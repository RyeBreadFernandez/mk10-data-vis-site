"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[3397],{11389:(w,S,t)=>{t.d(S,{o:()=>g});var e=t(74848),a=t(32196),d=t(40845),A=t(13471);const g=({items:y,children:m,isPinned:n,scrollable:M=!1,maxHeight:R})=>{const v=(0,d.of)(h),i=M?{maxHeight:R,overflowY:"auto"}:{};return(0,e.jsxs)("div",{className:v.wrapper,style:i,children:[y.map(({label:l,value:u,color:s,colorIndicator:p,colorPlacement:x,isActive:P,lineStyle:E},O)=>(0,e.jsx)(A.B,{label:l,value:u,color:s,colorIndicator:p,colorPlacement:x,isActive:P,justify:"space-between",isPinned:n,lineStyle:E,showValueScroll:!M},O)),m]})},h=y=>({wrapper:(0,a.css)({display:"flex",flexDirection:"column",flex:1,gap:2,borderTop:`1px solid ${y.colors.border.medium}`,padding:y.spacing(1)})})},75073:(w,S,t)=>{t.d(S,{S:()=>R});var e=t(74848),a=t(32196),d=t(67061),A=t(72109),g=t(55852),h=t(40845);function y({action:i,...l}){return(0,e.jsx)(g.$n,{variant:"primary",size:"sm",onClick:i.onClick,...l,children:i.title})}const m="add-annotation-button",n=i=>(0,e.jsx)(d.B,{direction:"column",justifyContent:"flex-start",children:i.map((l,u)=>(0,e.jsx)(A.Y,{href:l.href,external:l.target==="_blank",weight:"medium",inline:!1,variant:"bodySmall",children:l.title},u))}),M=i=>(0,e.jsx)(d.B,{direction:"column",justifyContent:"flex-start",children:i.map((l,u)=>(0,e.jsx)(y,{action:l,variant:"secondary"},u))}),R=({dataLinks:i,actions:l,annotate:u})=>{const s=(0,h.of)(v);return(0,e.jsxs)("div",{className:s.wrapper,children:[i.length>0&&(0,e.jsx)("div",{className:s.dataLinks,children:n(i)}),l&&l.length>0&&(0,e.jsx)("div",{className:s.dataLinks,children:M(l)}),u!=null&&(0,e.jsx)("div",{className:s.addAnnotations,children:(0,e.jsx)(g.$n,{icon:"comment-alt",variant:"secondary",size:"sm",id:m,onClick:u,children:"Add annotation"})})]})},v=i=>({wrapper:(0,a.css)({display:"flex",flexDirection:"column",flex:1,padding:i.spacing(0)}),dataLinks:(0,a.css)({borderTop:`1px solid ${i.colors.border.medium}`,padding:i.spacing(1)}),addAnnotations:(0,a.css)({borderTop:`1px solid ${i.colors.border.medium}`,padding:i.spacing(1)})})},52415:(w,S,t)=>{t.d(S,{A:()=>g});var e=t(74848),a=t(32196),d=t(40845),A=t(13471);const g=({item:y,isPinned:m})=>{const n=(0,d.of)(h),{label:M,value:R,color:v,colorIndicator:i}=y;return(0,e.jsx)("div",{className:n.wrapper,children:(0,e.jsx)(A.B,{label:M,value:R,color:v,colorIndicator:i,marginRight:"22px",isPinned:m})})},h=y=>({wrapper:(0,a.css)({display:"flex",flexDirection:"column",flex:1,padding:y.spacing(1),lineHeight:1})})},55307:(w,S,t)=>{t.d(S,{i:()=>A});var e=t(74848),a=t(32196),d=t(40845);const A=({children:h,className:y})=>{const m=(0,d.of)(g);return(0,e.jsx)("div",{className:(0,a.cx)(m.wrapper,y),children:h})},g=h=>({wrapper:(0,a.css)({display:"flex",flexDirection:"column",fontSize:h.typography.bodySmall.fontSize})})},72235:(w,S,t)=>{t.d(S,{l:()=>g});var e=t(74848),a=t(32196),d=t(96540),A=t(49785);function g({defaultValues:h,onSubmit:y,validateOnMount:m=!1,validateFieldsOnMount:n,children:M,validateOn:R="onSubmit",maxWidth:v=600,...i}){const{handleSubmit:l,trigger:u,formState:s,...p}=(0,A.mN)({mode:R,defaultValues:h});return(0,d.useEffect)(()=>{m&&u(n)},[u,n,m]),(0,e.jsx)("form",{className:(0,a.css)({maxWidth:v!=="none"?v+"px":v,width:"100%"}),onSubmit:l(y),...i,children:M({errors:s.errors,formState:s,trigger:u,...p})})}},81530:(w,S,t)=>{t.d(S,{X:()=>R,k:()=>n});var e=t(90708),a=t(26272),d=t(11261),A=t(80997),g=t(17172),h=t(10096),y=t(77920),m=t(3704);const n=(l,u,s,p,x,P)=>!x||x.length===0?[]:x.map(O=>{const D=(0,e.vd)(l,u,s),B={...s,__dataContext:D},N=(ot,V,rt)=>p(ot,{...B,...V},rt);P.valueRowIndex!==void 0&&!isNaN(P.valueRowIndex)?D.value.rowIndex=P.valueRowIndex:D.value.calculatedValue=P.calculatedValue;let C={title:"",onClick:ot=>{}};return C={title:p(O.title||"",B),onClick:(ot,V)=>{M(O,N)}},C}).filter(O=>!!O),M=(l,u)=>{try{const s=new URL(v(u(l.fetch.url))),p={};let x={url:s.toString(),method:l.fetch.method,data:i(l,u),headers:p};l.fetch.headers&&l.fetch.headers.forEach(([P,E])=>{p[u(P)]=u(E)}),l.fetch.queryParams&&(l.fetch.queryParams?.forEach(([P,E])=>{s.searchParams.append(u(P),u(E))}),x.url=s.toString()),p["X-Grafana-Action"]="1",x.headers=p,(0,g.AI)().fetch(x).subscribe({error:P=>{h.lE.emit(a.r1.alertError,["An error has occurred. Check console output for more details."]),console.error(P)},complete:()=>{h.lE.emit(a.r1.alertSuccess,["API call was successful"])}})}catch(s){h.lE.emit(a.r1.alertError,["An error has occurred. Check console output for more details."]),console.error(s);return}},R=(l=[],u=[])=>({name:"Default field",type:d.PU.string,config:{links:l,actions:u},values:[]}),v=l=>{if(l.startsWith("/")){const s=A.sQ.sanitizeUrl(l);l=(0,m.z)(s,[])}return l},i=(l,u)=>{let s=l.fetch.body?u(l.fetch.body):"{}";return l.fetch.method===y.DO.GET&&(s=void 0),s}},77920:(w,S,t)=>{t.d(S,{DO:()=>A,en:()=>e,gR:()=>a,xp:()=>d});var e=(n=>(n.Center="center",n.Left="left",n.LeftRight="leftright",n.Right="right",n.Scale="scale",n))(e||{}),a=(n=>(n.Bottom="bottom",n.Center="center",n.Scale="scale",n.Top="top",n.TopBottom="topbottom",n))(a||{}),d=(n=>(n.Contain="contain",n.Cover="cover",n.Fill="fill",n.Original="original",n.Tile="tile",n))(d||{}),A=(n=>(n.GET="GET",n.POST="POST",n.PUT="PUT",n))(A||{}),g=(n=>(n.Straight="straight",n))(g||{});const h={vertices:[]},y={connections:[]},m={infinitePan:!0,inlineEditing:!0,panZoom:!0,showAdvancedTypes:!0}},21164:(w,S,t)=>{t.d(S,{O:()=>A,u:()=>d});var e=t(32264),a=t(81530);const d=(g,h)=>{const y=[];if((g.config.links?.length??0)>0&&g.getLinks!=null){const m=g.values[h],n=g.display?g.display(m):{text:`${m}`,numeric:+m},M=new Set;g.getLinks({calculatedValue:n,valueRowIndex:h}).forEach(R=>{const v=`${R.title}/${R.href}`;M.has(v)||(y.push(R),M.add(v))})}return y},A=(g,h,y)=>{if(!e.$.featureToggles?.vizActions)return[];const m=[],n=new Set;return(0,a.k)(g,h,h.state.scopedVars,y,h.config.actions??[],{}).forEach(R=>{const v=`${R.title}`;n.has(v)||(m.push(R),n.add(v))}),m}},62567:(w,S,t)=>{t.d(S,{W:()=>Ot});var e=t(74848),a=t(32196),d=t(96540),A=t(40961),g=t(84140),h=t(36613),y=t(33948),m=t(52622),n=t(23596),M=t(24284),R=t(17464),v=t(40845),i=t(46885),l=t(83505),u=t(13544),s=t(49785),p=t(29647),x=t(41053),P=t(72724),E=t(42994),O=t(79041),D=t(67061),B=t(88575),N=t(21744),C=t(55852),ot=t(72235),V=t(99818),rt=t(10154);const gt=({annoVals:o,annoIdx:r,dismiss:U,timeZone:_,...k})=>{const j=(0,v.of)(it),{onAnnotationCreate:I,onAnnotationUpdate:nt}=(0,O.d2)(),F=(0,d.useRef)(null);(0,p.A)(F,U);const[G,X]=(0,x.A)(async c=>{const L=await I(c);return U(),L}),[at,tt]=(0,x.A)(async c=>{const L=await nt(c);return U(),L}),H=c=>(0,P.LE)(c,{format:E.WC.fullDate,timeZone:_}),J=o.id?.[r]!=null,lt=o.isRegion?.[r],ut=J?tt:X,st=J?at:G,f=lt?`${H(o.time[r])} - ${H(o.timeEnd[r])}`:H(o.time[r]),b=({tags:c,description:L})=>{ut({id:o.id?.[r]??void 0,tags:c,description:L,from:Math.round(o.time[r]),to:Math.round(o.timeEnd?.[r]??o.time[r])})};return(0,e.jsxs)("div",{ref:F,className:j.editor,...k,children:[(0,e.jsx)("div",{className:j.header,children:(0,e.jsxs)(D.B,{justifyContent:"space-between",alignItems:"center",children:[(0,e.jsx)("div",{children:J?"Edit annotation":"Add annotation"}),(0,e.jsx)("div",{children:f})]})}),(0,e.jsx)(ot.l,{onSubmit:b,defaultValues:{description:o.text?.[r],tags:o.tags?.[r]||[]},children:({register:c,errors:L,control:W})=>(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:j.content,children:[(0,e.jsx)(B.D,{label:"Description",invalid:!!L.description,error:L?.description?.message,children:(0,e.jsx)(N.f,{className:j.textarea,...c("description",{required:"Annotation description is required"})})}),(0,e.jsx)(B.D,{label:"Tags",children:(0,e.jsx)(s.xI,{control:W,name:"tags",render:({field:{ref:K,onChange:Q,...T}})=>(0,e.jsx)(V.$,{allowCustomValue:!0,placeholder:"Add tags",onChange:Q,tagOptions:rt.vy,tags:T.value})})})]}),(0,e.jsx)("div",{className:j.footer,children:(0,e.jsxs)(D.B,{justifyContent:"flex-end",children:[(0,e.jsx)(C.$n,{size:"sm",variant:"secondary",onClick:U,fill:"outline",children:"Cancel"}),(0,e.jsx)(C.$n,{size:"sm",type:"submit",disabled:st?.loading,children:st?.loading?"Saving":"Save"})]})})]})})]})},it=o=>({editor:(0,a.css)({background:o.colors.background.primary,border:`1px solid ${o.colors.border.weak}`,borderRadius:o.shape.radius.default,boxShadow:o.shadows.z3,userSelect:"text",width:"460px"}),content:(0,a.css)({padding:o.spacing(1)}),header:(0,a.css)({borderBottom:`1px solid ${o.colors.border.weak}`,padding:o.spacing(.5,1),fontWeight:o.typography.fontWeightBold,fontSize:o.typography.fontSize,color:o.colors.text.primary}),footer:(0,a.css)({borderTop:`1px solid ${o.colors.border.weak}`,padding:o.spacing(1,1)}),textarea:(0,a.css)({color:o.colors.text.secondary,fontSize:o.typography.bodySmall.fontSize})});var $=t(80997),ct=t(66864),dt=t(29158),q=t(78369),xt=t(55907);const Et=()=>!1,Dt=({annoVals:o,annoIdx:r,timeZone:U,onEdit:_})=>{const k=o.id?.[r],j=(0,v.of)(At),{canEditAnnotations:I=Et,canDeleteAnnotations:nt=Et,onAnnotationDelete:F}=(0,O.d2)(),G=o.dashboardUID?.[r],X=I(G),at=nt(G)&&F!=null,tt=f=>(0,P.LE)(f,{format:E.WC.fullDate,timeZone:U});let H=tt(o.time[r]),J=o.text?.[r]??"";o.isRegion?.[r]&&(H+=" - "+tt(o.timeEnd[r]));let lt;o.login?.[r]&&o.avatarUrl?.[r]&&(lt=(0,e.jsx)("img",{className:j.avatar,alt:"Annotation avatar",src:o.avatarUrl[r]}));let ut=null,st="";if(o.alertId?.[r]!==void 0&&o.newState?.[r]){const f=xt.A.getStateDisplayModel(o.newState[r]);ut=(0,e.jsx)("div",{className:j.alertState,children:(0,e.jsx)("i",{className:f.stateClass,children:f.text})}),st=o.data?.[r]?xt.A.getAlertAnnotationText(o.data[r]):""}else o.title?.[r]&&(J=o.title[r]+(J?`<br />${J}`:""));return(0,e.jsxs)("div",{className:j.wrapper,children:[(0,e.jsx)("div",{className:j.header,children:(0,e.jsxs)(ct.Gy,{justify:"space-between",align:"center",spacing:"md",children:[(0,e.jsxs)("div",{className:j.meta,children:[(0,e.jsxs)("span",{children:[lt,ut]}),H]}),(X||at)&&(0,e.jsxs)("div",{className:j.editControls,children:[X&&(0,e.jsx)(dt.K,{name:"pen",size:"sm",onClick:_,tooltip:"Edit"}),at&&(0,e.jsx)(dt.K,{name:"trash-alt",size:"sm",onClick:()=>F(k),tooltip:"Delete"})]})]})}),(0,e.jsxs)("div",{className:j.body,children:[J&&(0,e.jsx)("div",{className:j.text,dangerouslySetInnerHTML:{__html:$.sQ.sanitize(J)}}),st,(0,e.jsx)("div",{children:(0,e.jsx)(ct.Gy,{spacing:"xs",wrap:!0,children:o.tags?.[r]?.map((f,b)=>(0,e.jsx)(q.v,{name:f},`${f}-${b}`))})})]})]})},At=o=>({wrapper:(0,a.css)({zIndex:o.zIndex.tooltip,whiteSpace:"initial",borderRadius:o.shape.radius.default,background:o.colors.background.primary,border:`1px solid ${o.colors.border.weak}`,boxShadow:o.shadows.z2,userSelect:"text"}),header:(0,a.css)({padding:o.spacing(.5,1),borderBottom:`1px solid ${o.colors.border.weak}`,fontWeight:o.typography.fontWeightBold,fontSize:o.typography.fontSize,color:o.colors.text.primary,display:"flex"}),meta:(0,a.css)({display:"flex",justifyContent:"space-between",color:o.colors.text.primary,fontWeight:400}),editControls:(0,a.css)({display:"flex",alignItems:"center","> :last-child":{marginLeft:0}}),body:(0,a.css)({padding:o.spacing(1),fontSize:o.typography.bodySmall.fontSize,color:o.colors.text.secondary,fontWeight:400,a:{color:o.colors.text.link,"&:hover":{textDecoration:"underline"}}}),text:(0,a.css)({paddingBottom:o.spacing(1)}),avatar:(0,a.css)({borderRadius:o.shape.radius.circle,width:16,height:16,marginRight:o.spacing(1)}),alertState:(0,a.css)({paddingRight:o.spacing(1),fontWeight:o.typography.fontWeightMedium})}),pt=0,ft=1,yt=2,Mt=({annoVals:o,annoIdx:r,className:U,style:_,exitWipEdit:k,timeZone:j,portalRoot:I})=>{const nt=(0,v.of)(Tt),[F,G]=(0,d.useState)(k!=null?ft:pt),{refs:X,floatingStyles:at}=(0,l.we)({open:!0,placement:"bottom",middleware:[(0,i.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,i.BN)()],whileElementsMounted:i.ll,strategy:"fixed"}),tt=F===yt?(0,e.jsx)(Dt,{annoIdx:r,annoVals:o,timeZone:j,onEdit:()=>G(ft)}):F===ft?(0,e.jsx)(gt,{annoIdx:r,annoVals:o,timeZone:j,dismiss:()=>{k?.(),G(pt)}}):null;return(0,e.jsx)("div",{ref:X.setReference,className:U,style:_,onMouseEnter:()=>F!==ft&&G(yt),onMouseLeave:()=>F!==ft&&G(pt),"data-testid":u.Tp.pages.Dashboard.Annotations.marker,children:tt&&(0,A.createPortal)((0,e.jsx)("div",{ref:X.setFloating,className:nt.annoBox,style:at,"data-testid":"annotation-marker",children:tt}),I)})},Tt=o=>({annoBox:(0,a.css)({top:0,left:0,zIndex:o.zIndex.tooltip,borderRadius:o.shape.radius.default,position:"absolute",background:o.colors.background.primary,border:`1px solid ${o.colors.border.weak}`,boxShadow:o.shadows.z2,userSelect:"text",minWidth:"300px"})}),ht=(o,r,U,_,k)=>{o.beginPath(),o.moveTo(_,r),o.lineTo(_,U),o.strokeStyle=k,o.stroke()},vt=(0,g.A)(M.Mk).toHex8String();function Pt(o){let r={};return o.fields.forEach(U=>{r[U.name]=U.values}),r}const Ot=({annotations:o,timeZone:r,config:U,newRange:_,setNewRange:k,canvasRegionRendering:j=!0})=>{const[I,nt]=(0,d.useState)(),[F]=(0,d.useState)(()=>(0,R.gF)()),G=(0,v.of)(Ct),X=(0,v.$j)().visualization.getColorByName,[at,tt]=(0,d.useReducer)(f=>f+1,0),H=(0,d.useMemo)(()=>{let f=o.filter(b=>b.name!=="exemplar"&&b.length>0&&b.fields.some(c=>c.name==="time"));if(_){let b=_.to>_.from;const c=(0,y.I)([{time:_.from,timeEnd:b?_.to:null,isRegion:b,color:vt}]);c.meta={dataTopic:m.QR.Annotations,custom:{isWip:!0}},f.push(c)}return f},[o,_]),J=(0,d.useCallback)(()=>{k(null)},[k]),lt=(0,d.useRef)(H);lt.current=H;const ut=(0,d.useRef)(_);ut.current=_;const st=(0,d.useRef)();if((0,d.useLayoutEffect)(()=>{U.addHook("ready",f=>{let b=f.root.querySelector(".u-axis");st.current=b,nt(f)}),U.addHook("draw",f=>{let b=lt.current;const c=f.ctx;c.save(),c.beginPath(),c.rect(f.bbox.left,f.bbox.top,f.bbox.width,f.bbox.height),c.clip(),b.forEach(L=>{let W=Pt(L);if(L.name==="xymark"){let K=U.scales[0].props.scaleKey,Q=U.scales[1].props.scaleKey;for(let T=0;T<L.length;T++){let Y=X(W.color?.[T]||vt),z=f.valToPos(W.xMin[T],K,!0),Z=f.valToPos(W.xMax[T],K,!0),et=f.valToPos(W.yMax[T],Q,!0),mt=f.valToPos(W.yMin[T],Q,!0);c.fillStyle=n.MV.alpha(Y,W.fillOpacity[T]),c.fillRect(z,et,Z-z,mt-et),c.lineWidth=Math.round(W.lineWidth[T]*h.A.pxRatio),W.lineStyle[T]==="dash"?c.setLineDash([5,5]):c.setLineDash([]),c.strokeStyle=Y,c.strokeRect(z,et,Z-z,mt-et)}}else{let K=f.bbox.top,Q=K+f.bbox.height;c.lineWidth=2,c.setLineDash([5,5]);for(let T=0;T<W.time.length;T++){let Y=X(W.color?.[T]||vt),z=f.valToPos(W.time[T],"x",!0);if(!W.isRegion?.[T])ht(c,K,Q,z,Y);else if(j){ht(c,K,Q,z,Y);let Z=f.valToPos(W.timeEnd[T],"x",!0);ht(c,K,Q,Z,Y),c.fillStyle=n.MV.alpha(Y,.1),c.fillRect(z,K,Z-z,f.bbox.height)}}}}),c.restore()})},[U,j,X]),(0,d.useEffect)(()=>{I&&(I.redraw(),setTimeout(()=>{tt()},0))},[H,I]),I){let f=H.flatMap((b,c)=>{let L=Pt(b),W=[];for(let K=0;K<L.time.length;K++){let Q=X(L.color?.[K]||M.Mk),T=Math.round(I.valToPos(L.time[K],"x"))||0,Y=null,z="",Z=!0;if(L.isRegion?.[K]){let et=Math.round(I.valToPos(L.timeEnd?.[K],"x"))||0;if(Z=T<I.rect.width&&et>0,Z){let mt=Math.max(0,T),Rt=Math.min(I.rect.width,et);Y={left:mt,background:Q,width:Rt-mt},z=G.annoRegion}}else Z=T>=0&&T<=I.rect.width,Z&&(Y={left:T,borderBottomColor:Q},z=G.annoMarker);if(Z){let et=b.meta?.custom?.isWip;W.push((0,e.jsx)(Mt,{annoIdx:K,annoVals:L,className:z,style:Y,timeZone:r,exitWipEdit:et?J:null,portalRoot:F},`${c}:${K}`))}}return W});return(0,A.createPortal)(f,st.current)}return null},Ct=()=>({annoMarker:(0,a.css)({position:"absolute",width:0,height:0,borderLeft:"5px solid transparent",borderRight:"5px solid transparent",borderBottomWidth:"5px",borderBottomStyle:"solid",transform:"translateX(-50%)",cursor:"pointer",zIndex:1}),annoRegion:(0,a.css)({position:"absolute",height:"5px",cursor:"pointer",zIndex:1})})},7874:(w,S,t)=>{t.d(S,{U:()=>A});var e=t(74848),a=t(96540),d=t(55852);const A=({config:g,onChangeTimeRange:h})=>{const y=(0,a.useRef)(),[m,n]=(0,a.useState)([]),[M,R]=(0,a.useState)();if((0,a.useLayoutEffect)(()=>{g.addHook("init",x=>{y.current=x}),g.addHook("setScale",x=>{n(x.data?.[0]??[]),R(x.scales.x??void 0)})},[g]),m.length<2||!h||!M||!M.time||!M.min||!M.max)return null;let v=0,i=m.length-1;for(;v<=i&&m[v]==null;)v++;for(;i>=0&&m[i]==null;)i--;const l=m[v],u=m[i],s=M.min,p=M.max;return l==null||u==null||l<=p&&u>=s?null:(0,e.jsx)("div",{style:{position:"absolute",top:"50%",transform:"translateY(-50%)",width:"100%",textAlign:"center"},children:(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{children:"Data outside time range"}),(0,e.jsx)(d.$n,{onClick:x=>h({from:l,to:u}),variant:"secondary","data-testid":"time-series-zoom-to-data",children:"Zoom to data"})]})})};A.displayName="OutsideRangePlugin"},82915:(w,S,t)=>{t.d(S,{B_:()=>R,Fg:()=>l,O2:()=>i,T5:()=>u});var e=t(11261),a=t(28240),d=t(83195),A=t(57875),g=t(50311),h=t(46294),y=t(39624),m=t(52622),n=t(55129);function M(s){let p=new Map;return s.map(P=>({...P,fields:P.fields.map(E=>{if(E.type===e.PU.enum){let O=(0,n.M)(E.config,E.type),D=p.get(O);D||(D=[],p.set(O,D));let B=E.values.toArray().slice(),N=E.config.type.enum.text;if(D.length>0)for(let C=0;C<B.length;C++)B[C]+=D.length;return D.push(...N),E.config.type.enum.text=D,{...E,values:B}}return E})}))}function R(s,p,x,P){if(!s?.length)return null;(0,a.Fm)(s);let E=P!=null;P!=null&&P>0&&(s=[{...s[0],fields:[s[0].fields[P],...s[0].fields.filter((N,C)=>C!==P)]}]);for(let N of s)for(let C of N.fields)C.type===e.PU.time&&typeof C.values[0]!="number"&&(C.values=(0,g.s7)(C,{destinationType:e.PU.time}).values);let O=0;t:for(let N of s)for(let C of N.fields)if(C.type===e.PU.enum&&++O>1){s=M(s);break t}let D;const B=[];for(let N of s){const C=[];let ot=!1,V=!1,rt=E?N:(0,h.M)({frame:N,refFieldPseudoMin:x?.from.valueOf(),refFieldPseudoMax:x?.to.valueOf()});const gt=(0,y.C)(rt).fields;for(let it=0;it<gt?.length;it++){const $=gt[it];switch($.type){case e.PU.time:ot=!0,C.push($);break;case e.PU.number:V=E?it>0:!0,D={...$,values:$.values.map(q=>Number.isFinite(q)||q==null?q:null)},C.push(D);break;case e.PU.enum:V=!0;case e.PU.string:D={...$,values:$.values},C.push(D);break;case e.PU.boolean:V=!0;const ct=$.config?.custom??{},dt={...$.config,max:1,min:0,custom:ct};ct.lineInterpolation!==m.dx.StepBefore&&(ct.lineInterpolation=m.dx.StepAfter),D={...$,config:dt,type:e.PU.number,values:$.values.map(q=>q==null?q:q?1:0)},(0,d.j9)(dt.unit)||(dt.unit="bool",D.display=(0,A.J)({field:D,theme:p})),C.push(D);break}}(E||ot)&&V&&B.push({...N,length:rt.length,fields:C})}return B.length?(i(B,p,0),v(B,p),B):null}const v=(s,p)=>{const{palette:x}=p.visualization;for(const P of s)for(const E of P.fields)if(E.type===e.PU.enum){const O=x[E.state?.seriesIndex%x.length],D=p.visualization.getColorByName(O),B=E.config.type.enum;B.color=Array(B.text.length).fill(D),E.display=(0,A.J)({field:E,theme:p})}},i=(s,p,x)=>{let P=0;s.forEach(E=>{E.fields.forEach((O,D)=>{D!==x&&(O.type===e.PU.number||O.type===e.PU.boolean||O.type===e.PU.enum)&&(O.state={...O.state,seriesIndex:P++},O.display=(0,A.J)({field:O,theme:p}))})})};function l(s,p){return!s||!s.length?[p]:s.map(x=>x?.length?x:p)}const u=s=>s.mode===m.$N.Multi&&s.maxHeight!=null}}]);

//# sourceMappingURL=3397.ddbb0c6f910bdfcd328d.js.map