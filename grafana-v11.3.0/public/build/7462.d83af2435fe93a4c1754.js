(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[7462],{76287:(G,R,e)=>{"use strict";e.d(R,{p:()=>a});var t=e(74848),n=e(96540),s=e(94841);function a(r){const{children:g,instanceSettings:i}=r,l=(0,n.useMemo)(()=>({instanceSettings:i,meta:i.meta}),[i]);return(0,t.jsx)(s.o.Provider,{value:l,children:g})}},94841:(G,R,e)=>{"use strict";e.d(R,{o:()=>n});var t=e(96540);const n=(0,t.createContext)(void 0)},13834:(G,R,e)=>{"use strict";e.d(R,{a:()=>s});var t=e(74848),n=e(94841);function s(a){const{children:r,...g}=a;return(0,t.jsx)(n.o.Provider,{value:g,children:r})}},95187:(G,R,e)=>{"use strict";e.d(R,{S:()=>t});function t(n){return"instanceSettings"in n&&"meta"in n}},92470:(G,R,e)=>{"use strict";e.d(R,{Q:()=>s});var t=e(96540),n=e(94841);function s(){const a=(0,t.useContext)(n.o);return a||null}},33948:(G,R,e)=>{"use strict";e.d(R,{I:()=>a,f:()=>s});var t=e(11261),n=e(14236);class s{constructor(l,d){return this.fields=[],this.length=0,a(l,d)}}function a(i,l){const d={fields:[],length:i.length};if(!i?.length)return d;if(l){if(!g(i))throw new Error("source is not an array of objects");for(const h of l)d.fields.push(r(h,i.map(o=>o&&o[h])));return d}if(i.find(h=>h)===null)return d;if(g(i)){const h=i.find(o=>o);d.fields=Object.keys(h||{}).map(o=>r(o,i.map(m=>m&&m[o])))}else d.fields.push(r(t.Bc,i));return d}function r(i,l){const d={name:i,config:{},values:l,type:t.PU.other};return d.type=(0,n.dF)(d)??t.PU.other,d}function g(i){const l=i.find(d=>d);return i.length>0&&typeof l=="object"}},33526:(G,R,e)=>{"use strict";e.d(R,{x:()=>s});var t=e(36120),n=e(37471);class s extends n.k{constructor(r){super(void 0,g=>new t.$({...r,buffer:g}))}}},89667:(G,R,e)=>{"use strict";e.d(R,{EL:()=>r,Nw:()=>l,or:()=>i,t:()=>a});var t=e(11261),n=e(14236);const s={Inf:1/0,NegInf:-1/0,Undef:void 0,NaN:NaN};function a(d,c){let h;for(h in d){const o=s[h];for(const m of d[h])m<c.length&&(c[m]=o)}}function r(d,c){for(let h=0;h<c.length;h++)c[h]=d[Number(c[h])]}function g(d,c){for(const h of c)if(h!=null)return(0,n.by)(d,h);return t.PU.other}function i(d){const{schema:c,data:h}=d;if(!c||!c.fields)throw new Error("JSON needs a fields definition");const o=h?h.values.reduce((u,p)=>Math.max(u,p.length),0):0,m=c.fields.map((u,p)=>{let f=h?h.values[p]:[],y=f.length,x=u.type;y!==o&&(f.length=o,f.fill(void 0,y));let v=h?.entities?.[p];v&&a(v,f);let P=h?.enums?.[p];P&&(r(P,f),x=t.PU.string);const E=h?.nanos?.[p],D={...u,type:x??g(u.name,f),config:u.config??{},values:f,entities:v??{}};return E!=null&&(D.nanos=E),D});return{...c,fields:m,length:o}}function l(d){const c={values:[]},h=[];let o=!1;const m={refId:d.refId,meta:d.meta,name:d.name,fields:d.fields.map(u=>{const{values:p,nanos:f,state:y,display:x,...v}=u;return"entities"in v&&delete v.entities,c.values.push(p),f!=null?(h.push(f),o=!0):h.push(null),v})};return o&&(c.nanos=h),{schema:m,data:c}}},78368:(G,R,e)=>{"use strict";e.d(R,{R:()=>n});var t=e(18008);class n extends t.F{constructor(a){super(),this.data=a,this.index=0;const r={},g={};for(let i=0;i<a.fields.length;i++){const l=a.fields[i];if(!l.name)continue;g[l.name]=l;const d=()=>l.values.get(this.index);r.hasOwnProperty(l.name)||Object.defineProperty(r,l.name,{enumerable:!0,get:d}),r.hasOwnProperty(i.toString())||Object.defineProperty(r,i,{enumerable:!1,get:d})}this.obj=r,this.fields=g}get dataFrame(){return this.data}get length(){return this.data.length}getFieldDisplayProcessor(a){if(!this.dataFrame||!this.dataFrame.fields)return;const r=this.dataFrame.fields[a];if(!(!r||!r.display))return r.display}get(a){return this.index=a,this.obj}toArray(){return new Array(this.data.length).fill(0).map((a,r)=>({...this.get(r)}))}}},85404:(G,R,e)=>{"use strict";e.d(R,{L:()=>s});var t=e(11261),n=e(14236);class s{constructor(r){this.fields=[],this.fieldByName={},this.fieldByType={},this.fields=r.fields.map((g,i)=>({...g,index:i}));for(let g=0;g<r.fields.length;g++){const i=r.fields[g];if(i.type===t.PU.other){const l=(0,n.dF)(i);l&&(i.type=l)}this.fieldByType[i.type]||(this.fieldByType[i.type]=[]),this.fieldByType[i.type].push({...i,index:g}),this.fieldByName[i.name]?console.warn("Duplicate field names in DataFrame: ",i.name):this.fieldByName[i.name]={...i,index:g}}}getFields(r){if(!r)return[...this.fields];const g=this.fieldByType[r];return g?[...g]:[]}hasFieldOfType(r){const g=this.fieldByType[r];return g&&g.length>0}getFirstFieldOfType(r,g=!1){return this.fieldByType[r]?.find(d=>g||!d.config.custom?.hidden)}hasFieldNamed(r){return!!this.fieldByName[r]}hasFieldWithNameAndType(r,g){return!!this.fieldByName[r]&&this.fieldByType[g].filter(i=>i.name===r).length>0}getFieldByName(r){return this.fieldByName[r]}getFieldsByLabel(r,g){return Object.values(this.fieldByName).filter(i=>i.labels&&i.labels[r]===g)}}},37471:(G,R,e)=>{"use strict";e.d(R,{p:()=>g,k:()=>i});var t=e(2543),n=e(11261),s=e(14236);function a(l,d){return d.type||(d.name==="time"||d.name==="Time"?d.type=n.PU.time:d.type=(0,s.HW)(l)),d.type===n.PU.number?c=>parseFloat(c):d.type===n.PU.boolean?c=>!(c[0]==="F"||c[0]==="f"||c[0]==="0"):c=>c}var r=e(18008);const g=void 0;class i extends r.F{constructor(d,c){if(super(),this.fields=[],this.first=[],this.parsers=void 0,this.creator=c||(h=>h??[]),d){const{name:h,refId:o,meta:m,fields:u}=d;if(h&&(this.name=h),o&&(this.refId=o),m&&(this.meta=m),u)for(const p of u)this.addField(p)}Object.defineProperty(this,"length",{enumerable:!0,get:()=>this.first.length})}get length(){return this.first.length}addFieldFor(d,c){return this.addField({name:c||"",type:(0,s.HW)(d)})}addField(d,c){let h;d.values&&(h=d.values);let o=d.type;!o&&(d.name==="time"||d.name==="Time")?o=n.PU.time:(!o&&h&&h.length&&(o=(0,s.HW)(h[0])),o||(o=n.PU.other));let m=d.name;m||(m=`Field ${this.fields.length+1}`);const u={...d,name:m,type:o,config:d.config||{},values:this.creator(h)};if(o===n.PU.other&&(o=(0,s.dF)(u),o&&(u.type=o)),this.fields.push(u),this.first=this.fields[0].values,c)for(;u.values.length<c;)u.values.push(g);else this.validate();return u}validate(){const d=this.fields.reduce((c,h)=>Math.max(c,h.values.length),0);for(const c of this.fields)for(;c.values.length!==d;)c.values.push(g)}setParser(d,c){return this.parsers||(this.parsers=new Map),this.parsers.set(d,c),c}parseValue(d,c){let h=this.parsers?.get(d);return h||(h=this.setParser(d,a(c,d))),h(c)}appendRow(d){for(let c=this.fields.length;c<d.length;c++)this.addField({name:`Field ${c+1}`,type:(0,s.HW)(d[c])});if(this.length<1)for(let c=0;c<this.fields.length;c++){const h=this.fields[c];(!h.type||h.type===n.PU.other)&&(h.type=(0,s.HW)(d[c]))}for(let c=0;c<this.fields.length;c++){const h=this.fields[c];let o=d[c];h.type!==n.PU.string&&(0,t.isString)(o)&&(o=this.parseValue(h,o)),h.values.push(o)}}push(...d){for(const c of d)this.add(c);return this.length}reverse(){for(const d of this.fields)d.values.reverse();return this}add(d){const c=d;for(const h of this.fields){let o=c[h.name];h.type!==n.PU.string&&(0,t.isString)(o)&&(o=this.parseValue(h,o)),o===void 0&&(o=g),h.values.push(o)}}set(d,c){if(d>this.length)throw new Error("Unable to set value beyond current length");const h=c||{};for(const o of this.fields)o.values[d]=h[o.name]}get(d){const c={};for(const h of this.fields)c[h.name]=h.values[d];return c}toJSON(){return(0,s.Kl)(this)}}},9631:(G,R,e)=>{"use strict";e.d(R,{Kh:()=>i,Ls:()=>m,k9:()=>c,m8:()=>h});var t=e(73060),n=e(11261),s=e(8249),a=e(43659),r=e(89667),g=e(14236),i=(P=>(P.Append="append",P.Replace="replace",P))(i||{});const l="__name__";var d=(P=>(P[P.wide=0]="wide",P[P.labels=1]="labels",P))(d||{});class c{constructor(E){this.options=E,this.meta={},this.fields=[],this.length=0,this.schemaFields=[],this.timeFieldIndex=-1,this.pushMode=0,this.labels=new Set,this.packetInfo={schemaChanged:!0,number:0,action:"replace",length:0},this.serialize=(D,C,b)=>{const T=C?Object.assign({},{...this.options,...C}):this.options,S=(0,g.By)(this,D),O=x(S.fields.map(I=>I.values??[]),typeof b?.maxLength=="number"?Math.min(b.maxLength,T.maxLength):T.maxLength,this.timeFieldIndex,T.maxDelta);S.fields=S.fields.map(I=>({...I,values:I.values?.slice(O)}));const M=S.fields[0]?.values?.length??0;return{...S,labels:this.labels,schemaFields:this.schemaFields,name:this.name,refId:this.refId,meta:this.meta,length:M,timeFieldIndex:this.timeFieldIndex,pushMode:this.pushMode,packetInfo:this.packetInfo,options:T}},this.initFromSerialized=D=>{this.name=D.name,this.refId=D.refId,this.meta=D.meta,this.length=D.length,this.labels=D.labels,this.schemaFields=D.schemaFields,this.timeFieldIndex=D.timeFieldIndex,this.pushMode=D.pushMode,this.packetInfo.length=D.packetInfo.length,this.packetInfo.number=D.packetInfo.number,this.packetInfo.action="replace",this.packetInfo.schemaChanged=!0,this.fields=D.fields.map(C=>({...C,type:C.type??n.PU.other,config:C.config??{},values:C.values??[]})),y(this.fields.map(C=>C.values),this.options.maxLength,this.timeFieldIndex,this.options.maxDelta)},this.needsResizing=({maxLength:D,maxDelta:C})=>{const b=D&&this.options.maxLength<D,T=C&&this.options.maxDelta<C,S=C&&this.options.maxDelta===1/0;return!!(b||T||S)},this.resize=({maxLength:D,maxDelta:C})=>{C&&(this.options.maxDelta===1/0?this.options.maxDelta=C:this.options.maxDelta=Math.max(C,this.options.maxDelta)),this.options.maxLength=Math.max(this.options.maxLength,D??0)},this.pushNewValues=D=>{if(!D?.length)return;this.packetInfo.action=this.options.action,this.packetInfo.number++,this.packetInfo.length=D[0].length,this.packetInfo.schemaChanged=!1,this.options.action==="append"?f(this.fields.map(b=>b.values),D,this.options.maxLength,this.timeFieldIndex,this.options.maxDelta):(D.forEach((b,T)=>{this.fields[T]&&(this.fields[T].values=b)}),y(this.fields.map(b=>b.values),this.options.maxLength,this.timeFieldIndex,this.options.maxDelta));const C=this.fields?.[0]?.values.length;C!==void 0&&(this.length=C)},this.resetStateCalculations=()=>{this.fields.forEach(D=>{D.state={...D.state??{},calcs:void 0,range:void 0}})},this.getMatchingFieldIndexes=D=>this.fields.map((C,b)=>D(C)?b:void 0).filter(C=>C!==void 0),this.getValuesFromLastPacket=()=>this.fields.map(D=>{const C=D.values;return C.slice(Math.max(C.length-this.packetInfo.length))}),this.hasAtLeastOnePacket=()=>!!this.packetInfo.length,this.getOptions=()=>this.options,Object.defineProperty(this,"length",{enumerable:!0}),Object.defineProperty(this,"fields",{enumerable:!0})}static{this.deserialize=E=>{const D=new c(E.options);return D.initFromSerialized(E),D}}static{this.empty=E=>new c(h(E))}static{this.fromDataFrameJSON=(E,D)=>{const C=new c(h(D));return C.push(E),C}}get alwaysReplace(){return this.options.action==="replace"}push(E){const{schema:D,data:C}=E;if(this.packetInfo.number++,this.packetInfo.length=0,this.packetInfo.schemaChanged=!1,D){this.pushMode=0,this.timeFieldIndex=D.fields.findIndex(O=>O.type===n.PU.time);const b=D.fields[0];this.timeFieldIndex===1&&b.type===n.PU.string&&(b.name==="labels"||b.name==="Labels")&&(this.pushMode=1,this.timeFieldIndex=0);const T=this.pushMode===1?D.fields.slice(1):D.fields;this.refId=D.refId,D.meta&&(this.meta={...D.meta});const{displayNameFormat:S}=this.options;if(v(this.schemaFields,T)){const O=T.length;this.fields.forEach((M,I)=>{const L=T[I%O];M.config=L.config??{},M.labels=L.labels}),S&&this.fields.forEach(M=>{const I={[l]:M.name,...M.labels};M.config.displayNameFromDS=(0,a.j)(S,I)})}else{this.packetInfo.schemaChanged=!0;const O=this.pushMode===0;this.fields=T.map(M=>{const I=M.config??{};if(S){const L={[l]:M.name,...M.labels};I.displayNameFromDS=(0,a.j)(S,L)}return{config:I,name:M.name,labels:M.labels,type:M.type??n.PU.other,values:O?this.fields.find(L=>L.name===M.name&&M.type===L.type)?.values??Array(this.length).fill(void 0):[]}})}this.schemaFields=T}if(C&&C.values.length&&C.values[0].length){let{values:b,entities:T}=C;if(T&&T.forEach((O,M)=>{O&&(0,r.t)(O,b[M])}),this.pushMode===1){const O=o(b);for(const L of O.keys())this.labels.has(L)||(this.packetInfo.schemaChanged=!0,this.addLabel(L));let M=Array(this.schemaFields.length).fill([]),I=[];this.labels.forEach(L=>{I.push(O.get(L)??M)}),b=(0,t.fj)(I)}if(b.length!==this.fields.length){if(this.fields.length)throw new Error(`push message mismatch.  Expected: ${this.fields.length}, received: ${b.length} (labels=${this.pushMode===1})`);this.fields=b.map((O,M)=>{let I=`Field ${M}`,L=(0,g.HW)(O[0]);return M===0&&L===n.PU.number&&O[0]>1600016688632&&(L=n.PU.time,I="Time"),{name:I,type:L,config:{},values:[]}})}let S=b;this.packetInfo.length=b[0].length,this.alwaysReplace||!this.length?this.packetInfo.action="replace":(this.packetInfo.action="append",S=this.fields.map(O=>O.values),f(S,b,this.options.maxLength,this.timeFieldIndex,this.options.maxDelta)),S.forEach((O,M)=>{const I=this.fields[M],{state:L}=I;I.values=O,L&&(L.calcs=void 0)}),this.length=S[0].length}return{...this.packetInfo}}addLabel(E){const{displayNameFormat:D}=this.options,C=this.labels.size,b=u(E);if(C===0)this.fields.forEach((T,S)=>{if(S>0&&(T.labels=b,D)){const O={[l]:T.name,...b};T.config.displayNameFromDS=(0,a.j)(D,O)}});else for(let T=1;T<this.schemaFields.length;T++){let S=this.schemaFields[T];const O=S.config??{};if(D){const M={[l]:S.name,...b};O.displayNameFromDS=(0,a.j)(D,M)}this.fields.push({...S,config:O,labels:b,values:Array(this.length).fill(void 0)})}this.labels.add(E)}}function h(P){return{maxLength:P?.maxLength??1e3,maxDelta:P?.maxDelta??1/0,action:P?.action??"append",displayNameFormat:P?.displayNameFormat}}function o(P){let E=new Set(P[0]),D=new Map;E.forEach(C=>{let b=Array(P.length-1).fill(null).map(()=>[]);D.set(C,b)});for(let C=0;C<P[0].length;C++){let b=D.get(P[0][C]);for(let T=1;T<P.length;T++)b[T-1].push(P[T][C])}return D}function m(P,E,D,C){let b;D=D||0,C=C||E.length-1;let T=C<=2147483647;for(;C-D>1;)b=T?D+C>>1:Math.floor((D+C)/2),E[b]<P?D=b:C=b;return P-E[D]<=E[C]-P?D:C}function u(P){if(!P.length)return{};if(P.charAt(0)==="{")return(0,s.Xy)(P);const E={};return P.split(",").forEach(D=>{const[C,b]=D.trim().split("=");E[C]=b}),E}function p(P){const E=P.packetInfo;return E?.action?E:void 0}function f(P,E,D=1/0,C=0,b=1/0){for(let T=0;T<P.length;T++)for(let S=0;S<E[T].length;S++)P[T].push(E[T][S]);return y(P,D,C,b)}function y(P,E=1/0,D=0,C=1/0){const b=x(P,E,D,C);if(b)for(let T=0;T<P.length;T++)P[T].splice(0,b);return b}function x(P,E=1/0,D=0,C=1/0){if(!P[0]?.length)return 0;const b=P[0].length;let T=0;if(b>E&&(T=b-E),C!==1/0&&D>=0){const S=P[D],O=S[T],M=S[b-1];M-O>C&&(T=m(M-C,S,T))}return T}function v(P,E){if(P?.length!==E.length)return!1;for(let D=0;D<P.length;D++){const C=P[D],b=E[D];if(C.name!==b.name||C.type!==b.type)return!1}return!0}},61443:(G,R,e)=>{"use strict";e.d(R,{Km:()=>r,P4:()=>s,WK:()=>a,g6:()=>n,r4:()=>t,xB:()=>g});const t=(i,l)=>({name:i,columns:l}),n=i=>i.columns,s=(i,l)=>i.columns[l],a=(i,l,d)=>i.columns[l].values[d],r=(i,l,d)=>i.columns.map(c=>c.values[d]),g=(i,l)=>i[l]},21423:(G,R,e)=>{"use strict";e.d(R,{J3:()=>a,ab:()=>g,bW:()=>s});var t=e(2543),n=e.n(t);function s(i,l,d){if(i===l)return!0;if(i?.fields?.length!==l?.fields?.length||i.name!==l.name)return!1;for(let c=0;c<i.fields.length;c++){const h=i.fields[c],o=l.fields[c];if(h.type!==o.type||h.name!==o.name)return!1;if(d)continue;if(h.labels&&o.labels&&!g(h.labels,o.labels))return!1;const m=h.config,u=o.config;if(Object.keys(m).length!==Object.keys(u).length)return!1;let p;for(p in m){if(!(p in u))return!1;if(p!=="interval"&&!(0,t.isEqual)(m[p],u[p]))return!1}}return!0}function a(i,l,d){if(i===l)return!0;if(i?.length!==l?.length)return!1;for(let c=0;c<i.length;c++)if(!d(i[c],l[c]))return!1;return!0}const r=(i,l)=>i===l;function g(i,l,d=r){if(i===l)return!0;if(Object.keys(i).length!==Object.keys(l).length)return!1;let c;for(c in i)if(!d(i[c],l[c]))return!1;return!0}},14236:(G,R,e)=>{"use strict";e.d(R,{Bt:()=>j,By:()=>I,EI:()=>K,ES:()=>T,HW:()=>y,KR:()=>L,Kl:()=>M,LI:()=>D,N$:()=>A,Vc:()=>C,XQ:()=>v,Yn:()=>O,by:()=>p,ci:()=>E,dF:()=>x,oE:()=>f,pH:()=>P,q7:()=>S,w3:()=>b});var t=e(2543),n=e.n(t),s=e(47232),a=e(48241),r=e(28240),g=e(39070),i=e(11261),l=e(33948),d=e(89667);function c(W){const U=W.columns.map(F=>{const{text:V,type:w,...z}=F,N=[];return{name:V?.length?V:F,config:z||{},values:N,type:w&&Object.values(i.PU).includes(w)?w:i.PU.other}});if(!(0,t.isArray)(W.rows))throw new Error(`Expected table rows to be array, got ${typeof W.rows}.`);for(const F of W.rows)for(let V=0;V<U.length;V++)U[V].values.push(F[V]);for(const F of U)if(F.type===i.PU.other){const V=x(F);V&&(F.type=V)}return{fields:U,refId:W.refId,meta:W.meta,name:W.name,length:W.rows.length}}function h(W){const U=[],F=[],V=W.datapoints||W.points;for(const z of V)F.push(z[0]),U.push(z[1]);const w=[{name:i.LE,type:i.PU.time,config:{},values:U},{name:i.Bc,type:i.PU.number,config:{unit:W.unit},values:F,labels:W.tags}];return W.title&&(w[1].config.displayNameFromDS=W.title),{name:W.target||W.name,refId:W.refId,meta:W.meta,fields:w,length:F.length}}function o(W){const U=[],F=[];for(let V=0;V<W.data.length;V++){const w=W.data[V];U.push(w[1]),F.push(w[0])}return{name:W.label,fields:[{name:W.label||i.Bc,type:i.PU.number,config:{},values:U},{name:i.LE,type:i.PU.time,config:{unit:"dateTimeAsIso"},values:F}],length:U.length}}function m(W){const U=[{name:W.target,type:i.PU.other,labels:W.tags,config:{unit:W.unit,filterable:W.filterable},values:[]}];for(const F of W.datapoints)U[0].values.push(F);return{name:W.target,refId:W.target,meta:{json:!0},fields:U,length:W.datapoints.length}}const u=/^\s*(-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?|NAN)\s*$/i;function p(W,U){return W&&(W=W.toLowerCase(),W==="date"||W==="time")?i.PU.time:y(U)}function f(W){return W instanceof Date||(0,s.Ar)(W)?i.PU.time:(0,t.isNumber)(W)?i.PU.number:(0,t.isString)(W)?i.PU.string:(0,t.isBoolean)(W)?i.PU.boolean:i.PU.other}function y(W){return W instanceof Date||(0,s.Ar)(W)?i.PU.time:(0,t.isNumber)(W)?i.PU.number:(0,t.isString)(W)?u.test(W)?i.PU.number:W==="true"||W==="TRUE"||W==="True"||W==="false"||W==="FALSE"||W==="False"?i.PU.boolean:i.PU.string:(0,t.isBoolean)(W)?i.PU.boolean:i.PU.other}function x(W){if(W.name){const U=W.name.toLowerCase();if(U==="date"||U==="time")return i.PU.time}for(let U=0;U<W.values.length;U++){const F=W.values[U];if(F!=null)return y(F)}}const v=(W,U=!1)=>{for(const F of W.fields)if(!F.type||F.type===i.PU.other||U)return{...W,fields:W.fields.map(V=>V.type&&V.type!==i.PU.other&&!U?V:{...V,type:x(V)||i.PU.other})};return W},P=W=>!!(W&&W.hasOwnProperty("columns")),E=W=>!!(W&&W.hasOwnProperty("fields")),D=W=>!!(E(W)&&W.hasOwnProperty("value"));function C(W){if("fields"in W)return"length"in W&&W.fields[0]?.values?.get?W:K(W);if(W.hasOwnProperty("type")&&W.type==="docs")return m(W);if(W.hasOwnProperty("datapoints")||W.hasOwnProperty("points"))return h(W);if(W.hasOwnProperty("data"))return W.hasOwnProperty("schema")?(0,d.or)(W):o(W);if(W.hasOwnProperty("columns"))return c(W);if(Array.isArray(W))return(0,l.I)(W);throw console.warn("Can not convert",W),new Error("Unsupported data format")}const b=W=>{const{fields:U}=W,F=W.length,V=[];if(U.length===2){const{timeField:w,timeIndex:z}=L(W);if(w){const H=U[z===0?1:0],Q=U[z];for(let X=0;X<F;X++)V.push([H.values[X],Q.values[X]]);return{alias:W.name,target:(0,r.Ct)(H,W),datapoints:V,unit:U[0].config?U[0].config.unit:void 0,refId:W.refId,meta:W.meta}}}for(let w=0;w<F;w++){const z=[];for(let N=0;N<U.length;N++)z.push(U[N].values[w]);V.push(z)}return W.meta&&W.meta.json?{alias:U[0].name||W.name,target:U[0].name||W.name,datapoints:U[0].values,filterable:U[0].config?U[0].config.filterable:void 0,type:"docs"}:{columns:U.map(w=>{const{name:z,config:N}=w;if(N){const{...H}=N;return H.text=z,H}return{text:z}}),type:"table",refId:W.refId,meta:W.meta,rows:V}};function T(W,U,F=!1){const V=W.fields[U];if(!V)return W;const w=[];for(let N=0;N<W.length;N++)w.push(N);const z=(0,a.i)(V,F);return w.sort(z),{...W,fields:W.fields.map(N=>{const H={...N,values:N.values.map((X,ee)=>N.values[w[ee]])},{nanos:Q}=N;return Q!==void 0&&(H.nanos=Q.map((X,ee)=>Q[w[ee]])),H})}}function S(W){return{...W,fields:W.fields.map(U=>{const F=[...U.values];F.reverse();const V={...U,values:F},{nanos:w}=U;if(w!==void 0){const z=[...w];z.reverse(),V.nanos=z}return V})}}function O(W,U){const F=[];for(const V of W.fields)F.push(V.values[U]);return F}function M(W){return I(W)}function I(W,U){return{fields:(U?W.fields.filter(U):W.fields).map(w=>{let z=w.values;return{name:w.name,type:w.type,config:w.config,values:z,labels:w.labels}}),refId:W.refId,meta:W.meta,name:W.name}}const L=W=>{for(let U=0;U<W.fields.length;U++)if(W.fields[U].type===i.PU.time)return{timeField:W.fields[U],timeIndex:U};return{}};function B(W){const U=v(C(W));if(U.fields&&U.fields.length)for(const F of U.fields)F.state=null;return U}function j(W){return!W||!(0,t.isArray)(W)?[]:W.map(U=>B(U))}function A(W,U){const{series:F,annotations:V}=W;if(W.state===g.Gu.Loading&&F.length===0)return U||(U=W),{...U,state:g.Gu.Loading,request:W.request};const w=performance.now(),z=F.map(Q=>B(Q)),N=j(V),H=performance.now();return{...W,series:z,annotations:N,timings:{dataProcessingTime:H-w}}}function K(W){let U=0;const F=W.fields.map((V,w)=>{const{state:z,...N}=V;return N.name||(N.name=`Field ${w+1}`),N.config||(N.config={}),N.values?N.values.length>U&&(U=N.values.length):N.values=new Array(U),N.type||(N.type=x(N)??i.PU.other),N});return{...W,fields:F,length:U}}},19845:(G,R,e)=>{"use strict";e.d(R,{S1:()=>l,aH:()=>a,hF:()=>g,jq:()=>r,t9:()=>d,tP:()=>i,uY:()=>c});var t=e(11261),n=e(14236);const s=100;function a(h){if(h.fields.length<2)return!1;const o=h.fields.find(u=>u.type===t.PU.number);let m=!1;for(const u of h.fields)if(g(u)){m=!0;break}return m&&o!==void 0}function r(h){return!h.find(o=>!a(o))}function g(h){if(h.type!==t.PU.time)return!1;let o=null,m=h.values.length>s?s:h.values.length;for(let u=0;u<m;u++){const p=h.values[u];if(o===null||p!==null&&p>o)o=p;else return!1}return!0}function i(h){for(let o=0;o<h.length;o++){const m=(0,n.KR)(h[o]);if(m.timeField!==void 0&&m.timeIndex!==void 0)return!0}return!1}function l(h){return h.fields.some(o=>o.type===t.PU.time)}function d(h,o){if(h.meta?.uniqueRowIdFields!==void 0)return h.meta.uniqueRowIdFields.map(m=>h.fields[m].values[o]).join("-")}function c(h,o){if(o instanceof Array)for(let m=0;m<o.length;m++)h.fields[m].values.push(o[m]);else for(const m of h.fields)m.values.push(o[m.name]);try{h.length++}catch{}}},70416:(G,R,e)=>{"use strict";e.d(R,{E9:()=>g,Ri:()=>i,V3:()=>o,WT:()=>l,dU:()=>r,di:()=>c,pp:()=>h,vd:()=>d});var t=e(89369),n=e(68284),s=e(25579);const a={years:["y","Y","years"],months:["M","months"],weeks:["w","W","weeks"],days:["d","D","days"],hours:["h","H","hours"],minutes:["m","minutes"],seconds:["s","S","seconds"]};function r(u,p=!0){if((0,t.d)(u.start,u.end))return"";const f=(0,n.F)(u);return Object.entries(f).reduce((y,[x,v])=>v&&v!==0&&!(x==="seconds"&&!p&&y)?y+`${y!==""?" ":""}${v}${a[x][0]}`:y,"")}function g(u){return u.split(" ").reduce((p,f)=>{const y=f.match(/(\d+)(.+)/),x=y?.[1],v=y?.[2];if(!(x&&v))return p;const P=Object.entries(a).find(([D,C])=>C?.includes(y[2])),E=parseInt(x,10);return P?{...p,[P[0]]:E}:p},{})}function i(u,p){return(0,s.W)(u,p)}function l(u){const p=new Date;return i(p,u).getTime()-p.getTime()}function d(u){return!isNaN(Date.parse(u))}function c(u){for(const p of u.trim().split(" ")){const f=p.match(/(\d+)(.+)/);if(f===null||f.length!==3||!Object.entries(a).find(([x,v])=>v?.includes(f[2]))?.[0])return!1}return!0}function h(u){return m(u,["h","m","s","ms","us","\xB5s","ns"])}function o(u){return m(u,["y","M","w","d","h","m","s","ms","us","\xB5s","ns"])}function m(u,p){for(const f of u.trim().split(" ")){const y=f.match(/([0-9]*[.]?[0-9]+)(.+)/);if(y===null||y.length!==3||!p.includes(y[2]))return!1}return!0}},91410:(G,R,e)=>{"use strict";e.d(R,{HD:()=>l,P3:()=>c,QZ:()=>d,U3:()=>h,g$:()=>g,le:()=>i});var t=e(2543),n=e.n(t),s=e(84743),a=e.n(s),r=e(1933),g=(y=>(y.default="",y.localBrowserTime="browser",y.utc="utc",y))(g||{});const i=y=>{switch((0,r.O)({timeZone:y})){case"browser":return"Local browser time";case"utc":return"UTC";default:return y}},l=y=>a().tz.zone(y),d=(y,x)=>{const v=o(y,x);return v||u(y,x)},c=(0,t.memoize)((y=!1)=>{const x=[];return y===!0?x.push("","browser","utc"):y&&x.push(...y),a().tz.names().reduce((v,P)=>{const E=f[P];return!Array.isArray(E)||E.length===0||v.push(P),v},x)}),h=(0,t.memoize)((y=!1)=>{const v=c(y).reduce((P,E)=>{const D=E.indexOf("/");if(D===-1){const b="";return P[b]=P[b]??[],P[b].push(E),P}const C=E.slice(0,D);return P[C]=P[C]??[],P[C].push(E),P},{});return Object.keys(v).map(P=>({name:P,zones:v[P]}))}),o=(y,x)=>{switch(y){case"utc":return{name:"Coordinated Universal Time",ianaName:"UTC",zone:y,countries:[],abbreviation:"UTC, GMT",offsetInMins:0};case"":{const v=(0,r.O)(),E=v==="browser"||v==="utc"?o(v,x):u(v,x);return{countries:f[v]??[],abbreviation:"",offsetInMins:0,...E,ianaName:E?.ianaName??"",name:"Default",zone:y}}case"browser":{const v=a().tz.guess(!0),P=u(v,x);return{countries:f[v]??[],abbreviation:"Your local time",offsetInMins:new Date().getTimezoneOffset(),...P,name:"Browser Time",ianaName:P?.ianaName??"",zone:y}}default:return}},m=y=>/^(\+|\-).+/.test(y)?"":y,u=(y,x)=>{const v=a().tz.zone(y);if(v)return{name:y,ianaName:v.name,zone:y,countries:f[y]??[],abbreviation:m(v.abbr(x)),offsetInMins:v.utcOffset(x)}},p={AF:"Afghanistan",AX:"Aland Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua And Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:"Bosnia And Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, Democratic Republic",CK:"Cook Islands",CR:"Costa Rica",CI:"Cote D'Ivoire",HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island & Mcdonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran (Islamic Republic Of)",IQ:"Iraq",IE:"Ireland",IM:"Isle Of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KR:"Korea",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libyan Arab Jamahiriya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia (Federated States Of)",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestine, State of",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Reunion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",BL:"Saint Barthelemy",SH:"Saint Helena",KN:"Saint Kitts And Nevis",LC:"Saint Lucia",MF:"Saint Martin",PM:"Saint Pierre And Miquelon",VC:"Saint Vincent And Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome And Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia And Sandwich Isl.",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard And Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad And Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks And Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis And Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"},f=a().tz.countries().reduce((y,x)=>a().tz.zonesForCountry(x).reduce((P,E)=>{P[E]||(P[E]=[]);const D=p[x];return D&&P[E].push({code:x,name:D}),P},y),{})},69129:(G,R,e)=>{"use strict";e.d(R,{LL:()=>d,LO:()=>a,NI:()=>l,Tp:()=>c,We:()=>r,b_:()=>n,gc:()=>g,ql:()=>s,wE:()=>i});var t=e(65463);class n extends t.x{static{this.type="data-hover"}}class s extends t.a{static{this.type="data-hover-clear"}}class a extends t.x{static{this.type="data-select"}}class r extends t.x{static{this.type="annotation-event"}}class g extends t.x{static{this.type="dashboard-loaded"}}class i extends t.a{static{this.type="datasource-updated-successfully"}}class l extends t.a{static{this.type="datasource-test-succeeded"}}class d extends t.a{static{this.type="datasource-test-failed"}}class c extends t.x{static{this.type="set-panel-attention"}}},66670:(G,R,e)=>{"use strict";e.d(R,{K:()=>n});var t=e(83077);class n extends t.O{}},57875:(G,R,e)=>{"use strict";e.d(R,{H:()=>u,J:()=>o});var t=e(2543),n=e.n(t),s=e(14236),a=e(47232),r=e(53531),g=e(11261),i=e(28802),l=e(62398),d=e(83195),c=e(58563);const h={dateTimeAsIso:!0,dateTimeAsIsoNoDateIfToday:!0,dateTimeAsUS:!0,dateTimeAsUSNoDateIfToday:!0,dateTimeAsLocal:!0,dateTimeAsLocalNoDateIfToday:!0,dateTimeFromNow:!0};function o(f){if(!f||(0,t.isEmpty)(f)||!f.field)return m;const y=f.field,x=y.config??{},{palette:v}=f.theme.visualization;let P=x.unit,E=P&&(h[P]||P.startsWith("time:")),D=!1;if(y.type===g.PU.time&&!E){if(P="dateTimeAsSystem",E=!0,y.values&&y.values.length>1){let L=y.values[0],B=y.values[y.values.length-1];typeof L=="string"?(L=(0,r.b)(L).unix(),B=(0,r.b)(B).unix()):(L/=1e3,B/=1e3),D=Math.abs(B-L)<60}}else y.type===g.PU.boolean?(0,d.j9)(P)||(P="bool"):!P&&y.type===g.PU.string&&(P="string");const C=P?.startsWith("currency"),b=(0,d.j9)(P),T=y.type===g.PU.number,O=!E&&!C&&!b&&!(P==="locale")&&T&&x.decimals==null,M=(0,d.j_)(P||"none"),I=(0,c.jc)(y,f.theme);return(L,B)=>{const{mappings:j}=x,A=P==="string";E&&typeof L=="string"&&(L=(0,a.yT)(L).valueOf());let K=A?NaN:(0,i.t)(L),W,U,F,V,w,z;if(j&&j.length>0){const H=(0,l.Zz)(j,L);H&&(H.text!=null&&(W=H.text),H.color!=null&&(V=f.theme.visualization.getColorByName(H.color)),H.icon!=null&&(w=H.icon))}else if(y.type===g.PU.enum){if(L==null)return{text:"",numeric:NaN};const H=+L;if(x&&x.type&&x.type.enum){const{text:Q,color:X}=x.type.enum;if(W=Q?Q[H]:`${L}`,V=X?X[H]:void 0,V==null){const ee=v[H%v.length];V=f.theme.visualization.getColorByName(ee)}}}if(!Number.isNaN(K)){if(W==null&&!(0,t.isBoolean)(L)){let H;O&&B!=null?(H=M(K,B,null,f.timeZone,D),H.text=+H.text+""):H=M(K,x.decimals,null,f.timeZone,D),W=H.text,F=H.suffix,U=H.prefix}if(V==null){const H=I(K);V=H.color,z=H.percent}}if(W==null&&(0,t.isArray)(L)&&(W=(0,t.join)(L,", ")),W==null&&(W=(0,t.toString)(L),W||(x.noValue?W=x.noValue:W="")),!V){const H=I(-1/0);V=H.color,z=H.percent}const N={text:W,numeric:K,prefix:U,suffix:F,color:V};return w!=null&&(N.icon=w),z!=null&&(N.percent=z),N}}function m(f){return{text:(0,t.toString)(f),numeric:(0,i.t)(f)}}function u(){return f=>({text:(0,s.oE)(f)==="other"?`${JSON.stringify(f,p())}`:`${f}`,numeric:null})}const p=()=>{const f=new WeakSet;return(y,x)=>{if(typeof x=="object"&&x!==null){if(f.has(x))return;f.add(x)}return x}}},8066:(G,R,e)=>{"use strict";e.d(R,{Hs:()=>u,Qi:()=>m,lz:()=>p,uf:()=>h});var t=e(21197),n=e(55459),s=e.n(n),a=e(84140),r=e(23596),g=e(75059),i=e(24293),l=e(83077),d=e(58563),c=e(47737);const h=new l.O(()=>[{id:i.Y.Fixed,name:"Single color",description:"Set a specific color",getCalculator:f},{id:i.Y.Shades,name:"Shades of a color",description:"Select shades of a specific color",getCalculator:y},{id:i.Y.Thresholds,name:"From thresholds",isByValue:!0,description:"Derive colors from thresholds",getCalculator:(x,v)=>(P,E,D)=>{const C=D??c.QS;return v.visualization.getColorByName(C.color)}},new o({id:i.Y.PaletteClassic,name:"Classic palette",isContinuous:!1,isByValue:!1,getColors:x=>x.visualization.palette}),new o({id:i.Y.PaletteClassicByName,name:"Classic palette (by series name)",isContinuous:!1,isByValue:!1,useSeriesName:!0,getColors:x=>x.visualization.palette.filter(v=>(0,r.eM)(x.visualization.getColorByName(v),x.colors.background.primary)>=x.colors.contrastThreshold)}),new o({id:i.Y.ContinuousGrYlRd,name:"Green-Yellow-Red",isContinuous:!0,isByValue:!0,getColors:x=>["green","yellow","red"]}),new o({id:i.Y.ContinuousRdYlGr,name:"Red-Yellow-Green",isContinuous:!0,isByValue:!0,getColors:x=>["red","yellow","green"]}),new o({id:i.Y.ContinuousBlYlRd,name:"Blue-Yellow-Red",isContinuous:!0,isByValue:!0,getColors:x=>["dark-blue","super-light-yellow","dark-red"]}),new o({id:i.Y.ContinuousYlRd,name:"Yellow-Red",isContinuous:!0,isByValue:!0,getColors:x=>["super-light-yellow","dark-red"]}),new o({id:i.Y.ContinuousBlPu,name:"Blue-Purple",isContinuous:!0,isByValue:!0,getColors:x=>["blue","purple"]}),new o({id:i.Y.ContinuousYlBl,name:"Yellow-Blue",isContinuous:!0,isByValue:!0,getColors:x=>["super-light-yellow","dark-blue"]}),new o({id:i.Y.ContinuousBlues,name:"Blues",isContinuous:!0,isByValue:!0,getColors:x=>["panel-bg","dark-blue"]}),new o({id:i.Y.ContinuousReds,name:"Reds",isContinuous:!0,isByValue:!0,getColors:x=>["panel-bg","dark-red"]}),new o({id:i.Y.ContinuousGreens,name:"Greens",isContinuous:!0,isByValue:!0,getColors:x=>["panel-bg","dark-green"]}),new o({id:i.Y.ContinuousPurples,name:"Purples",isContinuous:!0,isByValue:!0,getColors:x=>["panel-bg","dark-purple"]})]);class o{constructor(v){this.id=v.id,this.name=v.name,this.description=v.description,this.getNamedColors=v.getColors,this.isContinuous=v.isContinuous,this.isByValue=v.isByValue,this.useSeriesName=v.useSeriesName}getColors(v){return this.getNamedColors?this.colorCache&&this.colorCacheTheme===v?this.colorCache:(this.colorCache=this.getNamedColors(v).map(v.visualization.getColorByName),this.colorCacheTheme=v,this.colorCache):[]}getInterpolator(){return this.interpolator||(this.interpolator=(0,t.Ik)(this.colorCache)),this.interpolator}getCalculator(v,P){const E=this.getColors(P);return this.isByValue?this.isContinuous?(D,C,b)=>this.getInterpolator()(C):(D,C,b)=>E[C*(E.length-1)]:this.useSeriesName?(D,C,b)=>E[Math.abs(s()(v.state?.displayName??v.name))%E.length]:(D,C,b)=>{const T=v.state?.seriesIndex??0;return E[T%E.length]}}}function m(x){return h.get(x.config.color?.mode??i.Y.Thresholds)}function u(x){return h.get(x??i.Y.Thresholds)}function p(x,v){const P=m(x);if(!P.isByValue)return{color:P.getCalculator(x,v)(0,0),threshold:c.QS,percent:1};const E=(0,d.jc)(x,v),D=x.config.color?.seriesBy??"last",b=(0,g.Nw)({field:x,reducers:[D]})[D]??0;return E(b)}function f(x,v){return()=>v.visualization.getColorByName(x.config.color?.fixedColor??i.F)}function y(x,v){return()=>{const P=v.visualization.getColorByName(x.config.color?.fixedColor??i.F),E=[P],D=6,C=10,b=35,T=35;for(let O=1;O<D;O++)E.push((0,a.A)(P).spin(O/D*C).brighten(O/D*b).toHexString()),E.push((0,a.A)(P).spin(-(O/D)*C).darken(O/D*T).toHexString());const S=x.state?.seriesIndex??0;return E[S%E.length]}}},56323:(G,R,e)=>{"use strict";e.d(R,{PI:()=>y,Pm:()=>f,XS:()=>D,Zo:()=>T,a_:()=>p,eG:()=>E,k3:()=>h,k_:()=>u,nF:()=>m,py:()=>o});var t=e(2543),n=e.n(t),s=e(78368),a=e(14236),r=e(75059),g=e(85200),i=e(1173),l=e(11261),d=e(57875),c=e(28240);const h="__series.name",o="__field.displayName",m="__field.labels",u="__calc",p="__cell_",f=25,y=O=>{const{replaceVariables:M,reduceOptions:I,timeZone:L,theme:B}=O,j=I.calcs.length?I.calcs:[r.gy.last],A=[],K=(0,g.NS)(I.fields?{id:i.Ct.byRegexp,options:I.fields}:{id:i.Ct.numeric}),W=O.data??[],U=I.limit?I.limit:f;let F=!1;for(let V=0;V<W.length&&!F;V++){const w=W[V],{timeField:z}=(0,a.KR)(w),N=new s.R(w);for(let H=0;H<w.fields.length&&!F;H++){const Q=w.fields[H],X=Q.getLinks;if(!K(Q,w,W))continue;let ee=Q.config;Q.state?.range&&(ee={...ee,...Q.state?.range});let Z=Q.config.displayName??"";const q=Q.display??(0,d.J)({field:Q,theme:O.theme,timeZone:L});if(I.values)for(let ae=0;ae<Q.values.length;ae++){Q.state=v(Q,A.length);const k=S(Q,ae),se=q(Q.values[ae]),te=x(w,Q,ae,M,k),ne=P(te,O.fieldConfig,B);if(A.push({name:"",field:ee,display:{...se,title:te,color:ne??se.color},view:N,colIndex:H,rowIndex:ae,getLinks:X?()=>X({valueRowIndex:ae}):()=>[],hasLinks:E(Q)}),A.length>=U){F=!0;break}}else{const ae=(0,r.Nw)({field:Q,reducers:j});for(const k of j){const se=Q.state?.scopedVars??{};se[u]={value:k,text:k};const te=q(ae[k]);Z!==""?te.title=M(Z,se):te.title=(0,c.Ct)(Q,w,W),te.percentChange=O.percentChange?(0,r.Nw)({field:Q,reducers:[r.gy.diffperc]}).diffperc:void 0;let ne;O.sparkline&&(ne={y:w.fields[H],x:z},k===r.gy.last?ne.highlightIndex=ne.y.values.length-1:k===r.gy.first&&(ne.highlightIndex=0));const le=w.length===1?0:void 0;A.push({name:k,field:ee,display:te,sparkline:ne,view:N,colIndex:H,getLinks:X?()=>X({calculatedValue:te,valueRowIndex:le}):()=>[],hasLinks:E(Q)})}}}}return A.length===0&&A.push(C(O)),A};function x(O,M,I,L,B){const j=M.config.displayName;if(j)return j.indexOf(p)?L(T(j),B):L(j,B);let A=[],K=0;for(const W of O.fields)if(W!==M)if(W.type===l.PU.string){const U=W.values[I]??"",F=W.display?W.display(U).text:U;F.length>0&&A.push(F)}else W.type===l.PU.number&&K++;return(K||A.length===0)&&A.push((0,c.Ct)(M,O)),A.join(" ")}function v(O,M){return{...O.state,seriesIndex:M}}function P(O,M,I){for(const L of M.overrides)if(L.matcher.id==="byName"&&L.matcher.options===O){for(const B of L.properties)if(B.id==="color"&&B.value)return I.visualization.getColorByName(B.value.fixedColor)}return null}function E(O){return O.config?.links?.length?O.config.links.length>0:!1}function D(O){let M="",I="",L="",B="";for(let j=0;j<O.length;j++){const A=O[j].display;A.text&&A.text.length>I.length&&(I=A.text),A.title&&A.title.length>M.length&&(M=A.title),A.prefix&&A.prefix.length>L.length&&(L=A.prefix),A.suffix&&A.suffix.length>B.length&&(B=A.suffix)}return{text:I,title:M,suffix:B,prefix:L}}function C(O){const M="No data",{fieldConfig:I,timeZone:L}=O,{defaults:B}=I,A=(0,d.J)({field:{type:l.PU.other,config:B},theme:O.theme,timeZone:L})(null),K=b(A,M);return{name:M,field:{...B,max:B.max??0,min:B.min??0},display:{text:K,numeric:0,color:A.color},hasLinks:!1}}function b(O,M){return!O||(0,t.isEmpty)(O.text)?M:O.text}function T(O){return O.replace(/\${__cell_(\d+)(.*?)}|\[\[__cell_(\d+)(.*?)\]\]|\$__cell_(\d+)(\S*)/g,(M,I,L,B,j,A,K)=>`\${__data.fields[${I??B??A}]${L??j??K}}`)}function S(O,M){return O.state?.scopedVars?.__dataContext?{...O.state?.scopedVars,__dataContext:{value:{...O.state?.scopedVars?.__dataContext.value,rowIndex:M}}}:O.state?.scopedVars}},90708:(G,R,e)=>{"use strict";e.d(R,{BF:()=>T,K3:()=>M,_M:()=>O,nJ:()=>x,rJ:()=>I,vd:()=>L,we:()=>v});var t=e(2543),n=e.n(t),s=e(96540),a=e(80292),r=e(52622),g=e(21423),i=e(14236),l=e(23596),d=e(75059),c=e(85200),h=e(11261),o=e(24293),m=e(6709),u=e(71733),p=e(57875),f=e(58563),y=e(69550);function x(B){let j=null,A=null;const K=[d.gy.min,d.gy.max];for(const W of B)for(const U of W.fields)if(U.type===h.PU.number){const F=(0,d.Nw)({field:U,reducers:K}),V=F[d.gy.min],w=F[d.gy.max];(j===null||V<j)&&(j=V),(A===null||w>A)&&(A=w)}return{min:j,max:A,delta:(A??0)-(j??0)}}function v(B){if(!B.data)return[];const j=B.fieldConfig;if(!j)return B.data;const A=B.fieldConfigRegistry??y.G;let K=0,W;const U=[];if(j.overrides)for(const F of j.overrides){const V=c.sJ.get(F.matcher.id);V&&U.push({match:V.get(F.matcher.options),properties:F.properties})}return B.data.map((F,V)=>{const w={...F};w.fields=w.fields.map(z=>({...z,config:(0,t.cloneDeep)(z.config),state:{...z.state}}));for(const z of w.fields){const N=z.config;z.state.scopedVars={__dataContext:{value:{data:B.data,frame:w,frameIndex:V,field:z}}};const H={field:z,data:B.data,dataFrameIndex:V,replaceVariables:B.replaceVariables,fieldConfigRegistry:A};C(N,j.defaults,H);for(const Z of U)if(Z.match(z,w,B.data))for(const q of Z.properties)D(N,q,H);let Q=z.type;if(!Q||Q===h.PU.other){const Z=(0,i.dF)(z);Z&&(Q=Z)}const{range:X,newGlobalRange:ee}=P(N,z,W,B.data);if(W=ee,z.state.displayName=null,z.state.seriesIndex=K,z.state.range=X,z.type=Q,z.type!==h.PU.time&&K++,z.display=(0,p.J)({field:z,theme:B.theme,timeZone:B.timeZone}),z.config.unit!=="dateTimeFromNow"&&(z.display=E(z.display,2500)),z.getLinks=O(w,z,z.state.scopedVars,H.replaceVariables,B.timeZone,B.dataLinkPostProcessor),z.type===h.PU.nestedFrames)for(const Z of z.values)for(let q=0;q<Z.length;q++)for(const ae of Z[q].fields)ae.display=(0,p.J)({field:ae,theme:B.theme,timeZone:B.timeZone}),ae.state={scopedVars:{__dataContext:{value:{data:Z,frame:Z[q],frameIndex:q,field:ae}}}},ae.getLinks=O(Z[q],ae,ae.state.scopedVars,H.replaceVariables,B.timeZone,B.dataLinkPostProcessor)}return w})}function P(B,j,A,K){if(j.type!==h.PU.number||(0,t.isNumber)(B.min)&&(0,t.isNumber)(B.max))return{newGlobalRange:A};if(B.fieldMinMax){const V=(0,f.AP)(j),w=B.min??V.min,z=B.max??V.max;return{range:{min:w,max:z,delta:z-w},newGlobalRange:A}}const W=A??x(K),U=B.min??W.min,F=B.max??W.max;return{range:{min:U,max:F,delta:F-U},newGlobalRange:W}}function E(B,j=2500){const A=new Map;for(let K=-1;K<=15;K++)A.set(K,new Map);return(K,W)=>{let U=A.get(W??-1),F=U.get(K);return F||(U.size===j&&U.clear(),F=B(K,W),F.color&&(F.color=(0,l.ze)(F.color)),U.set(K,F)),F}}function D(B,j,A){const W=A.fieldConfigRegistry.getIfExists(j.id);if(!W)return;const U=W.process(j.value,A,W.settings);U==null?W.isCustom&&B.custom?(0,t.unset)(B.custom,W.path):(0,t.unset)(B,W.path):W.isCustom?(B.custom||(B.custom={}),(0,t.set)(B.custom,W.path,U)):(0,t.set)(B,W.path,U)}function C(B,j,A){B.links&&j.links&&(B.links=[...B.links,...j.links]);for(const K of A.fieldConfigRegistry.list())K.isCustom&&!B.custom&&(B.custom={}),b(K.isCustom?B.custom:B,K.isCustom?j.custom:j,K,A);T(B)}function b(B,j,A,K){const W=(0,t.get)(B,A.path);if(W==null){const U=K.fieldConfigRegistry.getIfExists(A.id);if(!U)return;if(U&&U.shouldApply(K.field)){const F=U.process((0,t.get)(j,U.path),K,U.settings);F!=null&&(0,t.set)(B,U.path,F)}}}function T(B){const{thresholds:j}=B;if(B.color?B.color.mode||delete B.color:j&&(B.color={mode:o.Y.Thresholds}),B.hasOwnProperty("min")&&B.hasOwnProperty("max")&&B.min>B.max){const A=B.max;B.max=B.min,B.min=A}}const S=B=>{const{link:j,linkModel:A,dataLinkScopedVars:K,field:W,replaceVariables:U}=B;return j.internal?(0,m.u)({link:j,internalLink:j.internal,scopedVars:K,field:W,range:j.internal.range,replaceVariables:U}):A},O=(B,j,A,K,W,U)=>F=>!j.config.links||j.config.links.length===0?[]:j.config.links.map(w=>{const z=L(B,j,A),N={...A,__dataContext:z},H=(ee,Z,q)=>K(ee,{...N,...Z},q);F.valueRowIndex!==void 0&&!isNaN(F.valueRowIndex)?z.value.rowIndex=F.valueRowIndex:z.value.calculatedValue=F.calculatedValue;let Q,X=w.onClick||!w.onBuildUrl?w.url:w.onBuildUrl({origin:j,replaceVariables:H});return X&&(X=u.I.assureBaseUrl(X.replace(/\n/g,"")),X=K(X,N,r.$m.UriEncode),X=u.I.processUrl(X)),w.onClick?Q={href:X,title:K(w.title||"",N),target:w.targetBlank?"_blank":void 0,onClick:(ee,Z)=>{w.onClick({origin:Z??j,e:ee,replaceVariables:H})},origin:j}:Q={href:X,title:K(w.title||"",N),target:w.targetBlank?"_blank":void 0,origin:j},(U||S)({frame:B,field:j,dataLinkScopedVars:N,replaceVariables:K,config:F,link:w,linkModel:Q})}).filter(w=>!!w);function M(B){if(!B||B.length===0)return[];const j=[...B],A=(0,p.H)();for(let K=0;K<j.length;K++){const W={...j[K]},U=[...W.fields];for(let F=0;F<U.length;F++)U[F]={...U[F],display:A};j[K]={...W,fields:U}}return j}function I(B,j,A,K,W,U,F){const V=B?.fieldConfigRegistry,w=(0,s.useRef)(0),z=(0,a.A)(A?.series);return(0,s.useMemo)(()=>{if(!V||!j||!A)return;const N=A?.series;A.structureRev==null&&N&&z&&!(0,g.J3)(N,z,g.bW)&&w.current++;const H={structureRev:w.current,...A,series:v({data:N,fieldConfig:j,fieldConfigRegistry:V,replaceVariables:U,theme:W,timeZone:K,dataLinkPostProcessor:F})};return A.annotations&&A.annotations.length>0&&(H.annotations=v({data:A.annotations,fieldConfig:{defaults:{},overrides:[]},replaceVariables:U,theme:W,timeZone:K,dataLinkPostProcessor:F})),H},[V,j,A,z,K,W,U,F])}function L(B,j,A){return A?.__dataContext?{value:{...A.__dataContext.value}}:{value:{frame:B,field:j,data:[B]}}}},28240:(G,R,e)=>{"use strict";e.d(R,{Ct:()=>i,Fm:()=>r,Ri:()=>a,fk:()=>d,j2:()=>g});var t=e(85200),n=e(11261),s=e(8249);function a(h,o){if(h.name)return h.name;const m=[];for(const u of h.fields)if(u.type!==n.PU.time){if(m.length>1)break;m.push(i(u,h))}return m.length===1?m[0]:o===void 0&&h.fields.length>0?h.fields.filter(u=>u.type!==n.PU.time).map(u=>i(u,h)).join(", "):h.refId?`Series (${h.refId})`:`Series (${o})`}function r(h){h.forEach(o=>{o.fields.forEach(m=>{i(m,o,h)})})}function g(h,o){h.forEach(m=>{m.fields.forEach(u=>{const p={legend:!1,tooltip:!1,viz:!1,...o.defaults.custom?.hideFrom},f=u.config.custom?.hideFrom;o.overrides.forEach(y=>{if("__systemRef"in y)return;if((0,t.NS)(y.matcher)(u,m,h))for(const v of y.properties)v.id==="custom.hideFrom"&&Object.assign(p,v.value)}),u.state={...u.state,hideFrom:{...f}},u.config.custom.hideFrom=p})})}function i(h,o,m){const u=h.state?.displayName,p=!!(m&&m.length>1);if(u&&p===h.state?.multipleFrames)return u;const f=l(h,o,m);return h.state=h.state||{},h.state.displayName=f,h.state.multipleFrames=p,f}function l(h,o,m){const u=h.config?.displayName&&h.config?.displayName.length,p=!!o?.meta?.timeCompare?.isTimeShiftQuery;let f=u?h.config.displayName:h.name;if(u)return p?`${f} (comparison)`:f;if(o&&h.config?.displayNameFromDS)return p?`${h.config.displayNameFromDS} (comparison)`:h.config.displayNameFromDS;if(h.type===n.PU.time&&!h.labels)return f??n.LE;let y=[],x=!1;if(m&&m.length>1){for(let E=1;E<m.length;E++)if(m[E].name!==m[E-1].name){x=!0;break}}let v=!1,P=!1;if(x&&o?.name&&(y.push(o.name),v=!0),h.name&&h.name!==n.Bc&&y.push(h.name),h.labels&&o){let E=c(m??[o]);if(E)h.labels[E]&&(y.push(h.labels[E]),P=!0);else{let D=(0,s.h6)(h.labels);D&&(y.push(D),P=!0)}}return o&&!v&&!P&&h.name===n.Bc&&o.name&&o.name.length>0&&(y.push(o.name),v=!0),y.length?f=y.join(" "):h.name?f=h.name:f=n.Bc,f===h.name&&(f=d(h,o)),p&&(f=`${f} (comparison)`),f}function d(h,o){let m=0,u=!1;if(o)for(let p=0;p<o.fields.length;p++){const f=o.fields[p];if(h===f){if(u=!0,m>0){m++;break}}else if(h.name===f.name&&(m++,u))break}return m?`${h.name} ${m}`:h.name}function c(h){let o=null;for(let m=0;m<h.length;m++){const u=h[m];for(const p of u.fields)if(p.labels){for(const f in p.labels)if(o===null)o=f;else if(f!==o)return null}}return o}},92461:(G,R,e)=>{"use strict";e.d(R,{F:()=>r});var t=e(2543),n=e.n(t),s=e(83195),a=e(57875);function r(g){return new Proxy({},{get:(i,l)=>{let d=g.frame.fields.find(m=>l===m.name);if(!d){const m=(0,t.toNumber)(l);d=g.frame.fields[m]}if(d||(d=g.frame.fields.find(m=>l===m.config.displayName)),d||(d=g.frame.fields.find(m=>m.labels?l===m.labels.name:!1)),!d)return;const c=d.display??(0,a.J)(),h=d.values[g.rowIndex],o=c(h);return o.toString=()=>(0,s.cN)(o),o}})}},27310:(G,R,e)=>{"use strict";e.d(R,{AM:()=>s,Ch:()=>a,FM:()=>h,N7:()=>d,OU:()=>l,X4:()=>o,cz:()=>r,hL:()=>i,hS:()=>t,lG:()=>c,m0:()=>n,xT:()=>g});const t=m=>m,n=(m,u,p)=>{if(m!=null)return parseFloat(String(m))},s=(m,u,p)=>(delete u.field?.state?.displayName,l(m,u,p)),a=(m,u,p)=>m,r=(m,u,p)=>m,g=(m,u,p)=>m,i=(m,u,p)=>m,l=(m,u,p)=>m==null?m:p&&p.expandTemplateVars&&u.replaceVariables&&typeof m=="string"?u.replaceVariables(m,u.field.state.scopedVars):`${m}`,d=(m,u,p)=>m,c=(m,u,p)=>m,h=(m,u,p)=>m;var o=(m=>(m.IncludeAll="all",m.ExcludeBaseNames="exclude",m.OnlyBaseNames="only",m))(o||{})},58563:(G,R,e)=>{"use strict";e.d(R,{AP:()=>d,jc:()=>i,xg:()=>c});var t=e(2543),n=e.n(t),s=e(75059),a=e(11261),r=e(8066),g=e(47737);function i(h,o){if(h.type===a.PU.boolean)return l(h,o);const u=(0,r.Qi)(h).getCalculator(h,o),p=h.state?.range??d(h);return f=>{let y=0;f!==-1/0&&(y=(f-p.min)/p.delta,Number.isNaN(y)&&(y=0));const x=(0,g.k5)(h,f,y);return{percent:y,threshold:x,color:u(f,y,x)}}}function l(h,o){const m={color:o.visualization.getColorByName("green"),percent:1,threshold:void 0},u={color:o.visualization.getColorByName("red"),percent:0,threshold:void 0},p=(0,r.Qi)(h);if(p.isContinuous&&p.getColors){const f=p.getColors(o);m.color=f[f.length-1],u.color=f[0]}return f=>f?m:u}function d(h){if(h.type!==a.PU.number)return{min:0,max:100,delta:100};let o=h.config.min,m=h.config.max;if(!(0,t.isNumber)(o)||!(0,t.isNumber)(m))if(h.values&&h.values.length){const u=(0,s.Nw)({field:h,reducers:[s.gy.min,s.gy.max]});(0,t.isNumber)(o)||(o=u[s.gy.min]),(0,t.isNumber)(m)||(m=u[s.gy.max])}else o=0,m=100;return{min:o,max:m,delta:m-o}}function c(h,o){const{config:m}=h;let{min:u,max:p}=m;return(0,t.isNumber)(u)&&(0,t.isNumber)(p)?m:o||!h.state?.range?{...m,...d(h)}:{...m,...h.state.range}}},69550:(G,R,e)=>{"use strict";e.d(R,{D:()=>a,G:()=>s});var t=e(83077),n=e(66670);const s=new n.K,a=new t.O},47737:(G,R,e)=>{"use strict";e.d(R,{QS:()=>s,RU:()=>g,k5:()=>r,yQ:()=>a});var t=e(24293),n=e(50082);const s={value:0,color:t.F};function a(i,l){if(!l||l.length===0)return s;let d=l[0];for(const c of l)if(i>=c.value)d=c;else break;return d}function r(i,l,d){const{thresholds:c}=i.config;return c?.mode===n.O.Percentage?a(d*100,c?.steps):a(l,c?.steps)}function g(i){return i.sort((l,d)=>l.value-d.value)}},33459:(G,R,e)=>{"use strict";e.r(R),e.d(R,{AbstractLabelOperator:()=>Yt.D_,AlertState:()=>Ye.O,AnnotationChangeEvent:()=>E.We,AnnotationEventFieldSource:()=>mt.V,AppEvents:()=>Je.r1,AppPlugin:()=>Ms.hX,ArrayDataFrame:()=>d.f,ArrayVector:()=>Sn,BinaryOperationID:()=>oe.k,BusEventBase:()=>v.a,BusEventWithPayload:()=>v.x,ByNamesMatcherMode:()=>we.PP,CSVHeaderStyle:()=>k.F7,CSVReader:()=>k.i8,CircularDataFrame:()=>es.x,CircularVector:()=>Ut.$,CoreApp:()=>Ms.Jk,CustomVariableSupport:()=>Ge.f5,DEFAULT_FIELD_DISPLAY_VALUES_LIMIT:()=>I.Pm,DEFAULT_SAML_NAME:()=>xn.En,DashboardCursorSync:()=>on.y,DashboardLoadedEvent:()=>E.gc,DataFrameType:()=>yn.m,DataFrameView:()=>n.R,DataHoverClearEvent:()=>E.ql,DataHoverEvent:()=>E.b_,DataLinkBuiltInVars:()=>F.c,DataLinkConfigOrigin:()=>ln.x0,DataQueryErrorType:()=>ds.v2,DataSelectEvent:()=>E.LO,DataSourceApi:()=>ds.mA,DataSourcePlugin:()=>ds.tD,DataSourcePluginContextProvider:()=>ht.p,DataSourceTestFailed:()=>E.LL,DataSourceTestSucceeded:()=>E.NI,DataSourceUpdatedSuccessfully:()=>E.wE,DataSourceVariableSupport:()=>Ge.ZV,DataTopic:()=>m.QR,DataTransformerID:()=>Ve.F,DefaultTimeZone:()=>Ln.lE,DocsId:()=>V.f,EventBusSrv:()=>P.o,ExploreMode:()=>ds.ZF,FALLBACK_COLOR:()=>zt.F,FeatureState:()=>Ms.Ay,FieldCache:()=>s.L,FieldColorModeId:()=>zt.Y,FieldConfigEditorBuilder:()=>A.bk,FieldConfigOptionsRegistry:()=>C.K,FieldConfigProperty:()=>gs.uo,FieldMatcherID:()=>Me.Ct,FieldNamePickerBaseNameMode:()=>j.X4,FieldType:()=>wn.PU,FrameGeometrySourceMode:()=>m.aG,FrameMatcherID:()=>Me.jR,GAUGE_DEFAULT_MAXIMUM:()=>xn.d1,GAUGE_DEFAULT_MINIMUM:()=>xn.tw,GrafanaPlugin:()=>Yn.Ud,GrafanaThemeType:()=>St.I,HttpRequestMethod:()=>fn.DO,ISO_8601:()=>he.mt,InternalTimeZones:()=>be.g$,LanguageProvider:()=>ds.Is,LayoutModes:()=>ot.R,LegacyGraphHoverClearEvent:()=>Je.Tq,LegacyGraphHoverEvent:()=>Je.kb,LegacyMappingType:()=>H.An,LiveChannelConnectionState:()=>an.ZF,LiveChannelEventType:()=>an.o4,LiveChannelScope:()=>an.qD,LiveChannelType:()=>an.os,LoadingState:()=>Xn.Gu,LocalStorageValueProvider:()=>Ee.b,LogLevel:()=>Qn.$b,LogRowContextQueryDirection:()=>Qn.ZF,LogsDedupDescription:()=>Qn._C,LogsDedupStrategy:()=>m.fY,LogsMetaKind:()=>Qn.tG,LogsSortOrder:()=>m.uH,LogsVolumeType:()=>Qn.Aj,MISSING_VALUE:()=>a.p,MappingType:()=>Ls.d,MatcherID:()=>Me.cV,MutableDataFrame:()=>a.k,NodeGraphDataFrameFieldNames:()=>ce.u,NullValueMode:()=>Xn.UW,NumericLogLevel:()=>Qn.s5,OneClickMode:()=>ln.yd,OrgRole:()=>it.X,PageLayoutType:()=>Hn.k,PanelEvents:()=>Je.ee,PanelOptionsEditorBuilder:()=>A.pv,PanelPlugin:()=>gt.m,PluginContextProvider:()=>rt.a,PluginErrorCode:()=>Yn.ZK,PluginExtensionPoints:()=>Nn.S,PluginExtensionTypes:()=>Nn.u,PluginIncludeType:()=>Yn.ib,PluginLoadingStrategy:()=>Yn.xf,PluginSignatureStatus:()=>Yn.Ac,PluginSignatureType:()=>Yn.kv,PluginState:()=>Yn.pn,PluginType:()=>Yn.QE,ReducerID:()=>Ce.gy,Registry:()=>Z.O,SetPanelAttentionEvent:()=>E.Tp,SpecialValue:()=>Zn.N,SpecialValueMatch:()=>Ls.W,StandardVariableSupport:()=>Ge.J$,StreamingDataFrame:()=>l.k9,StreamingFrameAction:()=>l.Kh,SupplementaryQueryType:()=>Qn.cF,SupportedTransformationType:()=>ln.CC,SystemDateFormatsState:()=>Ke.JE,TIME_FORMAT:()=>Ln.G$,TIME_SERIES_METRIC_FIELD_NAME:()=>wn.aI,TIME_SERIES_TIME_FIELD_NAME:()=>wn.LE,TIME_SERIES_VALUE_FIELD_NAME:()=>wn.Bc,ThemeContext:()=>me.D,ThresholdsMode:()=>Qt.O,TransformationApplicabilityLevels:()=>Zn.M,TransformerCategory:()=>Ae.m,UnaryOperationID:()=>J._,VAR_CALC:()=>I.k_,VAR_CELL_PREFIX:()=>I.a_,VAR_FIELD_LABELS:()=>I.nF,VAR_FIELD_NAME:()=>I.py,VAR_SERIES_NAME:()=>I.k3,ValueMatcherID:()=>Me.Js,VariableHide:()=>Kt.zL,VariableOrigin:()=>ln.$0,VariableRefresh:()=>Kt.CO,VariableSort:()=>Kt.ZG,VariableSuggestionsScope:()=>ln.uP,VariableSupportBase:()=>Ge.xi,VariableSupportType:()=>Ge.Qz,VisualizationSuggestionScore:()=>ss.nQ,VisualizationSuggestionsBuilder:()=>ss.v2,VisualizationSuggestionsListAppender:()=>ss.NV,VizOrientation:()=>ss.wV,addDurationToDate:()=>tt.Ri,addRow:()=>i.uY,amendTable:()=>t.c,anySeriesWithTimeField:()=>i.tP,anyToNumber:()=>z.t,applyFieldOverrides:()=>T.we,applyNullInsertThreshold:()=>ut.M,applyRawFieldOverrides:()=>T.K3,arrayToDataFrame:()=>d.I,arrayUtils:()=>xe,availableIconsIndex:()=>Oe.az,binaryOperators:()=>oe.b,booleanOverrideProcessor:()=>j.FM,booleanValueFormatter:()=>Pe.Qc,buildHistogram:()=>_e.p3,cacheFieldDisplayNames:()=>O.Fm,classicColors:()=>le,closestIdx:()=>l.Ls,colorManipulator:()=>ue.MV,compareArrayValues:()=>h.J3,compareDataFrameStructures:()=>h.bW,containsSearchFilter:()=>Q.E,contentTypeOptions:()=>fn.Ur,convertOldAngularValueMappings:()=>H.bh,createDataFrame:()=>r.EI,createDimension:()=>g.r4,createFieldConfigRegistry:()=>et.O,createTheme:()=>ge.a,dataFrameFromJSON:()=>c.or,dataFrameToJSON:()=>c.Nw,dataLinksOverrideProcessor:()=>j.Ch,dateMath:()=>Ne,dateTime:()=>he.KQ,dateTimeAsMoment:()=>he.AN,dateTimeForTimeZone:()=>he.oZ,dateTimeFormat:()=>ze.LE,dateTimeFormatISO:()=>ze.M7,dateTimeFormatTimeAgo:()=>ze.fq,dateTimeFormatWithAbbrevation:()=>ze._Q,dateTimeParse:()=>nt.b,decodeFieldValueEntities:()=>c.t,decodeFieldValueEnums:()=>c.EL,defaultActionConfig:()=>fn.mx,defaultCalcs:()=>Ce.C6,deprecationWarning:()=>ae.l,displayNameOverrideProcessor:()=>j.AM,doStandardCalcs:()=>Ce.H3,durationToMilliseconds:()=>tt.WT,ensureTimeField:()=>at.ks,escapeRegex:()=>u.$f,escapeStringForRegex:()=>u.jD,eventFactory:()=>x.R,fieldColorModeRegistry:()=>D.uf,fieldMatchers:()=>ye.sJ,fieldReducers:()=>Ce.AS,filterFieldConfigOverrides:()=>He.aW,findCommonLabels:()=>se.yO,findHighlightChunksInText:()=>p.Oq,findMatchesInText:()=>p.bs,findUniqueLabels:()=>se.s6,fixCellTemplateExpressions:()=>I.Zo,formatLabels:()=>se.h6,formattedValueToString:()=>Pe.cN,frameMatchers:()=>ye.RE,getActiveThreshold:()=>b.yQ,getAllValuesFromDimension:()=>g.Km,getBuiltInThemes:()=>Ie.k,getColumnFromDimension:()=>g.P4,getColumnsFromDimension:()=>g.g6,getDataFrameRow:()=>r.Yn,getDataSourceRef:()=>q.p$,getDataSourceUID:()=>q.Iz,getDefaultRelativeTimeRange:()=>Ln.Cn,getDefaultTimeRange:()=>Ln.E2,getDimensionByName:()=>g.xB,getDisplayProcessor:()=>L.J,getDisplayValueAlignmentFactors:()=>I.XS,getFieldColorMode:()=>D.Hs,getFieldColorModeForField:()=>D.Qi,getFieldConfigWithMinMax:()=>M.xg,getFieldDataContextClone:()=>T.vd,getFieldDisplayName:()=>O.Ct,getFieldDisplayValues:()=>I.PI,getFieldDisplayValuesProxy:()=>S.F,getFieldMatcher:()=>ye.NS,getFieldSeriesColor:()=>D.lz,getFieldTypeFromValue:()=>r.oE,getFlotPairs:()=>K.R,getFlotPairsConstant:()=>K.r,getFrameDisplayName:()=>O.Ri,getFrameMatchers:()=>ye.Dq,getHistogramFields:()=>_e.ix,getLinksSupplier:()=>T._M,getLocale:()=>he.JK,getLocaleData:()=>he.XN,getMinMaxAndDelta:()=>M.AP,getNextRefId:()=>o.M,getPanelOptionsWithDefaults:()=>He.F,getProcessedDataFrames:()=>r.Bt,getRawDisplayProcessor:()=>L.H,getRowUniqueId:()=>i.t9,getScaleCalculator:()=>M.jc,getSearchFilterScopedVar:()=>Q.c,getSeriesTimeStep:()=>re,getThemeById:()=>Ie.g,getTimeField:()=>r.KR,getTimeZone:()=>Be.O,getTimeZoneGroups:()=>be.U3,getTimeZoneInfo:()=>be.QZ,getTimeZones:()=>be.P3,getUniqueFieldName:()=>O.fk,getValueFormat:()=>Pe.j_,getValueFormats:()=>Pe.Ke,getValueFormatterIndex:()=>Pe.uH,getValueFromDimension:()=>g.WK,getValueMatcher:()=>ye.kK,getWeekdayIndex:()=>he.xQ,getWeekdayIndexByEnglishName:()=>he.pp,getZone:()=>be.HD,guessDecimals:()=>te.E,guessFieldTypeForField:()=>r.dF,guessFieldTypeFromNameAndValue:()=>r.by,guessFieldTypeFromValue:()=>r.HW,guessFieldTypes:()=>r.XQ,hasLinks:()=>I.eG,hasLogsContextSupport:()=>Qn.Ol,hasLogsContextUiSupport:()=>Qn.wj,hasMsResolution:()=>de,hasQueryExportSupport:()=>Yt.Ee,hasQueryImportSupport:()=>Yt.FL,hasQueryModificationSupport:()=>Qn._0,hasSupplementaryQuerySupport:()=>Qn.Nc,hasTimeField:()=>i.S1,hasToggleableQueryFiltersSupport:()=>Qn.FP,histogramBucketSizes:()=>_e.rW,histogramFieldInfo:()=>_e.Rt,histogramFieldsToFrame:()=>_e.cg,histogramFrameBucketMaxFieldName:()=>_e.dA,histogramFrameBucketMinFieldName:()=>_e.d$,histogramTransformer:()=>_e.OA,httpMethodOptions:()=>fn.ki,identityOverrideProcessor:()=>j.hS,incrRound:()=>_e.ZU,incrRoundDn:()=>_e.rs,incrRoundUp:()=>_e.Uh,intervalToAbbreviatedDurationString:()=>tt.dU,isBooleanUnit:()=>Pe.j9,isCustomFieldProp:()=>He.TQ,isDataFrame:()=>r.ci,isDataFrameWithValue:()=>r.LI,isDataSourcePluginContext:()=>De.S,isDataSourceRef:()=>q.fN,isDateTime:()=>he.Ar,isDateTimeInput:()=>he.u8,isEmptyObject:()=>ne.R,isHistogramFrameBucketMaxFieldName:()=>_e.H1,isHistogramFrameBucketMinFieldName:()=>_e.NX,isIconName:()=>Oe.n6,isLikelyAscendingVector:()=>We.g2,isLiveChannelJoinEvent:()=>an.Cz,isLiveChannelLeaveEvent:()=>an.jQ,isLiveChannelMessageEvent:()=>an.Z7,isLiveChannelStatusEvent:()=>an.ew,isObject:()=>Xn.Gv,isReducerID:()=>Ce.Em,isStandardFieldProp:()=>He.nx,isSystemOverride:()=>gs.Ow,isSystemOverrideWithRef:()=>gs.ZW,isTableData:()=>r.pH,isTimeSeriesField:()=>i.hF,isTimeSeriesFrame:()=>i.aH,isTimeSeriesFrames:()=>i.jq,isTruthy:()=>Xn.zz,isUnsignedPluginSignature:()=>Te.x,isValidDate:()=>tt.vd,isValidDuration:()=>tt.di,isValidGoDuration:()=>tt.pp,isValidGrafanaDuration:()=>tt.V3,isValidLiveChannelAddress:()=>an.aj,localTimeFormat:()=>Ke.Od,locale:()=>Pe.Hg,locationUtil:()=>W.I,makeClassES5Compatible:()=>w.Y,makeTimeRange:()=>Ln.HW,mapInternalLinkToExplore:()=>F.u,matchAllLabels:()=>se._p,matchPluginId:()=>ee._,monacoLanguageRegistry:()=>It.l,nullToValue:()=>Tt.C,numberOverrideProcessor:()=>j.m0,objRemoveUndefined:()=>ne.w,onUpdateDatasourceJsonDataOption:()=>q.PG,onUpdateDatasourceJsonDataOptionChecked:()=>q.EX,onUpdateDatasourceJsonDataOptionSelect:()=>q.BD,onUpdateDatasourceOption:()=>q.zX,onUpdateDatasourceResetOption:()=>q.yV,onUpdateDatasourceSecureJsonDataOption:()=>q.mn,onUpdateDatasourceSecureJsonDataOptionSelect:()=>q.wY,outerJoinDataFrames:()=>We.Fd,parseDuration:()=>tt.E9,parseFlags:()=>p.bQ,parseLabels:()=>se.Xy,parseLiveChannelAddress:()=>an.DG,patchArrayVectorProrotypeMethods:()=>Bs.V,preProcessPanelData:()=>r.N$,preferredVisualizationTypes:()=>Xn.Nx,rangeUtil:()=>Fe,readCSV:()=>k.Jh,reduceField:()=>Ce.Nw,renderLegendFormat:()=>X.j,renderMarkdown:()=>f.G,renderTextPanelMarkdown:()=>f.P,restoreCustomOverrideRules:()=>He.H9,reverseDataFrame:()=>r.q7,roundDecimals:()=>te.h,scaledUnits:()=>Pe.yP,scopeFilterOperatorMap:()=>zn.n,selectOverrideProcessor:()=>j.hL,serializeStateToUrlParam:()=>U.Pp,setLocale:()=>he.xS,setTimeZoneResolver:()=>Be.G,setWeekStart:()=>he.$D,shallowCompare:()=>h.ab,simpleCountUnit:()=>Pe.UR,sortDataFrame:()=>r.ES,sortThresholds:()=>b.RU,standardEditorsRegistry:()=>B.D,standardFieldConfigEditorRegistry:()=>B.G,standardTransformers:()=>Se.c,standardTransformersRegistry:()=>Ae.h,store:()=>fe.M,stringFormater:()=>Pe.cH,stringOverrideProcessor:()=>j.OU,stringStartsAsRegEx:()=>u.AP,stringToJsRegex:()=>u.dO,stringToMs:()=>u.dc,systemDateFormats:()=>Ke.WC,textUtil:()=>y.sQ,thresholdsOverrideProcessor:()=>j.N7,timeZoneAbbrevation:()=>ze.jw,timeZoneFormatUserFriendly:()=>be.le,toCSV:()=>k._O,toDataFrame:()=>r.Vc,toDataFrameDTO:()=>r.Kl,toDuration:()=>he.Ah,toFilteredDataFrameDTO:()=>r.By,toFixed:()=>Pe.Mg,toFixedScaled:()=>Pe.gZ,toFixedUnit:()=>Pe.G8,toFloatOrUndefined:()=>u.$D,toIconName:()=>Oe.Uo,toIntegerOrUndefined:()=>u.vb,toLegacyResponseData:()=>r.w3,toLiveChannelId:()=>an.Qp,toNumberString:()=>u.kT,toOption:()=>pe.z,toPascalCase:()=>u.MX,toURLRange:()=>U.sQ,toUtc:()=>he.yT,transformDataFrame:()=>Ue.m,trimTable:()=>t.F,unEscapeStringFromRegex:()=>u.xb,unaryOperators:()=>J.j,unitOverrideProcessor:()=>j.lG,updateDatasourcePluginJsonDataOption:()=>q.lO,updateDatasourcePluginOption:()=>q.pN,updateDatasourcePluginResetOption:()=>q.QP,updateDatasourcePluginSecureJsonDataOption:()=>q.wp,urlUtil:()=>U.kM,useFieldOverrides:()=>T.rJ,usePluginContext:()=>ft.Q,userHasAllPermissions:()=>Pt.Fj,userHasAnyPermission:()=>Pt.jW,userHasPermission:()=>Pt.ZU,userHasPermissionInMetadata:()=>Pt.T6,validateFieldConfig:()=>T.BF,valueMappingsOverrideProcessor:()=>j.xT,valueMatchers:()=>ye.hI,vectorator:()=>nn.E,withLoadingIndicator:()=>N.k});var t=e(67414),n=e(78368),s=e(85404),a=e(37471),r=e(14236),g=e(61443),i=e(19845),l=e(9631),d=e(33948),c=e(89667),h=e(21423),o=e(77789),m=e(52622),u=e(54479),p=e(21),f=e(36663),y=e(80997),x=e(89550),v=e(65463),P=e(18226),E=e(69129),D=e(8066),C=e(66670),b=e(47737),T=e(90708),S=e(92461),O=e(28240),M=e(58563),I=e(56323),L=e(57875),B=e(69550),j=e(27310),A=e(60264),K=e(39306),W=e(71733),U=e(76885),F=e(6709),V=e(87885),w=e(92341),z=e(28802),N=e(72495),H=e(62398),Q=e(92053),X=e(43659),ee=e(80147),Z=e(83077),q=e(22391),ae=e(95344),k=e(72436),se=e(8249),te=e(97706),ne=e(92041);const le=["#7EB26D","#EAB839","#6ED0E0","#EF843C","#E24D42","#1F78C1","#BA43A9","#705DA0","#508642","#CCA300","#447EBC","#C15C17","#890F02","#0A437C","#6D1F62","#584477","#B7DBAB","#F4D598","#70DBED","#F9BA8F","#F29191","#82B5D8","#E5A8E2","#AEA2E0","#629E51","#E5AC0E","#64B0C8","#E0752D","#BF1B00","#0A50A1","#962D82","#614D93","#9AC48A","#F2C96D","#65C5DB","#F9934E","#EA6460","#5195CE","#D683CE","#806EB7","#3F6833","#967302","#2F575E","#99440A","#58140C","#052B51","#511749","#3F2B5B","#E0F9D7","#FCEACA","#CFFAFF","#F9E2D2","#FCE2DE","#BADFF4","#F9D9F9","#DEDAF7"],re=Ze=>{let lt,yt,Nt=Number.MAX_VALUE;for(let wt=0;wt<Ze.values.length;wt++){const Zt=Ze.values[wt];if(lt!==void 0){const pn=Zt-lt;yt===void 0&&(Nt=pn),pn<Nt&&(Nt=pn)}lt=Zt}return Nt},de=Ze=>{for(let lt=0;lt<Ze.values.length;lt++){const yt=Ze.values[lt];if(yt!=null){const Nt=yt.toString();if(Nt.length===13&&Nt%1e3!==0)return!0}}return!1};var oe=e(11710),J=e(27618),ce=e(25352),pe=e(50877),xe=e(14588),fe=e(68941),Ee=e(7144),Se=e(97522),ye=e(85200),Ve=e(18282),Me=e(1173),Ce=e(75059),Ue=e(2514),Ae=e(97497),we=e(58972),We=e(73060),_e=e(77678),at=e(50311),ut=e(46294),Tt=e(39624),It=e(96915),ge=e(75972),Ie=e(97594),ue=e(23596),me=e(60578),Pe=e(83195),Ne=e(85858),Fe=e(65879),Be=e(1933),he=e(47232),be=e(91410),Ke=e(42994),ze=e(72724),nt=e(53531),tt=e(70416),ot=e(19484),gt=e(65158),He=e(581),et=e(28528),rt=e(13834),ht=e(76287),ft=e(92470),De=e(95187),Te=e(51527),Oe=e(8887),Ye=e(43585),Ge=e(29505),Je=e(26272),it=e(62625),St=e(25137),zt=e(24293),Kt=e(12470),Qt=e(50082),an=e(55004),Nn=e(74135),zn=e(37891),Yn=e(43429),ss=e(47070),ds=e(40187),Ms=e(41987),Bs=e(35853),gs=e(37055),Zn=e(81010),Ls=e(25019),Ln=e(43127),Hn=e(64388),Qn=e(9557),mt=e(8790),Yt=e(73372),on=e(94624),ln=e(91890),fn=e(83580),yn=e(41260),wn=e(11261),Xn=e(39070),xn=e(58649),Ut=e(36120),nn=e(18008);const hn="ArrayVector is deprecated and will be removed in Grafana 11. Please use plain arrays for field.values.";let dn=!1;class Sn extends Array{get buffer(){return this}set buffer(lt){this.length=0;const yt=lt?.length;if(yt){let Nt=65e3,wt=Math.ceil(yt/Nt);for(let Zt=0;Zt<wt;Zt++)this.push.apply(this,lt.slice(Zt*Nt,(Zt+1)*Nt))}}constructor(lt){super(),this.buffer=lt??[],dn||(console.warn(hn),dn=!0)}toJSON(){return[...this]}}var es=e(33526),Pt=e(29263)},65158:(G,R,e)=>{"use strict";e.d(R,{m:()=>l});var t=e(2543),n=e.n(t),s=e(66670),a=e(43429),r=e(60264),g=e(95344),i=e(28528);class l extends a.Ud{constructor(c){super(),this._fieldConfigDefaults={defaults:{},overrides:[]},this._initConfigRegistry=()=>new s.K,this.dataSupport={annotations:!1,alertStates:!1},this.panel=c}get defaults(){let c=this._defaults||{};if(!this._defaults&&this.optionsSupplier){const h=new r.pv;this.optionsSupplier(h,{data:[]});for(const o of h.getItems())o.defaultValue!=null&&(0,t.set)(c,o.path,o.defaultValue)}return c}get fieldConfigDefaults(){const c=this._fieldConfigDefaults.defaults;c.custom={};for(const h of this.fieldConfigRegistry.list())h.defaultValue!==void 0&&(0,t.set)(c,h.id,h.defaultValue);return{defaults:{...c},overrides:this._fieldConfigDefaults.overrides}}setDefaults(c){return(0,g.l)("PanelPlugin","setDefaults","setPanelOptions"),this._defaults=c,this}get fieldConfigRegistry(){return this._fieldConfigRegistry||(this._fieldConfigRegistry=this._initConfigRegistry()),this._fieldConfigRegistry}setEditor(c){return(0,g.l)("PanelPlugin","setEditor","setPanelOptions"),this.editor=c,this}setNoPadding(){return this.noPadding=!0,this}setMigrationHandler(c){return this.onPanelMigration=c,this}setPanelChangeHandler(c){return this.onPanelTypeChanged=c,this}setPanelOptions(c){return this.optionsSupplier=c,this}getPanelOptionsSupplier(){return this.optionsSupplier??(()=>{})}setDataSupport(c){return this.dataSupport={...this.dataSupport,...c},this}useFieldConfig(c={}){return this._initConfigRegistry=()=>(0,i.O)(c,this.meta.name),this}setSuggestionsSupplier(c){return this.suggestionsSupplier=c,this}getSuggestionsSupplier(){return this.suggestionsSupplier}hasPluginId(c){return this.meta.id===c}}},581:(G,R,e)=>{"use strict";e.d(R,{F:()=>i,H9:()=>m,TQ:()=>u,aW:()=>d,nx:()=>p});var t=e(2543),n=e.n(t),s=e(8066),a=e(24293),r=e(37055),g=e(50082);function i({plugin:f,currentOptions:y,currentFieldConfig:x,isAfterPluginChange:v}){const P=(0,t.mergeWith)({},f.defaults,y||{},(C,b)=>{if((0,t.isArray)(b))return b}),E=l(x,f),D=h(f,E,v);return{options:P,fieldConfig:D}}function l(f,y){const x=y.fieldConfigDefaults,v={defaults:(0,t.mergeWith)({},x.defaults,f?f.defaults:{},(P,E)=>{if((0,t.isArray)(E))return E}),overrides:f?.overrides??[]};c(v.defaults,"",y.fieldConfigRegistry),v.defaults.thresholds&&o(v.defaults.thresholds),v.overrides=d(v.overrides,P=>y.fieldConfigRegistry.getIfExists(P.id)!==void 0);for(const P of v.overrides)for(const E of P.properties)E.id==="thresholds"&&o(E.value);return v}function d(f,y){return f.map(x=>{const v=x.properties.filter(y);return{...x,properties:v}})}function c(f,y,x){let v=!1;for(const[P,E]of Object.entries(f)){const D=`${y}${P}`,C=!!x.getIfExists(D);if(C){v=!0;continue}(0,t.isArray)(E)||!(0,t.isObject)(E)?C||(0,t.unset)(f,P):c(E,`${D}.`,x)||(0,t.unset)(f,P)}return v}function h(f,y,x){if(!x)return y;const v=f.fieldConfigRegistry.getIfExists(r.uo.Color);if(v&&v.settings){const P=v.settings,E=s.uf.getIfExists(y.defaults.color?.mode);if(!P.byValueSupport&&(!E||E.isByValue))return y.defaults.color={mode:a.Y.PaletteClassic},y;if(P.byValueSupport&&P.preferThresholdsMode&&E?.id!==a.Y.Fixed&&(!E||!E.isByValue))return y.defaults.color={mode:a.Y.Thresholds},y;if(P.bySeriesSupport&&E?.isByValue)return y.defaults.color={mode:a.Y.PaletteClassic},y}return y}function o(f){f.mode||(f.mode=g.O.Absolute),f.steps?f.steps.length&&(f.steps[0].value=-1/0):f.steps=[]}function m(f,y){const x={defaults:{...f.defaults,custom:y.defaults.custom},overrides:[...f.overrides]};for(const v of y.overrides)for(const P of v.properties)if(u(P)){const E=x.overrides.find(D=>(0,t.isEqual)(D.matcher,v.matcher));E?E!==v&&E.properties.push(P):x.overrides.push(v)}return x}function u(f){return f.id.startsWith("custom.")}function p(f){return!u(f)}},28528:(G,R,e)=>{"use strict";e.d(R,{O:()=>a});var t=e(66670),n=e(69550),s=e(60264);function a(g={},i){const l=new t.K,d=n.G.list(),c={};if(g.useCustomConfig){const h=new s.bk;g.useCustomConfig(h);for(const o of h.getRegistry().list())if(o.isCustom=!0,o.id="custom."+o.id,r(o,d)){const m=c[o.category[0]]??[];m.push(o),c[o.category[0]]=m}else l.register(o)}for(let h of d){const o=h.id;if(!(g.disableStandardOptions&&g.disableStandardOptions.indexOf(o)>-1)){if(g.standardOptions){const m=g.standardOptions[o]?.hideFromDefaults,u=g.standardOptions[o]?.defaultValue,p=g.standardOptions[o]?.settings;m&&(h={...h,hideFromDefaults:m}),u&&(h={...h,defaultValue:u}),p&&(h={...h,settings:h.settings?{...h.settings,...p}:p})}if(l.register(h),h.category&&c[h.category[0]])for(let m of c[h.category[0]])l.register(m)}}for(const h of l.list())if(h.path.indexOf("[")>0)throw new Error(`[${i}] Field config paths do not support arrays: ${h.id}`);return l}function r(g,i){return!!i.find(l=>g.category&&l.category&&g.category[0]===l.category[0])}},77789:(G,R,e)=>{"use strict";e.d(R,{M:()=>t});const t=s=>{for(let a=0;;a++){const r=n(a);if(!s.some(g=>g.refId===r))return r}};function n(s){const a="ABCDEFGHIJKLMNOPQRSTUVWXYZ";return s<a.length?a[s]:n(Math.floor(s/a.length)-1)+a[s%a.length]}},67414:(G,R,e)=>{"use strict";e.d(R,{F:()=>s,c:()=>n});var t=e(9631);function n(a,r){let[g]=a,[i]=r,l=g.length,d=g[0],c=g[l-1],h=i.length,o=i[0],m=i[h-1],u;if(l)if(h){if(o>c)u=a.map((p,f)=>a[f].concat(r[f]));else if(m<d)u=r.map((p,f)=>r[f].concat(a[f]));else if(o<=d&&m>=c)u=r;else if(o>d&&m<c){let p=(0,t.Ls)(o,g);p=g[p]<o?p+1:p;let f=(0,t.Ls)(m,g);f=g[f]>m?f-1:f,u=a.map((y,x)=>a[x].slice(0,p).concat(r[x]).concat(a[x].slice(f+1)))}else if(o>=d){let p=(0,t.Ls)(o,g);p=g[p]<o?p-1:p,u=a.map((f,y)=>a[y].slice(0,p).concat(r[y]))}else if(m>=d){let p=(0,t.Ls)(m,g);p=g[p]<m?p:p+1,u=r.map((f,y)=>r[y].concat(a[y].slice(p)))}}else u=a;else h?u=r:u=[[]];return u}function s(a,r,g){let[i,...l]=a,d,c;return i[0]<r&&(d=(0,t.Ls)(r,i),i[d]<r&&d++),i[i.length-1]>g&&(c=(0,t.Ls)(g,i),i[c]>g&&c--),(d!=null||c!=null)&&(i=i.slice(d??0,c),l=l.map(h=>h.slice(d??0,c))),[i,...l]}},36663:(G,R,e)=>{"use strict";e.d(R,{G:()=>g,P:()=>i});var t=e(60023),n=e(33836),s=e(80997);let a=!1;const r={pedantic:!1,gfm:!0,breaks:!1};function g(l,d){a||(t.xI.use((0,n.z)()),t.xI.setOptions({...r}),a=!0);let c;d?.breaks&&(c={...r,breaks:!0});const h=(0,t.xI)(l||"",c);if(typeof h!="string")throw new Error("Failed to process markdown synchronously.");return d?.noSanitize?h:(0,s.G$)(h)}function i(l,d){a||(t.xI.use((0,n.z)()),t.xI.setOptions({...r}),a=!0);const c=(0,t.xI)(l||"");if(typeof c!="string")throw new Error("Failed to process markdown synchronously.");return d?.noSanitize?c:(0,s.G$)(c)}},21:(G,R,e)=>{"use strict";e.d(R,{Oq:()=>t,bQ:()=>g,bs:()=>s});function t({searchWords:i,textToHighlight:l}){const d=[];for(const c of i)typeof c=="string"&&d.push(...s(l,c));return d}const n=i=>i.replace(/[[{(][\w,.\/:;<=>?:*+]+$/,"");function s(i,l){if(!i||!l)return[];const d=[],{cleaned:c,flags:h}=g(n(l));let o;try{o=new RegExp(`(?:${c})`,h)}catch{return d}return i.replace(o,(m,...u)=>{if(m){const p=u[u.length-2];d.push({text:m,start:p,length:m.length,end:p+m.length})}return""}),d}const a="-",r=/\(\?([ims-]+)\)/g;function g(i){const l=new Set(["g"]);return{cleaned:i.replace(r,(c,h)=>{const o=h.startsWith(a);for(let m=0;m<h.length;++m){const u=h.charAt(m);o||h.charAt(m-1)===a?l.delete(u):u!==a&&l.add(u)}return""}),flags:Array.from(l).join("")}}},75059:(G,R,e)=>{"use strict";e.d(R,{AS:()=>d,C6:()=>h,Em:()=>i,H3:()=>o,Nw:()=>l,gy:()=>g});var t=e(2543),n=e.n(t),s=e(39070),a=e(11261),r=e(83077),g=(E=>(E.sum="sum",E.max="max",E.min="min",E.logmin="logmin",E.mean="mean",E.variance="variance",E.stdDev="stdDev",E.last="last",E.median="median",E.first="first",E.count="count",E.range="range",E.diff="diff",E.diffperc="diffperc",E.delta="delta",E.step="step",E.firstNotNull="firstNotNull",E.lastNotNull="lastNotNull",E.changeCount="changeCount",E.distinctCount="distinctCount",E.allIsZero="allIsZero",E.allIsNull="allIsNull",E.allValues="allValues",E.uniqueValues="uniqueValues",E.p1="p1",E.p2="p2",E.p3="p3",E.p4="p4",E.p5="p5",E.p6="p6",E.p7="p7",E.p8="p8",E.p9="p9",E.p10="p10",E.p11="p11",E.p12="p12",E.p13="p13",E.p14="p14",E.p15="p15",E.p16="p16",E.p17="p17",E.p18="p18",E.p19="p19",E.p20="p20",E.p21="p21",E.p22="p22",E.p23="p23",E.p24="p24",E.p25="p25",E.p26="p26",E.p27="p27",E.p28="p28",E.p29="p29",E.p30="p30",E.p31="p31",E.p32="p32",E.p33="p33",E.p34="p34",E.p35="p35",E.p36="p36",E.p37="p37",E.p38="p38",E.p39="p39",E.p40="p40",E.p41="p41",E.p42="p42",E.p43="p43",E.p44="p44",E.p45="p45",E.p46="p46",E.p47="p47",E.p48="p48",E.p49="p49",E.p50="p50",E.p51="p51",E.p52="p52",E.p53="p53",E.p54="p54",E.p55="p55",E.p56="p56",E.p57="p57",E.p58="p58",E.p59="p59",E.p60="p60",E.p61="p61",E.p62="p62",E.p63="p63",E.p64="p64",E.p65="p65",E.p66="p66",E.p67="p67",E.p68="p68",E.p69="p69",E.p70="p70",E.p71="p71",E.p72="p72",E.p73="p73",E.p74="p74",E.p75="p75",E.p76="p76",E.p77="p77",E.p78="p78",E.p79="p79",E.p80="p80",E.p81="p81",E.p82="p82",E.p83="p83",E.p84="p84",E.p85="p85",E.p86="p86",E.p87="p87",E.p88="p88",E.p89="p89",E.p90="p90",E.p91="p91",E.p92="p92",E.p93="p93",E.p94="p94",E.p95="p95",E.p96="p96",E.p97="p97",E.p98="p98",E.p99="p99",E))(g||{});function i(E){return Object.keys(g).includes(E)}function l(E){const{field:D,reducers:C}=E;if(!D||!C||C.length<1)return{};if(D.state?.calcs){const L=[];for(const B of C)D.state.calcs.hasOwnProperty(B)||L.push(B);if(L.length<1)return{...D.state.calcs}}D.state||(D.state={});const b=d.list(C),T=D.values;if(T&&T.length<1){const L={...D.state.calcs};for(const B of b)L[B.id]=B.emptyInputResult!==null?B.emptyInputResult:null;return D.state.calcs=L}const{nullValueMode:S=s.UW.Ignore}=D.config,O=S===s.UW.Ignore,M=S===s.UW.AsZero;if(b.length===1&&b[0].reduce){const L=b[0].reduce(D,O,M);return D.state.calcs={...D.state.calcs,...L},L}let I=o(D,O,M);for(const L of b)!I.hasOwnProperty(L.id)&&L.reduce&&(I={...I,...L.reduce(D,O,M)});return D.state.calcs={...D.state.calcs,...I},I}const d=new r.O(()=>[{id:"lastNotNull",name:"Last *",description:"Last non-null value (also excludes NaNs)",standard:!0,aliasIds:["current"],reduce:f,preservesUnits:!0},{id:"last",name:"Last",description:"Last value",standard:!0,reduce:p,preservesUnits:!0},{id:"firstNotNull",name:"First *",description:"First non-null value (also excludes NaNs)",standard:!0,reduce:u,preservesUnits:!0},{id:"first",name:"First",description:"First Value",standard:!0,reduce:m,preservesUnits:!0},{id:"min",name:"Min",description:"Minimum Value",standard:!0,preservesUnits:!0},{id:"max",name:"Max",description:"Maximum Value",standard:!0,preservesUnits:!0},{id:"mean",name:"Mean",description:"Average Value",standard:!0,aliasIds:["avg"],preservesUnits:!0},{id:"median",name:"Median",description:"Median Value",standard:!0,aliasIds:["median"],preservesUnits:!0},{id:"variance",name:"Variance",description:"Variance of all values in a field",standard:!1,reduce:y,preservesUnits:!0},{id:"stdDev",name:"StdDev",description:"Standard deviation of all values in a field",standard:!1,reduce:y,preservesUnits:!0},{id:"sum",name:"Total",description:"The sum of all values",emptyInputResult:0,standard:!0,aliasIds:["total"],preservesUnits:!0},{id:"count",name:"Count",description:"Number of values in response",emptyInputResult:0,standard:!0,preservesUnits:!1},{id:"range",name:"Range",description:"Difference between minimum and maximum values",standard:!0,preservesUnits:!0},{id:"delta",name:"Delta",description:"Cumulative change in value",standard:!0,preservesUnits:!0},{id:"step",name:"Step",description:"Minimum interval between values",standard:!0,preservesUnits:!0},{id:"diff",name:"Difference",description:"Difference between first and last values",standard:!0,preservesUnits:!0},{id:"logmin",name:"Min (above zero)",description:"Used for log min scale",standard:!0,preservesUnits:!0},{id:"allIsZero",name:"All Zeros",description:"All values are zero",emptyInputResult:!1,standard:!0,preservesUnits:!0},{id:"allIsNull",name:"All Nulls",description:"All values are null",emptyInputResult:!0,standard:!0,preservesUnits:!1},{id:"changeCount",name:"Change Count",description:"Number of times the value changes",standard:!1,reduce:x,preservesUnits:!1},{id:"distinctCount",name:"Distinct Count",description:"Number of distinct values",standard:!1,reduce:v,preservesUnits:!1},{id:"diffperc",name:"Difference percent",description:"Percentage difference between first and last values",standard:!0,preservesUnits:!1},{id:"allValues",name:"All values",description:"Returns an array with all values",standard:!1,reduce:E=>({allValues:[...E.values]}),preservesUnits:!1},{id:"uniqueValues",name:"All unique values",description:"Returns an array with all unique values",standard:!1,reduce:E=>({uniqueValues:[...new Set(E.values)]}),preservesUnits:!1},...c()]),c=(E=[...Array.from({length:99},(D,C)=>C+1)])=>{const D=[],C=b=>b>3&&b<21?"th":b%10===1?"st":b%10===2?"nd":b%10===3?"rd":"th";return E.forEach(b=>{const T=b/100,S=`p${b}`,O=`${b}${C(b)} %`,M=`${b}${C(b)} percentile value`;D.push({id:S,name:O,description:M,standard:!1,reduce:(I,L,B)=>({[S]:P(I,T,L,B)}),preservesUnits:!0})}),D},h={sum:0,max:-Number.MAX_VALUE,min:Number.MAX_VALUE,logmin:Number.MAX_VALUE,mean:null,last:null,first:null,lastNotNull:null,firstNotNull:null,count:0,nonNullCount:0,allIsNull:!0,allIsZero:!0,range:null,diff:null,delta:0,step:Number.MAX_VALUE,diffperc:0,previousDeltaUp:!0};function o(E,D,C){const b={...h},T=E.values;if(!T)return b;const S=E.type===a.PU.number||E.type===a.PU.time;for(let O=0;O<T.length;O++){let M=T[O];if(O===0&&(b.first=M),b.last=M,M==null){if(D)continue;C&&(M=0)}if(b.count++,M!=null&&!Number.isNaN(M)){const I=b.firstNotNull===null;if(I&&(b.firstNotNull=M),S){if(b.sum+=M,b.allIsNull=!1,b.nonNullCount++,!I){const L=M-b.lastNotNull;b.step>L&&(b.step=L),b.lastNotNull>M?(b.previousDeltaUp=!1,O===T.length-1&&(b.delta+=M)):(b.previousDeltaUp?b.delta+=L:b.delta+=M,b.previousDeltaUp=!0)}M>b.max&&(b.max=M),M<b.min&&(b.min=M),M<b.logmin&&M>0&&(b.logmin=M)}M!==0&&(b.allIsZero=!1),b.lastNotNull=M}}return b.max===-Number.MAX_VALUE&&(b.max=null),b.min===Number.MAX_VALUE&&(b.min=null),b.step===Number.MAX_VALUE&&(b.step=null),b.nonNullCount>0&&(b.mean=b.sum/b.nonNullCount),b.allIsNull&&(b.allIsZero=!1),b.max!==null&&b.min!==null&&(b.range=b.max-b.min),(0,t.isNumber)(b.firstNotNull)&&(0,t.isNumber)(b.lastNotNull)&&(b.diff=b.lastNotNull-b.firstNotNull),(0,t.isNumber)(b.firstNotNull)&&(0,t.isNumber)(b.diff)&&(b.diffperc=b.diff/b.firstNotNull*100),b}function m(E,D,C){return{first:E.values[0]}}function u(E,D,C){const b=E.values;for(let T=0;T<b.length;T++){const S=b[T];if(S!=null&&!Number.isNaN(S))return{firstNotNull:S}}return{firstNotNull:null}}function p(E,D,C){const b=E.values;return{last:b[b.length-1]}}function f(E,D,C){const b=E.values;let T=b.length-1;for(;T>=0;){const S=b[T--];if(S!=null&&!Number.isNaN(S))return{lastNotNull:S}}return{lastNotNull:null}}function y(E,D,C){if(!(E.type===a.PU.number||E.type===a.PU.time))return{variance:0,stdDev:0};let b=0,T=0,S=0;const O=E.values;for(let M=0;M<O.length;M++){const I=O[M];if(I!=null){S++;let L=T;T+=(I-L)/S,b+=(I-L)*(I-T)}}if(S>0){const M=b/S;return{variance:M,stdDev:Math.sqrt(M)}}return{variance:0,stdDev:0}}function x(E,D,C){const b=E.values;let T=0,S=!0,O=null;for(let M=0;M<b.length;M++){let I=b[M];if(I===null){if(D)continue;C&&(I=0)}!S&&O!==I&&T++,S=!1,O=I}return{changeCount:T}}function v(E,D,C){const b=E.values,T=new Set;for(let S=0;S<b.length;S++){let O=b[S];if(O===null){if(D)continue;C&&(O=0)}T.add(O)}return{distinctCount:T.size}}function P(E,D,C,b){let T=E.values;C&&(T=T.filter(M=>M!==null)),b&&(T=T.map(M=>M===null?0:M));const S=T.slice().sort((M,I)=>M-I),O=Math.round((S.length-1)*D);return S[O]}},85200:(G,R,e)=>{"use strict";e.d(R,{Dq:()=>x,NS:()=>y,RE:()=>p,hI:()=>f,kK:()=>v,sJ:()=>u});var t=e(83077),n=e(7029),s=e(24814),a=e(58972),r=e(72693),g=e(8549),i=e(83855),l=e(60005),d=e(21262),c=e(70218),h=e(55008),o=e(16378),m=e(75754);const u=new t.O(()=>[...(0,r.nz)(),...(0,n._)(),...(0,a.P7)(),...(0,i.W)(),s.u]),p=new t.O(()=>[...(0,r.UM)(),...(0,a.Y7)(),...(0,g.i)()]),f=new t.O(()=>[...(0,d._)(),...(0,c.E)(),...(0,l.d)(),...(0,m.m)(),...(0,h.G)(),...(0,o.z)()]);function y(P){const E=u.get(P.id);if(!E)throw new Error("Unknown field matcher: "+P.id);return E.get(P.options)}function x(P){const E=p.get(P.id);if(!E)throw new Error("Unknown frame matcher: "+P.id);return E.get(P.options)}function v(P){const E=f.get(P.id);if(!E)throw new Error("Unknown value matcher: "+P.id);return E.get(P.options)}},58972:(G,R,e)=>{"use strict";e.d(R,{P7:()=>u,PP:()=>r,Y7:()=>p});var t=e(28240),n=e(54479),s=e(11261),a=e(1173),r=(f=>(f.exclude="exclude",f.include="include",f))(r||{});const g={id:a.Ct.byName,name:"Field Name",description:"match the field name",defaultOptions:"",get:f=>{const x=l(new Set([f]));return(v,P,E)=>f===v.name||f===(0,t.Ct)(v,P,E)||!!(x&&x(v,P,E))},getOptionsDisplayText:f=>`Field name: ${f}`},i={id:a.Ct.byNames,name:"Field Names",description:"match any of the given the field names",defaultOptions:{mode:"include",names:[]},get:f=>{const{names:y,mode:x="include"}=f,v=new Set(y??[]),P=l(v),E=(D,C,b)=>v.has(D.name)||v.has((0,t.Ct)(D,C,b))||!!(P&&P(D,C,b));return x==="exclude"?(D,C,b)=>!E(D,C,b):E},getOptionsDisplayText:f=>{const{names:y,mode:x}=f,v=(y??[]).join(", ");return x==="exclude"?`All except: ${v}`:`All of: ${v}`}};function l(f){let y;return window?.grafanaBootData?.settings?.featureToggles?.dataplaneFrontendFallback&&(f.has(s.Bc)?y=(v,P)=>!!v.labels&&v.labels?.__name__===v.name:(f.has("Time")||f.has("time"))&&(y=(v,P)=>P.meta?.typeVersion==null&&v.type===s.PU.time)),y}const d={id:a.Ct.byRegexp,name:"Field Name by Regexp",description:"match the field name by a given regexp pattern",defaultOptions:"/.*/",get:f=>{const y=o(f);return(x,v,P)=>{const E=(0,t.Ct)(x,v,P);return!!y&&y.test(E)}},getOptionsDisplayText:f=>`Field name by pattern: ${f}`},c={id:a.Ct.byFrameRefID,name:"Fields by frame refId",description:"match all fields returned in data frame with refId.",defaultOptions:"",get:f=>(y,x,v)=>x.refId===f,getOptionsDisplayText:f=>`Math all fields returned by query with reference ID: ${f}`},h={id:a.Ct.byRegexpOrNames,name:"Field Name by Regexp or Names",description:"match the field name by a given regexp pattern or given names",defaultOptions:{pattern:"/.*/",names:[]},get:f=>{const y=d.get(f?.pattern||""),x=i.get({mode:"include",names:f?.names??[]});return(v,P,E)=>x(v,P,E)||y(v,P,E)},getOptionsDisplayText:f=>{const y=f?.pattern??"",x=f?.names?.join(",")??"";return`Field name by pattern: ${y} or names: ${x}`}},o=f=>{if(f)try{return(0,n.dO)(f)}catch(y){console.error(y);return}},m={id:a.jR.byName,name:"Frame Name",description:"match the frame name",defaultOptions:"/.*/",get:f=>{const y=(0,n.dO)(f);return x=>y.test(x.name||"")},getOptionsDisplayText:f=>`Frame name: ${f}`};function u(){return[g,d,i,h,c]}function p(){return[m]}},72693:(G,R,e)=>{"use strict";e.d(R,{UM:()=>P,Yg:()=>c,nz:()=>v,zx:()=>m});var t=e(11261),n=e(85200),s=e(1173);const a={id:s.cV.anyMatch,name:"Any",description:"Any child matches (OR)",excludeFromPicker:!0,defaultOptions:[],get:E=>{const D=E.map(C=>(0,n.NS)(C));return(C,b,T)=>{for(const S of D)if(S(C,b,T))return!0;return!1}},getOptionsDisplayText:E=>{let D="";for(const C of E){D.length>0&&(D+=" OR ");const b=n.sJ.get(C.id);D+=b.getOptionsDisplayText?b.getOptionsDisplayText(C):b.name}return D}},r={id:s.cV.anyMatch,name:"Any",description:"Any child matches (OR)",excludeFromPicker:!0,defaultOptions:[],get:E=>{const D=E.map(C=>(0,n.Dq)(C));return C=>{for(const b of D)if(b(C))return!0;return!1}},getOptionsDisplayText:E=>{let D="";for(const C of E){D.length>0&&(D+=" OR ");const b=n.RE.get(C.id);D+=b.getOptionsDisplayText?b.getOptionsDisplayText(C):b.name}return D}},g={id:s.cV.allMatch,name:"All",description:"Everything matches (AND)",excludeFromPicker:!0,defaultOptions:[],get:E=>{const D=E.map(C=>(0,n.NS)(C));return(C,b,T)=>{for(const S of D)if(!S(C,b,T))return!1;return!0}},getOptionsDisplayText:E=>{let D="";for(const C of E){D.length>0&&(D+=" AND ");const b=n.sJ.get(C.id);D+=b.getOptionsDisplayText?b.getOptionsDisplayText(C):b.name}return D}},i={id:s.cV.allMatch,name:"All",description:"Everything matches (AND)",excludeFromPicker:!0,defaultOptions:[],get:E=>{const D=E.map(C=>(0,n.Dq)(C));return C=>{for(const b of D)if(!b(C))return!1;return!0}},getOptionsDisplayText:E=>{let D="";for(const C of E){D.length>0&&(D+=" AND ");const b=n.RE.get(C.id);D+=b.getOptionsDisplayText?b.getOptionsDisplayText(C):b.name}return D}},l={id:s.cV.invertMatch,name:"NOT",description:"Inverts other matchers",excludeFromPicker:!0,get:E=>{const D=(0,n.NS)(E);return(C,b,T)=>!D(C,b,T)},getOptionsDisplayText:E=>{const D=n.sJ.get(E.id);return"NOT "+(D.getOptionsDisplayText?D.getOptionsDisplayText(E.options):D.name)}},d={id:s.cV.invertMatch,name:"NOT",description:"Inverts other matchers",excludeFromPicker:!0,get:E=>{const D=(0,n.Dq)(E);return C=>!D(C)},getOptionsDisplayText:E=>{const D=n.RE.get(E.id);return"NOT "+(D.getOptionsDisplayText?D.getOptionsDisplayText(E.options):D.name)}},c=E=>!0,h=E=>!0,o=E=>!1,m=E=>E.type!==t.PU.time,u=E=>!1,p={id:s.cV.alwaysMatch,name:"All Fields",description:"Always Match",get:E=>c,getOptionsDisplayText:E=>"Always"},f={id:s.cV.alwaysMatch,name:"All Frames",description:"Always Match",get:E=>h,getOptionsDisplayText:E=>"Always"},y={id:s.cV.neverMatch,name:"No Fields",description:"Never Match",excludeFromPicker:!0,get:E=>o,getOptionsDisplayText:E=>"Never"},x={id:s.cV.neverMatch,name:"No Frames",description:"Never Match",get:E=>u,getOptionsDisplayText:E=>"Never"};function v(){return[a,g,l,p,y]}function P(){return[r,i,d,f,x]}},97497:(G,R,e)=>{"use strict";e.d(R,{h:()=>s,m:()=>n});var t=e(83077),n=(a=>(a.Combine="combine",a.CalculateNewFields="calculateNewFields",a.CreateNewVisualization="createNewVisualization",a.Filter="filter",a.PerformSpatialOperations="performSpatialOperations",a.Reformat="reformat",a.ReorderAndRename="reorderAndRename",a))(n||{});const s=new t.O},2514:(G,R,e)=>{"use strict";e.d(R,{m:()=>d});var t=e(62467),n=e(69862),s=e(81160),a=e(85200),r=e(97497);const g=(h,o)=>m=>{const u=r.h.get(h.id);if(!u)return m;const f={...u.transformation.defaultOptions??{},...h.options},y=h.filter?.options?(0,a.Dq)(h.filter):void 0;return m.pipe((0,n.Z)(x=>(0,t.of)(i(x,y)).pipe(u.transformation.operator(f,o),l(x,u,y))))};function i(h,o){return o?h.filter(m=>o(m)):h}const l=(h,o,m)=>u=>u.pipe((0,s.T)(p=>{if(p===h)return p;if(m){let f=0;const y=h.filter((x,v)=>{const P=!m(x);return P&&!f&&(f=v),P});y.length&&p.splice(f,0,...y)}return p}));function d(h,o,m){const u=(0,t.of)(o);if(!h.length)return u;const p=[],f=m??{interpolate:y=>y};for(let y=0;y<h.length;y++){const x=h[y];if(c(x))p.push(x(f));else{if(x.disabled)continue;p.push(g(x,f))}}return u.pipe.apply(u,p)}function c(h){return typeof h=="function"}},97522:(G,R,e)=>{"use strict";e.d(R,{c:()=>xe});var t=e(66350),n=e(82150),s=e(50311),a=e(34125),r=e(64224),g=e(35602),i=e(1173),l=e(18282);const d={id:l.F.filterByRefId,name:"Filter data by query refId",description:"select a subset of results",defaultOptions:{},operator:(fe,Ee)=>Se=>{const ye={};return fe.include&&(ye.include={id:i.jR.byRefId,options:fe.include}),fe.exclude&&(ye.exclude={id:i.jR.byRefId,options:fe.exclude}),Se.pipe(r.I.operator(ye,Ee))}};var c=e(73376),h=e(15400),o=e(81160),m=e(28240),u=e(81010);const p={id:l.F.formatTime,name:"Format time",description:"Set the output format of a time field",defaultOptions:{timeField:"",outputFormat:"",useTimezone:!0},isApplicable:fe=>{for(const Ee of fe)for(const Se of Ee.fields)if(Se.type==="time")return u.M.Applicable;return u.M.NotApplicable},isApplicableDescription:"The Format time transformation requires a time field to work. No time field could be found.",operator:(fe,Ee)=>Se=>Se.pipe((0,o.T)(ye=>f(fe,ye,Ee)))},f=({timeField:fe,outputFormat:Ee,timezone:Se},ye,Ve)=>!Array.isArray(ye)||ye.length===0?ye:((0,m.Fm)(ye),Ee=Ve?.interpolate(Ee)??Ee,ye.map(Me=>({...Me,fields:Me.fields.map(Ce=>(Ce.state?.displayName===fe&&(Ce=(0,s.Xv)(Ce,Ee,{timeZone:Se})),Ce))})));var y=e(25094),x=e(68133),v=e(11261),P=e(85200);const E="Time",D="Time",C="Value",b=u.N.Empty,T=window?.grafanaBootData?.settings?.featureToggles?.dataplaneFrontendFallback,S={id:l.F.groupingToMatrix,name:"Grouping to Matrix",description:"Groups series by field and return a matrix visualisation",defaultOptions:{columnField:E,rowField:D,valueField:C},isApplicable:fe=>{let Ee=0;for(const Se of fe)Ee+=Se.fields.length;return Ee>=3?u.M.Applicable:u.M.NotApplicable},isApplicableDescription:fe=>{let Ee=0;for(const Se of fe)Ee+=Se.fields.length;return`Grouping to matrix requiers at least 3 fields to work. Currently there are ${Ee} fields.`},operator:(fe,Ee)=>Se=>Se.pipe((0,o.T)(ye=>{const Ve=Ee.interpolate(fe.columnField||E),Me=Ee.interpolate(fe.rowField||D),Ce=Ee.interpolate(fe.valueField||C),Ue=fe.emptyValue||b;if(ye.length!==1)return ye;const Ae=ye[0],we=M(Ae,Ve),We=M(Ae,Me),_e=M(Ae,Ce),at=`${Me}\\${Ve}`;if(!we||!We||!_e)return ye;const ut=O(we.values),Tt=O(We.values),It={};for(let Ie=0;Ie<_e.values.length;Ie++){const ue=we.values[Ie],me=We.values[Ie],Pe=_e.values[Ie];It[ue]||(It[ue]={}),It[ue][me]=Pe}const ge=[{name:at,values:Tt,type:v.PU.string,config:{}}];for(const Ie of ut){let ue=[];for(const me of Tt){const Pe=It[Ie][me]??I(Ue);ue.push(Pe)}T&&typeof Ie=="number"&&(_e.config={..._e.config,displayNameFromDS:void 0}),ge.push({name:Ie.toString(),values:ue,config:_e.config,type:_e.type})}return[{fields:ge,length:Tt.length}]}))};function O(fe){const Ee=new Set;for(let Se=0;Se<fe.length;Se++)Ee.add(fe[Se]);return Array.from(Ee)}function M(fe,Ee){for(let Se=0;Se<fe.fields.length;Se++){const ye=fe.fields[Se];let Ve;if(T?Ve=P.sJ.get(i.Ct.byName).get(Ee)(ye,fe,[fe]):Ve=Ee===(0,m.Ct)(ye),Ve)return ye}return null}function I(fe){switch(fe){case u.N.False:return!1;case u.N.True:return!0;case u.N.Null:return null;case u.N.Empty:default:return""}}var L=e(77678),B=e(41511),j=e(6829),A=e(67641);const K=10,W={id:l.F.limit,name:"Limit",description:"Limit the number of items to the top N",defaultOptions:{limitField:K},operator:(fe,Ee)=>Se=>Se.pipe((0,o.T)(ye=>{let Ve=K;return fe.limitField!==void 0&&(typeof fe.limitField=="string"?(0,A.w)()?Ve=parseInt(Ee.interpolate(fe.limitField),10):Ve=parseInt(fe.limitField,10):Ve=fe.limitField),Ve<0&&(Ve=0),ye.map(Me=>Me.length>Ve?{...Me,fields:Me.fields.map(Ce=>({...Ce,values:Ce.values.slice(0,Ve)})),length:Ve}:Me)}))};var U=e(58140),F=e(64586),V=e(82280);const w={id:l.F.rename,name:"Rename fields by name",description:"Rename fields based on configuration given by user",defaultOptions:{renameByName:{}},operator:fe=>Ee=>Ee.pipe((0,o.T)(Se=>{const ye=z(fe.renameByName);return!Array.isArray(Se)||Se.length===0?Se:Se.map(Ve=>({...Ve,fields:ye(Ve)}))}))},z=fe=>Ee=>!fe||Object.keys(fe).length===0?Ee.fields:Ee.fields.map(Se=>{const ye=(0,m.Ct)(Se,Ee),Ve=fe[ye];return typeof Ve!="string"||Ve.length===0?Se:{...Se,config:{...Se.config,displayName:Ve},state:{...Se.state,displayName:Ve}}}),N={id:l.F.organize,name:"Organize fields by name",description:"Order, filter and rename fields based on configuration given by user",defaultOptions:{excludeByName:{},indexByName:{},renameByName:{},includeByName:{}},isApplicable:fe=>fe.length>1?u.M.NotPossible:u.M.Applicable,operator:(fe,Ee)=>Se=>Se.pipe(g.D.operator({include:fe.includeByName?{names:H(fe.includeByName)}:void 0,exclude:{names:H(fe.excludeByName)}},Ee),V.x.operator(fe,Ee),w.operator(fe,Ee))},H=fe=>fe?Object.keys(fe).filter(Ee=>fe[Ee]):[];var Q=e(21128),X=e(54479);const ee={id:l.F.renameByRegex,name:"Rename fields by regex",description:"Rename fields based on regular expression by users.",defaultOptions:{regex:"(.*)",renamePattern:"$1"},operator:fe=>Ee=>Ee.pipe((0,o.T)(Se=>!Array.isArray(Se)||Se.length===0?Se:Se.map(Z(fe))))},Z=fe=>Ee=>{const Se=(0,X.dO)(fe.regex),ye=Ee.fields.map(Ve=>{const Me=(0,m.Ct)(Ve,Ee);if(!Se.test(Me))return Ve;const Ce=Me.replace(Se,fe.renamePattern);return{...Ve,config:{...Ve.config,displayName:Ce},state:{...Ve.state,displayName:Ce}}});return{...Ee,fields:ye}};var q=e(2543),ae=e(37471),k=e(14236),se=e(19845);const te={id:l.F.seriesToRows,name:"Series to rows",description:"Combines multiple series into a single serie and appends a column with metric name per value.",defaultOptions:{},operator:fe=>Ee=>Ee.pipe((0,o.T)(Se=>{if(!Array.isArray(Se)||Se.length===0||(Se=Se.filter(Ue=>Ue.length>0),!(0,se.jq)(Se)))return Se;const ye={},Ve=new Set,Me=new ae.k,Ce={name:v.aI,values:[],config:{},type:v.PU.string};for(let Ue=0;Ue<Se.length;Ue++){const Ae=Se[Ue];for(let we=0;we<Ae.fields.length;we++){const We=Ae.fields[we];if(We.type===v.PU.time){ye[Ue]=we,Ve.has(v.LE)||(Me.addField(ne(We,v.LE)),Me.addField(Ce),Ve.add(v.LE));continue}Ve.has(v.Bc)||(Me.addField(ne(We,v.Bc)),Ve.add(v.Bc))}}for(let Ue=0;Ue<Se.length;Ue++){const Ae=Se[Ue];for(let we=0;we<Ae.length;we++){const We=ye[Ue],_e=We===0?1:0;Me.add({[v.LE]:Ae.fields[We].values[we],[v.aI]:(0,m.Ri)(Ae),[v.Bc]:Ae.fields[_e].values[we]})}}return[(0,k.ES)(Me,0,!0)]}))},ne=(fe,Ee)=>({...(0,q.omit)(fe,["values","state","labels","config","name"]),name:Ee,values:[],config:{...(0,q.omit)(fe.config,["displayName","displayNameFromDS"])}}),le={id:l.F.sortBy,name:"Sort by",description:"Sort fields in a frame.",defaultOptions:{fields:{}},operator:(fe,Ee)=>Se=>Se.pipe((0,o.T)(ye=>!Array.isArray(ye)||ye.length===0||!fe?.sort?.length?ye:re(ye,fe.sort,Ee)))};function re(fe,Ee,Se){return fe.map(ye=>{const Ve=de(ye,Ee,Se);return Ve.length&&Ve[0].index!=null?(0,k.ES)(ye,Ve[0].index,Ve[0].desc):ye})}function de(fe,Ee,Se){return Ee.map(ye=>ye.index!=null?ye:(0,A.w)()?{...ye,index:fe.fields.findIndex(Ve=>Se.interpolate(ye.field)===(0,m.Ct)(Ve,fe))}:{...ye,index:fe.fields.findIndex(Ve=>ye.field===(0,m.Ct)(Ve,fe))})}const oe={id:l.F.transpose,name:"Transpose",description:"Transpose the data frame",defaultOptions:{},operator:fe=>Ee=>Ee.pipe((0,o.T)(Se=>Se.length===0?Se:J(fe,Se)))};function J(fe,Ee){return Ee.map(Se=>{const ye=Se.fields[0],Ve=fe.firstFieldName?fe.firstFieldName:"Field",Me=fe.restFieldsName?fe.restFieldsName:"Value",Ce=ye.type===v.PU.string||ye.type===v.PU.time||ye.type===v.PU.enum,Ue=Ce?[Ve,...pe(ye,ye.values)]:[Ve,...ye.values.map((_e,at)=>Me)],Ae=Ce?Se.fields.map(_e=>_e.name).slice(1):Se.fields.map(_e=>_e.name),we=ce(Ce?Se.fields.map(_e=>_e.type).slice(1):Se.fields.map(_e=>_e.type)),We=Ue.map((_e,at)=>{if(at===0)return{name:Ve,type:v.PU.string,config:{},values:Ae};const ut=Se.fields.map(ge=>we===v.PU.string?pe(ge,[ge.values[at-1]])[0]:ge.values[at-1]),Tt=Ce?ye.name:"row",It=Ce?_e:at;return{name:Ce?Me:_e,labels:{[Tt]:It},type:we,config:{},values:Ce?ut.slice(1):ut}});return{...Se,fields:We,length:Math.max(...We.map(_e=>_e.values.length))}})}function ce(fe){const Ee=new Set(fe);return Ee.size===1?[...Ee][0]:v.PU.string}function pe(fe,Ee){switch(fe.type){case v.PU.time:case v.PU.number:case v.PU.boolean:case v.PU.string:return Ee.map(Se=>`${Se}`);case v.PU.enum:return Ee.map(Se=>fe.config.type.enum.text[Se]);default:return Ee.map(Se=>JSON.stringify(Se))}}const xe={noopTransformer:F.W,filterFieldsTransformer:r.z,filterFieldsByNameTransformer:g.D,filterFramesTransformer:r.I,filterFramesByRefIdTransformer:d,filterByValueTransformer:c.Sv,formatStringTransformer:h.yt,formatTimeTransformer:p,orderFieldsTransformer:V.x,organizeFieldsTransformer:N,reduceTransformer:Q.Wj,concatenateTransformer:n.vz,calculateFieldTransformer:t.SC,joinByFieldTransformer:B.L,seriesToColumnsTransformer:B.L,seriesToRowsTransformer:te,renameFieldsTransformer:w,labelsToFieldsTransformer:j.V,ensureColumnsTransformer:a.b,groupByTransformer:y.of,sortByTransformer:le,mergeTransformer:U.o,renameByRegexTransformer:ee,histogramTransformer:L.OA,convertFieldTypeTransformer:s.zM,groupingToMatrixTransformer:S,limitTransformer:W,groupToNestedTable:x._,transposeTransformer:oe}},66350:(G,R,e)=>{"use strict";e.d(R,{Bp:()=>y,SC:()=>C,UY:()=>f,Uj:()=>P,ip:()=>x,pR:()=>A,sw:()=>W});var t=e(2543),n=e.n(t),s=e(81160),a=e(14236),r=e(28240),g=e(39070),i=e(11261),l=e(11710),d=e(27618),c=e(75059),h=e(85200),o=e(1173),m=e(34125),u=e(18282),p=e(64586),f=(U=>(U.ReduceRow="reduceRow",U.CumulativeFunctions="cumulativeFunctions",U.WindowFunctions="windowFunctions",U.BinaryOperation="binary",U.UnaryOperation="unary",U.Index="index",U))(f||{}),y=(U=>(U.Percentage="percentage",U.Fixed="fixed",U))(y||{}),x=(U=>(U.Trailing="trailing",U.Centered="centered",U))(x||{});const v={reducer:c.gy.sum},P={reducer:c.gy.mean,windowAlignment:"trailing",windowSizeMode:"percentage",windowSize:.1},E={left:{fixed:""},operator:l.k.Add,right:{fixed:""}},D={operator:d._.Abs,fieldName:""},C={id:u.F.calculateField,name:"Add field from calculation",description:"Use the row values to calculate a new field",defaultOptions:{mode:"reduceRow",reduce:{reducer:c.gy.sum}},operator:(U,F)=>V=>{const w=U&&U.timeSeries!==!1?m.b.operator(null,F):p.W.operator({},F);return U.alias!=null&&(U.alias=F.interpolate(U.alias)),V.pipe(w,(0,s.T)(z=>{const N=U.mode??"reduceRow";let H;switch(N){case"reduceRow":H=L((0,t.defaults)(U.reduce,v),z);break;case"cumulativeFunctions":H=I((0,t.defaults)(U.cumulative,v),z);break;case"windowFunctions":H=b((0,t.defaults)(U.window,P),z);break;case"unary":H=K((0,t.defaults)(U.unary,D),z);break;case"binary":const Q=[];z.map(ee=>{ee.fields.map(Z=>{Q.push(Z.name)})});const X={left:A(U.binary?.left??"",Q),operator:U.binary?.operator??E.operator,right:A(U.binary?.right??"",Q)};if(U.binary=X,X.left?.matcher?.id&&X.left?.matcher.id===o.Ct.byType){const ee=X.left.matcher.options,Z=l.b.getIfExists(X.operator);return z.map(q=>{const{timeField:ae}=(0,a.KR)(q),k=[];return ae&&U.timeSeries!==!1&&k.push(ae),q.fields.map((se,te)=>{if(U.replaceFields||k.push(se),se.type===ee){const ne=se.values,le=B(q,X.right??E.right,z,F);if(!ne||!le||!Z)return;const re=new Array(ne.length);for(let oe=0;oe<re.length;oe++)re[oe]=Z.operation(ne[oe],le[oe]);const de={...se,name:`${se.name} ${U.binary?.operator??""} ${U.binary?.right.matcher?.options??U.binary?.right.fixed}`,values:re};k.push(de)}}),{...q,fields:k}})}else H=j((0,t.defaults)(X,E),z,F);break;case"index":return z.map(ee=>{const Z=[...Array(ee.length).keys()];if(U.index?.asPercentile)for(let ae=0;ae<Z.length;ae++)Z[ae]=Z[ae]/Z.length;const q={name:U.alias??"Row",type:i.PU.number,values:Z,config:U.index?.asPercentile?{unit:"percentunit"}:{}};return{...ee,fields:U.replaceFields?[q]:[...ee.fields,q]}})}return H?z.map(Q=>{const X=H(Q);if(!X)return Q;const ee={name:W(U),type:i.PU.number,config:{},values:X};let Z=[];if(U.replaceFields){const{timeField:q}=(0,a.KR)(Q);q&&U.timeSeries!==!1?Z=[q,ee]:Z=[ee]}else Z=[...Q.fields,ee];return{...Q,fields:Z}}):z}))}};function b(U,F){if(U.windowSize<=0)throw new Error("Add field from calculation transformation - Window size must be larger than 0");let V=(0,h.NS)({id:o.Ct.numeric});return U.field&&(V=(0,h.NS)({id:o.Ct.byNames,options:{names:[U.field]}})),w=>{const z=Math.ceil(U.windowSize*(U.windowSizeMode==="percentage"?w.length:1));let N=null;for(const H of w.fields)if(V(H,w,F)){N=H;break}if(N){if(![c.gy.mean,c.gy.stdDev,c.gy.variance].includes(U.reducer))throw new Error(`Add field from calculation transformation - Unsupported reducer: ${U.reducer}`);return U.windowAlignment==="centered"?S(w,U.reducer,N,z):T(w,U.reducer,N,z)}}}function T(U,F,V,w){const z=[];let N=0,H=0;for(let Q=0;Q<U.length;Q++)if(F===c.gy.mean){const X=V.values[Q];X!=null&&(H++,N+=X,Q>w-1&&(N-=V.values[Q-w],H--)),z.push(H===0?0:N/H)}else if(F===c.gy.variance){const X=Math.max(0,Q-w+1),ee=Q+1;z.push(O(V.values.slice(X,ee)))}else if(F===c.gy.stdDev){const X=Math.max(0,Q-w+1),ee=Q+1;z.push(M(V.values.slice(X,ee)))}return z}function S(U,F,V,w){const z=[];let N=0,H=0;const Q=Math.ceil(w/2)-1,X=Math.floor(w/2);for(let ee=0;ee<U.length;ee++){const Z=ee-X,q=ee+Q;if(F===c.gy.mean){if(ee===0)for(let ae=0;ae<Q+1&&ae<V.values.length;ae++)V.values[ae]!=null&&(N+=V.values[ae],H++);else q<V.values.length&&V.values[q]!=null&&(N+=V.values[q],H++),Z>0&&V.values[Z-1]!=null&&(N-=V.values[Z-1],H--);z.push(H===0?0:N/H)}else if(F===c.gy.variance){const ae=V.values.slice(Math.max(0,Z),Math.min(q+1,V.values.length));z.push(O(ae))}else if(F===c.gy.stdDev){const ae=V.values.slice(Math.max(0,Z),Math.min(q+1,V.values.length));z.push(M(ae))}}return z}function O(U){if(U.length<1)return 0;let F=0,V=0,w=0;for(let N=0;N<U.length;N++){const H=U[N];if(H!=null){w++;let Q=V;V+=(H-Q)/w,F+=(H-Q)*(H-V)}}return w===0?0:F/w}function M(U){return Math.sqrt(O(U))}function I(U,F){let V=(0,h.NS)({id:o.Ct.numeric});if(U.field&&(V=(0,h.NS)({id:o.Ct.byNames,options:{names:[U.field]}})),![c.gy.mean,c.gy.sum].includes(U.reducer))throw new Error(`Add field from calculation transformation - Unsupported reducer: ${U.reducer}`);return w=>{let z=null;for(const Q of w.fields)if(V(Q,w,F)){z=Q;break}if(!z)return;const N=[];let H=0;for(let Q=0;Q<w.length;Q++)H+=z.values[Q]??0,U.reducer===c.gy.sum?N.push(H):U.reducer===c.gy.mean&&N.push(H/(Q+1));return N}}function L(U,F){let V=(0,h.NS)({id:o.Ct.numeric});U.include&&U.include.length&&(V=(0,h.NS)({id:o.Ct.byNames,options:{names:U.include}}));const w=c.AS.get(U.reducer);if(!w)throw new Error(`Unknown reducer: ${U.reducer}`);const z=w.reduce??c.H3,N=U.nullValueMode===g.UW.Ignore,H=U.nullValueMode===g.UW.AsZero;return Q=>{const X=[];for(const ae of Q.fields)V(ae,Q,F)&&X.push(ae.values);const ee=X.length,Z={name:"temp",values:new Array(ee),type:i.PU.number,config:{}},q=[];for(let ae=0;ae<Q.length;ae++){for(let k=0;k<ee;k++)Z.values[k]=X[k][ae];q.push(z(Z,N,H)[U.reducer])}return q}}function B(U,F,V,w){if(!F)return;if(F.matcher&&F.matcher.id===o.Ct.byName){const N=w.interpolate(F.matcher.options??"");for(const H of U.fields)if(N===(0,r.Ct)(H,U,V))return H.type===i.PU.boolean?H.values.map(Q=>Q?1:0):H.values}const z=parseFloat(F.fixed??w.interpolate(F.matcher?.options??""));if(!isNaN(z))return new Array(U.length).fill(z)}function j(U,F,V){const w=l.b.getIfExists(U.operator);return z=>{const N=B(z,U.left,F,V),H=B(z,U.right,F,V);if(!N||!H||!w)return;const Q=new Array(N.length);for(let X=0;X<Q.length;X++)Q[X]=w.operation(N[X],H[X]);return Q}}function A(U,F){return typeof U=="string"?isNaN(Number(U))?{matcher:{id:o.Ct.byName,options:U}}:F.includes(U)?{matcher:{id:o.Ct.byName,options:U}}:{fixed:U}:U}function K(U,F){const V=d.j.getIfExists(U.operator);return w=>{let z=[];for(const H of w.fields)U.fieldName===(0,r.Ct)(H,w,F)&&H.type===i.PU.number&&(z=H.values);if(!z.length||!V)return;const N=new Array(z.length);for(let H=0;H<N.length;H++)N[H]=V.operation(z[H]);return N}}function W(U){if(U.alias?.length)return U.alias;switch(U.mode){case"cumulativeFunctions":{const{cumulative:F}=U;return`cumulative ${F?.reducer??""}${F?.field?`(${F.field})`:""}`}case"windowFunctions":{const{window:F}=U;return`${F?.windowAlignment??""} moving ${F?.reducer??""}${F?.field?`(${F.field})`:""}`}case"unary":{const{unary:F}=U;return`${F?.operator??""}${F?.fieldName?`(${F.fieldName})`:""}`}case"binary":{const{binary:F}=U;return`${F?.left?.matcher?.options??F?.left?.fixed??""} ${F?.operator??""} ${F?.right?.matcher?.options??F?.right?.fixed??""}`.replace(/\$/g,"")}case"reduceRow":{const F=c.AS.getIfExists(U.reduce?.reducer);if(F)return F.name}break;case"index":return"Row"}return"math"}},82150:(G,R,e)=>{"use strict";e.d(R,{vz:()=>r,x1:()=>a});var t=e(81160),n=e(11261),s=e(18282),a=(i=>(i.Drop="drop",i.FieldName="field",i.Label="label",i))(a||{});const r={id:s.F.concatenate,name:"Concatenate fields",description:"Combine all fields into a single frame.  Values will be appended with undefined values if not the same length.",defaultOptions:{frameNameMode:"field",frameNameLabel:"frame"},operator:i=>l=>l.pipe((0,t.T)(d=>!Array.isArray(d)||d.length<2?d:[g(d,i)]))};function g(i,l){let d=!0,c=i[0].length;const h=l.frameNameLabel??"frame";let o=[];for(const m of i){c!==m.length&&(d=!1,c=Math.max(c,m.length));for(const u of m.fields){const p={...u};p.state=void 0,m.name&&(l.frameNameMode==="drop"||(l.frameNameMode==="label"?(p.labels={...u.labels},p.labels[h]=m.name):!p.name||p.name===n.Bc?p.name=m.name:p.name=`${m.name} \xB7 ${u.name}`)),o.push(p)}}return d||(o=o.map(m=>{if(m.values.length===c)return m;const u=m.values.slice();return u.length=c,{...m,values:u}})),{fields:o,length:c}}},50311:(G,R,e)=>{"use strict";e.d(R,{Xv:()=>u,ks:()=>f,s7:()=>d,zM:()=>i});var t=e(81160),n=e(53531),s=e(11261),a=e(85200),r=e(1173),g=e(18282);const i={id:g.F.convertFieldType,name:"Convert field type",description:"Convert a field to a specified field type.",defaultOptions:{fields:{},conversions:[{targetField:void 0,destinationType:void 0,dateFormat:void 0,timezone:void 0}]},operator:(x,v)=>P=>P.pipe((0,t.T)(E=>i.transformer(x,v)(E))),transformer:x=>v=>!Array.isArray(v)||v.length===0?v:l(x,v)??[]};function l(x,v){if(!x.conversions.length)return v;const P=v.map(E=>({...E}));for(const E of x.conversions){if(!E.targetField)continue;const D=a.sJ.get(r.Ct.byName).get(E.targetField);for(const C of P)C.fields=C.fields.map(b=>D(b,C,P)?d(b,E):b)}return P}function d(x,v){switch(v.destinationType){case s.PU.time:return f(x,v.dateFormat);case s.PU.number:return o(x);case s.PU.string:return u(x,v.dateFormat,{timeZone:v.timezone},v.joinWith);case s.PU.boolean:return m(x);case s.PU.enum:return y(x,v.enumConfig);case s.PU.other:return p(x);default:return x}}const c=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d{3,})?(?:Z|[-+]\d{2}:?\d{2})$/;function h(x,v){let P=v?{format:v}:void 0;const E=x.values.slice();let D=E.find(b=>b!=null),C=typeof D=="string"&&c.test(D);for(let b=0;b<E.length;b++)if(E[b]){let T=C?Date.parse(E[b]):(0,n.b)(E[b],P).valueOf();E[b]=Number.isFinite(T)?T:null}else E[b]=null;return{...x,type:s.PU.time,values:E}}function o(x){const v=x.values.slice(),P=v.some(E=>typeof E=="string");for(let E=0;E<v.length;E++){let D=v[E];P&&D!=null&&typeof D=="string"&&(D=D.replace(/,/g,""));const C=+D;v[E]=Number.isFinite(C)?C:null}return{...x,type:s.PU.number,values:v}}function m(x){const v=x.values.slice();for(let P=0;P<v.length;P++)v[P]=!!v[P];return{...x,type:s.PU.boolean,values:v}}function u(x,v,P,E){let D=x.values;switch(x.type){case s.PU.time:D=D.map(C=>(0,n.b)(C,P).format(v));break;case s.PU.other:D=D.map(C=>E?.length&&Array.isArray(C)?C.join(E):JSON.stringify(C));break;default:D=D.map(C=>`${C}`)}return{...x,type:s.PU.string,values:D}}function p(x){const v=x.values.slice();for(let P=0;P<v.length;P++)try{v[P]=JSON.parse(v[P])}catch{v[P]=null}return{...x,type:s.PU.other,values:v}}function f(x,v){const P=typeof x.values[0]=="number";return x.type===s.PU.time&&P?x:P?{...x,type:s.PU.time}:h(x,v)}function y(x,v){const P={...v},E=x.values.slice(),D=new Map;if(P.text&&P.text.length>0)for(let C=0;C<P.text.length;C++)D.set(P.text[C],C);else return x;for(let C=0;C<E.length;C++){const b=E[C];E[C]=D.get(b)}return{...x,config:{...x.config,type:{enum:P}},type:s.PU.enum,values:E}}},34125:(G,R,e)=>{"use strict";e.d(R,{b:()=>r});var t=e(81160),n=e(14236),s=e(18282),a=e(41511);const r={id:s.F.ensureColumns,name:"Ensure Columns Transformer",description:"Will check if current data frames is series or columns. If in series it will convert to columns.",operator:(i,l)=>d=>d.pipe((0,t.T)(c=>r.transformer(i,l)(c))),transformer:(i,l)=>d=>{const c=g(d);return d.length>1&&c?a.L.transformer({byField:c},l)(d):d}};function g(i){let l;for(const d of i){const{timeField:c}=(0,n.KR)(d);if(!c)return;if(!l)l=c.name;else if(l!==c.name)return}return l}},64224:(G,R,e)=>{"use strict";e.d(R,{I:()=>g,z:()=>r});var t=e(81160),n=e(85200),s=e(18282),a=e(64586);const r={id:s.F.filterFields,name:"Filter Fields",description:"select a subset of fields",defaultOptions:{},operator:(i,l)=>d=>!i.include&&!i.exclude?d.pipe(a.W.operator({},l)):(typeof i.include?.options=="string"?i.include.options=l.interpolate(i.include?.options):typeof i.include?.options?.pattern=="string"&&(i.include.options.pattern=l.interpolate(i.include?.options.pattern)),typeof i.exclude?.options=="string"?i.exclude.options=l.interpolate(i.exclude?.options):typeof i.exclude?.options?.pattern=="string"&&(i.exclude.options.pattern=l.interpolate(i.exclude?.options.pattern)),d.pipe((0,t.T)(c=>{const h=i.include?(0,n.NS)(i.include):null,o=i.exclude?(0,n.NS)(i.exclude):null,m=[];for(const u of c){const p=[];for(let y=0;y<u.fields.length;y++){const x=u.fields[y];if(o){if(o(x,u,c))continue;h||p.push(x)}h&&h(x,u,c)&&p.push(x)}if(!p.length)continue;const f={...u,fields:p};m.push(f)}return m})))},g={id:s.F.filterFrames,name:"Filter Frames",description:"select a subset of frames",defaultOptions:{},operator:(i,l)=>d=>!i.include&&!i.exclude?d.pipe(a.W.operator({},l)):d.pipe((0,t.T)(c=>{const h=i.include?(0,n.Dq)(i.include):null,o=i.exclude?(0,n.Dq)(i.exclude):null,m=[];for(const u of c){if(o){if(o(u))continue;h||m.push(u)}h&&h(u)&&m.push(u)}return m}))}},35602:(G,R,e)=>{"use strict";e.d(R,{D:()=>a,R:()=>r});var t=e(1173),n=e(64224),s=e(18282);const a={id:s.F.filterFieldsByName,name:"Filter fields by name",description:"select a subset of fields",defaultOptions:{},operator:(g,i)=>l=>l.pipe(n.z.operator({include:r(i,g.include,g.byVariable),exclude:r(i,g.exclude,g.byVariable)},i))},r=(g,i,l)=>{if(!i)return;const{names:d,pattern:c,variable:h}=i;if(l&&h){const o=g.interpolate(h);if(/\{.*\}/.test(o)){const m=o.slice(1).slice(0,-1).split(",");return{id:t.Ct.byNames,options:{names:m}}}return{id:t.Ct.byNames,options:{names:o.split(",")}}}if(!((!Array.isArray(d)||d.length===0)&&!c))return c?!Array.isArray(d)||d.length===0?{id:t.Ct.byRegexp,options:c}:{id:t.Ct.byRegexpOrNames,options:i}:{id:t.Ct.byNames,options:{names:d}}}},73376:(G,R,e)=>{"use strict";e.d(R,{Sm:()=>d,Sv:()=>c,j4:()=>l});var t=e(81160),n=e(28240),s=e(85200),a=e(1173),r=e(18282),g=e(64586),i=e(67641),l=(m=>(m.exclude="exclude",m.include="include",m))(l||{}),d=(m=>(m.all="all",m.any="any",m))(d||{});const c={id:r.F.filterByValue,name:"Filter data by values",description:"select a subset of results based on values",defaultOptions:{filters:[],type:"include",match:"any"},operator:(m,u)=>p=>{const f=m.filters,y=m.match==="all",x=m.type==="include";if(!Array.isArray(f)||f.length===0)return p.pipe(g.W.operator({},u));const v=[];return(0,i.w)()&&v.push(...f.map(P=>{if(P.config.id===a.Js.between){let E=P.config.options.from,D=P.config.options.to;return typeof P.config.options.from=="string"&&(E=u.interpolate(E)),typeof P.config.options.to=="string"&&(D=u.interpolate(D)),{...P,config:{...P.config,options:{...P.config.options,to:D,from:E}}}}else if(P.config.options.value){let E=P.config.options.value;return typeof P.config.options.value=="string"&&(E=u.interpolate(E)),{...P,config:{...P.config,options:{...P.config.options,value:E}}}}return P})),p.pipe((0,t.T)(P=>{if(P.length===0)return P;const E=[];for(const D of P){const C=new Set,b=o(D,P);let T;(0,i.w)()?T=h(v,b):T=h(f,b);for(let M=0;M<D.length;M++){if(C.has(M))continue;let I=!0;for(const L of T){const B=L(M,D,P);if(!y&&B){I=!0;break}if(y&&!B){I=!1;break}I=B}I&&C.add(M)}const S=[],O=x?C.size:P[0].length-C.size;for(const M of D.fields){const I=[];for(let L=0;L<D.length;L++){if(x&&C.has(L)){I.push(M.values[L]);continue}if(!x&&!C.has(L)){I.push(M.values[L]);continue}}S.push({...M,values:I,state:{}})}E.push({...D,fields:S,length:O})}return E}))}},h=(m,u)=>{const p=()=>!1;return m.map(f=>{const y=u[f.fieldName]??-1;if(y<0)return console.warn(`[FilterByValue] Could not find index for field name: ${f.fieldName}`),p;const x=(0,s.kK)(f.config);return(v,P,E)=>x(v,P.fields[y],P,E)})},o=(m,u)=>{const p={};return m.fields.forEach((f,y)=>{const x=(0,n.Ct)(f,m,u);p[x]=y}),p}},15400:(G,R,e)=>{"use strict";e.d(R,{gs:()=>i,yt:()=>c});var t=e(81160),n=e(11261),s=e(81010),a=e(85200),r=e(1173),g=e(18282),i=(o=>(o.UpperCase="Upper Case",o.LowerCase="Lower Case",o.SentenceCase="Sentence Case",o.TitleCase="Title Case",o.PascalCase="Pascal Case",o.CamelCase="Camel Case",o.SnakeCase="Snake Case",o.KebabCase="Kebab Case",o.Trim="Trim",o.Substring="Substring",o))(i||{});const l=o=>{const m=o.split(" ");for(let u=0;u<m.length;u++)m[u]=m[u].charAt(0).toUpperCase()+m[u].slice(1).toLowerCase();return m},d=o=>m=>m.values.map(u=>{switch(o.outputFormat){case"Upper Case":return u.toUpperCase();case"Lower Case":return u.toLowerCase();case"Sentence Case":return u.charAt(0).toUpperCase()+u.slice(1);case"Title Case":return l(u).join(" ");case"Pascal Case":return l(u).join("");case"Camel Case":return u=l(u).join(""),u.charAt(0).toLowerCase()+u.slice(1);case"Snake Case":return u.toLowerCase().split(" ").join("_");case"Kebab Case":return u.toLowerCase().split(" ").join("-");case"Trim":return u.trim();case"Substring":return u.substring(o.substringStart,o.substringEnd)}}),c={id:g.F.formatString,name:"Format string",description:"Manipulate string fields formatting",defaultOptions:{stringField:"",outputFormat:"Upper Case"},isApplicable:o=>{for(const m of o)for(const u of m.fields)if(u.type==="string")return s.M.Applicable;return s.M.NotApplicable},operator:o=>m=>m.pipe((0,t.T)(u=>{if(u.length===0)return u;const p=a.sJ.get(r.Ct.byName).get(o.stringField),f=d(o),y=h(p,f);return u.map(x=>({...x,fields:y(x,u)}))}))},h=(o,m)=>(u,p)=>u.fields.map(f=>{if(o(f,u,p)){const y=m(f);return{...f,type:n.PU.string,values:y}}return f})},25094:(G,R,e)=>{"use strict";e.d(R,{Ce:()=>f,R3:()=>c,Y2:()=>p,of:()=>h});var t=e(81160),n=e(14236),s=e(28240),a=e(11261),r=e(81010),g=e(75059),i=e(18282),l=e(67641);const d=2;var c=(y=>(y.aggregate="aggregate",y.groupBy="groupby",y))(c||{});const h={id:i.F.groupBy,name:"Group by",description:"Group the data by a field values then process calculations for each group.",defaultOptions:{fields:{}},isApplicable:y=>(0,l.f)(y)>=d?r.M.Applicable:r.M.NotApplicable,isApplicableDescription:y=>{const x=(0,l.f)(y);return`The Group by transformation requires a series with at least ${d} fields to work. The maximum number of fields found on a series is ${x}`},operator:y=>x=>x.pipe((0,t.T)(v=>{if(!Object.keys(y.fields).find(D=>y.fields[D].operation==="groupby"))return v;const E=[];for(const D of v){const C=D.fields.filter(S=>o(S,y));if(C.length===0)continue;const b=p(D,C),T=f(C,b);for(const S of D.fields){if(!m(S,y))continue;const O=(0,s.Ct)(S),M=y.fields[O].aggregations,I={};b.forEach(L=>{const B=L[O],j=(0,g.Nw)({field:B,reducers:M});for(const A of M)Array.isArray(I[A])||(I[A]=[]),I[A].push(j[A])});for(const L of M){const B={name:`${O} (${L})`,values:I[L]??[],type:a.PU.other,config:{}};B.type=u(L,S,B),T.push(B)}}E.push({fields:T,length:b.size})}return E}))},o=(y,x)=>{const v=(0,s.Ct)(y);return x?.fields[v]?.operation==="groupby"},m=(y,x)=>{const v=(0,s.Ct)(y);return x?.fields[v]?.operation==="aggregate"&&Array.isArray(x?.fields[v].aggregations)&&x?.fields[v].aggregations.length>0};function u(y,x,v){switch(y){case g.gy.allIsNull:return a.PU.boolean;case g.gy.last:case g.gy.lastNotNull:case g.gy.first:case g.gy.firstNotNull:return x.type;default:return(0,n.dF)(v)??a.PU.string}}function p(y,x){const v=new Map;for(let P=0;P<y.length;P++){const E=String(x.map(C=>C.values[P])),D=v.get(E)??{};v.has(E)||v.set(E,D);for(let C of y.fields){const b=(0,s.Ct)(C);D[b]||(D[b]={name:b,type:C.type,config:{...C.config},values:[]}),D[b].values.push(C.values[P])}}return v}function f(y,x){const v=[];for(const P of y){const E=[],D=(0,s.Ct)(P);x.forEach(C=>{E.push(C[D].values[0])}),v.push({name:P.name,type:P.type,config:{...P.config},values:E})}return v}},68133:(G,R,e)=>{"use strict";e.d(R,{_:()=>m,l:()=>c});var t=e(81160),n=e(14236),s=e(28240),a=e(11261),r=e(81010),g=e(75059),i=e(25094),l=e(18282),d=e(67641);const c=!0,h=2;var o=(v=>(v.aggregate="aggregate",v.groupBy="groupby",v))(o||{});const m={id:l.F.groupToNestedTable,name:"Group to nested tables",description:"Group data by a field value and create nested tables with the grouped data",defaultOptions:{showSubframeHeaders:c,fields:{}},isApplicable:v=>(0,d.f)(v)>=h?r.M.Applicable:r.M.NotApplicable,isApplicableDescription:v=>{const P=(0,d.f)(v);return`The Group to nested table transformation requires a series with at least ${h} fields to work. The maximum number of fields found on a series is ${P}`},operator:v=>P=>P.pipe((0,t.T)(E=>{if(!Object.keys(v.fields).find(b=>v.fields[b].operation==="groupby"))return E;const C=[];for(const b of E){const T=b.fields.filter(I=>p(I,v));if(T.length===0)continue;const S=(0,i.Y2)(b,T),O=(0,i.Ce)(T,S),M=x(S,v);for(let I=0;I<b.fields.length;I++){const L=b.fields[I];if(!f(L,v))continue;const B=(0,s.Ct)(L),j=v.fields[B].aggregations,A={};S.forEach(K=>{const W=K[B],U=(0,g.Nw)({field:W,reducers:j});for(const F of j)Array.isArray(A[F])||(A[F]=[]),A[F].push(U[F])});for(const K of j){const W={name:`${B} (${K})`,values:A[K],type:a.PU.other,config:{}};W.type=y(K,L,W),O.push(W)}}O.push({config:{},name:"Nested frames",type:a.PU.nestedFrames,values:M}),C.push({fields:O,length:S.size})}return C}))};function u(v,P,E){return{meta:{custom:{noHeader:!(E.showSubframeHeaders===void 0?c:E.showSubframeHeaders)}},length:P,fields:v}}const p=(v,P)=>{const E=(0,s.Ct)(v);return P?.fields[E]?.operation==="groupby"},f=(v,P)=>{const E=(0,s.Ct)(v);return P?.fields[E]?.operation==="aggregate"&&Array.isArray(P?.fields[E].aggregations)&&P?.fields[E].aggregations.length>0},y=(v,P,E)=>{switch(v){case g.gy.allIsNull:return a.PU.boolean;case g.gy.last:case g.gy.lastNotNull:case g.gy.first:case g.gy.firstNotNull:return P.type;default:return(0,n.dF)(E)??a.PU.string}};function x(v,P){const E=[];for(const[,D]of v){const C=[];for(const[b,T]of Object.entries(D)){const S=P.fields[b];(S===void 0||S.aggregations===void 0||S.operation==="aggregate"&&S.aggregations.length===0||S.operation===null||S.operation===void 0)&&C.push(T)}C.length>0?E.push([u(C,C[0].values.length,P)]):E.push([u([],0,P)])}return E}},77678:(G,R,e)=>{"use strict";e.d(R,{H1:()=>P,NX:()=>x,OA:()=>f,Rt:()=>p,Uh:()=>b,ZU:()=>C,cg:()=>O,d$:()=>y,dA:()=>v,ix:()=>E,p3:()=>D,rW:()=>h,rs:()=>T});var t=e(81160),n=e(57875),s=e(75972),a=e(11261),r=e(41260),g=e(97706),i=e(18282),l=e(73060),d=e(39624),c=e(67641);const h=[1e-9,2e-9,25e-10,4e-9,5e-9,1e-8,2e-8,25e-9,4e-8,5e-8,1e-7,2e-7,25e-8,4e-7,5e-7,1e-6,2e-6,25e-7,4e-6,5e-6,1e-5,2e-5,25e-6,4e-5,5e-5,1e-4,2e-4,25e-5,4e-4,5e-4,.001,.002,.0025,.004,.005,.01,.02,.025,.04,.05,.1,.2,.25,.4,.5,1,2,4,5,10,20,25,40,50,100,200,250,400,500,1e3,2e3,2500,4e3,5e3,1e4,2e4,25e3,4e4,5e4,1e5,2e5,25e4,4e5,5e5,1e6,2e6,25e5,4e6,5e6,1e7,2e7,25e6,4e7,5e7,1e8,2e8,25e7,4e8,5e8,1e9,2e9,25e8,4e9,5e9],o=30,m=[],u=(M,I)=>M-I,p={bucketCount:{name:"Bucket count",description:"approx bucket count"},bucketSize:{name:"Bucket size",description:void 0},bucketOffset:{name:"Bucket offset",description:"for non-zero-based buckets"},combine:{name:"Combine series",description:"combine all series into a single histogram"}},f={id:i.F.histogram,name:"Histogram",description:"Calculate a histogram from input data.",defaultOptions:{fields:{}},operator:(M,I)=>L=>L.pipe((0,t.T)(B=>f.transformer(M,I)(B))),transformer:(M,I)=>L=>{if(!Array.isArray(L)||L.length===0)return L;let B,j;M.bucketSize&&((0,c.w)()&&(M.bucketSize=I.interpolate(M.bucketSize.toString())),typeof M.bucketSize=="string"?B=parseFloat(M.bucketSize):B=M.bucketSize,isNaN(B)&&(B=void 0)),M.bucketOffset&&((0,c.w)()&&(M.bucketOffset=I.interpolate(M.bucketOffset.toString())),typeof M.bucketOffset=="string"?j=parseFloat(M.bucketOffset):j=M.bucketOffset,isNaN(j)&&(j=void 0));const A={bucketSize:B,bucketOffset:j,combine:M.combine},K=D(L,A);return K==null?[]:[O(K)]}},y="xMin";function x(M){return M===y||M==="BucketMin"}const v="xMax";function P(M){return M===v||M==="BucketMax"}function E(M){if(M.meta?.type===r.m.HeatmapCells){let j=M.fields.find(w=>w.name==="yMin"),A=M.fields.find(w=>w.name==="yMax"),K=M.fields.find(w=>w.name==="count"),W=[...new Set(A.values)].sort((w,z)=>w-z),U=[...new Set(j.values)].sort((w,z)=>w-z),F=new Map;W.forEach(w=>F.set(w,0));for(let w=0;w<A.values.length;w++){let z=A.values[w];F.set(z,F.get(z)+K.values[w])}return{xMin:{...j,name:"xMin",values:U},xMax:{...A,name:"xMax",values:W},counts:[{...K,values:[...F.values()]}]}}else if(M.meta?.type===r.m.HeatmapRows){let j=[],A=[],K=[],W="0";return M.fields.forEach(F=>{if(F.type===a.PU.number){let V=F.values.reduce((w,z)=>w+z,0);K.push(V),j.push(W),A.push(W=F.name)}}),K.push(0),j.push(W),A.push(W),{xMin:{...M.fields[1],name:"xMin",type:a.PU.string,values:j},xMax:{...M.fields[1],name:"xMax",type:a.PU.string,values:A},counts:[{...M.fields[1],name:"count",type:a.PU.number,values:K}]}}let I,L;const B=[];for(const j of M.fields)x(j.name)?I=j:P(j.name)?L=j:j.type===a.PU.number&&B.push(j);if(!L&&I&&I.values.length>1){let j=I.values,A=(0,g.h)(j[1]-j[0],6);L={...I,name:v,values:j.map(K=>K+A)}}if(!I&&L&&L?.values.length>1){let j=L.values,A=(0,g.h)(j[1]-j[0],6);I={...L,name:y,values:j.map(K=>K-A)}}if(I&&L&&B.length)return{xMin:I,xMax:L,counts:B}}function D(M,I){let L=I?.bucketSize,B=I?.bucketCount??o,j=I?.bucketOffset??0;if(M=M.map(N=>({...N,fields:N.fields.map(H=>{if(H.type===a.PU.number){const Q=Number(H.config.noValue);Number.isNaN(Q)?H={...H,values:H.values.filter(X=>X!=null)}:H=(0,d.A)(H,Q)}return H})})),!L||L<0){let N=[];for(const q of M)for(const ae of q.fields)ae.type===a.PU.number&&(N=N.concat(ae.values));N.sort((q,ae)=>q-ae);let H=1/0;if(N.length===1)H=1;else for(let q=1;q<N.length;q++){let ae=N[q]-N[q-1];ae!==0&&(H=Math.min(H,ae))}let Q=N[0];const Z=(N[N.length-1]-Q)/B;for(let q=0;q<h.length;q++){let ae=h[q];if(Z<ae&&ae>=H){L=ae;break}}}const A=N=>(0,g.h)(T(N-j,L)+j,9);let K=((""+L).match(/\.\d+$/)??["."])[0].length-1,W=[],U=[],F;for(const N of M)for(const H of N.fields)if(H.type===a.PU.number){let Q=S(H.values,A,m,u);W.push(Q),U.push({...H,config:{...H.config,unit:H.config.unit==="short"?"short":void 0}}),!F&&H.config.unit&&(F=H.config)}if(!U.length)return null;let V=(0,l.fj)(W);for(let N=1;N<V.length;N++){let H=V[N];for(let Q=0;Q<H.length;Q++)H[Q]==null&&(H[Q]=0)}const w={name:y,values:V[0],type:a.PU.number,state:void 0,config:K===0?F??{}:{...F,decimals:K}},z={...w,name:v,values:V[0].map(N=>N+L)};if(I?.combine){const N=new Array(V[0].length).fill(0);for(let H=1;H<V.length;H++)for(let Q=0;Q<N.length;Q++)N[Q]+=V[H][Q];U=[{...U[0],name:"count",values:N,type:a.PU.number,state:{...U[0].state,displayName:"Count",multipleFrames:!1,origin:{frameIndex:0,fieldIndex:2}}}]}else U.forEach((N,H)=>{N.values=V[H+1]});return{xMin:w,xMax:z,counts:U}}function C(M,I){return Math.round(M/I)*I}function b(M,I){return Math.ceil(M/I)*I}function T(M,I){return Math.floor(M/I)*I}function S(M,I,L,B){let j=new Map;for(let U=0;U<M.length;U++){let F=M[U];F!=null&&(F=I(F));let V=j.get(F);V?V.count++:j.set(F,{value:F,count:1})}L&&L.forEach(U=>j.delete(U));let A=[...j.values()];B&&A.sort((U,F)=>B(U.value,F.value));let K=Array(A.length),W=Array(A.length);for(let U=0;U<A.length;U++)K[U]=A[U].value,W[U]=A[U].count;return[K,W]}function O(M,I){if(!M.xMin.display){const L=(0,n.J)({field:M.xMin,theme:I??(0,s.a)()});M.xMin.display=L,M.xMax.display=L}return M.counts[0].display=(0,n.J)({field:M.counts[0],theme:I??(0,s.a)()}),{length:M.xMin.values.length,meta:{type:r.m.Histogram},fields:[M.xMin,M.xMax,...M.counts]}}},41511:(G,R,e)=>{"use strict";e.d(R,{L:()=>i,W:()=>g});var t=e(81160),n=e(85200),s=e(1173),a=e(18282),r=e(73060),g=(l=>(l.outer="outer",l.inner="inner",l.outerTabular="outerTabular",l))(g||{});const i={id:a.F.joinByField,aliasIds:[a.F.seriesToColumns],name:"Join by field",description:"Combine rows from two or more tables, based on a related field between them.  This can be used to outer join multiple time series on the _time_ field to show many time series in one table.",defaultOptions:{byField:void 0,mode:"outer"},operator:(l,d)=>c=>c.pipe((0,t.T)(h=>i.transformer(l,d)(h))),transformer:(l,d)=>{let c;return h=>{if(h.length>1){l.byField&&!c&&(c=n.sJ.get(s.Ct.byName).get(d.interpolate(l.byField)));const o=(0,r.Fd)({frames:h,joinBy:c,mode:l.mode});if(o)return[o]}return h}}}},73060:(G,R,e)=>{"use strict";e.d(R,{Fd:()=>d,JI:()=>u,RC:()=>o,WO:()=>m,Yj:()=>l,fj:()=>f,g2:()=>y});var t=e(14236),n=e(11261),s=e(85200),a=e(1173),r=e(41511);function g(x){const{timeField:v}=(0,t.KR)(x[0]);if(v)return s.sJ.get(a.Ct.firstTimeField).get({});let P=[];for(const E of x[0].fields)E.type===n.PU.number&&P.push(E.name);for(let E=1;E<x.length;E++){const D=[];for(const C of x[0].fields)C.type===n.PU.number&&D.push(C.name);P=P.filter(C=>!D.includes(C))}return s.sJ.get(a.Ct.byName).get(P[0])}function i(x){return x.joinBy??g(x.frames)}function l(x,v){if(v>=0){let P=x.fields[v];P.type!==n.PU.string&&!y(P.values)&&(x=(0,t.ES)(x,v))}return x}function d(x){if(!x.frames?.length)return;const v=x.nullMode??(O=>{let M=O.config.custom?.spanNulls;return M===!0?o:M===-1?m:u});if(x.frames.length===1){let O=x.frames[0],M=O;const I=i(x);let L=M.fields.findIndex(B=>I(B,M,x.frames));if(x.keepOriginIndices&&(M={...O,fields:O.fields.map((B,j)=>{const A={...B},K={frameIndex:0,fieldIndex:j};return A.state?A.state.origin=K:A.state={origin:K},A})},L>0)){const B=M.fields[L],j=M.fields.filter((A,K)=>K!==L);j.unshift(B),M.fields=j,L=0}if(L>=0&&(M=l(M,L)),x.keep){let B=M.fields.filter((j,A)=>A===L||x.keep(j,M,x.frames));O!==M?M.fields=B:M={...O,fields:B}}return M}const P=[],E=[],D=[],C=[];let b=1;const T=i(x);for(let O=0;O<x.frames.length;O++){const M=x.frames[O];if(!M||!M.fields?.length)continue;const I=[o];let L,B=[],j=[];for(let K=0;K<M.fields.length;K++){const W=M.fields[K];if(W.state=W.state||{},!L&&T(W,M,x.frames))L=W;else{if(x.keep&&!x.keep(W,M,x.frames))continue;I.push(v(W));let U=W.labels??{},F=W.name;M.name&&(W.name===n.Bc?F=M.name:U.name==null&&(U={...U,name:M.name})),B.push({...W,name:F,labels:U})}x.keepOriginIndices&&(W.state.origin={frameIndex:O,fieldIndex:K})}if(!L)continue;D.length===0&&D.push(L),P.push(I);const A=[L.values];for(const K of B)A.push(K.values),D.push(K),x.keepDisplayNames||delete K.state?.displayName,j.push(b),b++;C.push(j),E.push(A)}let S=[];return x.mode===r.W.outerTabular?S=c(E,C,D.length,P):x.mode===r.W.inner?S=h(E):S=f(E,P,x.mode),{length:S[0]?S[0].length:0,fields:D.map((O,M)=>({...O,values:S[M]}))}}function c(x,v,P,E){let D={};for(let b=0;b<x.length;b++){let T=x[b],S=T[0];for(let O=0;O<x.length;O++){if(O===b)continue;let M=x[O],I=M[0];for(let L=0;L<S.length;L++){const B=S[L],j=P-1;let A=[B].concat(new Array(j)),K=0;for(let W=1;W<T.length;W++){const U=v[b][K];A[U]=T[W][L],K++}for(let W=0;W<I.length;W++)if(S[L]===I[W]){let U=0;for(let F=1;F<M.length;F++){const V=v[O][U];A[V]=M[F][W],U++}break}D[JSON.stringify(A)]=A}}}let C=[];for(let b=0;b<P;b++)C.push(new Array(0));for(let b in D){const T=D[b];for(let S=0;S<T.length;S++)C[S].push(T[S])}return C}function h(x){const v=[],P=(E,D,C)=>{if(D===E.length){v.push(C);return}const b=E[D],[T,...S]=b;for(let O=0;O<T.length;O++){const M=T[O];if(D===0||C.includes(M)){const I=[...C];D===0&&I.push(M);for(let L=0;L<S.length;L++)I.push(S[L][O]);P(E,D+1,I)}}};if(P(x,0,[]),v.length===0){const E=x.reduce((D,C)=>D+(C.length-1),1);return Array.from({length:E},()=>[])}return v[0].map((E,D)=>v.map(C=>C[D]))}const o=0,m=1,u=2;function p(x,v,P){for(let E=0,D,C=-1;E<v.length;E++){let b=v[E];if(b>C){for(D=b-1;D>=0&&x[D]==null;)x[D--]=null;for(D=b+1;D<P&&x[D]==null;)x[C=D++]=null}}}function f(x,v,P=r.W.outer){let E=new Set;for(let T=0;T<x.length;T++){let O=x[T][0],M=O.length;for(let I=0;I<M;I++)E.add(O[I])}let D=[Array.from(E).sort((T,S)=>T-S)],C=D[0].length,b=new Map;for(let T=0;T<C;T++)b.set(D[0][T],T);for(let T=0;T<x.length;T++){let S=x[T],O=S[0];for(let M=1;M<S.length;M++){let I=S[M],L=Array(C).fill(void 0),B=v?v[T][M]:m,j=[];for(let A=0;A<I.length;A++){let K=I[A],W=b.get(O[A]);K===null?B!==o&&(L[W]=K,B===u&&j.push(W)):L[W]=K}p(L,j,C),D.push(L)}}return D}function y(x,v=50){const P=x.length;if(P<=1)return!0;let E=0,D=P-1;for(;E<=D&&x[E]==null;)E++;for(;D>=E&&x[D]==null;)D--;if(D<=E)return!0;const C=Math.max(1,Math.floor((D-E+1)/v));for(let b=x[E],T=E+C;T<=D;T+=C){const S=x[T];if(S!=null&&b!=null){if(S<=b)return!1;b=S}}return!0}},6829:(G,R,e)=>{"use strict";e.d(R,{V:()=>g,n:()=>r});var t=e(81160),n=e(28240),s=e(11261),a=e(18282),r=(l=>(l.Columns="columns",l.Rows="rows",l))(r||{});const g={id:a.F.labelsToFields,name:"Labels to fields",description:"Extract time series labels to fields (columns or rows)",defaultOptions:{},operator:(l,d)=>c=>c.pipe((0,t.T)(h=>g.transformer(l,d)(h))),transformer:l=>d=>{if(l.mode==="rows")return i(d,l.keepLabels);const c=[],h=l.keepLabels?.length?new Set(l.keepLabels):void 0;for(const o of d){const m=[],u={};for(const p of o.fields){if(!p.labels){m.push(p);continue}const f={...p,config:{...p.config,displayName:void 0,displayNameFromDS:void 0},labels:void 0};m.push(f);for(const y of Object.keys(p.labels)){if(h&&!h.has(y))continue;if(l.valueLabel===y){f.name=p.labels[y];continue}(u[y]??(u[y]=new Set)).add(p.labels[y])}}for(const p in u)for(const f of u[p]){const y=new Array(o.length).fill(f);m.push({name:p,type:s.PU.string,values:y,config:{}})}c.push({...o,fields:m,length:o.length})}return c}};function i(l,d){const c=[];for(const h of l)for(const o of h.fields)if(o.labels){const m=[],u=[];if(d)for(const p of d)m.push(p),u.push(o.labels[p]);else for(const[p,f]of Object.entries(o.labels))m.push(p),u.push(f);u.length&&c.push({...h,name:(0,n.Ct)(o,h,l),fields:[{name:"label",type:s.PU.string,config:{},values:m},{name:"value",type:s.PU.string,config:{},values:u}],length:u.length})}return c}},58140:(G,R,e)=>{"use strict";e.d(R,{o:()=>i});var t=e(2543),n=e.n(t),s=e(81160),a=e(37471),r=e(81010),g=e(18282);const i={id:g.F.merge,name:"Merge series/tables",description:"Merges multiple series/tables into a single serie/table",defaultOptions:{},isApplicable:u=>u.length>1?r.M.Applicable:r.M.NotApplicable,isApplicableDescription:u=>`The merge transformation requires at least 2 data series to work. There is currently ${u.length} data series.`,operator:u=>p=>p.pipe((0,s.T)(f=>{if(!Array.isArray(f)||f.length<=1)return f;const y=f.filter(S=>S.fields.length>0);if(y.length===0)return[f[0]];const x=new Set,v={},P=[],E=new a.k;for(let S=0;S<y.length;S++){const O=y[S];for(let M=0;M<O.fields.length;M++){const I=O.fields[M];x.has(I.name)||(E.addField(l(I)),x.add(I.name)),v[I.name]=v[I.name]||{},v[I.name][S]=M,y.length-1===S&&o(v,I,y)&&P.push(I.name)}}if(P.length===0)return f;const D={},C=[],b=d(y,v,P),T=c(y,x,v);for(let S=0;S<y.length;S++){const O=y[S];for(let M=0;M<O.length;M++){const I=b(S,M),L=T(S,M);if(!Array.isArray(D[I])){D[I]=[L],C.push(m(I,D));continue}let B=!1;D[I]=D[I].map(j=>h(j,L)?(B=!0,{...j,...L}):j),B||(D[I].push(L),C.push(m(I,D)))}}for(const S of C){const O=D[S.key][S.index];O&&E.add(O)}return[E]}))},l=u=>({...(0,t.omit)(u,["values","state","labels","config"]),values:[],config:{...(0,t.omit)(u.config,"displayName")}}),d=(u,p,f)=>{const y=f.reduce((x,v)=>Object.keys(p[v]).reduce((P,E)=>(P[E]=P[E]||[],P[E].push(p[v][E]),P),x),{});return(x,v)=>y[x].reduce((P,E)=>P+u[x].fields[E].values[v],"")},c=(u,p,f)=>(y,x)=>{const v={},P=Array.from(p);for(const E of P){const D=f[E];if(!D)continue;const C=D[y];if(typeof C!="number")continue;const b=u[y];if(!b||!b.fields)continue;const T=b.fields[C];!T||!T.values||(v[E]=T.values[x])}return v},h=(u,p)=>{let f=!0;for(const y in p)if(!(typeof u[y]>"u")&&u[y]!==null&&u[y]!==p[y]){f=!1;break}return f},o=(u,p,f)=>Object.keys(u[p.name]).length===f.length,m=(u,p)=>({key:u,index:p[u].length-1})},64586:(G,R,e)=>{"use strict";e.d(R,{W:()=>n});var t=e(18282);const n={id:t.F.noop,name:"noop",description:"No-operation transformer",defaultOptions:{},operator:s=>a=>a,transformer:s=>a=>a}},46294:(G,R,e)=>{"use strict";e.d(R,{M:()=>a});var t=e(11261);const n={threshold:(g,i,l)=>g+l,midpoint:(g,i,l)=>(g+i)/2,plusone:(g,i,l)=>g+1};function s(g,i){return g.fields.find(l=>i!=null?l.name===i:l.type===t.PU.time)}function a(g){if(g.frame.length===0)return g.frame;let i=!0,{frame:l,refFieldName:d,refFieldPseudoMax:c,refFieldPseudoMin:h,insertMode:o}=g;o||(o=n.threshold);const m=s(l,d);if(m==null)return l;m.state={...m.state,nullThresholdApplied:!0};const u=l.fields.map(f=>f.config.custom?.insertNulls||m.config.interval||null),p=new Set(u);if(p.delete(null),p.size===0)return l;if(p.size===1){const f=p.values().next().value;if(f<=0)return l;const y=m.values,x=l.fields.map(P=>P.values),v=r(y,x,f,h,c,o,i);return v===x?l:{...l,length:v[0].length,fields:l.fields.map((P,E)=>({...P,values:v[E]}))}}return l}function r(g,i,l,d=null,c=null,h,o){const m=g.length,u=[];if(d!=null&&d<g[0]){let x=Math.ceil((g[0]-d)/l),v=g[0]-x*l;for(;v<g[0];)u.push(h(v-l,v,l)),v+=l}u.push(g[0]);let p=g[0];for(let x=1;x<m;x++){const v=g[x];for(;v-p>l&&(u.push(h(p,v,l)),p+=l,!!o););u.push(v),p=v}if(c!=null&&c>p)for(;p+l<c;)u.push(h(p,c,l)),p+=l;const f=u.length;if(f===m)return i;const y=[];for(let x of i){let v;if(x!==g){v=Array(f);for(let P=0,E=0;P<f;P++)v[P]=g[E]===u[P]?x[E++]:null}else v=u;y.push(v)}return y}},39624:(G,R,e)=>{"use strict";e.d(R,{A:()=>n,C:()=>t});function t(s){return{...s,fields:s.fields.map(a=>{const r=Number(a.config.noValue);return Number.isNaN(r)?a:n(a,r)})}}function n(s,a){const r=s.values.slice();for(let g=0;g<r.length;g++)r[g]===null&&(r[g]=a);return{...s,values:r}}},82280:(G,R,e)=>{"use strict";e.d(R,{X:()=>i,x:()=>g});var t=e(2543),n=e.n(t),s=e(81160),a=e(28240),r=e(18282);const g={id:r.F.order,name:"Order fields by name",description:"Order fields based on configuration given by user",defaultOptions:{indexByName:{}},operator:c=>h=>h.pipe((0,s.T)(o=>{const m=l(c.indexByName);return!Array.isArray(o)||o.length===0?o:o.map(u=>({...u,fields:m(u.fields,o,u)}))}))},i=c=>(h,o)=>d(h,c)-d(o,c),l=c=>(h,o,m)=>{if(!Array.isArray(h)||h.length===0||!c||Object.keys(c).length===0)return h;const u=i(c);return(0,t.clone)(h).sort((p,f)=>u((0,a.Ct)(p,m,o),(0,a.Ct)(f,m,o)))},d=(c,h)=>Number.isInteger(h[c])?h[c]:Number.MAX_SAFE_INTEGER},21128:(G,R,e)=>{"use strict";e.d(R,{Wj:()=>c,rV:()=>d});var t=e(81160),n=e(14236),s=e(28240),a=e(11261),r=e(75059),g=e(85200),i=e(72693),l=e(18282),d=(f=>(f.SeriesToRows="seriesToRows",f.ReduceFields="reduceFields",f))(d||{});const c={id:l.F.reduce,name:"Reduce",description:"Reduce all rows or data points to a single value using a function like max, min, mean or last.",defaultOptions:{reducers:[r.gy.max]},operator:f=>y=>y.pipe((0,t.T)(x=>{if(!f?.reducers?.length)return x;const v=f.fields?(0,g.NS)(f.fields):f.includeTimeField&&f.mode==="reduceFields"?i.Yg:i.zx;if(f.mode==="reduceFields")return u(x,v,f.reducers);const P=h(x,v,f.reducers,f.labelsToFields);return P?[P]:[]}))};function h(f,y,x,v){const P=r.AS.list(x),E=P.map(b=>b.id),D=[],C=v?o(f):[];for(const b of f){const T=b.fields.filter(B=>y(B,b,f)),S=T.length,O=[],M=new Array(S);O.push({name:"Field",type:a.PU.string,values:M,config:{}});const I={};if(v)for(const B of C)I[B]=new Array(S),O.push({name:B,type:a.PU.string,values:I[B],config:{}});const L={};for(const B of P)L[B.id]=new Array(S),O.push({name:B.name,type:a.PU.other,values:L[B.id],config:{}});for(let B=0;B<T.length;B++){const j=T[B],A=(0,r.Nw)({field:j,reducers:E});if(v){if(M[B]=j.name,j.labels)for(const K in j.labels)I[K][B]=j.labels[K]}else M[B]=(0,s.Ct)(j,b,f);for(const K of P){const W=A[K.id];W===null?L[K.id][B]=NaN:L[K.id][B]=W}}for(const B of O)if(B.type===a.PU.other){const j=(0,n.dF)(B);j&&(B.type=j)}D.push({...b,fields:O,length:S})}return m(D)}function o(f){const y=new Set;for(const x of f)for(const v of x.fields)if(v.labels)for(const P of Object.keys(v.labels))y.add(P);return[...y]}function m(f){if(!f?.length)return;const y=f[0];for(let x=1;x<f.length;x++){const v=f[x];for(let P=0;P<y.fields.length;P++){const E=y.fields[P];for(let D=0;D<v.fields.length;D++){const C=v.fields[D],b=P===0&&D===0,T=E.type===C.type&&E.name===C.name;if(b||T){const S=E.values,O=C.values;E.values=S.concat(O)}}}}return y.name=void 0,y.length=y.fields[0].values.length,y}function u(f,y,x){const P=r.AS.list(x).map(D=>D.id),E=[];for(const D of f){const C=[];for(const b of D.fields)if(y(b,D,f)){const T=(0,r.Nw)({field:b,reducers:P});for(const S of P){const O=T[S],M={...b,type:p(S,b),values:[O]};M.state=void 0,P.length>1&&(M.labels||(M.labels={}),M.labels.reducer=r.AS.get(S).name),C.push(M)}}C.length&&E.push({...D,fields:C,length:1})}return E}function p(f,y){switch(f){case r.gy.allValues:case r.gy.uniqueValues:return a.PU.other;case r.gy.first:case r.gy.firstNotNull:case r.gy.last:case r.gy.lastNotNull:return y.type;default:return a.PU.number}}},67641:(G,R,e)=>{"use strict";e.d(R,{f:()=>n,w:()=>t});const t=()=>window?.grafanaBootData?.settings?.featureToggles?.transformationsVariableSupport;function n(s){let a=0;for(const r of s)r.fields.length>a&&(a=r.fields.length);return a}},83580:(G,R,e)=>{"use strict";e.d(R,{DO:()=>n,Ur:()=>a,ki:()=>s,mx:()=>r});var t=(g=>(g.Fetch="fetch",g))(t||{}),n=(g=>(g.POST="POST",g.PUT="PUT",g.GET="GET",g))(n||{});const s=[{label:"POST",value:"POST"},{label:"PUT",value:"PUT"},{label:"GET",value:"GET"}],a=[{label:"application/json",value:"application/json"},{label:"text/plain",value:"text/plain"},{label:"application/xml",value:"application/xml"},{label:"application/x-www-form-urlencoded",value:"application/x-www-form-urlencoded"}],r={type:"fetch",title:"",fetch:{url:"",method:"POST",body:"{}",queryParams:[],headers:[["Content-Type","application/json"]]}}},43585:(G,R,e)=>{"use strict";e.d(R,{O:()=>t});var t=(n=>(n.NoData="no_data",n.Paused="paused",n.Alerting="alerting",n.OK="ok",n.Pending="pending",n.Unknown="unknown",n))(t||{})},8790:(G,R,e)=>{"use strict";e.d(R,{V:()=>t});var t=(n=>(n.Field="field",n.Text="text",n.Skip="skip",n))(t||{})},41987:(G,R,e)=>{"use strict";e.d(R,{Ay:()=>a,Jk:()=>n,hX:()=>s});var t=e(43429),n=(r=>(r.CloudAlerting="cloud-alerting",r.UnifiedAlerting="unified-alerting",r.Dashboard="dashboard",r.Explore="explore",r.Correlations="correlations",r.Unknown="unknown",r.PanelEditor="panel-editor",r.PanelViewer="panel-viewer",r))(n||{});class s extends t.Ud{constructor(){super(...arguments),this._exposedComponentConfigs=[],this._addedComponentConfigs=[],this._addedLinkConfigs=[]}init(g){}setRootPage(g){return this.root=g,this}setComponentsFromLegacyExports(g){if(g.ConfigCtrl&&(this.angularConfigCtrl=g.ConfigCtrl),this.meta&&this.meta.includes){for(const i of this.meta.includes)if(i.type===t.ib.page&&i.component&&!g[i.component]){console.warn("App Page uses unknown component: ",i.component,this.meta);continue}}}get exposedComponentConfigs(){return this._exposedComponentConfigs}get addedComponentConfigs(){return this._addedComponentConfigs}get addedLinkConfigs(){return this._addedLinkConfigs}addLink(g){return this._addedLinkConfigs.push(g),this}addComponent(g){return this._addedComponentConfigs.push(g),this}exposeComponent(g){return this._exposedComponentConfigs.push(g),this}configureExtensionLink(g){return this.addLink({targets:[g.extensionPointId],...g}),this}configureExtensionComponent(g){return this.addComponent({targets:[g.extensionPointId],...g,component:g.component}),this}}var a=(r=>(r.alpha="alpha",r.beta="beta",r.experimental="experimental",r.privatePreview="private preview",r.preview="preview",r))(a||{})},61268:(G,R,e)=>{"use strict";e.d(R,{r:()=>t});var t=(n=>(n.OpenSource="Open Source",n.Pro="Pro",n.Enterprise="Enterprise",n))(t||{})},58649:(G,R,e)=>{"use strict";e.d(R,{En:()=>s,d1:()=>n,tw:()=>t});const t=0,n=100,s="SAML"},94624:(G,R,e)=>{"use strict";e.d(R,{y:()=>t});var t=(n=>(n[n.Off=0]="Off",n[n.Crosshair=1]="Crosshair",n[n.Tooltip=2]="Tooltip",n))(t||{})},39070:(G,R,e)=>{"use strict";e.d(R,{Gu:()=>t,Gv:()=>g,Nx:()=>n,UW:()=>s,zz:()=>a});var t=(i=>(i.NotStarted="NotStarted",i.Loading="Loading",i.Streaming="Streaming",i.Done="Done",i.Error="Error",i))(t||{});const n=["graph","table","logs","trace","nodeGraph","flamegraph","rawPrometheus"];var s=(i=>(i.Null="null",i.Ignore="connected",i.AsZero="null as zero",i))(s||{});const a=i=>!!i;function r(i){return i}function g(i){return typeof i=="object"&&i!==null?!0:!1}},41260:(G,R,e)=>{"use strict";e.d(R,{m:()=>t});var t=(n=>(n.TimeSeriesWide="timeseries-wide",n.TimeSeriesLong="timeseries-long",n.TimeSeriesMany="timeseries-many",n.TimeSeriesMulti="timeseries-multi",n.NumericWide="numeric-wide",n.NumericMulti="numeric-multi",n.NumericLong="numeric-long",n.LogLines="log-lines",n.DirectoryListing="directory-listing",n.HeatmapRows="heatmap-rows",n.HeatmapCells="heatmap-cells",n.Histogram="histogram",n))(t||{})},91890:(G,R,e)=>{"use strict";e.d(R,{$0:()=>s,CC:()=>n,uP:()=>a,x0:()=>t,yd:()=>r});var t=(g=>(g.Datasource="Datasource",g.Correlations="Correlations",g.ExploreCorrelationsEditor="CorrelationsEditor",g))(t||{}),n=(g=>(g.Regex="regex",g.Logfmt="logfmt",g))(n||{}),s=(g=>(g.Series="series",g.Field="field",g.Fields="fields",g.Value="value",g.BuiltIn="built-in",g.Template="template",g))(s||{}),a=(g=>(g.Values="values",g))(a||{}),r=(g=>(g.Action="action",g.Link="link",g.Off="off",g))(r||{})},40187:(G,R,e)=>{"use strict";e.d(R,{Is:()=>i,ZF:()=>r,mA:()=>a,tD:()=>s,v2:()=>g});var t=e(92341),n=e(43429);class s extends n.Ud{constructor(d){super(),this.DataSourceClass=d,this.components={}}setConfigEditor(d){return this.components.ConfigEditor=d,this}setConfigCtrl(d){return this.angularConfigCtrl=d,this}setQueryCtrl(d){return this.components.QueryCtrl=d,this}setAnnotationQueryCtrl(d){return this.components.AnnotationsQueryCtrl=d,this}setQueryEditor(d){return this.components.QueryEditor=d,this}setExploreQueryField(d){return this.components.ExploreQueryField=d,this}setExploreMetricsQueryField(d){return this.components.ExploreMetricsQueryField=d,this}setExploreLogsQueryField(d){return this.components.ExploreLogsQueryField=d,this}setQueryEditorHelp(d){return this.components.QueryEditorHelp=d,this}setExploreStartPage(d){return this.setQueryEditorHelp(d)}setVariableQueryEditor(d){return this.components.VariableQueryEditor=d,this}setMetadataInspector(d){return this.components.MetadataInspector=d,this}setComponentsFromLegacyExports(d){this.angularConfigCtrl=d.ConfigCtrl,this.components.QueryCtrl=d.QueryCtrl,this.components.AnnotationsQueryCtrl=d.AnnotationsQueryCtrl,this.components.ExploreQueryField=d.ExploreQueryField,this.components.QueryEditor=d.QueryEditor,this.components.QueryEditorHelp=d.QueryEditorHelp,this.components.VariableQueryEditor=d.VariableQueryEditor}}class a{constructor(d){this.name=d.name,this.id=d.id,this.type=d.type,this.meta=d.meta,this.cachingConfig=d.cachingConfig,this.uid=d.uid,this.apiVersion=d.apiVersion}filterQuery(d){return!0}getRef(){const d={type:this.type,uid:this.uid};return this.apiVersion&&(d.apiVersion=this.apiVersion),d}}var r=(l=>(l.Logs="Logs",l.Metrics="Metrics",l.Tracing="Tracing",l))(r||{}),g=(l=>(l.Cancelled="cancelled",l.Timeout="timeout",l.Unknown="unknown",l))(g||{});class i{}i=(0,t.Y)(i),a=(0,t.Y)(a)},37055:(G,R,e)=>{"use strict";e.d(R,{Ow:()=>n,ZW:()=>t,uo:()=>s});function t(a){return r=>"__systemRef"in r&&r.__systemRef===a}const n=a=>"__systemRef"in a&&typeof a.__systemRef=="string";var s=(a=>(a.Unit="unit",a.Min="min",a.Max="max",a.FieldMinMax="fieldMinMax",a.Decimals="decimals",a.DisplayName="displayName",a.NoValue="noValue",a.Thresholds="thresholds",a.Mappings="mappings",a.Links="links",a.Color="color",a.Filterable="filterable",a))(s||{})},19484:(G,R,e)=>{"use strict";e.d(R,{R:()=>t});var t=(n=>(n.Grid="grid",n.List="list",n))(t||{})},26272:(G,R,e)=>{"use strict";e.d(R,{Tq:()=>g,ee:()=>a,kb:()=>r,r1:()=>s});var t=e(89550),n=e(65463);const s={alertSuccess:(0,t.R)("alert-success"),alertWarning:(0,t.R)("alert-warning"),alertError:(0,t.R)("alert-error"),alertInfo:(0,t.R)("alert-info")},a={refresh:(0,t.R)("refresh"),componentDidMount:(0,t.R)("component-did-mount"),dataReceived:(0,t.R)("data-received"),dataError:(0,t.R)("data-error"),dataFramesReceived:(0,t.R)("data-frames-received"),dataSnapshotLoad:(0,t.R)("data-snapshot-load"),editModeInitialized:(0,t.R)("init-edit-mode"),initPanelActions:(0,t.R)("init-panel-actions"),initialized:(0,t.R)("panel-initialized"),panelTeardown:(0,t.R)("panel-teardown"),render:(0,t.R)("render")};class r extends n.x{static{this.type="graph-hover"}}class g extends n.a{constructor(){super(...arguments),this.payload={point:{}}}static{this.type="graph-hover-clear"}}},55004:(G,R,e)=>{"use strict";e.d(R,{Cz:()=>g,DG:()=>d,Qp:()=>h,Z7:()=>l,ZF:()=>s,aj:()=>c,ew:()=>r,jQ:()=>i,o4:()=>a,os:()=>n,qD:()=>t});var t=(o=>(o.DataSource="ds",o.Plugin="plugin",o.Grafana="grafana",o.Stream="stream",o))(t||{}),n=(o=>(o.DataStream="stream",o.DataFrame="frame",o.JSON="json",o))(n||{}),s=(o=>(o.Pending="pending",o.Connected="connected",o.Connecting="connecting",o.Disconnected="disconnected",o.Shutdown="shutdown",o.Invalid="invalid",o))(s||{}),a=(o=>(o.Status="status",o.Join="join",o.Leave="leave",o.Message="message",o))(a||{});function r(o){return o.type==="status"}function g(o){return o.type==="join"}function i(o){return o.type==="leave"}function l(o){return o.type==="message"}function d(o){if(o?.length){let m=o.trim().split("/");if(m.length>=3)return{scope:m[0],namespace:m[1],path:m.slice(2).join("/")}}}function c(o){return!!(o?.path&&o.namespace&&o.scope)}function h(o){if(!o.scope)return"";let m=o.scope;return!o.namespace||(m+="/"+o.namespace,!o.path)?m:m+"/"+o.path}},9557:(G,R,e)=>{"use strict";e.d(R,{$b:()=>t,Aj:()=>l,FP:()=>h,Nc:()=>d,Ol:()=>g,ZF:()=>r,_0:()=>o,_C:()=>a,cF:()=>i,s5:()=>n,tG:()=>s,wj:()=>c});var t=(m=>(m.emerg="critical",m.fatal="critical",m.alert="critical",m.crit="critical",m.critical="critical",m.warn="warning",m.warning="warning",m.err="error",m.eror="error",m.error="error",m.info="info",m.information="info",m.informational="info",m.notice="info",m.dbug="debug",m.debug="debug",m.trace="trace",m.unknown="unknown",m))(t||{});const n={0:"critical",1:"critical",2:"critical",3:"error",4:"warning",5:"info",6:"info",7:"debug"};var s=(m=>(m[m.Number=0]="Number",m[m.String=1]="String",m[m.LabelsMap=2]="LabelsMap",m[m.Error=3]="Error",m))(s||{}),a=(m=>(m.none="No de-duplication",m.exact="De-duplication of successive lines that are identical, ignoring ISO datetimes.",m.numbers="De-duplication of successive lines that are identical when ignoring numbers, e.g., IP addresses, latencies.",m.signature="De-duplication of successive lines that have identical punctuation and whitespace.",m))(a||{}),r=(m=>(m.Backward="BACKWARD",m.Forward="FORWARD",m))(r||{});const g=m=>!m||typeof m!="object"?!1:"getLogRowContext"in m;var i=(m=>(m.LogsVolume="LogsVolume",m.LogsSample="LogsSample",m))(i||{}),l=(m=>(m.FullRange="FullRange",m.Limited="Limited",m))(l||{});const d=(m,u)=>m?("getDataProvider"in m||"getSupplementaryRequest"in m)&&"getSupplementaryQuery"in m&&"getSupportedSupplementaryQueryTypes"in m&&m.getSupportedSupplementaryQueryTypes().includes(u):!1,c=m=>!m||typeof m!="object"?!1:"getLogRowContextUi"in m,h=m=>m!=null&&typeof m=="object"&&"toggleQueryFilter"in m&&"queryHasFilter"in m,o=m=>m!=null&&typeof m=="object"&&"modifyQuery"in m&&"getSupportedQueryModifications"in m},64388:(G,R,e)=>{"use strict";e.d(R,{k:()=>t});var t=(n=>(n[n.Standard=0]="Standard",n[n.Canvas=1]="Canvas",n[n.Custom=2]="Custom",n))(t||{})},47070:(G,R,e)=>{"use strict";e.d(R,{NV:()=>i,nQ:()=>r,v2:()=>g,wV:()=>a});var t=e(2543),n=e.n(t),s=e(11261),a=(l=>(l.Auto="auto",l.Vertical="vertical",l.Horizontal="horizontal",l))(a||{}),r=(l=>(l[l.Best=100]="Best",l[l.Good=70]="Good",l[l.OK=50]="OK",l))(r||{});class g{constructor(d,c){this.list=[],this.data=d,this.panel=c,this.dataSummary=this.computeDataSummary()}getListAppender(d){return new i(this.list,d)}computeDataSummary(){const d=this.data?.series||[];let c=0,h=0,o=0,m=0,u=0,p=0,f;for(const y of d){m+=y.length,y.meta?.preferredVisualisationType&&(f=y.meta.preferredVisualisationType);for(const x of y.fields)switch(p++,x.type){case s.PU.number:c+=1;break;case s.PU.time:h+=1;break;case s.PU.string:o+=1;break}y.length>u&&(u=y.length)}return{numberFieldCount:c,timeFieldCount:h,stringFieldCount:o,rowCountTotal:m,rowCountMax:u,fieldCount:p,preferredVisualisationType:f,frameCount:d.length,hasData:m>0,hasTimeField:h>0,hasNumberField:c>0,hasStringField:o>0}}getList(){return this.list}}class i{constructor(d,c){this.list=d,this.defaults=c}append(d){this.list.push((0,t.defaultsDeep)(d,this.defaults))}}},74135:(G,R,e)=>{"use strict";e.d(R,{S:()=>n,u:()=>t});var t=(s=>(s.link="link",s.component="component",s))(t||{}),n=(s=>(s.AlertInstanceAction="grafana/alerting/instance/action",s.AlertingHomePage="grafana/alerting/home",s.AlertingAlertingRuleAction="grafana/alerting/alertingrule/action",s.AlertingRecordingRuleAction="grafana/alerting/recordingrule/action",s.CommandPalette="grafana/commandpalette/action",s.DashboardPanelMenu="grafana/dashboard/panel/menu",s.DataSourceConfig="grafana/datasources/config",s.ExploreToolbarAction="grafana/explore/toolbar/action",s.UserProfileTab="grafana/user/profile/tab",s))(n||{})},51527:(G,R,e)=>{"use strict";e.d(R,{x:()=>n});var t=e(43429);function n(s){return s&&s!==t.Ac.valid&&s!==t.Ac.internal}},73372:(G,R,e)=>{"use strict";e.d(R,{D_:()=>t,Ee:()=>s,FL:()=>n});var t=(a=>(a.Equal="Equal",a.NotEqual="NotEqual",a.EqualRegEx="EqualRegEx",a.NotEqualRegEx="NotEqualRegEx",a))(t||{});const n=a=>!a||typeof a!="object"?!1:"importFromAbstractQueries"in a,s=a=>!a||typeof a!="object"?!1:"exportToAbstractQueries"in a},37891:(G,R,e)=>{"use strict";e.d(R,{n:()=>t});const t={"=":"equals","!=":"not-equals","=~":"regex-match","!~":"regex-not-match","=|":"one-of","!=|":"not-one-of"}},12470:(G,R,e)=>{"use strict";e.d(R,{CO:()=>t,ZG:()=>n,zL:()=>s});var t=(a=>(a[a.never=0]="never",a[a.onDashboardLoad=1]="onDashboardLoad",a[a.onTimeRangeChanged=2]="onTimeRangeChanged",a))(t||{}),n=(a=>(a[a.disabled=0]="disabled",a[a.alphabeticalAsc=1]="alphabeticalAsc",a[a.alphabeticalDesc=2]="alphabeticalDesc",a[a.numericalAsc=3]="numericalAsc",a[a.numericalDesc=4]="numericalDesc",a[a.alphabeticalCaseInsensitiveAsc=5]="alphabeticalCaseInsensitiveAsc",a[a.alphabeticalCaseInsensitiveDesc=6]="alphabeticalCaseInsensitiveDesc",a[a.naturalAsc=7]="naturalAsc",a[a.naturalDesc=8]="naturalDesc",a))(n||{}),s=(a=>(a[a.dontHide=0]="dontHide",a[a.hideLabel=1]="hideLabel",a[a.hideVariable=2]="hideVariable",a))(s||{})},50082:(G,R,e)=>{"use strict";e.d(R,{O:()=>t});var t=(n=>(n.Absolute="absolute",n.Percentage="percentage",n))(t||{})},81010:(G,R,e)=>{"use strict";e.d(R,{M:()=>t,N:()=>n});var t=(s=>(s[s.NotPossible=-1]="NotPossible",s[s.NotApplicable=0]="NotApplicable",s[s.Applicable=1]="Applicable",s[s.HighlyApplicable=2]="HighlyApplicable",s))(t||{}),n=(s=>(s.True="true",s.False="false",s.Null="null",s.Empty="empty",s))(n||{})},25019:(G,R,e)=>{"use strict";e.d(R,{W:()=>n,d:()=>t});var t=(s=>(s.ValueToText="value",s.RangeToText="range",s.RegexToText="regex",s.SpecialValue="special",s))(t||{}),n=(s=>(s.True="true",s.False="false",s.Null="null",s.NaN="nan",s.NullAndNaN="null+nan",s.Empty="empty",s))(n||{})},29505:(G,R,e)=>{"use strict";e.d(R,{J$:()=>s,Qz:()=>t,ZV:()=>r,f5:()=>a,xi:()=>n});var t=(g=>(g.Legacy="legacy",g.Standard="standard",g.Custom="custom",g.Datasource="datasource",g))(t||{});class n{}class s extends n{getType(){return"standard"}}class a extends n{getType(){return"custom"}}class r extends n{getType(){return"datasource"}}},35853:(G,R,e)=>{"use strict";e.d(R,{V:()=>t});function t(){Object.getOwnPropertyDescriptor(Array.prototype,"toArray")||Object.defineProperties(Array.prototype,{get:{value:function(n){return this[n]},writable:!0,enumerable:!1,configurable:!0},set:{value:function(n,s){this[n]=s},writable:!0,enumerable:!1,configurable:!0},add:{value:function(n){this.push(n)},writable:!0,enumerable:!1,configurable:!0},toArray:{value:function(){return this},writable:!0,enumerable:!1,configurable:!0}})}t()},7144:(G,R,e)=>{"use strict";e.d(R,{b:()=>a});var t=e(74848),n=e(96540),s=e(68941);const a=r=>{const{children:g,storageKey:i,defaultValue:l}=r,[d,c]=(0,n.useState)({value:s.M.getObject(r.storageKey,r.defaultValue)});(0,n.useEffect)(()=>{const m=u=>{u.key===i&&c({value:s.M.getObject(r.storageKey,r.defaultValue)})};return window.addEventListener("storage",m),()=>{window.removeEventListener("storage",m)}});const h=m=>{try{s.M.setObject(i,m)}catch(u){console.error(u)}c({value:m})},o=()=>{try{s.M.delete(i)}catch(m){console.log(m)}c({value:l})};return(0,t.jsx)(t.Fragment,{children:g(d.value,h,o)})}},60264:(G,R,e)=>{"use strict";e.d(R,{bk:()=>i,pv:()=>c,iF:()=>d});var t=e(2543),n=e(27310),s=e(69550),a=e(83077);class r{constructor(){this.properties=[]}addCustomEditor(o){return this.properties.push(o),this}getRegistry(){return new a.O(()=>this.properties)}getItems(){return this.properties}}var g=e(39070);class i extends r{addNumberInput(o){return this.addCustomEditor({...o,id:o.path,override:s.D.get("number").editor,editor:s.D.get("number").editor,process:n.m0,shouldApply:o.shouldApply??(()=>!0),settings:o.settings||{}})}addSliderInput(o){return this.addCustomEditor({...o,id:o.path,override:s.D.get("slider").editor,editor:s.D.get("slider").editor,process:n.m0,shouldApply:o.shouldApply??(()=>!0),settings:o.settings||{}})}addTextInput(o){return this.addCustomEditor({...o,id:o.path,override:s.D.get("text").editor,editor:s.D.get("text").editor,process:n.OU,shouldApply:o.shouldApply??(()=>!0),settings:o.settings||{}})}addSelect(o){return this.addCustomEditor({...o,id:o.path,override:s.D.get("select").editor,editor:s.D.get("select").editor,process:n.hL,shouldApply:o.shouldApply?o.shouldApply:()=>!0,settings:o.settings||{options:[]}})}addRadio(o){return this.addCustomEditor({...o,id:o.path,override:s.D.get("radio").editor,editor:s.D.get("radio").editor,process:n.hL,shouldApply:o.shouldApply?o.shouldApply:()=>!0,settings:o.settings||{options:[]}})}addBooleanSwitch(o){return this.addCustomEditor({...o,id:o.path,editor:s.D.get("boolean").editor,override:s.D.get("boolean").editor,process:n.FM,shouldApply:o.shouldApply?o.shouldApply:()=>!0,settings:o.settings||{}})}addColorPicker(o){return this.addCustomEditor({...o,id:o.path,editor:s.D.get("color").editor,override:s.D.get("color").editor,process:n.hS,shouldApply:o.shouldApply?o.shouldApply:()=>!0,settings:o.settings||{}})}addUnitPicker(o){return this.addCustomEditor({...o,id:o.path,editor:s.D.get("unit").editor,override:s.D.get("unit").editor,process:n.lG,shouldApply:o.shouldApply?o.shouldApply:()=>!0,settings:o.settings||{}})}addFieldNamePicker(o){return this.addCustomEditor({...o,id:o.path,editor:s.D.get("field-name").editor,override:s.D.get("field-name").editor,process:n.hS,shouldApply:o.shouldApply?o.shouldApply:()=>!0,settings:o.settings||{}})}addGenericEditor(o,m){return this.addCustomEditor({...o,id:o.path,editor:m,override:m,process:n.hS,shouldApply:o.shouldApply?o.shouldApply:()=>!0,settings:o.settings||{}})}}class l{constructor(o){this.cfg=o,this.path="",this.id="nested-panel-options",this.name="nested",this.editor=()=>null,this.getBuilder=()=>this.cfg.build,this.getNestedValueAccess=m=>{const u=this.cfg.values;return u?u(m):{getValue:p=>m.getValue(`${this.path}.${p}`),onChange:(p,f)=>m.onChange(`${this.path}.${p}`,f)}},this.path=o.path,this.category=o.category,this.defaultValue=this.getDefaultValue(o)}getDefaultValue(o){let m=(0,g.Gv)(o.defaultValue)?(0,t.cloneDeep)(o.defaultValue):{};const u=new c;o.build(u,{data:[]});for(const p of u.getItems())p.defaultValue!=null&&(0,t.set)(m,p.path,p.defaultValue);return m}}function d(h){return(0,g.Gv)(h)&&"id"in h&&h.id==="nested-panel-options"}class c extends r{addNestedOptions(o){const m=new l(o);return this.addCustomEditor(m)}addNumberInput(o){return this.addCustomEditor({...o,id:o.path,editor:s.D.get("number").editor})}addSliderInput(o){return this.addCustomEditor({...o,id:o.path,editor:s.D.get("slider").editor})}addTextInput(o){return this.addCustomEditor({...o,id:o.path,editor:s.D.get("text").editor})}addStringArray(o){return this.addCustomEditor({...o,id:o.path,editor:s.D.get("strings").editor})}addSelect(o){return this.addCustomEditor({...o,id:o.path,editor:s.D.get("select").editor})}addMultiSelect(o){return this.addCustomEditor({...o,id:o.path,editor:s.D.get("multi-select").editor})}addRadio(o){return this.addCustomEditor({...o,id:o.path,editor:s.D.get("radio").editor})}addBooleanSwitch(o){return this.addCustomEditor({...o,id:o.path,editor:s.D.get("boolean").editor})}addColorPicker(o){return this.addCustomEditor({...o,id:o.path,editor:s.D.get("color").editor,settings:o.settings||{}})}addTimeZonePicker(o){return this.addCustomEditor({...o,id:o.path,editor:s.D.get("timezone").editor,settings:o.settings||{}})}addUnitPicker(o){return this.addCustomEditor({...o,id:o.path,editor:s.D.get("unit").editor})}addFieldNamePicker(o){return this.addCustomEditor({...o,id:o.path,editor:s.D.get("field-name").editor})}addDashboardPicker(o){return this.addCustomEditor({...o,id:o.path,editor:s.D.get("dashboard-uid").editor})}}},28802:(G,R,e)=>{"use strict";e.d(R,{t:()=>s});var t=e(2543),n=e.n(t);function s(a){return typeof a=="number"?a:a===""||a===null||a===void 0||Array.isArray(a)?NaN:typeof a=="boolean"?a?1:0:(0,t.toNumber)(a)}},14588:(G,R,e)=>{"use strict";e.r(R),e.d(R,{insertAfterImmutably:()=>a,insertBeforeImmutably:()=>s,moveItemImmutably:()=>n,sortValues:()=>i});var t=e(52622);function n(l,d,c){const h=[...l];return Array.prototype.splice.call(h,c,0,Array.prototype.splice.call(h,d,1)[0]),h}function s(l,d,c){if(c<0||c>l.length)throw new Error("Index out of bounds");const h=[...l];return h.splice(c,0,d),h}function a(l,d,c){if(c<0||c>l.length)throw new Error("Index out of bounds");const h=[...l];return h.splice(c+1,0,d),h}const r=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),g=(l,d)=>l-d;function i(l){return(d,c)=>{if(d===c)return 0;if(c==null||typeof c=="string"&&c.trim()==="")return-1;if(d==null||typeof d=="string"&&d?.trim()==="")return 1;let h=r.compare;return typeof d=="number"&&typeof c=="number"&&(h=g),l===t.xB.Descending?h(c,d):h(d,c)}}},11710:(G,R,e)=>{"use strict";e.d(R,{b:()=>s,k:()=>n});var t=e(83077),n=(a=>(a.Add="+",a.Subtract="-",a.Divide="/",a.Multiply="*",a))(n||{});const s=new t.O(()=>[{id:"+",name:"Add",operation:(a,r)=>a+r,binaryOperationID:"+"},{id:"-",name:"Subtract",operation:(a,r)=>a-r,binaryOperationID:"-"},{id:"*",name:"Multiply",operation:(a,r)=>a*r,binaryOperationID:"*"},{id:"/",name:"Divide",operation:(a,r)=>a/r,binaryOperationID:"/"}])},72436:(G,R,e)=>{"use strict";e.d(R,{F7:()=>c,Jh:()=>h,_O:()=>x,i8:()=>m});var t=e(2543),n=e.n(t),s=e(44809),a=e.n(s),r=e(37471),g=e(14236),i=e(28240),l=e(11261),d=e(83195),c=(v=>(v[v.full=0]="full",v[v.name=1]="name",v[v.none=2]="none",v))(c||{});function h(v,P){return new m(P).readCSV(v)}var o=(v=>(v[v.Starting=0]="Starting",v[v.InHeader=1]="InHeader",v[v.ReadingRows=2]="ReadingRows",v))(o||{});class m{constructor(P){this.chunk=(E,D)=>{for(let C=0;C<E.data.length;C++){const b=E.data[C];if(b.length<1)continue;const T=b[0];if(T){if(T.startsWith("#")){const S=T.indexOf("#",2);if(S>0){const O=T.slice(1,S),M=O==="name";if(M||{unit:"#"}.hasOwnProperty(O)){this.state===2&&(this.current=new r.k({fields:[]}),this.data.push(this.current));const L=T.slice(S+1);if(M){this.current.addFieldFor(void 0,L);for(let B=1;B<b.length;B++)this.current.addFieldFor(void 0,b[B])}else{const{fields:B}=this.current;for(let j=0;j<B.length;j++){B[j].config||(B[j].config={});const A=B[j].config;A[O]=j===0?L:b[j]}}this.state=1;continue}}else if(this.state===0){this.state=1;continue}continue}if(this.state===0){if((0,g.HW)(T)===l.PU.string){for(const O of b)this.current.addFieldFor(void 0,O);this.state=1;continue}this.state=1}}if(this.state,this.state=2,b.length>this.current.fields.length){const{fields:S}=this.current;for(let O=S.length;O<b.length;O++)this.current.addFieldFor(b[O]);this.callback&&this.callback.onHeader(this.current.fields)}this.current.appendRow(b),this.callback&&this.callback.onRow(b)}},P||(P={}),this.config=P.config||{},this.callback=P.callback,this.current=new r.k({fields:[]}),this.state=0,this.data=[]}readCSV(P){this.current=new r.k({fields:[]}),this.data=[this.current];const E={...this.config,dynamicTyping:!1,skipEmptyLines:!0,comments:!1,chunk:this.chunk};return a().parse(P,E),this.data}}function u(v,P){if(v==null)return"";const E=v.toString();return E.includes('"')?P.quoteChar+E.replace(/"/gi,'""')+P.quoteChar:E.includes(`
`)||P.delimiter&&E.includes(P.delimiter)?P.quoteChar+E+P.quoteChar:E}function p(v,P){return v.display?E=>{const D=v.display(E);return u((0,d.cN)(D),P)}:E=>u(E,P)}function f(v,P,E){const D=v==="name",C=v==="type";for(const b of P){const T=b.config;if(D||C||T&&T.hasOwnProperty(v)){let S="#"+v+"#";for(let O=0;O<P.length;O++){O>0&&(S=S+E.delimiter);let M=P[O].name;C?M=P[O].type:D||(M=P[O].config[v]),M&&(S=S+u(M,E))}return S+E.newline}}return""}function y(){const v=["x","y"];return v.toLocaleString?v.toLocaleString().charAt(1):","}function x(v,P){if(!v)return"";P=(0,t.defaults)(P,{delimiter:y(),newline:`\r
`,quoteChar:'"',encoding:"",headerStyle:1,useExcelHeader:!1});let E=P.useExcelHeader?`sep=${P.delimiter}${P.newline}`:"";for(let D=0;D<v.length;D++){const C=v[D],{fields:b}=C;if(b.length===0)continue;if(P.headerStyle===0)E=E+f("name",b,P)+f("type",b,P)+f("unit",b,P)+f("dateFormat",b,P);else if(P.headerStyle===1){for(let S=0;S<b.length;S++)S>0&&(E+=P.delimiter),E+=`"${(0,i.Ct)(b[S],C).replace(/"/g,'""')}"`;E+=P.newline}const T=b[0].values.length;if(T>0){const S=b.map(O=>p(O,P));for(let O=0;O<T;O++){for(let M=0;M<b.length;M++){M>0&&(E=E+P.delimiter);let I=b[M].values[O];b[M].type===l.PU.frame&&b[M].values[O].value&&(I=b[M].values[O].value),I!==null&&(E=E+S[M](I))}O!==T-1&&(E=E+P.newline)}}D!==v.length-1&&(E=E+P.newline)}return E}},6709:(G,R,e)=>{"use strict";e.d(R,{c:()=>s,u:()=>a});var t=e(71733),n=e(76885);const s={keepTime:"__url_time_range",timeRangeFrom:"__from",timeRangeTo:"__to",includeVars:"__all_variables",seriesName:"__series.name",fieldName:"__field.name",valueTime:"__value.time",valueNumeric:"__value.numeric",valueText:"__value.text",valueRaw:"__value.raw",valueCalc:"__value.calc"};function a(l){const{onClickFn:d,replaceVariables:c,link:h,scopedVars:o,range:m,field:u,internalLink:p}=l,f=g(h.internal?.query,o,c),y=g(h.internal?.panelsState,o,c),x=g(h.meta?.correlationData,o,c),v=h.title?h.title:p.datasourceName;return{title:c(v,o),href:r(p.datasourceUid,f,m,y),onClick:d?P=>{P.preventDefault&&P.preventDefault(),d({datasourceUid:p.datasourceUid,queries:[f],panelsState:y,correlationHelperData:x,range:m})}:void 0,target:h?.targetBlank?"_blank":"_self",origin:u}}function r(l,d,c,h){return t.I.assureBaseUrl(`/explore?left=${encodeURIComponent((0,n.Pp)({...c?.raw?{range:(0,n.sQ)(c.raw)}:{},datasource:l,queries:[d],panelsState:h}))}`)}function g(l,d,c){if(!l)return l;if(typeof l=="string")return c(l,d);const h=JSON.parse(JSON.stringify(l));return i(h,d,c)}function i(l,d,c){for(const h of Object.keys(l))typeof l[h]=="string"?l[h]=c(l[h],d):typeof l[h]=="object"&&l[h]!==null&&(l[h]=i(l[h],d,c));return l}},22391:(G,R,e)=>{"use strict";e.d(R,{BD:()=>d,EX:()=>c,Iz:()=>r,PG:()=>i,QP:()=>f,fN:()=>a,lO:()=>u,mn:()=>l,p$:()=>s,pN:()=>m,wY:()=>h,wp:()=>p,yV:()=>o,zX:()=>g});var t=e(2543),n=e.n(t);function s(y){const x={uid:y.uid,type:y.type};return y.apiVersion&&(x.apiVersion=y.apiVersion),x}function a(y){return typeof y=="object"&&typeof y?.uid=="string"}function r(y){if(a(y))return y.uid;if((0,t.isString)(y))return y}const g=(y,x)=>v=>{m(y,x,v.currentTarget.value)},i=(y,x)=>v=>{u(y,x,v.currentTarget.value)},l=(y,x)=>v=>{p(y,x,v.currentTarget.value)},d=(y,x)=>v=>{u(y,x,v.value)},c=(y,x)=>v=>{u(y,x,v.currentTarget.checked)},h=(y,x)=>v=>{p(y,x,v.value)},o=(y,x)=>v=>{f(y,x)};function m(y,x,v){const P=y.options;y.onOptionsChange({...P,[x]:v})}const u=(y,x,v)=>{const P=y.options;y.onOptionsChange({...P,jsonData:{...P.jsonData,[x]:v}})},p=(y,x,v)=>{const P=y.options;y.onOptionsChange({...P,secureJsonData:{...P.secureJsonData?P.secureJsonData:{},[x]:v}})},f=(y,x)=>{const v=y.options;y.onOptionsChange({...v,secureJsonData:{...v.secureJsonData?v.secureJsonData:{},[x]:""},secureJsonFields:{...v.secureJsonFields,[x]:!1}})}},87885:(G,R,e)=>{"use strict";e.d(R,{f:()=>t});var t=(n=>(n[n.Transformations=0]="Transformations",n[n.FieldConfig=1]="FieldConfig",n[n.FieldConfigOverrides=2]="FieldConfigOverrides",n))(t||{})},39306:(G,R,e)=>{"use strict";e.d(R,{R:()=>n,r:()=>s});var t=e(39070);function n({xField:a,yField:r,nullValueMode:g}){const i=a.values,l=r.values,d=i.length;if(l.length!==d)throw new Error("Unexpected field length");const c=g===t.UW.Ignore,h=g===t.UW.AsZero,o=[];for(let m=0;m<d;m++){const u=i[m];let p=l[m];if(p===null){if(c)continue;h&&(p=0)}u!==null&&o.push([u,p])}return o}function s(a,r){if(!r.from||!r.to||!a||a.length===0)return[];const g=r.from.valueOf(),i=r.to.valueOf(),l=a[0][1];return[[g,l],[i,l]]}},8249:(G,R,e)=>{"use strict";e.d(R,{Xy:()=>n,_p:()=>r,h6:()=>g,s6:()=>a,yO:()=>s});const t=/\b(\w+)(!?=~?)"([^"\n]*?)"/g;function n(i){const l={};return i.replace(t,(d,c,h,o)=>(l[c]=o,"")),l}function s(i){return i.reduce((l,d)=>{if(!d)throw new Error("Need parsed labels to find common labels.");return Object.keys(d).forEach(c=>{(l[c]===void 0||l[c]!==d[c])&&delete l[c]}),Object.keys(l).forEach(c=>{d[c]===void 0&&delete l[c]}),l},{...i[0]})}function a(i,l){const d={...i};return Object.keys(l).forEach(c=>{delete d[c]}),d}function r(i,l){if(!i)return!0;for(const[d,c]of Object.entries(i))if(!l||l[d]!==c)return!1;return!0}function g(i,l="",d){if(!i||Object.keys(i).length===0)return l;const h=Object.keys(i).sort().map(o=>`${o}="${i[o]}"`).join(", ");return d?h:["{",h,"}"].join("")}},71733:(G,R,e)=>{"use strict";e.d(R,{I:()=>h});var t=e(80997),n=e(76885);let s={appSubUrl:""},a,r;const g=o=>{try{return new URL(o)}catch{return}},i=o=>{const m=g(o);if(m&&m.origin!==window.location.origin)return o;const u=s.appSubUrl??"",p=u.endsWith("/")?1:0,f=o.startsWith("http");let y=u;return(!o.startsWith("/")||f)&&(y=`${window.location.origin}${u}`),o.length>0&&(o.indexOf(y+"/")===0||o===y)?o.slice(y.length-p):o},l=o=>o.startsWith("/")?`${s.appSubUrl}${i(o)}`:o,h={initialize:o=>{s=o.config,a=o.getTimeRangeForUrl,r=o.getVariablesUrlParams},stripBaseFromUrl:i,assureBaseUrl:l,updateSearchParams:(o,m)=>{const u=new URLSearchParams(m);try{const p=new URL(o);return u.forEach((f,y)=>p.searchParams.set(y,f)),p.href}catch{const p=new URLSearchParams(o);return u.forEach((f,y)=>{p.set(y,f)}),"?"+p.toString()}},getTimeRangeUrlParams:()=>a?n.kM.toUrlParams(a()):null,getVariablesUrlParams:o=>{if(!r)return null;const m=r(o);return n.kM.toUrlParams(m)},getUrlForPartial:(o,m)=>{const u=n.kM.parseKeyValue(o.search.startsWith("?")?o.search.substring(1):o.search);for(const p in m)m[p]===null||m[p]===void 0?delete u[p]:u[p]=m[p];return l(n.kM.renderUrl(o.pathname,u))},processUrl:o=>s.disableSanitizeHtml?o:t.sQ.sanitizeUrl(o)}},92341:(G,R,e)=>{"use strict";e.d(R,{Y:()=>t});function t(n){return new Proxy(n,{apply(s,a,r){return(typeof Reflect>"u"||!Reflect.construct)&&alert("Browser is too old"),Reflect.construct(s,r,a.constructor)}})}},80147:(G,R,e)=>{"use strict";e.d(R,{_:()=>t});function t(n,s){return s.id===n?!0:s.aliasIDs?s.aliasIDs.includes(n):!1}},25352:(G,R,e)=>{"use strict";e.d(R,{u:()=>t});var t=(n=>(n.id="id",n.title="title",n.subTitle="subtitle",n.mainStat="mainstat",n.secondaryStat="secondarystat",n.arc="arc__",n.icon="icon",n.color="color",n.source="source",n.target="target",n.detail="detail__",n.nodeRadius="noderadius",n.thickness="thickness",n.highlighted="highlighted",n.strokeDasharray="strokedasharray",n.fixedX="fixedx",n.fixedY="fixedy",n))(t||{})},97706:(G,R,e)=>{"use strict";e.d(R,{E:()=>n,h:()=>t});function t(s,a=0){if(Number.isInteger(s))return s;let r=10**a,g=s*r*(1+Number.EPSILON);return Math.round(g)/r}function n(s){return((""+s).split(".")[1]||"").length}},92041:(G,R,e)=>{"use strict";e.d(R,{R:()=>n,w:()=>t});const t=s=>Object.keys(s).reduce((a,r)=>(s[r]!==void 0&&(a[r]=s[r]),a),{}),n=s=>typeof s=="object"&&s!==null&&Object.keys(s).length===0},68941:(G,R,e)=>{"use strict";e.d(R,{M:()=>n});class t{get(a){return window.localStorage[a]}set(a,r){window.localStorage[a]=r}getBool(a,r){return r!==void 0&&!this.exists(a)?r:window.localStorage[a]==="true"}getObject(a,r){let g=r;if(this.exists(a)){const i=window.localStorage[a];try{g=JSON.parse(i)}catch(l){console.error(`Error parsing store object: ${a}. Returning default: ${r}. [${l}]`)}}return g}setObject(a,r){let g;try{g=JSON.stringify(r)}catch(i){throw new Error(`Could not stringify object: ${a}. [${i}]`)}try{this.set(a,g)}catch(i){const l=new Error(`Could not save item in localStorage: ${a}. [${i}]`);throw i instanceof Error&&(l.name=i.name),l}return!0}exists(a){return window.localStorage[a]!==void 0}delete(a){window.localStorage.removeItem(a)}}const n=new t},27618:(G,R,e)=>{"use strict";e.d(R,{_:()=>n,j:()=>s});var t=e(83077),n=(a=>(a.Abs="abs",a.Exp="exp",a.Ln="ln",a.Floor="floor",a.Ceil="ceil",a))(n||{});const s=new t.O(()=>[{id:"abs",name:"Absolute value",operation:a=>Math.abs(a),unaryOperationID:"abs"},{id:"exp",name:"Natural exponent",operation:a=>Math.exp(a),unaryOperationID:"exp"},{id:"ln",name:"Natural logarithm",operation:a=>Math.log(a),unaryOperationID:"ln"},{id:"floor",name:"Floor",operation:a=>Math.floor(a),unaryOperationID:"floor"},{id:"ceil",name:"Ceiling",operation:a=>Math.ceil(a),unaryOperationID:"ceil"}])},76885:(G,R,e)=>{"use strict";e.d(R,{Pp:()=>h,kM:()=>c,sQ:()=>o});var t=e(47232);/**
 * @preserve jquery-param (c) 2015 KNOWLEDGECODE | MIT
 */function n(m,u){return u&&Object.keys(u).length>0&&(m+="?"+a(u)),m}function s(m,u){return encodeURIComponent(m).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,u?"%20":"+").replace(/[!'()*]/g,function(p){return"%"+p.charCodeAt(0).toString(16).toUpperCase()})}function a(m,u=!0){const p=[],f=/\[\]$/,y=u?(E,D)=>s(E,D):(E,D)=>encodeURIComponent(E),x=E=>Object.prototype.toString.call(E)==="[object Array]",v=(E,D)=>{if(D=typeof D=="function"?D():D===null||D===void 0?"":D,typeof D!="boolean")p[p.length]=y(E,!0)+"="+y(D,!0);else{const C=D?"":"="+y("false",!0);p[p.length]=y(E,!0)+C}},P=(E,D)=>{let C,b,T;if(E)if(x(D))for(C=0,b=D.length;C<b;C++)f.test(E)?v(E,D[C]):P(E,D[C]);else if(D&&String(D)==="[object Object]")for(T in D)P(E+"["+T+"]",D[T]);else v(E,D);else if(x(D))for(C=0,b=D.length;C<b;C++)v(D[C].name,D[C].value);else for(T in D)P(T,D[T]);return p};return P("",m).join("&")}function r(m){return a(m,!1)}function g(m,u){if(u!=null&&u!==""){const p=m.indexOf("?");p!==-1?m.length-p>1&&(m+="&"):m+="?",m+=u}return m}function i(){const u=window.location.search.substring(1).split("&"),p={};for(const f of u){const y=f.split("=");if(y.length>1){const x=decodeURIComponent(y[0]),v=decodeURIComponent(y[1]);x in p?p[x]=[...p[x],v]:p[x]=[v]}else if(y.length===1){const x=decodeURIComponent(y[0]);p[x]=!0}}return p}function l(m){const u={},p=(m||"").split("&");for(let f of p){let y,x,v;if(f&&(x=f=f.replace(/\+/g,"%20"),y=f.indexOf("="),y!==-1&&(x=f.substring(0,y),v=f.substring(y+1)),x=d(x),x!==void 0)){v=v!==void 0?d(v):!0;let P;typeof v=="string"&&v!==""?P=v==="true"||v==="false"?v==="true":v:P=v,u.hasOwnProperty(x)?Array.isArray(u[x])?u[x].push(v):u[x]=[u[x],isNaN(P)?v:P]:u[x]=isNaN(P)?v:P}}return u}function d(m){try{return decodeURIComponent(m)}catch{return}}const c={renderUrl:n,toUrlParams:a,appendQueryToUrl:g,getUrlSearchParams:i,parseKeyValue:l,serializeParams:r};function h(m,u){return u!==void 0&&console.warn("`compact` parameter is deprecated and will be removed in a future release"),JSON.stringify(m)}const o=m=>{let u=m.from;(0,t.Ar)(u)&&(u=u.valueOf().toString());let p=m.to;return(0,t.Ar)(p)&&(p=p.valueOf().toString()),{from:u,to:p}}},62398:(G,R,e)=>{"use strict";e.d(R,{An:()=>g,Zz:()=>a,bh:()=>i});var t=e(47737),n=e(54479),s=e(25019);function a(d,c){for(const h of d)switch(h.type){case s.d.ValueToText:if(c==null)continue;const o=h.options[c];if(o)return o;break;case s.d.RangeToText:if(c==null)continue;const m=parseFloat(c);if(isNaN(m)||!isNaN(h.options.from)&&m<h.options.from||!isNaN(h.options.to)&&m>h.options.to)continue;return h.options.result;case s.d.RegexToText:if(c==null||typeof c!="string")continue;const f=(0,n.dO)(h.options.pattern);if(c.match(f)){const y={...h.options.result};return y.text!=null&&(y.text=c.replace(f,h.options.result.text||"")),y}case s.d.SpecialValue:switch(h.options.match){case s.W.Null:{if(c==null)return h.options.result;break}case s.W.NaN:{if(typeof c=="number"&&isNaN(c))return h.options.result;break}case s.W.NullAndNaN:{if(typeof c=="number"&&isNaN(c)||c==null)return h.options.result;break}case s.W.True:{if(c===!0||c==="true")return h.options.result;break}case s.W.False:{if(c===!1||c==="false")return h.options.result;break}case s.W.Empty:{if(c==="")return h.options.result;break}}}return null}function r(d){return(typeof d=="number"||typeof d=="string"&&d.trim()!=="")&&!isNaN(d)}var g=(d=>(d[d.ValueToText=1]="ValueToText",d[d.RangeToText=2]="RangeToText",d))(g||{});function i(d,c){const h=[];let o=d.mappingType;if(d.mappingType||(d.valueMaps&&d.valueMaps.length?o=1:d.rangeMaps&&d.rangeMaps.length&&(o=2)),o===1)for(let m=0;m<d.valueMaps.length;m++){const u=d.valueMaps[m];h.push(l({...u,id:m,type:s.d.ValueToText},d.fieldConfig?.defaults?.thresholds||c))}else if(o===2)for(let m=0;m<d.rangeMaps.length;m++){const u=d.rangeMaps[m];h.push(l({...u,id:m,type:s.d.RangeToText},d.fieldConfig?.defaults?.thresholds||c))}return h}function l(d,c){const h={type:s.d.ValueToText,options:{}},o=[];let m;const u=parseFloat(d.text);if(c&&!isNaN(u)){const p=(0,t.yQ)(u,c.steps);p&&p.color&&(m=p.color)}switch(d.type){case 1:case s.d.ValueToText:d.value!=null&&(d.value==="null"?o.push({type:s.d.SpecialValue,options:{match:s.W.Null,result:{text:d.text,color:m}}}):h.options[String(d.value)]={text:d.text,color:m});break;case 2:case s.d.RangeToText:d.from==="null"||d.to==="null"?o.push({type:s.d.SpecialValue,options:{match:s.W.Null,result:{text:d.text,color:m}}}):o.push({type:s.d.RangeToText,options:{from:+d.from,to:+d.to,result:{text:d.text,color:m}}});break}return Object.keys(h.options).length>0&&o.unshift(h),o[0]}},92053:(G,R,e)=>{"use strict";e.d(R,{E:()=>n,c:()=>s});const t="__searchFilter",n=a=>a&&typeof a=="string"?a.indexOf(t)!==-1:!1,s=a=>{const{query:r,wildcardChar:g}=a;if(!n(r))return{};let{options:i}=a;return i=i||{searchFilter:""},{__searchFilter:{value:i.searchFilter?`${i.searchFilter}${g}`:`${g}`,text:""}}}},72495:(G,R,e)=>{"use strict";e.d(R,{k:()=>r});var t=e(44240),n=e(39697),s=e(65961),a=e(67791);function r({whileLoading:g,source:i}){return(0,t.h)((0,n.O)(200).pipe((0,s.u)(g),(0,a.Q)(i)),i)}},36120:(G,R,e)=>{"use strict";e.d(R,{$:()=>n});var t=e(18008);class n extends t.F{constructor(a){return super(),this.buffer=a.buffer||[],this.capacity=this.buffer.length,this.tail=a.append!=="head",this.index=0,this.add=this.getAddFunction(),a.capacity&&this.setCapacity(a.capacity),new Proxy(this,{get(r,g,i){if(typeof g!="symbol"){const l=+g;if(String(l)===g)return r.get(l)}return Reflect.get(r,g,i)},set(r,g,i,l){if(typeof g!="symbol"){const d=+g;if(String(d)===g)return r.set(d,i),!0}return Reflect.set(r,g,i,l)}})}getAddFunction(){return this.capacity>this.buffer.length?this.tail?a=>{this.buffer.push(a),this.buffer.length>=this.capacity&&(this.add=this.getAddFunction())}:a=>{this.buffer.unshift(a),this.buffer.length>=this.capacity&&(this.add=this.getAddFunction())}:this.tail?a=>{this.buffer[this.index]=a,this.index=(this.index+1)%this.buffer.length}:a=>{let r=this.index-1;r<0&&(r=this.buffer.length-1),this.buffer[r]=a,this.index=r}}setCapacity(a){if(this.capacity===a)return;const r=this.toArray();if(a>this.length)this.buffer=r;else if(a<this.capacity){const g=this.length-a;this.tail?this.buffer=r.slice(g,r.length):this.buffer=r.slice(0,r.length-g)}this.capacity=a,this.index=0,this.add=this.getAddFunction()}setAppendMode(a){const r=a!=="head";r!==this.tail&&(this.buffer=this.toArray().reverse(),this.index=0,this.tail=r,this.add=this.getAddFunction())}reverse(){return this.buffer.reverse()}get(a){return this.buffer[(a+this.index)%this.buffer.length]}set(a,r){this.buffer[(a+this.index)%this.buffer.length]=r}get length(){return this.buffer.length}}},18008:(G,R,e)=>{"use strict";e.d(R,{E:()=>r,F:()=>s});var t,n;class s{constructor(){this[t]={}}*iterator(){for(let i=0;i<this.length;i++)yield this.get(i)}set(i,l){throw"unsupported operation"}add(i){throw"unsupported operation"}push(...i){for(const l of i)this.add(l);return this.length}[(n=Symbol.iterator,t=Symbol.unscopables,n)](){return this.iterator()}forEach(i){return r(this).forEach(i)}map(i){return r(this).map(i)}filter(i){return r(this).filter(i)}at(i){return this.get(i)}toArray(){const i=new Array(this.length);for(let l=0;l<this.length;l++)i[l]=this.get(l);return i}join(i){return this.toArray().join(i)}toJSON(){return this.toArray()}pop(){throw new Error("Method not implemented.")}concat(...i){throw new Error("Method not implemented.")}reverse(){throw new Error("Method not implemented.")}shift(){throw new Error("Method not implemented.")}sort(i){throw new Error("Method not implemented.")}splice(i,l,...d){throw new Error("Method not implemented.")}unshift(...i){throw new Error("Method not implemented.")}fill(i,l,d){throw new Error("Method not implemented.")}copyWithin(i,l,d){throw new Error("Method not implemented.")}slice(i,l){return this.toArray().slice(i,l)}indexOf(i,l){return this.toArray().indexOf(i,l)}lastIndexOf(i,l){return this.toArray().lastIndexOf(i,l)}every(i,l){return this.toArray().every(i,l)}some(i,l){return this.toArray().some(i,l)}reduce(i,l){throw new Error("Method not implemented.")}reduceRight(i,l){throw new Error("Method not implemented.")}find(i,l){return this.toArray().find(i,l)}findIndex(i,l){return this.toArray().findIndex(i,l)}entries(){return this.toArray().entries()}keys(){return this.toArray().keys()}values(){return this.toArray().values()}includes(i,l){return this.toArray().includes(i,l)}flatMap(i,l){return this.toArray().flatMap(i,l)}flat(i){throw new Error("Method not implemented.")}}const a=[];function r(g){return{*[Symbol.iterator](){for(let i=0;i<g.length;i++)yield g.get(i)},forEach(i){for(let l=0;l<g.length;l++)i(g.get(l),l,a)},map(i){const l=[];for(let d=0;d<g.length;d++)l.push(i(g.get(d),d,a));return l},filter(i){const l=[];let d=0;for(const c of this)i(c,d++,a)&&l.push(c);return l}}}},80822:(G,R,e)=>{"use strict";e.d(R,{Wn:()=>r,_k:()=>a});var t=e(21423),n=e(41260),s=e(11261);function a(m,u){const p=r({data:m.series},{data:u.series}).data;return{...m,series:p}}function r(m,u){if(!m)return c(u);u.data.forEach(x=>{const v=m.data.find(P=>o(P,x));if(!v){m.data.push(h(x));return}g(v,x)});const p=[...m.errors??[],...u.errors??[]];p.length>0&&(m.errors=p);const f=m.error??u.error;f!=null&&(m.error=f);const y=[...m.traceIds??[],...u.traceIds??[]];return y.length>0&&(m.traceIds=y),m}function g(m,u){const p=Math.max(m.fields.length,u.fields.length);for(let f=0;f<p;f++){if(!m.fields[f])continue;const y=i(m.fields[f],u.fields,f);if(y&&(m.fields[f].values=[].concat.apply(y.values,m.fields[f].values),y.nanos)){const x=m.fields[f].nanos?.slice()||[];m.fields[f].nanos=u.fields[f].nanos?.concat(x)}}m.length+=u.length,m.meta={...m.meta,stats:d(m.meta?.stats??[],u.meta?.stats??[])}}function i(m,u,p){const f=u.filter(y=>y.name===m.name);return f.length===1?f[0]:m.labels?f.find(y=>(0,t.ab)(m.labels??{},y.labels??{})):u[p]}const l="Summary: total bytes processed";function d(m,u){const p=m.find(x=>x.displayName===l),f=u.find(x=>x.displayName===l);if(f!=null&&p!=null)return[{value:f.value+p.value,displayName:l,unit:p.unit}];const y=f??p;return y!=null?[y]:[]}function c(m){return{...m,data:m.data.map(h)}}function h(m){return{...m,fields:m.fields.map(u=>({...u,values:u.values}))}}function o(m,u){if(m.refId!==u.refId||m.name!==u.name)return!1;const p=m.meta?.type,f=u.meta?.type;if(p!==f)return!1;if(p===n.m.TimeSeriesMulti){const v=m.fields.find(E=>E.type===s.PU.number),P=u.fields.find(E=>E.type===s.PU.number);return v===void 0||P===void 0?!1:(0,t.ab)(v.labels??{},P.labels??{})}const y=m.meta?.custom?.frameType,x=u.meta?.custom?.frameType;return y==="LabeledTimeValues"&&x==="LabeledTimeValues"?!0:y===x}},80937:(G,R,e)=>{"use strict";e.d(R,{t:()=>a});var t=e(84555),n=e(32370),s=e(76040);function a(d,c,h,o="="){if(!c||!h)throw new Error("Need label to add to query.");const m=r(d);if(!m.length)return d;const u=g(c,h,o);return i(d,m,u)}function r(d){const c=t.K3.parse(d),h=[];return c.iterate({enter:({to:o,from:m,type:u})=>{if(u.id===t.Fb){const p=(0,s.u)(d.substring(m,o));return h.push({query:p.query,from:m,to:o}),!1}}}),h}function g(d,c,h){const o=c===1/0?"+Inf":c.toString();return{label:d,op:h,value:o}}function i(d,c,h){const o=new n.l;let m="",u=0;for(let p=0;p<c.length;p++){const f=c[p],y=p===c.length-1,x=d.substring(u,f.from),v=y?d.substring(f.to):"";l(f.query.labels,h)||f.query.labels.push(h);const P=o.renderQuery(f.query);m+=x+P+v,u=f.to}return m}function l(d,c){return d.find(h=>h.label===c.label&&h.value===c.value)}},7338:(G,R,e)=>{"use strict";e.d(R,{L:()=>ft});var t=e(74848),n=e(32196),s=e(96540),a=e(14236),r=e(7144),g=e(13544),i=e(14110),l=e(14578),d=e(55852),c=e(40845),h=e(81996),o=e(91396);function m(De){return typeof De=="object"&&De!==null&&"isCanceled"in De}const u=De=>{let Te=!1;return{promise:new Promise((Ye,Ge)=>{const Je={isCanceled:!0};De.then(it=>Te?Ge(Je):Ye(it)),De.catch(it=>Ge(Te?Je:it))}),cancel(){Te=!0}}};var p=e(84555),f=e(2543),y=e(75357),x=e(39554),v=e(62938),P=e(85828);function E(){const De=new Map;return De.set("expandSuggestionDocs","true"),{onDidChangeValue:Te=>{},onDidChangeTarget:Te=>{},onWillSaveState:Te=>{},get:(Te,Oe,Ye)=>De.get(Te)??Ye,getBoolean:(Te,Oe,Ye)=>{const Ge=De.get(Te);return Ge!==void 0?Ge==="true":Ye},getNumber:(Te,Oe,Ye)=>{const Ge=De.get(Te);return Ge!==void 0?parseInt(Ge,10):Ye},store:(Te,Oe,Ye,Ge)=>{Oe==null?De.delete(Te):De.set(Te,Oe.toString())},remove:(Te,Oe)=>{De.delete(Te)},keys:(Te,Oe)=>Array.from(De.keys()),logStorage:()=>{console.log("logStorage: not implemented")},migrate:()=>Promise.resolve(void 0),isNew:Te=>!0,flush:Te=>Promise.resolve(void 0)}}let D=null;function C(){return D===null&&(D={storageService:E()}),D}var b=e(53076),T=e(32264),S=e(20719);class O extends Error{constructor(Te){super("should never happen")}}const M=new b.A({intraMode:1});function I(De){let Te=De.getAllMetricNames();if(T.$.featureToggles.prometheusCodeModeMetricNamesSearch&&Te.length>De.metricNamesSuggestionLimit){const{monacoSettings:Oe}=De;Oe.enableAutocompleteSuggestionsUpdate(),Oe.inputInRange?Te=M.filter(Te,Oe.inputInRange)?.slice(0,De.metricNamesSuggestionLimit).map(Ye=>Te[Ye])??[]:Te=Te.slice(0,De.metricNamesSuggestionLimit)}return De.metricNamesToMetrics(Te).map(Oe=>({type:"METRIC_NAME",label:Oe.name,insertText:Oe.name,detail:`${Oe.name} : ${Oe.type}`,documentation:Oe.help}))}const L=S.AW.map(De=>({type:"FUNCTION",label:De.label,insertText:De.insertText??"",detail:De.detail,documentation:De.documentation}));async function B(De){const Te=I(De);return[...L,...Te]}const j=["$__interval","$__range","$__rate_interval","1m","5m","10m","30m","1h","1d"].map(De=>({type:"DURATION",label:De,insertText:De}));function A(De){return De.getHistory().slice(0,10).map(Oe=>({type:"HISTORY",label:Oe,insertText:Oe}))}function K(De,Te){const Oe=[...Te];return De!==void 0&&Oe.push({name:"__name__",value:De,op:"="}),`{${Oe.map(Ge=>`${Ge.name}${Ge.op}"${(0,h.Qn)(Ge.value)}"`).join(",")}}`}async function W(De,Te,Oe){if(De===void 0&&Te.length===0)return Promise.resolve(Oe.getAllLabelNames());{const Ye=K(De,Te);return await Oe.getSeriesLabels(Ye,Te)}}async function U(De,Te,Oe,Ye,Ge){return(await W(De,Ye,Ge)).map(it=>({type:"LABEL_NAME",label:it,insertText:`${it}${Te}`,triggerOnInsert:Oe}))}async function F(De,Te,Oe){return U(De,"=",!0,Te,Oe)}async function V(De,Te,Oe){return U(De,"",!1,Te,Oe)}async function w(De,Te,Oe,Ye){if(De===void 0&&Oe.length===0)return Ye.getLabelValues(Te);{const Ge=K(De,Oe);return await Ye.getSeriesValues(Te,Ge)}}async function z(De,Te,Oe,Ye,Ge){return(await w(De,Te,Ye,Ge)).map(it=>({type:"LABEL_VALUE",label:it,insertText:Oe?it:`"${it}"`}))}function N(De,Te){switch(De.type){case"IN_DURATION":return Promise.resolve(j);case"IN_FUNCTION":return B(Te);case"AT_ROOT":return B(Te);case"EMPTY":{const Oe=I(Te),Ye=A(Te);return Promise.resolve([...Ye,...L,...Oe])}case"IN_LABEL_SELECTOR_NO_LABEL_NAME":return F(De.metricName,De.otherLabels,Te);case"IN_GROUPING":return V(De.metricName,De.otherLabels,Te);case"IN_LABEL_SELECTOR_WITH_LABEL_NAME":return z(De.metricName,De.labelName,De.betweenQuotes,De.otherLabels,Te);default:throw new O(De)}}function H(De,Te){switch(Te){case"parent":return De.parent;case"firstChild":return De.firstChild;case"lastChild":return De.lastChild;case"nextSibling":return De.nextSibling;default:throw new O(Te)}}function Q(De,Te){let Oe=De;for(const[Ye,Ge]of Te)if(Oe=H(Oe,Ye),Oe===null||Oe.type.id!==Ge)return null;return Oe}function X(De,Te){return Te.slice(De.from,De.to)}function ee(De){const Te=De.slice(1,De.length-1);if(De.startsWith('"')&&De.endsWith('"'))return Te.replace(/\\"/,'"');if(De.startsWith("'")&&De.endsWith("'"))return Te.replace(/\\'/,"'");if(De.startsWith("`")&&De.endsWith("`"))return Te;throw new Error("FIXME: invalid string literal")}function Z(De,Te){return De.every((Oe,Ye)=>Oe===Te[Ye])}const q=0,ae=[{path:[p.ww,p.Fb],fun:xe},{path:[p.ab],fun:J},{path:[p.Dh],fun:ce},{path:[p.LW,p.Yq],fun:oe},{path:[q,p.df,p.ab],fun:J},{path:[q,p.Yq],fun:oe},{path:[q,p.l4],fun:pe},{path:[p.x$],fun:de}],k=new Map([[p.Hl,"="],[p.Ed,"=~"],[p.l3,"!="],[p.$i,"!~"]]);function se(De){const Te=De.firstChild;return Te===null?null:k.get(Te.type.id)??null}function te(De,Te){if(De.type.id!==p.Yq)return null;const Oe=Q(De,[["firstChild",p.IC]]);if(Oe===null)return null;const Ye=Q(Oe,[["nextSibling",p.Lf]]);if(Ye===null)return null;const Ge=se(Ye);if(Ge===null)return null;const Je=Q(De,[["lastChild",p.LW]]);if(Je===null)return null;const it=X(Oe,Te),St=ee(X(Je,Te));return{name:it,value:St,op:Ge}}function ne(De,Te){return De.type.id!==p.ww?[]:De.getChildren(p.Yq).map(Ye=>te(Ye,Te)).filter(Se)}function le(De){let Te=De.firstChild;const Oe=[];for(;Te!==null;)Oe.push(Te),Te=Te.nextSibling;return Oe}function re(De,Te){if(De.type.id===Te)return De;const Oe=le(De);for(const Ye of Oe){const Ge=re(Ye,Te);if(Ge!==null)return Ge}return null}function de(De,Te,Oe){const Ye=Q(De,[["parent",p.hI],["parent",p.Fn]]);if(Ye===null)return null;const Ge=Ye.getChild(p.Dh);if(Ge===null)return null;const Je=re(Ge,p.gw);return Je===null?null:{type:"IN_GROUPING",metricName:X(Je,Te),otherLabels:[]}}function oe(De,Te,Oe){const Ye=!De.type.isError,Ge=Q(De,[["parent",p.Yq]]);if(Ge===null)return null;const Je=Q(Ge,[["firstChild",p.IC]]);if(Je===null)return null;const it=X(Je,Te),St=Q(Ge,[["parent",p.ww]]);if(St===null)return null;const Kt=ne(St,Te).filter(Nn=>Nn.name!==it),Qt=Q(St,[["parent",p.Fb],["firstChild",p.gw]]);return Qt===null?{type:"IN_LABEL_SELECTOR_WITH_LABEL_NAME",labelName:it,betweenQuotes:Ye,otherLabels:Kt}:{type:"IN_LABEL_SELECTOR_WITH_LABEL_NAME",metricName:X(Qt,Te),labelName:it,betweenQuotes:Ye,otherLabels:Kt}}function J(De,Te,Oe){return{type:"AT_ROOT"}}function ce(De,Te,Oe){return{type:"IN_FUNCTION"}}function pe(De,Te,Oe){return{type:"IN_DURATION"}}function xe(De,Te,Oe){const Ye=Q(De,[["firstChild",p.Yq]]);if(Ye!==null&&!Te.slice(Ye.to,Oe).includes(","))return null;const Ge=Q(De,[["parent",p.Fb],["firstChild",p.gw]]),Je=ne(De,Te);return Ge===null?{type:"IN_LABEL_SELECTOR_NO_LABEL_NAME",otherLabels:Je}:{type:"IN_LABEL_SELECTOR_NO_LABEL_NAME",metricName:X(Ge,Te),otherLabels:Je}}function fe(De,Te){const Oe=De.cursorAt(Te);for(;;){if(Oe.from===Te&&Oe.to===Te){const{node:Ye}=Oe;if(Ye.type.isError)return Ye}if(!Oe.next())break}return null}function Ee(De,Te){if(De==="")return{type:"EMPTY"};const Oe=p.K3.parse(De),Ye=fe(Oe,Te),Ge=Ye!=null?Ye.cursor():Oe.cursorAt(Te),Je=Ge.node,it=[Ge.type.id];for(;Ge.parent();)it.push(Ge.type.id);for(let St of ae)if(Z(St.path,it))return St.fun(Je,De,Te);return null}function Se(De){return De!=null}function ye(){return{showWords:!1}}function Ve(De,Te){switch(De){case"DURATION":return Te.languages.CompletionItemKind.Unit;case"FUNCTION":return Te.languages.CompletionItemKind.Variable;case"HISTORY":return Te.languages.CompletionItemKind.Snippet;case"LABEL_NAME":return Te.languages.CompletionItemKind.Enum;case"LABEL_VALUE":return Te.languages.CompletionItemKind.EnumMember;case"METRIC_NAME":return Te.languages.CompletionItemKind.Constructor;default:throw new O(De)}}function Me(De,Te){return{triggerCharacters:["{",",","[","(","=","~"," ",'"'],provideCompletionItems:(Ye,Ge)=>{const Je=Ye.getWordAtPosition(Ge),it=Je!=null?De.Range.lift({startLineNumber:Ge.lineNumber,endLineNumber:Ge.lineNumber,startColumn:Je.startColumn,endColumn:Je.endColumn}):De.Range.fromPositions(Ge),St={column:Ge.column,lineNumber:Ge.lineNumber};if(Te.monacoSettings.setInputInRange(Ye.getValueInRange(it)),window.getSelection){const an=window.getSelection()?.toString();an&&an.length>0&&(St.column=St.column-an.length)}const zt=Ye.getOffsetAt(St),Kt=Ee(Ye.getValue(),zt);return(Kt!=null?N(Kt,Te):Promise.resolve([])).then(an=>{const Nn=an.length.toString().length;return{suggestions:an.map((Yn,ss)=>({kind:Ve(Yn.type,De),label:Yn.label,insertText:Yn.insertText,detail:Yn.detail,documentation:Yn.documentation,sortText:ss.toString().padStart(Nn,"0"),range:it,command:Yn.triggerOnInsert?{id:"editor.action.triggerSuggest",title:""}:void 0})),incomplete:Te.monacoSettings.suggestionsIncomplete}})}}}var Ce=e(91306);const Ue=0;function Ae(De,Te,Oe,Ye){if(!De)return!1;const Ge=we(Te,Ye);if(!Ge.length)return!1;let Je=Ge;if(De!==Te){const it=we(De,Ye);Je=Ge.flatMap(St=>it.filter(zt=>St.text===zt.text)||St)}return Je.map(it=>We(De,Oe,it)).filter(_e)}function we(De,Te){const Oe=[];return Te.parse(De).iterate({enter:Ge=>{if(Ge.type.id===Ue){const Je=Ge.node;Oe.push({node:Je,text:De.substring(Je.from,Je.to)})}}}),Oe}function We(De,Te,Oe){if(Te.length===1){const Je=Oe.node.from===Oe.node.to,it=Je&&Oe.node.parent?Oe.node.parent:Oe.node,St=Je?De.substring(it.from,it.to):Oe.text;return{startLineNumber:1,startColumn:it.from+1,endLineNumber:1,endColumn:it.to+1,error:St}}let Ye=0,Ge=0;for(let Je=0;Je<Te.length;Je++){if(Ge=Ye+Te[Je].length,Oe.node.from>Ge){Ye+=Te[Je].length+1;continue}return{startLineNumber:Je+1,startColumn:Oe.node.from-Ye+1,endLineNumber:Je+1,endColumn:Oe.node.to-Ye+1,error:Oe.text}}return null}function _e(De){return De!==null}const at={__interval:{text:"1s",value:"1s"},__rate_interval:{text:"1s",value:"1s"},__auto:{text:"1s",value:"1s"},__interval_ms:{text:"1000",value:1e3},__range_ms:{text:"1000",value:1e3},__range_s:{text:"1",value:1},__range:{text:"1s",value:"1s"}},ut={wordPattern:/(-?\d*\.\d\w*)|([^`~!#%^&*()\-=+\[{\]}\\|;:'",.<>\/?\s]+)/g,comments:{lineComment:"#"},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"<",close:">"}],folding:{}},Tt=["sum","min","max","avg","group","stddev","stdvar","count","count_values","bottomk","topk","quantile"],It=["abs","absent","ceil","changes","clamp_max","clamp_min","day_of_month","day_of_week","days_in_month","delta","deriv","exp","floor","histogram_quantile","histogram_avg","histogram_count","histogram_sum","histogram_fraction","histogram_stddev","histogram_stdvar","holt_winters","hour","idelta","increase","irate","label_join","label_replace","ln","log2","log10","minute","month","predict_linear","rate","resets","round","scalar","sort","sort_desc","sqrt","time","timestamp","vector","year"],ge=[];for(let De=0,Te=Tt;De<Te.length;De++){let Oe=Te[De];ge.push(Oe+"_over_time")}const Ie=["on","ignoring","group_right","group_left","by","without"],ue="("+Ie.reduce(function(De,Te){return De+"|"+Te})+")",me=["+","-","*","/","%","^","==","!=",">","<",">=","<=","and","or","unless"],Pe=["offset"],Fe={ignoreCase:!1,defaultToken:"",tokenPostfix:".promql",keywords:Tt.concat(It).concat(ge).concat(Ie).concat(Pe),operators:me,vectorMatching:ue,symbols:/[=><!~?:&|+\-*\/^%]+/,escapes:/\\(?:[abfnrtv\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,digits:/\d+(_+\d+)*/,octaldigits:/[0-7]+(_+[0-7]+)*/,binarydigits:/[0-1]+(_+[0-1]+)*/,hexdigits:/[[0-9a-fA-F]+(_+[0-9a-fA-F]+)*/,integersuffix:/(ll|LL|u|U|l|L)?(ll|LL|u|U|l|L)?/,floatsuffix:/[fFlL]?/,tokenizer:{root:[[/@vectorMatching\s*(?=\()/,"type","@clauses"],[/[a-z_]\w*(?=\s*(=|!=|=~|!~))/,"tag"],[/(^#.*$)/,"comment"],[/[a-zA-Z_]\w*/,{cases:{"@keywords":"type","@default":"identifier"}}],[/"([^"\\]|\\.)*$/,"string.invalid"],[/'([^'\\]|\\.)*$/,"string.invalid"],[/"/,"string","@string_double"],[/'/,"string","@string_single"],[/`/,"string","@string_backtick"],{include:"@whitespace"},[/[{}()\[\]]/,"@brackets"],[/[<>](?!@symbols)/,"@brackets"],[/@symbols/,{cases:{"@operators":"delimiter","@default":""}}],[/\d+[smhdwy]/,"number"],[/\d*\d+[eE]([\-+]?\d+)?(@floatsuffix)/,"number.float"],[/\d*\.\d+([eE][\-+]?\d+)?(@floatsuffix)/,"number.float"],[/0[xX][0-9a-fA-F']*[0-9a-fA-F](@integersuffix)/,"number.hex"],[/0[0-7']*[0-7](@integersuffix)/,"number.octal"],[/0[bB][0-1']*[0-1](@integersuffix)/,"number.binary"],[/\d[\d']*\d(@integersuffix)/,"number"],[/\d(@integersuffix)/,"number"]],string_double:[[/[^\\"]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/"/,"string","@pop"]],string_single:[[/[^\\']+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/'/,"string","@pop"]],string_backtick:[[/[^\\`$]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/`/,"string","@pop"]],clauses:[[/[^(,)]/,"tag"],[/\)/,"identifier","@pop"]],whitespace:[[/[ \t\r\n]+/,"white"]]}},Be={codeLens:!1,contextmenu:!1,fixedOverflowWidgets:!0,folding:!1,fontSize:14,lineDecorationsWidth:8,lineNumbers:"off",minimap:{enabled:!1},overviewRulerBorder:!1,overviewRulerLanes:0,padding:{top:4,bottom:5},renderLineHighlight:"none",scrollbar:{vertical:"hidden",verticalScrollbarSize:8,horizontal:"hidden",horizontalScrollbarSize:0,alwaysConsumeMouseWheel:!1},scrollBeyondLastLine:!1,suggest:ye(),suggestFontSize:12,wordWrap:"on"},he=2,be=y.Y.id;let Ke=!1;function ze(De){if(Ke===!1){Ke=!0;const{aliases:Te,extensions:Oe,mimetypes:Ye}=y.Y;De.languages.register({id:be,aliases:Te,extensions:Oe,mimetypes:Ye}),De.languages.setMonarchTokensProvider(be,Fe),De.languages.setLanguageConfiguration(be,ut)}}const nt=(De,Te)=>({container:(0,n.css)({borderRadius:De.shape.radius.default,border:`1px solid ${De.components.input.borderColor}`,display:"flex",flexDirection:"row",justifyContent:"start",alignItems:"center",height:"100%"}),placeholder:(0,n.css)({"::after":{content:`'${Te}'`,fontFamily:De.typography.fontFamilyMonospace,opacity:.6}})}),ot=De=>{const Te=(0,v.A)(),Oe=(0,s.useRef)(C()),Ye=(0,s.useRef)(null),{languageProvider:Ge,history:Je,onBlur:it,onRunQuery:St,initialValue:zt,placeholder:Kt,onChange:Qt,datasource:an}=De,Nn=(0,x.A)(Ge),zn=(0,x.A)(Je),Yn=(0,x.A)(St),ss=(0,x.A)(it),ds=(0,x.A)(Qt),Ms=(0,s.useRef)(null),Bs=(0,c.$j)(),gs=nt(Bs,Kt);return(0,s.useEffect)(()=>()=>{Ms.current?.()},[]),(0,t.jsx)("div",{"data-testid":g.Tp.components.QueryField.container,className:gs.container,ref:Ye,children:(0,t.jsx)(P.m,{overrideServices:Oe.current,options:Be,language:"promql",value:zt,beforeMount:Zn=>{ze(Zn)},onMount:(Zn,Ls)=>{const Ln=Zn.createContextKey("isEditorFocused"+Te,!1);Zn.onDidBlurEditorWidget(()=>{Ln.set(!1),ss.current(Zn.getValue())}),Zn.onDidFocusEditorText(()=>{Ln.set(!0)});const Hn=new Ce.M9({historyProvider:zn.current,languageProvider:Nn.current}),Qn=Me(Ls,Hn),mt={...Qn,provideCompletionItems:(fn,yn,wn,Xn)=>Zn.getModel()?.id!==fn.id?{suggestions:[]}:Qn.provideCompletionItems(fn,yn,wn,Xn)},{dispose:Yt}=Ls.languages.registerCompletionItemProvider(be,mt);Ms.current=Yt;const on=()=>{const fn=Ye.current;if(fn!==null){const yn=Zn.getContentHeight();fn.style.height=`${yn+he}px`,fn.style.width="100%";const wn=fn.clientWidth;Zn.layout({width:wn,height:yn})}};Zn.onDidContentSizeChange(on),on();const ln=(0,f.debounce)(()=>{const fn=Zn.getValue();ds.current(fn)},Nn.current.datasource.getDebounceTimeInMilliseconds());if(Zn.getModel()?.onDidChangeContent(()=>{ln()}),Zn.addCommand(Ls.KeyMod.Shift|Ls.KeyCode.Enter,()=>{Yn.current(Zn.getValue())},"isEditorFocused"+Te),Ls.editor.addKeybindingRule({keybinding:Ls.KeyMod.CtrlCmd|Ls.KeyCode.KeyF,command:null}),Zn.addCommand(Ls.KeyMod.CtrlCmd|Ls.KeyCode.KeyK,function(){e.g.dispatchEvent(new KeyboardEvent("keydown",{key:"k",metaKey:!0}))}),Kt){const fn=[{range:new Ls.Range(1,1,1,1),options:{className:gs.placeholder,isWholeLine:!0}}];let yn=[];const wn=()=>{const Xn=Zn.getModel();if(!Xn)return;const xn=Xn.getValueLength()===0?fn:[];yn=Xn.deltaDecorations(yn,xn)};wn(),Zn.onDidChangeModelContent(wn),Zn.onDidChangeModelContent(Xn=>{const xn=Zn.getModel();if(!xn)return;const Ut=xn.getValue(),hn=(Ae(Ut,an.interpolateString(Ut,at),xn.getLinesContent(),p.K3)||[]).map(({error:dn,...Sn})=>({message:`${dn?`Error parsing "${dn}"`:"Parse error"}. The query appears to be incorrect and could fail to be executed.`,severity:Ls.MarkerSeverity.Error,...Sn}));Ls.editor.setModelMarkers(xn,"owner",hn)})}}})})},gt=De=>(0,t.jsx)(s.Suspense,{fallback:null,children:(0,t.jsx)(ot,{...De})}),He=De=>{const Te=(0,s.useRef)(null),{onRunQuery:Oe,onChange:Ye,...Ge}=De,Je=zt=>{Te.current=zt,Ye(zt),Oe()},it=zt=>{Ye(zt)},St=zt=>{Ye(zt)};return(0,t.jsx)(gt,{onChange:St,onRunQuery:Je,onBlur:it,...Ge})},et="grafana.datasources.prometheus.browser.labels";function rt(De,Te,Oe){return De?"(Disabled)":Te?Oe?"Metrics browser":"(No metrics found)":"Loading metrics..."}class ht extends s.PureComponent{constructor(Te){super(Te),this.refreshHint=()=>{const{datasource:Oe,query:Ye,data:Ge}=this.props,Je=Oe.getInitHints(),it=Je.length>0?Je[0]:null;if(!Ge||Ge.series.length===0){this.setState({hint:it});return}const St=(0,a.ci)(Ge.series[0])?Ge.series.map(a.w3):Ge.series,zt=Oe.getQueryHints(Ye,St);let Kt=zt.length>0?zt[0]:null;this.setState({hint:Kt??it})},this.refreshMetrics=async()=>{const{range:Oe,datasource:{languageProvider:Ye}}=this.props;this.languageProviderInitializationPromise=u(Ye.start(Oe));try{const Ge=await this.languageProviderInitializationPromise.promise;await Promise.all(Ge),this.onUpdateLanguage()}catch(Ge){if(!(m(Ge)&&Ge.isCanceled))throw Ge}},this.onChangeLabelBrowser=Oe=>{this.onChangeQuery(Oe,!0),this.setState({labelBrowserVisible:!1})},this.onChangeQuery=(Oe,Ye)=>{const{query:Ge,onChange:Je,onRunQuery:it}=this.props;if(Je){const St={...Ge,expr:Oe};Je(St),Ye&&it&&it()}},this.onClickChooserButton=()=>{this.setState(Oe=>({labelBrowserVisible:!Oe.labelBrowserVisible})),(0,i.rR)("user_grafana_prometheus_metrics_browser_clicked",{editorMode:this.state.labelBrowserVisible?"metricViewClosed":"metricViewOpen",app:this.props?.app??""})},this.onClickHintFix=()=>{const{datasource:Oe,query:Ye,onChange:Ge,onRunQuery:Je}=this.props,{hint:it}=this.state;it?.fix?.action&&Ge(Oe.modifyQuery(Ye,it.fix.action)),Je()},this.onUpdateLanguage=()=>{const{datasource:{languageProvider:Oe}}=this.props,{metrics:Ye}=Oe;Ye&&this.setState({syntaxLoaded:!0})},this.state={labelBrowserVisible:!1,syntaxLoaded:!1,hint:null}}componentDidMount(){this.props.datasource.languageProvider&&this.refreshMetrics(),this.refreshHint()}componentWillUnmount(){this.languageProviderInitializationPromise&&this.languageProviderInitializationPromise.cancel()}componentDidUpdate(Te){const{data:Oe,datasource:{languageProvider:Ye},range:Ge}=this.props;Ye!==Te.datasource.languageProvider&&this.setState({syntaxLoaded:!1});const Je=this.rangeChangedToRefresh(Ge,Te.range);(Ye!==Te.datasource.languageProvider||Je)&&this.refreshMetrics(),Oe&&Te.data&&Te.data.series!==Oe.series&&this.refreshHint()}rangeChangedToRefresh(Te,Oe){if(Te&&Oe){const Ye=(0,h.eN)(Te.from.valueOf())===(0,h.eN)(Oe.from.valueOf()),Ge=(0,h.eN)(Te.to.valueOf())===(0,h.eN)(Oe.to.valueOf());return!(Ye&&Ge)}return!1}render(){const{datasource:Te,datasource:{languageProvider:Oe},query:Ye,ExtraFieldElement:Ge,history:Je=[],theme:it}=this.props,{labelBrowserVisible:St,syntaxLoaded:zt,hint:Kt}=this.state,Qt=Oe.metrics.length>0,an=rt(Te.lookupsDisabled,zt,Qt),Nn=!(zt&&Qt);return(0,t.jsx)(r.b,{storageKey:et,defaultValue:[],children:(zn,Yn,ss)=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"gf-form-inline gf-form-inline--xs-view-flex-column flex-grow-1","data-testid":this.props["data-testid"],children:[(0,t.jsxs)("button",{className:"gf-form-label query-keyword pointer",onClick:this.onClickChooserButton,disabled:Nn,type:"button","data-testid":g.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.openButton,children:[an,(0,t.jsx)(l.I,{name:St?"angle-down":"angle-right"})]}),(0,t.jsx)("div",{className:"flex-grow-1 min-width-15",children:(0,t.jsx)(He,{languageProvider:Oe,history:Je,onChange:this.onChangeQuery,onRunQuery:this.props.onRunQuery,initialValue:Ye.expr??"",placeholder:"Enter a PromQL query\u2026",datasource:Te})})]}),St&&(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(o.ur,{languageProvider:Oe,onChange:this.onChangeLabelBrowser,lastUsedLabels:zn||[],storeLastUsedLabels:Yn,deleteLastUsedLabels:ss,timeRange:this.props.range})}),Ge,Kt?(0,t.jsx)("div",{className:(0,n.css)({flexBasis:"100%"}),children:(0,t.jsxs)("div",{className:"text-warning",children:[Kt.label," ",Kt.fix?(0,t.jsx)("button",{type:"button",className:(0,n.cx)((0,d.my)(it),"text-link","muted"),onClick:this.onClickHintFix,children:Kt.fix.label}):null]})}):null]})})}}const ft=(0,c.cV)(ht)},91396:(G,R,e)=>{"use strict";e.d(R,{_N:()=>x,bS:()=>v,ur:()=>b});var t=e(74848),n=e(32196),s=e(96540),a=e(91793),r=e(13544),g=e(3911),i=e(39558),l=e(67061),d=e(60029),c=e(10354),h=e(54438),o=e(55852),m=e(40845),u=e(81996);const p="{}",f="__name__",y=25,x="40000",v="none";function P(T){let S="";const O=[];for(const M of T)if((M.name===f||M.selected)&&M.values&&M.values.length>0){const I=M.values.filter(L=>L.selected).map(L=>L.name);I.length>1?O.push(`${M.name}=~"${I.map(u.Cs).join("|")}"`):I.length===1&&(M.name===f?S=I[0]:O.push(`${M.name}="${(0,u.Qn)(I[0])}"`))}return[S,"{",O.join(","),"}"].join("")}function E(T,S,O){return T.map(M=>{const I=S[M.name];if(I){let L;if(M.name===O&&M.values)L=M.values;else{const B=new Set(M.values?.filter(j=>j.selected).map(j=>j.name)||[]);L=I.map(j=>({name:j,selected:B.has(j)}))}return{...M,loading:!1,values:L,hidden:!I,facets:L.length}}return{...M,loading:!1,hidden:!I,values:void 0,facets:0}})}const D=(0,g.N)(T=>({wrapper:(0,n.css)({backgroundColor:T.colors.background.secondary,padding:T.spacing(1),width:"100%"}),list:(0,n.css)({marginTop:T.spacing(1),display:"flex",flexWrap:"wrap",maxHeight:"200px",overflow:"auto",alignContent:"flex-start"}),section:(0,n.css)({"& + &":{margin:`${T.spacing(2)} 0`},position:"relative"}),selector:(0,n.css)({fontFamily:T.typography.fontFamilyMonospace,marginBottom:T.spacing(1)}),status:(0,n.css)({padding:T.spacing(.5),color:T.colors.text.secondary,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",position:"absolute",width:"50%",right:0,textAlign:"right",opacity:0,[T.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 100ms linear"}}),statusShowing:(0,n.css)({opacity:1}),error:(0,n.css)({color:T.colors.error.main}),valueList:(0,n.css)({marginRight:T.spacing(1),resize:"horizontal"}),valueListWrapper:(0,n.css)({borderLeft:`1px solid ${T.colors.border.medium}`,margin:`${T.spacing(1)} 0`,padding:`${T.spacing(1)} 0 ${T.spacing(1)} ${T.spacing(1)}`}),valueListArea:(0,n.css)({display:"flex",flexWrap:"wrap",marginTop:T.spacing(1)}),valueTitle:(0,n.css)({marginLeft:`-${T.spacing(.5)}`,marginBottom:T.spacing(1)}),validationStatus:(0,n.css)({padding:T.spacing(.5),marginBottom:T.spacing(1),color:T.colors.text.maxContrast,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"})}));class C extends s.Component{constructor(){super(...arguments),this.valueListsRef=s.createRef(),this.state={labels:[],labelSearchTerm:"",metricSearchTerm:"",status:"Ready",error:"",validationStatus:"",valueSearchTerm:""},this.onChangeLabelSearch=S=>{this.setState({labelSearchTerm:S.target.value})},this.onChangeMetricSearch=S=>{this.setState({metricSearchTerm:S.target.value})},this.onChangeSeriesLimit=S=>{this.setState({seriesLimit:S.target.value.trim()})},this.onChangeValueSearch=S=>{this.setState({valueSearchTerm:S.target.value})},this.onClickRunQuery=()=>{const S=P(this.state.labels);this.props.onChange(S)},this.onClickRunRateQuery=()=>{const O=`rate(${P(this.state.labels)}[$__rate_interval])`;this.props.onChange(O)},this.onClickClear=()=>{this.setState(S=>({labels:S.labels.map(M=>({...M,values:void 0,selected:!1,loading:!1,hidden:!1,facets:void 0})),labelSearchTerm:"",metricSearchTerm:"",status:"",error:"",validationStatus:"",valueSearchTerm:""})),this.props.deleteLastUsedLabels(),this.fetchValues(f,p)},this.onClickLabel=(S,O,M)=>{const I=this.state.labels.find(j=>j.name===S);if(!I)return;const L=!I.selected;let B={selected:L};if(I.values&&!L){const j=I.values.map(A=>({...A,selected:!1}));B={...B,facets:0,values:j}}this.setState({labelSearchTerm:""}),this.updateLabelState(S,B,"",()=>this.doFacettingForLabel(S))},this.onClickValue=(S,O,M)=>{const I=this.state.labels.find(B=>B.name===S);if(!I||!I.values)return;this.setState({labelSearchTerm:""});const L=I.values.map(B=>({...B,selected:B.name===O?!B.selected:B.selected}));this.updateLabelState(S,{values:L},"",()=>this.doFacetting(S))},this.onClickMetric=(S,O,M)=>{const I=this.state.labels.find(j=>j.name===S);if(!I||!I.values)return;this.setState({metricSearchTerm:""});const L=I.values.map(j=>({...j,selected:j.name===O||j.selected?!j.selected:j.selected})),B=L.some(j=>j.selected);this.updateLabelState(S,{selected:B,values:L},"",()=>this.doFacetting(S))},this.onClickValidate=()=>{const S=P(this.state.labels);this.validateSelector(S)},this.doFacetting=S=>{const O=P(this.state.labels);if(O===p){const M=this.state.labels.map(I=>({...I,facets:0,values:void 0,hidden:!1}));this.setState({labels:M},()=>{this.state.labels.forEach(I=>(I.selected||I.name===f)&&this.fetchValues(I.name,O))})}else this.fetchSeries(O,S)}}updateLabelState(S,O,M="",I){this.setState(L=>{const B=L.labels.map(A=>A.name===S?{...A,...O}:A),j=M?"":L.error;return{labels:B,status:M,error:j,validationStatus:""}},I)}componentDidMount(){const{languageProvider:S,lastUsedLabels:O}=this.props;if(S){const M=O;S.start(this.props.timeRange).then(()=>{let I=S.getLabelKeys();this.fetchValues(f,p);const L=I.map((B,j,A)=>({name:B,selected:M.includes(B),loading:!1}));this.setState({labels:L},()=>{this.state.labels.forEach(B=>{B.selected&&this.fetchValues(B.name,p)})})})}}doFacettingForLabel(S){const O=this.state.labels.find(I=>I.name===S);if(!O)return;const M=this.state.labels.filter(I=>I.selected).map(I=>I.name);this.props.storeLastUsedLabels(M),O.selected?O.values||this.fetchValues(S,P(this.state.labels)):this.doFacetting()}async fetchValues(S,O){const{languageProvider:M}=this.props;this.updateLabelState(S,{loading:!0},`Fetching values for ${S}`);try{let I=await M.getLabelValues(S);if(O!==P(this.state.labels)){this.updateLabelState(S,{loading:!1});return}const L=[],{metricsMetadata:B}=M;for(const j of I){const A={name:j};if(S===f&&B){const K=B[j];K&&(A.details=`(${K.type}) ${K.help}`)}L.push(A)}this.updateLabelState(S,{values:L,loading:!1})}catch(I){console.error(I)}}async fetchSeries(S,O){const{languageProvider:M}=this.props;O&&this.updateLabelState(O,{loading:!0},`Facetting labels for ${S}`);try{const I=await M.fetchSeriesLabels(S,!0,this.state.seriesLimit);if(S!==P(this.state.labels)){O&&this.updateLabelState(O,{loading:!1});return}if(Object.keys(I).length===0){this.setState({error:`Empty results, no matching label for ${S}`});return}const L=E(this.state.labels,I,O);this.setState({labels:L,error:""}),O&&this.updateLabelState(O,{loading:!1})}catch(I){console.error(I)}}async validateSelector(S){const{languageProvider:O}=this.props;this.setState({validationStatus:`Validating selector ${S}`,error:""});const M=await O.fetchSeries(S);this.setState({validationStatus:`Selector is valid (${M.length} series found)`})}render(){const{theme:S}=this.props,{labels:O,labelSearchTerm:M,metricSearchTerm:I,status:L,error:B,validationStatus:j,valueSearchTerm:A}=this.state,K=D(S);if(O.length===0)return(0,t.jsx)("div",{className:K.wrapper,children:(0,t.jsx)(i._,{text:"Loading labels..."})});let W=O.find(N=>N.name===f);W&&I&&(W={...W,values:W.values?.filter(N=>N.selected||N.name.includes(I))});let U=O.filter(N=>!N.hidden&&N.name!==f);M&&(U=U.filter(N=>N.selected||N.name.includes(M)));let F=U.filter(N=>N.selected&&N.values);A&&(F=F.map(N=>({...N,values:N.values?.filter(H=>H.selected||H.name.includes(A))})));const V=P(this.state.labels),w=V===p,z=W?.values?.length||0;return(0,t.jsxs)("div",{className:K.wrapper,children:[(0,t.jsxs)(l.B,{gap:3,children:[(0,t.jsx)("div",{children:(0,t.jsxs)("div",{className:K.section,children:[(0,t.jsx)(d.J,{description:"Once a metric is selected only possible labels are shown. Labels are limited by the series limit below.",children:"1. Select a metric"}),(0,t.jsx)("div",{children:(0,t.jsx)(c.p,{onChange:this.onChangeMetricSearch,"aria-label":"Filter expression for metric",value:I,"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.selectMetric})}),(0,t.jsx)(d.J,{description:"Set to 'none' to remove limit and show all labels for a selected metric. Removing the limit may cause performance issues.",children:"Series limit"}),(0,t.jsx)("div",{children:(0,t.jsx)(c.p,{onChange:this.onChangeSeriesLimit,"aria-label":"Limit results from series endpoint",value:this.state.seriesLimit??x,"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.seriesLimit})}),(0,t.jsx)("div",{role:"list",className:K.valueListWrapper,"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.metricList,children:(0,t.jsx)(a.Y1,{height:Math.min(450,z*y),itemCount:z,itemSize:y,itemKey:N=>W.values[N].name,width:300,className:K.valueList,children:({index:N,style:H})=>{const Q=W?.values?.[N];return Q?(0,t.jsx)("div",{style:H,children:(0,t.jsx)(h.J,{name:W.name,value:Q?.name,title:Q.details,active:Q?.selected,onClick:this.onClickMetric,searchTerm:I})}):null}})})]})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:K.section,children:[(0,t.jsx)(d.J,{description:"Once label values are selected, only possible label combinations are shown.",children:"2. Select labels to search in"}),(0,t.jsx)("div",{children:(0,t.jsx)(c.p,{onChange:this.onChangeLabelSearch,"aria-label":"Filter expression for label",value:M,"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.labelNamesFilter})}),(0,t.jsx)("div",{className:K.list,style:{height:120},children:U.map(N=>(0,t.jsx)(h.J,{name:N.name,loading:N.loading,active:N.selected,hidden:N.hidden,facets:N.facets,onClick:this.onClickLabel,searchTerm:M},N.name))})]}),(0,t.jsxs)("div",{className:K.section,children:[(0,t.jsx)(d.J,{description:"Use the search field to find values across selected labels.",children:"3. Select (multiple) values for your labels"}),(0,t.jsx)("div",{children:(0,t.jsx)(c.p,{onChange:this.onChangeValueSearch,"aria-label":"Filter expression for label values",value:A,"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.labelValuesFilter})}),(0,t.jsx)("div",{className:K.valueListArea,ref:this.valueListsRef,children:F.map(N=>(0,t.jsxs)("div",{role:"list","aria-label":`Values for ${N.name}`,className:K.valueListWrapper,children:[(0,t.jsx)("div",{className:K.valueTitle,children:(0,t.jsx)(h.J,{name:N.name,loading:N.loading,active:N.selected,hidden:N.hidden,facets:N.facets||N.values?.length,onClick:this.onClickLabel})}),(0,t.jsx)(a.Y1,{height:Math.min(200,y*(N.values?.length||0)),itemCount:N.values?.length||0,itemSize:28,itemKey:H=>N.values[H].name,width:200,className:K.valueList,children:({index:H,style:Q})=>{const X=N.values?.[H];return X?(0,t.jsx)("div",{style:Q,children:(0,t.jsx)(h.J,{name:N.name,value:X?.name,active:X?.selected,onClick:this.onClickValue,searchTerm:A})}):null}})]},N.name))})]})]})]}),(0,t.jsxs)("div",{className:K.section,children:[(0,t.jsx)(d.J,{children:"4. Resulting selector"}),(0,t.jsx)("div",{"aria-label":"selector",className:K.selector,children:V}),j&&(0,t.jsx)("div",{className:K.validationStatus,children:j}),(0,t.jsxs)(l.B,{children:[(0,t.jsx)(o.$n,{"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.useQuery,"aria-label":"Use selector for query button",disabled:w,onClick:this.onClickRunQuery,children:"Use query"}),(0,t.jsx)(o.$n,{"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.useAsRateQuery,"aria-label":"Use selector as metrics button",variant:"secondary",disabled:w,onClick:this.onClickRunRateQuery,children:"Use as rate query"}),(0,t.jsx)(o.$n,{"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.validateSelector,"aria-label":"Validate submit button",variant:"secondary",disabled:w,onClick:this.onClickValidate,children:"Validate selector"}),(0,t.jsx)(o.$n,{"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.clear,"aria-label":"Selector clear button",variant:"secondary",onClick:this.onClickClear,children:"Clear"}),(0,t.jsx)("div",{className:(0,n.cx)(K.status,(L||B)&&K.statusShowing),children:(0,t.jsx)("span",{className:B?K.error:"",children:B||L})})]})]})]})}}const b=(0,m.cV)(C)},91306:(G,R,e)=>{"use strict";e.d(R,{M9:()=>s,Ol:()=>n,w0:()=>t});const t="codeModeSuggestionsIncomplete";function n(a){return a.type===t&&"detail"in a&&typeof a.detail=="object"&&a.detail!==null&&"limit"in a.detail&&"datasourceUid"in a.detail}class s{constructor(r){this.languageProvider=r.languageProvider,this.historyProvider=r.historyProvider,this.inputInRange="",this.metricNamesSuggestionLimit=this.languageProvider.datasource.metricNamesAutocompleteSuggestionLimit,this.suggestionsIncomplete=!1,this.getSeriesLabels=this.languageProvider.getSeriesLabels.bind(this.languageProvider),this.getSeriesValues=this.languageProvider.getSeriesValues.bind(this.languageProvider),this.getAllLabelNames=this.languageProvider.getLabelKeys.bind(this.languageProvider),this.getLabelValues=this.languageProvider.getLabelValues.bind(this.languageProvider)}getHistory(){return this.historyProvider.map(r=>r.query.expr).filter(Boolean)}getAllMetricNames(){return this.languageProvider.metrics}metricNamesToMetrics(r){const{metricsMetadata:g}=this.languageProvider;return r.map(l=>{const d=g?.[l];return{name:l,help:d?.help??"",type:d?.type??""}})}enableAutocompleteSuggestionsUpdate(){this.suggestionsIncomplete=!0,dispatchEvent(new CustomEvent(t,{detail:{limit:this.metricNamesSuggestionLimit,datasourceUid:this.languageProvider.datasource.uid}}))}setInputInRange(r){this.inputInRange=r}get monacoSettings(){return{enableAutocompleteSuggestionsUpdate:this.enableAutocompleteSuggestionsUpdate.bind(this),inputInRange:this.inputInRange,setInputInRange:this.setInputInRange.bind(this),suggestionsIncomplete:this.suggestionsIncomplete}}}},4936:(G,R,e)=>{"use strict";e.d(R,{TT:()=>i,Zh:()=>l,jW:()=>g,k1:()=>a});var t=e(74848),n=e(32196),s=e(72093);const a=30,r=d=>{const{options:c,onOptionsChange:h}=d,o=useTheme2(),m=l(o);return jsxs(Fragment,{children:[c.access==="direct"&&jsx(Alert,{title:"Error",severity:"error",children:"Browser access mode in the Prometheus data source is no longer available. Switch to server access mode."}),jsx(DataSourceDescription,{dataSourceName:"Prometheus",docsLink:"https://grafana.com/docs/grafana/latest/datasources/prometheus/configure-prometheus-data-source/"}),jsx("hr",{className:`${m.hrTopSpace} ${m.hrBottomSpace}`}),jsx(DataSourceHttpSettingsOverhaul,{options:c,onOptionsChange:h,secureSocksDSProxyEnabled:config.secureSocksDSProxyEnabled}),jsx("hr",{}),jsxs(ConfigSection,{className:m.advancedSettings,title:"Advanced settings",description:"Additional settings are optional settings that can be configured for more control over your data source.",children:[jsx(AdvancedHttpSettings,{className:m.advancedHTTPSettingsMargin,config:c,onChange:h}),jsx(AlertingSettingsOverhaul,{options:c,onOptionsChange:h}),jsx(PromSettings,{options:c,onOptionsChange:h})]})]})};function g(d){return(0,t.jsx)("a",{href:d||"https://grafana.com/docs/grafana/latest/datasources/prometheus/#configure-the-data-source",target:"_blank",rel:"noopener noreferrer",children:"Visit docs for more details here."})}const i=(d,c,h)=>{const o="Value is not valid";return d&&!d.match(c)?(0,t.jsx)(s.P,{children:h||o}):!0};function l(d){return{additionalSettings:(0,n.css)({marginBottom:"25px"}),secondaryGrey:(0,n.css)({color:d.colors.secondary.text,opacity:"65%"}),inlineError:(0,n.css)({margin:"0px 0px 4px 245px"}),switchField:(0,n.css)({alignItems:"center"}),sectionHeaderPadding:(0,n.css)({paddingTop:"32px"}),sectionBottomPadding:(0,n.css)({paddingBottom:"28px"}),subsectionText:(0,n.css)({fontSize:"12px"}),hrBottomSpace:(0,n.css)({marginBottom:"56px"}),hrTopSpace:(0,n.css)({marginTop:"50px"}),textUnderline:(0,n.css)({textDecoration:"underline"}),versionMargin:(0,n.css)({marginBottom:"12px"}),advancedHTTPSettingsMargin:(0,n.css)({margin:"24px 0 8px 0"}),advancedSettings:(0,n.css)({paddingTop:"32px"}),alertingTop:(0,n.css)({marginTop:"40px !important"}),overhaulPageHeading:(0,n.css)({fontWeight:400}),container:(0,n.css)({maxwidth:578})}}},75212:(G,R,e)=>{"use strict";e.d(R,{gs:()=>Ie,UD:()=>ue});var t=e(2543),n=e(13288),s=e(75505),a=e(81160),r=e(59099),g=e(97716),i=e.n(g),l=e(65879),d=e(43659),c=e(43127),h=e(47232),o=e(37891),m=e(41987),u=e(26657),p=e(72574),f=e(47773),y=e(17172),x=e(32264),v=e(80937),P=e(74848),E=e(13544),D=e(71087),C=e(9e4),b=e(81580),T=e(79458),S=e(51440),O=e(68402),M=e(10354),I=e(80109);function L(Be){const he=Be.annotation,be=Be.onAnnotationChange,Ke={expr:he.expr,refId:he.name,interval:he.step};return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)(D.D,{children:[(0,P.jsx)(I.$,{...Be,query:Ke,showExplain:!1,onChange:ze=>{be({...he,expr:ze.expr})}}),(0,P.jsx)(C.U,{children:(0,P.jsx)(b.c,{label:"Min step",tooltip:(0,P.jsxs)(P.Fragment,{children:["An additional lower limit for the step parameter of the Prometheus query and for the"," ",(0,P.jsx)("code",{children:"$__interval"})," and ",(0,P.jsx)("code",{children:"$__rate_interval"})," variables."]}),children:(0,P.jsx)(S.D,{type:"text","aria-label":"Set lower limit for the step parameter",placeholder:"auto",minWidth:10,onCommitChange:ze=>{be({...he,step:ze.currentTarget.value})},defaultValue:Ke.interval,id:E.Tp.components.DataSource.Prometheus.annotations.minStep})})})]}),(0,P.jsx)(O.$,{v:.5}),(0,P.jsxs)(C.U,{children:[(0,P.jsx)(b.c,{label:"Title",tooltip:"Use either the name or a pattern. For example, {{instance}} is replaced with label value for the label instance.",children:(0,P.jsx)(M.p,{type:"text",placeholder:"{{alertname}}",value:he.titleFormat,onChange:ze=>{be({...he,titleFormat:ze.currentTarget.value})},"data-testid":E.Tp.components.DataSource.Prometheus.annotations.title})}),(0,P.jsx)(b.c,{label:"Tags",children:(0,P.jsx)(M.p,{type:"text",placeholder:"label1,label2",value:he.tagKeys,onChange:ze=>{be({...he,tagKeys:ze.currentTarget.value})},"data-testid":E.Tp.components.DataSource.Prometheus.annotations.tags})}),(0,P.jsx)(b.c,{label:"Text",tooltip:"Use either the name or a pattern. For example, {{instance}} is replaced with label value for the label instance.",children:(0,P.jsx)(M.p,{type:"text",placeholder:"{{instance}}",value:he.textFormat,onChange:ze=>{be({...he,textFormat:ze.currentTarget.value})},"data-testid":E.Tp.components.DataSource.Prometheus.annotations.text})}),(0,P.jsx)(b.c,{label:"Series value as timestamp",tooltip:"The unit of timestamp is milliseconds. If the unit of the series value is seconds, multiply its range vector by 1000.",children:(0,P.jsx)(T.C,{value:he.useValueForTime,onChange:ze=>{be({...he,useValueForTime:ze.currentTarget.value})},"data-testid":E.Tp.components.DataSource.Prometheus.annotations.seriesValueAsTimestamp})})]})]})}var B=e(50556),j=e(81996),A=e(32370),K=e(76040),W=e(62183);const U=/^label_names\(\)\s*$/,F=/^label_values\((?:(.+),\s*)?([a-zA-Z_$][a-zA-Z0-9_]*)\)\s*$/,V=/^metrics\((.+)\)\s*$/,w=/^query_result\((.+)\)\s*$/,z=/^label_names\((.+)\)\s*$/;function N(Be){if(typeof Be!="string")return Be;const he={refId:"PrometheusDatasource-VariableQuery",qryType:W.B4.LabelNames},be=Be.match(z);if(be)return{...he,qryType:W.B4.LabelNames,match:be[1]};const Ke=Be.match(U);if(Ke)return{...he,qryType:W.B4.LabelNames};const ze=Be.match(/^label_values\(/);if(ze){const ot=Be.match(F),gt=ot?ot[2]:"",He=ot?ot[1]:"";if(He){const et=(0,K.u)(He);return{...he,qryType:W.B4.LabelValues,label:gt,metric:et.query.metric,labelFilters:et.query.labels}}else return{...he,qryType:W.B4.LabelValues,label:gt}}const nt=Be.match(/^metrics\(/);if(nt){const ot=Be.match(V),gt=ot?ot[1]:"";return{...he,qryType:W.B4.MetricNames,metric:gt}}const tt=Be.match(/^query_result\(/);if(tt){const ot=Be.match(w),gt=ot?ot[1]:"";return{...he,qryType:W.B4.VarQueryResult,varQuery:gt}}return!Ke&&!ze&&!nt&&!tt?{...he,qryType:W.B4.SeriesQuery,seriesQuery:Be}:he}function H(Be){switch(Be.qryType){case W.B4.LabelNames:return Be.match?`label_names(${Be.match})`:"label_names()";case W.B4.LabelValues:if(Be.metric||Be.labelFilters&&Be.labelFilters.length!==0){const be={metric:Be.metric,labels:Be.labelFilters??[],operations:[]};return`label_values(${A.z.renderQuery(be)},${Be.label})`}else return`label_values(${Be.label})`;case W.B4.MetricNames:return`metrics(${Be.metric})`;case W.B4.VarQueryResult:return`query_result(${Q(Be.varQuery)})`;case W.B4.SeriesQuery:return Be.seriesQuery??"";case W.B4.ClassicQuery:return Be.classicQuery??""}return""}function Q(Be){return Be?Be.replace(/[\r\n]+/gm,""):""}class X{constructor(he,be){this.datasource=he,this.query=be,this.datasource=he,this.query=be,this.range=(0,c.E2)()}process(he){this.range=he;const be=U,Ke=z,ze=/^label_values\((?:(.+),\s*)?([a-zA-Z_][a-zA-Z0-9_]*)\)\s*$/,nt=V,tt=w,ot=this.query.match(be),gt=this.query.match(Ke);if(gt){const ft=`{__name__=~".*${gt[1]}.*"}`;return this.datasource.languageProvider.getSeriesLabels(ft,[]).then(De=>De.map(Te=>({text:Te})))}if(ot)return this.datasource.getTagKeys({filters:[],timeRange:he});const He=this.query.match(ze);if(He){const ft=He[1],De=He[2];return ee(ft)?this.labelValuesQuery(De,ft):this.labelValuesQuery(De)}const et=this.query.match(nt);if(et)return this.metricNameQuery(et[1]);const rt=this.query.match(tt);return rt?this.queryResultQuery(rt[1]):["label_values()","metrics()","query_result()"].includes(this.query)?Promise.resolve([]):this.metricNameAndLabelsQuery(this.query)}labelValuesQuery(he,be){const Ke=(0,j.mv)(this.range.from,!1),ze=(0,j.mv)(this.range.to,!0),nt={...be&&{"match[]":be},start:Ke.toString(),end:ze.toString()};if(!be||this.datasource.hasLabelsMatchAPISupport()){const tt=`/api/v1/label/${he}/values`;return this.datasource.metadataRequest(tt,nt).then(ot=>(0,t.map)(ot.data.data,gt=>({text:gt})))}else return this.datasource.metadataRequest("/api/v1/series",nt).then(ot=>{const gt=(0,t.map)(ot.data.data,He=>He[he]||"").filter(He=>He!=="");return(0,t.uniq)(gt).map(He=>({text:He,expandable:!0}))})}metricNameQuery(he){const be=(0,j.mv)(this.range.from,!1),Ke=(0,j.mv)(this.range.to,!0),ze={start:be.toString(),end:Ke.toString()};return this.datasource.metadataRequest("/api/v1/label/__name__/values",ze).then(tt=>(0,t.chain)(tt.data.data).filter(ot=>new RegExp(he).test(ot)).map(ot=>({text:ot,expandable:!0})).value())}queryResultQuery(he){const be="/api/v1/query",Ke={query:he,time:(0,j.mv)(this.range.to,!0).toString()};return this.datasource.metadataRequest(be,Ke).then(ze=>{switch(ze.data.data.resultType){case"scalar":case"string":return[{text:ze.data.data.result[1]||"",expandable:!1}];case"vector":return(0,t.map)(ze.data.data.result,nt=>{let tt=nt.metric.__name__||"";return delete nt.metric.__name__,tt+="{"+(0,t.map)(nt.metric,(ot,gt)=>gt+'="'+ot+'"').join(",")+"}",tt+=" "+nt.value[1]+" "+nt.value[0]*1e3,{text:tt,expandable:!0}});default:throw Error(`Unknown/Unhandled result type: [${ze.data.data.resultType}]`)}})}metricNameAndLabelsQuery(he){const be=(0,j.mv)(this.range.from,!1),Ke=(0,j.mv)(this.range.to,!0),ze={"match[]":he,start:be.toString(),end:Ke.toString()},nt="/api/v1/series",tt=this;return this.datasource.metadataRequest(nt,ze).then(ot=>(0,t.map)(ot.data.data,gt=>({text:tt.datasource.getOriginalMetricName(gt),expandable:!0})))}}function ee(Be){return Be&&Be.split(" ").join("")!=="{}"}const Z=20;function q(Be,he,be){const Ke=[],ze=be?.languageProvider?.metricsMetadata;if(Be.trim().match(/^\w+_bucket$|^\w+_bucket{.*}$/))Ke.push({type:"HISTOGRAM_QUANTILE",label:"Selected metric has buckets.",fix:{label:"Consider calculating aggregated quantile by adding histogram_quantile().",action:{type:"ADD_HISTOGRAM_QUANTILE",query:Be}}});else if(ze&&re(Be)){const tt=ne(Be),{nameMetric:ot}=le(tt,"histogram",ze,!1);if(ot){const He="Selected metric is a native histogram.";Ke.push({type:"HISTOGRAM_AVG",label:He,fix:{label:"Consider calculating the arithmetic average of observed values by adding histogram_avg().",action:{type:"ADD_HISTOGRAM_AVG",query:Be}}},{type:"HISTOGRAM_COUNT",label:He,fix:{label:"Consider calculating the count of observations by adding histogram_count().",action:{type:"ADD_HISTOGRAM_COUNT",query:Be}}},{type:"HISTOGRAM_SUM",label:He,fix:{label:"Consider calculating the sum of observations by adding histogram_sum().",action:{type:"ADD_HISTOGRAM_SUM",query:Be}}},{type:"HISTOGRAM_FRACTION",label:He,fix:{label:"Consider calculating the estimated fraction of observations between the provided lower and upper values by adding histogram_fraction().",action:{type:"ADD_HISTOGRAM_FRACTION",query:Be}}},{type:"HISTOGRAM_STDDEV",label:He,fix:{label:"Consider calculating the estimated standard deviation of observations by adding histogram_stddev().",action:{type:"ADD_HISTOGRAM_STDDEV",query:Be}}},{type:"HISTOGRAM_STDVAR",label:He,fix:{label:"Consider calculating the estimated standard variance of observations by adding histogram_stdvar().",action:{type:"ADD_HISTOGRAM_STDVAR",query:Be}}})}}if(Be.indexOf("rate(")===-1&&Be.indexOf("increase(")===-1){const tt=Be.match(/\b((?<!:)\w+_(total|sum|count)(?!:))\b/);let ot=tt?tt[1]:"",gt=!1;if(ze){const He=ne(Be),et=le(He,"counter",ze,gt);ot=et.nameMetric,gt=et.certain}if(ot){const He=re(Be);let rt=`Selected metric ${gt?"is":"looks like"} a counter.`,ht;He?ht={label:"Consider calculating rate of counter by adding rate().",action:{type:"ADD_RATE",query:Be}}:rt=`${rt} Consider calculating rate of counter by adding rate().`,Ke.push({type:"APPLY_RATE",label:rt,fix:ht})}}if(be&&be.ruleMappings){const tt=k(Be,be.ruleMappings);Ke.push(...tt)}return he&&he.length>=Z&&Be.trim().match(/^\w+$/)&&Ke.push({type:"ADD_SUM",label:"Many time series results returned.",fix:{label:"Consider aggregating with sum().",action:{type:"ADD_SUM",query:Be,preventSubmit:!0}}}),Ke}function ae(Be){const he=[];return Be.lookupsDisabled&&he.push({label:"Labels and metrics lookup was disabled in data source settings.",type:"INFO"}),he}function k(Be,he){const be=[],Ke=Object.keys(he).reduce((ze,nt)=>{if(Be.search(nt)===-1)return ze;if(he[nt].length>1){const{idx:tt,expandedQuery:ot,identifier:gt,identifierValue:He}=se(Be,nt,he[nt]);return tt===-1?(be.push({type:"EXPAND_RULES_WARNING",label:"We found multiple recording rules that match in this query. To expand the recording rule, add an identifier label/value."}),ze):{...ze,[nt]:{expandedQuery:ot,identifier:gt,identifierValue:He}}}else return{...ze,[nt]:{expandedQuery:he[nt][0].query}}},{});return(0,t.size)(Ke)>0&&be.push({type:"EXPAND_RULES",label:"Query contains recording rules.",fix:{label:"Expand rules",action:{type:"EXPAND_RULES",query:Be,options:Ke}}}),be}function se(Be,he,be){const{query:Ke}=(0,K.u)(Be),ze=te(he,Ke);if(ze.length===0)return{idx:-1,identifier:"",identifierValue:"",expandedQuery:""};let nt="",tt="",ot=-1;return ze.forEach(gt=>{ot===-1&&gt.label.search("uuid")!==-1&&(nt=gt.label,tt=gt.value)}),be.forEach((gt,He)=>{gt.labels&&Object.entries(gt.labels).forEach(([et,rt])=>{ot===-1&&et===nt&&rt===tt&&(ot=He)})}),{idx:ot,identifier:nt,identifierValue:tt,expandedQuery:be[ot]?.query??""}}function te(Be,he){if(he.metric===Be)return he.labels;if(he.binaryQueries)for(let be=0;be<he.binaryQueries.length;be++){const Ke=te(Be,he.binaryQueries[be].query);if(Ke&&Ke.length>0)return Ke}return[]}function ne(Be){return Array.from(Be.matchAll(/\$?[a-zA-Z_:][a-zA-Z0-9_:]*/g)).map(([he])=>he).filter(he=>!he.startsWith("$")).flatMap(he=>he.split(":"))}function le(Be,he,be,Ke){return{nameMetric:Be.find(nt=>{const tt=be[nt];return tt&&tt.type.toLowerCase()===he?(Ke=!0,!0):!1})??"",certain:Ke}}function re(Be){return Be.trim().match(/^\w+$|^\w+{.*}$/)}var de=e(33115),oe=e(59809),J=e(14110);function ce(Be,he,be){const{app:Ke,targets:ze}=he;if(Ke===m.Jk.Explore)for(const nt of ze)(0,J.rR)("grafana_prometheus_query_executed",{app:Ke,grafana_version:x.$.buildInfo.version,has_data:Be.data.some(tt=>tt.length>0),has_error:Be.error!==void 0,expr:nt.expr,format:nt.format,instant:nt.instant,range:nt.range,exemplar:nt.exemplar,hinting:nt.hinting,interval:nt.interval,intervalFactor:nt.intervalFactor,utcOffsetSec:nt.utcOffsetSec,legend:nt.legendFormat,valueWithRefId:nt.valueWithRefId,requestId:he.requestId,showingGraph:nt.showingGraph,showingTable:nt.showingTable,editor_mode:nt.editorMode,simultaneously_sent_query_count:ze.length,time_range_from:he?.range?.from?.toISOString(),time_range_to:he?.range?.to?.toISOString(),time_taken:Date.now()-be.getTime()})}var pe=e(62467),xe=e(65474),fe=e(29505),Ee=e(76459),Se=e.n(Ee),ye=e(96540),Ve=e(50877),Me=e(39268),Ce=e(14186),Ue=e(90182),Ae=e(21744),we=e(29993);const We=[{label:"Label names",value:W.B4.LabelNames},{label:"Label values",value:W.B4.LabelValues},{label:"Metrics",value:W.B4.MetricNames},{label:"Query result",value:W.B4.VarQueryResult},{label:"Series query",value:W.B4.SeriesQuery},{label:"Classic query",value:W.B4.ClassicQuery}],_e="PrometheusVariableQueryEditor-VariableQuery",at=({onChange:Be,query:he,datasource:be,range:Ke})=>{const[ze,nt]=(0,ye.useState)(void 0),[tt,ot]=(0,ye.useState)(""),[gt,He]=(0,ye.useState)(""),[et,rt]=(0,ye.useState)(""),[ht,ft]=(0,ye.useState)(""),[De,Te]=(0,ye.useState)(""),[Oe,Ye]=(0,ye.useState)(""),[Ge,Je]=(0,ye.useState)([]),[it,St]=(0,ye.useState)([]);function zt(Ln,Hn){St([...Hn,...Ln]);const Qn=(0,j.ky)(Ln);Je([...Hn,...Qn])}const[Kt,Qt]=(0,ye.useState)([]);(0,ye.useEffect)(()=>{be.languageProvider.start(Ke)},[]),(0,ye.useEffect)(()=>{if(he)if(he.qryType===W.B4.ClassicQuery)nt(he.qryType),Ye(he.query??"");else{const Ln=ut(he);He(Ln.match??""),nt(Ln.qryType),ot(Ln.label??""),rt(Ln.metric??""),Qt(Ln.labelFilters??[]),ft(Ln.varQuery??""),Te(Ln.seriesQuery??""),Ye(Ln.classicQuery??"")}},[he]),(0,ye.useEffect)(()=>{if(ze!==W.B4.LabelValues)return;const Ln=be.getVariables().map(Hn=>({label:Hn,value:Hn}));if(!et)be.getTagKeys({filters:[]}).then(Hn=>{const Qn=Hn.map(({text:mt})=>({label:mt,value:mt}));zt(Qn,Ln)});else{const Hn=[{label:"__name__",op:"=",value:et}],Qn=A.z.renderLabels(Hn);be.languageProvider.fetchLabelsWithMatch(Qn).then(mt=>{const on=Object.keys(mt).map(ln=>({label:ln,value:ln}));zt(on,Ln)})}},[be,ze,et]);const an=(Ln,Hn)=>{const Yt={...{qryType:ze,label:tt,metric:et,match:gt,varQuery:ht,seriesQuery:De,classicQuery:Oe,refId:"PrometheusVariableQueryEditor-VariableQuery"},...Ln,...Hn?{labelFilters:Hn}:{labelFilters:Kt}},on=H(Yt);Be({query:on,qryType:Yt.qryType,refId:_e})},Nn=Ln=>{nt(Ln.value),Ln.value!==W.B4.SeriesQuery&&an({qryType:Ln.value??0})},zn=Ln=>{const Hn=Ln&&Ln.value?Ln.value:"";ot(Hn),ze===W.B4.LabelValues&&Hn&&an({label:Hn})},Yn=Ln=>{rt(Ln.metric),Qt(Ln.labels);const Hn=Ln.metric,Qn=Ln.labels??[];ze===W.B4.LabelValues&&tt&&(Hn||Qn)&&an({qryType:ze,metric:Hn},Qn)},ss=Ln=>{ze===W.B4.LabelNames&&an({qryType:ze,match:Ln})},ds=Ln=>{ze===W.B4.MetricNames&&Ln&&an({metric:Ln})},Ms=Ln=>{ft(Ln.currentTarget.value)},Bs=Ln=>{Te(Ln.currentTarget.value)},gs=Ln=>{Ye(Ln.currentTarget.value)},Zn=(0,ye.useCallback)(()=>({metric:et,labels:Kt,operations:[]}),[et,Kt]),Ls=Se()(Ln=>{const Hn=it.filter(Qn=>Qn.value?.includes(Ln));return(0,j.ky)(Hn)},300);return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(Me.C,{children:(0,P.jsx)(Ce.I,{label:"Query type",labelWidth:20,tooltip:(0,P.jsx)("div",{children:"The Prometheus data source plugin provides the following query types for template variables."}),children:(0,P.jsx)(Ue.l6,{placeholder:"Select query type","aria-label":"Query type",onChange:Nn,value:ze,options:We,width:25,"data-testid":E.Tp.components.DataSource.Prometheus.variableQueryEditor.queryType})})}),ze===W.B4.LabelValues&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(Me.C,{children:(0,P.jsx)(Ce.I,{label:"Label",labelWidth:20,required:!0,"aria-labelledby":"label-select",tooltip:(0,P.jsx)("div",{children:"Returns a list of label values for the label name in all metrics unless the metric is specified."}),children:(0,P.jsx)(Ue.DW,{"aria-label":"label-select",onChange:zn,value:tt?(0,Ve.z)(tt):null,defaultOptions:Ge,width:25,allowCustomValue:!0,isClearable:!0,loadOptions:Ls,"data-testid":E.Tp.components.DataSource.Prometheus.variableQueryEditor.labelValues.labelSelect})})}),(0,P.jsx)(we.I,{query:Zn(),datasource:be,onChange:Yn,variableEditor:!0})]}),ze===W.B4.LabelNames&&(0,P.jsx)(Me.C,{children:(0,P.jsx)(Ce.I,{label:"Metric regex",labelWidth:20,"aria-labelledby":"Metric regex",tooltip:(0,P.jsx)("div",{children:"Returns a list of label names, optionally filtering by specified metric regex."}),children:(0,P.jsx)(M.p,{type:"text","aria-label":"Metric regex",placeholder:"Metric regex",value:gt,onBlur:Ln=>{He(Ln.currentTarget.value),ss(Ln.currentTarget.value)},onChange:Ln=>{He(Ln.currentTarget.value)},width:25,"data-testid":E.Tp.components.DataSource.Prometheus.variableQueryEditor.labelnames.metricRegex})})}),ze===W.B4.MetricNames&&(0,P.jsx)(Me.C,{children:(0,P.jsx)(Ce.I,{label:"Metric regex",labelWidth:20,"aria-labelledby":"Metric selector",tooltip:(0,P.jsx)("div",{children:"Returns a list of metrics matching the specified metric regex."}),children:(0,P.jsx)(M.p,{type:"text","aria-label":"Metric selector",placeholder:"Metric regex",value:et,onChange:Ln=>{rt(Ln.currentTarget.value)},onBlur:Ln=>{rt(Ln.currentTarget.value),ds(Ln.currentTarget.value)},width:25,"data-testid":E.Tp.components.DataSource.Prometheus.variableQueryEditor.metricNames.metricRegex})})}),ze===W.B4.VarQueryResult&&(0,P.jsx)(Me.C,{children:(0,P.jsx)(Ce.I,{label:"Query",labelWidth:20,tooltip:(0,P.jsx)("div",{children:"Returns a list of Prometheus query results for the query. This can include Prometheus functions, i.e. sum(go_goroutines)."}),children:(0,P.jsx)(Ae.f,{type:"text","aria-label":"Prometheus Query",placeholder:"Prometheus Query",value:ht,onChange:Ms,onBlur:()=>{ze===W.B4.VarQueryResult&&ht&&an({qryType:ze})},cols:100,"data-testid":E.Tp.components.DataSource.Prometheus.variableQueryEditor.varQueryResult})})}),ze===W.B4.SeriesQuery&&(0,P.jsx)(Me.C,{children:(0,P.jsx)(Ce.I,{label:"Series Query",labelWidth:20,tooltip:(0,P.jsx)("div",{children:'Enter a metric with labels, only a metric or only labels, i.e. go_goroutines{instance="localhost:9090"}, go_goroutines, or {instance="localhost:9090"}. Returns a list of time series associated with the entered data.'}),children:(0,P.jsx)(M.p,{type:"text","aria-label":"Series Query",placeholder:"Series Query",value:De,onChange:Bs,onBlur:()=>{ze===W.B4.SeriesQuery&&De&&an({qryType:ze})},width:100,"data-testid":E.Tp.components.DataSource.Prometheus.variableQueryEditor.seriesQuery})})}),ze===W.B4.ClassicQuery&&(0,P.jsx)(Me.C,{children:(0,P.jsx)(Ce.I,{label:"Classic Query",labelWidth:20,tooltip:(0,P.jsx)("div",{children:"The original implemetation of the Prometheus variable query editor. Enter a string with the correct query type and parameters as described in these docs. For example, label_values(label, metric)."}),children:(0,P.jsx)(M.p,{type:"text","aria-label":"Classic Query",placeholder:"Classic Query",value:Oe,onChange:gs,onBlur:()=>{ze===W.B4.ClassicQuery&&Oe&&an({qryType:ze})},width:100,"data-testid":E.Tp.components.DataSource.Prometheus.variableQueryEditor.classicQuery})})})]})};function ut(Be){return typeof Be=="string"?N(Be):Be.query?N(Be.query):Be}class Tt extends fe.f5{constructor(he,be=(0,p.w)()){super(),this.datasource=he,this.templateSrv=be,this.editor=at}query(he){let be;if(typeof he.targets[0]=="string"?be=he.targets[0]:be=he.targets[0].query,!be)return(0,pe.of)({data:[]});const Ke={...he.scopedVars,__interval:{text:this.datasource.interval,value:this.datasource.interval},__interval_ms:{text:l.intervalToMs(this.datasource.interval),value:l.intervalToMs(this.datasource.interval)},...this.datasource.getRangeScopedVars(he.range)},ze=this.templateSrv.replace(be,Ke,this.datasource.interpolateQueryExpr),nt=new X(this.datasource,ze);return(0,xe.H)(nt.process(he.range)).pipe((0,a.T)(ot=>({data:ot})))}}const It="60s",ge=["api/v1/query","api/v1/query_range","api/v1/series","api/v1/labels","suggestions"],Ie="-Instant";class ue extends u.iy{constructor(he,be=(0,p.w)(),Ke){super(he),this.templateSrv=be,this.init=async()=>{this.disableRecordingRules||this.loadRules(),this.exemplarsAvailable=await this.areExemplarsAvailable()},this.processAnnotationResponse=(ze,nt)=>{const tt=(0,f.bE)({data:nt}).data;if(!tt||!tt.length)return[];const ot=ze.annotation,{tagKeys:gt="",titleFormat:He="",textFormat:et=""}=ot,rt=l.intervalToSeconds(ot.step||It)*1e3,ht=gt.split(","),ft=[];for(const De of tt){if(De.fields.length===0)continue;const Te=De.fields[0],Oe=De.fields[1],Ye=Oe?.labels||{},Ge=Object.keys(Ye).filter(Qt=>ht.includes(Qt)).map(Qt=>Ye[Qt]),Je=[];let it=0;Oe.values.forEach(Qt=>{let an,Nn;const zn=Te.values[it];ze.annotation.useValueForTime?(an=Math.floor(parseFloat(Qt)),Nn=1):(an=Math.floor(parseFloat(zn)),Nn=parseFloat(Qt)),it++,Je.push([an,Nn])});const zt=Je.filter(Qt=>Qt[1]>0).map(Qt=>Qt[0]);let Kt=null;for(const Qt of zt){if(Kt&&(Kt.timeEnd??0)+rt>=Qt){Kt.timeEnd=Qt;continue}Kt&&ft.push(Kt),Kt={time:Qt,timeEnd:Qt,annotation:ot,title:(0,d.j)(He,Ye),tags:Ge,text:(0,d.j)(et,Ye)}}Kt&&(Kt.timeEnd=zt[zt.length-1],ft.push(Kt))}return ft},this.type="prometheus",this.id=he.id,this.url=he.url,this.access=he.access,this.basicAuth=he.basicAuth,this.withCredentials=!!he.withCredentials,this.interval=he.jsonData.timeInterval||"15s",this.queryTimeout=he.jsonData.queryTimeout,this.httpMethod=he.jsonData.httpMethod||"GET",this.exemplarTraceIdDestinations=he.jsonData.exemplarTraceIdDestinations,this.hasIncrementalQuery=he.jsonData.incrementalQuerying??!1,this.ruleMappings={},this.languageProvider=Ke??new B.Ay(this),this.lookupsDisabled=he.jsonData.disableMetricsLookup??!1,this.customQueryParameters=new URLSearchParams(he.jsonData.customQueryParameters),this.datasourceConfigurationPrometheusFlavor=he.jsonData.prometheusType,this.datasourceConfigurationPrometheusVersion=he.jsonData.prometheusVersion,this.defaultEditor=he.jsonData.defaultEditor,this.disableRecordingRules=he.jsonData.disableRecordingRules??!1,this.variables=new Tt(this,this.templateSrv),this.exemplarsAvailable=!0,this.cacheLevel=he.jsonData.cacheLevel??W.fD.Low,this.metricNamesAutocompleteSuggestionLimit=he.jsonData.codeModeMetricNamesSuggestionLimit??B.OP,this.cache=new de.$i({getTargetSignature:this.getPrometheusTargetSignature.bind(this),overlapString:he.jsonData.incrementalQueryOverlapWindow??de.Dr,applyInterpolation:this.interpolateString.bind(this)}),this.annotations={QueryEditor:L}}getQueryDisplayText(he){return he.expr}getPrometheusTargetSignature(he,be){return`${this.interpolateString(be.expr)}|${be.interval??he.interval}|${JSON.stringify(he.rangeRaw??"")}|${be.exemplar}`}hasLabelsMatchAPISupport(){return this._isDatasourceVersionGreaterOrEqualTo("2.24.0",W.N1.Prometheus)||this._isDatasourceVersionGreaterOrEqualTo("2.0.0",W.N1.Mimir)||this._isDatasourceVersionGreaterOrEqualTo("1.11.0",W.N1.Cortex)||this._isDatasourceVersionGreaterOrEqualTo("0.18.0",W.N1.Thanos)}_isDatasourceVersionGreaterOrEqualTo(he,be){return!this.datasourceConfigurationPrometheusVersion||!this.datasourceConfigurationPrometheusFlavor?!0:be!==this.datasourceConfigurationPrometheusFlavor?!1:i().gte(this.datasourceConfigurationPrometheusVersion,he)}_addTracingHeaders(he,be){he.headers={},this.access==="proxy"&&(he.headers["X-Dashboard-UID"]=be.dashboardUID,he.headers["X-Panel-Id"]=be.panelId)}directAccessError(){return(0,n.$)(()=>new Error("Browser access mode in the Prometheus datasource is no longer available. Switch to server access mode."))}_request(he,be,Ke={}){if(this.access==="direct")return this.directAccessError();be=be||{};for(const[tt,ot]of this.customQueryParameters)be[tt]==null&&(be[tt]=ot);let ze=this.url+he;he.startsWith(`/api/datasources/uid/${this.uid}`)&&(ze=he);const nt=(0,t.defaults)(Ke,{url:ze,method:this.httpMethod,headers:{}});return nt.method==="GET"?be&&Object.keys(be).length&&(nt.url=nt.url+(nt.url.search(/\?/)>=0?"&":"?")+Object.entries(be).map(([tt,ot])=>`${encodeURIComponent(tt)}=${encodeURIComponent(ot)}`).join("&")):(nt.headers["Content-Type"]||(nt.headers["Content-Type"]="application/x-www-form-urlencoded"),nt.data=be),(this.basicAuth||this.withCredentials)&&(nt.withCredentials=!0),this.basicAuth&&(nt.headers.Authorization=this.basicAuth),(0,y.AI)().fetch(nt)}async importFromAbstractQueries(he){return he.map(be=>this.languageProvider.importFromAbstractQuery(be))}async exportToAbstractQueries(he){return he.map(be=>this.languageProvider.exportToAbstractQuery(be))}async metadataRequest(he,be={},Ke){if(ge.some(ze=>he.includes(ze)))try{return await(0,s.s)(this._request(`/api/datasources/uid/${this.uid}/resources${he}`,be,{method:this.httpMethod,hideFromInspector:!0,showErrorAlert:!1,...Ke}))}catch(ze){if(this.httpMethod==="POST"&&(0,y.NF)(ze)&&(ze.status===405||ze.status===400))console.warn("Couldn't use configured POST HTTP method for this request. Trying to use GET method instead.");else throw ze}return await(0,s.s)(this._request(`/api/datasources/uid/${this.uid}/resources${he}`,be,{method:"GET",hideFromInspector:!0,...Ke}))}interpolateQueryExpr(he=[],be){if(!be.multi&&!be.includeAll)return Ne(he);if(typeof he=="string")return Fe(he);const Ke=he.map(ze=>Fe(ze));return Ke.length===1?Ke[0]:"("+Ke.join("|")+")"}targetContainsTemplate(he){return this.templateSrv.containsTemplate(he.expr)}shouldRunExemplarQuery(he,be){if(he.exemplar){const Ke=this.languageProvider.histogramMetrics.find(tt=>he.expr.includes(tt)),ze=be.targets.findIndex(tt=>tt.refId===he.refId),nt=be.targets.slice(0,ze).filter(tt=>!tt.hide);return!!(!Ke||Ke&&!nt.some(tt=>tt.expr.includes(Ke)))}return!1}processTargetV2(he,be){const Ke=[],ze={...he,exemplar:this.shouldRunExemplarQuery(he,be),requestId:be.panelId+he.refId,utcOffsetSec:be.range.to.utcOffset()*60};return x.$.featureToggles.promQLScope&&(ze.scopes=(be.scopes??[]).map(nt=>({name:nt.metadata.name,...nt.spec}))),x.$.featureToggles.groupByVariable&&(ze.groupByKeys=be.groupByKeys),he.instant&&he.range?Ke.push({...ze,refId:ze.refId,instant:!1},{...ze,refId:ze.refId+Ie,range:!1}):Ke.push(ze),Ke}query(he){if(this.access==="direct")return this.directAccessError();let be,Ke;const ze=he.targets.some(ot=>ot.instant);this.hasIncrementalQuery&&!ze?(Ke=this.cache.requestInfo(he),be=Ke.requests[0]):be=he;const nt=be.targets.map(ot=>this.processTargetV2(ot,be)),tt=new Date;return super.query({...be,targets:nt.flat()}).pipe((0,a.T)(ot=>{const gt={...ot,data:this.cache.procFrames(he,Ke,ot.data)};return(0,oe.J3)(gt,he,{exemplarTraceIdDestinations:this.exemplarTraceIdDestinations})}),(0,r.M)(ot=>{ce(ot,he,tt)}))}metricFindQuery(he,be){if(!he)return Promise.resolve([]);const Ke={...this.getIntervalVars(),...this.getRangeScopedVars(be?.range??(0,c.E2)())},ze=this.templateSrv.replace(he,Ke,this.interpolateQueryExpr);return new X(this,ze).process(be?.range??(0,c.E2)())}getIntervalVars(){return{__interval:{text:this.interval,value:this.interval},__interval_ms:{text:l.intervalToMs(this.interval),value:l.intervalToMs(this.interval)}}}getRangeScopedVars(he){const be=he.to.diff(he.from),Ke=Math.round(be/1e3);return{__range_ms:{text:be,value:be},__range_s:{text:Ke,value:Ke},__range:{text:Ke+"s",value:Ke+"s"}}}async annotationQuery(he){if(this.access==="direct"){const tt=new Error("Browser access mode in the Prometheus datasource is no longer available. Switch to server access mode.");return Promise.reject(tt)}const be=he.annotation,{expr:Ke=""}=be;if(!Ke)return Promise.resolve([]);const ze=he.annotation.step||It,nt={expr:Ke,range:!0,instant:!1,exemplar:!1,interval:ze,refId:"X",datasource:this.getRef()};return await(0,s.s)((0,y.AI)().fetch({url:"/api/ds/query",method:"POST",headers:this.getRequestHeaders(),data:{from:((0,j.mv)(he.range.from,!1)*1e3).toString(),to:((0,j.mv)(he.range.to,!0)*1e3).toString(),queries:[this.applyTemplateVariables(nt,{})]},requestId:`prom-query-${be.name}`}).pipe((0,a.T)(tt=>this.processAnnotationResponse(he,tt.data))))}async getTagKeys(he){if(x.$.featureToggles.promQLScope&&he)return(await this.languageProvider.fetchSuggestions(he.timeRange,he.queries,he.scopes,he.filters)).filter(tt=>!!tt&&!he.filters.find(ot=>ot.key===tt)).map(tt=>({value:tt,text:tt}));if(!he||he.filters.length===0)return await this.languageProvider.fetchLabels(he.timeRange,he.queries),this.languageProvider.getLabelKeys().map(nt=>({value:nt,text:nt}));const be=he.filters.map(nt=>({label:nt.key,value:nt.value,op:nt.operator})),Ke=A.z.renderLabels(be);let ze=await this.languageProvider.fetchLabelsWithMatch(Ke);return Object.keys(ze).filter(nt=>!he.filters.find(tt=>tt.key===nt)).map(nt=>({value:nt,text:nt}))}async getTagValues(he){const be=`[${this.uid}][${he.key}]`;if(x.$.featureToggles.promQLScope)return(await this.languageProvider.fetchSuggestions(he.timeRange,he.queries,he.scopes,he.filters,he.key,void 0,be)).map(ot=>({value:ot,text:ot}));const Ke=he.filters.map(ot=>({label:ot.key,value:ot.value,op:ot.operator})),ze=A.z.renderLabels(Ke);if(this.hasLabelsMatchAPISupport())return(await this.languageProvider.fetchSeriesValuesWithMatch(he.key,ze,be,he.timeRange)).map(ot=>({value:ot,text:ot}));const nt=this.getTimeRangeParams(he.timeRange??(0,c.E2)());return(await this.metadataRequest(`/api/v1/label/${he.key}/values`,nt))?.data?.data?.map(ot=>({text:ot}))??[]}interpolateVariablesInQueries(he,be,Ke){let ze=he;return he&&he.length&&(ze=he.map(nt=>{const tt=this.templateSrv.replace(nt.expr,be,this.interpolateQueryExpr),ot=x.$.featureToggles.promQLScope?tt:this.templateSrv.replace(this.enhanceExprWithAdHocFilters(Ke,tt),be,this.interpolateQueryExpr);return{...nt,...x.$.featureToggles.promQLScope?{adhocFilters:this.generateScopeFilters(Ke)}:{},datasource:this.getRef(),expr:ot,interval:this.templateSrv.replace(nt.interval,be)}})),ze}getQueryHints(he,be){return q(he.expr??"",be,this)}getInitHints(){return ae(this)}async loadRules(){try{const be=(await this.metadataRequest("/api/v1/rules",{},{showErrorAlert:!1})).data?.data?.groups;be&&(this.ruleMappings=Pe(be))}catch(he){console.log("Rules API is experimental. Ignore next error."),console.error(he)}}async areExemplarsAvailable(){try{return(await this.metadataRequest("/api/v1/query_exemplars",{query:"test",start:(0,h.KQ)().subtract(30,"minutes").valueOf().toString(),end:(0,h.KQ)().valueOf().toString()},{showErrorAlert:!1})).data.status==="success"}catch{return!1}}modifyQuery(he,be){let Ke=he.expr??"";switch(be.type){case"ADD_FILTER":{const{key:ze,value:nt}=be.options??{};ze&&nt&&(Ke=(0,v.t)(Ke,ze,nt));break}case"ADD_FILTER_OUT":{const{key:ze,value:nt}=be.options??{};ze&&nt&&(Ke=(0,v.t)(Ke,ze,nt,"!="));break}case"ADD_HISTOGRAM_QUANTILE":{Ke=`histogram_quantile(0.95, sum(rate(${Ke}[$__rate_interval])) by (le))`;break}case"ADD_HISTOGRAM_AVG":{Ke=`histogram_avg(rate(${Ke}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_FRACTION":{Ke=`histogram_fraction(0,0.2,rate(${Ke}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_COUNT":{Ke=`histogram_count(rate(${Ke}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_SUM":{Ke=`histogram_sum(rate(${Ke}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_STDDEV":{Ke=`histogram_stddev(rate(${Ke}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_STDVAR":{Ke=`histogram_stdvar(rate(${Ke}[$__rate_interval]))`;break}case"ADD_RATE":{Ke=`rate(${Ke}[$__rate_interval])`;break}case"ADD_SUM":{Ke=`sum(${Ke.trim()}) by ($1)`;break}case"EXPAND_RULES":{be.options&&(Ke=(0,j.P_)(Ke,be.options));break}default:break}return{...he,expr:Ke}}getAdjustedInterval(he){return(0,j.Xd)(this.cacheLevel,he)}getTimeRangeParams(he){return{start:(0,j.mv)(he.from,!1).toString(),end:(0,j.mv)(he.to,!0).toString()}}getOriginalMetricName(he){return(0,oe.hF)(he)}generateScopeFilters(he){return he?he.map(be=>({key:be.key,operator:o.n[be.operator],value:this.templateSrv.replace(be.value,{},this.interpolateQueryExpr),values:be.values?.map(Ke=>this.templateSrv.replace(Ke,{},this.interpolateQueryExpr))})):[]}enhanceExprWithAdHocFilters(he,be){return!he||he.length===0?be:he.reduce((ze,nt)=>{const{key:tt,operator:ot}=nt;let{value:gt}=nt;return(ot==="=~"||ot==="!~")&&(gt=Ne(gt)),(0,v.t)(ze,tt,gt,ot)},be)}filterQuery(he){return!(he.hide||!he.expr)}applyTemplateVariables(he,be,Ke){const ze={...be};ze.__interval={value:"$__interval"},ze.__interval_ms={value:"$__interval_ms"};const nt=this.templateSrv.replace(he.expr,ze,this.interpolateQueryExpr),tt=x.$.featureToggles.promQLScope?nt:this.templateSrv.replace(this.enhanceExprWithAdHocFilters(Ke,nt),ze,this.interpolateQueryExpr);return{...he,...x.$.featureToggles.promQLScope?{adhocFilters:this.generateScopeFilters(Ke)}:{},expr:tt,interval:this.templateSrv.replace(he.interval,ze),legendFormat:this.templateSrv.replace(he.legendFormat,ze)}}getVariables(){return this.templateSrv.getVariables().map(he=>`$${he.name}`)}interpolateString(he,be){return this.templateSrv.replace(he,be,this.interpolateQueryExpr)}getDebounceTimeInMilliseconds(){switch(this.cacheLevel){case W.fD.Medium:return 600;case W.fD.High:return 1200;default:return 350}}getDaysToCacheMetadata(){switch(this.cacheLevel){case W.fD.Medium:return 7;case W.fD.High:return 30;default:return 1}}getCacheDurationInMinutes(){return(0,j.u3)(this.cacheLevel)}getDefaultQuery(he){const be={refId:"A",expr:"",range:!0,instant:!1};return he===m.Jk.UnifiedAlerting?{...be,instant:!0,range:!1}:he===m.Jk.Explore?{...be,instant:!0,range:!0}:be}}function me(Be,he,be,Ke){const ze=Math.floor((he+Ke)/be)*be-Ke,nt=Math.floor((Be+Ke)/be)*be-Ke;return{end:ze,start:nt}}function Pe(Be){return Be.reduce((he,be)=>be.rules.filter(Ke=>Ke.type==="recording").reduce((Ke,ze)=>{const nt=Ke[ze.name]??[];return nt.push({query:ze.query,labels:ze.labels}),Ke[ze.name]=nt,Ke},he),{})}function Ne(Be){return typeof Be=="string"?Be.replace(/\\/g,"\\\\").replace(/'/g,"\\\\'"):Be}function Fe(Be){return typeof Be=="string"?Be.replace(/\\/g,"\\\\\\\\").replace(/[$^*{}\[\]\'+?.()|]/g,"\\\\$&"):Be}},50556:(G,R,e)=>{"use strict";e.d(R,{AU:()=>P,Ay:()=>C,OP:()=>f,pK:()=>v,xB:()=>x});var t=e(2543),n=e.n(t),s=e(28848),a=e.n(s),r=e(40187),g=e(43127),i=e(37891),l=e(73372),d=e(91396),c=e(81996),h=e(20719),o=e(76040),m=e(62183);const u=["job","instance"],p="{}",f=1e4,y=S=>({headers:{"X-Grafana-Cache":`private, max-age=${S}`}});function x(S,O){if(!O[S])return;const{type:M,help:I}=O[S];return`${M.toUpperCase()}: ${I}`}function v(S,O){if(O[S])return O[S].help}function P(S,O){if(O[S])return O[S].type}const E=/(="|!="|=~"|!~"|\{|\[|\(|\+|-|\/|\*|%|\^|\band\b|\bor\b|\bunless\b|==|>=|!=|<=|>|<|=|~|,)/,D=86400;class C extends r.Is{constructor(O,M){super(),this.labelKeys=[],this.request=async(I,L,B={},j)=>{try{return(await this.datasource.metadataRequest(I,B,j)).data.data}catch(A){T(A)||console.error(A)}return L},this.start=async I=>(this.timeRange=I??(0,g.E2)(),this.datasource.lookupsDisabled?[]:(this.metrics=await this.fetchLabelValues("__name__")||[],this.histogramMetrics=(0,c.Rg)(this.metrics).sort(),Promise.all([this.loadMetricsMetadata(),this.fetchLabels()]))),this.fetchLabelValues=async I=>{const L=this.datasource.getAdjustedInterval(this.timeRange),j=`/api/v1/label/${this.datasource.interpolateString(I)}/values`;return await this.request(j,[],L,this.getDefaultCacheHeaders())??[]},this.fetchLabels=async(I,L)=>{I&&(this.timeRange=I);let B="/api/v1/labels";const j=this.datasource.getAdjustedInterval(this.timeRange);this.labelFetchTs=Date.now().valueOf();const A=new URLSearchParams({...j});L?.forEach(W=>{const U=(0,o.u)(W.expr);U.query.metric!==""&&(A.append("match[]",U.query.metric),U.query.binaryQueries&&U.query.binaryQueries.forEach(F=>{A.append("match[]",F.query.metric)}))}),this.datasource.httpMethod==="GET"&&(B+=`?${A.toString()}`);const K=await this.request(B,[],A,this.getDefaultCacheHeaders());return Array.isArray(K)&&(this.labelKeys=K.slice().sort()),[]},this.getSeriesValues=async(I,L)=>this.datasource.hasLabelsMatchAPISupport()?await this.fetchSeriesValuesWithMatch(I,L):(await this.getSeries(L))[I]??[],this.fetchSeriesValuesWithMatch=async(I,L,B,j=this.timeRange)=>{const A=I?this.datasource.interpolateString(I):null,K=L?this.datasource.interpolateString(L):null,U={...this.datasource.getAdjustedInterval(j),...K&&{"match[]":K}};let F={...this.getDefaultCacheHeaders(),...B&&{requestId:B}};return Object.keys(F).length||(F=void 0),await this.request(`/api/v1/label/${A}/values`,[],U,F)??[]},this.getSeriesLabels=async(I,L)=>{let B,j;this.datasource.hasLabelsMatchAPISupport()?(L.push({name:"__name__",value:"",op:"!="}),j=await this.fetchSeriesLabelsMatch(I),B=Object.keys(j)):(j=await this.getSeries(I),B=Object.keys(j));const A=new Set(L.map(K=>K.name));return B.filter(K=>!A.has(K))},this.fetchLabelsWithMatch=async(I,L)=>this.datasource.hasLabelsMatchAPISupport()?this.fetchSeriesLabelsMatch(I,L):this.fetchSeriesLabels(I,L,d.bS),this.fetchSeriesLabels=async(I,L,B)=>{const j=this.datasource.interpolateString(I);let K={...this.datasource.getAdjustedInterval(this.timeRange),"match[]":j};B!=="none"&&(K={...K,limit:B??d._N});const U=await this.request("/api/v1/series",[],K,this.getDefaultCacheHeaders()),{values:F}=(0,c.P7)(U,L);return F},this.fetchSeriesLabelsMatch=async(I,L)=>{const B=this.datasource.interpolateString(I),A={...this.datasource.getAdjustedInterval(this.timeRange),"match[]":B};return(await this.request("/api/v1/labels",[],A,this.getDefaultCacheHeaders())).reduce((U,F)=>({...U,[F]:""}),{})},this.fetchSeries=async I=>{const L="/api/v1/series",j={...this.datasource.getTimeRangeParams(this.timeRange),"match[]":I};return await this.request(L,{},j,this.getDefaultCacheHeaders())},this.fetchDefaultSeries=(0,t.once)(async()=>{const I=await Promise.all(u.map(L=>this.fetchLabelValues(L)));return u.reduce((L,B,j)=>({...L,[B]:I[j]}),{})}),this.fetchSuggestions=async(I,L,B,j,A,K,W)=>{I&&(this.timeRange=I);const U="/suggestions",F=this.datasource.getAdjustedInterval(this.timeRange);return await this.request(U,[],{labelName:A,queries:L?.map(w=>this.datasource.interpolateString(w.expr,{...this.datasource.getIntervalVars(),...this.datasource.getRangeScopedVars(this.timeRange)})),scopes:B?.reduce((w,z)=>(w.push(...z.spec.filters),w),[]),adhocFilters:j?.map(w=>({key:w.key,operator:i.n[w.operator],value:w.value,values:w.values})),limit:K,...F},{...W&&{requestId:W},headers:{...this.getDefaultCacheHeaders()?.headers,"Content-Type":"application/json"},method:"POST"})??[]},this.datasource=O,this.histogramMetrics=[],this.timeRange=(0,g.E2)(),this.metrics=[],Object.assign(this,M)}getDefaultCacheHeaders(){if(this.datasource.cacheLevel!==m.fD.None)return y(this.datasource.getCacheDurationInMinutes()*60)}cleanText(O){return O.split(E).pop().trimLeft().replace(/"$/,"").replace(/^"/,"")}get syntax(){return h.Ay}async loadMetricsMetadata(){const O=y(this.datasource.getDaysToCacheMetadata()*D);this.metricsMetadata=(0,c.DX)(await this.request("/api/v1/metadata",{},{},{showErrorAlert:!1,...O}))}getLabelKeys(){return this.labelKeys}importFromAbstractQuery(O){return(0,c.pt)(O)}exportToAbstractQuery(O){const M=O.expr;if(!M||M.length===0)return{refId:O.refId,labelMatchers:[]};const I=a().tokenize(M,h.Ay),L=(0,c.VH)(I),B=b(M,I);return B&&B.length>0&&L.push({name:"__name__",operator:l.D_.Equal,value:B}),{refId:O.refId,labelMatchers:L}}async getSeries(O,M){if(this.datasource.lookupsDisabled)return{};try{return O===p?await this.fetchDefaultSeries():await this.fetchSeriesLabels(O,M,d.bS)}catch(I){return console.error(I),{}}}async getLabelValues(O){return await this.fetchLabelValues(O)}}function b(S,O){let M="";for(const I of O)if(typeof I=="string"){M=I;break}return M}function T(S){return typeof S=="object"&&S!==null&&"cancelled"in S&&S.cancelled===!0}},81996:(G,R,e)=>{"use strict";e.d(R,{Cs:()=>M,DX:()=>v,P7:()=>m,P_:()=>y,Qn:()=>O,Rg:()=>o,VH:()=>K,Xd:()=>W,eN:()=>P,ky:()=>V,mv:()=>F,pt:()=>j,u3:()=>U});var t=e(2543),n=e.n(t),s=e(28848),a=e.n(s),r=e(73372),g=e(77678),i=e(85858),l=e(80937),d=e(50556),c=e(9103),h=e(62183);const o=w=>{const z=new Set,N=new RegExp("_bucket($|:)");for(let H=0;H<w.length;H++){const Q=w[H];N.test(Q)&&z.add(Q)}return[...z]};function m(w,z=!1){const N={};w.forEach(Q=>{const{__name__:X,...ee}=Q;z&&(N.__name__=N.__name__||new Set,N.__name__.has(X)||N.__name__.add(X)),Object.keys(ee).forEach(Z=>{N[Z]||(N[Z]=new Set),N[Z].has(ee[Z])||N[Z].add(ee[Z])})});const H={};return C(Object.keys(N)).forEach(Q=>{H[Q]=C(Array.from(N[Q]))}),{values:H,keys:Object.keys(H)}}const u=/\{[^}]*?(\}|$)/,p=/\b(\w+)(!?=~?)("[^"\n]*?")(,)?(\s*)?/g;function f(w,z=1){if(!w.match(u)){if(w.match(/^[A-Za-z:][\w:]*$/))return{selector:`{__name__="${w}"}`,labelKeys:["__name__"]};throw new Error("Query must contain a selector: "+w)}const N=w.slice(0,z),H=N.lastIndexOf("{"),Q=N.lastIndexOf("}");if(H===-1)throw new Error("Not inside selector, missing open brace: "+N);if(Q>-1&&Q>H)throw new Error("Not inside selector, previous selector already closed: "+N);const X=w.slice(z),Z=X.indexOf("}")+z,q=X.indexOf("{"),ae=q+z;if(Z===-1)throw new Error("Not inside selector, missing closing brace in suffix: "+X);if(q>-1&&ae<Z)throw new Error("Not inside selector, next selector opens before this one closed: "+X);const k=w.slice(H,Z),se={};k.replace(p,(oe,J,ce,pe)=>{const xe=w.indexOf(oe),fe=xe+J.length+ce.length+1,Ee=xe+J.length+ce.length+pe.length-1;return(z<fe||z>Ee)&&(se[J]={value:pe,operator:ce}),""});const ne=w.slice(0,H).match(/[A-Za-z:][\w:]*$/);ne&&(se.__name__={value:`"${ne[0]}"`,operator:"="});const le=Object.keys(se).sort(),de=["{",le.map(oe=>`${oe}${se[oe].operator}${se[oe].value}`).join(","),"}"].join("");return{labelKeys:le,selector:de}}function y(w,z){const N=ee=>new RegExp(`(\\s|\\(|^)(${ee})(\\s|$|\\(|\\[|\\{)`,"ig"),H=Object.keys(z).reduce((ee,Z)=>{let q=[],ae=[],k=[];return ee.filter(Boolean).forEach((se,te)=>{se.match(N(Z))&&(q=se.split(Z),q.length===2?(k.push(te),ae.push(...[q[0],Z,q[1]].filter(Boolean))):q.length>2&&(k.push(te),q=q.map(le=>le===""?Z:le),ae.push(...q)))}),k.forEach(se=>ee[se]=""),ee=ee.filter(Boolean),ee.push(...ae),ee},[w]);let Q=!1;return H.map((ee,Z)=>{if(Q)return Q=!1,"";if(z[ee]){const{expandedQuery:q,identifierValue:ae,identifier:k}=z[ee];if(Z+1!==H.length&&H[Z+1].match(p)){Q=!0;const se=new RegExp(`(,)?(\\s)?(${k}=\\"${ae}\\")(,)?(\\s)?`,"g"),te=H[Z+1].replace(se,""),ne=/(\)\{|\}\{|\]\{)/;return x(q+te,ne)}else return q}return ee}).filter(Boolean).join("")}function x(w,z){const N=w.match(z);if(!N)return w;const H=N.index??0,Q=w.slice(0,H+1),X=w.slice(H+1),ee=[];X.replace(p,(k,se,te,ne,le,re)=>(ee.push({key:se,operator:te,value:ne,comma:le,space:re}),""));let Z=Q;ee.filter(Boolean).forEach(k=>{const se=k.value.slice(1,-1);Z=(0,l.t)(Z,k.key,se,k.operator)});let q=ee.reduce((k,se)=>(k+=`${se.key}${se.operator}${se.value}${se.comma??""}${se.space??""}`,k),"");q="{"+q+"}";const ae=X.replace(q,"");return Z+ae}function v(w){if(!w)return w;const z={},N={};for(const Q in w){const X=w[Q][0];z[Q]=X,X.type==="histogram"&&(N[`${Q}_bucket`]={type:"counter",help:`Cumulative counters for the observation buckets (${X.help})`},N[`${Q}_count`]={type:"counter",help:`Count of events that have been observed for the histogram metric (${X.help})`},N[`${Q}_sum`]={type:"counter",help:`Total sum of all observed values for the histogram metric (${X.help})`}),X.type==="summary"&&(N[`${Q}_count`]={type:"counter",help:`Count of events that have been observed for the base metric (${X.help})`},N[`${Q}_sum`]={type:"counter",help:`Total sum of all observed values for the base metric (${X.help})`})}const H={};return H.ALERTS={type:"counter",help:"Time series showing pending and firing alerts. The sample value is set to 1 as long as the alert is in the indicated active (pending or firing) state."},{...z,...N,...H}}function P(w){return E(w/1e3)}function E(w){return Math.floor(w/60)}function D(w,z=1){return Math.ceil(w/60)-Math.ceil(w/60)%z}function C(w){return w.slice(0,d.OP)}function b(w){return w&&w.length>=SUGGESTIONS_LIMIT?`, limited to the first ${SUGGESTIONS_LIMIT} received items`:""}const T=/[*+?()|\\.\[\]{}^$]/g;function S(w){return w.replace(T,"\\$&")}function O(w){return w.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/"/g,'\\"')}function M(w){return O(S(w))}const I={"=":r.D_.Equal,"!=":r.D_.NotEqual,"=~":r.D_.EqualRegEx,"!~":r.D_.NotEqualRegEx},L=(0,t.invert)(I);function B(w){const z=w.labelMatchers.map(N=>{const H=L[N.operator];return H?`${N.name}${H}"${N.value}"`:""}).filter(N=>N!=="").join(", ");return z?`{${z}}`:""}function j(w){return{refId:w.refId,expr:B(w),range:!0}}function A(w){return typeof w.content=="string"?w.content:""}function K(w){const z=[];for(const N of w)if(N instanceof s.Token&&N.type==="context-labels"){let H="",Q="",X="";const ee=Array.isArray(N.content)?N.content:[N.content];for(let Z of ee)if(typeof Z=="string"){let q;q=Z,(q==="="||q==="!="||q==="=~"||q==="!~")&&(X=q)}else if(Z instanceof s.Token)switch(Z.type){case"label-key":H=A(Z);break;case"label-value":Q=A(Z),Q=Q.substring(1,Q.length-1);const q=I[X];q&&z.push({name:H,operator:q,value:Q});break}}return z}function W(w,z){if(w===h.fD.None)return{start:F(z.from,!1).toString(),end:F(z.to,!0).toString()};const N=F(z.from,!1),H=(0,g.rs)(N,U(w)*60),Q=F(z.to,!0),X=D(Q,U(w))*60;if(H===X){const q=X+U(w)*60;return{start:H.toString(),end:q.toString()}}const ee=H.toString(),Z=X.toString();return{start:ee,end:Z}}function U(w){switch(w){case h.fD.Medium:return 10;case h.fD.High:return 60;default:return 1}}function F(w,z){return typeof w=="string"&&(w=i.parse(w,z)),Math.ceil(w.valueOf()/1e3)}function V(w,z){return z===void 0&&(z=c.o6),w.length=Math.min(w.length,z),w}},20719:(G,R,e)=>{"use strict";e.d(R,{AW:()=>g,Ay:()=>d,n6:()=>l});const t=[{label:"$__interval",sortValue:"$__interval"},{label:"$__rate_interval",sortValue:"$__rate_interval"},{label:"$__range",sortValue:"$__range"},{label:"1m",sortValue:"00:01:00"},{label:"5m",sortValue:"00:05:00"},{label:"10m",sortValue:"00:10:00"},{label:"30m",sortValue:"00:30:00"},{label:"1h",sortValue:"01:00:00"},{label:"1d",sortValue:"24:00:00"}],n=["by","group_left","group_right","ignoring","on","offset","without"],s=null,a=[{label:"acos",insertText:"acos",detail:"acos(v instant-vector)",documentation:"calculates the arccosine of all elements in v"},{label:"acosh",insertText:"acosh",detail:"acosh(v instant-vector)",documentation:"calculates the inverse hyperbolic cosine of all elements in v"},{label:"asin",insertText:"asin",detail:"asin(v instant-vector)",documentation:"calculates the arcsine of all elements in v"},{label:"asinh",insertText:"asinh",detail:"asinh(v instant-vector)",documentation:"calculates the inverse hyperbolic sine of all elements in v"},{label:"atan",insertText:"atan",detail:"atan(v instant-vector)",documentation:"calculates the arctangent of all elements in v"},{label:"atanh",insertText:"atanh",detail:"atanh(v instant-vector)",documentation:"calculates the inverse hyperbolic tangent of all elements in v"},{label:"cos",insertText:"cos",detail:"cos(v instant-vector)",documentation:"calculates the cosine of all elements in v"},{label:"cosh",insertText:"cosh",detail:"cosh(v instant-vector)",documentation:"calculates the hyperbolic cosine of all elements in v"},{label:"sin",insertText:"sin",detail:"sin(v instant-vector)",documentation:"calculates the sine of all elements in v"},{label:"sinh",insertText:"sinh",detail:"sinh(v instant-vector)",documentation:"calculates the hyperbolic sine of all elements in v"},{label:"tan",insertText:"tan",detail:"tan(v instant-vector)",documentation:"calculates the tangent of all elements in v"},{label:"tanh",insertText:"tanh",detail:"tanh(v instant-vector)",documentation:"calculates the hyperbolic tangent of all elements in v"}],g=[...[{label:"sum",insertText:"sum",documentation:"Calculate sum over dimensions"},{label:"min",insertText:"min",documentation:"Select minimum over dimensions"},{label:"max",insertText:"max",documentation:"Select maximum over dimensions"},{label:"avg",insertText:"avg",documentation:"Calculate the average over dimensions"},{label:"group",insertText:"group",documentation:"All values in the resulting vector are 1"},{label:"stddev",insertText:"stddev",documentation:"Calculate population standard deviation over dimensions"},{label:"stdvar",insertText:"stdvar",documentation:"Calculate population standard variance over dimensions"},{label:"count",insertText:"count",documentation:"Count number of elements in the vector"},{label:"count_values",insertText:"count_values",documentation:"Count number of elements with the same value"},{label:"bottomk",insertText:"bottomk",documentation:"Smallest k elements by sample value"},{label:"topk",insertText:"topk",documentation:"Largest k elements by sample value"},{label:"quantile",insertText:"quantile",documentation:"Calculate \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) over dimensions"}],...a,{insertText:"abs",label:"abs",detail:"abs(v instant-vector)",documentation:"Returns the input vector with all sample values converted to their absolute value."},{insertText:"absent",label:"absent",detail:"absent(v instant-vector)",documentation:"Returns an empty vector if the vector passed to it has any elements and a 1-element vector with the value 1 if the vector passed to it has no elements. This is useful for alerting on when no time series exist for a given metric name and label combination."},{insertText:"absent_over_time",label:"absent_over_time",detail:"absent(v range-vector)",documentation:"Returns an empty vector if the range vector passed to it has any elements and a 1-element vector with the value 1 if the range vector passed to it has no elements."},{insertText:"ceil",label:"ceil",detail:"ceil(v instant-vector)",documentation:"Rounds the sample values of all elements in `v` up to the nearest integer."},{insertText:"changes",label:"changes",detail:"changes(v range-vector)",documentation:"For each input time series, `changes(v range-vector)` returns the number of times its value has changed within the provided time range as an instant vector."},{insertText:"clamp",label:"clamp",detail:"clamp(v instant-vector, min scalar, max scalar)",documentation:"Clamps the sample values of all elements in `v` to have a lower limit of `min` and an upper limit of `max`."},{insertText:"clamp_max",label:"clamp_max",detail:"clamp_max(v instant-vector, max scalar)",documentation:"Clamps the sample values of all elements in `v` to have an upper limit of `max`."},{insertText:"clamp_min",label:"clamp_min",detail:"clamp_min(v instant-vector, min scalar)",documentation:"Clamps the sample values of all elements in `v` to have a lower limit of `min`."},{insertText:"count_scalar",label:"count_scalar",detail:"count_scalar(v instant-vector)",documentation:"Returns the number of elements in a time series vector as a scalar. This is in contrast to the `count()` aggregation operator, which always returns a vector (an empty one if the input vector is empty) and allows grouping by labels via a `by` clause."},{insertText:"deg",label:"deg",detail:"deg(v instant-vector)",documentation:"Converts radians to degrees for all elements in v"},{insertText:"day_of_month",label:"day_of_month",detail:"day_of_month(v=vector(time()) instant-vector)",documentation:"Returns the day of the month for each of the given times in UTC. Returned values are from 1 to 31."},{insertText:"day_of_week",label:"day_of_week",detail:"day_of_week(v=vector(time()) instant-vector)",documentation:"Returns the day of the week for each of the given times in UTC. Returned values are from 0 to 6, where 0 means Sunday etc."},{insertText:"day_of_year",label:"day_of_year",detail:"day_of_year(v=vector(time()) instant-vector)",documentation:"Returns the day of the year for each of the given times in UTC. Returned values are from 1 to 365 for non-leap years, and 1 to 366 in leap years."},{insertText:"days_in_month",label:"days_in_month",detail:"days_in_month(v=vector(time()) instant-vector)",documentation:"Returns number of days in the month for each of the given times in UTC. Returned values are from 28 to 31."},{insertText:"delta",label:"delta",detail:"delta(v range-vector)",documentation:"Calculates the difference between the first and last value of each time series element in a range vector `v`, returning an instant vector with the given deltas and equivalent labels. The delta is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if the sample values are all integers."},{insertText:"deriv",label:"deriv",detail:"deriv(v range-vector)",documentation:"Calculates the per-second derivative of the time series in a range vector `v`, using simple linear regression."},{insertText:"drop_common_labels",label:"drop_common_labels",detail:"drop_common_labels(instant-vector)",documentation:"Drops all labels that have the same name and value across all series in the input vector."},{insertText:"exp",label:"exp",detail:"exp(v instant-vector)",documentation:"Calculates the exponential function for all elements in `v`.\nSpecial cases are:\n* `Exp(+Inf) = +Inf` \n* `Exp(NaN) = NaN`"},{insertText:"floor",label:"floor",detail:"floor(v instant-vector)",documentation:"Rounds the sample values of all elements in `v` down to the nearest integer."},{insertText:"histogram_quantile",label:"histogram_quantile",detail:"histogram_quantile(\u03C6 float, b instant-vector)",documentation:"Calculates the \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) from the buckets `b` of a histogram. The samples in `b` are the counts of observations in each bucket. Each sample must have a label `le` where the label value denotes the inclusive upper bound of the bucket. (Samples without such a label are silently ignored.) The histogram metric type automatically provides time series with the `_bucket` suffix and the appropriate labels."},{insertText:"holt_winters",label:"holt_winters",detail:"holt_winters(v range-vector, sf scalar, tf scalar)",documentation:"Produces a smoothed value for time series based on the range in `v`. The lower the smoothing factor `sf`, the more importance is given to old data. The higher the trend factor `tf`, the more trends in the data is considered. Both `sf` and `tf` must be between 0 and 1."},{insertText:"hour",label:"hour",detail:"hour(v=vector(time()) instant-vector)",documentation:"Returns the hour of the day for each of the given times in UTC. Returned values are from 0 to 23."},{insertText:"idelta",label:"idelta",detail:"idelta(v range-vector)",documentation:"Calculates the difference between the last two samples in the range vector `v`, returning an instant vector with the given deltas and equivalent labels."},{insertText:"increase",label:"increase",detail:"increase(v range-vector)",documentation:"Calculates the increase in the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. The increase is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if a counter increases only by integer increments."},{insertText:"irate",label:"irate",detail:"irate(v range-vector)",documentation:"Calculates the per-second instant rate of increase of the time series in the range vector. This is based on the last two data points. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for."},{insertText:"label_join",label:"label_join",detail:"label_join(v instant-vector, dst_label string, separator string, src_label_1 string, src_label_2 string, ...)",documentation:"For each timeseries in `v`, joins all the values of all the `src_labels` using `separator` and returns the timeseries with the label `dst_label` containing the joined value. There can be any number of `src_labels` in this function."},{insertText:"label_replace",label:"label_replace",detail:"label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)",documentation:"For each timeseries in `v`, `label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)`  matches the regular expression `regex` against the label `src_label`.  If it matches, then the timeseries is returned with the label `dst_label` replaced by the expansion of `replacement`. `$1` is replaced with the first matching subgroup, `$2` with the second etc. If the regular expression doesn't match then the timeseries is returned unchanged."},{insertText:"ln",label:"ln",detail:"ln(v instant-vector)",documentation:"Calculates the natural logarithm for all elements in `v`.\nSpecial cases are:\n * `ln(+Inf) = +Inf`\n * `ln(0) = -Inf`\n * `ln(x < 0) = NaN`\n * `ln(NaN) = NaN`"},{insertText:"log2",label:"log2",detail:"log2(v instant-vector)",documentation:"Calculates the binary logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{insertText:"log10",label:"log10",detail:"log10(v instant-vector)",documentation:"Calculates the decimal logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{insertText:"minute",label:"minute",detail:"minute(v=vector(time()) instant-vector)",documentation:"Returns the minute of the hour for each of the given times in UTC. Returned values are from 0 to 59."},{insertText:"month",label:"month",detail:"month(v=vector(time()) instant-vector)",documentation:"Returns the month of the year for each of the given times in UTC. Returned values are from 1 to 12, where 1 means January etc."},{insertText:"pi",label:"pi",detail:"pi()",documentation:"Returns pi"},{insertText:"predict_linear",label:"predict_linear",detail:"predict_linear(v range-vector, t scalar)",documentation:"Predicts the value of time series `t` seconds from now, based on the range vector `v`, using simple linear regression."},{insertText:"rad",label:"rad",detail:"rad(v instant-vector)",documentation:"Converts degrees to radians for all elements in v"},{insertText:"rate",label:"rate",detail:"rate(v range-vector)",documentation:"Calculates the per-second average rate of increase of the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. Also, the calculation extrapolates to the ends of the time range, allowing for missed scrapes or imperfect alignment of scrape cycles with the range's time period."},{insertText:"resets",label:"resets",detail:"resets(v range-vector)",documentation:"For each input time series, `resets(v range-vector)` returns the number of counter resets within the provided time range as an instant vector. Any decrease in the value between two consecutive samples is interpreted as a counter reset."},{insertText:"round",label:"round",detail:"round(v instant-vector, to_nearest=1 scalar)",documentation:"Rounds the sample values of all elements in `v` to the nearest integer. Ties are resolved by rounding up. The optional `to_nearest` argument allows specifying the nearest multiple to which the sample values should be rounded. This multiple may also be a fraction."},{insertText:"scalar",label:"scalar",detail:"scalar(v instant-vector)",documentation:"Given a single-element input vector, `scalar(v instant-vector)` returns the sample value of that single element as a scalar. If the input vector does not have exactly one element, `scalar` will return `NaN`."},{insertText:"sgn",label:"sgn",detail:"sgn(v instant-vector)",documentation:"Returns a vector with all sample values converted to their sign, defined as this: 1 if v is positive, -1 if v is negative and 0 if v is equal to zero."},{insertText:"sort",label:"sort",detail:"sort(v instant-vector)",documentation:"Returns vector elements sorted by their sample values, in ascending order."},{insertText:"sort_desc",label:"sort_desc",detail:"sort_desc(v instant-vector)",documentation:"Returns vector elements sorted by their sample values, in descending order."},{insertText:"sqrt",label:"sqrt",detail:"sqrt(v instant-vector)",documentation:"Calculates the square root of all elements in `v`."},{insertText:"time",label:"time",detail:"time()",documentation:"Returns the number of seconds since January 1, 1970 UTC. Note that this does not actually return the current time, but the time at which the expression is to be evaluated."},{insertText:"timestamp",label:"timestamp",detail:"timestamp(v instant-vector)",documentation:"Returns the timestamp of each of the samples of the given vector as the number of seconds since January 1, 1970 UTC."},{insertText:"vector",label:"vector",detail:"vector(s scalar)",documentation:"Returns the scalar `s` as a vector with no labels."},{insertText:"year",label:"year",detail:"year(v=vector(time()) instant-vector)",documentation:"Returns the year for each of the given times in UTC."},{insertText:"avg_over_time",label:"avg_over_time",detail:"avg_over_time(range-vector)",documentation:"The average value of all points in the specified interval."},{insertText:"min_over_time",label:"min_over_time",detail:"min_over_time(range-vector)",documentation:"The minimum value of all points in the specified interval."},{insertText:"max_over_time",label:"max_over_time",detail:"max_over_time(range-vector)",documentation:"The maximum value of all points in the specified interval."},{insertText:"sum_over_time",label:"sum_over_time",detail:"sum_over_time(range-vector)",documentation:"The sum of all values in the specified interval."},{insertText:"count_over_time",label:"count_over_time",detail:"count_over_time(range-vector)",documentation:"The count of all values in the specified interval."},{insertText:"quantile_over_time",label:"quantile_over_time",detail:"quantile_over_time(scalar, range-vector)",documentation:"The \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) of the values in the specified interval."},{insertText:"stddev_over_time",label:"stddev_over_time",detail:"stddev_over_time(range-vector)",documentation:"The population standard deviation of the values in the specified interval."},{insertText:"stdvar_over_time",label:"stdvar_over_time",detail:"stdvar_over_time(range-vector)",documentation:"The population standard variance of the values in the specified interval."},{insertText:"last_over_time",label:"last_over_time",detail:"last_over_time(range-vector)",documentation:"The most recent point value in specified interval."},{insertText:"present_over_time",label:"present_over_time",detail:"present_over_time(range-vector)",documentation:"The value 1 for any series in the specified interval."},{insertText:"histogram_avg",label:"histogram_avg",detail:"histogram_avg(v instant-vector)",documentation:"Returns the arithmetic average of observed values stored in a native histogram. Samples that are not native histograms are ignored and do not show up in the returned vector."},{insertText:"histogram_count",label:"histogram_count",detail:"histogram_count(v instant-vector)",documentation:"Returns the count of observations stored in a native histogram."},{insertText:"histogram_sum",label:"histogram_sum",detail:"histogram_sum(v instant-vector)",documentation:"Returns the sum of observations stored in a native histogram."},{insertText:"histogram_fraction",label:"histogram_fraction",detail:"histogram_fraction(lower scalar, upper scalar, v instant-vector)",documentation:"Returns the estimated fraction of observations between the provided lower and upper values."},{insertText:"histogram_stddev",label:"histogram_stddev",detail:"histogram_stddev(v instant-vector)",documentation:"Returns the estimated standard deviation of observations in a native histogram, based on the geometric mean of the buckets where the observations lie."},{insertText:"histogram_stdvar",label:"histogram_stdvar",detail:"histogram_stdvar(v instant-vector)",documentation:"Returns the estimated standard variance of observations in a native histogram."}],i=g.map(c=>c.label),l={comment:{pattern:/#.*/},"context-aggregation":{pattern:/((by|without)\s*)\([^)]*\)/,lookbehind:!0,inside:{"label-key":{pattern:/[^(),\s][^,)]*[^),\s]*/,alias:"attr-name"},punctuation:/[()]/}},"context-labels":{pattern:/\{[^}]*(?=}?)/,greedy:!0,inside:{comment:{pattern:/#.*/},"label-key":{pattern:/[a-z_]\w*(?=\s*(=|!=|=~|!~))/,alias:"attr-name",greedy:!0},"label-value":{pattern:/"(?:\\.|[^\\"])*"/,greedy:!0,alias:"attr-value"},punctuation:/[{]/}},function:new RegExp(`\\b(?:${g.map(c=>c.label).join("|")})(?=\\s*\\()`,"i"),"context-range":[{pattern:/\[[^\]]*(?=])/,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}},{pattern:/(offset\s+)\w+/,lookbehind:!0,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}}],idList:{pattern:/\d+(\|\d+)+/,alias:"number"},number:/\b-?\d+((\.\d*)?([eE][+-]?\d+)?)?\b/,operator:new RegExp(`/[-+*/=%^~]|&&?|\\|?\\||!=?|<(?:=>?|<|>)?|>[>=]?|\\b(?:${n.join("|")})\\b`,"i"),punctuation:/[{};()`,.]/},d=l},32370:(G,R,e)=>{"use strict";e.d(R,{l:()=>E,z:()=>D});var t=e(20719),n=e(1220),s=e(75161),a=e(38961),r=e(15145);function g(){return[{id:r.jN.HistogramQuantile,name:"Histogram quantile",params:[{name:"Quantile",type:"number",options:[.99,.95,.9,.75,.5,.25]}],defaultParams:[.9],category:r.Ag.Functions,renderer:n.jY,addOperationHandler:n.iZ},i({id:r.jN.HistogramAvg}),i({id:r.jN.HistogramCount}),i({id:r.jN.HistogramSum}),{id:r.jN.HistogramFraction,name:"Histogram fraction",params:[{name:"Lower scalar",type:"number"},{name:"Upper scalar",type:"number"}],defaultParams:[0,.2],category:r.Ag.Functions,renderer:n.jY,addOperationHandler:n.iZ},i({id:r.jN.HistogramStddev}),i({id:r.jN.HistogramStdvar}),{id:r.jN.LabelReplace,name:"Label replace",params:[{name:"Destination label",type:"string"},{name:"Replacement",type:"string"},{name:"Source label",type:"string"},{name:"Regex",type:"string"}],category:r.Ag.Functions,defaultParams:["","$1","","(.*)"],renderer:n.kf,addOperationHandler:n.iZ},{id:r.jN.Ln,name:"Ln",params:[],defaultParams:[],category:r.Ag.Functions,renderer:n.jY,addOperationHandler:n.iZ},l(r.jN.Changes),l(r.jN.Rate,!0),l(r.jN.Irate),l(r.jN.Increase,!0),l(r.jN.Idelta),l(r.jN.Delta),i({id:r.jN.HoltWinters,params:[(0,n.z2)(),{name:"Smoothing Factor",type:"number"},{name:"Trend Factor",type:"number"}],defaultParams:["$__interval",.5,.5],alternativesKey:"range function",category:r.Ag.RangeFunctions,renderer:n.nU,addOperationHandler:h,changeTypeHandler:d}),i({id:r.jN.PredictLinear,params:[(0,n.z2)(),{name:"Seconds from now",type:"number"}],defaultParams:["$__interval",60],alternativesKey:"range function",category:r.Ag.RangeFunctions,renderer:n.nU,addOperationHandler:h,changeTypeHandler:d}),i({id:r.jN.QuantileOverTime,params:[(0,n.z2)(),{name:"Quantile",type:"number"}],defaultParams:["$__interval",.5],alternativesKey:"overtime function",category:r.Ag.RangeFunctions,renderer:n.Kl,addOperationHandler:h,changeTypeHandler:d}),...s.Iu,{id:r.jN.NestedQuery,name:"Binary operation with query",params:[],defaultParams:[],category:r.Ag.BinaryOps,renderer:(b,T,S)=>S,addOperationHandler:o},i({id:r.jN.Abs}),i({id:r.jN.Absent}),i({id:r.jN.Acos,category:r.Ag.Trigonometric}),i({id:r.jN.Acosh,category:r.Ag.Trigonometric}),i({id:r.jN.Asin,category:r.Ag.Trigonometric}),i({id:r.jN.Asinh,category:r.Ag.Trigonometric}),i({id:r.jN.Atan,category:r.Ag.Trigonometric}),i({id:r.jN.Atanh,category:r.Ag.Trigonometric}),i({id:r.jN.Ceil}),i({id:r.jN.Clamp,name:"Clamp",params:[{name:"Minimum Scalar",type:"number"},{name:"Maximum Scalar",type:"number"}],defaultParams:[1,1]}),i({id:r.jN.ClampMax,params:[{name:"Maximum Scalar",type:"number"}],defaultParams:[1]}),i({id:r.jN.ClampMin,params:[{name:"Minimum Scalar",type:"number"}],defaultParams:[1]}),i({id:r.jN.Cos,category:r.Ag.Trigonometric}),i({id:r.jN.Cosh,category:r.Ag.Trigonometric}),i({id:r.jN.DayOfMonth,category:r.Ag.Time}),i({id:r.jN.DayOfWeek,category:r.Ag.Time}),i({id:r.jN.DayOfYear,category:r.Ag.Time}),i({id:r.jN.DaysInMonth,category:r.Ag.Time}),i({id:r.jN.Deg}),l(r.jN.Deriv),i({id:r.jN.Exp}),i({id:r.jN.Floor}),i({id:r.jN.Hour}),i({id:r.jN.LabelJoin,params:[{name:"Destination Label",type:"string",editor:a.r},{name:"Separator",type:"string"},{name:"Source Label",type:"string",restParam:!0,optional:!0,editor:a.r}],defaultParams:["",",",""],renderer:m,explainHandler:u,addOperationHandler:p}),i({id:r.jN.Log10}),i({id:r.jN.Log2}),i({id:r.jN.Minute}),i({id:r.jN.Month}),i({id:r.jN.Pi,renderer:b=>`${b.id}()`}),i({id:r.jN.Rad}),l(r.jN.Resets),i({id:r.jN.Round,category:r.Ag.Functions,params:[{name:"To Nearest",type:"number"}],defaultParams:[1]}),i({id:r.jN.Scalar}),i({id:r.jN.Sgn}),i({id:r.jN.Sin,category:r.Ag.Trigonometric}),i({id:r.jN.Sinh,category:r.Ag.Trigonometric}),i({id:r.jN.Sort}),i({id:r.jN.SortDesc}),i({id:r.jN.Sqrt}),i({id:r.jN.Stddev}),i({id:r.jN.Tan,category:r.Ag.Trigonometric}),i({id:r.jN.Tanh,category:r.Ag.Trigonometric}),i({id:r.jN.Time,renderer:b=>`${b.id}()`}),i({id:r.jN.Timestamp}),i({id:r.jN.Vector,params:[{name:"Value",type:"number"}],defaultParams:[1],renderer:b=>`${b.id}(${b.params[0]})`}),i({id:r.jN.Year})]}function i(C){return{...C,id:C.id,name:C.name??(0,n.DQ)(C.id),params:C.params??[],defaultParams:C.defaultParams??[],category:C.category??r.Ag.Functions,renderer:C.renderer??(C.params?n.kf:n.jY),addOperationHandler:C.addOperationHandler??n.iZ}}function l(C,b=!1){return{id:C,name:(0,n.DQ)(C),params:[(0,n.z2)(b)],defaultParams:[b?"$__rate_interval":"$__interval"],alternativesKey:"range function",category:r.Ag.RangeFunctions,renderer:c,addOperationHandler:h,changeTypeHandler:d}}function d(C,b){return(C.params[0]==="$__rate_interval"&&b.defaultParams[0]!=="$__rate_interval"||C.params[0]==="$__interval"&&b.defaultParams[0]!=="$__interval")&&(C.params=b.defaultParams),C}function c(C,b,T){let S=(C.params??[])[0]??"5m";return`${b.id}(${T}[${S}])`}function h(C,b,T){const S={id:C.id,params:C.defaultParams};return b.operations.length>0&&T.getOperationDef(b.operations[0].id).addOperationHandler===h?{...b,operations:[S,...b.operations.slice(1)]}:{...b,operations:[S,...b.operations]}}function o(C,b){return{...b,binaryQueries:[...b.binaryQueries??[],{operator:"/",query:b}]}}function m(C,b,T){const S=C.params[0]??"",M=`"${C.params[1]??""}"`;return`${C.id}(${T}, "${S}", ${M}, "${C.params.slice(2).join(M)}")`}function u(C,b){let T=b?.documentation??"no docs";return typeof C.params[1]!="string"&&(T+=" \u{1F6A8}\u{1F6A8}\u{1F6A8} The `separator` must be a string."),T}function p(C,b){const T={id:C.id,params:C.defaultParams};return{...b,operations:[...b.operations,T]}}function f(){return[...(0,n.G3)(r.jN.Sum),...(0,n.G3)(r.jN.Avg),...(0,n.G3)(r.jN.Min),...(0,n.G3)(r.jN.Max),...(0,n.G3)(r.jN.Count),...(0,n.G3)(r.jN.Group),...(0,n.jC)(r.jN.TopK,{params:[{name:"K-value",type:"number"}],defaultParams:[5]}),...(0,n.jC)(r.jN.BottomK,{params:[{name:"K-value",type:"number"}],defaultParams:[5]}),...(0,n.jC)(r.jN.CountValues,{params:[{name:"Identifier",type:"string"}],defaultParams:["count"]}),...(0,n.jC)(r.jN.Quantile,{params:[{name:"Value",type:"number"}],defaultParams:[1]}),y(r.jN.SumOverTime),y(r.jN.AvgOverTime),y(r.jN.MinOverTime),y(r.jN.MaxOverTime),y(r.jN.CountOverTime),y(r.jN.LastOverTime),y(r.jN.PresentOverTime),y(r.jN.AbsentOverTime),y(r.jN.StddevOverTime)]}function y(C){return{id:C,name:(0,n.DQ)(C),params:[(0,n.z2)()],defaultParams:["$__interval"],alternativesKey:"overtime function",category:r.Ag.RangeFunctions,renderer:x,addOperationHandler:h}}function x(C,b,T){let S=(C.params??[])[0]??"$__interval";return`${b.id}(${T}[${S}])`}var v=e(83077);class P{constructor(b){this.categories=[],this.operationsRegistry=new v.O(b)}setOperationCategories(b){this.categories=b}getOperationsForCategory(b){return this.operationsRegistry.list().filter(T=>T.category===b&&!T.hideFromList)}getAlternativeOperations(b){return this.operationsRegistry.list().filter(T=>T.alternativesKey&&T.alternativesKey===b)}getCategories(){return this.categories}getOperationDef(b){return this.operationsRegistry.getIfExists(b)}renderOperations(b,T){for(const S of T){const O=this.operationsRegistry.getIfExists(S.id);if(!O)throw new Error(`Could not find operation ${S.id} in the registry`);b=O.renderer(S,O,b)}return b}renderBinaryQueries(b,T){if(T)for(const S of T)b=`${this.renderBinaryQuery(b,S)}`;return b}renderBinaryQuery(b,T){let S=b+` ${T.operator} `;return T.vectorMatches&&(S+=`${T.vectorMatchesType}(${T.vectorMatches}) `),S+this.renderQuery(T.query,!0)}renderLabels(b){if(b.length===0)return"";let T="{";for(const S of b)T!=="{"&&(T+=", "),T+=`${S.label}${S.op}"${S.value}"`;return T+"}"}renderQuery(b,T){let S=`${b.metric??""}${this.renderLabels(b.labels)}`;return S=this.renderOperations(S,b.operations),!T&&this.hasBinaryOp(b)&&b.binaryQueries?.length&&(S=`(${S})`),S=this.renderBinaryQueries(S,b.binaryQueries),T&&(this.hasBinaryOp(b)||b.binaryQueries?.length)&&(S=`(${S})`),S}hasBinaryOp(b){return b.operations.find(T=>this.getOperationDef(T.id)?.category===r.Ag.BinaryOps)!==void 0}}class E extends P{constructor(){super(()=>{const b=[...g(),...f()];for(const T of b){const S=t.AW.find(O=>O.insertText===T.id);S&&(T.documentation=S.documentation)}return b}),this.setOperationCategories([r.Ag.Aggregations,r.Ag.RangeFunctions,r.Ag.Functions,r.Ag.BinaryOps,r.Ag.Trigonometric,r.Ag.Time])}getQueryPatterns(){return[{name:"Rate then sum",type:r.n5.Rate,operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}]},{name:"Rate then sum by(label) then avg",type:r.n5.Rate,operations:[{id:"rate",params:["$__rate_interval"]},{id:"__sum_by",params:[""]},{id:"avg",params:[]}]},{name:"Histogram quantile on rate",type:r.n5.Histogram,operations:[{id:"rate",params:["$__rate_interval"]},{id:"__sum_by",params:["le"]},{id:"histogram_quantile",params:[.95]}]},{name:"Histogram quantile on increase",type:r.n5.Histogram,operations:[{id:"increase",params:["$__rate_interval"]},{id:"__max_by",params:["le"]},{id:"histogram_quantile",params:[.95]}]},{name:"Binary Query",type:r.n5.Binary,operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}],binaryQueries:[{operator:"/",query:{metric:"",labels:[],operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}]}}]}]}}const D=new E},75161:(G,R,e)=>{"use strict";e.d(R,{AE:()=>a,C8:()=>s,Iu:()=>r});var t=e(1220),n=e(15145);const s=[{id:n.jN.Addition,name:"Add scalar",sign:"+"},{id:n.jN.Subtraction,name:"Subtract scalar",sign:"-"},{id:n.jN.MultiplyBy,name:"Multiply by scalar",sign:"*"},{id:n.jN.DivideBy,name:"Divide by scalar",sign:"/"},{id:n.jN.Modulo,name:"Modulo by scalar",sign:"%"},{id:n.jN.Exponent,name:"Exponent",sign:"^"},{id:n.jN.EqualTo,name:"Equal to",sign:"==",comparison:!0},{id:n.jN.NotEqualTo,name:"Not equal to",sign:"!=",comparison:!0},{id:n.jN.GreaterThan,name:"Greater than",sign:">",comparison:!0},{id:n.jN.LessThan,name:"Less than",sign:"<",comparison:!0},{id:n.jN.GreaterOrEqual,name:"Greater or equal to",sign:">=",comparison:!0},{id:n.jN.LessOrEqual,name:"Less or equal to",sign:"<=",comparison:!0}],a=s.reduce((i,l)=>(i[l.sign]={id:l.id,comparison:l.comparison},i),{}),r=s.map(i=>{const l=[{name:"Value",type:"number"}];let d=[2];return i.comparison&&(l.push({name:"Bool",type:"boolean",description:"If checked comparison will return 0 or 1 for the value rather than filtering."}),d=[2,!1]),{id:i.id,name:i.name,params:l,defaultParams:d,alternativesKey:"binary scalar operations",category:n.Ag.BinaryOps,renderer:g(i.sign),addOperationHandler:t.iZ}});function g(i){return function(d,c,h){let o=d.params[0],m="";return d.params.length===2&&(m=d.params[1]?" bool":""),`${h} ${i}${m} ${o}`}}},38961:(G,R,e)=>{"use strict";e.d(R,{r:()=>i});var t=e(74848),n=e(96540),s=e(50877),a=e(90182),r=e(32370),g=e(1220);function i({onChange:d,index:c,operationId:h,value:o,query:m,datasource:u}){const[p,f]=(0,n.useState)({});return(0,t.jsx)(a.l6,{inputId:(0,g.OS)(h,c),autoFocus:o===""?!0:void 0,openMenuOnFocus:!0,onOpenMenu:async()=>{f({isLoading:!0});const y=await l(m,u);f({options:y,isLoading:void 0})},isLoading:p.isLoading,allowCustomValue:!0,noOptionsMessage:"No labels found",loadingMessage:"Loading labels",options:p.options,value:(0,s.z)(o),onChange:y=>d(c,y.value)})}async function l(d,c){let h=d.labels;c.type==="prometheus"&&(h=[{label:"__name__",op:"=",value:d.metric},...d.labels]);const o=r.z.renderLabels(h),m=await c.languageProvider.fetchLabelsWithMatch(o);return Object.keys(m).map(u=>({label:u,value:u}))}},9103:(G,R,e)=>{"use strict";e.d(R,{dm:()=>Pe,o6:()=>me});var t=e(74848),n=e(32196),s=e(76459),a=e.n(s),r=e(96540),g=e(23257),i=e.n(g),l=e(50877),d=e(13544),c=e(97801),h=e(81580),o=e(32264),m=e(40845),u=e(55852),p=e(14578),f=e(12681),y=e(88824),x=e(40276),v=e(90182),P=e(39268),E=e(14186),D=e(81996),C=e(26115),b=e(65307),T=e(37390),S=e(10354),O=e(62930),M=e(60782),I=e(19727),L=e(19384),B=e(15292),j=e(56034),A=e(14110),K=e(50556);async function W(he,be,Ke){let ze=!0;const nt=he.languageProvider.metricsMetadata;nt&&Object.keys(nt).length===0&&(ze=!1);let tt={},ot={},gt;return gt=Ke?.map(He=>{const et=U(He,he),rt=`${He}\xA6${et.description}`;return tt[He]=et,ot[rt]=et,et}),{isLoading:!1,hasMetadata:ze,metrics:gt??[],metaHaystackDictionary:ot,nameHaystackDictionary:tt,totalMetricCount:gt?.length??0,filteredMetricCount:gt?.length??0}}function U(he,be){let Ke=(0,K.AU)(he,be.languageProvider.metricsMetadata);const ze=(0,K.pK)(he,be.languageProvider.metricsMetadata);["histogram","summary"].forEach(ot=>{ze?.toLowerCase().includes(ot)&&Ke!==ot&&(Ke+=` (${ot})`)});const nt=he.match(/^\w+_bucket$|^\w+_bucket{.*}$/);return Ke==="histogram"&&!nt&&(Ke="native histogram"),{value:he,type:Ke,description:ze}}function F(he,be){const Ke=V(he);return!he.isLoading&&he.filteredMetricCount!==Ke.length&&be(Ie(Ke.length)),z(Ke,he.pageNum,he.resultsPerPage)}function V(he){let be=he.metrics;return he.fuzzySearchQuery&&!he.useBackend&&(he.fullMetaSearch?be=he.metaHaystackOrder.map(Ke=>he.metaHaystackDictionary[Ke]):be=he.nameHaystackOrder.map(Ke=>he.nameHaystackDictionary[Ke])),he.selectedTypes.length>0&&(be=be.filter((Ke,ze)=>he.selectedTypes.some(tt=>Ke.type&&tt.value?Ke.type.includes(tt.value):!Ke.type&&tt.value==="no type"))),he.includeNullMetadata||(be=be.filter(Ke=>Ke.type!==void 0&&Ke.description!==void 0)),be}function w(he){if(!he.metrics.length)return[];const be=he.resultsPerPage===0?1:he.resultsPerPage,Ke=Math.floor(V(he).length/be)+1;return[...Array(Ke).keys()].map(ze=>ze+1)}function z(he,be,Ke){const ze=Ke===0?1:Ke,nt=be===1?0:(be-1)*ze,tt=nt+ze;return he.slice(nt,tt)}const N=(he,be,Ke)=>he<1?1:he>Ke?Ke:he??be;async function H(he,be,Ke){const ze=(0,C.b4)(he),nt=be.map(gt=>`,${gt.label}="${gt.value}"`),tt=`label_values({__name__=~".*${ze}"${be?nt.join():""}},__name__)`;return await Ke.metricFindQuery(tt).then(gt=>gt.map(He=>U(He.text,Ke)))}function Q(he,be,Ke,ze){switch(he){case"grafana_prom_metric_encycopedia_tracking":(0,A.rR)(he,{metric:Ke,hasMetadata:be?.hasMetadata,totalMetricCount:be?.totalMetricCount,fuzzySearchQuery:be?.fuzzySearchQuery,fullMetaSearch:be?.fullMetaSearch,selectedTypes:be?.selectedTypes,useRegexSearch:be?.useBackend,includeResultsWithoutMetadata:be?.includeNullMetadata});case"grafana_prom_metric_encycopedia_disable_text_wrap_interaction":(0,A.rR)(he,{disableTextWrap:be?.disableTextWrap});case"grafana_prometheus_metric_encyclopedia_open":(0,A.rR)(he,{query:ze})}}const X=[{value:"counter",description:"A cumulative metric that represents a single monotonically increasing counter whose value can only increase or be reset to zero on restart."},{value:"gauge",description:"A metric that represents a single numerical value that can arbitrarily go up and down."},{value:"histogram",description:"A histogram samples observations (usually things like request durations or response sizes) and counts them in configurable buckets."},{value:"native histogram",description:"Native histograms are different from classic Prometheus histograms in a number of ways: Native histogram bucket boundaries are calculated by a formula that depends on the scale (resolution) of the native histogram, and are not user defined."},{value:"summary",description:"A summary samples observations (usually things like request durations and response sizes) and can calculate configurable quantiles over a sliding time window."},{value:"unknown",description:"These metrics have been given the type unknown in the metadata."},{value:"no type",description:"These metrics have no defined type in the metadata."}],ee={browse:"Search metrics by name",metadataSearchSwitch:"Include description in search",type:"Filter by type",includeNullMetadata:"Include results with no metadata",setUseBackend:"Enable regex search"};function Z(he){const{state:be,onChangeFullMetaSearch:Ke,onChangeIncludeNullMetadata:ze,onChangeDisableTextWrap:nt,onChangeUseBackend:tt}=he,ot=(0,m.$j)(),gt=q(ot);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:gt.selectItem,children:[(0,t.jsx)(B.d,{"data-testid":Ee.searchWithMetadata,value:be.fullMetaSearch,disabled:be.useBackend||!be.hasMetadata,onChange:()=>Ke()}),(0,t.jsx)("div",{className:gt.selectItemLabel,children:ee.metadataSearchSwitch})]}),(0,t.jsxs)("div",{className:gt.selectItem,children:[(0,t.jsx)(B.d,{value:be.includeNullMetadata,disabled:!be.hasMetadata,onChange:()=>ze()}),(0,t.jsx)("div",{className:gt.selectItemLabel,children:ee.includeNullMetadata})]}),(0,t.jsxs)("div",{className:gt.selectItem,children:[(0,t.jsx)(B.d,{value:be.disableTextWrap,onChange:()=>nt()}),(0,t.jsx)("div",{className:gt.selectItemLabel,children:"Disable text wrap"})]}),(0,t.jsxs)("div",{className:gt.selectItem,children:[(0,t.jsx)(B.d,{"data-testid":Ee.setUseBackend,value:be.useBackend,onChange:()=>tt()}),(0,t.jsxs)("div",{className:gt.selectItemLabel,children:[ee.setUseBackend,"\xA0"]}),(0,t.jsx)(j.m,{content:"Filter metric names by regex search, using an additional call on the Prometheus API.",placement:"bottom-end",children:(0,t.jsx)(p.I,{name:"info-circle",size:"xs",className:gt.settingsIcon})})]})]})}function q(he){return{settingsIcon:(0,n.css)({color:he.colors.text.secondary}),selectItem:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center",padding:"4px 0"}),selectItemLabel:(0,n.css)({margin:`0 0 0 ${he.spacing(1)}`,alignSelf:"center",color:he.colors.text.secondary,fontSize:"12px"})}}var ae=e(67061);function k({feedbackUrl:he}){const be=(0,m.of)(se);return(0,t.jsx)(ae.B,{children:(0,t.jsxs)("a",{href:he,className:be.link,title:"The metrics explorer is new, please let us know how we can improve it",target:"_blank",rel:"noreferrer noopener",children:[(0,t.jsx)(p.I,{name:"comment-alt-message"})," Give feedback"]})})}function se(he){return{link:(0,n.css)({color:he.colors.text.secondary,fontSize:he.typography.bodySmall.fontSize,":hover":{color:he.colors.text.link},margin:"-25px 0 30px 0"})}}var te=e(4936);function ne(he){const{metrics:be,onChange:Ke,onClose:ze,query:nt,state:tt,disableTextWrap:ot}=he,gt=(0,m.$j)(),He=le(gt,ot);function et(Oe){Oe.value&&(Ke({...nt,metric:Oe.value}),Q("grafana_prom_metric_encycopedia_tracking",tt,Oe.value),ze())}function rt(Oe){return tt.fullMetaSearch&&Oe?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("td",{children:ft(Oe.type??"")}),(0,t.jsx)("td",{children:(0,t.jsx)(i(),{textToHighlight:Oe.description??"",searchWords:tt.metaHaystackMatches,autoEscape:!0,highlightClassName:He.matchHighLight})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("td",{children:ft(Oe.type??"")}),(0,t.jsx)("td",{children:Oe.description??""})]})}function ht(Oe,Ye,Ge){return(0,t.jsxs)(t.Fragment,{children:[Oe,(0,t.jsx)("span",{className:He.tooltipSpace,children:(0,t.jsx)(j.m,{content:(0,t.jsxs)(t.Fragment,{children:["When creating a ",Ye,", Prometheus exposes multiple series with the type counter."," ",(0,te.jW)(Ge)]}),placement:"bottom-start",interactive:!0,children:(0,t.jsx)(p.I,{name:"info-circle",size:"xs"})})})]})}function ft(Oe){return Oe?Oe.includes("(summary)")?ht(Oe,"summary","https://prometheus.io/docs/concepts/metric_types/#summary"):Oe.includes("(histogram)")?ht(Oe,"histogram","https://prometheus.io/docs/concepts/metric_types/#histogram"):Oe:""}function De(){let Oe;return tt.fuzzySearchQuery||(Oe="There are no metrics found in the data source."),nt.labels.length>0&&(Oe="There are no metrics found. Try to expand your label filters."),(tt.fuzzySearchQuery||tt.selectedTypes.length>0)&&(Oe="There are no metrics found. Try to expand your search and filters."),(0,t.jsx)("tr",{className:He.noResults,children:(0,t.jsx)("td",{colSpan:3,children:Oe})})}function Te(Oe){return Oe.useBackend?[Oe.fuzzySearchQuery]:Oe.fullMetaSearch?Oe.metaHaystackMatches:Oe.nameHaystackMatches}return(0,t.jsxs)("table",{className:He.table,children:[(0,t.jsx)("thead",{className:He.stickyHeader,children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:`${He.nameWidth} ${He.tableHeaderPadding}`,children:"Name"}),tt.hasMetadata&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("th",{className:`${He.typeWidth} ${He.tableHeaderPadding}`,children:"Type"}),(0,t.jsx)("th",{className:`${He.descriptionWidth} ${He.tableHeaderPadding}`,children:"Description"})]}),(0,t.jsx)("th",{className:He.selectButtonWidth,children:" "})]})}),(0,t.jsx)("tbody",{children:(0,t.jsxs)(t.Fragment,{children:[be.length>0&&be.map((Oe,Ye)=>(0,t.jsxs)("tr",{className:He.row,children:[(0,t.jsx)("td",{className:He.nameOverflow,children:(0,t.jsx)(i(),{textToHighlight:Oe?.value??"",searchWords:Te(tt),autoEscape:!0,highlightClassName:He.matchHighLight})}),tt.hasMetadata&&rt(Oe),(0,t.jsx)("td",{children:(0,t.jsx)(u.$n,{size:"md",variant:"secondary",onClick:()=>et(Oe),className:He.centerButton,children:"Select"})})]},Oe?.value??Ye)),be.length===0&&!tt.isLoading&&De()]})})]})}const le=(he,be)=>({table:(0,n.css)({tableLayout:be?void 0:"fixed",borderRadius:he.shape.radius.default,width:"100%",whiteSpace:be?"nowrap":"normal",td:{padding:he.spacing(1)},"td,th":{minWidth:he.spacing(3),borderBottom:`1px solid ${he.colors.border.weak}`}}),row:(0,n.css)({label:"row",borderBottom:`1px solid ${he.colors.border.weak}`,"&:last-child":{borderBottom:0}}),tableHeaderPadding:(0,n.css)({padding:"8px"}),matchHighLight:(0,n.css)({background:"inherit",color:he.components.textHighlight.text,backgroundColor:he.components.textHighlight.background}),nameWidth:(0,n.css)({width:be?void 0:"37.5%"}),nameOverflow:(0,n.css)({overflowWrap:be?void 0:"anywhere"}),typeWidth:(0,n.css)({width:be?void 0:"15%"}),descriptionWidth:(0,n.css)({width:be?void 0:"35%"}),selectButtonWidth:(0,n.css)({width:be?void 0:"12.5%"}),stickyHeader:(0,n.css)({position:"sticky",top:0,backgroundColor:he.colors.background.primary}),noResults:(0,n.css)({textAlign:"center",color:he.colors.text.secondary}),tooltipSpace:(0,n.css)({marginLeft:"4px"}),centerButton:(0,n.css)({display:"block",margin:"auto",border:"none"})});var re=e(78036);const de=(he,be)=>({modal:(0,n.css)({width:"85vw",[he.breakpoints.down("md")]:{width:"100%"},[he.breakpoints.up("xl")]:{width:"60%"}}),inputWrapper:(0,n.css)({display:"flex",flexDirection:"row",flexWrap:"wrap"}),inputItemFirst:(0,n.css)({flexBasis:"40%",paddingRight:"16px",[he.breakpoints.down("md")]:{paddingRight:"0px",paddingBottom:"16px"}}),inputItem:(0,n.css)({flexGrow:1,flexBasis:"20%",[he.breakpoints.down("md")]:{minWidth:"100%"}}),selectWrapper:(0,n.css)({marginBottom:he.spacing(1)}),resultsAmount:(0,n.css)({color:he.colors.text.secondary,fontSize:"0.85rem",padding:"0 0 4px 0"}),resultsData:(0,n.css)({margin:`4px 0 ${he.spacing(2)} 0`}),resultsDataCount:(0,n.css)({margin:0}),resultsDataFiltered:(0,n.css)({color:he.colors.text.secondary,textAlign:"center",border:"solid 1px rgba(204, 204, 220, 0.25)",padding:"7px"}),resultsDataFilteredText:(0,n.css)({display:"inline",verticalAlign:"text-top"}),results:(0,n.css)({height:"calc(80vh - 310px)",overflowY:"scroll"}),resultsFooter:(0,n.css)({marginTop:"24px",display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",position:"sticky"}),currentlySelected:(0,n.css)({color:"grey",opacity:"75%",fontSize:"0.75rem"}),loadingSpinner:(0,n.css)({visibility:"hidden"}),visible:(0,n.css)({visibility:"visible"}),settingsBtn:(0,n.css)({float:"right"}),noBorder:(0,n.css)({border:"none"}),resultsPerPageLabel:(0,n.css)({color:he.colors.text.secondary,opacity:"75%",paddingTop:"5px",fontSize:"0.85rem",marginRight:"8px"}),resultsPerPageWrapper:(0,n.css)({display:"flex"})});var oe=e(53076),J=e(2543);const ce=new oe.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1});function pe(he,be,Ke){const[ze,nt,tt]=ce.search(he,be,0,1e5);let ot=[],gt=new Set;if(ze&&tt){const He=(et,rt)=>{rt&&gt.add(et)};for(let et=0;et<tt.length;et++){let rt=tt[et];oe.A.highlight(he[nt.idx[rt]],nt.ranges[rt],He),ot.push(he[nt.idx[rt]])}Ke([ot,[...gt]])}else be||Ke([[],[]])}const xe=(0,J.debounce)(pe,300),fe=he=>{const{datasource:be,isOpen:Ke,onClose:ze,onChange:nt,query:tt,initialMetrics:ot}=he,[gt,He]=(0,r.useReducer)(Se.reducer,(0,re.ue)(tt)),et=(0,m.$j)(),rt=de(et,gt.disableTextWrap),ht=(0,r.useCallback)(async()=>{He(ye(!0));const Je=await W(be,tt,ot);He(Ve({isLoading:!1,hasMetadata:Je.hasMetadata,metrics:Je.metrics,metaHaystackDictionary:Je.metaHaystackDictionary,nameHaystackDictionary:Je.nameHaystackDictionary,totalMetricCount:Je.metrics.length,filteredMetricCount:Je.metrics.length}))},[tt,be,ot]);(0,r.useEffect)(()=>{ht()},[ht]);const ft=X.map(Je=>({value:Je.value,label:Je.value,description:Je.description})),De=(0,r.useMemo)(()=>a()(async Je=>{He(ye(!0));const it=await H(Je,tt.labels,be);He(Me({metrics:it,filteredMetricCount:it.length,isLoading:!1}))},be.getDebounceTimeInMilliseconds()),[be,tt]);function Te(Je){He(we(Je))}function Oe(Je){He(We(Je))}function Ye(Je,it){gt.useBackend&&Je===""?ht():gt.useBackend?De(Je):it?xe(Object.keys(gt.metaHaystackDictionary),Je,Oe):xe(Object.keys(gt.nameHaystackDictionary),Je,Te)}const Ge=(0,t.jsx)(Z,{state:gt,onChangeFullMetaSearch:()=>{const Je=!gt.fullMetaSearch;He(_e(Je)),nt({...tt,fullMetaSearch:Je}),Ye(gt.fuzzySearchQuery,Je)},onChangeIncludeNullMetadata:()=>{He(at(!gt.includeNullMetadata)),nt({...tt,includeNullMetadata:!gt.includeNullMetadata})},onChangeDisableTextWrap:()=>{He(It()),nt({...tt,disableTextWrap:!gt.disableTextWrap}),Q("grafana_prom_metric_encycopedia_disable_text_wrap_interaction",gt,"")},onChangeUseBackend:()=>{const Je=!gt.useBackend;He(Tt(Je)),nt({...tt,useBackend:Je}),Je===!1?ht():gt.fuzzySearchQuery!==""&&De(gt.fuzzySearchQuery)}});return(0,t.jsxs)(T.a,{"data-testid":Ee.metricModal,isOpen:Ke,title:"Metrics explorer",onDismiss:ze,"aria-label":"Browse metrics",className:rt.modal,children:[(0,t.jsx)(k,{feedbackUrl:"https://forms.gle/DEMAJHoAMpe3e54CA"}),(0,t.jsxs)("div",{className:rt.inputWrapper,"data-testid":d.Tp.components.DataSource.Prometheus.queryEditor.builder.metricsExplorer,children:[(0,t.jsx)("div",{className:(0,n.cx)(rt.inputItem,rt.inputItemFirst),children:(0,t.jsx)(S.p,{autoFocus:!0,"data-testid":Ee.searchMetric,placeholder:ee.browse,value:gt.fuzzySearchQuery,onInput:Je=>{const it=Je.currentTarget.value??"";He(Ae(it)),Ye(it,gt.fullMetaSearch)}})}),gt.hasMetadata&&(0,t.jsx)("div",{className:rt.inputItem,children:(0,t.jsx)(v.KF,{"data-testid":Ee.selectType,inputId:"my-select",options:ft,value:gt.selectedTypes,placeholder:ee.type,onChange:Je=>He(ut(Je))})}),(0,t.jsx)("div",{children:(0,t.jsx)(O.y,{className:`${rt.loadingSpinner} ${gt.isLoading?rt.visible:""}`})}),(0,t.jsx)("div",{className:rt.inputItem,children:(0,t.jsx)(M.G,{"aria-label":"Additional settings",content:Ge,placement:"bottom-end",closeButton:!1,children:(0,t.jsxs)(I.e,{className:rt.settingsBtn,children:[(0,t.jsx)(u.$n,{variant:"secondary",size:"md",onClick:()=>He(ge()),"data-testid":Ee.showAdditionalSettings,className:rt.noBorder,children:"Additional Settings"}),(0,t.jsx)(u.$n,{className:rt.noBorder,variant:"secondary",icon:gt.showAdditionalSettings?"angle-up":"angle-down"})]})})})]}),(0,t.jsxs)("div",{className:rt.resultsData,children:[tt.metric&&(0,t.jsxs)("i",{className:rt.currentlySelected,children:["Currently selected: ",tt.metric]}),tt.labels.length>0&&(0,t.jsxs)("div",{className:rt.resultsDataFiltered,children:[(0,t.jsx)(p.I,{name:"info-circle",size:"sm"}),(0,t.jsx)("div",{className:rt.resultsDataFilteredText,children:"\xA0These metrics have been pre-filtered by labels chosen in the label filters."})]})]}),(0,t.jsx)("div",{className:rt.results,children:gt.metrics&&(0,t.jsx)(ne,{metrics:F(gt,He),onChange:nt,onClose:ze,query:tt,state:gt,disableTextWrap:gt.disableTextWrap})}),(0,t.jsxs)("div",{className:rt.resultsFooter,children:[(0,t.jsxs)("div",{className:rt.resultsAmount,children:["Showing ",gt.filteredMetricCount," of ",gt.totalMetricCount," results"]}),(0,t.jsx)(L.d,{currentPage:gt.pageNum??1,numberOfPages:w(gt).length,onNavigate:Je=>{He(Ue(Je??1))}}),(0,t.jsxs)("div",{className:rt.resultsPerPageWrapper,children:[(0,t.jsx)("p",{className:rt.resultsPerPageLabel,children:"# Results per page\xA0"}),(0,t.jsx)(S.p,{"data-testid":Ee.resultsPerPage,value:N(gt.resultsPerPage,re.J3,re.yH),placeholder:"results per page",width:10,title:"The maximum results per page is "+re.yH,type:"number",onInput:Je=>{const it=+Je.currentTarget.value;isNaN(it)||it>=re.yH||He(Ce(it))}})]})]})]})},Ee={metricModal:"metric-modal",searchMetric:"search-metric",searchWithMetadata:"search-with-metadata",selectType:"select-type",metricCard:"metric-card",useMetric:"use-metric",searchPage:"search-page",resultsPerPage:"results-per-page",setUseBackend:"set-use-backend",showAdditionalSettings:"show-additional-settings"},Se=(0,b.Z0)({name:"metrics-modal-state",initialState:(0,re.ue)(),reducers:{filterMetricsBackend:(he,be)=>{he.metrics=be.payload.metrics,he.filteredMetricCount=be.payload.filteredMetricCount,he.isLoading=be.payload.isLoading},buildMetrics:(he,be)=>{he.isLoading=be.payload.isLoading,he.metrics=be.payload.metrics,he.hasMetadata=be.payload.hasMetadata,he.metaHaystackDictionary=be.payload.metaHaystackDictionary,he.nameHaystackDictionary=be.payload.nameHaystackDictionary,he.totalMetricCount=be.payload.totalMetricCount,he.filteredMetricCount=be.payload.filteredMetricCount},setIsLoading:(he,be)=>{he.isLoading=be.payload},setFilteredMetricCount:(he,be)=>{he.filteredMetricCount=be.payload},setResultsPerPage:(he,be)=>{he.resultsPerPage=be.payload},setPageNum:(he,be)=>{he.pageNum=be.payload},setFuzzySearchQuery:(he,be)=>{he.fuzzySearchQuery=be.payload,he.pageNum=1},setNameHaystack:(he,be)=>{he.nameHaystackOrder=be.payload[0],he.nameHaystackMatches=be.payload[1]},setMetaHaystack:(he,be)=>{he.metaHaystackOrder=be.payload[0],he.metaHaystackMatches=be.payload[1]},setFullMetaSearch:(he,be)=>{he.fullMetaSearch=be.payload,he.pageNum=1},setIncludeNullMetadata:(he,be)=>{he.includeNullMetadata=be.payload,he.pageNum=1},setSelectedTypes:(he,be)=>{he.selectedTypes=be.payload,he.pageNum=1},setUseBackend:(he,be)=>{he.useBackend=be.payload,he.fullMetaSearch=!1,he.pageNum=1},setDisableTextWrap:he=>{he.disableTextWrap=!he.disableTextWrap},showAdditionalSettings:he=>{he.showAdditionalSettings=!he.showAdditionalSettings}}}),{setIsLoading:ye,buildMetrics:Ve,filterMetricsBackend:Me,setResultsPerPage:Ce,setPageNum:Ue,setFuzzySearchQuery:Ae,setNameHaystack:we,setMetaHaystack:We,setFullMetaSearch:_e,setIncludeNullMetadata:at,setSelectedTypes:ut,setUseBackend:Tt,setDisableTextWrap:It,showAdditionalSettings:ge,setFilteredMetricCount:Ie}=Se.actions,ue=" ",me=1e3;function Pe({datasource:he,query:be,onChange:Ke,onGetMetrics:ze,labelsFilters:nt,metricLookupDisabled:tt,onBlur:ot,variableEditor:gt}){const He=(0,m.of)(Ne),[et,rt]=(0,r.useState)({}),ht=o.$.featureToggles.prometheusMetricEncyclopedia,ft=[{value:"BrowseMetrics",label:"Metrics explorer",description:"Browse and filter all metrics and metadata with a fuzzy search"}],De=(0,r.useCallback)((Kt,Qt)=>{const an=Kt.label??Kt.value;return an?an.toLowerCase?Qt.split(ue).reduce((zn,Yn)=>{const ss=an.toLowerCase().includes(Yn.toLowerCase());let ds=!1;return ht&&(ds=an==="Metrics explorer"),zn&&(ss||ds)},!0):!0:!1},[ht]),Te=(0,r.useCallback)((Kt,Qt)=>Kt.__isNew__?Kt.label:(0,t.jsx)(i(),{searchWords:Qt.inputValue.split(ue),textToHighlight:Kt.label??"",highlightClassName:He.highlight}),[He.highlight]),Oe=(Kt,Qt)=>{const an=(0,C.b4)(Kt);return Fe(an,Qt)},Ye=Kt=>he.metricFindQuery(Oe(Kt,nt)).then(an=>{const Nn=an.length;(0,D.ky)(an),Nn>an.length?rt({...et,resultsTruncated:!0}):rt({...et,resultsTruncated:!1});const zn=an.map(Yn=>({label:Yn.text,value:Yn.text}));return ht?[...ft,...zn]:zn}),Ge=()=>Promise.resolve([]),Je=a()(Kt=>Ye(Kt),he.getDebounceTimeInMilliseconds()),it=Kt=>{const Qt=Kt.data;if(Qt.value==="BrowseMetrics"){const an=Kt.isFocused?He.focus:"";return(0,t.jsx)("div",{...Kt.innerProps,ref:Kt.innerRef,className:`${He.customOptionWidth} metric-encyclopedia-open`,"data-testid":d.Tp.components.Select.option,onKeyDown:Nn=>{Nn.code==="Enter"&&rt({...et,metricsModalOpen:!0})},children:(0,t.jsxs)("div",{className:`${He.customOption} ${an} metric-encyclopedia-open`,children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"metric-encyclopedia-open",children:Qt.label}),(0,t.jsx)("div",{className:`${He.customOptionDesc} metric-encyclopedia-open`,children:Qt.description})]}),(0,t.jsxs)(u.$n,{fill:"text",size:"sm",variant:"secondary",onClick:()=>rt({...et,metricsModalOpen:!0}),className:"metric-encyclopedia-open",children:["Open",(0,t.jsx)(p.I,{name:"arrow-right"})]})]})})}return(0,f.o5)(Kt)},St=({children:Kt,maxHeight:Qt,innerRef:an,innerProps:Nn})=>{const zn=(0,m.$j)(),Yn=(0,y.J)(zn),ss=!r.isValidElement(Kt)&&et.resultsTruncated;return(0,t.jsxs)("div",{...Nn,className:`${Yn.menu} ${He.customMenuContainer}`,style:{maxHeight:Math.round(Qt*.9)},"aria-label":"Select options menu",children:[(0,t.jsx)(x.E,{scrollRefCallback:an,autoHide:!1,autoHeightMax:"inherit",hideHorizontalTrack:!0,showScrollIndicators:!0,children:Kt}),ss&&(0,t.jsx)("div",{className:He.customMenuFooter,children:(0,t.jsx)("div",{children:"Only the top 1000 metrics are displayed in the metric select. Use the metrics explorer to view all metrics."})})]})},zt=()=>(0,t.jsx)(v.DW,{"data-testid":d.Tp.components.DataSource.Prometheus.queryEditor.builder.metricSelect,isClearable:!!gt,inputId:"prometheus-metric-select",className:He.select,value:be.metric?(0,l.z)(be.metric):void 0,placeholder:"Select metric",allowCustomValue:!0,formatOptionLabel:Te,filterOption:De,minMenuHeight:250,onOpenMenu:async()=>{if(tt)return;rt({isLoading:!0});const Kt=await ze(),Qt=Kt.map(Nn=>Nn.value),an=Kt.length;Kt.length>me&&(0,D.ky)(Kt),rt(ht?{metrics:[...ft,...Kt],isLoading:void 0,initialMetrics:Qt,resultsTruncated:an>Kt.length}:{metrics:Kt,isLoading:void 0,resultsTruncated:an>Kt.length})},loadOptions:tt?Ge:Je,isLoading:et.isLoading,defaultOptions:et.metrics??Array.from(new Array(25),()=>({value:""})),onChange:Kt=>{const Qt=Kt?.value;Qt?ht&&Qt==="BrowseMetrics"?(Q("grafana_prometheus_metric_encyclopedia_open",null,"",be),rt({...et,metricsModalOpen:!0})):Ke({...be,metric:Qt}):Ke({...be,metric:""})},components:ht?{Option:it,MenuList:St}:{MenuList:St},onBlur:ot});return(0,t.jsxs)(t.Fragment,{children:[ht&&!he.lookupsDisabled&&et.metricsModalOpen&&(0,t.jsx)(fe,{datasource:he,isOpen:et.metricsModalOpen,onClose:()=>rt({...et,metricsModalOpen:!1}),query:be,onChange:Ke,initialMetrics:et.initialMetrics??[]}),gt?(0,t.jsx)(P.C,{children:(0,t.jsx)(E.I,{label:"Metric",labelWidth:20,tooltip:(0,t.jsx)("div",{children:"Optional: returns a list of label values for the label name in the specified metric."}),children:zt()})}):(0,t.jsx)(c.B,{children:(0,t.jsx)(h.c,{label:"Metric",children:zt()})})]})}const Ne=he=>({select:(0,n.css)({minWidth:"125px"}),highlight:(0,n.css)({label:"select__match-highlight",background:"inherit",padding:"inherit",color:he.colors.warning.contrastText,backgroundColor:he.colors.warning.main}),customOption:(0,n.css)({padding:"8px",display:"flex",justifyContent:"space-between",cursor:"pointer",":hover":{backgroundColor:he.colors.emphasize(he.colors.background.primary,.1)}}),customOptionlabel:(0,n.css)({color:he.colors.text.primary}),customOptionDesc:(0,n.css)({color:he.colors.text.secondary,fontSize:he.typography.size.xs,opacity:"50%"}),focus:(0,n.css)({backgroundColor:he.colors.emphasize(he.colors.background.primary,.1)}),customOptionWidth:(0,n.css)({minWidth:"400px"}),customMenuFooter:(0,n.css)({flex:0,display:"flex",justifyContent:"space-between",padding:he.spacing(1.5),borderTop:`1px solid ${he.colors.border.weak}`,color:he.colors.text.secondary}),customMenuContainer:(0,n.css)({display:"flex",flexDirection:"column",background:he.colors.background.primary,boxShadow:he.shadows.z3})}),Fe=(he,be)=>{const Ke=be?Be(be):[];return`label_values({__name__=~".*${he}"${Ke?Ke.join(""):""}},__name__)`},Be=he=>he.map(be=>`,${be.label}="${be.value}"`)},29993:(G,R,e)=>{"use strict";e.d(R,{I:()=>S});var t=e(74848),n=e(96540),s=e(50556),a=e(81996),r=e(32370),g=e(26115),i=e(32196),l=e(2543),d=e(85269),c=e(97801),h=e(81580),o=e(39268),m=e(76892),u=e(76459),p=e.n(u),f=e(50877),y=e(13544),x=e(81392),v=e(3721),P=e(90182);function E({item:M,defaultOp:I,onChange:L,onDelete:B,onGetLabelNames:j,onGetLabelValues:A,invalidLabel:K,invalidValue:W,getLabelValuesAutofillSuggestions:U,debounceDuration:F}){const[V,w]=(0,n.useState)({}),[z,N]=(0,n.useState)(!1),[H,Q]=(0,n.useState)(!1),[X,ee]=(0,n.useState)([]),Z=(te=M.op)=>D.find(ne=>ne.label===te)?.isMultiValue,q=te=>{if(te){const ne=/\(([^)]+)\)/,le=te?.match(ne);return le&&le[0].indexOf("|")>0?[te]:te.indexOf("|")>0?te.split("|"):[te]}return[]},ae=p()(te=>U(te,M.label),F),k=p()(te=>{const ne=X.filter(le=>le.value.includes(te));return(0,a.ky)(ne)},F),se=M?.value??"";return(0,t.jsx)("div",{"data-testid":"prometheus-dimensions-filter-item",children:(0,t.jsxs)(x.M,{children:[(0,t.jsx)(P.DW,{placeholder:"Select label","data-testid":y.Tp.components.QueryBuilder.labelSelect,inputId:"prometheus-dimensions-filter-item-key",width:"auto",value:M.label?(0,f.z)(M.label):null,allowCustomValue:!0,onOpenMenu:async()=>{w({isLoadingLabelNames:!0});const te=await j(M);ee(te),N(!0);const ne=(0,a.ky)(te);w({labelNames:ne,isLoadingLabelNames:void 0})},onCloseMenu:()=>{N(!1)},isOpen:z,isLoading:V.isLoadingLabelNames??!1,loadOptions:k,defaultOptions:V.labelNames,onChange:te=>{te.label&&L({...M,op:M.op??I,label:te.label})},invalid:K}),(0,t.jsx)(P.l6,{"data-testid":y.Tp.components.QueryBuilder.matchOperatorSelect,className:"query-segment-operator",value:(0,f.z)(M.op??I),options:D,width:"auto",onChange:te=>{te.value!=null&&L({...M,op:te.value,value:Z(te.value)?M.value:q(M?.value)[0]})}}),(0,t.jsx)(P.DW,{placeholder:"Select value","data-testid":y.Tp.components.QueryBuilder.valueSelect,inputId:"prometheus-dimensions-filter-item-value",width:"auto",value:Z()?q(se).map(f.z):q(se).map(f.z)[0],allowCustomValue:!0,formatCreateLabel:te=>te,createOptionPosition:M.op?.includes("~")?"first":"last",onOpenMenu:async()=>{w({isLoadingLabelValues:!0});const te=await A(M);(0,a.ky)(te),Q(!0),w({...V,labelValues:te,isLoadingLabelValues:void 0})},onCloseMenu:()=>{Q(!1)},isOpen:H,defaultOptions:V.labelValues,isMulti:Z(),isLoading:V.isLoadingLabelValues,loadOptions:ae,onChange:te=>{if(te.value)L({...M,value:te.value,op:M.op??I});else{const ne=te.map(le=>le.label).join("|");L({...M,value:ne,op:M.op??I})}},invalid:W}),(0,t.jsx)(v.Z,{"aria-label":`remove-${M.label}`,icon:"times",variant:"secondary",onClick:B})]})},se)}const D=[{label:"=",value:"=",isMultiValue:!1},{label:"!=",value:"!=",isMultiValue:!1},{label:"=~",value:"=~",isMultiValue:!0},{label:"!~",value:"!~",isMultiValue:!0}],C="Select at least 1 label filter (label and value)";function b({labelsFilters:M,onChange:I,onGetLabelNames:L,onGetLabelValues:B,labelFilterRequired:j,getLabelValuesAutofillSuggestions:A,debounceDuration:K,variableEditor:W}){const U="=",[F,V]=(0,n.useState)([{op:U}]);(0,n.useEffect)(()=>{M.length>0?V(M):V([{op:U}])},[M]);const w=H=>{V(H);const Q=H.filter(X=>X.label!=null&&X.value!=null);(0,l.isEqual)(Q,M)||I(Q)},z=F.some(H=>H.label&&H.value),N=()=>(0,t.jsx)(d.o,{items:F,onChange:w,renderItem:(H,Q,X)=>(0,t.jsx)(E,{debounceDuration:K,item:H,defaultOp:U,onChange:Q,onDelete:X,onGetLabelNames:L,onGetLabelValues:B,invalidLabel:j&&!H.label,invalidValue:j&&!H.value,getLabelValuesAutofillSuggestions:A})});return(0,t.jsx)(t.Fragment,{children:W?(0,t.jsx)(o.C,{children:(0,t.jsxs)("div",{className:(0,i.cx)((0,i.css)({display:"flex"})),children:[(0,t.jsx)(m.c,{width:20,tooltip:(0,t.jsx)("div",{children:"Optional: used to filter the metric select for this query type."}),children:"Label filters"}),N()]})}):(0,t.jsx)(c.B,{children:(0,t.jsx)(h.c,{label:"Label filters",error:C,invalid:j&&!z,children:N()})})})}var T=e(9103);function S({datasource:M,query:I,onChange:L,onBlur:B,variableEditor:j}){const A=N=>{L({...I,labels:N})},K=(0,n.useCallback)(async N=>{const H=M.getVariables(),Q=await N;return[...H.map(X=>({label:X,value:X})),...Q.map(X=>({label:X.value,value:X.value,title:X.description}))]},[M]),W=async N=>{if(!I.metric)return await M.languageProvider.fetchLabels(),M.languageProvider.getLabelKeys().map(ee=>({value:ee}));const H=I.labels.filter(ee=>ee!==N);H.push({label:"__name__",op:"=",value:I.metric});const Q=r.z.renderLabels(H);let X=await M.languageProvider.fetchLabelsWithMatch(Q);return Object.keys(X).filter(ee=>!H.find(Z=>Z.label===ee)).map(ee=>({value:ee}))},U=(N,H)=>{const Q={label:H??"__name__",op:"=~",value:(0,g.b4)(`.*${N}`)},X=I.labels.filter(ae=>ae.label!==Q.label);X.push(Q),I.metric&&X.push({label:"__name__",op:"=",value:I.metric});const ee=X.map(ae=>({...ae,label:M.interpolateString(ae.label),value:M.interpolateString(ae.value)})),Z=r.z.renderLabels(ee);let q;return M.hasLabelsMatchAPISupport()?q=V(Q,Z):q=F(Q,Z),q.then(ae=>((0,a.ky)(ae),ae))},F=(N,H)=>{if(!N.label)return Promise.resolve([]);const Q=M.languageProvider.fetchSeries(H),X=M.interpolateString(N.label);return Q.then(ee=>{const Z=new Set;return ee.forEach(q=>{const ae=q[X];Z.add(ae)}),Array.from(Z).map(q=>({label:q,value:q}))})},V=(N,H)=>{if(!N.label)return Promise.resolve([]);const Q=`[${M.uid}][${I.metric}][${N.label}][${N.op}]`;return M.languageProvider.fetchSeriesValuesWithMatch(N.label,H,Q).then(X=>X.map(ee=>({value:ee,label:ee})))},w=async N=>{if(!N.label)return[];if(!I.metric)return(await M.languageProvider.getLabelValues(N.label)).map(ee=>({value:ee}));const H=I.labels.filter(ee=>ee!==N);H.push({label:"__name__",op:"=",value:I.metric});const Q=H.map(ee=>({...ee,label:M.interpolateString(ee.label),value:M.interpolateString(ee.value)})),X=r.z.renderLabels(Q);return M.hasLabelsMatchAPISupport()?V(N,X):F(N,X)},z=(0,n.useCallback)(()=>K(O(M,I)),[M,I,K]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(T.dm,{query:I,onChange:L,onGetMetrics:z,datasource:M,labelsFilters:I.labels,metricLookupDisabled:M.lookupsDisabled,onBlur:B||(()=>{}),variableEditor:j}),(0,t.jsx)(b,{debounceDuration:M.getDebounceTimeInMilliseconds(),getLabelValuesAutofillSuggestions:U,labelsFilters:I.labels,onChange:A,onGetLabelNames:N=>K(W(N)),onGetLabelValues:N=>K(w(N)),variableEditor:j})]})}async function O(M,I){M.languageProvider.metricsMetadata||await M.languageProvider.loadMetricsMetadata(),M.languageProvider.metricsMetadata||(M.languageProvider.metricsMetadata={});let L;if(I.labels.length>0){const B=r.z.renderLabels(I.labels);L=(await M.languageProvider.getSeries(B,!0)).__name__??[]}else L=await M.languageProvider.getLabelValues("__name__")??[];return L.map(B=>({value:B,description:(0,s.xB)(B,M.languageProvider.metricsMetadata)}))}},26432:(G,R,e)=>{"use strict";e.d(R,{W:()=>c,i:()=>h});var t=e(74848),n=e(96540),s=e(67061),a=e(20719),r=e(32370),g=e(76040),i=e(27994),l=e(96625),d=e(3884);const c="Fetch all series matching metric name and label filters.",h=(0,n.memo)(({query:o})=>{const m=(0,g.u)(o||"").query,u={grammar:a.Ay,name:"promql"};return(0,t.jsxs)(s.B,{gap:.5,direction:"column",children:[(0,t.jsx)(i.r,{stepNumber:1,title:(0,t.jsx)(d.Z,{query:`${m.metric} ${r.z.renderLabels(m.labels)}`,lang:u}),children:c}),(0,t.jsx)(l.k,{stepNumber:2,queryModeller:r.z,query:m,lang:u})]})});h.displayName="PromQueryBuilderExplained"},80109:(G,R,e)=>{"use strict";e.d(R,{$:()=>i});var t=e(74848),n=e(32196),s=e(13544),a=e(40845),r=e(7338),g=e(26432);function i(d){const{query:c,datasource:h,range:o,onRunQuery:m,onChange:u,data:p,app:f,showExplain:y}=d,x=(0,a.of)(l);return(0,t.jsxs)("div",{"data-testid":s.Tp.components.DataSource.Prometheus.queryEditor.code.queryField,className:x.wrapper,children:[(0,t.jsx)(r.L,{datasource:h,query:c,range:o,onRunQuery:m,onChange:u,history:[],data:p,app:f}),y&&(0,t.jsx)(g.i,{query:c.expr})]})}const l=d=>({wrapper:(0,n.css)({".gf-form":{marginBottom:0}})})},78036:(G,R,e)=>{"use strict";e.d(R,{J3:()=>t,mt:()=>a,ue:()=>s,yH:()=>n});const t=100,n=1e3;function s(r){return{isLoading:!0,metrics:[],hasMetadata:!0,metaHaystackDictionary:{},metaHaystackMatches:[],metaHaystackOrder:[],nameHaystackDictionary:{},nameHaystackOrder:[],nameHaystackMatches:[],totalMetricCount:0,filteredMetricCount:null,resultsPerPage:t,pageNum:1,fuzzySearchQuery:"",fullMetaSearch:r?.fullMetaSearch??!1,includeNullMetadata:r?.includeNullMetadata??!0,selectedTypes:[],useBackend:r?.useBackend??!1,disableTextWrap:r?.disableTextWrap??!1,showAdditionalSettings:!1}}function a(r){return{useBackend:r?.useBackend??!1,disableTextWrap:r?.disableTextWrap??!1,fullMetaSearch:r?.fullMetaSearch??!1,includeNullMetadata:r.includeNullMetadata??!1}}},1220:(G,R,e)=>{"use strict";e.d(R,{DQ:()=>u,G3:()=>y,Kl:()=>h,OS:()=>p,iZ:()=>m,jC:()=>x,jY:()=>i,kf:()=>l,nU:()=>c,z2:()=>f});var t=e(2543),n=e.n(t),s=e(55127),a=e.n(s),r=e(38961),g=e(15145);function i(S,O,M){const I=o(S,O,M),L=S.id+"(";return M&&I.push(M),L+I.join(", ")+")"}function l(S,O,M){const I=o(S,O,M),L=S.id+"(";return M&&I.unshift(M),L+I.join(", ")+")"}function d(S,O,M,I){if(O.params.length<2)throw`Cannot render a function with params of length [${O.params.length}]`;let L=(S.params??[])[0]??"5m";const B=o({...S,params:S.params.slice(1)},{...O,params:O.params.slice(1),defaultParams:O.defaultParams.slice(1)},M),j=S.id+"(";return M&&(I?B.push(`${M}[${L}]`):B.unshift(`${M}[${L}]`)),j+B.join(", ")+")"}function c(S,O,M){return d(S,O,M,!1)}function h(S,O,M){return d(S,O,M,!0)}function o(S,O,M){return(S.params??[]).map((I,L)=>O.params[L].type==="string"?'"'+I+'"':I)}function m(S,O){const M={id:S.id,params:S.defaultParams};return{...O,operations:[...O.operations,M]}}function u(S){return(0,t.capitalize)(S.replace(/_/g," "))}function p(S,O){return`operations.${S}.param.${O}`}function f(S=!1){const O=[{label:"$__interval",value:"$__interval"},{label:"1m",value:"1m"},{label:"5m",value:"5m"},{label:"10m",value:"10m"},{label:"1h",value:"1h"},{label:"24h",value:"24h"}];return S&&O.unshift({label:"$__rate_interval",value:"$__rate_interval"}),{name:"Range",type:"string",options:O}}function y(S,O={}){return[{id:S,name:u(S),params:[{name:"By label",type:"string",restParam:!0,optional:!0}],defaultParams:[],alternativesKey:"plain aggregations",category:g.Ag.Aggregations,renderer:i,paramChangedHandler:b(`__${S}_by`),explainHandler:E(S,""),addOperationHandler:m,...O},{id:`__${S}_by`,name:`${u(S)} by`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:r.r}],defaultParams:[""],alternativesKey:"aggregations by",category:g.Ag.Aggregations,renderer:v(S),paramChangedHandler:C(S),explainHandler:E(S,"by"),addOperationHandler:m,hideFromList:!0,...O},{id:`__${S}_without`,name:`${u(S)} without`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:r.r}],defaultParams:[""],alternativesKey:"aggregations by",category:g.Ag.Aggregations,renderer:P(S),paramChangedHandler:C(S),explainHandler:E(S,"without"),addOperationHandler:m,hideFromList:!0,...O}]}function x(S,O,M={}){const I=y(S,M);return I[0].params.unshift(...O.params),I[1].params.unshift(...O.params),I[2].params.unshift(...O.params),I[0].defaultParams=O.defaultParams,I[1].defaultParams=[...O.defaultParams,""],I[2].defaultParams=[...O.defaultParams,""],I[1].renderer=D(S),I[2].renderer=D(S),I}function v(S){return function(M,I,L){return`${S} by(${M.params.join(", ")}) (${L})`}}function P(S){return function(M,I,L){return`${S} without(${M.params.join(", ")}) (${L})`}}function E(S,O){return function(I){const L=I.params.map(j=>`\`${j}\``).join(" and "),B=a()("label",I.params.length);switch(O){case"by":return`Calculates ${S} over dimensions while preserving ${B} ${L}.`;case"without":return`Calculates ${S} over the dimensions ${L}. All other labels are preserved.`;default:return`Calculates ${S} over the dimensions.`}}}function D(S){return function(M,I,L){const B=I.params.findIndex(K=>K.restParam),j=M.params.slice(0,B),A=M.params.slice(B);return`${S} by(${A.join(", ")}) (${j.map((K,W)=>I.params[W].type==="string"?`"${K}"`:K).join(", ")}, ${L})`}}function C(S){return function(M,I,L){return I.params.length<L.params.length?{...I,id:S}:I}}function b(S){return function(M,I,L){return I.params.length===L.params.length?{...I,id:S}:I}}function T(S,O){if(!S.label||!S.op||!S.value||O.length<2)return!1;const M=S.op.toString().startsWith("!");return O.filter(B=>B.label===S.label&&B.value===S.value&&B.op!==S.op).some(B=>!!(M&&B?.op?.toString().startsWith("!")===!1||M===!1&&B?.op?.toString().startsWith("!")))}},76040:(G,R,e)=>{"use strict";e.d(R,{u:()=>a});var t=e(84555),n=e(75161),s=e(26115);function a(f){const y=(0,s.qk)(f),v=t.K3.parse(y).topNode,E={query:{metric:"",labels:[],operations:[]},errors:[]};try{g(y,v,E)}catch(D){console.error(D),D instanceof Error&&E.errors.push({text:D.message})}return p(E.query)&&(E.errors=[]),r(f)&&(E.errors=[]),E}function r(f){const y={query:{metric:"",labels:[],operations:[]},errors:[]};f=f.replace(/\$__interval/g,"1s"),f=f.replace(/\$__interval_ms/g,"1000"),f=f.replace(/\$__rate_interval/g,"1s"),f=f.replace(/\$__range_ms/g,"1000"),f=f.replace(/\$__range_s/g,"1"),f=f.replace(/\$__range/g,"1s");const v=t.K3.parse(f).topNode;try{g(f,v,y)}catch{return!1}return y.errors.length===0}function g(f,y,x){const v=x.query;switch(y.type.id){case t.gw:{v.metric=(0,s.AA)(f,y);break}case t.Yq:{v.labels.push(l(f,y));const P=y.getChild(s.Ql);P&&x.errors.push((0,s.xz)(f,P));break}case t.R6:{c(f,y,x);break}case t.Fn:{h(f,y,x);break}case t.df:{m(f,y,x);break}case s.Ql:{if(i(y))break;x.errors.push((0,s.xz)(f,y));break}default:{y.type.id===t.ek&&x.errors.push((0,s.xz)(f,y));let P=y.firstChild;for(;P;)g(f,P,x),P=P.nextSibling}}}function i(f){return f.prevSibling?.firstChild?.type.id===t.Fb}function l(f,y){const x=(0,s.AA)(f,y.getChild(t.IC)),v=(0,s.AA)(f,y.getChild(t.Lf)),P=(0,s.AA)(f,y.getChild(t.LW)).replace(/^["'`]|["'`]$/g,"");return{label:x,op:v,value:P}}const d=["changes","rate","irate","increase","delta"];function c(f,y,x){const v=x.query,P=y.getChild(t.m3),E=(0,s.AA)(f,P),D=y.getChild(t.Dh),C=[];let b="";if(d.includes(E)||E.endsWith("_over_time")){let S=(0,s.AA)(f,y).match(/\[(.+)\]/);S?.[1]&&(b=S[1],C.push(S[1]))}const T={id:E,params:C};if(v.operations.unshift(T),D){if((0,s.AA)(f,D)==="(["+b+"])")return;o(f,D,x,T)}}function h(f,y,x){const v=x.query,P=y.getChild(t.xb);let E=(0,s.AA)(f,P);const D=y.getChild(t.hI),C=[];D&&(D.getChild("By")&&E&&(E=`__${E}_by`),D.getChild(t.xB)&&(E=`__${E}_without`),C.push(...(0,s.R1)(f,D,t.IC)));const b=y.getChild(t.Dh),T={id:E,params:[]};v.operations.unshift(T),o(f,b,x,T),T.params.push(...C)}function o(f,y,x,v){if(y)switch(y.type.id){case t.Dh:{let P=y.firstChild;for(;P;){let E;P.type.id===t.df?E=P:E=P.getChild(t.df),E&&x.errors.push({text:"Query parsing is ambiguous.",from:E.from,to:E.to}),o(f,P,x,v),P=P.nextSibling}break}case t.Po:{v.params.push(parseFloat((0,s.AA)(f,y)));break}case t.LW:{v.params.push((0,s.AA)(f,y).replace(/"/g,""));break}default:g(f,y,x)}}function m(f,y,x){const v=x.query,P=y.firstChild,E=(0,s.AA)(f,P.nextSibling),D=u(f,y.getChild(t.eM)??y.getChild(t.Ue)),C=y.lastChild,b=n.AE[E],T=P.type.id===t.Po,S=C.type.id===t.Po,O=C.type.id===t.df;if(T||g(f,P,x),S)v.operations.push((0,s.rq)(b,f,C,!!D?.isBool));else if(O){const M=(0,s.z9)(C);M?.type.id===t.Po&&v.operations.push((0,s.rq)(b,f,M,!!D?.isBool)),g(f,C,x)}else{v.binaryQueries=v.binaryQueries||[];const M={operator:E,query:{metric:"",labels:[],operations:[]}};D?.isMatcher&&(M.vectorMatchesType=D.matchType,M.vectorMatches=D.matches),v.binaryQueries.push(M),g(f,C,{query:M.query,errors:x.errors})}}function u(f,y){if(y){if(y.getChild("Bool"))return{isBool:!0,isMatcher:!1};{let x="";const v=y.getChild(t.x$);return v&&(x=(0,s.R1)(f,v,t.IC).join(", ")),{isMatcher:!0,isBool:!1,matches:x,matchType:y.getChild(t.On)?"on":"ignoring"}}}}function p(f){return f.labels.length===0&&f.operations.length===0&&!f.metric}},26115:(G,R,e)=>{"use strict";e.d(R,{AA:()=>l,Ql:()=>t,R1:()=>c,b4:()=>h,qk:()=>r,rq:()=>d,xz:()=>s,z9:()=>n});const t=0;function n(o){return o.firstChild?n(o.firstChild):o}function s(o,m){return{text:l(o,m),from:m.from,to:m.to,parentType:m.parent?.name}}const a=/\$(\w+)|\[\[([\s\S]+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g;function r(o){return o.replace(a,(m,u,p,f,y,x,v)=>{const P=f||v;let E=u,D="0";return p&&(E=p,D="1"),y&&(E=y,D="2"),`__V_${D}__`+E+"__V__"+(P?"__F__"+P+"__F__":"")})}const g=[(o,m)=>`$${o}`,(o,m)=>`[[${o}${m?`:${m}`:""}]]`,(o,m)=>`\${${o}${m?`:${m}`:""}}`];function i(o){return o.replace(/__V_(\d)__(.+?)__V__(?:__F__(\w+)__F__)?/g,(m,u,p,f)=>g[parseInt(u,10)](p,f))}function l(o,m){return m?i(o.substring(m.from,m.to)):""}function d(o,m,u,p){const f=[parseFloat(l(m,u))];return o.comparison&&f.push(p),{id:o.id,params:f}}function c(o,m,u){if(m.type.id===u)return[l(o,m)];const p=[];let f=0,y=m.childAfter(f);for(;y;)p.push(...c(o,y,u)),f=y.to,y=m.childAfter(f);return p}const h=o=>o.split(" ").map(u=>`${u}.*`).join("")},27994:(G,R,e)=>{"use strict";e.d(R,{r:()=>r});var t=e(74848),n=e(32196),s=e(36663),a=e(40845);function r({title:i,stepNumber:l,markdown:d,children:c}){const h=(0,a.of)(g);return(0,t.jsxs)("div",{className:h.box,children:[l!==void 0&&(0,t.jsx)("div",{className:h.stepNumber,children:l}),(0,t.jsxs)("div",{className:h.boxInner,children:[i&&(0,t.jsx)("div",{className:h.header,children:(0,t.jsx)("span",{children:i})}),(0,t.jsxs)("div",{className:h.body,children:[d&&(0,t.jsx)("div",{dangerouslySetInnerHTML:{__html:(0,s.G)(d)}}),c]})]})]})}const g=i=>({box:(0,n.css)({background:i.colors.background.secondary,padding:i.spacing(1),borderRadius:i.shape.radius.default,position:"relative"}),boxInner:(0,n.css)({marginLeft:i.spacing(4)}),stepNumber:(0,n.css)({fontWeight:i.typography.fontWeightMedium,background:i.colors.secondary.main,width:"20px",height:"20px",borderRadius:i.shape.radius.circle,display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"10px",left:"11px",fontSize:i.typography.bodySmall.fontSize}),header:(0,n.css)({paddingBottom:i.spacing(.5),display:"flex",alignItems:"center",fontFamily:i.typography.fontFamilyMonospace}),body:(0,n.css)({color:i.colors.text.secondary,"p:last-child":{margin:0},a:{color:i.colors.text.link,textDecoration:"underline"}})})},96625:(G,R,e)=>{"use strict";e.d(R,{k:()=>a});var t=e(74848),n=e(27994),s=e(3884);function a({query:r,queryModeller:g,stepNumber:i,lang:l,onMouseEnter:d,onMouseLeave:c}){return(0,t.jsx)(t.Fragment,{children:r.operations.map((h,o)=>{const m=g.getOperationDef(h.id);if(!m)return`Operation ${h.id} not found`;const u=m.renderer(h,m,"<expr>"),p=m.explainHandler?m.explainHandler(h,m):m.documentation??"no docs";return(0,t.jsx)("div",{onMouseEnter:()=>d?.(h,o),onMouseLeave:()=>c?.(h,o),children:(0,t.jsx)(n.r,{stepNumber:o+i,title:(0,t.jsx)(s.Z,{query:u,lang:l}),markdown:p})},o)})})}},3884:(G,R,e)=>{"use strict";e.d(R,{Z:()=>g});var t=e(74848),n=e(32196),s=e(28848),a=e.n(s),r=e(40845);function g({query:l,lang:d,className:c}){const h=(0,r.$j)(),o=i(h),m=a().highlight(l,d.grammar,d.name);return(0,t.jsx)("div",{className:(0,n.cx)(o.editorField,"prism-syntax-highlight",c),"aria-label":"selector",dangerouslySetInnerHTML:{__html:m}})}const i=l=>({editorField:(0,n.css)({fontFamily:l.typography.fontFamilyMonospace,fontSize:l.typography.bodySmall.fontSize})})},15145:(G,R,e)=>{"use strict";e.d(R,{Ag:()=>t,jN:()=>n,n5:()=>s});var t=(a=>(a.Aggregations="Aggregations",a.RangeFunctions="Range functions",a.Functions="Functions",a.BinaryOps="Binary operations",a.Trigonometric="Trigonometric",a.Time="Time Functions",a))(t||{}),n=(a=>(a.Abs="abs",a.Absent="absent",a.AbsentOverTime="absent_over_time",a.Acos="acos",a.Acosh="acosh",a.Asin="asin",a.Asinh="asinh",a.Atan="atan",a.Atanh="atanh",a.Avg="avg",a.AvgOverTime="avg_over_time",a.BottomK="bottomk",a.Ceil="ceil",a.Changes="changes",a.Clamp="clamp",a.ClampMax="clamp_max",a.ClampMin="clamp_min",a.Cos="cos",a.Cosh="cosh",a.Count="count",a.CountOverTime="count_over_time",a.CountScalar="count_scalar",a.CountValues="count_values",a.DayOfMonth="day_of_month",a.DayOfWeek="day_of_week",a.DayOfYear="day_of_year",a.DaysInMonth="days_in_month",a.Deg="deg",a.Delta="delta",a.Deriv="deriv",a.DropCommonLabels="drop_common_labels",a.Exp="exp",a.Floor="floor",a.Group="group",a.HistogramQuantile="histogram_quantile",a.HistogramAvg="histogram_avg",a.HistogramCount="histogram_count",a.HistogramSum="histogram_sum",a.HistogramFraction="histogram_fraction",a.HistogramStddev="histogram_stddev",a.HistogramStdvar="histogram_stdvar",a.HoltWinters="holt_winters",a.Hour="hour",a.Idelta="idelta",a.Increase="increase",a.Irate="irate",a.LabelJoin="label_join",a.LabelReplace="label_replace",a.Last="last",a.LastOverTime="last_over_time",a.Ln="ln",a.Log10="log10",a.Log2="log2",a.Max="max",a.MaxOverTime="max_over_time",a.Min="min",a.MinOverTime="min_over_time",a.Minute="minute",a.Month="month",a.Pi="pi",a.PredictLinear="predict_linear",a.Present="present",a.PresentOverTime="present_over_time",a.Quantile="quantile",a.QuantileOverTime="quantile_over_time",a.Rad="rad",a.Rate="rate",a.Resets="resets",a.Round="round",a.Scalar="scalar",a.Sgn="sgn",a.Sin="sin",a.Sinh="sinh",a.Sort="sort",a.SortDesc="sort_desc",a.Sqrt="sqrt",a.Stddev="stddev",a.StddevOverTime="stddev_over_time",a.Sum="sum",a.SumOverTime="sum_over_time",a.Tan="tan",a.Tanh="tanh",a.Time="time",a.Timestamp="timestamp",a.TopK="topk",a.Vector="vector",a.Year="year",a.Addition="__addition",a.Subtraction="__subtraction",a.MultiplyBy="__multiply_by",a.DivideBy="__divide_by",a.Modulo="__modulo",a.Exponent="__exponent",a.NestedQuery="__nested_query",a.EqualTo="__equal_to",a.NotEqualTo="__not_equal_to",a.GreaterThan="__greater_than",a.LessThan="__less_than",a.GreaterOrEqual="__greater_or_equal",a.LessOrEqual="__less_or_equal",a))(n||{}),s=(a=>(a.Rate="rate",a.Histogram="histogram",a.Binary="binary",a))(s||{})},33115:(G,R,e)=>{"use strict";e.d(R,{$i:()=>l,Dr:()=>g});var t=e(70416),n=e(47232),s=e(77678),a=e(67414),r=e(65879);const g="10m",i=c=>`${c.type}|${c.name}|${JSON.stringify(c.labels??"")}`;class l{constructor(h){this.applyInterpolation=(m,u)=>m,this.cache=new Map;const o=h.overlapString;if((0,t.di)(o)){const m=(0,t.E9)(o);this.overlapWindowMs=(0,t.WT)(m)}else{const m=(0,t.E9)(g);this.overlapWindowMs=(0,t.WT)(m)}this.getTargetSignature=h.getTargetSignature,h.applyInterpolation&&(this.applyInterpolation=h.applyInterpolation)}requestInfo(h){const o=h.range.from.valueOf(),m=h.range.to.valueOf(),u=h.rangeRaw?.to?.toString()==="now";let p=u,f;const y=new Map;h.targets.forEach(x=>{let v=`${h.dashboardUID}|${h.panelId}|${x.refId}`,P=this.getTargetSignature(h,x);y.set(v,P)});for(const[x,v]of y){let P=this.cache.get(x);if(P?.signature!==v?p=!1:(f=P?.prevTo??1/0,p=m>f&&o<=f),!p)break}if(p&&f){let x=Math.max(f-this.overlapWindowMs,o);const v=(0,n.KQ)(m),P=(0,n.KQ)((0,s.rs)(x,h.intervalMs));h={...h,range:{...h.range,from:P,to:v}}}else y.forEach((x,v)=>{this.cache.delete(v)});return{requests:[h],targetSignatures:y,shouldCache:u}}procFrames(h,o,m){if(o?.shouldCache){const u=h.range.from.valueOf(),p=h.range.to.valueOf(),f=new Map;m.forEach(x=>{let v=`${h.dashboardUID}|${h.panelId}|${x.refId}`,P=f.get(v);P||(P=[],f.set(v,P)),P.push(x)});let y=[];f.forEach((x,v)=>{let P=(v?this.cache.get(v)?.frames:null)??[];x.forEach(D=>{if(D.length===0||D.fields.length===0)return;let C=i(D.fields[1]),b=P.find(T=>i(T.fields[1])===C);if(!b)P.push(D);else{let T=b.fields.map(M=>M.values),S=D.fields.map(M=>M.values),O=(0,a.c)(T,S);if(O){for(let M=0;M<O.length;M++)b.fields[M].values=O[M],b.fields[M].config.displayNameFromDS!==D.fields[M].config.displayNameFromDS&&(b.fields[M].config.displayNameFromDS=D.fields[M].config.displayNameFromDS);b.length=b.fields[0].values.length}}});let E=[];P.forEach(D=>{let C=D.fields.map(S=>S.values);const b=d(h,x,this.applyInterpolation);let T=(0,a.F)(C,u-b,p);if(T[0].length>0){for(let S=0;S<T.length;S++)D.fields[S].values=T[S];E.push(D)}}),this.cache.set(v,{signature:o.targetSignatures.get(v),frames:E,prevTo:p}),y.push(...E)}),m=y.map(x=>({...x,fields:x.fields.map(v=>({...v,config:{...v.config},values:v.values.slice()}))}))}return m}}function d(c,h,o){if(c.targets[0].datasource?.type!=="prometheus")return 0;const m=c.targets.find(p=>p.refId===h[0].refId);let u=c.intervalMs;if(m?.interval){const p=r.intervalToMs(o(m.interval));p>c.intervalMs&&(u=p)}return u}},59809:(G,R,e)=>{"use strict";e.d(R,{Bm:()=>b,J3:()=>m,L:()=>T,hF:()=>E});var t=e(2543),n=e.n(t),s=e(41987),a=e(41260),r=e(11261),g=e(28240),i=e(52622),l=e(57875),d=e(19347);const c=/^[+-]?inf(?:inity)?$/i,h=(S,O)=>O.app===s.Jk.Explore&&(S.meta?.custom?.resultType==="vector"||S.meta?.custom?.resultType==="scalar")?!0:O.targets.find(I=>I.refId===S.refId)?.format==="table",o=(S,O)=>S.meta?.type===a.m.HeatmapCells?!1:O.targets.find(I=>I.refId===S.refId)?.format==="heatmap";function m(S,O,M){S.data.forEach(H=>{const Q=O.targets.find(X=>X.refId===H.refId);Q&&Q.legendFormat==="__auto"&&H.fields.forEach(X=>{if(X.labels?.__name__&&X.labels?.__name__===X.name){const ee={...X,name:r.Bc};X.config.displayNameFromDS=(0,g.Ct)(ee,H,S.data)}})});const[I,L]=(0,t.partition)(S.data,H=>h(H,O)),B=p(I),[j,A]=(0,t.partition)(L,H=>H.meta?.custom?.resultType==="exemplar"),{exemplarTraceIdDestinations:K}=M,W=j.map(H=>{if(K?.length)for(const Q of K){const X=H.fields.find(ee=>ee.name===Q.name);if(X){const ee=y(Q);X.config.links=X.config.links?.length?[...X.config.links,...ee]:ee}}return{...H,meta:{...H.meta,dataTopic:i.QR.Annotations}}}),[U,F]=(0,t.partition)(A,H=>o(H,O));U.forEach(H=>{if(H.name==null){let Q=H.fields.find(X=>X.type===r.PU.number);if(Q){let X=Q.labels?.le;X&&(H.name=X,Q.config.displayNameFromDS=X)}}});const V=(0,t.groupBy)(U,H=>H.refId);let w=[];for(const H in V){const Q=V[H],X=(0,t.groupBy)(Q,ee=>{const Z=ee.fields.find(q=>q.type===r.PU.number);if(Z?.labels&&u in Z.labels){const{le:q,...ae}=Z?.labels;return Object.values(ae).join()}return Object.values(Z?.labels??[]).join()});(0,t.forOwn)(X,(ee,Z)=>{const q=ee.sort(b);w.push(D(C(q)))})}const z=F.map(H=>({...H,meta:{...H.meta,preferredVisualisationType:"graph"}})),N=(0,t.flatten)(w);return{...S,data:[...z,...B,...N,...W]}}const u="le";function p(S){if(S.length===0||S.length===1&&S[0].length===0)return S;const O=(0,t.groupBy)(S,"refId"),M=Object.keys(O);return M.map(L=>{const B=f(M.length,L),j=P({data:[],valueName:B}),A=v([]),K=[];O[L].forEach(U=>{const V=U.fields[1]?.labels??{};Object.keys(V).sort().forEach(w=>{K.some(z=>z.name===w)||K.push({name:w,config:{filterable:!0},type:r.PU.string,values:[]})})}),O[L].forEach(U=>{A.config.interval??=U.fields[0]?.config.interval;const F=U.fields[0]?.values??[],V=U.fields[1]?.values??[];F.forEach(w=>A.values.push(w)),V.forEach(w=>{j.values.push(T(w));const z=U.fields[1].labels??{};K.forEach(N=>N.values.push(x(z,N.name)))})});const W=[A,...K,j];return{refId:L,fields:W,meta:{...O[L][0].meta,preferredVisualisationType:"rawPrometheus"},length:A.values.length}})}function f(S,O=""){return S>1?`Value #${O}`:"Value"}function y(S){const O=[];if(S.datasourceUid){const I=(0,d.l)().getInstanceSettings(S.datasourceUid);I&&O.push({title:S.urlDisplayLabel||`Query with ${I?.name}`,url:"",internal:{query:{query:"${__value.raw}",queryType:"traceql"},datasourceUid:S.datasourceUid,datasourceName:I?.name??"Data source not found"}})}return S.url&&O.push({title:S.urlDisplayLabel||`Go to ${S.url}`,url:S.url,targetBlank:!0}),O}function x(S,O){return S.hasOwnProperty(O)?S[O]:""}function v(S,O=!1){return{name:r.LE,type:r.PU.time,config:{},values:S.map(M=>O?M[0]:M[0]*1e3)}}function P({data:S,valueName:O=r.Bc,parseValue:M=!0,labels:I,displayNameFromDS:L}){return{name:O,type:r.PU.number,display:(0,l.J)(),config:{displayNameFromDS:L},labels:I,values:S.map(B=>M?T(B[1]):B[1])}}function E(S){const O=S.__name__||"";delete S.__name__;const M=Object.entries(S).map(I=>`${I[0]}="${I[1]}"`).join(",");return`${O}{${M}}`}function D(S){if(S.length===0||S.length===1&&S[0].length===0)return[];const O=S[0].fields.find(I=>I.type===r.PU.time),M=S.map(I=>{let L=I.fields.find(B=>B.type===r.PU.number);return{...L,name:L.config.displayNameFromDS}});return[{...S[0],meta:{...S[0].meta,type:a.m.HeatmapRows},fields:[O,...M]}]}function C(S){for(let O=S.length-1;O>0;O--){const M=S[O].fields.find(L=>L.type===r.PU.number),I=S[O-1].fields.find(L=>L.type===r.PU.number);if(!M||!I)throw new Error("Prometheus heatmap transform error: data should be a time series");for(let L=0;L<M.values.length;L++){const B=I.values[L]||[0];M.values[L]-=B,M.values[L]<1e-9&&(M.values[L]=0)}}return S}function b(S,O){let M,I;try{M=T(S.fields[1].state?.displayName??S.name??S.fields[1].name),I=T(O.fields[1].state?.displayName??O.name??O.fields[1].name)}catch(L){return console.error(L),0}return M>I?1:M<I?-1:0}function T(S){return c.test(S)?S[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY:parseFloat(S)}},62183:(G,R,e)=>{"use strict";e.d(R,{B4:()=>a,N1:()=>n,fD:()=>t,m_:()=>s});var t=(r=>(r.Low="Low",r.Medium="Medium",r.High="High",r.None="None",r))(t||{}),n=(r=>(r.Cortex="Cortex",r.Mimir="Mimir",r.Prometheus="Prometheus",r.Thanos="Thanos",r))(n||{}),s=(r=>(r.Auto="__auto",r.Verbose="__verbose",r.Custom="__custom",r))(s||{}),a=(r=>(r[r.LabelNames=0]="LabelNames",r[r.LabelValues=1]="LabelValues",r[r.MetricNames=2]="MetricNames",r[r.VarQueryResult=3]="VarQueryResult",r[r.SeriesQuery=4]="SeriesQuery",r[r.ClassicQuery=5]="ClassicQuery",r))(a||{})},5261:(G,R,e)=>{"use strict";e.d(R,{L:()=>n,y:()=>s});var t=e(32264);function n(a){return{grafana_version:t.$.buildInfo.version,plugin_type:String(a.type),plugin_version:a.info.version,plugin_id:a.id,plugin_name:a.name}}function s(a){return{...n(a.meta),datasource_uid:a.uid}}},44027:(G,R,e)=>{"use strict";e.d(R,{G:()=>i});var t=e(96540),n=e(92470),s=e(95187),a=e(14110),r=e(5261);const g="grafana_plugin_";function i(){const d=(0,n.Q)();return(0,t.useMemo)(()=>{if(!d)throw new Error("No PluginContext found. The usePluginInteractionReporter() hook can only be used from a plugin.");const c=(0,s.S)(d)?(0,r.y)(d.instanceSettings):(0,r.L)(d.meta);return(h,o)=>{if(!l(h))throw new Error(`Interactions reported in plugins should start with: "${g}".`);return(0,a.rR)(h,{...o,...c})}},[d])}function l(d){return d.startsWith(g)&&d.length>g.length}},61298:(G,R,e)=>{"use strict";e.d(R,{fX:()=>s,nB:()=>n,n_:()=>t,p6:()=>a});var t=(r=>(r.DashboardView="dashboard-view",r.DataRequest="data-request",r))(t||{});const n=r=>!!r.payload.page,s=r=>!!r.payload.interactionName,a=r=>!!r.payload.experimentId},14110:(G,R,e)=>{"use strict";e.d(R,{G$:()=>a,Jy:()=>r,Xp:()=>i,rR:()=>g});var t=e(32264),n=e(39601),s=e(63415);const a=l=>{(0,s.x$)().addEvent({type:s.on.MetaAnalytics,payload:l})},r=()=>{const l=n.Ny.getLocation(),d=`${t.$.appSubUrl??""}${l.pathname}${l.search}${l.hash}`;(0,s.x$)().addEvent({type:s.on.Pageview,payload:{page:d}})},g=(l,d)=>{t.$.reportingStaticContext&&t.$.reportingStaticContext instanceof Object&&(d={...d,...t.$.reportingStaticContext}),(0,s.x$)().addEvent({type:s.on.Interaction,payload:{interactionName:l,properties:d}})},i=(l,d,c)=>{(0,s.x$)().addEvent({type:s.on.ExperimentView,payload:{experimentId:l,experimentGroup:d,experimentVariant:c}})}},55882:(G,R,e)=>{"use strict";e.d(R,{s:()=>h});var t=e(74848),n=e(96540),s=e(22391),a=e(51527),r=e(13544),g=e(90182),i=e(67061),l=e(98624),d=e(19347),c=e(26657);class h extends n.PureComponent{constructor(m){super(m),this.dataSourceSrv=(0,d.l)(),this.state={},this.onChange=(u,p)=>{if(p.action==="clear"&&this.props.onClear){this.props.onClear();return}const f=this.dataSourceSrv.getInstanceSettings(u.value);f&&(this.props.onChange(f),this.setState({error:void 0}))}}static{this.defaultProps={autoFocus:!1,openMenuOnFocus:!1,placeholder:"Select data source"}}componentDidMount(){const{current:m}=this.props;this.dataSourceSrv.getInstanceSettings(m)||this.setState({error:"Could not find data source "+m})}getCurrentValue(){const{current:m,hideTextValue:u,noDefault:p}=this.props;if(!m&&p)return;const f=this.dataSourceSrv.getInstanceSettings(m);if(f)return{label:f.name.slice(0,37),value:f.uid,imgUrl:f.meta.info.logos.small,hideText:u,meta:f.meta};const y=(0,s.Iz)(m);return y===c.dR.uid||y===c.dR.name?{label:y,value:y,hideText:u}:{label:(y??"no name")+" - not found",value:y??void 0,imgUrl:"",hideText:u}}getDataSourceOptions(){const{alerting:m,tracing:u,metrics:p,mixed:f,dashboard:y,variables:x,annotations:v,pluginId:P,type:E,filter:D,logs:C}=this.props;return this.dataSourceSrv.getList({alerting:m,tracing:u,metrics:p,logs:C,dashboard:y,mixed:f,variables:x,annotations:v,pluginId:P,filter:D,type:E}).map(T=>({value:T.name,label:`${T.name}${T.isDefault?" (default)":""}`,imgUrl:T.meta.info.logos.small,meta:T.meta}))}render(){const{autoFocus:m,onBlur:u,onClear:p,openMenuOnFocus:f,placeholder:y,width:x,inputId:v,disabled:P=!1,isLoading:E=!1}=this.props,{error:D}=this.state,C=this.getDataSourceOptions(),b=this.getCurrentValue(),T=typeof p=="function";return(0,t.jsx)("div",{"aria-label":"Data source picker select container","data-testid":r.Tp.components.DataSourcePicker.container,children:(0,t.jsx)(g.l6,{isLoading:E,disabled:P,"aria-label":"Select a data source","data-testid":r.Tp.components.DataSourcePicker.inputV2,inputId:v||"data-source-picker",className:"ds-picker select-container",isMulti:!1,isClearable:T,backspaceRemovesValue:!1,onChange:this.onChange,options:C,autoFocus:m,onBlur:u,width:x,openMenuOnFocus:f,maxMenuHeight:500,placeholder:y,noOptionsMessage:"No datasources found",value:b??null,invalid:!!D||!!this.props.invalid,getOptionLabel:S=>S.meta&&(0,a.x)(S.meta.signature)&&S!==b?(0,t.jsxs)(i.B,{alignItems:"center",justifyContent:"space-between",children:[(0,t.jsx)("span",{children:S.label})," ",(0,t.jsx)(l.B,{status:S.meta.signature})]}):S.label||""})})}}},96937:(G,R,e)=>{"use strict";e.d(R,{f:()=>t,p:()=>n});let t=()=>{throw new Error("EmbeddedDashboard requires runtime initialization")};function n(s){t=s}},97152:(G,R,e)=>{"use strict";e.d(R,{a:()=>n,e:()=>s});var t=e(74848);let n=({message:a})=>(0,t.jsxs)("div",{children:["Unable to render data: ",a,"."]});function s(a){n=a}},24308:(G,R,e)=>{"use strict";e.d(R,{Y:()=>s,m:()=>n});var t=e(74848);let n=()=>(0,t.jsx)("div",{children:"PanelRenderer can only be used after Grafana instance has been started."});function s(a){n=a}},46235:(G,R,e)=>{"use strict";e.d(R,{V:()=>n,l:()=>s});var t=e(74848);let n=({children:a})=>(0,t.jsx)("div",{children:a});function s(a){n=a}},7117:(G,R,e)=>{"use strict";e.r(R),e.d(R,{CopyPanelEvent:()=>c.ah,DataSourcePicker:()=>B.s,DataSourceWithBackend:()=>b.iy,EchoEventType:()=>r.on,EmbeddedDashboard:()=>U.f,FakeEchoSrv:()=>r.c_,GrafanaBootConfig:()=>x.p,HealthCheckError:()=>b.b1,HealthStatus:()=>b.VQ,HistoryWrapper:()=>d.K9,LocationServiceProvider:()=>d._K,MetaAnalyticsEventName:()=>v.n_,PanelDataErrorView:()=>O.a,PanelRenderer:()=>S.m,PluginPage:()=>L.V,RefreshEvent:()=>c._,StreamingFrameAction:()=>l.Kh,ThemeChangedEvent:()=>c.E8,TimeRangeUpdatedEvent:()=>c.sR,config:()=>x.$,createDataSourcePluginEventProperties:()=>j.y,createMonitoringLogger:()=>C.DW,createPluginEventProperties:()=>j.L,createQueryRunner:()=>I.d,featureEnabled:()=>D.a,frameToMetricFindValue:()=>T.$h,getAngularLoader:()=>n.E,getAppEvents:()=>c.J7,getBackendSrv:()=>t.AI,getDataSourceSrv:()=>s.l,getEchoSrv:()=>r.x$,getGrafanaLiveSrv:()=>l.oF,getLegacyAngularInjector:()=>i.C,getLocationSrv:()=>a.X,getPluginComponentExtensions:()=>h.Dp,getPluginExtensions:()=>h.O3,getPluginImportUtils:()=>P.o,getPluginLinkExtensions:()=>h.Kf,getRunRequest:()=>I.XJ,getTemplateSrv:()=>g.w,hasAllPermissions:()=>z,hasAnyPermission:()=>N,hasPermission:()=>V,hasPermissionInMetadata:()=>w,isExperimentViewEvent:()=>v.p6,isExpressionReference:()=>b.s9,isFetchError:()=>t.NF,isInteractionEvent:()=>v.fX,isPageviewEvent:()=>v.nB,isPluginExtensionComponent:()=>f.a,isPluginExtensionLink:()=>f.D,loadPluginCss:()=>P.PL,locationSearchToObject:()=>d.SE,locationService:()=>d.Ny,logDebug:()=>C.MD,logError:()=>C.vV,logInfo:()=>C.fH,logWarning:()=>C.FF,navigationLogger:()=>d.Lc,registerEchoBackend:()=>r.pl,reportExperimentView:()=>E.Xp,reportInteraction:()=>E.rR,reportMetaAnalytics:()=>E.G$,reportPageview:()=>E.Jy,setAngularLoader:()=>n.w,setAppEvents:()=>c.H8,setBackendSrv:()=>t.u5,setChromeHeaderHeightHook:()=>W._,setCurrentUser:()=>y.l,setDataSourceSrv:()=>s.h,setEchoSrv:()=>r.H2,setEmbeddedDashboard:()=>U.p,setGrafanaLiveSrv:()=>l.S8,setLegacyAngularInjector:()=>i.j,setLocationService:()=>d.vG,setLocationSrv:()=>a.T,setPluginComponentHook:()=>m.A,setPluginComponentsHook:()=>u.R,setPluginExtensionGetter:()=>h.cE,setPluginExtensionsHook:()=>o.Vu,setPluginImportUtils:()=>P.se,setPluginLinksHook:()=>p.q,setQueryRunnerFactory:()=>I.HC,setReturnToPreviousHook:()=>K._,setRunRequest:()=>I.pC,setTemplateSrv:()=>g.d,toDataQueryError:()=>M.u,toDataQueryResponse:()=>T.bE,useChromeHeaderHeight:()=>W.k,useLocationService:()=>d.at,usePluginComponent:()=>m.S,usePluginComponentExtensions:()=>o.kr,usePluginComponents:()=>u.f,usePluginExtensions:()=>o.pc,usePluginInteractionReporter:()=>A.G,usePluginLinkExtensions:()=>o.vl,usePluginLinks:()=>p.U,useReturnToPrevious:()=>K.i});var t=e(17172),n=e(7376),s=e(19347),a=e(23509),r=e(63415),g=e(72574),i=e(81634),l=e(78731),d=e(39601),c=e(3591),h=e(4402),o=e(3197),m=e(79396),u=e(7299),p=e(71798),f=e(80882),y=e(61706),x=e(32264),v=e(61298),P=e(89191),E=e(14110),D=e(33378),C=e(34867),b=e(26657),T=e(47773),S=e(24308),O=e(97152),M=e(12091),I=e(63639),L=e(46235),B=e(55882),j=e(5261),A=e(44027),K=e(14778),W=e(23172),U=e(96937),F=e(29263);const V=H=>(0,F.ZU)(H,(0,y.H)()),w=(H,Q)=>(0,F.T6)(H,Q),z=H=>(0,F.Fj)(H,(0,y.H)()),N=H=>(0,F.jW)(H,(0,y.H)())},7376:(G,R,e)=>{"use strict";e.d(R,{E:()=>s,w:()=>n});let t;function n(a){t=a}function s(){return t}},63415:(G,R,e)=>{"use strict";e.d(R,{H2:()=>s,c_:()=>g,on:()=>t,pl:()=>r,x$:()=>a});var t=(i=>(i.Performance="performance",i.MetaAnalytics="meta-analytics",i.Pageview="pageview",i.Interaction="interaction",i.ExperimentView="experimentview",i.GrafanaJavascriptAgent="grafana-javascript-agent",i))(t||{});let n;function s(i){if(n instanceof g)for(const l of n.buffer)i.addEvent(l.event,l.meta);n=i}function a(){return n||(n=new g),n}const r=i=>{a().addBackend(i)};class g{constructor(){this.buffer=[]}flush(){this.buffer=[]}addBackend(l){}addEvent(l,d){this.buffer.push({event:l,meta:d})}}},39601:(G,R,e)=>{"use strict";e.d(R,{K9:()=>d,Lc:()=>u,Ny:()=>h,SE:()=>c,_K:()=>y,at:()=>f,vG:()=>o});var t=e(74848),n=e(17929),s=e(96540),a=e(76885),r=e(95344),g=e(91040),i=e(40621),l=e(32264);class d{constructor(v){this.history=v||n.zR({basename:l.$.appSubUrl??"/"}),this.partial=this.partial.bind(this),this.push=this.push.bind(this),this.replace=this.replace.bind(this),this.getSearch=this.getSearch.bind(this),this.getHistory=this.getHistory.bind(this),this.getLocation=this.getLocation.bind(this)}getHistory(){return this.history}getSearch(){return new URLSearchParams(this.history.location.search)}partial(v,P){const E=this.history.location,D=this.getSearchObject();for(const b in v)v[b]===null||v[b]===void 0?delete D[b]:D[b]=v[b];const C=a.kM.renderUrl(E.pathname,D);P?this.history.replace(C,this.history.location.state):this.history.push(C,this.history.location.state)}push(v){this.history.push(v)}replace(v){this.history.replace(v)}reload(){const v=this.history.location.state?.routeReloadCounter;this.history.replace({...this.history.location,state:{routeReloadCounter:v?v+1:1}})}getLocation(){return this.history.location}getSearchObject(){return c(this.history.location.search)}update(v){if((0,r.l)("LocationSrv","update","partial, push or replace"),v.partial&&v.query)this.partial(v.query,v.partial);else{const P={pathname:v.path};v.query&&(P.search=a.kM.toUrlParams(v.query)),v.replace?this.replace(P):this.push(P)}}}function c(x){let v=typeof x=="number"?String(x):x;return v.length>0?v.startsWith("?")?a.kM.parseKeyValue(v.substring(1)):a.kM.parseKeyValue(v):{}}let h=new d;const o=x=>{throw new Error("locationService can be only overriden in test environment")},m=(0,g.h)("Router"),u=m.logger;(0,i.h)("location",h,m);const p=s.createContext(void 0);function f(){const x=(0,s.useContext)(p);if(!x)throw new Error("useLocationService must be used within a LocationServiceProvider");return x}const y=({service:x,children:v})=>(0,t.jsx)(p.Provider,{value:x,children:v})},23509:(G,R,e)=>{"use strict";e.d(R,{T:()=>n,X:()=>s});let t;function n(a){t=a}function s(){return t}},63639:(G,R,e)=>{"use strict";e.d(R,{HC:()=>n,XJ:()=>g,d:()=>s,pC:()=>r});let t;const n=i=>{if(t)throw new Error("Runner should only be set when Grafana is starting.");t=i},s=()=>{if(!t)throw new Error("`createQueryRunner` can only be used after Grafana instance has started.");return t()};let a;function r(i){if(a)throw new Error("runRequest function should only be set once, when Grafana is starting.");a=i}function g(){if(!a)throw new Error("getRunRequest can only be used after Grafana instance has started.");return a}},19347:(G,R,e)=>{"use strict";e.d(R,{h:()=>n,l:()=>s});let t;function n(a){t=a}function s(){return t}},81634:(G,R,e)=>{"use strict";e.d(R,{C:()=>s,j:()=>n});let t;const n=a=>{t=a},s=()=>t},78731:(G,R,e)=>{"use strict";e.d(R,{Kh:()=>t.Kh,S8:()=>s,oF:()=>a});var t=e(9631);let n;const s=r=>{n=r},a=()=>n},4402:(G,R,e)=>{"use strict";e.d(R,{Dp:()=>i,Kf:()=>g,O3:()=>r,cE:()=>s});var t=e(80882);let n;function s(l){if(n)throw new Error("setPluginExtensionGetter() function should only be called once, when Grafana is starting.");n=l}function a(){if(!n)throw new Error("getPluginExtensionGetter() can only be used after the Grafana instance has started.");return n}const r=l=>a()(l),g=l=>{const{extensions:d}=r(l);return{extensions:d.filter(t.D)}},i=l=>{const{extensions:d}=r(l);return{extensions:d.filter(t.a)}}},79396:(G,R,e)=>{"use strict";e.d(R,{A:()=>n,S:()=>s});let t;function n(a){if(t)throw new Error("setPluginComponentHook() function should only be called once, when Grafana is starting.");t=a}function s(a){if(!t)throw new Error("setPluginComponentHook(options) can only be used after the Grafana instance has started.");return t(a)}},7299:(G,R,e)=>{"use strict";e.d(R,{R:()=>n,f:()=>s});let t;function n(a){if(t)throw new Error("setPluginComponentsHook() function should only be called once, when Grafana is starting.");t=a}function s(a){if(!t)throw new Error("setPluginComponentsHook(options) can only be used after the Grafana instance has started.");return t(a)}},3197:(G,R,e)=>{"use strict";e.d(R,{Vu:()=>a,kr:()=>i,pc:()=>r,vl:()=>g});var t=e(96540),n=e(80882);let s;function a(l){if(s)throw new Error("setPluginExtensionsHook() function should only be called once, when Grafana is starting.");s=l}function r(l){if(!s)throw new Error("usePluginExtensions(options) can only be used after the Grafana instance has started.");return s(l)}function g(l){const{extensions:d,isLoading:c}=r(l);return(0,t.useMemo)(()=>({extensions:d.filter(n.D),isLoading:c}),[d,c])}function i(l){const{extensions:d,isLoading:c}=r(l);return(0,t.useMemo)(()=>({extensions:d.filter(n.a),isLoading:c}),[d,c])}},71798:(G,R,e)=>{"use strict";e.d(R,{U:()=>s,q:()=>n});let t;function n(a){if(t)throw new Error("setPluginLinksHook() function should only be called once, when Grafana is starting.");t=a}function s(a){if(!t)throw new Error("setPluginLinksHook(options) can only be used after the Grafana instance has started.");return t(a)}},80882:(G,R,e)=>{"use strict";e.d(R,{D:()=>n,a:()=>s});var t=e(74135);function n(a){return a?a.type===t.u.link&&("path"in a||"onClick"in a):!1}function s(a){return a?a.type===t.u.component&&"component"in a:!1}},72574:(G,R,e)=>{"use strict";e.d(R,{d:()=>n,w:()=>s});let t;const n=a=>{t=a},s=()=>t},61706:(G,R,e)=>{"use strict";e.d(R,{H:()=>s,l:()=>n});let t=null;function n(a){if(t)throw new Error("User should only be set once, when Grafana is starting.");t=a}function s(){if(!t)throw new Error("User can only be used after Grafana instance has started.");return t}},26657:(G,R,e)=>{"use strict";e.d(R,{iy:()=>C,dR:()=>x,b1:()=>P,VQ:()=>E,s9:()=>v,ph:()=>T,x7:()=>b});var t=e(62467),n=e(75505),s=e(44240),a=e(63720),r=e(66847),g=e(40187),i=e(22391),l=e(55004),d=e(89667),c=e(92341),h=e(32264),o=e(19347),m=e(78731),u=e(17172),p=e(9631),f=e(47773);function y(S){const{intervalMs:O,maxDataPoints:M,requestId:I,panelId:L,queryCachingTTL:B,range:{from:j,to:A}}=S;if(!S.targets.length)return(0,t.of)({data:[]});const K={intervalMs:O,maxDataPoints:M,queryCachingTTL:B,timeRange:{from:j.valueOf().toString(),to:A.valueOf().toString(),timezone:S.timezone}};return(0,u.AI)().fetch({url:`/api/public/dashboards/${h.$.publicDashboardAccessToken}/panels/${L}/query`,method:"POST",data:K,requestId:I}).pipe((0,a.n)(W=>(0,t.of)((0,f.bE)(W,S.targets))),(0,r.W)(W=>(0,t.of)((0,f.bE)(W))))}const x=Object.freeze({type:"__expr__",uid:"__expr__",name:"Expression"});function v(S){if(!S)return!1;const O=typeof S=="string"?S:S.type;return O===x.type||O===x.name||O==="-100"}class P extends Error{constructor(O,M){super(O),this.details=M,this.name="HealthCheckError"}}var E=(S=>(S.Unknown="UNKNOWN",S.OK="OK",S.Error="ERROR",S))(E||{}),D=(S=>(S.PluginID="X-Plugin-Id",S.DatasourceUID="X-Datasource-Uid",S.DashboardUID="X-Dashboard-Uid",S.PanelID="X-Panel-Id",S.PanelPluginId="X-Panel-Plugin-Id",S.QueryGroupID="X-Query-Group-Id",S.FromExpression="X-Grafana-From-Expr",S.SkipQueryCache="X-Cache-Skip",S))(D||{});class C extends g.mA{constructor(O){super(O),this.streamOptionsProvider=T}query(O){if(h.$.publicDashboardAccessToken)return y(O);const{intervalMs:M,maxDataPoints:I,queryCachingTTL:L,range:B,requestId:j,hideFromInspector:A=!1}=O;let K=O.targets,W=!1;const U=new Set,F=new Set,V=K.map(H=>{let Q=this.getRef(),X=this.id,ee=!0;if(v(H.datasource))return W=!0,{...H,datasource:x};if(H.datasource){const Z=(0,o.l)().getInstanceSettings(H.datasource,O.scopedVars);if(!Z)throw new Error(`Unknown Datasource: ${JSON.stringify(H.datasource)}`);const q=Z.rawRef??(0,i.p$)(Z),ae=Z.id;(q.uid!==Q.uid||X!==ae)&&(Q=q,X=ae,ee=!1)}return Q.type?.length&&U.add(Q.type),Q.uid?.length&&F.add(Q.uid),{...ee?this.applyTemplateVariables(H,O.scopedVars,O.filters):H,datasource:Q,datasourceId:X,intervalMs:M,maxDataPoints:I,queryCachingTTL:L}});if(!V.length)return(0,t.of)({data:[]});const w={queries:V,from:B?.from.valueOf().toString(),to:B?.to.valueOf().toString()};if(h.$.featureToggles.queryOverLive)return(0,m.oF)().getQueryData({request:O,body:w});const z=O.headers??{};z["X-Plugin-Id"]=Array.from(U).join(", "),z["X-Datasource-Uid"]=Array.from(F).join(", ");let N="/api/ds/query?ds_type="+this.type;return h.$.featureToggles.queryServiceFromUI&&(h.$.featureToggles.queryService||h.$.featureToggles.grafanaAPIServerWithExperimentalAPIs?(!W&&F.size,N=`/apis/query.grafana.app/v0alpha1/namespaces/${h.$.namespace}/query?ds_type=' + this.type`):console.warn("feature toggle queryServiceFromUI also requires the queryService to be running")),W&&(z["X-Grafana-From-Expr"]="true",N+="&expression=true"),j&&(N+=`&requestId=${j}`),O.dashboardUID&&(z["X-Dashboard-Uid"]=O.dashboardUID,O.panelId&&(z["X-Panel-Id"]=`${O.panelId}`)),O.panelPluginId&&(z["X-Panel-Plugin-Id"]=`${O.panelPluginId}`),O.queryGroupId&&(z["X-Query-Group-Id"]=`${O.queryGroupId}`),O.skipQueryCache&&(z["X-Cache-Skip"]="true"),(0,u.AI)().fetch({url:N,method:"POST",data:w,requestId:j,hideFromInspector:A,headers:z}).pipe((0,a.n)(H=>{const Q=(0,f.bE)(H,V);return Q.data?.length&&Q.data.find(X=>X.meta?.channel)?b(Q,O,this.streamOptionsProvider):(0,t.of)(Q)}),(0,r.W)(H=>(0,t.of)((0,f.bE)(H))))}getRequestHeaders(){const O={};return O["X-Plugin-Id"]=this.type,O["X-Datasource-Uid"]=this.uid,O}interpolateVariablesInQueries(O,M,I){return O.map(L=>this.applyTemplateVariables(L,M,I))}applyTemplateVariables(O,M,I){return O}async getResource(O,M,I){const L=this.getRequestHeaders();return(await(0,n.s)((0,u.AI)().fetch({...I,method:"GET",headers:I?.headers?{...I.headers,...L}:L,params:M??I?.params,url:`/api/datasources/uid/${this.uid}/resources/${O}`}))).data}async postResource(O,M,I){const L=this.getRequestHeaders();return(await(0,n.s)((0,u.AI)().fetch({...I,method:"POST",headers:I?.headers?{...I.headers,...L}:L,data:M??{...M},url:`/api/datasources/uid/${this.uid}/resources/${O}`}))).data}async callHealthCheck(){return(0,n.s)((0,u.AI)().fetch({method:"GET",url:`/api/datasources/uid/${this.uid}/health`,showErrorAlert:!1,headers:this.getRequestHeaders()})).then(O=>O.data).catch(O=>O.data)}async testDatasource(){return this.callHealthCheck().then(O=>O.status==="OK"?{status:"success",message:O.message}:Promise.reject({status:"error",message:O.message,error:new P(O.message,O.details)}))}}function b(S,O,M){const I=(0,m.oF)();if(!I)return(0,t.of)(S);const L=[],B=[];for(const j of S.data){const A=(0,l.DG)(j.meta?.channel);if(A){const K=j;B.push(I.getDataStream({addr:A,buffer:M(O,K),frame:(0,d.Nw)(j)}))}else L.push(j)}return L.length&&B.push((0,t.of)({...S,data:L})),B.length===1?B[0]:(0,s.h)(...B)}const T=(S,O)=>{const M={maxLength:S.maxDataPoints??500,action:p.Kh.Append};return S.rangeRaw?.to==="now"&&(M.maxDelta=S.range.to.valueOf()-S.range.from.valueOf()),M};C=(0,c.Y)(C)},23172:(G,R,e)=>{"use strict";e.d(R,{_:()=>n,k:()=>s});let t;const n=a=>{t=a},s=()=>(t||console.error("useChromeHeaderHeight hook not found"),t?.())},34867:(G,R,e)=>{"use strict";e.d(R,{DW:()=>d,FF:()=>r,MD:()=>g,fH:()=>a,l$:()=>l,vV:()=>i});var t=e(32631),n=e(37930),s=e(32264);function a(c,h){s.$.grafanaJavascriptAgent.enabled&&t.P.api.pushLog([c],{level:n.$b.INFO,context:h})}function r(c,h){s.$.grafanaJavascriptAgent.enabled&&t.P.api.pushLog([c],{level:n.$b.WARN,context:h})}function g(c,h){s.$.grafanaJavascriptAgent.enabled&&t.P.api.pushLog([c],{level:n.$b.DEBUG,context:h})}function i(c,h){s.$.grafanaJavascriptAgent.enabled&&t.P.api.pushError(c,{context:h})}function l(c,h,o){s.$.grafanaJavascriptAgent.enabled&&t.P.api.pushMeasurement({type:c,values:h,context:o})}function d(c,h){const o=m=>({source:c,...h,...m});return{logDebug:(m,u)=>g(m,o(u)),logInfo:(m,u)=>a(m,o(u)),logWarning:(m,u)=>r(m,o(u)),logError:(m,u)=>i(m,o(u)),logMeasurement:(m,u,p)=>l(m,u,o(p))}}},89191:(G,R,e)=>{"use strict";e.d(R,{PL:()=>n,o:()=>r,se:()=>a});var t=e(32264);async function n(g){try{const i=t.$.bootData.user.theme==="light"?g.light:g.dark;return window.System.import(i)}catch(i){console.error(i)}}let s;function a(g){if(s)throw new Error("pluginImportUtils should only be set once, when Grafana is starting.");s=g}function r(){if(!s)throw new Error("pluginImportUtils can only be used after Grafana instance has started.");return s}},47773:(G,R,e)=>{"use strict";e.d(R,{$h:()=>h,bE:()=>i});var t=e(39070),n=e(89667),s=e(14236),a=e(11261),r=e(12091);const g={severity:"info",text:"Cached response"};function i(o,m){const u={data:[],state:t.Gu.Done},p="traceId"in o?o.traceId:void 0;p!=null&&(u.traceIds=[p]);const f=o;if(f.data?.results){const y=f.data.results,x=m?.length?m.map(E=>E.refId):Object.keys(y),v=l(f),P=[];for(const E of x){const D=y[E];D&&(D.refId=E,P.push(D))}for(const E of P){if(E.error){const D={refId:E.refId,message:E.error,status:E.status};p!=null&&(D.traceId=p),u.error||(u.error={...D}),u.errors?u.errors.push({...D}):u.errors=[{...D}],u.state=t.Gu.Error}if(E.frames?.length){for(let D of E.frames){v&&(D=d(D));const C=(0,n.or)(D);C.refId||(C.refId=E.refId),u.data.push(C)}continue}if(E.series?.length)for(const D of E.series)D.refId||(D.refId=E.refId),u.data.push((0,s.Vc)(D));if(E.tables?.length)for(const D of E.tables)D.refId||(D.refId=E.refId),u.data.push((0,s.Vc)(D))}}return f.status&&f.status!==200&&(u.state!==t.Gu.Error&&(u.state=t.Gu.Error),u.error||(u.error=(0,r.u)(o))),u}function l(o){const m=o?.headers;return!m||!m.get?!1:m.get("X-Cache")==="HIT"}function d(o){return{...o,schema:{...o.schema,fields:[...o.schema?.fields??[]],meta:{...o.schema?.meta,notices:[...o.schema?.meta?.notices??[],g],isCachedResponse:!0}}}}function c(o){const m=i(o);if(m.error?.data?.message)return{status:"error",message:m.error.data.message,details:m.error?.data?.error?{message:m.error.data.error}:void 0};if(m.error?.refId&&m.error?.message)return{status:"error",message:m.error.message};throw o}function h(o){if(!o||!o.length)return[];const m=[];let u=o.fields.find(p=>p.type===a.PU.string);if(u||(u=o.fields.find(p=>p.type!==a.PU.time)),u)for(let p=0;p<u.values.length;p++)m.push({text:""+u.values[p]});return m}},14778:(G,R,e)=>{"use strict";e.d(R,{_:()=>n,i:()=>s});let t;const n=a=>{t=a},s=()=>t?t():()=>console.error("ReturnToPrevious hook not found")},33623:(G,R,e)=>{"use strict";e.d(R,{KQ:()=>s,QB:()=>a});var t=e(52622);const n="11.3.0-pre",s={barRadius:0,barWidth:.97,fullHighlight:!1,groupWidth:.7,orientation:t.wV.Auto,showValue:t.yL.Auto,stacking:t.gs.None,xTickLabelRotation:0,xTickLabelSpacing:0},a={fillOpacity:80,gradientMode:t.on.None,lineWidth:1}},16371:(G,R,e)=>{"use strict";e.d(R,{K:()=>s});var t=e(52622);const n="11.3.0-pre",s={displayMode:t.eX.Gradient,maxVizHeight:300,minVizHeight:16,minVizWidth:8,namePlacement:t.TZ.Auto,showUnfilled:!0,sizing:t.T6.Auto,valueMode:t.$l.Color}},37827:(G,R,e)=>{"use strict";e.d(R,{K:()=>n});const t="11.3.0-pre",n={selectedSeries:0}},44955:(G,R,e)=>{"use strict";e.d(R,{K:()=>s});var t=e(52622);const n="11.3.0-pre",s={minVizHeight:75,minVizWidth:75,showThresholdLabels:!1,showThresholdMarkers:!0,sizing:t.T6.Auto}},87487:(G,R,e)=>{"use strict";e.d(R,{KQ:()=>n});const t="11.3.0-pre",n={layers:[]},s={allLayers:!0,id:"zero",lat:0,lon:0,zoom:1};var a=(g=>(g.Details="details",g.None="none",g))(a||{}),r=(g=>(g.Coords="coords",g.Fit="fit",g.Zero="zero",g))(r||{})},96529:(G,R,e)=>{"use strict";e.d(R,{KQ:()=>g});var t=e(52622);const n="11.3.0-pre";var s=(i=>(i.Opacity="opacity",i.Scheme="scheme",i))(s||{}),a=(i=>(i.Exponential="exponential",i.Linear="linear",i))(a||{}),r=(i=>(i.X="x",i.Xy="xy",i.Y="y",i))(r||{});const g={calculate:!1,cellGap:1,cellValues:{},color:{scheme:"Oranges",fill:"dark-orange",reverse:!1,exponent:.5,steps:64},exemplars:{color:"rgba(255,0,255,0.7)"},filterValues:{le:1e-9},legend:{show:!0},selectionMode:"x",showValue:t.yL.Auto,tooltip:{mode:t.$N.Single,yHistogram:!1,showColorScale:!1}}},42226:(G,R,e)=>{"use strict";e.d(R,{KQ:()=>s,QB:()=>a});var t=e(52622);const n="11.3.0-pre",s={bucketCount:30,bucketOffset:0},a={fillOpacity:80,gradientMode:t.on.None,lineWidth:1}},69383:(G,R,e)=>{"use strict";e.d(R,{K:()=>n});const t="11.3.0-pre",n={showImage:!0}},65391:(G,R,e)=>{"use strict";e.d(R,{KQ:()=>g});const t="11.3.0-pre";var n=(i=>(i.Donut="donut",i.Pie="pie",i))(n||{}),s=(i=>(i.Name="name",i.Percent="percent",i.Value="value",i))(s||{}),a=(i=>(i.Percent="percent",i.Value="value",i))(a||{});const r={values:[]},g={displayLabels:[]}},89607:(G,R,e)=>{"use strict";e.d(R,{K:()=>s});var t=e(52622);const n="11.3.0-pre",s={colorMode:t.yp.Value,graphMode:t.$p.Area,justifyMode:t.F8.Auto,percentChangeColorMode:t.CD.Standard,showPercentChange:!1,textMode:t.SV.Auto,wideLayout:!0}},15821:(G,R,e)=>{"use strict";e.d(R,{KQ:()=>s,QB:()=>a});var t=e(52622);const n="11.3.0-pre",s={alignValue:"left",mergeValues:!0,perPage:20,rowHeight:.9,showValue:t.yL.Auto},a={fillOpacity:70,lineWidth:0}},64337:(G,R,e)=>{"use strict";e.d(R,{KQ:()=>s,QB:()=>a});var t=e(52622);const n="11.3.0-pre",s={colWidth:.9,rowHeight:.9,showValue:t.yL.Auto},a={fillOpacity:70,lineWidth:1}},52037:(G,R,e)=>{"use strict";e.d(R,{K:()=>s});var t=e(52622);const n="11.3.0-pre",s={cellHeight:t.qM.Sm,footer:{show:!1,countRows:!1,reducer:[]},frameIndex:0,showHeader:!0,showTypeIcons:!1,sortBy:[]}},12183:(G,R,e)=>{"use strict";e.d(R,{KQ:()=>g});const t="11.3.0-pre";var n=(i=>(i.Code="code",i.HTML="html",i.Markdown="markdown",i))(n||{}),s=(i=>(i.Go="go",i.Html="html",i.Json="json",i.Markdown="markdown",i.Plaintext="plaintext",i.Sql="sql",i.Typescript="typescript",i.Xml="xml",i.Yaml="yaml",i))(s||{});const a="plaintext",r={language:"plaintext",showLineNumbers:!1,showMiniMap:!1},g={content:`# Title

For markdown syntax help: [commonmark.org/help](https://commonmark.org/help/)`,mode:"markdown"}},10055:(G,R,e)=>{"use strict";e.d(R,{KQ:()=>i,QB:()=>g});var t=e(52622);const n="11.3.0-pre";var s=(l=>(l.Auto="auto",l.Manual="manual",l))(s||{}),a=(l=>(l.Lines="lines",l.Points="points",l.PointsAndLines="points+lines",l))(a||{});const r={exclude:[]},g={label:t.yL.Auto,show:"points"},i={series:[]}},73134:(G,R,e)=>{"use strict";e.d(R,{CO:()=>g,GW:()=>C,OA:()=>v,Ol:()=>o,QB:()=>D,Yb:()=>c,Ye:()=>b,ZG:()=>l,aD:()=>s,bf:()=>a,bt:()=>P,dM:()=>u,lt:()=>f,rw:()=>r,ss:()=>E,yV:()=>y});const t={tags:[]},n={exclude:!1,ids:[]},s={list:[]},a={builtIn:0,enable:!0,hide:!1},r={includeAll:!1,multi:!1,options:[],skipUrlSync:!1};var g=(T=>(T[T.never=0]="never",T[T.onDashboardLoad=1]="onDashboardLoad",T[T.onTimeRangeChanged=2]="onTimeRangeChanged",T))(g||{}),i=(T=>(T[T.dontHide=0]="dontHide",T[T.hideLabel=1]="hideLabel",T[T.hideVariable=2]="hideVariable",T))(i||{}),l=(T=>(T[T.alphabeticalAsc=1]="alphabeticalAsc",T[T.alphabeticalCaseInsensitiveAsc=5]="alphabeticalCaseInsensitiveAsc",T[T.alphabeticalCaseInsensitiveDesc=6]="alphabeticalCaseInsensitiveDesc",T[T.alphabeticalDesc=2]="alphabeticalDesc",T[T.disabled=0]="disabled",T[T.naturalAsc=7]="naturalAsc",T[T.naturalDesc=8]="naturalDesc",T[T.numericalAsc=3]="numericalAsc",T[T.numericalDesc=4]="numericalDesc",T))(l||{});const d={asDropdown:!1,includeVars:!1,keepTime:!1,tags:[],targetBlank:!1};var c=(T=>(T.ContinuousBlPu="continuous-BlPu",T.ContinuousBlYlRd="continuous-BlYlRd",T.ContinuousBlues="continuous-blues",T.ContinuousGrYlRd="continuous-GrYlRd",T.ContinuousGreens="continuous-greens",T.ContinuousPurples="continuous-purples",T.ContinuousRdYlGr="continuous-RdYlGr",T.ContinuousReds="continuous-reds",T.ContinuousYlBl="continuous-YlBl",T.ContinuousYlRd="continuous-YlRd",T.Fixed="fixed",T.PaletteClassic="palette-classic",T.PaletteClassicByName="palette-classic-by-name",T.Shades="shades",T.Thresholds="thresholds",T))(c||{});const h={h:9,w:12,x:0,y:0};var o=(T=>(T.Absolute="absolute",T.Percentage="percentage",T))(o||{});const m={steps:[]};var u=(T=>(T.RangeToText="range",T.RegexToText="regex",T.SpecialValue="special",T.ValueToText="value",T))(u||{}),p=(T=>(T.Empty="empty",T.False="false",T.NaN="nan",T.Null="null",T.NullAndNan="null+nan",T.True="true",T))(p||{});const f={hidden:!1,refresh_intervals:["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],time_options:["5m","15m","1h","6h","12h","24h","2d","7d","30d"]};var y=(T=>(T[T.Crosshair=1]="Crosshair",T[T.Off=0]="Off",T[T.Tooltip=2]="Tooltip",T))(y||{});const x=0,v={links:[],repeatDirection:"h",targets:[],transformations:[],transparent:!1},P={overrides:[]},E={id:""},D={links:[],mappings:[]},C={collapsed:!1,panels:[]},b={editable:!0,fiscalYearStartMonth:0,graphTooltip:0,links:[],panels:[],schemaVersion:39,tags:[],timezone:"browser"}},39651:(G,R,e)=>{"use strict";e.d(R,{Gu:()=>s,gB:()=>n});var t=e(52622);const n={align:"auto",inspect:!1,cellOptions:{type:t.ob.Auto}};var s=(a=>(a.NotStarted="NotStarted",a.Loading="Loading",a.Streaming="Streaming",a.Done="Done",a.Error="Error",a))(s||{})},79422:(G,R,e)=>{"use strict";e.d(R,{Ye:()=>s,lt:()=>r,rw:()=>a,zL:()=>n});var t=e(73134),n=(m=>(m[m.dontHide=0]="dontHide",m[m.hideLabel=1]="hideLabel",m[m.hideVariable=2]="hideVariable",m))(n||{});const s=t.Ye,a={...t.rw},r=t.lt,g=t.OA,i=t.GW,l=t.QB,d=t.bt,c=t.ss,h=t.bf,o=t.aD},11807:(G,R,e)=>{"use strict";e.d(R,{l:()=>c});var t=e(74848),n=e(32196),s=e(73287),a=e(14110),r=e(40845),g=e(29158),i=e(88575),l=e(32372),d=e(94471);function c({rawSql:o,datasourceType:m}){const[u,p]=(0,s.A)(),f=(0,r.of)(h),y=v=>{p(v),(0,a.rR)("grafana_sql_preview_copied",{datasource:m})},x=(0,t.jsxs)("div",{className:f.labelWrapper,children:[(0,t.jsx)("span",{className:f.label,children:"Preview"}),(0,t.jsx)(g.K,{tooltip:"Copy to clipboard",onClick:()=>y(o),name:"copy"})]});return(0,t.jsx)(i.D,{label:x,className:f.grow,children:(0,t.jsx)(l.B,{language:"sql",height:80,value:(0,d.s)(o),monacoOptions:{scrollbar:{vertical:"hidden"},scrollBeyondLastLine:!1},readOnly:!0,showMiniMap:!1})})}function h(o){return{grow:(0,n.css)({flexGrow:1}),label:(0,n.css)({fontSize:12,fontWeight:o.typography.fontWeightMedium}),labelWrapper:(0,n.css)({display:"flex",justifyContent:"space-between",paddingBottom:o.spacing(.5)})}}},94471:(G,R,e)=>{"use strict";e.d(R,{s:()=>n});var t=e(27633);function n(s){return t.Ay.format(s).replace(/(\$ \{ .* \})|(\$ __)|(\$ \w+)/g,a=>a.replace(/\s/g,""))}},42418:(G,R,e)=>{"use strict";e.d(R,{F:()=>c});var t=e(74848),n=e(32196),s=e(96540),a=e(13544),r=e(40845),g=e(55852),i=e(14578),l=e(90613),d=e(94753);const c=s.forwardRef(({title:m,onRemove:u,children:p,buttonContent:f,elevated:y,bottomSpacing:x,topSpacing:v,className:P,severity:E="error",...D},C)=>{const b=(0,r.$j)(),S=o(b,E,!!m,y,x,v),O={error:"alert",warning:"alert",info:"status",success:"status"},M=D.role||O[E],I=D["aria-label"]||m;return(0,t.jsx)("div",{ref:C,className:(0,n.cx)(S.wrapper,P),role:M,"aria-label":I,...D,children:(0,t.jsxs)(l.a,{"data-testid":a.Tp.components.Alert.alertV2(E),display:"flex",backgroundColor:E,borderRadius:"default",paddingY:1,paddingX:2,borderStyle:"solid",borderColor:E,alignItems:"stretch",boxShadow:y?"z3":void 0,children:[(0,t.jsx)(l.a,{paddingTop:1,paddingRight:2,children:(0,t.jsx)("div",{className:S.icon,children:(0,t.jsx)(i.I,{size:"xl",name:h(E)})})}),(0,t.jsxs)(l.a,{paddingY:1,grow:1,children:[(0,t.jsx)(d.E,{color:"primary",weight:"medium",children:m}),p&&(0,t.jsx)("div",{className:S.content,children:p})]}),u&&!f&&(0,t.jsx)("div",{className:S.close,children:(0,t.jsx)(g.$n,{"aria-label":"Close alert",icon:"times",onClick:u,type:"button",fill:"text",variant:"secondary"})}),u&&f&&(0,t.jsx)(l.a,{marginLeft:1,display:"flex",alignItems:"center",children:(0,t.jsx)(g.$n,{"aria-label":"Close alert",variant:"secondary",onClick:u,type:"button",children:f})})]})})});c.displayName="Alert";const h=m=>{switch(m){case"error":return"exclamation-circle";case"warning":return"exclamation-triangle";case"info":return"info-circle";case"success":return"check"}},o=(m,u,p,f,y,x)=>{const v=m.colors[u];return{wrapper:(0,n.css)({flexGrow:1,marginBottom:m.spacing(y??2),marginTop:m.spacing(x??0),position:"relative","&:before":{content:'""',position:"absolute",top:0,left:0,bottom:0,right:0,background:m.colors.background.primary,zIndex:-1}}),icon:(0,n.css)({color:v.text,position:"relative",top:"-1px"}),content:(0,n.css)({color:m.colors.text.primary,paddingTop:p?m.spacing(.5):0,maxHeight:"50vh",overflowY:"auto"}),close:(0,n.css)({position:"relative",color:m.colors.text.secondary,background:"none",display:"flex",top:"-6px",right:"-14px"})}}},39938:(G,R,e)=>{"use strict";e.d(R,{E:()=>o});var t=e(74848),n=e(32196),s=e(96540),a=e(70255),r=e(84140),g=e(40845),i=e(72129),l=e(14578),d=e(56034);const c=s.memo(({icon:p,color:f,text:y,tooltip:x,className:v,...P})=>{const E=(0,g.of)(u,f),D=(0,t.jsxs)("div",{className:(0,n.cx)(E.wrapper,v),...P,children:[p&&(0,t.jsx)(l.I,{name:p,size:"sm"}),y]});return x?(0,t.jsx)(d.m,{content:x,placement:"auto",children:D}):D});c.displayName="Badge";const h=({rootProps:p})=>{const f=(0,g.of)(m);return(0,t.jsx)(a.A,{width:60,height:22,containerClassName:f.container,...p})},o=(0,i.j)(c,h),m=()=>({container:(0,n.css)({lineHeight:1})}),u=(p,f)=>{let y=p.visualization.getColorByName(f),x="",v="",P="";return p.isDark?(v=(0,r.A)(y).setAlpha(.15).toString(),x=(0,r.A)(y).setAlpha(.25).toString(),P=(0,r.A)(y).lighten(15).toString()):(v=(0,r.A)(y).setAlpha(.15).toString(),x=(0,r.A)(y).setAlpha(.25).toString(),P=(0,r.A)(y).darken(20).toString()),{wrapper:(0,n.css)({display:"inline-flex",padding:"1px 4px",borderRadius:p.shape.radius.default,background:v,border:`1px solid ${x}`,color:P,fontWeight:p.typography.fontWeightRegular,gap:"2px",fontSize:p.typography.bodySmall.fontSize,lineHeight:p.typography.bodySmall.lineHeight,alignItems:"center"})}}},97696:(G,R,e)=>{"use strict";e.d(R,{xE:()=>D});var t=e(74848),n=e(32196),s=e(96540),a=e(84140),r=e(47070),g=e(50082),i=e(58649),l=e(83195),d=e(24293),c=e(8066),h=e(13544),o=e(52622),m=e(29413),u=e(55852),p=e(9286);const f=18,y=50,x=150,v=1.5,P=1,E=10;class D extends s.PureComponent{static{this.defaultProps={lcdCellWidth:12,value:{text:"100",numeric:100},displayMode:o.eX.Gradient,orientation:r.wV.Horizontal,field:{min:0,max:100,thresholds:{mode:g.O.Absolute,steps:[]}},itemSpacing:8,showUnfilled:!0}}render(){const{onClick:K,className:W,theme:U}=this.props,{title:F}=this.props.value,V=T(this.props);return K?(0,t.jsxs)("button",{type:"button",style:V.wrapper,onClick:K,className:(0,n.cx)((0,u.my)(U),W),children:[(0,t.jsx)("div",{style:V.title,children:F}),this.renderBarAndValue()]}):(0,t.jsxs)("div",{style:V.wrapper,className:W,children:[F&&(0,t.jsx)("div",{style:V.title,children:F}),this.renderBarAndValue()]})}renderBarAndValue(){switch(this.props.displayMode){case"lcd":return this.renderRetroBars();case"basic":case"gradient":default:return this.renderBasicAndGradientBars()}}renderBasicAndGradientBars(){const{value:K,showUnfilled:W,valueDisplayMode:U}=this.props,F=I(this.props);return(0,t.jsxs)("div",{style:F.wrapper,children:[U!==o.$l.Hidden&&(0,t.jsx)(p.i,{"data-testid":h.Tp.components.Panels.Visualization.BarGauge.valueV2,value:K,style:F.value}),W&&(0,t.jsx)("div",{style:F.emptyBar}),(0,t.jsx)("div",{style:F.bar})]})}renderRetroBars(){const{display:K,field:W,value:U,itemSpacing:F,alignmentFactors:V,orientation:w,lcdCellWidth:z,text:N,valueDisplayMode:H,theme:Q}=this.props,{valueHeight:X,valueWidth:ee,maxBarHeight:Z,maxBarWidth:q,wrapperWidth:ae,wrapperHeight:k}=S(this.props),se=W.min??i.tw,te=W.max??i.d1,ne=C(w),le=te-se,re=ne?Z:q,de=F,oe=Math.floor(re/z),J=Math.floor((re-de*oe)/oe),ce=B(this.props),xe=j(V||U,ce,ee,X,w,N),fe={width:`${ae}px`,height:`${k}px`,display:"flex"};ne?(fe.flexDirection="column-reverse",fe.alignItems="center"):(fe.flexDirection="row",fe.alignItems="center",xe.justifyContent="flex-end");const Ee=[];for(let Se=0;Se<oe;Se++){const ye=se+le/oe*Se,Ve=O(ye,U,K),Me={borderRadius:Q.shape.radius.default};Ve.isLit?Me.backgroundImage=`radial-gradient(${Ve.background} 10%, ${Ve.backgroundShade})`:Me.backgroundColor=Ve.background,ne?(Me.height=`${J}px`,Me.width=`${q}px`,Me.marginTop=`${de}px`):(Me.width=`${J}px`,Me.height=`${Z}px`,Me.marginRight=`${de}px`),Ee.push((0,t.jsx)("div",{style:Me},Se.toString()))}return(0,t.jsxs)("div",{style:fe,children:[Ee,H!==o.$l.Hidden&&(0,t.jsx)(p.i,{"data-testid":h.Tp.components.Panels.Visualization.BarGauge.valueV2,value:U,style:xe})]})}}function C(A){return A===r.wV.Vertical}function b(A){const{height:K,width:W,alignmentFactors:U,orientation:F,text:V,namePlacement:w}=A,z=U?U.title:A.value.title;if(!z)return{fontSize:0,width:0,height:0,placement:"above"};if(w===o.TZ.Hidden)return{fontSize:0,width:0,height:0,placement:o.TZ.Hidden};if(C(F)){const q=V?.titleSize??14;return{fontSize:q,width:W,height:q*v,placement:"below"}}if(K>40&&w===o.TZ.Auto||w===o.TZ.Top){if(V?.titleSize)return{fontSize:V?.titleSize,width:0,height:V.titleSize*v,placement:"above"};const ae=Math.max(Math.min(K*.45,y),17);return{fontSize:ae/v,width:0,height:ae,placement:"above"}}const X=Math.max(K*.6,f)/v,ee=(0,m.kD)(z,X),Z=Math.min(ee.width+15,W*.4);return{fontSize:V?.titleSize??X,height:0,width:Z,placement:"left"}}function T(A){const K={display:"flex",overflow:"hidden",width:"100%"},W=b(A),U={fontSize:`${W.fontSize}px`,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",width:"100%",alignItems:"center",alignSelf:"center"};return W.placement==="hidden"?U.display="none":C(A.orientation)?(K.flexDirection="column-reverse",U.textAlign="center"):W.placement==="above"?K.flexDirection="column":(K.flexDirection="row",U.width=`${W.width}px`,U.textAlign="right",U.paddingRight="10px"),{wrapper:K,title:U}}function S(A){const{height:K,width:W,orientation:U,text:F,alignmentFactors:V,valueDisplayMode:w}=A,z=b(A),N=V??A.value,H=(0,l.cN)(N);let Q=0,X=0,ee=0,Z=0,q=0,ae=0;const k=F?.valueSize??Math.max(z.fontSize,12),te=(0,m.kD)(H,k).width+E*2;return C(U)?(F?.valueSize?ee=F.valueSize*P:ee=Math.min(Math.max(K*.1,f),y),Z=W,w===o.$l.Hidden&&(ee=0,Z=0),Q=K-(z.height+ee),X=W,q=W,ae=K-z.height):(w===o.$l.Hidden?(ee=0,Z=0):(ee=K-z.height,Z=Math.max(Math.min(W*.2,x),te)),Q=K-z.height,X=W-Z-z.width,z.placement==="above"?(q=W,ae=K-z.height):(q=W-z.width,ae=K)),{valueWidth:Z,valueHeight:ee,maxBarWidth:X,maxBarHeight:Q,wrapperHeight:ae,wrapperWidth:q}}function O(A,K,W){if(A===null)return{background:d.F,border:d.F};const U=W?W(A).color:null;return U?K===null||isNaN(K.numeric)||A!==null&&A>K.numeric?{background:(0,a.A)(U).setAlpha(.18).toRgbString(),border:"transparent",isLit:!1}:{background:(0,a.A)(U).setAlpha(.95).toRgbString(),backgroundShade:(0,a.A)(U).setAlpha(.55).toRgbString(),border:(0,a.A)(U).setAlpha(.9).toRgbString(),isLit:!0}:{background:d.F,border:d.F}}function M(A,K,W){const U=Math.min((A-K)/(W-K),1);return isNaN(U)?0:U}function I(A){const{displayMode:K,field:W,value:U,alignmentFactors:F,orientation:V,theme:w,text:z}=A,{valueWidth:N,valueHeight:H,maxBarHeight:Q,maxBarWidth:X}=S(A),ee=W.min??i.tw,Z=W.max??i.d1,q=M(U.numeric,ee,Z),ae=B(A),k=U.color??d.F,te=j(F||U,ae,N,H,V,z),ne=K==="basic",le={display:"flex",flexGrow:1},re={borderRadius:w.shape.radius.default,position:"relative",zIndex:1},de={background:w.colors.background.secondary,flexGrow:1,display:"flex",borderRadius:w.shape.radius.default,position:"relative"};if(C(V)){const oe=Math.max(q*Q,1);le.flexDirection="column",le.justifyContent="flex-end",re.transition="height 1s",re.height=`${oe}px`,re.width=`${X}px`,de.bottom="-3px",de.width=`${N}px`,ne?(re.background=`${(0,a.A)(k).setAlpha(.35).toRgbString()}`,re.borderTop=`2px solid ${k}`):re.background=L(A,Q)}else{const oe=Math.max(q*X,1);le.flexDirection="row-reverse",le.justifyContent="flex-end",le.alignItems="stretch",re.transition="width 1s",re.height=`${Q}px`,re.width=`${oe}px`,de.left="-3px",de.height=`${H}px`,ne?(re.background=`${(0,a.A)(k).setAlpha(.35).toRgbString()}`,re.borderRight=`2px solid ${k}`):re.background=L(A,X)}return{wrapper:le,bar:re,value:te,emptyBar:de}}function L(A,K){const{field:W,value:U,orientation:F,theme:V}=A,w=C(F)?"0deg":"90deg",z=W.min,N=W.max;let H="",Q=0,X=(0,c.Hs)(W.color?.mode);if(X.id===d.Y.Thresholds){const ee=W.thresholds;for(let Z=0;Z<ee.steps.length;Z++){const q=ee.steps[Z],ae=A.theme.visualization.getColorByName(q.color),k=ee.mode===g.O.Percentage?q.value/100:M(q.value,z,N),se=k*K,te=Math.round(se-(se-Q)/2),ne=ee.mode===g.O.Percentage?z+(N-z)*k:q.value;if(H==="")H=`linear-gradient(${w}, ${ae}, ${ae}`;else{if(U.numeric<ne)break;Q=se,H+=` ${te}px, ${ae}`}}return H+")"}if(X.isContinuous&&X.getColors){const ee=X.getColors(V);for(let Z=0;Z<ee.length;Z++){const q=ee[Z];if(H==="")H=`linear-gradient(${w}, ${q} 0px`;else{const k=Z/(ee.length-1)*K;H+=`, ${q} ${k}px`}}return H+")"}return U.color??d.F}function B(A){if(A.valueDisplayMode==="text")return A.theme.colors.text.primary;const{value:K}=A;return K.color?K.color:d.F}function j(A,K,W,U,F,V){const w={color:K,height:`${U}px`,width:`${W}px`,display:"flex",alignItems:"center",textWrap:"nowrap",lineHeight:P};let z=W;const N=(0,l.cN)(A);return C(F)?(w.fontSize=V?.valueSize??(0,m.Vr)(N,z,U,P),w.justifyContent="center"):(w.fontSize=V?.valueSize??(0,m.Vr)(N,z-E*2,U,P),w.justifyContent="flex-end",w.paddingLeft=`${E}px`,w.paddingRight=`${E}px`,z-=E),w}},37494:(G,R,e)=>{"use strict";e.d(R,{yV:()=>j,yp:()=>M,$p:()=>I,F8:()=>L,SV:()=>B});var t=e(74848),n=e(32196),s=e(96540),a=e(55852),r=e(9286),g=e(84140),i=e(11261),l=e(83195),d=e(52622),c=e(24284),h=e(29413),o=e(5926),m=e(14578);const u=({percentChange:A,styles:K})=>{let W;return A>0?W="arrow-up":A<0&&(W="arrow-down"),(0,t.jsxs)("div",{style:K.containerStyles,children:[W&&(0,t.jsx)(m.I,{name:W,height:K.iconSize,width:K.iconSize,viewBox:"6 6 12 12"}),p(A)]})},p=A=>(A/100).toLocaleString(void 0,{style:"percent",maximumSignificantDigits:3}),f=1.2,y=30,x=500;class v{constructor(K){this.props=K;const{width:W,height:U,value:F,text:V}=K;this.valueColor=F.color??"gray",this.panelPadding=U>100?12:8,this.textValues=S(K),this.justifyCenter=T(K.justifyMode,this.textValues.title),this.valueToAlignTo=this.textValues.valueToAlignTo,this.titleToAlignTo=this.textValues.titleToAlignTo,this.titleFontSize=0,this.valueFontSize=0,this.chartHeight=0,this.chartWidth=0,this.maxTextWidth=W-this.panelPadding*2,this.maxTextHeight=U-this.panelPadding*2,V&&(V.titleSize&&(this.titleFontSize=V.titleSize,this.titleToAlignTo=void 0),V.valueSize&&(this.valueFontSize=V.valueSize,this.valueToAlignTo=""))}getTitleStyles(){const K={fontSize:`${this.titleFontSize}px`,lineHeight:f};return(this.props.colorMode===M.Background||this.props.colorMode===M.BackgroundSolid)&&(K.color=(0,c.mZ)(this.valueColor,this.props.theme.isDark)),K}getValueStyles(){const K={fontSize:this.valueFontSize,fontWeight:x,lineHeight:f,position:"relative",zIndex:1};switch(this.justifyCenter&&(K.textAlign="center"),this.props.colorMode){case M.Value:K.color=this.valueColor;break;case M.Background:case M.BackgroundSolid:K.color=(0,c.mZ)(this.valueColor,this.props.theme.isDark);break;case M.None:K.color=this.props.theme.colors.text.primary;break}return K}getPercentChangeStyles(K,W,U){const V=this.getValueAndTitleContainerStyles(),w=Math.max(this.valueFontSize/2.5,12);let z=Math.max(this.valueFontSize/3,10);const N=this.props.theme.visualization,H=O(K,W,U,N),Q={fontSize:w,fontWeight:x,lineHeight:f,position:"relative",display:"flex",alignItems:"center",gap:Math.max(w/3,4),zIndex:1,color:H};switch(this.justifyCenter&&(Q.textAlign="center"),V.flexDirection==="column"&&w>12&&(Q.marginTop=-(w/4)),V.flexDirection==="row"&&(Q.alignItems="baseline",Q.lineHeight=f*2.5),this.props.colorMode){case M.Background:case M.BackgroundSolid:Q.color=(0,c.mZ)(this.valueColor,this.props.theme.isDark);break}return this.props.textMode===B.None&&(Q.fontSize=(0,h.Vr)(p(K),this.maxTextWidth*.8,this.maxTextHeight*.8,f,void 0,x),z=Q.fontSize*.8),{containerStyles:Q,iconSize:z}}getValueAndTitleContainerStyles(){const K={display:"flex",flexWrap:"wrap"};return this.justifyCenter&&(K.alignItems="center",K.justifyContent="center",K.flexGrow=1,K.gap="0.75ch"),K}getPanelStyles(){const{width:K,height:W,theme:U,colorMode:F,textMode:V}=this.props,w={width:`${K}px`,height:`${W}px`,padding:`${V===B.None?2:this.panelPadding}px`,borderRadius:U.shape.radius.default,position:"relative",display:"flex"},z=U.isDark?1:-.7;switch(F){case M.Background:const N=(0,g.A)(this.valueColor).darken(15*z).spin(8).toRgbString(),H=(0,g.A)(this.valueColor).darken(5*z).spin(-8).toRgbString();w.background=`linear-gradient(120deg, ${N}, ${H})`;break;case M.BackgroundSolid:w.background=(0,g.A)(this.valueColor).toString();break;case M.Value:w.background="transparent";break}return this.justifyCenter&&(w.alignItems="center",w.flexDirection="row"),w}renderChart(){const{sparkline:K,colorMode:W}=this.props;if(!K||K.y?.type!==i.PU.number)return null;let U,F;switch(W){case M.Background:case M.BackgroundSolid:U="rgba(255,255,255,0.4)",F=(0,g.A)(this.valueColor).brighten(40).toRgbString();break;case M.None:case M.Value:default:F=this.valueColor,U=(0,g.A)(this.valueColor).setAlpha(.2).toRgbString();break}const V={custom:{drawStyle:d.GR.Line,lineWidth:1,fillColor:U,lineColor:F}};return(0,t.jsx)("div",{style:this.getChartStyles(),children:(0,t.jsx)(o.O,{height:this.chartHeight,width:this.chartWidth,sparkline:K,config:V,theme:this.props.theme})})}getChartStyles(){return{position:"absolute",right:0,bottom:0}}}class P extends v{constructor(K){super(K);const W=this.titleToAlignTo?.length?.3:1;this.valueToAlignTo.length&&(this.valueFontSize=(0,h.Vr)(this.valueToAlignTo,this.maxTextWidth*W,this.maxTextHeight,f,void 0,x)),this.titleToAlignTo?.length&&(this.titleFontSize=(0,h.Vr)(this.titleToAlignTo,this.maxTextWidth*.6,this.maxTextHeight,f,y),this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize))}getValueAndTitleContainerStyles(){const K=super.getValueAndTitleContainerStyles();return K.flexDirection="row",K.alignItems="center",K.flexGrow=1,this.justifyCenter||(K.justifyContent="space-between"),K}renderChart(){return null}getPanelStyles(){const K=super.getPanelStyles();return K.alignItems="center",K}}class E extends v{constructor(K){super(K);const{width:W,height:U}=K,F=.5,V=.6,w=1-V,z=.4;this.chartWidth=W,this.chartHeight=U*F,this.titleToAlignTo?.length&&(this.titleFontSize=(0,h.Vr)(this.titleToAlignTo,this.maxTextWidth*V,this.maxTextHeight*z,f,y)),this.valueToAlignTo.length&&(this.valueFontSize=(0,h.Vr)(this.valueToAlignTo,this.maxTextWidth*w,this.maxTextHeight*F,f,void 0,x))}getValueAndTitleContainerStyles(){const K=super.getValueAndTitleContainerStyles();return K.flexDirection="row",K.flexGrow=1,this.justifyCenter||(K.justifyContent="space-between"),K}getPanelStyles(){const K=super.getPanelStyles();return K.flexDirection="row",K.justifyContent="space-between",K}}class D extends v{constructor(K){super(K);const{width:W,height:U}=K,F=.15,V=.25;let w=0;this.chartHeight=U*V,this.chartWidth=W,this.titleToAlignTo?.length&&(this.titleFontSize=(0,h.Vr)(this.titleToAlignTo,this.maxTextWidth,U*F,f,y),w=this.titleFontSize*f),this.valueToAlignTo.length&&(this.valueFontSize=(0,h.Vr)(this.valueToAlignTo,this.maxTextWidth,this.maxTextHeight-this.chartHeight-w,f,void 0,x)),this.titleToAlignTo?.length&&(this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize)),this.chartHeight=U-this.titleFontSize*f-this.valueFontSize*f}getValueAndTitleContainerStyles(){const K=super.getValueAndTitleContainerStyles();return K.flexDirection="column",K.justifyContent="center",K}getPanelStyles(){const K=super.getPanelStyles();return K.flexDirection="column",K}}class C extends v{constructor(K){super(K);const{height:W}=K,U=.15;let F=0;this.titleToAlignTo?.length&&(this.titleFontSize=(0,h.Vr)(this.titleToAlignTo,this.maxTextWidth,W*U,f,y),F=this.titleFontSize*f),this.valueToAlignTo.length&&(this.valueFontSize=(0,h.Vr)(this.valueToAlignTo,this.maxTextWidth,this.maxTextHeight-F,f,void 0,x)),this.titleToAlignTo?.length&&(this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize))}getValueAndTitleContainerStyles(){const K=super.getValueAndTitleContainerStyles();return K.flexDirection="column",K.flexGrow=1,K}renderChart(){return null}getPanelStyles(){const K=super.getPanelStyles();return K.alignItems="center",K}}function b(A){const{width:K,height:W,sparkline:U}=A;return K/W>2.5&&!A.disableWideLayout?W>50&&U&&U.y.values.length>1?new E(A):new P(A):W>100&&U&&U.y.values.length>1?new D(A):new C(A)}function T(A,K){return A===L.Center?!0:(K??"").length===0}function S(A){const{value:K,alignmentFactors:W,count:U}=A;let{textMode:F}=A;const V=W?W.title:K.title,w=(0,l.cN)(W||K);switch(F===B.Auto&&(U??1)===1&&(F=B.Value),F){case B.Name:return{...K,title:void 0,prefix:void 0,suffix:void 0,text:K.title||"",titleToAlignTo:void 0,valueToAlignTo:V??"",tooltip:(0,l.cN)(K)};case B.Value:return{...K,title:void 0,titleToAlignTo:void 0,valueToAlignTo:w,tooltip:K.title};case B.None:return{numeric:K.numeric,color:K.color,title:void 0,text:"",titleToAlignTo:void 0,valueToAlignTo:"1",tooltip:`Name: ${K.title}
Value: ${(0,l.cN)(K)}`};case B.ValueAndName:default:return{...K,titleToAlignTo:V,valueToAlignTo:w}}}function O(A,K,W,U){return K===d.CD.SameAsValue?W.color:A*(K===d.CD.Inverted?-1:1)>0?U.getColorByName("green"):U.getColorByName("red")}var M=(A=>(A.Background="background",A.BackgroundSolid="background_solid",A.None="none",A.Value="value",A))(M||{}),I=(A=>(A.None="none",A.Line="line",A.Area="area",A))(I||{}),L=(A=>(A.Auto="auto",A.Center="center",A))(L||{}),B=(A=>(A.Auto="auto",A.Value="value",A.ValueAndName="value_and_name",A.Name="name",A.None="none",A))(B||{});class j extends s.PureComponent{static{this.defaultProps={justifyMode:"auto"}}render(){const{onClick:K,className:W,hasLinks:U,theme:F}=this.props,V=b(this.props),w=V.getPanelStyles(),z=V.getValueAndTitleContainerStyles(),N=V.getValueStyles(),H=V.getTitleStyles(),Q=V.textValues,X=this.props.value.percentChange,ee=this.props.percentChangeColorMode,Z=X!=null&&!Number.isNaN(X),q=U?void 0:Q.tooltip;return K?(0,t.jsxs)("button",{type:"button",className:(0,n.cx)((0,a.my)(F),W),style:w,onClick:K,title:q,children:[(0,t.jsxs)("div",{style:z,children:[Q.title&&(0,t.jsx)("div",{style:H,children:Q.title}),(0,t.jsx)(r.i,{value:Q,style:N})]}),V.renderChart()]}):(0,t.jsxs)("div",{className:W,style:w,title:q,children:[(0,t.jsxs)("div",{style:z,children:[Q.title&&(0,t.jsx)("div",{style:H,children:Q.title}),(0,t.jsx)(r.i,{value:Q,style:N}),Z&&(0,t.jsx)(u,{percentChange:X,styles:V.getPercentChangeStyles(X,ee,N)})]}),V.renderChart()]})}}},54438:(G,R,e)=>{"use strict";e.d(R,{J:()=>l});var t=e(74848),n=e(32196),s=e(96540),a=e(23257),r=e.n(a),g=e(40845),i=e(5313);const l=(0,s.forwardRef)(({name:c,value:h,hidden:o,facets:m,onClick:u,className:p,loading:f,searchTerm:y,active:x,style:v,title:P,highlightParts:E,...D},C)=>{const b=(0,g.$j)(),T=d(b),S=y?[y]:[],O=(0,s.useCallback)(I=>{u&&!o&&u(c,h,I)},[u,c,o,h]);let M=h||c;return m&&(M=`${M} (${m})`),(0,t.jsx)("button",{ref:C,onClick:O,style:v,title:P||M,type:"button",role:"option","aria-selected":!!x,className:(0,n.cx)(T.base,x&&T.active,f&&T.loading,o&&T.hidden,p,u&&!o&&T.hover),...D,children:E!==void 0?(0,t.jsx)(i.z,{text:M,highlightClassName:T.matchHighLight,highlightParts:E}):(0,t.jsx)(r(),{textToHighlight:M,searchWords:S,autoEscape:!0,highlightClassName:T.matchHighLight})},M)});l.displayName="Label";const d=c=>({base:(0,n.css)({display:"inline-block",cursor:"pointer",fontSize:c.typography.size.sm,lineHeight:c.typography.bodySmall.lineHeight,backgroundColor:c.colors.background.secondary,color:c.colors.text.primary,whiteSpace:"nowrap",textShadow:"none",padding:c.spacing(.5),borderRadius:c.shape.radius.default,border:"none",marginRight:c.spacing(1),marginBottom:c.spacing(.5)}),loading:(0,n.css)({fontWeight:c.typography.fontWeightMedium,backgroundColor:c.colors.primary.shade,color:c.colors.text.primary,[c.transitions.handleMotion("no-preference","reduce")]:{animation:"pulse 3s ease-out 0s infinite normal forwards"},"@keyframes pulse":{"0%":{color:c.colors.text.primary},"50%":{color:c.colors.text.secondary},"100%":{color:c.colors.text.disabled}}}),active:(0,n.css)({fontWeight:c.typography.fontWeightMedium,backgroundColor:c.colors.primary.main,color:c.colors.primary.contrastText}),matchHighLight:(0,n.css)({background:"inherit",color:c.components.textHighlight.text,backgroundColor:c.components.textHighlight.background}),hidden:(0,n.css)({opacity:.6,cursor:"default",border:"1px solid transparent"}),hover:(0,n.css)({"&:hover":{opacity:.85,cursor:"pointer"}})})},19727:(G,R,e)=>{"use strict";e.d(R,{e:()=>r});var t=e(74848),n=e(32196),s=e(96540),a=e(40845);const r=(0,s.forwardRef)(({className:i,children:l,...d},c)=>{const h=(0,a.of)(g);return(0,t.jsx)("div",{ref:c,className:(0,n.cx)("button-group",h.wrapper,i),...d,children:l})});r.displayName="ButtonGroup";const g=i=>({wrapper:(0,n.css)({display:"flex","> .button-group:not(:first-child) > button, > button:not(:first-child)":{borderTopLeftRadius:0,borderBottomLeftRadius:0},"> .button-group:not(:last-child) > button, > button:not(:last-child)":{borderTopRightRadius:0,borderBottomRightRadius:0,borderRightWidth:0}})})},76442:(G,R,e)=>{"use strict";e.d(R,{c:()=>a});var t=e(74848),n=e(32196),s=e(40845);const a=({message:g,callToActionElement:i,footer:l,className:d})=>{const c=(0,s.of)(r);return(0,t.jsxs)("div",{className:(0,n.cx)([c.wrapper,d]),children:[g&&(0,t.jsx)("div",{className:c.message,children:g}),i,l&&(0,t.jsx)("div",{className:c.footer,children:l})]})},r=g=>({wrapper:(0,n.css)({label:"call-to-action-card",background:g.colors.background.secondary,borderRadius:g.shape.radius.default,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flexGrow:1,padding:g.spacing(3),[g.breakpoints.down("sm")]:{padding:g.spacing(3,1)}}),message:(0,n.css)({marginBottom:g.spacing(3),fontStyle:"italic"}),footer:(0,n.css)({marginTop:g.spacing(3)})})},10860:(G,R,e)=>{"use strict";e.d(R,{H:()=>C,Z:()=>l});var t=e(74848),n=e(32196),s=e(96540),a=e(40845),r=e(16797),g=e(81507);const i=s.createContext(null),l=({disabled:b,href:T,onClick:S,children:O,isSelected:M,isCompact:I,className:L,...B})=>{const j=(0,s.useMemo)(()=>s.Children.toArray(O).some(U=>s.isValidElement(U)&&U.type===d),[O]),A=b||!S&&!T,K=S&&!b?S:void 0,W=(0,a.of)(g.i,b,A,M,I);return(0,t.jsx)(g.Q,{disableEvents:b,disableHover:A,isSelected:M,className:(0,n.cx)(W.container,L),...B,children:(0,t.jsxs)(i.Provider,{value:{href:T,onClick:K,disabled:b,isSelected:M},children:[!j&&(0,t.jsx)(d,{}),O]})})},d=({children:b,className:T,"aria-label":S})=>{const O=(0,s.useContext)(i),M=(0,a.of)(c),{href:I,onClick:L,isSelected:B}=O??{href:void 0,onClick:void 0,isSelected:void 0};return(0,t.jsxs)("h2",{className:(0,n.cx)(M.heading,T),children:[I?(0,t.jsx)("a",{href:I,className:M.linkHack,"aria-label":S,onClick:L,children:b}):L?(0,t.jsx)("button",{onClick:L,className:M.linkHack,"aria-label":S,type:"button",children:b}):(0,t.jsx)(t.Fragment,{children:b}),B!==void 0&&(0,t.jsx)("input",{"aria-label":"option",type:"radio",checked:B,readOnly:!0})]})};d.displayName="Heading";const c=b=>({heading:(0,n.css)({gridArea:"Heading",justifySelf:"start",display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:0,fontSize:b.typography.size.md,letterSpacing:"inherit",lineHeight:b.typography.body.lineHeight,color:b.colors.text.primary,fontWeight:b.typography.fontWeightMedium,"& input[readonly]":{cursor:"inherit"}}),linkHack:(0,n.css)({all:"unset","&::after":{position:"absolute",content:'""',top:0,bottom:0,left:0,right:0,borderRadius:b.shape.radius.default},"&:focus-visible":{outline:"none",outlineOffset:0,boxShadow:"none","&::after":{...(0,r.getFocusStyles)(b),zIndex:1}}})}),h=({children:b,className:T})=>{const S=(0,a.of)(o);return(0,t.jsx)("div",{className:(0,n.cx)(S.tagList,T),children:b})};h.displayName="Tags";const o=b=>({tagList:(0,n.css)({position:"relative",gridArea:"Tags",alignSelf:"center"})}),m=({children:b,className:T})=>{const S=(0,a.of)(u);return(0,t.jsx)("p",{className:(0,n.cx)(S.description,T),children:b})};m.displayName="Description";const u=b=>({description:(0,n.css)({width:"100%",gridArea:"Description",margin:b.spacing(1,0,0),color:b.colors.text.secondary,lineHeight:b.typography.body.lineHeight})}),p=({children:b,align:T="start",className:S})=>{const O=(0,a.of)(f);return(0,t.jsx)("div",{className:(0,n.cx)(O.media,S,(0,n.css)({alignSelf:T})),children:b})};p.displayName="Figure";const f=b=>({media:(0,n.css)({position:"relative",gridArea:"Figure",marginRight:b.spacing(2),width:"40px","> img":{width:"100%"},"&:empty":{display:"none"}})}),y=(0,s.memo)(({children:b,className:T,separator:S="|"})=>{const O=(0,a.of)(x);let M=b;const I=s.Children.toArray(b).filter(Boolean);return I.length?(M=I.map((L,B)=>(0,t.jsx)("div",{className:O.metadataItem,children:L},`element_${B}`)),I.length>1&&S&&(M=I.reduce((L,B,j)=>[L,(0,t.jsx)("span",{className:O.separator,children:S},`separator_${j}`),B])),(0,t.jsx)("div",{className:(0,n.cx)(O.metadata,T),children:M})):null});y.displayName="Meta";const x=b=>({metadata:(0,n.css)({gridArea:"Meta",display:"flex",alignItems:"center",width:"100%",fontSize:b.typography.size.sm,color:b.colors.text.secondary,margin:b.spacing(.5,0,0),lineHeight:b.typography.bodySmall.lineHeight,overflowWrap:"anywhere"}),metadataItem:(0,n.css)({zIndex:0}),separator:(0,n.css)({margin:`0 ${b.spacing(1)}`})}),v=({children:b,disabled:T,variant:S,className:O})=>{const M=(0,a.of)(P),L=(0,s.useContext)(i)?.disabled||T,B=S==="primary"?M.actions:M.secondaryActions;return(0,t.jsx)("div",{className:(0,n.cx)(B,O),children:s.Children.map(b,j=>s.isValidElement(j)?(0,s.cloneElement)(j,{disabled:L,...j.props}):null)})},P=b=>({actions:(0,n.css)({display:"flex",flexDirection:"row",flexWrap:"wrap",gap:b.spacing(1),gridArea:"Actions",marginTop:b.spacing(2)}),secondaryActions:(0,n.css)({alignSelf:"center",color:b.colors.text.secondary,display:"flex",flexDirection:"row",flexWrap:"wrap",gap:b.spacing(1),gridArea:"Secondary",marginTop:b.spacing(2)})}),E=({children:b,disabled:T,className:S})=>(0,t.jsx)(v,{variant:"primary",disabled:T,className:S,children:b});E.displayName="Actions";const D=({children:b,disabled:T,className:S})=>(0,t.jsx)(v,{variant:"secondary",disabled:T,className:S,children:b});D.displayName="SecondaryActions";const C=b=>({inner:(0,n.css)({display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",flexWrap:"wrap"}),...c(b),...x(b),...u(b),...f(b),...P(b),...o(b)});l.Heading=d,l.Tags=h,l.Figure=p,l.Meta=y,l.Actions=E,l.SecondaryActions=D,l.Description=m},81507:(G,R,e)=>{"use strict";e.d(R,{Q:()=>i,i:()=>l});var t=e(74848),n=e(32196),s=e(40845),a=e(16797);const r=({children:d,href:c})=>{const{inner:h}=(0,s.of)(g);return c?(0,t.jsx)("a",{className:h,href:c,children:d}):(0,t.jsx)(t.Fragment,{children:d})},g=d=>({inner:(0,n.css)({display:"flex",width:"100%",padding:d.spacing(2)})}),i=({children:d,disableEvents:c,disableHover:h,isSelected:o,className:m,href:u,...p})=>{const{oldContainer:f}=(0,s.of)(l,c,h,o);return(0,t.jsx)("div",{...p,className:(0,n.cx)(f,m),children:(0,t.jsx)(r,{href:u,children:d})})},l=(d,c=!1,h=!1,o,m)=>{const u=o!==void 0;return{container:(0,n.css)({display:"grid",position:"relative",gridTemplateColumns:"auto 1fr auto",gridTemplateRows:"1fr auto auto auto",gridAutoColumns:"1fr",gridAutoFlow:"row",gridTemplateAreas:`
        "Figure Heading Tags"
        "Figure Meta Tags"
        "Figure Description Tags"
        "Figure Actions Secondary"`,width:"100%",padding:d.spacing(m?1:2),background:d.colors.background.secondary,borderRadius:d.shape.radius.default,marginBottom:"8px",pointerEvents:c?"none":"auto",[d.transitions.handleMotion("no-preference","reduce")]:{transition:d.transitions.create(["background-color","box-shadow","border-color","color"],{duration:d.transitions.duration.short})},...!h&&{"&:hover":{background:d.colors.emphasize(d.colors.background.secondary,.03),cursor:"pointer",zIndex:1},"&:focus":a.getFocusStyles(d)},...u&&{cursor:"pointer"},...o&&{outline:`solid 2px ${d.colors.primary.border}`}}),oldContainer:(0,n.css)({display:"flex",width:"100%",background:d.colors.background.secondary,borderRadius:d.shape.radius.default,position:"relative",pointerEvents:c?"none":"auto",marginBottom:d.spacing(1),[d.transitions.handleMotion("no-preference","reduce")]:{transition:d.transitions.create(["background-color","box-shadow","border-color","color"],{duration:d.transitions.duration.short})},...!h&&{"&:hover":{background:d.colors.emphasize(d.colors.background.secondary,.03),cursor:"pointer",zIndex:1},"&:focus":a.getFocusStyles(d)}})}}},3988:(G,R,e)=>{"use strict";e.d(R,{v:()=>x});var t=e(74848),n=e(32196),s=e(47078),a=e.n(s),r=e(16401),g=e(96540),i=e(40845),l=e(14578),d=e(29158),c=e(10354),h=e(67061),o=e(90182),m=e(58898),u=e(30958);const p=(0,n.css)({"&:focus":{outline:"none"}}),f=" / ";class y extends g.PureComponent{constructor(P){super(P),this.flattenOptions=(b,T=[])=>{let S=[];for(const O of b){const M=[...T];M.push(O),!O.items||O.items.length===0?S.push({singleLabel:M[M.length-1].label,label:M.map(I=>I.label).join(this.props.separator||f),value:M.map(I=>I.value)}):S=[...S,...this.flattenOptions(O.items,M)]}return S},this.getSearchableOptions=a()(b=>this.flattenOptions(b)),this.onChange=(b,T)=>{const S=this.props.hideActiveLevelLabel?"":this.props.displayAllSelectedLevels?T.map(M=>M.label).join(this.props.separator||f):T[T.length-1].label,O={rcValue:{value:b,label:S},focusCascade:!0,activeLabel:S,isSearching:!1,inputValue:S};this.setState(O),this.props.onSelect(T[T.length-1].value)},this.onSelect=b=>{const T=b.value||[],S=this.props.displayAllSelectedLevels?b.label:b.singleLabel||"",O={activeLabel:S,inputValue:S,rcValue:{value:T,label:S},isSearching:!1,focusCascade:!1};this.setState(O),this.props.onSelect(T[T.length-1])},this.onCreateOption=b=>{this.setState({activeLabel:b,inputValue:b,rcValue:[],isSearching:!1}),this.props.onSelect(b)},this.onBlur=()=>{this.setState({isSearching:!1,focusCascade:!1}),this.state.activeLabel===""&&this.setState({rcValue:[]}),this.props.onBlur?.()},this.onBlurCascade=()=>{this.setState({focusCascade:!1}),this.props.onBlur?.()},this.onInputKeyDown=b=>{if(["ArrowDown","ArrowUp","Enter","ArrowLeft","ArrowRight"].includes(b.key))return;const{activeLabel:T}=this.state;this.setState({focusCascade:!1,isSearching:!0,inputValue:T})},this.onSelectInputChange=b=>{this.setState({inputValue:b})};const E=this.getSearchableOptions(P.options),{rcValue:D,activeLabel:C}=this.setInitialValue(E,P.initialValue);this.state={isSearching:!1,focusCascade:!1,rcValue:D,activeLabel:C,inputValue:""}}static{this.defaultProps={changeOnSelect:!0}}setInitialValue(P,E){if(!E)return{rcValue:[],activeLabel:""};for(const D of P){const C=D.value||[];if(C[C.length-1]===E)return{rcValue:C,activeLabel:this.props.displayAllSelectedLevels?D.label:D.singleLabel||""}}return this.props.allowCustomValue?{rcValue:[],activeLabel:E}:{rcValue:[],activeLabel:""}}render(){const{allowCustomValue:P,formatCreateLabel:E,placeholder:D,width:C,changeOnSelect:b,options:T,disabled:S,id:O,isClearable:M,theme:I}=this.props,{focusCascade:L,isSearching:B,rcValue:j,activeLabel:A,inputValue:K}=this.state,W=this.getSearchableOptions(T),U=(0,u.T)(I);return(0,t.jsx)("div",{children:B?(0,t.jsx)(o.l6,{allowCustomValue:P,placeholder:D,autoFocus:!L,onChange:this.onSelect,onBlur:this.onBlur,options:W,onCreateOption:this.onCreateOption,formatCreateLabel:E,width:C,onInputChange:this.onSelectInputChange,disabled:S,inputValue:K,inputId:O}):(0,t.jsx)(r.A,{onChange:(0,m.k)(this.onChange),options:T,changeOnSelect:b,value:j.value,fieldNames:{label:"label",value:"value",children:"items"},expandIcon:null,open:this.props.alwaysOpen,disabled:S,dropdownClassName:U.dropdown,children:(0,t.jsx)("div",{className:p,children:(0,t.jsx)(c.p,{autoFocus:this.props.autoFocus,width:C,placeholder:D,onBlur:this.onBlurCascade,value:A,onKeyDown:this.onInputKeyDown,onChange:()=>{},suffix:(0,t.jsxs)(h.B,{gap:.5,children:[M&&A!==""&&(0,t.jsx)(d.K,{name:"times","aria-label":"Clear selection",onClick:F=>{F.preventDefault(),F.stopPropagation(),this.setState({rcValue:[],activeLabel:"",inputValue:""}),this.props.onSelect("")}}),(0,t.jsx)(l.I,{name:L?"angle-up":"angle-down"})]}),disabled:S,id:O})})})})}}const x=(0,i.cV)(y)},58898:(G,R,e)=>{"use strict";e.d(R,{W:()=>n,k:()=>t});const t=r=>(g,i)=>{r&&r(g.map(l=>String(l)),s(i))},n=r=>g=>{r&&r(s(g))},s=r=>r.map(a),a=r=>{const g=r.value?String(r.value):"";return{value:g,label:typeof r.label=="string"?r.label:g}}},30958:(G,R,e)=>{"use strict";e.d(R,{T:()=>g});var t=e(32196);const n=(0,t.keyframes)({"0%":{opacity:0,transformOrigin:"0% 0%",transform:"scaleY(0.8)"},"100%":{opacity:1,transformOrigin:"0% 0%",transform:"scaleY(1)"}}),s=(0,t.keyframes)({"0%":{opacity:1,transformOrigin:"0% 0%",transform:"scaleY(1)"},"100%":{opacity:0,transformOrigin:"0% 0%",transform:"scaleY(0.8)"}}),a=(0,t.keyframes)({"0%":{opacity:0,transformOrigin:"0% 100%",transform:"scaleY(0.8)"},"100%":{opacity:1,transformOrigin:"0% 100%",transform:"scaleY(1)"}}),r=(0,t.keyframes)({"0%":{opacity:1,transformOrigin:"0% 100%",transform:"scaleY(1)"},"100%":{opacity:0,transformOrigin:"0% 100%",transform:"scaleY(0.8)"}}),g=i=>({dropdown:(0,t.css)({"&.rc-cascader-dropdown":{position:"absolute",zIndex:9999,"&-hidden":{display:"none"}},".rc-cascader":{"&-menus":{overflow:"hidden",background:i.colors.background.canvas,border:`1px solid ${i.colors.border.weak}`,borderRadius:i.shape.radius.default,boxShadow:i.shadows.z3,whiteSpace:"nowrap","&.slide-up-enter, &.slide-up-appear":{animationDuration:"0.3s",animationFillMode:"both",transformOrigin:"0 0",opacity:0,animationTimingFunction:"cubic-bezier(0.08, 0.82, 0.17, 1)",animationPlayState:"paused"},"&.slide-up-enter.slide-up-enter-active.rc-cascader-menus-placement, &.slide-up-appear.slide-up-appear-active.rc-cascader-menus-placement":{"&-bottomLeft":{animationName:n,animationPlayState:"running"},"&-topLeft":{animationName:a,animationPlayState:"running"}},"&.slide-up-leave":{animationDuration:"0.3s",animationFillMode:"both",transformOrigin:"0 0",opacity:1,animationTimingFunction:"cubic-bezier(0.6, 0.04, 0.98, 0.34)",animationPlayState:"paused","&.slide-up-leave-active.rc-cascader-menus-placement":{"&-bottomLeft":{animationName:s,animationPlayState:"running"},"&-topLeft":{animationName:r,animationPlayState:"running"}}}},"&-menu":{display:"inline-block",maxWidth:"50vw",height:"192px",listStyle:"none",margin:0,padding:0,borderRight:`1px solid ${i.colors.border.weak}`,overflow:"auto","&:last-child":{borderRight:0},"&-item":{height:i.spacing(4),lineHeight:i.spacing(4),padding:i.spacing(0,4,0,2),cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",transition:"all 0.3s ease",position:"relative","&:hover":{background:i.colors.action.hover},"&-disabled":{cursor:"not-allowed",color:i.colors.text.disabled,"&:hover":{background:"transparent"},"&:after":{position:"absolute",right:"12px",content:"'loading'",color:i.colors.text.disabled,fontStyle:"italic"}},"&-active":{color:i.colors.text.maxContrast,background:i.colors.background.secondary,"&:hover":{background:i.colors.action.hover}},"&-expand":{position:"relative","&:after":{background:i.colors.background.secondary,content:"''",height:i.spacing(3),mask:"url(../img/icons/unicons/angle-right.svg)",maskType:"luminance",position:"absolute",right:0,top:i.spacing(.5),width:i.spacing(3)}}}}}})})},8866:(G,R,e)=>{"use strict";e.d(R,{N:()=>s});var t=e(74848),n=e(96540);class s extends n.PureComponent{constructor(){super(...arguments),this.myRef=(0,n.createRef)(),this.state={hasEventListener:!1},this.onOutsideClick=r=>{const g=this.myRef.current;(!g||r.target instanceof Node&&!g.contains(r.target))&&this.props.onClick()}}static{this.defaultProps={includeButtonPress:!0,parent:typeof window<"u"?window:void 0,useCapture:!1}}componentDidMount(){this.props.parent.addEventListener("click",this.onOutsideClick,this.props.useCapture),this.props.includeButtonPress&&this.props.parent.addEventListener("keyup",this.onOutsideClick,this.props.useCapture)}componentWillUnmount(){this.props.parent.removeEventListener("click",this.onOutsideClick,this.props.useCapture),this.props.includeButtonPress&&this.props.parent.removeEventListener("keyup",this.onOutsideClick,this.props.useCapture)}render(){return(0,t.jsx)("div",{ref:this.myRef,children:this.props.children})}}},10534:(G,R,e)=>{"use strict";e.d(R,{b:()=>c});var t=e(74848),n=e(32196),s=e(96540),a=e(76412),r=e(40845),g=e(55852),i=e(14578),l=e(32982);const d=2*1e3;function c({onClipboardCopy:m,onClipboardError:u,children:p,getText:f,icon:y,variant:x,...v}){const P=(0,r.of)(o),[E,D]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let T;return E&&(T=setTimeout(()=>{D(!1)},d)),()=>{window.clearTimeout(T)}},[E]);const C=(0,s.useRef)(null),b=(0,s.useCallback)(async()=>{const T=f();try{await h(T,C),D(!0),m?.(T)}catch(S){u?.(T,S)}},[f,m,u]);return(0,t.jsxs)(t.Fragment,{children:[E&&(0,t.jsx)(l.r,{placement:"top",referenceElement:C.current,children:(0,t.jsx)(a.x,{i18nKey:"clipboard-button.inline-toast.success",children:"Copied"})}),(0,t.jsxs)(g.$n,{onClick:b,icon:y,variant:E?"success":x,"aria-label":E?"Copied":void 0,...v,className:(0,n.cx)(P.button,E&&P.successButton,v.className),ref:C,children:[p,E&&(0,t.jsx)("div",{className:P.successOverlay,children:(0,t.jsx)(i.I,{name:"check"})})]})]})}const h=async(m,u)=>{if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(m);{const p=document.createElement("textarea");u.current?.appendChild(p),p.value=m,p.focus(),p.select(),document.execCommand("copy"),p.remove()}},o=m=>({button:(0,n.css)({position:"relative"}),successButton:(0,n.css)({"> *":(0,n.css)({visibility:"hidden"})}),successOverlay:(0,n.css)({position:"absolute",top:0,bottom:0,right:0,left:0,visibility:"visible"})})},57418:(G,R,e)=>{"use strict";e.d(R,{M:()=>c});var t=e(74848),n=e(32196),s=e(2543),a=e.n(s),r=e(96540),g=e(40845),i=e(16797),l=e(14578),d=e(62930);const c=({label:o,isOpen:m,onToggle:u,className:p,contentClassName:f,children:y,labelId:x,loading:v=!1,headerDataTestId:P,contentDataTestId:E})=>{const[D,C]=(0,r.useState)(m),b=(0,g.of)(h),T=M=>{M.target instanceof HTMLElement&&M.target.tagName==="A"||(M.preventDefault(),M.stopPropagation(),u?.(!D),C(!D))},{current:S}=(0,r.useRef)((0,s.uniqueId)()),O=x??`collapse-label-${S}`;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{onClick:T,className:(0,n.cx)(b.header,p),children:[(0,t.jsx)("button",{type:"button",id:`collapse-button-${S}`,className:b.button,onClick:T,"aria-expanded":D&&!v,"aria-controls":`collapse-content-${S}`,"aria-labelledby":O,children:v?(0,t.jsx)(d.y,{className:b.spinner}):(0,t.jsx)(l.I,{name:D?"angle-up":"angle-down",className:b.icon})}),(0,t.jsx)("div",{className:b.label,id:`collapse-label-${S}`,"data-testid":P,children:o})]}),D&&(0,t.jsx)("div",{id:`collapse-content-${S}`,className:(0,n.cx)(b.content,f),"data-testid":E,children:y})]})},h=o=>({header:(0,n.css)({display:"flex",cursor:"pointer",boxSizing:"border-box",flexDirection:"row-reverse",position:"relative",justifyContent:"space-between",fontSize:o.typography.size.lg,padding:`${o.spacing(.5)} 0`,"&:focus-within":(0,i.getFocusStyles)(o)}),button:(0,n.css)({all:"unset","&:focus-visible":{outline:"none",outlineOffset:"unset",transition:"none",boxShadow:"none"}}),icon:(0,n.css)({color:o.colors.text.secondary}),content:(0,n.css)({padding:`${o.spacing(2)} 0`}),spinner:(0,n.css)({display:"flex",alignItems:"center",width:o.spacing(2)}),label:(0,n.css)({display:"flex"})})},82762:(G,R,e)=>{"use strict";e.d(R,{S:()=>d,a:()=>l});var t=e(74848),n=e(32196),s=e(96540),a=e(40845),r=e(55852),g=e(14578);const i=c=>({collapse:(0,n.css)({label:"collapse",marginBottom:c.spacing(1),backgroundColor:c.colors.background.primary,border:`1px solid ${c.colors.border.weak}`,position:"relative",borderRadius:c.shape.radius.default,width:"100%",display:"flex",flexDirection:"column",flex:"1 1 0"}),collapseBody:(0,n.css)({label:"collapse__body",padding:c.spacing(c.components.panel.padding),paddingTop:0,flex:1,overflow:"hidden",display:"flex",flexDirection:"column"}),bodyContentWrapper:(0,n.css)({label:"bodyContentWrapper",flex:1}),loader:(0,n.css)({label:"collapse__loader",height:"2px",position:"relative",overflow:"hidden",background:"none",margin:c.spacing(.5)}),loaderActive:(0,n.css)({label:"collapse__loader_active","&:after":{content:"' '",display:"block",width:"25%",top:0,height:"250%",position:"absolute",animation:"loader 2s cubic-bezier(0.17, 0.67, 0.83, 0.67) 500ms",animationIterationCount:100,left:"-25%",background:c.colors.primary.main},"@keyframes loader":{from:{left:"-25%",opacity:.1},to:{left:"100%",opacity:1}}}),header:(0,n.css)({label:"collapse__header",padding:c.spacing(1,2,1,2),display:"flex"}),headerCollapsed:(0,n.css)({label:"collapse__header--collapsed",padding:c.spacing(1,2,1,2)}),headerLabel:(0,n.css)({label:"collapse__header-label",fontWeight:c.typography.fontWeightMedium,marginRight:c.spacing(1),fontSize:c.typography.size.md,display:"flex",flex:"0 0 100%"}),icon:(0,n.css)({label:"collapse__icon",margin:c.spacing(.25,1,0,-1)})}),l=({isOpen:c,onToggle:h,...o})=>{const[m,u]=(0,s.useState)(c);return(0,t.jsx)(d,{isOpen:m,collapsible:!0,...o,onToggle:()=>{u(!m),h&&h(!m)}})},d=({isOpen:c,label:h,loading:o,collapsible:m,onToggle:u,className:p,children:f})=>{const y=(0,a.of)(r.my),x=(0,a.of)(i),v=()=>{u&&u(!c)},P=(0,n.cx)([x.collapse,p]),E=o?(0,n.cx)([x.loader,x.loaderActive]):(0,n.cx)([x.loader]),D=m?(0,n.cx)([x.header]):(0,n.cx)([x.headerCollapsed]);return(0,t.jsxs)("div",{className:P,children:[(0,t.jsxs)("button",{type:"button",className:(0,n.cx)(y,D),onClick:v,children:[m&&(0,t.jsx)(g.I,{className:x.icon,name:c?"angle-down":"angle-right"}),(0,t.jsx)("div",{className:(0,n.cx)([x.headerLabel]),children:h})]}),c&&(0,t.jsxs)("div",{className:(0,n.cx)([x.collapseBody]),children:[(0,t.jsx)("div",{className:E}),(0,t.jsx)("div",{className:x.bodyContentWrapper,children:f})]})]})};d.displayName="Collapse"},36314:(G,R,e)=>{"use strict";e.d(R,{A:()=>c});var t=e(74848),n=e(32196),s=e(2543),a=e.n(s),r=e(96540),g=e(84140),i=e(40845),l=e(10354);const d=(0,r.forwardRef)(({color:m,onChange:u,isClearable:p=!1,onClick:f,onBlur:y,disabled:x,buttonAriaLabel:v,...P},E)=>{const[D,C]=(0,r.useState)(m),[b,T]=(0,r.useState)(m),S=(0,r.useMemo)(()=>(0,s.debounce)(u,100),[]);(0,r.useEffect)(()=>{const I=(0,g.A)(m);I.isValid()&&m!==b&&(C(I.toString()),T(m))},[m,b]);const O=I=>{const{value:L}=I.currentTarget;if(C(L),L===""&&p){S(L);return}const B=(0,g.A)(L);B.isValid()&&S(B.toString())},M=I=>{(0,g.A)(D).isValid()||C(m),y?.(I)};return(0,t.jsx)(l.p,{...P,value:D,onChange:O,disabled:x,onClick:f,onBlur:M,addonBefore:(0,t.jsx)(h,{onClick:f,ariaLabel:v,disabled:x,color:m}),ref:E})});d.displayName="ColorInput";const c=d,h=({color:m,onClick:u,disabled:p,ariaLabel:f})=>{const y=(0,i.of)(o);return(0,t.jsx)("button",{type:"button",onClick:u,"aria-label":f,disabled:p||!u,className:(0,n.cx)(y,(0,n.css)({backgroundColor:m}))})},o=m=>(0,n.css)({height:"100%",width:`${m.spacing.gridSize*4}px`,borderRadius:`${m.shape.radius.default} 0 0 ${m.shape.radius.default}`,border:`1px solid ${m.colors.border.medium}`})},83598:(G,R,e)=>{"use strict";e.d(R,{Dp:()=>u,sk:()=>m});var t=e(74848),n=e(32196),s=e(96540),a=e(40845),r=e(3911),g=e(40321),i=e(13840),l=e(95868),d=e(70045),c=e(83876),h=e(70104);const o=(f,y="ColorPicker")=>class extends s.Component{constructor(){super(...arguments),this.pickerTriggerRef=(0,s.createRef)()}static{this.displayName=y}render(){const{theme:v,children:P,onChange:E,color:D}=this.props,C=p(v),b=s.createElement(f,{...this.props,children:null,onChange:E});return(0,t.jsx)(l.I,{content:b,hideAfter:300,children:(T,S,O)=>(0,t.jsxs)(t.Fragment,{children:[this.pickerTriggerRef.current&&(0,t.jsx)(i.A,{...O,referenceElement:this.pickerTriggerRef.current,wrapperClassName:C.colorPicker,onMouseLeave:S,onMouseEnter:T,onKeyDown:M=>(0,g.Q)(M,S)}),P?P({ref:this.pickerTriggerRef,showColorPicker:T,hideColorPicker:S}):(0,t.jsx)(c.q,{ref:this.pickerTriggerRef,onClick:T,onMouseLeave:S,color:v.visualization.getColorByName(D||"#000000"),"aria-label":D})]})})}},m=(0,a.cV)(o(d.$,"ColorPicker")),u=(0,a.cV)(o(h.o,"SeriesColorPicker")),p=(0,r.N)(f=>({colorPicker:(0,n.css)({position:"absolute",zIndex:f.zIndex.tooltip,color:f.colors.text.primary,maxWidth:"400px",fontSize:f.typography.size.sm})}))},99128:(G,R,e)=>{"use strict";e.d(R,{i:()=>h});var t=e(74848),n=e(32196),s=e(96540),a=e(7612),r=e(65229),g=e(23596),i=e(40845),l=e(8866),d=e(36314),c=e(95151);const h=(0,s.forwardRef)(({value:m="",onChange:u,returnColorAs:p="rgb",...f},y)=>{const[x,v]=(0,s.useState)(m),[P,E]=(0,s.useState)(!1),D=(0,i.$j)(),C=(0,i.of)(o),b=(0,i.of)(c.$);return(0,r.A)(T=>{if(T===m)return;if(!T){u("");return}const S=D.visualization.getColorByName(T);u(p==="rgb"?g.MV.asRgbString(S):g.MV.asHexString(S))},500,[x]),(0,t.jsx)(l.N,{onClick:()=>E(!1),children:(0,t.jsxs)("div",{className:C.wrapper,children:[P&&!f.disabled&&(0,t.jsx)(a.p9,{"data-testid":"color-popover",color:x,onChange:v,className:(0,n.cx)(b.root,C.picker)}),(0,t.jsx)(d.A,{...f,theme:D,color:x,onChange:v,buttonAriaLabel:"Open color picker",onClick:()=>E(!0),onBlur:()=>E(!1),ref:y,isClearable:!0})]})})});h.displayName="ColorPickerInput";const o=m=>({wrapper:(0,n.css)({position:"relative"}),picker:(0,n.css)({"&.react-colorful":{position:"absolute",width:"100%",zIndex:11,bottom:"36px"}}),inner:(0,n.css)({position:"absolute"})})},70045:(G,R,e)=>{"use strict";e.d(R,{$:()=>x});var t=e(74848),n=e(32196),s=e(85690),a=e(96540),r=e(23596),g=e(40845),i=e(3911),l=e(83876),d=e(2543);function c(P,E){const D=new Array(P.length);for(let C=0;C<P.length;C++){const b=P.length-1-C;D[C]=E(P[b],b,P)}return D}const o=({hue:P,selectedColor:E,onColorSelect:D,...C})=>{const b=(0,d.upperFirst)(P.name),T=(0,g.of)(m);return(0,t.jsxs)("div",{className:T.colorRow,children:[(0,t.jsx)("div",{className:T.colorLabel,children:b}),(0,t.jsx)("div",{...C,className:T.swatchRow,children:c(P.shades,S=>(0,t.jsx)(l.q,{"aria-label":S.name,variant:S.primary?l.h.Large:l.h.Small,isSelected:S.name===E,color:S.color,onClick:()=>D(S.name)},S.name))})]})},m=P=>({colorRow:(0,n.css)({display:"grid",gridTemplateColumns:"25% 1fr",gridColumnGap:P.spacing(2),padding:P.spacing(.5,0),"&:hover":{background:P.colors.background.secondary}}),colorLabel:(0,n.css)({paddingLeft:P.spacing(2),display:"flex",alignItems:"center"}),swatchRow:(0,n.css)({display:"flex",gap:P.spacing(1),alignItems:"center",justifyContent:"space-around",flexDirection:"row"})}),u=({color:P,onChange:E})=>{const D=(0,g.$j)(),C=(0,g.of)(p),b=[];for(const T of D.visualization.hues)b.push((0,t.jsx)(o,{selectedColor:P,hue:T,onColorSelect:E},T.name));return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:C.swatches,children:b}),(0,t.jsxs)("div",{className:C.extraColors,children:[(0,t.jsx)(l.q,{isSelected:P==="transparent",color:"rgba(0,0,0,0)",label:"Transparent",onClick:()=>E("transparent")}),(0,t.jsx)(l.q,{isSelected:P==="text",color:D.colors.text.primary,label:"Text color",onClick:()=>E("text")})]})]})},p=P=>({container:(0,n.css)({display:"flex",flexDirection:"column"}),extraColors:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-around",gap:P.spacing(1),padding:P.spacing(1,0)}),swatches:(0,n.css)({display:"grid",flexGrow:1})});var f=e(95151);class y extends a.Component{constructor(E){super(E),this.getTabClassName=D=>{const{activePicker:C}=this.state;return`ColorPickerPopover__tab ${C===D&&"ColorPickerPopover__tab--active"}`},this.handleChange=D=>{const{onChange:C,enableNamedColors:b,theme:T}=this.props;if(b)return C(D);C(r.MV.asHexString(T.visualization.getColorByName(D)))},this.onTabChange=D=>()=>this.setState({activePicker:D}),this.renderPicker=()=>{const{activePicker:D}=this.state,{color:C}=this.props;switch(D){case"spectrum":return(0,t.jsx)(f.A,{color:C,onChange:this.handleChange});case"palette":return(0,t.jsx)(u,{color:C,onChange:this.handleChange});default:return this.renderCustomPicker(D)}},this.renderCustomPicker=D=>{const{customPickers:C,color:b,theme:T}=this.props;return C?a.createElement(C[D].tabComponent,{color:b,theme:T,onChange:this.handleChange}):null},this.renderCustomPickerTabs=()=>{const{customPickers:D}=this.props;return D?(0,t.jsx)(t.Fragment,{children:Object.keys(D).map(C=>(0,t.jsx)("button",{className:this.getTabClassName(C),onClick:this.onTabChange(C),type:"button",children:D[C].name},C))}):null},this.state={activePicker:"palette"}}render(){const{theme:E}=this.props,D=v(E);return(0,t.jsx)(s.n1,{contain:!0,restoreFocus:!0,autoFocus:!0,children:(0,t.jsxs)("div",{tabIndex:-1,className:D.colorPickerPopover,children:[(0,t.jsxs)("div",{className:D.colorPickerPopoverTabs,children:[(0,t.jsx)("button",{className:this.getTabClassName("palette"),onClick:this.onTabChange("palette"),type:"button",children:"Colors"}),(0,t.jsx)("button",{className:this.getTabClassName("spectrum"),onClick:this.onTabChange("spectrum"),type:"button",children:"Custom"}),this.renderCustomPickerTabs()]}),(0,t.jsx)("div",{className:D.colorPickerPopoverContent,children:this.renderPicker()})]})})}}const x=(0,g.cV)(y);x.displayName="ColorPickerPopover";const v=(0,i.N)(P=>({colorPickerPopover:(0,n.css)({borderRadius:P.shape.radius.default,boxShadow:P.shadows.z3,background:P.colors.background.primary,border:`1px solid ${P.colors.border.weak}`,".ColorPickerPopover__tab":{width:"50%",textAlign:"center",padding:P.spacing(1,0),background:P.colors.background.secondary,color:P.colors.text.secondary,fontSize:P.typography.bodySmall.fontSize,cursor:"pointer",border:"none","&:focus:not(:focus-visible)":{outline:"none",boxShadow:"none"},":focus-visible":{position:"relative"}},".ColorPickerPopover__tab--active":{color:P.colors.text.primary,fontWeight:P.typography.fontWeightMedium,background:P.colors.background.primary}}),colorPickerPopoverContent:(0,n.css)({width:"246px",fontSize:P.typography.bodySmall.fontSize,minHeight:"184px",padding:P.spacing(1),display:"flex",flexDirection:"column"}),colorPickerPopoverTabs:(0,n.css)({display:"flex",width:"100%",borderRadius:`${P.shape.radius.default} ${P.shape.radius.default} 0 0`})}))},83876:(G,R,e)=>{"use strict";e.d(R,{h:()=>l,q:()=>d});var t=e(74848),n=e(32196),s=e(95382),a=e(96540),r=e(84140),g=e(13544),i=e(40845),l=(h=>(h.Small="small",h.Large="large",h))(l||{});const d=a.forwardRef(({color:h,label:o,variant:m="small",isSelected:u,"aria-label":p,...f},y)=>{const x=(0,i.$j)(),{isFocusVisible:v,focusProps:P}=(0,s.o)(),E=c(x,m,h,v,u),D=!!o,C=p||o;return(0,t.jsxs)("div",{ref:y,className:E.wrapper,"data-testid":g.Tp.components.ColorSwatch.name,...f,children:[D&&(0,t.jsx)("span",{className:E.label,children:o}),(0,t.jsx)("button",{className:E.swatch,...P,"aria-label":C?`${C} color`:"Pick a color",type:"button"})]})}),c=(h,o,m,u,p)=>{const f=(0,r.A)(m),x=o==="small"?"16px":"32px";let v="none";return f.getAlpha()<.1&&(v=`2px solid ${h.colors.border.medium}`),{wrapper:(0,n.css)({display:"flex",alignItems:"center",cursor:"pointer"}),label:(0,n.css)({marginRight:h.spacing(1)}),swatch:(0,n.css)({width:x,height:x,background:`${m}`,border:v,borderRadius:h.shape.radius.circle,outlineOffset:"1px",outline:u?`2px solid  ${h.colors.primary.main}`:"none",boxShadow:p?`inset 0 0 0 2px ${m}, inset 0 0 0 4px ${h.colors.getContrastText(m)}`:"none",[h.transitions.handleMotion("no-preference")]:{transition:h.transitions.create(["transform"],{duration:h.transitions.duration.short})},"&:hover":{transform:"scale(1.1)"},"@media (forced-colors: active)":{forcedColorAdjust:"none"}})}};d.displayName="ColorSwatch"},70104:(G,R,e)=>{"use strict";e.d(R,{o:()=>g,t:()=>i});var t=e(74848),n=e(40845),s=e(14186),a=e(15292),r=e(70045);const g=l=>{const{yaxis:d,onToggleAxis:c,color:h,...o}=l,m=c?{yaxis:{name:"Y-Axis",tabComponent(){return(0,t.jsx)(s.I,{labelWidth:20,label:"Use right y-axis",children:(0,t.jsx)(a.K,{value:d===2,label:"Use right y-axis",onChange:c})})}}}:void 0;return(0,t.jsx)(r.$,{...o,color:h||"#000000",customPickers:m})},i=(0,n.cV)(g)},95151:(G,R,e)=>{"use strict";e.d(R,{$:()=>h,A:()=>o});var t=e(74848),n=e(32196),s=e(96540),a=e(7612),r=e(65229),g=e(84140),i=e(23596),l=e(40845),d=e(36314);const c=({color:m,onChange:u})=>{const[p,f]=(0,s.useState)(m);(0,r.A)(P=>{u(i.MV.asHexString(y.visualization.getColorByName(P)))},500,[p]);const y=(0,l.$j)(),x=(0,l.of)(h),v=(0,s.useMemo)(()=>p.startsWith("rgba")?p:(0,g.A)(y.visualization.getColorByName(m)).toRgbString(),[p,y,m]);return(0,t.jsxs)("div",{className:x.wrapper,children:[(0,t.jsx)(a.p9,{className:x.root,color:v,onChange:f}),(0,t.jsx)(d.A,{theme:y,color:v,onChange:f,className:x.colorInput})]})},h=m=>({wrapper:(0,n.css)({flexGrow:1}),root:(0,n.css)({"&.react-colorful":{width:"auto"},".react-colorful":{"&__saturation":{borderRadius:`${m.shape.radius.default} ${m.shape.radius.default} 0 0`},"&__alpha":{borderRadius:`0 0 ${m.shape.radius.default} ${m.shape.radius.default}`},"&__alpha, &__hue":{height:m.spacing(2),position:"relative"},"&__pointer":{height:m.spacing(2),width:m.spacing(2)}}}),colorInput:(0,n.css)({marginTop:m.spacing(2)})}),o=c},55014:(G,R,e)=>{"use strict";e.d(R,{G:()=>D});var t=e(74848),n=e(32196),s=e(72181),a=e(76698),r=e(96540),g=e(40845),i=e(76412),l=e(14578),d=e(51440),c=e(10354);const h=400,o=C=>({menuClosed:(0,n.css)({display:"none"}),menu:(0,n.css)({label:"grafana-select-menu",background:C.components.dropdown.background,boxShadow:C.shadows.z3,zIndex:C.zIndex.dropdown,maxHeight:h,overflowY:"auto",position:"relative"}),menuUlContainer:(0,n.css)({label:"grafana-select-menu-ul-container",listStyle:"none"}),option:(0,n.css)({label:"grafana-select-option",padding:"8px",position:"absolute",display:"flex",alignItems:"center",flexDirection:"row",flexShrink:0,whiteSpace:"nowrap",width:"100%",overflow:"hidden",cursor:"pointer","&:hover":{background:C.colors.action.hover,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${C.colors.primary.border}`}}}),optionBody:(0,n.css)({label:"grafana-select-option-body",display:"flex",fontWeight:C.typography.fontWeightMedium,flexDirection:"column",flexGrow:1,overflow:"hidden"}),optionLabel:(0,n.css)({label:"grafana-select-option-label",textOverflow:"ellipsis",overflow:"hidden"}),optionDescription:(0,n.css)({label:"grafana-select-option-description",fontWeight:"normal",fontSize:C.typography.bodySmall.fontSize,color:C.colors.text.secondary,lineHeight:C.typography.body.lineHeight,textOverflow:"ellipsis",overflow:"hidden"}),optionFocused:(0,n.css)({label:"grafana-select-option-focused",top:0,background:C.colors.action.focus,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${C.colors.primary.border}`}}),optionSelected:(0,n.css)({background:C.colors.action.selected,"&::before":{backgroundImage:C.colors.gradients.brandVertical,borderRadius:C.shape.radius.default,content:'" "',display:"block",height:"100%",position:"absolute",width:C.spacing(.5),left:0,top:0}}),clear:(0,n.css)({label:"grafana-select-clear",cursor:"pointer","&:hover":{color:C.colors.text.primary}})});var m=e(34743),u=e(83505),p=e(46885);const f=100,y=7.3;function x(){return 45}const v=(C,b,T)=>{const S=(0,r.useRef)(null),O=(0,r.useRef)(null),[M,I]=(0,r.useState)(void 0),[L,B]=(0,r.useState)(void 0),j=[(0,m.UU)({crossAxis:!0,boundary:document.body}),(0,m.Ej)({apply({availableWidth:U}){B(U)}})],A={reference:S.current,floating:O.current},{floatingStyles:K}=(0,u.we)({strategy:"fixed",open:T,placement:"bottom-start",middleware:j,elements:A,whileElementsMounted:p.ll});(0,r.useEffect)(()=>{if(b===null)return;const U=b?.startIndex,F=b?.endIndex;if(!(typeof U>"u"||typeof F>"u")){if(U===0||U%f===0&&U>=f){let V=0;const w=Math.min(C.length,F+f);for(let z=U;z<w;z++)V=Math.max(V,C[z].label.length);I(V*y)}else if(F%f===0&&F>=f){let V=0;const w=Math.max(0,U-f);for(let z=w;z<F;z++)V=Math.max(V,C[z].label.length);I(V*y)}}},[C,b,I]);const W={...K,width:M,maxWidth:L,minWidth:S.current?.offsetWidth};return{inputRef:S,floatingRef:O,floatStyles:W}};function P(C){return C?.label??C?.value.toString()??""}function E(C){const b=C.toLowerCase();return T=>!C||T?.label?.toLowerCase().includes(b)||T?.value?.toString().toLowerCase().includes(b)}const D=({options:C,onChange:b,value:T,isClearable:S=!1,createCustomValue:O=!1,id:M,width:I,"aria-labelledby":L,...B})=>{const[j,A]=(0,r.useState)(C),K=(0,r.useMemo)(()=>{if(T===null)return null;const de=C.findIndex(oe=>oe.value===T);return de===-1?null:de},[C,T]),W=(0,r.useMemo)(()=>K!==null?C[K]:T!==null?{label:T.toString(),value:T}:null,[K,C,T]),U=`downshift-${(0,r.useId)().replace(/:/g,"--")}-menu`,F=`downshift-${(0,r.useId)().replace(/:/g,"--")}-label`,V=(0,g.of)(o),w={count:j.length,getScrollElement:()=>te.current,estimateSize:x,overscan:4},z=(0,s.Te)(w),{getInputProps:N,getMenuProps:H,getItemProps:Q,isOpen:X,highlightedIndex:ee,setInputValue:Z,openMenu:q,closeMenu:ae,selectItem:k}=(0,a.Bp)({menuId:U,labelId:F,inputId:M,items:j,itemToString:P,selectedItem:W,onSelectedItemChange:({selectedItem:de})=>{b(de)},defaultHighlightedIndex:K??0,scrollIntoView:()=>{},onInputValueChange:({inputValue:de})=>{const oe=C.filter(E(de));if(O&&de&&oe.findIndex(J=>J.label===de)===-1){const J={label:de,value:de,description:(0,i.t)("combobox.custom-value.create","Create custom value")};A([...oe,J]);return}else A(oe)},onIsOpenChange:({isOpen:de})=>{if(de){A(C);return}},onHighlightedIndexChange:({highlightedIndex:de,type:oe})=>{oe!==a.Bp.stateChangeTypes.MenuMouseLeave&&z.scrollToIndex(de)}}),{inputRef:se,floatingRef:te,floatStyles:ne}=v(j,z.range,X),le=(0,r.useCallback)(()=>{Z(W?.label??T?.toString()??"")},[W,Z,T]),re=I==="auto"?d.D:c.p;return(0,t.jsxs)("div",{children:[(0,t.jsx)(re,{width:I==="auto"?void 0:I,suffix:(0,t.jsxs)(t.Fragment,{children:[!!T&&T===W?.value&&S&&(0,t.jsx)(l.I,{name:"times",className:V.clear,title:(0,i.t)("combobox.clear.title","Clear value"),tabIndex:0,role:"button",onClick:()=>{k(null)},onKeyDown:de=>{(de.key==="Enter"||de.key===" ")&&k(null)}}),(0,t.jsx)(l.I,{name:X?"search":"angle-down",onClick:()=>{X?ae():q()}})]}),...B,...N({ref:se,onChange:()=>{},onBlur:le,"aria-labelledby":L})}),(0,t.jsx)("div",{className:(0,n.cx)(V.menu,!X&&V.menuClosed),style:{...ne},...H({ref:te,"aria-labelledby":L}),children:X&&(0,t.jsx)("ul",{style:{height:z.getTotalSize()},className:V.menuUlContainer,children:z.getVirtualItems().map(de=>(0,t.jsx)("li",{"data-index":de.index,className:(0,n.cx)(V.option,W&&j[de.index].value===W.value&&V.optionSelected,ee===de.index&&V.optionFocused),style:{height:de.size,transform:`translateY(${de.start}px)`},...Q({item:j[de.index],index:de.index}),children:(0,t.jsxs)("div",{className:V.optionBody,children:[(0,t.jsx)("span",{className:V.optionLabel,children:j[de.index].label}),j[de.index].description&&(0,t.jsx)("span",{className:V.optionDescription,children:j[de.index].description})]})},j[de.index].value+j[de.index].label))})})]})}},82702:(G,R,e)=>{"use strict";e.d(R,{Z:()=>g});var t=e(74848),n=e(32196),s=e(96540),a=e(40845),r=e(55852);const g=({children:l,className:d,closeOnConfirm:c,confirmText:h="Save",confirmVariant:o="primary",disabled:m=!1,onCancel:u,onClick:p,onConfirm:f,size:y="md"})=>{const x=(0,s.useRef)(null),v=(0,s.useRef)(null),[P,E]=(0,s.useState)(!1),[D,C]=(0,s.useState)(!1),b=(0,a.of)(i);(0,s.useEffect)(()=>{P?(v.current?.focus(),C(!0)):D&&(x.current?.focus(),C(!1))},[D,P]);const T=B=>{B&&B.preventDefault(),E(!0),p?.()},S=B=>{B&&B.preventDefault(),E(!1),x.current?.focus(),u?.()},O=B=>{B&&B.preventDefault(),f?.(),c&&E(!1)},M=(0,n.cx)(d,b.mainButton,{[b.mainButtonHide]:P}),I=(0,n.cx)(b.confirmButton,{[b.confirmButtonHide]:!P}),L=(0,n.cx)(b.confirmButtonContainer,{[b.confirmButtonContainerHide]:!P});return(0,t.jsxs)("div",{className:b.container,children:[(0,t.jsx)("span",{className:M,children:typeof l=="string"?(0,t.jsx)(r.$n,{disabled:m,size:y,fill:"text",onClick:T,ref:x,children:l}):s.cloneElement(l,{disabled:m,onClick:T,ref:x})}),(0,t.jsx)("div",{className:L,children:(0,t.jsxs)("span",{className:I,children:[(0,t.jsx)(r.$n,{size:y,variant:o,onClick:O,ref:v,children:h}),(0,t.jsx)(r.$n,{size:y,fill:"text",onClick:S,children:"Cancel"})]})})]})};g.displayName="ConfirmButton";const i=l=>({container:(0,n.css)({alignItems:"center",display:"flex",justifyContent:"flex-end",position:"relative"}),mainButton:(0,n.css)({opacity:1,[l.transitions.handleMotion("no-preference")]:{transition:l.transitions.create(["opacity"],{duration:l.transitions.duration.shortest,easing:l.transitions.easing.easeOut})},zIndex:2}),mainButtonHide:(0,n.css)({opacity:0,[l.transitions.handleMotion("no-preference")]:{transition:l.transitions.create(["opacity","visibility"],{duration:l.transitions.duration.shortest,easing:l.transitions.easing.easeIn})},visibility:"hidden",zIndex:0}),confirmButtonContainer:(0,n.css)({overflow:"visible",position:"absolute",pointerEvents:"all",right:0}),confirmButtonContainerHide:(0,n.css)({overflow:"hidden",pointerEvents:"none"}),confirmButton:(0,n.css)({alignItems:"flex-start",background:l.colors.background.primary,display:"flex",opacity:1,transform:"translateX(0)",[l.transitions.handleMotion("no-preference")]:{transition:l.transitions.create(["opacity","transform"],{duration:l.transitions.duration.shortest,easing:l.transitions.easing.easeOut})},zIndex:1}),confirmButtonHide:(0,n.css)({opacity:0,transform:"translateX(100%)",[l.transitions.handleMotion("no-preference")]:{transition:l.transitions.create(["opacity","transform","visibility"],{duration:l.transitions.duration.shortest,easing:l.transitions.easing.easeIn})},visibility:"hidden"})})},91605:(G,R,e)=>{"use strict";e.d(R,{e:()=>a});var t=e(74848),n=e(55852),s=e(82702);const a=({size:r,disabled:g,onConfirm:i,"aria-label":l,closeOnConfirm:d})=>(0,t.jsx)(s.Z,{confirmText:"Delete",confirmVariant:"destructive",size:r||"md",disabled:g,onConfirm:i,closeOnConfirm:d,children:(0,t.jsx)(n.$n,{"aria-label":l,variant:"destructive",icon:"times",size:r||"sm"})})},45014:(G,R,e)=>{"use strict";e.d(R,{k:()=>h});var t=e(74848),n=e(32196),s=e(96540),a=e(49785),r=e(13544),g=e(40845),i=e(55852),l=e(88575),d=e(10354),c=e(67061);const h=({body:m,confirmPromptText:u,confirmButtonLabel:p,confirmButtonVariant:f,dismissButtonVariant:y,dismissButtonLabel:x,onConfirm:v,onDismiss:P,onAlternative:E,alternativeButtonLabel:D,description:C,justifyButtons:b="flex-end",disabled:T})=>{const[S,O]=(0,s.useState)(T),M=(0,g.of)(o),I=(0,s.useRef)(null),L=A=>{O(u?.toLowerCase().localeCompare(A.currentTarget.value.toLowerCase())!==0)};(0,s.useEffect)(()=>{I.current?.focus()},[]),(0,s.useEffect)(()=>{O(T?!0:!!u)},[u,T]);const B=async()=>{T===void 0&&O(!0);try{await v()}finally{T===void 0&&O(!1)}},{handleSubmit:j}=(0,a.mN)();return(0,t.jsxs)("form",{onSubmit:j(B),children:[(0,t.jsxs)("div",{className:M.text,children:[m,C?(0,t.jsx)("div",{className:M.description,children:C}):null,u?(0,t.jsx)("div",{className:M.confirmationInput,children:(0,t.jsx)(c.B,{alignItems:"flex-start",children:(0,t.jsx)(l.D,{disabled:T,children:(0,t.jsx)(d.p,{placeholder:`Type "${u}" to confirm`,onChange:L})})})}):null]}),(0,t.jsx)("div",{className:M.buttonsContainer,children:(0,t.jsxs)(c.B,{justifyContent:b,gap:2,wrap:"wrap",children:[(0,t.jsx)(i.$n,{variant:y,onClick:P,fill:"outline",children:x}),(0,t.jsx)(i.$n,{type:"submit",variant:f,disabled:S,ref:I,"data-testid":r.Tp.pages.ConfirmModal.delete,children:p}),E?(0,t.jsx)(i.$n,{variant:"primary",onClick:E,children:D}):null]})})]})},o=m=>({text:(0,n.css)({fontSize:m.typography.h5.fontSize,color:m.colors.text.primary}),description:(0,n.css)({fontSize:m.typography.body.fontSize}),confirmationInput:(0,n.css)({paddingTop:m.spacing(1)}),buttonsContainer:(0,n.css)({paddingTop:m.spacing(3)})})},96374:(G,R,e)=>{"use strict";e.d(R,{u:()=>g});var t=e(74848),n=e(32196),s=e(40845),a=e(37390),r=e(45014);const g=({isOpen:l,title:d,body:c,description:h,confirmText:o,confirmVariant:m="destructive",confirmationText:u,dismissText:p="Cancel",dismissVariant:f="secondary",alternativeText:y,modalClass:x,icon:v="exclamation-triangle",onConfirm:P,onDismiss:E,onAlternative:D,confirmButtonVariant:C="destructive",disabled:b})=>{const T=(0,s.of)(i);return(0,t.jsx)(a.a,{className:(0,n.cx)(T.modal,x),title:d,icon:v,isOpen:l,onDismiss:E,children:(0,t.jsx)(r.k,{body:c,description:h,confirmButtonLabel:o,dismissButtonLabel:p,dismissButtonVariant:f,confirmPromptText:u,alternativeButtonLabel:y,confirmButtonVariant:C,onConfirm:P,onDismiss:E,onAlternative:D,disabled:b})})},i=()=>({modal:(0,n.css)({width:"500px"})})},28122:(G,R,e)=>{"use strict";e.d(R,{t:()=>i});var t=e(74848),n=e(96540),s=e(29647),a=e(13544),r=e(38138),g=e(17464);const i=n.memo(({x:l,y:d,onClose:c,focusOnOpen:h=!0,renderMenuItems:o,renderHeader:m})=>{const u=(0,n.useRef)(null),[p,f]=(0,n.useState)({});(0,n.useLayoutEffect)(()=>{const E=u.current;if(E){const D=E.getBoundingClientRect(),C=5,b={right:window.innerWidth<l+D.width,bottom:window.innerHeight<d+D.height+C};f({position:"fixed",left:b.right?l-D.width-C:l-C,top:Math.max(0,b.bottom?d-D.height-C:d+C)})}},[l,d]),(0,s.A)(u,()=>{c?.()});const y=m?.(),x=o?.(),v=E=>{h&&E(0)},P=E=>{E.key==="Escape"&&(E.preventDefault(),E.stopPropagation(),c?.())};return(0,t.jsx)(g.ZL,{children:(0,t.jsx)(r.W,{header:y,ref:u,style:p,ariaLabel:a.Tp.components.Menu.MenuComponent("Context"),onOpen:v,onClick:c,onKeyDown:P,children:x})})});i.displayName="ContextMenu"},51686:(G,R,e)=>{"use strict";e.d(R,{n:()=>a});var t=e(74848),n=e(96540),s=e(28122);const a=({children:r,renderMenuItems:g,focusOnOpen:i=!0})=>{const[l,d]=(0,n.useState)(!1),[c,h]=(0,n.useState)({x:0,y:0});return(0,t.jsxs)(t.Fragment,{children:[r({openMenu:o=>{d(!0),h({x:o.pageX,y:o.pageY-window.scrollY})}}),l&&(0,t.jsx)(s.t,{onClose:()=>d(!1),x:c.x,y:c.y,renderMenuItems:g,focusOnOpen:i})]})}},14689:(G,R,e)=>{"use strict";e.d(R,{R:()=>s});var t=e(74848),n=e(55852);function s({link:a,buttonProps:r}){return(0,t.jsx)("a",{href:a.href,target:a.target,rel:"noreferrer",onClick:a.onClick?g=>{!(g.ctrlKey||g.metaKey||g.shiftKey)&&a.onClick&&(g.preventDefault(),a.onClick(g))}:void 0,children:(0,t.jsx)(n.$n,{icon:a.target==="_blank"?"external-link-alt":void 0,variant:"primary",size:"sm",...r,children:a.title})})}},64078:(G,R,e)=>{"use strict";e.d(R,{l:()=>S});var t=e(74848),n=e(32196),s=e(34743),a=e(83505),r=e(46885),g=e(28848),i=e.n(g),l=e(96540),d=e(80292),c=e(52845),h=e(29317),o=e(91890),m=e(6709),u=e(41781),p=e(40845),f=e(72307),y=e(40276),x=e(10354),v=e(17464),P=e(43538);class E{getBoundingClientRect(){const I=window.getSelection(),L=I&&I.anchorNode;return L&&L.parentElement?L.parentElement.getBoundingClientRect():{top:0,left:0,bottom:0,right:0,width:0,height:0,x:0,y:0,toJSON:()=>{}}}get clientWidth(){return this.getBoundingClientRect().width}get clientHeight(){return this.getBoundingClientRect().height}}const D=(M,I)=>M-I*Math.floor(M/I),C={builtInVariable:{pattern:/(\${\S+?})/}},b=[(0,u.D)({onlyIn:M=>"type"in M&&M.type==="code_block",getSyntax:()=>"links"},{...i().languages,links:C})],T=M=>({input:(0,x.n)({theme:M,invalid:!1}).input,editor:(0,n.css)({".token.builtInVariable":{color:M.colors.success.text},".token.variable":{color:M.colors.primary.text}}),suggestionsWrapper:(0,n.css)({boxShadow:M.shadows.z2}),wrapperOverrides:(0,n.css)({width:"100%","> .slate-query-field__wrapper":{padding:0,backgroundColor:"transparent",border:"none"}})}),S=(0,l.memo)(({value:M,onChange:I,suggestions:L,placeholder:B="http://your-grafana.com/d/000000010/annotations"})=>{const j=(0,l.useRef)(null),A=(0,p.of)(T),[K,W]=(0,l.useState)(!1),[U,F]=(0,l.useState)(0),[V,w]=(0,l.useState)((0,f.mO)(M)),z=(0,d.A)(V),[N,H]=(0,l.useState)(0),Q=[(0,s.cY)(({rects:ne})=>({alignmentAxis:ne.reference.width})),(0,s.UU)({fallbackAxisSideDirection:"start",crossAxis:!1,boundary:document.body}),(0,s.BN)()],{refs:X,floatingStyles:ee}=(0,a.we)({open:K,placement:"bottom-start",onOpenChange:W,middleware:Q,whileElementsMounted:r.ll,strategy:"fixed"}),Z=(0,l.useRef)({showingSuggestions:K,suggestions:L,suggestionsIndex:U,linkUrl:V,onChange:I});Z.current={showingSuggestions:K,suggestions:L,suggestionsIndex:U,linkUrl:V,onChange:I};const q=(0,l.useRef)(null);(0,l.useEffect)(()=>{H(O(q.current,U))},[U]);const ae=l.useCallback((ne,le)=>{if(!Z.current.showingSuggestions){if(ne.key==="="||ne.key==="$"||ne.keyCode===32&&ne.ctrlKey){const re=new E;return X.setReference(re),W(!0)}return le()}switch(ne.key){case"Backspace":Z.current.linkUrl.focusText.getText().length===1&&le();case"Escape":return W(!1),F(0);case"Enter":return ne.preventDefault(),se(Z.current.suggestions[Z.current.suggestionsIndex]);case"ArrowDown":case"ArrowUp":ne.preventDefault();const re=ne.key==="ArrowDown"?1:-1;return F(de=>D(de+re,Z.current.suggestions.length));default:return le()}},[]);(0,l.useEffect)(()=>{z&&z.selection.isFocused&&!V.selection.isFocused&&Z.current.onChange(c.default.serialize(V))},[V,z]);const k=l.useCallback(({value:ne})=>{w(ne)},[]),se=(ne,le=j.current)=>{const de=te()==="$";ne.origin!==o.$0.Template||ne.value===m.c.includeVars?le.insertText(`${de?"":"$"}{${ne.value}}`):le.insertText(`${de?"":"$"}{${ne.value}:queryparam}`),w(le.value),W(!1),F(0),Z.current.onChange(c.default.serialize(le.value))},te=()=>{const ne=document.getElementById("data-link-input");let le="",re,de;return window.getSelection&&(re=window.getSelection(),re&&re.rangeCount>0&&(de=re.getRangeAt(0).cloneRange(),de.collapse(!0),de.setStart(ne,0),le=de.toString().slice(-1))),le};return(0,t.jsx)("div",{className:A.wrapperOverrides,children:(0,t.jsx)("div",{className:"slate-query-field__wrapper",children:(0,t.jsxs)("div",{id:"data-link-input",className:"slate-query-field",children:[K&&(0,t.jsx)(v.ZL,{children:(0,t.jsx)("div",{ref:X.setFloating,style:ee,children:(0,t.jsx)(y.A,{scrollTop:N,autoHeightMax:"300px",setScrollTop:({scrollTop:ne})=>H(ne),children:(0,t.jsx)(P.k,{activeRef:q,suggestions:Z.current.suggestions,onSuggestionSelect:se,onClose:()=>W(!1),activeIndex:U})})})}),(0,t.jsx)(h.Editor,{schema:f.yx,ref:j,placeholder:B,value:Z.current.linkUrl,onChange:k,onKeyDown:(ne,le,re)=>ae(ne,re),plugins:b,className:(0,n.cx)(A.editor,A.input,(0,n.css)({padding:"3px 8px"}))})]})})})});S.displayName="DataLinkInput";function O(M,I){return(M?.clientHeight??0)*I}},43538:(G,R,e)=>{"use strict";e.d(R,{k:()=>c});var t=e(74848),n=e(96540),s=e(32196),a=e(2543),r=e.n(a),g=e(37151),i=e(40845),l=e(33552);const d=o=>({list:(0,s.css)({borderBottom:`1px solid ${o.colors.border.weak}`,"&:last-child":{border:"none"}}),wrapper:(0,s.css)({background:o.colors.background.primary,width:"250px"}),item:(0,s.css)({background:"none",padding:"2px 8px",userSelect:"none",color:o.colors.text.primary,cursor:"pointer","&:hover":{background:o.colors.action.hover}}),label:(0,s.css)({color:o.colors.text.secondary}),activeItem:(0,s.css)({background:o.colors.background.secondary,"&:hover":{background:o.colors.background.secondary}}),itemValue:(0,s.css)({fontFamily:o.typography.fontFamilyMonospace,fontSize:o.typography.size.sm})}),c=({suggestions:o,...m})=>{const u=(0,n.useRef)(null);(0,g.A)(u,()=>{m.onClose&&m.onClose()});const p=(0,n.useMemo)(()=>(0,a.groupBy)(o,y=>y.origin),[o]),f=(0,i.of)(d);return(0,t.jsx)("div",{role:"menu",ref:u,className:f.wrapper,children:Object.keys(p).map((y,x)=>{const v=x===0?0:Object.keys(p).reduce((P,E,D)=>D>=x?P:P+p[E].length,0);return(0,n.createElement)(h,{...m,suggestions:p[y],label:`${(0,a.capitalize)(y)}`,activeIndex:m.activeIndex,activeIndexOffset:v,key:y})})})};c.displayName="DataLinkSuggestions";const h=n.memo(({activeIndex:o,activeIndexOffset:m,label:u,onClose:p,onSuggestionSelect:f,suggestions:y,activeRef:x})=>{const v=(0,i.of)(d);return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(l.B,{className:v.list,items:y,renderItem:(P,E)=>{const D=E+m===o;return(0,t.jsx)("div",{role:"menuitem",tabIndex:0,className:(0,s.cx)(v.item,D&&v.activeItem),ref:D?x:void 0,onClick:()=>{f(P)},title:P.documentation,children:(0,t.jsxs)("span",{className:v.itemValue,children:[(0,t.jsx)("span",{className:v.label,children:u})," ",P.label]})})}})})});h.displayName="DataLinkSuggestionsList"},59796:(G,R,e)=>{"use strict";e.d(R,{e:()=>l});var t=e(74848),n=e(32196),s=e(13544),a=e(14555),r=e(51686),g=e(59093),i=e(64539);const l=({children:d,links:c,style:h})=>{const o=[{items:(0,a.J)(c),label:"Data links"}],m=o[0].items.length,u=()=>o.map((f,y)=>(0,t.jsx)(g.r,{label:f.label,children:(f.items||[]).map((x,v)=>(0,t.jsx)(i.D,{url:x.url,label:x.label,target:x.target,icon:x.icon,active:x.active,onClick:x.onClick},`${f.label}-${y}-${v}}`))},`${f.label}${y}`)),p=(0,n.css)({cursor:"context-menu"});if(m>1)return(0,t.jsx)(r.n,{renderMenuItems:u,children:({openMenu:f})=>d({openMenu:f,targetClassName:p})});{const f=c()[0];return(0,t.jsx)("a",{href:f.href,onClick:f.onClick,target:f.target,title:f.title,style:{...h,overflow:"hidden",display:"flex"},"data-testid":s.Tp.components.DataLinksContextMenu.singleLink,children:d({})})}}},64919:(G,R,e)=>{"use strict";e.d(R,{e:()=>D});var t=e(74848),n=e(32196),s=e(91076),a=e(2543),r=e(96540),g=e(40845),i=e(55852),l=e(37390),d=e(14555),c=e(88575),h=e(10354),o=e(15292),m=e(64078);const u=b=>({listItem:(0,n.css)({marginBottom:b.spacing()}),infoText:(0,n.css)({paddingBottom:b.spacing(2),marginLeft:"66px",color:b.colors.text.secondary})}),p=(0,r.memo)(({index:b,value:T,onChange:S,suggestions:O,isLast:M})=>{const I=(0,g.of)(u),L=(A,K)=>{S(b,{...T,url:A},K)},B=A=>{S(b,{...T,title:A.target.value})},j=()=>{S(b,{...T,targetBlank:!T.targetBlank})};return(0,t.jsxs)("div",{className:I.listItem,children:[(0,t.jsx)(c.D,{label:"Title",children:(0,t.jsx)(h.p,{value:T.title,onChange:B,placeholder:"Show details"})}),(0,t.jsx)(c.D,{label:"URL",invalid:(0,d.F)(T.url),error:"Data link is an Explore URL in a deprecated format. Please visit the URL to be redirected, and edit this data link to use that URL.",children:(0,t.jsx)(m.l,{value:T.url,onChange:L,suggestions:O})}),(0,t.jsx)(c.D,{label:"Open in new tab",children:(0,t.jsx)(o.d,{value:T.targetBlank||!1,onChange:j})}),M&&(0,t.jsx)("div",{className:I.infoText,children:"With data links you can reference data variables like series name, labels and values. Type CMD+Space, CTRL+Space, or $ to open variable suggestions."})]})});p.displayName="DataLinkEditor";const f=({link:b,index:T,getSuggestions:S,onSave:O,onCancel:M})=>{const[I,L]=(0,r.useState)(b);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p,{value:I,index:T,isLast:!1,suggestions:S(),onChange:(B,j)=>{L(j)}}),(0,t.jsxs)(l.a.ButtonRow,{children:[(0,t.jsx)(i.$n,{variant:"secondary",onClick:()=>M(T),fill:"outline",children:"Cancel"}),(0,t.jsx)(i.$n,{onClick:()=>{O(T,I)},children:"Save"})]})]})};var y=e(72093),x=e(14578),v=e(29158);const P=({link:b,onEdit:T,onRemove:S,index:O,itemKey:M})=>{const I=(0,g.of)(E),{title:L="",url:B=""}=b,j=L.trim()!=="",A=B.trim()!=="",K=(0,d.F)(B);return(0,t.jsx)(s.sx,{draggableId:M,index:O,children:W=>(0,t.jsx)(t.Fragment,{children:(0,r.createElement)("div",{className:(0,n.cx)(I.wrapper,I.dragRow),ref:W.innerRef,...W.draggableProps,key:O},(0,t.jsxs)("div",{className:I.linkDetails,children:[(0,t.jsx)("div",{className:(0,n.cx)(I.url,!A&&I.notConfigured,K&&I.errored),children:j?L:"Data link title not provided"}),(0,t.jsx)("div",{className:(0,n.cx)(I.url,!A&&I.notConfigured,K&&I.errored),title:B,children:A?B:"Data link url not provided"}),K&&(0,t.jsx)(y.P,{children:"Explore data link may not work in the future. Please edit."})]}),(0,t.jsxs)("div",{className:I.icons,children:[(0,t.jsx)(v.K,{name:"pen",onClick:T,className:I.icon,tooltip:"Edit data link"}),(0,t.jsx)(v.K,{name:"trash-alt",onClick:S,className:I.icon,tooltip:"Remove data link"}),(0,t.jsx)("div",{className:I.dragIcon,...W.dragHandleProps,children:(0,t.jsx)(x.I,{name:"draggabledots",size:"lg"})})]}))})},M)},E=b=>({wrapper:(0,n.css)({display:"flex",flexGrow:1,alignItems:"center",justifyContent:"space-between",width:"100%",padding:"5px 0 5px 10px",borderRadius:b.shape.radius.default,background:b.colors.background.secondary,gap:8}),linkDetails:(0,n.css)({display:"flex",flexDirection:"column",flexGrow:1,maxWidth:"calc(100% - 100px)"}),errored:(0,n.css)({color:b.colors.error.text,fontStyle:"italic"}),notConfigured:(0,n.css)({fontStyle:"italic"}),title:(0,n.css)({color:b.colors.text.primary,fontSize:b.typography.size.sm,fontWeight:b.typography.fontWeightMedium}),url:(0,n.css)({color:b.colors.text.secondary,fontSize:b.typography.size.sm,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}),dragRow:(0,n.css)({position:"relative"}),icons:(0,n.css)({display:"flex",padding:6,alignItems:"center",gap:8}),dragIcon:(0,n.css)({cursor:"grab",color:b.colors.text.secondary,margin:b.spacing(0,.5)}),icon:(0,n.css)({color:b.colors.text.secondary})}),D=({links:b,onChange:T,getSuggestions:S,data:O,showOneClick:M=!1})=>{const[I,L]=(0,r.useState)(null),[B,j]=(0,r.useState)(!1),[A,K]=(0,r.useState)([]);(0,r.useEffect)(()=>{K(b??[])},[b]);const W=(0,g.of)(C),U=I!==null,F=(Q,X)=>{if(B)if(X.title.trim()===""&&X.url.trim()===""){j(!1),L(null);return}else L(null),j(!1);const ee=(0,a.cloneDeep)(A);ee[Q]=X,T(ee),L(null)},V=()=>{let Q=(0,a.cloneDeep)(A);L(Q.length),j(!0)},w=Q=>{B&&j(!1),L(null)},z=Q=>{const X=(0,a.cloneDeep)(A);X.splice(Q,1),T(X)},N=Q=>{if(!b||!Q.destination)return;const X=(0,a.cloneDeep)(A),ee=X[Q.source.index];X.splice(Q.source.index,1),X.splice(Q.destination.index,0,ee),K(X),T(X)},H=(Q,X)=>M?(0,t.jsxs)("div",{className:W.oneClickOverlay,children:[(0,t.jsx)("span",{className:W.oneClickSpan,children:"One-click link"}),Q]},X):Q;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.JY,{onDragEnd:N,children:(0,t.jsx)(s.gL,{droppableId:"sortable-links",direction:"vertical",children:Q=>(0,t.jsxs)("div",{className:W.wrapper,ref:Q.innerRef,...Q.droppableProps,children:[A.map((X,ee)=>{const Z=`${X.title}/${ee}`,q=(0,t.jsx)("div",{className:W.itemWrapper,children:(0,t.jsx)(P,{index:ee,link:X,onChange:F,onEdit:()=>L(ee),onRemove:()=>z(ee),data:O,itemKey:Z},Z)},Z);return ee===0?H(q,Z):q}),Q.placeholder]})})}),U&&I!==null&&(0,t.jsx)(l.a,{title:"Edit link",isOpen:!0,closeOnBackdropClick:!1,onDismiss:()=>{w(I)},children:(0,t.jsx)(f,{index:I,link:B?{title:"",url:""}:A[I],data:O,onSave:F,onCancel:w,getSuggestions:S})}),(0,t.jsx)(i.$n,{size:"sm",icon:"plus",onClick:V,variant:"secondary",className:W.button,children:"Add link"})]})},C=b=>({wrapper:(0,n.css)({marginBottom:b.spacing(2),display:"flex",flexDirection:"column"}),oneClickOverlay:(0,n.css)({height:"auto",border:`2px dashed ${b.colors.text.link}`,fontSize:10,color:b.colors.text.primary,marginBottom:b.spacing(1)}),oneClickSpan:(0,n.css)({padding:10,marginBottom:-10,display:"inline-block"}),itemWrapper:(0,n.css)({padding:"4px 8px 8px 8px"}),button:(0,n.css)({marginLeft:b.spacing(1)})})},28623:(G,R,e)=>{"use strict";e.d(R,{K:()=>i});var t=e(74848),n=e(55852),s=e(14186),a=e(39268),r=e(10354),g=e(21744);const i=({hasCert:l,label:d,onChange:c,onClick:h,placeholder:o})=>(0,t.jsxs)(a.C,{children:[(0,t.jsx)(s.I,{label:d,labelWidth:14,disabled:l,children:l?(0,t.jsx)(r.p,{type:"text",value:"configured",width:24}):(0,t.jsx)(g.f,{rows:7,onChange:c,placeholder:o,required:!0})}),l&&(0,t.jsx)(n.$n,{variant:"secondary",onClick:h,style:{marginLeft:4},children:"Reset"})]})},11184:(G,R,e)=>{"use strict";e.d(R,{P:()=>m});var t=e(74848),n=e(32196),s=e(2543),a=e.n(s),r=e(96540),g=e(40845),i=e(55852),l=e(90090),d=e(14578),c=e(56286);const h=()=>({layout:(0,n.css)({display:"flex",alignItems:"center",marginBottom:"4px","> *":{marginLeft:"4px",marginBottom:0,height:"100%","&:first-child, &:last-child":{marginLeft:0}}})}),o=({header:p,onBlur:f,onChange:y,onRemove:x,onReset:v})=>{const P=(0,g.of)(h);return(0,t.jsxs)("div",{className:P.layout,children:[(0,t.jsx)(l.z,{label:"Header",name:"name",placeholder:"X-Custom-Header",labelWidth:5,value:p.name||"",onChange:E=>y({...p,name:E.target.value}),onBlur:f}),(0,t.jsx)(c.L,{label:"Value","aria-label":"Value",name:"value",isConfigured:p.configured,value:p.value,labelWidth:5,inputWidth:p.configured?11:12,placeholder:"Header Value",onReset:()=>v(p.id),onChange:E=>y({...p,value:E.target.value}),onBlur:f}),(0,t.jsx)(i.$n,{type:"button","aria-label":"Remove header",variant:"secondary",size:"xs",onClick:E=>x(p.id),children:(0,t.jsx)(d.I,{name:"trash-alt"})})]})};o.displayName="CustomHeaderRow";class m extends r.PureComponent{constructor(f){super(f),this.state={headers:[]},this.updateSettings=()=>{const{headers:P}=this.state,E=Object.fromEntries(Object.entries(this.props.dataSourceConfig.jsonData).filter(([C,b])=>!C.startsWith("httpHeaderName"))),D=Object.fromEntries(Object.entries(this.props.dataSourceConfig.secureJsonData||{}).filter(([C,b])=>!C.startsWith("httpHeaderValue")));for(const[C,b]of P.entries())E[`httpHeaderName${C+1}`]=b.name,b.configured||(D[`httpHeaderValue${C+1}`]=b.value);this.props.onChange({...this.props.dataSourceConfig,jsonData:E,secureJsonData:D})},this.onHeaderAdd=()=>{this.setState(P=>({headers:[...P.headers,{id:(0,s.uniqueId)(),name:"",value:"",configured:!1}]}))},this.onHeaderChange=(P,E)=>{this.setState(({headers:D})=>({headers:D.map((C,b)=>P!==b?C:{...E})}))},this.onHeaderReset=P=>{this.setState(({headers:E})=>({headers:E.map((D,C)=>D.id!==P?D:{...D,value:"",configured:!1})}))},this.onHeaderRemove=P=>{this.setState(({headers:E})=>({headers:E.filter(D=>D.id!==P)}),this.updateSettings)};const{jsonData:y,secureJsonData:x,secureJsonFields:v}=this.props.dataSourceConfig;this.state={headers:Object.keys(y).sort().filter(P=>P.startsWith("httpHeaderName")).map((P,E)=>({id:(0,s.uniqueId)(),name:y[P],value:x!==void 0?x[P]:"",configured:v&&v[`httpHeaderValue${E+1}`]||!1}))}}render(){const{headers:f}=this.state,{dataSourceConfig:y}=this.props;return(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)("h6",{children:"Custom HTTP Headers"})}),(0,t.jsx)("div",{children:f.map((x,v)=>(0,t.jsx)(o,{header:x,onChange:P=>{this.onHeaderChange(v,P)},onBlur:this.updateSettings,onRemove:this.onHeaderRemove,onReset:this.onHeaderReset},x.id))}),!y.readOnly&&(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(i.$n,{variant:"secondary",icon:"plus",type:"button",onClick:x=>{this.onHeaderAdd()},children:"Add header"})})]})}}var u=null},91409:(G,R,e)=>{"use strict";e.d(R,{t:()=>O});var t=e(74848),n=e(32196),s=e(96540),a=e(13544),r=e(40845),g=e(42418),i=e(90090),l=e(38894),d=e(14186),c=e(91634),h=e(14578),o=e(90182),m=e(15292),u=e(79924),p=e(94753),f=e(56286);const y=({dataSourceConfig:M,onChange:I})=>{const L=M.secureJsonData?M.secureJsonData.basicAuthPassword:"",B=()=>{I({...M,secureJsonData:{...M.secureJsonData,basicAuthPassword:""},secureJsonFields:{...M.secureJsonFields,basicAuthPassword:!1}})},j=A=>{I({...M,secureJsonData:{...M.secureJsonData,basicAuthPassword:A.currentTarget.value}})};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.I,{disabled:M.readOnly,children:(0,t.jsx)(i.z,{label:"User",labelWidth:10,inputWidth:18,placeholder:"user",value:M.basicAuthUser,onChange:A=>I({...M,basicAuthUser:A.currentTarget.value})})}),(0,t.jsx)(d.I,{disabled:M.readOnly,children:(0,t.jsx)(f.L,{isConfigured:!!(M.secureJsonFields&&M.secureJsonFields.basicAuthPassword),value:L||"",inputWidth:18,labelWidth:10,onReset:B,onChange:j})})]})};var x=e(11184);const v=26,P=({dataSourceConfig:M,onChange:I,showForwardOAuthIdentityOption:L=!0})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"gf-form-inline",children:[(0,t.jsx)(d.I,{label:"TLS Client Auth",labelWidth:v,disabled:M.readOnly,children:(0,t.jsx)(m.K,{id:"http-settings-tls-client-auth",value:M.jsonData.tlsAuth||!1,onChange:B=>I({...M.jsonData,tlsAuth:B.currentTarget.checked})})}),(0,t.jsx)(d.I,{label:"With CA Cert",tooltip:"Needed for verifying self-signed TLS Certs",labelWidth:v,disabled:M.readOnly,children:(0,t.jsx)(m.K,{id:"http-settings-ca-cert",value:M.jsonData.tlsAuthWithCACert||!1,onChange:B=>I({...M.jsonData,tlsAuthWithCACert:B.currentTarget.checked})})})]}),(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsx)(d.I,{label:"Skip TLS Verify",labelWidth:v,disabled:M.readOnly,children:(0,t.jsx)(m.K,{id:"http-settings-skip-tls-verify",value:M.jsonData.tlsSkipVerify||!1,onChange:B=>I({...M.jsonData,tlsSkipVerify:B.currentTarget.checked})})})}),L&&(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsx)(d.I,{label:"Forward OAuth Identity",tooltip:"Forward the user's upstream OAuth identity to the data source (Their access token gets passed along).",labelWidth:v,disabled:M.readOnly,children:(0,t.jsx)(m.K,{id:"http-settings-forward-oauth",value:M.jsonData.oauthPassThru||!1,onChange:B=>I({...M.jsonData,oauthPassThru:B.currentTarget.checked})})})})]});var E=e(17081),D=e(95180);const C=[{label:"Server (default)",value:"proxy"},{label:"Browser",value:"direct"}],b={label:"Server (default)",value:"proxy"},T=()=>(0,t.jsxs)(g.F,{severity:"info",title:"",topSpacing:3,children:[(0,t.jsxs)("p",{children:["Access mode controls how requests to the data source will be handled.",(0,t.jsxs)("strong",{children:["\xA0",(0,t.jsx)("i",{children:"Server"})]})," ","should be the preferred way if nothing else is stated."]}),(0,t.jsx)(p.E,{weight:"medium",children:"Server access mode (Default):"}),(0,t.jsx)("p",{children:"All requests will be made from the browser to Grafana backend/server which in turn will forward the requests to the data source and by that circumvent possible Cross-Origin Resource Sharing (CORS) requirements. The URL needs to be accessible from the grafana backend/server if you select this access mode."}),(0,t.jsx)(p.E,{weight:"medium",children:"Browser access mode:"}),(0,t.jsx)("p",{children:"All requests will be made from the browser directly to the data source and may be subject to Cross-Origin Resource Sharing (CORS) requirements. The URL needs to be accessible from the browser if you select this access mode."})]}),S=26,O=M=>{const{defaultUrl:I,dataSourceConfig:L,onChange:B,showAccessOptions:j,sigV4AuthToggleEnabled:A,showForwardOAuthIdentityOption:K,azureAuthSettings:W,renderSigV4Editor:U,secureSocksDSProxyEnabled:F,urlLabel:V,urlDocs:w}=M,[z,N]=(0,s.useState)(!1),[H,Q]=(0,s.useState)(!1),X=(0,r.$j)();let ee;const Z=(0,s.useCallback)(le=>{const re=W?.azureAuthSupported&&W.getAzureAuthEnabled(L)||!1;if(Q(re),re){const de=L.jsonData.oauthPassThru!==void 0?L.jsonData.oauthPassThru:!1;le={...le,jsonData:{...L.jsonData,oauthPassThru:re?!1:de}}}B({...L,...le})},[W,L,B]);switch(L.access){case"direct":ee=(0,t.jsxs)(t.Fragment,{children:["Your access method is ",(0,t.jsx)("em",{children:"Browser"}),", this means the URL needs to be accessible from the browser.",w]});break;case"proxy":ee=(0,t.jsxs)(t.Fragment,{children:["Your access method is ",(0,t.jsx)("em",{children:"Server"}),", this means the URL needs to be accessible from the grafana backend/server.",w]});break;default:ee=(0,t.jsxs)(t.Fragment,{children:["Specify a complete HTTP URL (for example http://your_server:8080) ",w]})}const q=(0,t.jsx)(o.l6,{"aria-label":"Access",className:"width-20 gf-form-input",options:C,value:C.filter(le=>le.value===L.access)[0]||b,onChange:le=>Z({access:le.value}),disabled:L.readOnly}),ae=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/.test(L.url),k=(0,n.css)({boxShadow:`inset 0 0px 5px ${X.v1.palette.red}`}),se=(0,n.cx)({"width-20":!0,[k]:!ae}),te=(0,s.useId)(),ne=(0,t.jsx)(c.p,{id:te,className:se,placeholder:I,value:L.url,"data-testid":a.Tp.components.DataSource.DataSourceHttpSettings.urlInput,onChange:le=>Z({url:le.currentTarget.value}),disabled:L.readOnly});return(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{className:"page-heading",children:"HTTP"}),(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(i.z,{interactive:!!w,label:V??"URL",labelWidth:13,tooltip:ee,inputEl:ne})}),j&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"gf-form-inline",children:[(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(i.z,{label:"Access",labelWidth:13,inputWidth:20,inputEl:q})}),(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsxs)("button",{type:"button",className:"gf-form-label query-keyword pointer",onClick:()=>N(le=>!le),children:["Help\xA0",(0,t.jsx)(h.I,{name:z?"angle-down":"angle-right",style:{marginBottom:0}})]})})]}),z&&(0,t.jsx)(T,{})]}),L.access==="proxy"&&(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(l.I,{width:13,tooltip:"Grafana proxy deletes forwarded cookies by default. Specify cookies by name that should be forwarded to the data source.",children:"Allowed cookies"}),(0,t.jsx)(u.u,{tags:L.jsonData.keepCookies,width:40,onChange:le=>Z({jsonData:{...L.jsonData,keepCookies:le}}),disabled:L.readOnly})]}),(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(i.z,{label:"Timeout",type:"number",labelWidth:13,inputWidth:20,tooltip:"HTTP request timeout in seconds",placeholder:"Timeout in seconds","aria-label":"Timeout in seconds",value:L.jsonData.timeout,onChange:le=>{Z({jsonData:{...L.jsonData,timeout:parseInt(le.currentTarget.value,10)}})},disabled:L.readOnly})})]})]})]}),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{className:"page-heading",children:"Auth"}),(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsxs)("div",{className:"gf-form-inline",children:[(0,t.jsx)(d.I,{label:"Basic auth",labelWidth:S,disabled:L.readOnly,children:(0,t.jsx)(m.K,{id:"http-settings-basic-auth",value:L.basicAuth,onChange:le=>{Z({basicAuth:le.currentTarget.checked})}})}),(0,t.jsx)(d.I,{label:"With Credentials",tooltip:"Whether credentials such as cookies or auth headers should be sent with cross-site requests.",labelWidth:S,disabled:L.readOnly,children:(0,t.jsx)(m.K,{id:"http-settings-with-credentials",value:L.withCredentials,onChange:le=>{Z({withCredentials:le.currentTarget.checked})}})})]}),W?.azureAuthSupported&&(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsx)(d.I,{label:"Azure Authentication",tooltip:"Use Azure authentication for Azure endpoint.",labelWidth:S,disabled:L.readOnly,children:(0,t.jsx)(m.K,{id:"http-settings-azure-auth",value:H,onChange:le=>{Z(W.setAzureAuthEnabled(L,le.currentTarget.checked))}})})}),A&&(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsx)(d.I,{label:"SigV4 auth",labelWidth:S,disabled:L.readOnly,children:(0,t.jsx)(m.K,{id:"http-settings-sigv4-auth",value:L.jsonData.sigV4Auth||!1,onChange:le=>{Z({jsonData:{...L.jsonData,sigV4Auth:le.currentTarget.checked}})}})})}),L.access==="proxy"&&(0,t.jsx)(P,{dataSourceConfig:L,onChange:le=>Z({jsonData:le}),showForwardOAuthIdentityOption:H?!1:K})]}),L.basicAuth&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h6",{children:"Basic Auth Details"}),(0,t.jsx)("div",{className:"gf-form-group",children:(0,t.jsx)(y,{...M})})]}),W?.azureAuthSupported&&H&&W.azureSettingsUI&&(0,t.jsx)(W.azureSettingsUI,{dataSourceConfig:L,onChange:B}),L.jsonData.sigV4Auth&&A&&U,(L.jsonData.tlsAuth||L.jsonData.tlsAuthWithCACert)&&(0,t.jsx)(D.j,{dataSourceConfig:L,onChange:B}),L.access==="proxy"&&(0,t.jsx)(x.P,{dataSourceConfig:L,onChange:B})]}),F&&(0,t.jsx)(E.Y,{options:L,onOptionsChange:B})]})}},17081:(G,R,e)=>{"use strict";e.d(R,{Y:()=>a});var t=e(74848),n=e(15292),s=e(14186);function a({options:r,onOptionsChange:g}){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{className:"page-heading",children:"Secure Socks Proxy"}),(0,t.jsx)("div",{className:"gf-form-group",children:(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(s.I,{labelWidth:26,label:"Enabled",tooltip:"Connect to this datasource via the secure socks proxy.",children:(0,t.jsx)(n.K,{value:r.jsonData.enableSecureSocksProxy??!1,onChange:i=>g({...r,jsonData:{...r.jsonData,enableSecureSocksProxy:i.currentTarget.checked}})})})})})})]})}},95180:(G,R,e)=>{"use strict";e.d(R,{j:()=>i});var t=e(74848),n=e(32196),s=e(90090),a=e(14578),r=e(56034),g=e(28623);const i=({dataSourceConfig:l,onChange:d})=>{const c=l.secureJsonFields&&l.secureJsonFields.tlsCACert,h=l.secureJsonFields&&l.secureJsonFields.tlsClientCert,o=l.secureJsonFields&&l.secureJsonFields.tlsClientKey,m=l.jsonData&&l.jsonData.serverName,u=y=>x=>{x.preventDefault();const v={...l.secureJsonFields};v[y]=!1,d({...l,secureJsonFields:v})},p=y=>x=>{const v={...l.secureJsonData};v[y]=x.currentTarget.value,d({...l,secureJsonData:v})},f=y=>{const x={...l.jsonData,serverName:y.currentTarget.value};d({...l,jsonData:x})};return(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsxs)("div",{className:(0,n.cx)("gf-form",(0,n.css)({alignItems:"baseline"})),children:[(0,t.jsx)("h6",{children:"TLS/SSL Auth Details"}),(0,t.jsx)(r.m,{placement:"right-end",content:"TLS/SSL Certs are encrypted and stored in the Grafana database.",theme:"info",children:(0,t.jsx)(a.I,{name:"info-circle",size:"xs",style:{marginLeft:"10px"}})})]}),(0,t.jsxs)("div",{children:[l.jsonData.tlsAuthWithCACert&&(0,t.jsx)(g.K,{hasCert:!!c,onChange:p("tlsCACert"),placeholder:"Begins with -----BEGIN CERTIFICATE-----",label:"CA Cert",onClick:u("tlsCACert")}),l.jsonData.tlsAuth&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(s.z,{label:"ServerName",labelWidth:7,inputWidth:30,placeholder:"domain.example.com",value:m&&l.jsonData.serverName,onChange:f})}),(0,t.jsx)(g.K,{hasCert:!!h,label:"Client Cert",onChange:p("tlsClientCert"),placeholder:"Begins with -----BEGIN CERTIFICATE-----",onClick:u("tlsClientCert")}),(0,t.jsx)(g.K,{hasCert:!!o,label:"Client Key",placeholder:"Begins with -----BEGIN RSA PRIVATE KEY-----",onChange:p("tlsClientKey"),onClick:u("tlsClientKey")})]})]})]})}},56181:(G,R,e)=>{"use strict";e.d(R,{l:()=>d});var t=e(74848),n=e(32196),s=e(96540),a=e(21497),r=e(40845),g=e(8866),i=e(14578),l=e(72265);const d=(0,s.memo)(o=>{const m=(0,r.of)(h),{isOpen:u,onClose:p}=o;return u?(0,t.jsx)(g.N,{useCapture:!0,includeButtonPress:!1,onClick:p,children:(0,t.jsx)("div",{className:m.modal,"data-testid":"date-picker",children:(0,t.jsx)(c,{...o})})}):null});d.displayName="DatePicker";const c=(0,s.memo)(({value:o,minDate:m,maxDate:u,onChange:p})=>{const f=(0,r.of)(l.h2);return(0,t.jsx)(a.Ay,{className:f.body,tileClassName:f.title,value:o||new Date,minDate:m,maxDate:u,nextLabel:(0,t.jsx)(i.I,{name:"angle-right"}),prevLabel:(0,t.jsx)(i.I,{name:"angle-left"}),onChange:y=>{y&&!Array.isArray(y)&&p(y)},locale:"en"})});c.displayName="Body";const h=o=>({modal:(0,n.css)({zIndex:o.zIndex.modal,boxShadow:o.shadows.z3,backgroundColor:o.colors.background.primary,border:`1px solid ${o.colors.border.weak}`,borderTopLeftRadius:o.shape.radius.default,borderBottomLeftRadius:o.shape.radius.default,"button:disabled":{color:o.colors.text.disabled}})})},98239:(G,R,e)=>{"use strict";e.d(R,{l:()=>o});var t=e(74848),n=e(32196),s=e(34743),a=e(83505),r=e(46885),g=e(96540),i=e(47232),l=e(40845),d=e(10354),c=e(56181);const h=u=>(0,i.KQ)(u).format("L"),o=({value:u,minDate:p,maxDate:f,onChange:y,closeOnSelect:x,placeholder:v="Date",...P})=>{const[E,D]=(0,g.useState)(!1),C=(0,l.of)(m),b=[(0,s.UU)({crossAxis:!1,boundary:document.body}),(0,s.BN)()],{context:T,refs:S,floatingStyles:O}=(0,a.we)({open:E,placement:"bottom-start",onOpenChange:D,middleware:b,whileElementsMounted:r.ll,strategy:"fixed"}),M=(0,a.kp)(T),I=(0,a.s9)(T),{getReferenceProps:L,getFloatingProps:B}=(0,a.bv)([I,M]);return(0,t.jsxs)("div",{className:C.container,children:[(0,t.jsx)(d.p,{ref:S.setReference,type:"text",autoComplete:"off",placeholder:v,value:u&&h(u),onChange:j=>{j.target.value===""&&y("")},className:C.input,...P,...L()}),(0,t.jsx)("div",{className:C.popover,ref:S.setFloating,style:O,...B(),children:(0,t.jsx)(c.l,{isOpen:E,value:u&&typeof u!="string"?u:(0,i.KQ)().toDate(),minDate:p,maxDate:f,onChange:j=>{y(j),x&&D(!1)},onClose:()=>D(!1)})})]})},m=u=>({container:(0,n.css)({position:"relative"}),input:(0,n.css)({"input[type='date']::-webkit-inner-spin-button, input[type='date']::-webkit-calendar-picker-indicator":{display:"none",WebkitAppearance:"none"}}),popover:(0,n.css)({zIndex:u.zIndex.tooltip})})},63383:(G,R,e)=>{"use strict";e.d(R,{K:()=>M});var t=e(74848),n=e(32196),s=e(34743),a=e(83505),r=e(46885),g=e(18828),i=e(85690),l=e(93225),d=e(96540),c=e(21497),h=e(49045),o=e(72724),m=e(47232),u=e(1933),p=e(13390),f=e(40845),y=e(55852),x=e(14186),v=e(14578),P=e(10354),E=e(67061),D=e(88448),C=e(17464),b=e(66070),T=e(72265),S=e(47619),O=e(99225);const M=({date:j,maxDate:A,minDate:K,label:W,onChange:U,disabledHours:F,disabledMinutes:V,disabledSeconds:w,timeZone:z,showSeconds:N=!0,clearable:H=!1})=>{const[Q,X]=(0,d.useState)(!1),ee=(0,d.useRef)(null),{overlayProps:Z,underlayProps:q}=(0,l.e)({onClose:()=>X(!1),isDismissable:!0,isOpen:Q,shouldCloseOnInteractOutside:ce=>{const pe=document.getElementsByClassName(b.i)[0];return!(pe&&pe.contains(ce))}},ee),{dialogProps:ae}=(0,g.s)({},ee),k=(0,f.$j)(),{modalBackdrop:se}=(0,f.of)(D.o),te=(0,h.A)(`(min-width: ${k.breakpoints.values.lg}px)`),ne=(0,f.of)(B),le=[(0,s.UU)({crossAxis:!1,boundary:document.body}),(0,s.BN)()],{refs:re,floatingStyles:de}=(0,a.we)({open:Q,placement:"bottom-start",onOpenChange:X,middleware:le,whileElementsMounted:r.ll,strategy:"fixed"}),oe=(0,d.useCallback)(ce=>{X(!1),U(ce)},[U]),J=(0,d.useCallback)(ce=>{ce.preventDefault(),X(!0)},[X]);return(0,t.jsxs)("div",{"data-testid":"date-time-picker",style:{position:"relative"},children:[(0,t.jsx)(I,{date:j,onChange:U,isFullscreen:te,onOpen:J,label:W,ref:re.setReference,showSeconds:N,clearable:H,timeZone:z}),Q?te?(0,t.jsx)(C.ZL,{children:(0,t.jsx)(i.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("div",{ref:ee,...Z,...ae,children:(0,t.jsx)(L,{date:j,onChange:oe,isFullscreen:!0,onClose:()=>X(!1),maxDate:A,minDate:K,ref:re.setFloating,style:de,showSeconds:N,disabledHours:F,disabledMinutes:V,disabledSeconds:w,timeZone:z})})})}):(0,t.jsxs)(C.ZL,{children:[(0,t.jsx)("div",{className:se,...q}),(0,t.jsx)(i.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("div",{ref:ee,...Z,...ae,children:(0,t.jsx)("div",{className:ne.modal,children:(0,t.jsx)(L,{date:j,maxDate:A,minDate:K,onChange:oe,isFullscreen:!1,onClose:()=>X(!1),showSeconds:N,disabledHours:F,disabledMinutes:V,disabledSeconds:w,timeZone:z})})})})]}):null]})},I=d.forwardRef(({date:j,label:A,onChange:K,onOpen:W,timeZone:U,showSeconds:F=!0,clearable:V=!1},w)=>{const z=(0,f.of)(B),N=F?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD HH:mm",[H,Q]=(0,d.useState)(()=>({value:j?(0,o.LE)(j,{timeZone:U}):V?"":(0,o.LE)((0,m.KQ)(),{timeZone:U}),invalid:!1}));(0,d.useEffect)(()=>{if(j){const ae=(0,o.LE)(j,{format:N,timeZone:U});Q({invalid:!(0,S.f)(ae),value:(0,m.Ar)(j)?ae:j})}},[j,N,U]);const X=(0,d.useCallback)(ae=>{const k=!(0,S.f)(ae.currentTarget.value);Q({value:ae.currentTarget.value,invalid:k})},[]),ee=(0,d.useCallback)(()=>{if(!H.invalid&&H.value){const ae=(0,m.oZ)((0,u.O)({timeZone:U}),H.value);K(ae)}},[H,K,U]),Z=(0,d.useCallback)(()=>{Q({value:"",invalid:!1}),K()},[K]),q=(0,t.jsx)(y.$n,{"aria-label":"Time picker",icon:"calendar-alt",variant:"secondary",onClick:W});return(0,t.jsx)(x.I,{label:A,invalid:!!(H.value&&H.invalid),className:z.field,children:(0,t.jsx)(P.p,{onChange:X,addonAfter:q,value:H.value,onBlur:ee,"data-testid":p.X.DateTimePicker.input,placeholder:"Select date/time",ref:w,suffix:V&&H.value&&(0,t.jsx)(v.I,{name:"times",className:z.clearIcon,onClick:Z})})})});I.displayName="DateTimeInput";const L=d.forwardRef(({date:j,onClose:A,onChange:K,isFullscreen:W,maxDate:U,minDate:F,style:V,showSeconds:w=!0,disabledHours:z,disabledMinutes:N,disabledSeconds:H,timeZone:Q},X)=>{const ee=(0,f.of)(T.h2),Z=(0,f.of)(B),[q,ae]=(0,d.useState)(()=>j&&j.isValid()?(0,m.oZ)((0,u.O)({timeZone:Q}),j):(0,m.oZ)((0,u.O)({timeZone:Q}),new Date)),[k,se]=(0,d.useState)(()=>j&&j.isValid()?(0,O.Q)(j.toDate(),(0,u.O)({timeZone:Q})):(0,O.Q)(new Date,(0,u.O)({timeZone:Q}))),te=(0,d.useCallback)(re=>{re&&!Array.isArray(re)&&se(re)},[]),ne=(0,d.useCallback)(re=>{ae(re)},[]),le=()=>{const re=(0,m.KQ)(q);re.set("date",k.getDate()),re.set("month",k.getMonth()),re.set("year",k.getFullYear()),K(re)};return(0,t.jsxs)("div",{className:(0,n.cx)(Z.container,{[Z.fullScreen]:W}),style:V,ref:X,children:[(0,t.jsx)(c.Ay,{next2Label:null,prev2Label:null,value:k,nextLabel:(0,t.jsx)(v.I,{name:"angle-right"}),nextAriaLabel:"Next month",prevLabel:(0,t.jsx)(v.I,{name:"angle-left"}),prevAriaLabel:"Previous month",onChange:te,locale:"en",className:ee.body,tileClassName:ee.title,maxDate:U,minDate:F}),(0,t.jsx)("div",{className:Z.time,children:(0,t.jsx)(b.R,{showSeconds:w,onChange:ne,value:q,disabledHours:z,disabledMinutes:N,disabledSeconds:H})}),(0,t.jsxs)(E.B,{children:[(0,t.jsx)(y.$n,{type:"button",onClick:le,children:"Apply"}),(0,t.jsx)(y.$n,{variant:"secondary",type:"button",onClick:A,children:"Cancel"})]})]})});L.displayName="DateTimeCalendar";const B=j=>({container:(0,n.css)({padding:j.spacing(1),border:`1px ${j.colors.border.weak} solid`,borderRadius:j.shape.radius.default,backgroundColor:j.colors.background.primary,zIndex:j.zIndex.modal}),fullScreen:(0,n.css)({position:"absolute"}),time:(0,n.css)({marginBottom:j.spacing(2)}),modal:(0,n.css)({position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:j.zIndex.modal,maxWidth:"280px"}),clearIcon:(0,n.css)({cursor:"pointer"}),field:(0,n.css)({marginBottom:0,width:"100%"})})},5308:(G,R,e)=>{"use strict";e.d(R,{N:()=>B});var t=e(74848),n=e(32196),s=e(34743),a=e(83505),r=e(46885),g=e(18828),i=e(85690),l=e(93225),d=e(96540),c=e(40845),h=e(76412),o=e(55852),m=e(40276),u=e(88575),p=e(14578),f=e(10354),y=e(56034),x=e(64998),v=e(11752),P=e(32432);const E=/^now$|^now(\-|\+)(\d{1,10})([wdhms])$/,D=U=>({from:S(U.from),to:S(U.to)}),C=U=>{const F=M(U.from),V=M(U.to);return{from:F,to:V,display:`${F} to ${V}`}},b=(U,F=Date.now())=>T(U)?S(U)>Math.ceil(F/1e3)?{isValid:!1,errorMessage:"Can not enter value prior to January 1, 1970."}:{isValid:!0}:{isValid:!1,errorMessage:"Value not in relative time format."},T=U=>E.test(U),S=U=>{const F=E.exec(U);if(!F||F.length!==4)return 0;const[,V,w,z]=F,N=parseInt(w,10);if(isNaN(N))return 0;const H=N*O[z];return V==="+"?H*-1:H},O={w:604800,d:86400,h:3600,m:60,s:1},M=U=>{if(U===0)return"now";const F=Math.abs(U);return U<0?`now+${I(F)}`:`now-${I(F)}`};function I(U){const F=[{unit:"w",value:604800},{unit:"d",value:86400},{unit:"h",value:3600},{unit:"m",value:60},{unit:"s",value:1}];for(const{unit:w,value:z}of F)if(U%z===0)return`${U/z}${w}`;const V=F[F.length-1];return`${U}${V.unit}`}const L=P.o.filter(U=>T(U.from));function B(U){const{timeRange:F,onChange:V}=U,[w,z]=(0,d.useState)(!1),N=(0,d.useCallback)(()=>z(!1),[]),H=C(F),[Q,X]=(0,d.useState)({value:H.from,validation:b(H.from)}),[ee,Z]=(0,d.useState)({value:H.to,validation:b(H.to)}),q=(0,d.useRef)(null),{overlayProps:ae,underlayProps:k}=(0,l.e)({onClose:()=>z(!1),isDismissable:!0,isOpen:w},q),{dialogProps:se}=(0,g.s)({},q),te=[(0,s.UU)({crossAxis:!1,boundary:document.body}),(0,s.BN)()],{context:ne,refs:le,floatingStyles:re}=(0,a.we)({open:w,placement:"bottom-start",onOpenChange:z,middleware:te,whileElementsMounted:r.ll,strategy:"fixed"}),de=(0,a.kp)(ne),oe=(0,a.s9)(ne),{getReferenceProps:J,getFloatingProps:ce}=(0,a.bv)([oe,de]),pe=(0,c.of)(K(Q.validation.errorMessage,ee.validation.errorMessage)),xe=Se=>{const ye=D(Se);ye&&(N(),X({...Q,value:Se.from}),Z({...ee,value:Se.to}),V(ye))},fe=(0,d.useCallback)(Se=>{Se.stopPropagation(),Se.preventDefault(),z(!w)},[w]),Ee=Se=>{if(Se.preventDefault(),!ee.validation.isValid||!Q.validation.isValid)return;const ye=D({from:Q.value,to:ee.value,display:""});ye&&(V(ye),z(!1))};return(0,t.jsxs)("div",{className:pe.container,children:[(0,t.jsxs)("button",{ref:le.setReference,className:pe.pickerInput,type:"button",onClick:fe,...J(),children:[(0,t.jsx)("span",{className:pe.clockIcon,children:(0,t.jsx)(p.I,{name:"clock-nine"})}),(0,t.jsxs)("span",{children:[H.from," to ",H.to]}),(0,t.jsx)("span",{className:pe.caretIcon,children:(0,t.jsx)(p.I,{name:w?"angle-up":"angle-down",size:"lg"})})]}),w&&(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{role:"presentation",className:pe.backdrop,...k}),(0,t.jsx)(i.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("div",{ref:q,...ae,...se,children:(0,t.jsx)("div",{className:pe.content,ref:le.setFloating,style:re,...ce(),children:(0,t.jsxs)("div",{className:pe.body,children:[(0,t.jsx)(m.A,{className:pe.leftSide,hideHorizontalTrack:!0,children:(0,t.jsx)(v.l,{title:(0,h.t)("time-picker.time-range.example-title","Example time ranges"),options:L,onChange:xe,value:H})}),(0,t.jsxs)("div",{className:pe.rightSide,children:[(0,t.jsx)("div",{className:pe.title,children:(0,t.jsx)(x.e,{children:(0,t.jsx)(y.m,{content:(0,t.jsx)(j,{}),placement:"bottom",theme:"info",children:(0,t.jsx)("div",{children:(0,t.jsxs)(h.x,{i18nKey:"time-picker.time-range.specify",children:["Specify time range ",(0,t.jsx)(p.I,{name:"info-circle"})]})})})})}),(0,t.jsx)(u.D,{label:"From",invalid:!Q.validation.isValid,error:Q.validation.errorMessage,children:(0,t.jsx)(f.p,{onClick:Se=>Se.stopPropagation(),onBlur:()=>X({...Q,validation:b(Q.value)}),onChange:Se=>X({...Q,value:Se.currentTarget.value}),value:Q.value})}),(0,t.jsx)(u.D,{label:"To",invalid:!ee.validation.isValid,error:ee.validation.errorMessage,children:(0,t.jsx)(f.p,{onClick:Se=>Se.stopPropagation(),onBlur:()=>Z({...ee,validation:b(ee.value)}),onChange:Se=>Z({...ee,value:Se.currentTarget.value}),value:ee.value})}),(0,t.jsx)(o.$n,{"aria-label":"TimePicker submit button",onClick:Ee,children:"Apply time range"})]})]})})})})]})]})}const j=()=>{const U=(0,c.of)(A);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:U.supported,children:["Supported formats: ",(0,t.jsx)("code",{className:U.tooltip,children:"now-[digit]s/m/h/d/w"})]}),(0,t.jsx)("div",{children:"Example: to select a time range from 10 minutes ago to now"}),(0,t.jsx)("code",{className:U.tooltip,children:"From: now-10m To: now"}),(0,t.jsxs)("div",{className:U.link,children:["For more information see"," ",(0,t.jsxs)("a",{href:"https://grafana.com/docs/grafana/latest/dashboards/time-range-controls/",children:["docs ",(0,t.jsx)(p.I,{name:"external-link-alt"})]}),"."]})]})},A=U=>({supported:(0,n.css)({marginBottom:U.spacing(1)}),tooltip:(0,n.css)({margin:0}),link:(0,n.css)({marginTop:U.spacing(1)})}),K=(U,F)=>V=>{const w=(0,f.n)({theme:V,invalid:!1}),N=250+W(V,U)+W(V,F);return{backdrop:(0,n.css)({position:"fixed",zIndex:V.zIndex.modalBackdrop,top:0,right:0,bottom:0,left:0}),container:(0,n.css)({display:"flex",position:"relative"}),pickerInput:(0,n.cx)(w.input,w.wrapper,(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",paddingRight:0,paddingLeft:0,lineHeight:`${V.spacing.gridSize*V.components.height.md-2}px`})),caretIcon:(0,n.cx)(w.suffix,(0,n.css)({position:"relative",marginLeft:V.spacing(.5)})),clockIcon:(0,n.cx)(w.prefix,(0,n.css)({position:"relative",marginRight:V.spacing(.5)})),content:(0,n.css)({background:V.colors.background.primary,boxShadow:V.shadows.z3,position:"absolute",zIndex:V.zIndex.modal,width:"500px",top:"100%",borderRadius:V.shape.radius.default,border:`1px solid ${V.colors.border.weak}`,left:0,whiteSpace:"normal"}),body:(0,n.css)({display:"flex",height:`${N}px`}),description:(0,n.css)({color:V.colors.text.secondary,fontSize:V.typography.size.sm}),leftSide:(0,n.css)({width:"50% !important",borderRight:`1px solid ${V.colors.border.medium}`}),rightSide:(0,n.css)({width:"50%",padding:V.spacing(1)}),title:(0,n.css)({marginBottom:V.spacing(1)})}};function W(U,F){return F?F.length>34?U.spacing.gridSize*6.5:U.spacing.gridSize*4:0}},66070:(G,R,e)=>{"use strict";e.d(R,{R:()=>h,i:()=>c});var t=e(74848),n=e(32196),s=e(79770),a=e(47232),r=e(40845),g=e(16797),i=e(87266),l=e(14578),d=e(78537);const c="time-of-day-picker-panel",h=({minuteStep:u=1,showHour:p=!0,showSeconds:f=!1,onChange:y,value:x,size:v="auto",disabled:P,disabledHours:E,disabledMinutes:D,disabledSeconds:C})=>{const b=(0,r.of)(m);return(0,t.jsx)(s.A,{className:(0,n.cx)((0,i.lH)()[v],b.input),popupClassName:(0,n.cx)(b.picker,c),defaultValue:(0,a.AN)(),onChange:T=>{if((0,a.u8)(T))return y((0,a.KQ)(T))},allowEmpty:!1,showSecond:f,value:(0,a.AN)(x),showHour:p,minuteStep:u,inputIcon:(0,t.jsx)(o,{wrapperStyle:b.caretWrapper}),disabled:P,disabledHours:E,disabledMinutes:D,disabledSeconds:C})},o=({wrapperStyle:u=""})=>(0,t.jsx)("div",{className:u,children:(0,t.jsx)(l.I,{name:"angle-down"})}),m=u=>{const p=u.components.input.background,f=u.v1.palette.black,y=u.colors.background.secondary,x=u.shape.radius.default,v=u.components.input.borderColor;return{caretWrapper:(0,n.css)({position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",display:"inline-block",textAlign:"right",color:u.colors.text.secondary}),picker:(0,n.css)({".rc-time-picker-panel-select":{fontSize:"14px",backgroundColor:p,color:u.colors.text.secondary,borderColor:v,li:{outlineWidth:"2px","&.rc-time-picker-panel-select-option-selected":{backgroundColor:"inherit",border:`1px solid ${u.v1.palette.orange}`,borderRadius:x,color:u.colors.text.primary},"&:hover":{background:y,color:u.colors.text.primary},"&.rc-time-picker-panel-select-option-disabled":{color:u.colors.action.disabledText}}},".rc-time-picker-panel-inner":{boxShadow:`0px 4px 4px ${f}`,backgroundColor:p,borderColor:v,borderRadius:x,marginTop:"3px",".rc-time-picker-panel-input-wrap":{marginRight:"2px","&, .rc-time-picker-panel-input":{backgroundColor:p,paddingTop:"2px"}},".rc-time-picker-panel-combobox":{display:"flex"}}}),input:(0,n.css)({".rc-time-picker-input":{backgroundColor:p,borderRadius:x,borderColor:v,color:u.colors.text.primary,height:u.spacing(4),"&:focus":(0,g.getFocusStyles)(u),"&:disabled":{backgroundColor:u.colors.action.disabledBackground,color:u.colors.action.disabledText,border:`1px solid ${u.colors.action.disabledBackground}`,"&:focus":{boxShadow:"none"}}}})}}},54230:(G,R,e)=>{"use strict";e.d(R,{b:()=>x});var t=e(74848),n=e(32196),s=e(18828),a=e(85690),r=e(93225),g=e(96540),i=e(47232),l=e(43127),d=e(13544),c=e(40845),h=e(14578),o=e(10354),m=e(85068),u=e(3799),p=e(32432),f=e(47619);const y=()=>{},x=({value:P,onChange:E,onChangeTimeZone:D=y,clearable:C,weekStart:b,hideTimeZone:T=!0,timeZone:S="browser",placeholder:O="Select time range",isReversed:M=!0,hideQuickRanges:I=!1,disabled:L=!1,showIcon:B=!1})=>{const[j,A]=(0,g.useState)(!1),K=(0,c.of)(v,L),W=Q=>{Q.stopPropagation(),Q.preventDefault(),!L&&A(!j)},U=()=>{A(!1)},F=Q=>{U(),E(Q)},V=Q=>{Q.stopPropagation();const X=(0,i.KQ)(null),ee=(0,i.KQ)(null);E({from:X,to:ee,raw:{from:X,to:ee}})},w=(0,g.createRef)(),z=(0,g.createRef)(),{dialogProps:N}=(0,s.s)({},w),{overlayProps:H}=(0,r.e)({onClose:U,isDismissable:!0,isOpen:j,shouldCloseOnInteractOutside:Q=>!z.current?.contains(Q)},w);return(0,t.jsxs)("div",{className:K.container,children:[(0,t.jsxs)("button",{type:"button",className:K.pickerInput,"data-testid":d.Tp.components.TimePicker.openButton,onClick:W,ref:z,children:[B&&(0,t.jsx)(h.I,{name:"clock-nine",size:"sm",className:K.icon}),(0,t.jsx)(u.f,{value:P,timeZone:S,placeholder:O}),!L&&(0,t.jsxs)("span",{className:K.caretIcon,children:[(0,f.X)(P)&&C&&(0,t.jsx)(h.I,{className:K.clearIcon,name:"times",size:"lg",onClick:V}),(0,t.jsx)(h.I,{name:j?"angle-up":"angle-down",size:"lg"})]})]}),j&&(0,t.jsx)(a.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("section",{className:K.content,ref:w,...H,...N,children:(0,t.jsx)(m.r,{timeZone:S,value:(0,f.X)(P)?P:(0,l.E2)(),onChange:F,quickOptions:p.o,onChangeTimeZone:D,className:K.content,hideTimeZone:T,isReversed:M,hideQuickRanges:I,weekStart:b})})})]})},v=(P,E=!1)=>{const D=(0,o.n)({theme:P,invalid:!1});return{container:(0,n.css)({display:"flex",position:"relative"}),content:(0,n.css)({marginLeft:0,position:"absolute",top:"116%",zIndex:P.zIndex.dropdown}),pickerInput:(0,n.cx)(D.input,E&&D.inputDisabled,D.wrapper,(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",paddingRight:0,lineHeight:`${P.spacing.gridSize*4-2}px`})),caretIcon:(0,n.cx)(D.suffix,(0,n.css)({position:"relative",top:"-1px",marginLeft:P.spacing(.5)})),clearIcon:(0,n.css)({marginRight:P.spacing(.5),"&:hover":{color:P.colors.text.maxContrast}}),placeholder:(0,n.css)({color:P.colors.text.disabled,opacity:1}),icon:(0,n.css)({marginRight:P.spacing(.5)})}}},15666:(G,R,e)=>{"use strict";e.d(R,{$6:()=>P,_8:()=>C,xS:()=>D});var t=e(74848),n=e(32196),s=e(18828),a=e(85690),r=e(93225),g=e(96540),i=e(65879),l=e(72724),d=e(91410),c=e(85858),h=e(13544),o=e(40845),m=e(76412),u=e(19727),p=e(88448),f=e(27746),y=e(56034),x=e(85068),v=e(32432);function P(O){const[M,I]=(0,g.useState)(!1),{value:L,onMoveBackward:B,onMoveForward:j,onZoom:A,onError:K,timeZone:W,fiscalYearStartMonth:U,timeSyncButton:F,isSynced:V,history:w,onChangeTimeZone:z,onChangeFiscalYearStartMonth:N,hideQuickRanges:H,widthOverride:Q,isOnCanvas:X,onToolbarTimePickerClick:ee,weekStart:Z}=O,q=Ee=>{O.onChange(Ee),I(!1)};(0,g.useEffect)(()=>{M&&ee&&ee()},[M,ee]);const ae=()=>{I(Ee=>!Ee)},k=()=>{I(!1)},se=(0,g.createRef)(),te=(0,g.createRef)(),{overlayProps:ne,underlayProps:le}=(0,r.e)({onClose:k,isDismissable:!0,isOpen:M,shouldCloseOnInteractOutside:Ee=>!te.current?.contains(Ee)},se),{dialogProps:re}=(0,s.s)({},se),de=(0,o.of)(T),{modalBackdrop:oe}=(0,o.of)(p.o),J=!i.isRelativeTime(L.raw.from)||!i.isRelativeTime(L.raw.to),ce=V?"active":X?"canvas":"default",xe=L?.to?.isBefore(L.from)?"exclamation-triangle":"clock-nine",fe=b(L,W);return(0,t.jsxs)(u.e,{className:de.container,children:[J&&(0,t.jsx)(f.I,{"aria-label":(0,m.t)("time-picker.range-picker.backwards-time-aria-label","Move time range backwards"),variant:ce,onClick:B,icon:"angle-left",narrow:!0}),(0,t.jsx)(y.m,{ref:te,content:(0,t.jsx)(D,{timeRange:L,timeZone:W}),placement:"bottom",interactive:!0,children:(0,t.jsx)(f.I,{"data-testid":h.Tp.components.TimePicker.openButton,"aria-label":(0,m.t)("time-picker.range-picker.current-time-selected","Time range selected: {{currentTimeRange}}",{currentTimeRange:fe}),"aria-controls":"TimePickerContent",onClick:ae,icon:xe,isOpen:M,variant:ce,children:(0,t.jsx)(C,{...O})})}),M&&(0,t.jsxs)("div",{"data-testid":h.Tp.components.TimePicker.overlayContent,children:[(0,t.jsx)("div",{role:"presentation",className:(0,n.cx)(oe,de.backdrop),...le}),(0,t.jsx)(a.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("section",{className:de.content,ref:se,...ne,...re,children:(0,t.jsx)(x.r,{timeZone:W,fiscalYearStartMonth:U,value:L,onChange:q,quickOptions:v.o,history:w,showHistory:!0,widthOverride:Q,onChangeTimeZone:z,onChangeFiscalYearStartMonth:N,hideQuickRanges:H,onError:K,weekStart:Z})})})]}),F,J&&(0,t.jsx)(f.I,{"aria-label":(0,m.t)("time-picker.range-picker.forwards-time-aria-label","Move time range forwards"),onClick:j,icon:"angle-right",narrow:!0,variant:ce}),(0,t.jsx)(y.m,{content:E,placement:"bottom",children:(0,t.jsx)(f.I,{"aria-label":(0,m.t)("time-picker.range-picker.zoom-out-button","Zoom out time range"),onClick:A,icon:"search-minus",variant:ce})})]})}P.displayName="TimeRangePicker";const E=()=>(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(m.x,{i18nKey:"time-picker.range-picker.zoom-out-tooltip",children:["Time range zoom out ",(0,t.jsx)("br",{})," CTRL+Z"]})}),D=({timeRange:O,timeZone:M})=>{const I=(0,o.of)(S);return(0,t.jsxs)(t.Fragment,{children:[(0,l.LE)(O.from,{timeZone:M}),(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)(m.x,{i18nKey:"time-picker.range-picker.to",children:"to"})}),(0,l.LE)(O.to,{timeZone:M}),(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)("span",{className:I.utc,children:(0,d.le)(M)})})]})},C=(0,g.memo)(({hideText:O,value:M,timeZone:I})=>{const L=(0,o.of)(S);return O?null:(0,t.jsxs)("span",{className:L.container,"aria-live":"polite","aria-atomic":"true",children:[(0,t.jsx)("span",{children:b(M,I)}),(0,t.jsx)("span",{className:L.utc,children:i.describeTimeRangeAbbreviation(M,I)})]})});C.displayName="TimePickerButtonLabel";const b=(O,M)=>{const I={to:c.isMathString(O.raw.to)?O.raw.to:O.to,from:c.isMathString(O.raw.from)?O.raw.from:O.from};return i.describeTimeRange(I,M)},T=O=>({container:(0,n.css)({position:"relative",display:"flex",verticalAlign:"middle"}),backdrop:(0,n.css)({display:"none",[O.breakpoints.down("sm")]:{display:"block"}}),content:(0,n.css)({position:"absolute",right:0,top:"116%",zIndex:O.zIndex.dropdown,[O.breakpoints.down("sm")]:{position:"fixed",right:"50%",top:"50%",transform:"translate(50%, -50%)",zIndex:O.zIndex.modal}})}),S=O=>({container:(0,n.css)({display:"flex",alignItems:"center",whiteSpace:"nowrap"}),utc:(0,n.css)({color:O.v1.palette.orange,fontSize:O.typography.size.sm,paddingLeft:"6px",lineHeight:"28px",verticalAlign:"bottom",fontWeight:O.typography.fontWeightMedium})})},72265:(G,R,e)=>{"use strict";e.d(R,{h2:()=>f,nB:()=>o});var t=e(74848),n=e(32196),s=e(96540),a=e(21497),r=e(53531),g=e(40845),i=e(76412),l=e(14578),d=e(15648),c=e(99225);const h={saturday:"islamic",sunday:"gregory",monday:"iso8601"};function o({onChange:y,from:x,to:v,timeZone:P,weekStart:E}){const D=m(x,v,new Date,P),C=u(y,P),b=(0,g.of)(f),T=(0,d.r)(E);return(0,t.jsx)(a.Ay,{selectRange:!0,next2Label:null,prev2Label:null,className:b.body,tileClassName:b.title,value:D,nextLabel:(0,t.jsx)(l.I,{name:"angle-right"}),nextAriaLabel:(0,i.t)("time-picker.calendar.next-month","Next month"),prevLabel:(0,t.jsx)(l.I,{name:"angle-left"}),prevAriaLabel:(0,i.t)("time-picker.calendar.previous-month","Previous month"),onChange:C,locale:"en",calendarType:h[T]})}o.displayName="Body";function m(y,x,v=new Date,P){let E=y.isValid()?y.toDate():v,D=x.isValid()?x.toDate():v;return P&&(E=(0,c.Q)(E,P),D=(0,c.Q)(D,P)),E>D?[D,E]:[E,D]}function u(y,x){return(0,s.useCallback)(v=>{if(!Array.isArray(v))return console.error("onCalendarChange: should be run in selectRange={true}");if(v[0]&&v[1]){const P=(0,r.b)(p(v[0]),{timeZone:x}),E=(0,r.b)(p(v[1]),{timeZone:x});y(P,E)}},[y,x])}function p(y){return[y.getFullYear(),y.getMonth(),y.getDate(),y.getHours(),y.getMinutes(),y.getSeconds()]}const f=y=>{const x=".react-calendar__tile--hasActive:not(.react-calendar__tile--range)";return{title:(0,n.css)({color:y.colors.text.primary,backgroundColor:y.colors.background.primary,fontSize:y.typography.size.md,border:"1px solid transparent","&:hover, &:focus":{position:"relative"},"&:disabled":{color:y.colors.action.disabledText}}),body:(0,n.css)({zIndex:y.zIndex.modal,backgroundColor:y.colors.background.primary,width:"268px",".react-calendar__navigation":{display:"flex"},".react-calendar__navigation__label, .react-calendar__navigation__arrow, .react-calendar__navigation":{paddingTop:"4px",backgroundColor:"inherit",color:y.colors.text.primary,border:0,fontWeight:y.typography.fontWeightMedium},".react-calendar__month-view__weekdays":{backgroundColor:"inherit",textAlign:"center",color:y.colors.primary.text,abbr:{border:0,textDecoration:"none",cursor:"default",display:"block",padding:"4px 0 4px 0"}},".react-calendar__month-view__days":{backgroundColor:"inherit"},".react-calendar__tile, .react-calendar__tile--now":{marginBottom:"4px",backgroundColor:"inherit",height:"26px"},".react-calendar__navigation__label, .react-calendar__navigation > button:focus, .time-picker-calendar-tile:focus":{outline:0},[`${x}, .react-calendar__tile--active, .react-calendar__tile--active:hover`]:{color:y.colors.primary.contrastText,fontWeight:y.typography.fontWeightMedium,background:y.colors.primary.main,border:"0px"},".react-calendar__tile--rangeEnd, .react-calendar__tile--rangeStart":{padding:0,border:"0px",color:y.colors.primary.contrastText,fontWeight:y.typography.fontWeightMedium,background:y.colors.primary.main,abbr:{backgroundColor:y.colors.primary.main,borderRadius:"100px",display:"block",paddingTop:"2px",height:"26px"}},[`${x}, .react-calendar__tile--rangeStart`]:{borderTopLeftRadius:"20px",borderBottomLeftRadius:"20px"},[`${x}, .react-calendar__tile--rangeEnd`]:{borderTopRightRadius:"20px",borderBottomRightRadius:"20px"}})}}},85068:(G,R,e)=>{"use strict";e.d(R,{r:()=>oe});var t=e(74848),n=e(32196),s=e(96540),a=e(47232),r=e(65879),g=e(13544),i=e(40845),l=e(16797),d=e(76412),c=e(67647),h=e(14578),o=e(2543),m=e(91410),u=e(55852),p=e(55014),f=e(88575),y=e(63021),x=e(40675),v=e(40980),P=e(20333),E=e(79451),D=e(17624),C=e(67459),b=e(32432);const T=Me=>{const{timeZone:Ce,fiscalYearStartMonth:Ue,timestamp:Ae=Date.now(),onChangeTimeZone:we,onChangeFiscalYearStartMonth:We}=Me,[_e,at]=(0,s.useState)(!1),[ut,Tt]=(0,s.useState)("tz"),It=(0,s.useId)(),ge=(0,s.useId)(),Ie=(0,s.useId)(),ue=(0,s.useCallback)(Ne=>{Ne&&Ne.stopPropagation(),at(!_e)},[_e,at]),me=(0,i.of)(S);if(!(0,o.isString)(Ce))return null;const Pe=(0,m.QZ)(Ce,Ae);return Pe?(0,t.jsxs)("div",{children:[(0,t.jsxs)("section",{"aria-label":(0,d.t)("time-picker.footer.time-zone-selection","Time zone selection"),className:me.container,children:[(0,t.jsxs)("div",{className:me.timeZoneContainer,children:[(0,t.jsxs)("div",{className:me.timeZone,children:[(0,t.jsx)(C.U,{title:Pe.name}),(0,t.jsx)("div",{className:me.spacer}),(0,t.jsx)(E.E,{info:Pe})]}),(0,t.jsx)(D.X,{timeZone:Ce,timestamp:Ae})]}),(0,t.jsx)("div",{className:me.spacer}),(0,t.jsx)(u.$n,{"data-testid":g.Tp.components.TimeZonePicker.changeTimeSettingsButton,variant:"secondary",onClick:ue,size:"sm","aria-expanded":_e,"aria-controls":It,icon:_e?"angle-up":"angle-down",children:(0,t.jsx)(d.x,{i18nKey:"time-picker.footer.change-settings-button",children:"Change time settings"})})]}),_e?(0,t.jsxs)("div",{className:me.editContainer,id:It,children:[(0,t.jsxs)(y.U,{children:[(0,t.jsx)(x.o,{label:(0,d.t)("time-picker.footer.time-zone-option","Time zone"),active:ut==="tz",onChangeTab:()=>{Tt("tz")},"aria-controls":ge}),(0,t.jsx)(x.o,{label:(0,d.t)("time-picker.footer.fiscal-year-option","Fiscal year"),active:ut==="fy",onChangeTab:()=>{Tt("fy")},"aria-controls":Ie})]}),(0,t.jsx)(v.J,{children:ut==="tz"?(0,t.jsx)("section",{role:"tabpanel","data-testid":g.Tp.components.TimeZonePicker.containerV2,id:ge,className:(0,n.cx)(me.timeZoneContainer,me.timeSettingContainer),children:(0,t.jsx)(P.U,{includeInternal:!0,onChange:Ne=>{ue(),(0,o.isString)(Ne)&&we(Ne)},onBlur:ue,menuShouldPortal:!1})}):(0,t.jsx)("section",{role:"tabpanel","data-testid":g.Tp.components.TimeZonePicker.containerV2,id:Ie,className:(0,n.cx)(me.timeZoneContainer,me.timeSettingContainer),children:(0,t.jsx)(f.D,{className:me.fiscalYearField,label:(0,d.t)("time-picker.footer.fiscal-year-start","Fiscal year start month"),children:(0,t.jsx)(p.G,{value:Ue??null,options:b.Z,onChange:Ne=>{We&&We(Ne?.value??0)}})})})})]}):null]}):null},S=Me=>({container:(0,n.css)({borderTop:`1px solid ${Me.colors.border.weak}`,padding:Me.spacing(1.5),display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"}),editContainer:(0,n.css)({borderTop:`1px solid ${Me.colors.border.weak}`,padding:Me.spacing(1.5),paddingTop:0,justifyContent:"space-between",alignItems:"center"}),spacer:(0,n.css)({marginLeft:"7px"}),timeSettingContainer:(0,n.css)({paddingTop:Me.spacing(1)}),fiscalYearField:(0,n.css)({marginBottom:0}),timeZoneContainer:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",flexGrow:1}),timeZone:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"baseline",flexGrow:1})});var O=e(64998),M=e(53531),I=e(72724),L=e(10354),B=e(56034),j=e(47619),A=e(18828),K=e(85690),W=e(93225),U=e(59875),F=e(88448),V=e(72265),w=e(67061);function z({onClose:Me,onApply:Ce}){return(0,t.jsxs)(w.B,{gap:2,justifyContent:"space-between",children:[(0,t.jsx)(u.$n,{variant:"secondary",onClick:Me,children:(0,t.jsx)(d.x,{i18nKey:"time-picker.calendar.cancel-button",children:"Cancel"})}),(0,t.jsx)(u.$n,{onClick:Ce,children:(0,t.jsx)(d.x,{i18nKey:"time-picker.calendar.apply-button",children:"Apply time range"})})]})}z.displayName="Footer";var N=e(29158);function H({onClose:Me}){return(0,t.jsxs)(w.B,{justifyContent:"space-between",children:[(0,t.jsx)(O.e,{children:(0,t.jsx)(d.x,{i18nKey:"time-picker.calendar.select-time",children:"Select a time range"})}),(0,t.jsx)(N.K,{"data-testid":g.Tp.components.TimePicker.calendar.closeButton,tooltip:(0,d.t)("time-picker.calendar.close","Close calendar"),name:"times",variant:"secondary",onClick:Me})]})}H.displayName="Header";const Q=(Me,Ce=!1)=>({container:(0,n.css)({top:0,position:"absolute",[`${Ce?"left":"right"}`]:"546px"}),modalContainer:(0,n.css)({label:"modalContainer",margin:"0 auto"}),calendar:(0,n.css)({display:"flex",flexDirection:"column",gap:Me.spacing(1),padding:Me.spacing(1),label:"calendar",boxShadow:Me.shadows.z3,backgroundColor:Me.colors.background.primary,border:`1px solid ${Me.colors.border.weak}`,borderRadius:Me.shape.radius.default}),modal:(0,n.css)({label:"modal",boxShadow:Me.shadows.z3,left:"50%",position:"fixed",top:"50%",transform:"translate(-50%, -50%)",zIndex:Me.zIndex.modal})});function X(Me){const Ce=(0,i.$j)(),{modalBackdrop:Ue}=(0,i.of)(F.o),Ae=Q(Ce,Me.isReversed),{isOpen:we,isFullscreen:We,onClose:_e}=Me,at=(0,s.createRef)(),{dialogProps:ut}=(0,A.s)({"aria-label":g.Tp.components.TimePicker.calendar.label},at),{overlayProps:Tt}=(0,W.e)({isDismissable:!0,isOpen:we,onClose:_e},at),It=!We;if(!we)return null;const ge=(0,t.jsxs)("section",{className:Ae.calendar,ref:at,...Tt,...ut,"data-testid":g.Tp.components.TimePicker.calendar.label,children:[(0,t.jsx)(H,{...Me}),(0,t.jsx)(V.nB,{...Me}),It&&(0,t.jsx)(z,{...Me})]});return It?(0,t.jsxs)(U.Sf,{children:[(0,t.jsx)("div",{className:Ue}),(0,t.jsx)(K.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("div",{className:Ae.modal,children:(0,t.jsx)("div",{className:Ae.modalContainer,children:ge})})})]}):(0,t.jsx)(K.n1,{contain:!0,restoreFocus:!0,autoFocus:!0,children:(0,t.jsx)("div",{className:Ae.container,children:ge})})}const ee=(0,s.memo)(X);X.displayName="TimePickerCalendar";const Z={default:()=>(0,d.t)("time-picker.range-content.default-error",'Please enter a past date or "now"'),range:()=>(0,d.t)("time-picker.range-content.range-error",`"From" can't be after "To"`)},q=Me=>{const{value:Ce,isFullscreen:Ue=!1,timeZone:Ae,onApply:we,isReversed:We,fiscalYearStartMonth:_e,onError:at,weekStart:ut}=Me,[Tt,It]=k(Ce.raw.from,Ce.raw.to,Ae),ge=(0,i.of)(te),[Ie,ue]=(0,s.useState)(Tt),[me,Pe]=(0,s.useState)(It),[Ne,Fe]=(0,s.useState)(!1),Be=(0,s.useId)(),he=(0,s.useId)();(0,s.useEffect)(()=>{const[ht,ft]=k(Ce.raw.from,Ce.raw.to,Ae);ue(ht),Pe(ft)},[Ce.raw.from,Ce.raw.to,Ae]);const be=(0,s.useCallback)(ht=>{ht.preventDefault(),Fe(!0)},[Fe]),Ke=(0,s.useCallback)(()=>{if(me.invalid||Ie.invalid)return;const ht={from:Ie.value,to:me.value},ft=r.convertRawToRange(ht,Ae,_e);we(ft)},[Ie.invalid,Ie.value,we,Ae,me.invalid,me.value,_e]),ze=(0,s.useCallback)((ht,ft)=>{const[De,Te]=k(ht,ft,Ae);ue(De),Pe(Te)},[Ae]),nt=ht=>{ht.key==="Enter"&&Ke()},tt=()=>{const ht={from:Ie.value,to:me.value};navigator.clipboard.writeText(JSON.stringify(ht))},ot=async()=>{const ht=await navigator.clipboard.readText();let ft;try{ft=JSON.parse(ht)}catch{at&&at(ht);return}const[De,Te]=k(ft.from,ft.to,Ae);ue(De),Pe(Te)},gt=r.convertRawToRange({from:"now/fy",to:"now/fy"},Ae,_e),He=(0,d.t)("time-picker.range-content.fiscal-year","Fiscal year"),et=(0,t.jsx)("div",{className:ge.tooltip,children:r.isFiscal(Ce)?(0,t.jsx)(B.m,{content:`${He}: ${gt.from.format("MMM-DD")} - ${gt.to.format("MMM-DD")}`,children:(0,t.jsx)(h.I,{name:"info-circle"})}):null}),rt=(0,t.jsx)(u.$n,{"aria-label":(0,d.t)("time-picker.range-content.open-input-calendar","Open calendar"),"data-testid":g.Tp.components.TimePicker.calendar.openButton,icon:"calendar-alt",variant:"secondary",type:"button",onClick:be});return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:ge.fieldContainer,children:[(0,t.jsx)(f.D,{label:(0,d.t)("time-picker.range-content.from-input","From"),invalid:Ie.invalid,error:Ie.errorMessage,children:(0,t.jsx)(L.p,{id:Be,onClick:ht=>ht.stopPropagation(),onChange:ht=>ze(ht.currentTarget.value,me.value),addonAfter:rt,onKeyDown:nt,"data-testid":g.Tp.components.TimePicker.fromField,value:Ie.value})}),et]}),(0,t.jsxs)("div",{className:ge.fieldContainer,children:[(0,t.jsx)(f.D,{label:(0,d.t)("time-picker.range-content.to-input","To"),invalid:me.invalid,error:me.errorMessage,children:(0,t.jsx)(L.p,{id:he,onClick:ht=>ht.stopPropagation(),onChange:ht=>ze(Ie.value,ht.currentTarget.value),addonAfter:rt,onKeyDown:nt,"data-testid":g.Tp.components.TimePicker.toField,value:me.value})}),et]}),(0,t.jsxs)("div",{className:ge.buttonsContainer,children:[(0,t.jsx)(u.$n,{"data-testid":g.Tp.components.TimePicker.copyTimeRange,icon:"copy",variant:"secondary",tooltip:(0,d.t)("time-picker.copy-paste.tooltip-copy","Copy time range to clipboard"),type:"button",onClick:tt}),(0,t.jsx)(u.$n,{"data-testid":g.Tp.components.TimePicker.pasteTimeRange,icon:"clipboard-alt",variant:"secondary",tooltip:(0,d.t)("time-picker.copy-paste.tooltip-paste","Paste time range"),type:"button",onClick:ot}),(0,t.jsx)(u.$n,{"data-testid":g.Tp.components.TimePicker.applyTimeRange,type:"button",onClick:Ke,children:(0,t.jsx)(d.x,{i18nKey:"time-picker.range-content.apply-button",children:"Apply time range"})})]}),(0,t.jsx)(ee,{isFullscreen:Ue,isOpen:Ne,from:(0,M.b)(Ie.value,{timeZone:Ae}),to:(0,M.b)(me.value,{timeZone:Ae}),onApply:Ke,onClose:()=>Fe(!1),onChange:ze,timeZone:Ae,isReversed:We,weekStart:ut})]})};function ae(Me,Ce,Ue){const Ae={from:Me,to:Ce},we=r.convertRawToRange(Ae,Ue);return!(we.from.isSame(we.to)||we.from.isBefore(we.to))}function k(Me,Ce,Ue){const Ae=se(Me,Ue),we=se(Ce,Ue),We=!(0,j.f)(Ae,!1,Ue),_e=!(0,j.f)(we,!0,Ue),at=ae(Ae,we,Ue)&&!_e;return[{value:Ae,invalid:We||at,errorMessage:at&&!We?Z.range():Z.default()},{value:we,invalid:_e,errorMessage:Z.default()}]}function se(Me,Ce){if((0,a.Ar)(Me))return(0,I.LE)(Me,{timeZone:Ce});if(Me.endsWith("Z")){const Ue=(0,M.b)(Me,{timeZone:"utc"});return(0,I.LE)(Ue,{timeZone:Ce})}return Me}function te(Me){return{fieldContainer:(0,n.css)({display:"flex"}),buttonsContainer:(0,n.css)({display:"flex",gap:Me.spacing(.5),marginTop:Me.spacing(1)}),tooltip:(0,n.css)({paddingLeft:Me.spacing(1),paddingTop:Me.spacing(3)})}}var ne=e(11752);const le=(Me,Ce)=>r.convertRawToRange({from:Me.from,to:Me.to},Ce),re=(Me,Ce)=>{const Ue=(0,I.LE)(Me.from,{timeZone:Ce}),Ae=(0,I.LE)(Me.to,{timeZone:Ce});return{from:Ue,to:Ae,display:`${Ue} to ${Ae}`}},de=Me=>{const{quickOptions:Ce=[],isReversed:Ue,isFullscreen:Ae,hideQuickRanges:we,timeZone:We,fiscalYearStartMonth:_e,value:at,onChange:ut,history:Tt,showHistory:It,className:ge,hideTimeZone:Ie,onChangeTimeZone:ue,onChangeFiscalYearStartMonth:me}=Me,Pe=!Tt?.length,Ne=Ae&&It||!Ae&&(It&&!Pe||!we),Fe=(0,i.of)(Ee,Ue,we,Ne,Ae),Be=xe(Tt,We),he=fe(at.raw,Ce),[be,Ke]=(0,s.useState)(""),ze=Ce.filter(tt=>tt.display.toLowerCase().includes(be.toLowerCase())),nt=tt=>ut(le(tt));return(0,t.jsxs)("div",{id:"TimePickerContent",className:(0,n.cx)(Fe.container,ge),children:[(0,t.jsxs)("div",{className:Fe.body,children:[(!Ae||!we)&&(0,t.jsxs)("div",{className:Fe.rightSide,children:[(0,t.jsx)("div",{className:Fe.timeRangeFilter,children:(0,t.jsx)(c.Z,{width:0,value:be,onChange:Ke,placeholder:(0,d.t)("time-picker.content.filter-placeholder","Search quick ranges")})}),(0,t.jsxs)("div",{className:Fe.scrollContent,children:[!Ae&&(0,t.jsx)(J,{...Me,historyOptions:Be}),!we&&(0,t.jsx)(ne.l,{options:ze,onChange:nt,value:he})]})]}),Ae&&(0,t.jsx)("div",{className:Fe.leftSide,children:(0,t.jsx)(ce,{...Me,historyOptions:Be})})]}),!Ie&&Ae&&(0,t.jsx)(T,{timeZone:We,fiscalYearStartMonth:_e,onChangeTimeZone:ue,onChangeFiscalYearStartMonth:me})]})},oe=Me=>{const{widthOverride:Ce}=Me,Ue=(0,i.$j)(),Ae=(Ce||window.innerWidth)>=Ue.breakpoints.values.lg;return(0,t.jsx)(de,{...Me,isFullscreen:Ae})},J=Me=>{const{value:Ce,hideQuickRanges:Ue,onChange:Ae,timeZone:we,historyOptions:We=[],showHistory:_e,onError:at,weekStart:ut}=Me,Tt=(0,i.of)(Se),It=(0,a.Ar)(Ce.raw.from)||(0,a.Ar)(Ce.raw.to),[ge,Ie]=(0,s.useState)(!It),ue=Ue?!1:ge,me=Pe=>Ae(le(Pe,we));return(0,t.jsxs)("fieldset",{children:[(0,t.jsx)("div",{className:Tt.header,children:(0,t.jsxs)("button",{type:"button",className:Tt.expandButton,onClick:()=>{Ue||Ie(!ue)},"data-testid":g.Tp.components.TimePicker.absoluteTimeRangeTitle,"aria-expanded":!ue,"aria-controls":"expanded-timerange",children:[(0,t.jsx)(O.e,{children:(0,t.jsx)(d.x,{i18nKey:"time-picker.absolute.title",children:"Absolute time range"})}),!Ue&&(0,t.jsx)(h.I,{name:ue?"angle-down":"angle-up"})]})}),!ue&&(0,t.jsxs)("div",{className:Tt.body,id:"expanded-timerange",children:[(0,t.jsx)("div",{className:Tt.form,children:(0,t.jsx)(q,{value:Ce,onApply:Ae,timeZone:we,isFullscreen:!1,onError:at,weekStart:ut})}),_e&&(0,t.jsx)(ne.l,{title:(0,d.t)("time-picker.absolute.recent-title","Recently used absolute ranges"),options:We,onChange:me,placeholderEmpty:null})]})]})},ce=Me=>{const{onChange:Ce,value:Ue,timeZone:Ae,fiscalYearStartMonth:we,isReversed:We,historyOptions:_e,onError:at,weekStart:ut}=Me,Tt=(0,i.of)(ye,Me.hideQuickRanges),It=ge=>Ce(le(ge,Ae));return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:Tt.container,children:[(0,t.jsx)("div",{className:Tt.title,"data-testid":g.Tp.components.TimePicker.absoluteTimeRangeTitle,children:(0,t.jsx)(O.e,{children:(0,t.jsx)(d.x,{i18nKey:"time-picker.absolute.title",children:"Absolute time range"})})}),(0,t.jsx)(q,{value:Ue,timeZone:Ae,fiscalYearStartMonth:we,onApply:Ce,isFullscreen:!0,isReversed:We,onError:at,weekStart:ut})]}),Me.showHistory&&(0,t.jsx)("div",{className:Tt.recent,children:(0,t.jsx)(ne.l,{title:(0,d.t)("time-picker.absolute.recent-title","Recently used absolute ranges"),options:_e||[],onChange:It,placeholderEmpty:(0,t.jsx)(pe,{})})})]})},pe=(0,s.memo)(()=>{const Me=(0,i.of)(Ve),Ce=(0,d.t)("time-picker.content.empty-recent-list-info","It looks like you haven't used this time picker before. As soon as you enter some time intervals, recently used intervals will appear here.");return(0,t.jsxs)("div",{className:Me.container,children:[(0,t.jsx)("div",{children:(0,t.jsx)("span",{children:Ce})}),(0,t.jsx)(d.x,{i18nKey:"time-picker.content.empty-recent-list-docs",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("a",{className:Me.link,href:"https://grafana.com/docs/grafana/latest/dashboards/time-range-controls",target:"_new",children:"Read the documentation"}),(0,t.jsx)("span",{children:" to find out more about how to enter custom time ranges."})]})})]})});function xe(Me,Ce){return!Array.isArray(Me)||Me.length===0?[]:Me.map(Ue=>re(Ue,Ce))}pe.displayName="EmptyRecentList";const fe=(Me,Ce)=>(0,s.useMemo)(()=>{if(r.isRelativeTimeRange(Me))return Ce.find(Ue=>Ue.from===Me.from&&Ue.to===Me.to)},[Me,Ce]),Ee=(Me,Ce,Ue,Ae,we)=>({container:(0,n.css)({background:Me.colors.background.primary,boxShadow:Me.shadows.z3,width:`${we?"546px":"262px"}`,borderRadius:Me.shape.radius.default,border:`1px solid ${Me.colors.border.weak}`,[`${Ce?"left":"right"}`]:0,display:"flex",flexDirection:"column"}),body:(0,n.css)({display:"flex",flexDirection:"row-reverse",height:`${Ae?"381px":"217px"}`,maxHeight:"100vh"}),leftSide:(0,n.css)({display:"flex",flexDirection:"column",borderRight:`${Ce?"none":`1px solid ${Me.colors.border.weak}`}`,width:`${Ue?"100%":"60%"}`,overflow:"auto",scrollbarWidth:"thin",order:Ce?1:0}),rightSide:(0,n.css)({width:`${we?"40%":"100%"}; !important`,borderRight:Ce?`1px solid ${Me.colors.border.weak}`:"none",display:"flex",flexDirection:"column"}),timeRangeFilter:(0,n.css)({padding:Me.spacing(1)}),spacing:(0,n.css)({marginTop:"16px"}),scrollContent:(0,n.css)({overflowY:"auto",scrollbarWidth:"thin"})}),Se=Me=>({header:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderBottom:`1px solid ${Me.colors.border.weak}`,padding:"7px 9px 7px 9px"}),expandButton:(0,n.css)({backgroundColor:"transparent",border:"none",display:"flex",width:"100%","&:focus-visible":(0,l.getFocusStyles)(Me)}),body:(0,n.css)({borderBottom:`1px solid ${Me.colors.border.weak}`}),form:(0,n.css)({padding:"7px 9px 7px 9px"})}),ye=(Me,Ce)=>({container:(0,n.css)({paddingTop:"9px",paddingLeft:"11px",paddingRight:Ce?"11px":"20%"}),title:(0,n.css)({marginBottom:"11px"}),recent:(0,n.css)({flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"flex-end",paddingTop:Me.spacing(1)})}),Ve=Me=>({container:(0,n.css)({padding:"12px",margin:"12px","a, span":{fontSize:"13px"}}),link:(0,n.css)({color:Me.colors.text.link})})},64998:(G,R,e)=>{"use strict";e.d(R,{e:()=>g});var t=e(74848),n=e(32196),s=e(96540),a=e(40845);const r=i=>({text:(0,n.css)({fontSize:i.typography.size.md,fontWeight:i.typography.fontWeightMedium,color:i.colors.text.primary,margin:0,display:"flex"})}),g=(0,s.memo)(({children:i})=>{const l=(0,a.of)(r);return(0,t.jsx)("h3",{className:l.text,children:i})});g.displayName="TimePickerTitle"},3799:(G,R,e)=>{"use strict";e.d(R,{f:()=>i});var t=e(74848),n=e(32196),s=e(96540),a=e(40845),r=e(15666),g=e(47619);const i=(0,s.memo)(function({hideText:c,value:h,timeZone:o="browser",placeholder:m="No time range selected",className:u}){const p=(0,a.of)(l);return c?null:(0,t.jsx)("span",{className:u,children:(0,g.X)(h)?(0,t.jsx)(r._8,{value:h,timeZone:o}):(0,t.jsx)("span",{className:p.placeholder,children:m})})}),l=d=>({placeholder:(0,n.css)({color:d.colors.text.disabled,opacity:1})})},11752:(G,R,e)=>{"use strict";e.d(R,{l:()=>u});var t=e(74848),n=e(32196),s=e(96540),a=e(40845),r=e(76412),g=e(64998),i=e(62938),l=e(16797);const d=P=>({container:(0,n.css)({display:"flex",alignItems:"center",flexDirection:"row-reverse",justifyContent:"space-between"}),selected:(0,n.css)({background:P.colors.action.selected,fontWeight:P.typography.fontWeightMedium}),radio:(0,n.css)({opacity:0,width:"0 !important","&:focus-visible + label":(0,l.getFocusStyles)(P)}),label:(0,n.css)({cursor:"pointer",flex:1,padding:"7px 9px 7px 9px","&:hover":{background:P.colors.action.hover,cursor:"pointer"}})}),c=(0,s.memo)(({value:P,onSelect:E,selected:D=!1,name:C})=>{const b=(0,a.of)(d),T=(0,i.A)();return(0,t.jsxs)("li",{className:(0,n.cx)(b.container,D&&b.selected),children:[(0,t.jsx)("input",{className:b.radio,checked:D,name:C,type:"checkbox","data-role":"item",tabIndex:-1,id:T,onChange:()=>E(P)}),(0,t.jsx)("label",{className:b.label,htmlFor:T,children:P.display})]})});c.displayName="TimeRangeOption";const h=(P,E)=>(P%E+E)%E,o=["ArrowUp","ArrowDown","Home","End","Enter","Tab"],m=({localRef:P,options:E})=>{const[D,C]=(0,s.useState)(0);return(0,s.useEffect)(()=>{const T=P.current?.querySelectorAll('[data-role="item"]')||[],S=Array.from(T).findIndex(M=>M.checked),O=S>=0?S:0;T.forEach((M,I)=>{M.tabIndex=I===O?0:-1}),C(O)},[P,E]),[T=>{const S=P?.current?.querySelectorAll('[data-role="item"]'),O=S?.length??0;o.indexOf(T.key)>-1&&(T.preventDefault(),T.key!=="Tab"&&T.stopPropagation());let M=null;switch(T.key){case"ArrowUp":M=h(D-1,O);break;case"ArrowDown":M=h(D+1,O);break;case"Home":M=0;break;case"End":M=O-1;break;case"Enter":S?.[D]?.click();break;default:break}M!==null&&(C(M),S?.[M]?.focus(),S?.forEach((I,L)=>{I.tabIndex=L===M?0:-1}))}]},u=P=>{const E=(0,a.of)(x),{title:D,options:C,placeholderEmpty:b}=P;return typeof b<"u"&&C.length<=0?(0,t.jsx)(t.Fragment,{children:b}):D?(0,t.jsx)("section",{"aria-label":D,children:(0,t.jsxs)("fieldset",{children:[(0,t.jsx)("div",{className:E.title,children:(0,t.jsx)(g.e,{children:D})}),(0,t.jsx)(p,{...P})]})}):(0,t.jsx)(p,{...P})},p=({options:P,value:E,onChange:D,title:C})=>{const b=(0,a.of)(v),T=(0,s.useRef)(null),[S]=m({localRef:T,options:P});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("ul",{role:"presentation",onKeyDown:S,ref:T,"aria-roledescription":(0,r.t)("time-picker.time-range.aria-role","Time range selection"),children:P.map((O,M)=>(0,t.jsx)(c,{value:O,selected:y(O,E),onSelect:D,name:C??(0,r.t)("time-picker.time-range.default-title","Time ranges")},f(O,M)))}),(0,t.jsx)("div",{className:b.grow})]})};function f(P,E){return`${P.from}-${P.to}-${E}`}function y(P,E){return!E||!P?!1:E.from===P.from&&E.to===P.to}const x=()=>({title:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 16px 5px 9px"})}),v=()=>({grow:(0,n.css)({flexGrow:1,alignItems:"flex-start"})})},20333:(G,R,e)=>{"use strict";e.d(R,{U:()=>P});var t=e(74848),n=e(2543),s=e(96540),a=e(91410),r=e(76412),g=e(90182),i=e(32196),l=e(40845);const d=S=>{const{children:O,label:M}=S,I=(0,l.of)(c);return M?(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:I.header,children:(0,t.jsx)("span",{className:I.label,children:M})}),O]}):(0,t.jsx)("div",{children:O})},c=S=>({header:(0,i.css)({padding:"7px 10px",width:"100%",borderTop:`1px solid ${S.colors.border.weak}`,textTransform:"capitalize"}),label:(0,i.css)({fontSize:S.typography.size.sm,color:S.colors.text.secondary,fontWeight:S.typography.fontWeightMedium})});var h=e(17624),o=e(13544),m=e(14578),u=e(79451),p=e(67459);const f="tz-utc-offset",y=S=>{const{children:O,innerProps:M,innerRef:I,data:L,isSelected:B,isFocused:j}=S,A=(0,l.of)(v),K=Date.now(),W=(0,i.cx)(A.container,j&&A.containerFocused);if(!(0,n.isString)(L.value))return null;const U=(0,a.QZ)(L.value,K);return(0,t.jsx)("div",{className:W,...M,ref:I,"data-testid":o.Tp.components.Select.option,children:(0,t.jsxs)("div",{className:(0,i.cx)(A.leftColumn,A.row),children:[(0,t.jsxs)("div",{className:(0,i.cx)(A.leftColumn,A.wideRow),children:[(0,t.jsx)(p.U,{title:O}),(0,t.jsx)("div",{className:A.spacer}),(0,t.jsx)(u.E,{info:U})]}),(0,t.jsxs)("div",{className:A.rightColumn,children:[(0,t.jsx)(h.X,{timeZone:U?.ianaName||L.value,timestamp:K,className:f}),B&&(0,t.jsx)("span",{children:(0,t.jsx)(m.I,{name:"check"})})]})]})})},x=S=>{const{children:O,innerProps:M,innerRef:I,data:L,isSelected:B,isFocused:j}=S,A=(0,l.of)(v),K=Date.now(),W=(0,i.cx)(A.container,j&&A.containerFocused);if(!(0,n.isString)(L.value))return null;const U=(0,a.QZ)(L.value,K);return(0,t.jsx)("div",{className:W,...M,ref:I,"data-testid":o.Tp.components.Select.option,children:(0,t.jsxs)("div",{className:A.body,children:[(0,t.jsxs)("div",{className:A.row,children:[(0,t.jsx)("div",{className:A.leftColumn,children:(0,t.jsx)(p.U,{title:O})}),(0,t.jsx)("div",{className:A.rightColumn,children:B&&(0,t.jsx)("span",{children:(0,t.jsx)(m.I,{name:"check"})})})]}),(0,t.jsxs)("div",{className:A.row,children:[(0,t.jsx)("div",{className:A.leftColumn,children:(0,t.jsx)(u.E,{info:U})}),(0,t.jsx)("div",{className:A.rightColumn,children:(0,t.jsx)(h.X,{timestamp:K,timeZone:U?.ianaName||L.value,className:f})})]})]})})},v=S=>({container:(0,i.css)({display:"flex",alignItems:"center",flexDirection:"row",flexShrink:0,whiteSpace:"nowrap",cursor:"pointer",padding:"6px 8px 4px","&:hover":{background:S.colors.action.hover}}),containerFocused:(0,i.css)({background:S.colors.action.hover}),body:(0,i.css)({display:"flex",fontWeight:S.typography.fontWeightMedium,flexDirection:"column",flexGrow:1}),row:(0,i.css)({display:"flex",flexDirection:"row"}),leftColumn:(0,i.css)({flexGrow:1,textOverflow:"ellipsis"}),rightColumn:(0,i.css)({justifyContent:"flex-end",alignItems:"center"}),wideRow:(0,i.css)({display:"flex",flexDirection:"row",alignItems:"baseline"}),spacer:(0,i.css)({marginLeft:"6px"})}),P=S=>{const{onChange:O,width:M,autoFocus:I=!1,onBlur:L,value:B,includeInternal:j=!1,disabled:A=!1,inputId:K,menuShouldPortal:W=!0,openMenuOnFocus:U=!0}=S,F=E(j),V=D(F,B),w=b(),z=M&&M<=45?x:y,N=(0,s.useCallback)(H=>{if(!H||!(0,n.isString)(H.value))return O(B);O(H.value)},[O,B]);return(0,t.jsx)(g.l6,{inputId:K,value:V,placeholder:(0,r.t)("time-picker.zone.select-search-input","Type to search (country, city, abbreviation)"),autoFocus:I,menuShouldPortal:W,openMenuOnFocus:U,width:M,filterOption:w,options:F,onChange:N,onBlur:L,components:{Option:z,Group:d},disabled:A,"aria-label":(0,r.t)("time-picker.zone.select-aria-label","Time zone picker")})},E=S=>{const O=Date.now();return(0,a.U3)(S).map(I=>{const L=I.zones.reduce((B,j)=>{const A=(0,a.QZ)(j,O);return A&&B.push({label:A.name,value:A.zone,searchIndex:T(A,O)}),B},[]);return{label:I.name,options:L}})},D=(S,O)=>(0,s.useMemo)(()=>{if(O===void 0)return;const M=(0,n.toLower)(O);return S.find(L=>L.label?M.startsWith((0,n.toLower)(L.label)):C(M))?.options.find(L=>(0,n.isEmpty)(M)?L.value===a.g$.default:(0,n.toLower)(L.value)===M)},[S,O]),C=S=>{switch(S){case a.g$.default:case a.g$.localBrowserTime:case a.g$.utc:return!0;default:return!1}},b=()=>(0,s.useCallback)((S,O)=>!O||!S.data||!S.data.searchIndex?!0:S.data.searchIndex.indexOf((0,n.toLower)(O))>-1,[]),T=(S,O)=>{const M=[(0,n.toLower)(S.name),(0,n.toLower)(S.abbreviation),(0,n.toLower)((0,h.t)(O,S.zone))];for(const I of S.countries)M.push((0,n.toLower)(I.name)),M.push((0,n.toLower)(I.code));return M.join("|")}},79451:(G,R,e)=>{"use strict";e.d(R,{E:()=>r});var t=e(74848),n=e(32196),s=e(96540),a=e(40845);const r=({info:l})=>{const d=(0,a.of)(i),c=g(l);return l?(0,t.jsx)("div",{className:d.description,children:c}):null},g=l=>(0,s.useMemo)(()=>{const d=[];if(!l)return"";if(l.name==="Europe/Simferopol")return"Ukraine, EEST";if(l.countries.length>0){const c=l.countries[0];d.push(c.name)}return l.abbreviation&&d.push(l.abbreviation),d.join(", ")},[l]),i=l=>({description:(0,n.css)({fontWeight:"normal",fontSize:l.typography.size.sm,color:l.colors.text.secondary,whiteSpace:"normal",textOverflow:"ellipsis"})})},17624:(G,R,e)=>{"use strict";e.d(R,{X:()=>i,t:()=>l});var t=e(74848),n=e(32196),s=e(2543),a=e.n(s),r=e(72724),g=e(40845);const i=c=>{const{timestamp:h,timeZone:o,className:m}=c,u=(0,g.of)(d);return(0,s.isString)(o)?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("span",{className:(0,n.cx)(u.offset,m),children:l(h,o)})}):null},l=(c,h)=>`UTC${(0,r.LE)(c,{timeZone:h,format:"Z"})}`,d=c=>{const h=(0,n.css)({fontWeight:"normal",fontSize:c.typography.size.sm,color:c.colors.text.secondary,whiteSpace:"normal"});return{offset:(0,n.css)(h,{color:c.colors.text.primary,background:c.colors.background.secondary,padding:"2px 5px",borderRadius:c.shape.radius.default,marginLeft:"4px"})}}},67459:(G,R,e)=>{"use strict";e.d(R,{U:()=>a});var t=e(74848),n=e(32196),s=e(40845);const a=({title:g})=>{const i=(0,s.of)(r);return g?(0,t.jsx)("span",{className:i.title,children:g}):null},r=g=>({title:(0,n.css)({fontWeight:g.typography.fontWeightRegular,textOverflow:"ellipsis"})})},15648:(G,R,e)=>{"use strict";e.d(R,{l:()=>l,r:()=>i});var t=e(74848),n=e(96540),s=e(13544),a=e(55014);const r=[{value:"",label:"Default"},{value:"saturday",label:"Saturday"},{value:"sunday",label:"Sunday"},{value:"monday",label:"Monday"}],g=d=>["saturday","sunday","monday"].includes(d);function i(d){if(d&&g(d))return d;const c=window?.grafanaBootData?.user?.weekStart;return c&&g(c)?c:"monday"}const l=d=>{const{onChange:c,width:h,autoFocus:o=!1,onBlur:m,value:u,disabled:p=!1,inputId:f}=d,y=(0,n.useCallback)(v=>{v&&v.value!==void 0&&c(v.value)},[c]),x=(0,n.useMemo)(()=>r.find(v=>v.value===u)?.value??null,[u]);return(0,t.jsx)(a.G,{id:f,value:x,placeholder:s.Tp.components.WeekStartPicker.placeholder,autoFocus:o,width:h,options:r,onChange:y,onBlur:m,disabled:p})}},32432:(G,R,e)=>{"use strict";e.d(R,{Z:()=>n,o:()=>t});const t=[{from:"now-5m",to:"now",display:"Last 5 minutes"},{from:"now-15m",to:"now",display:"Last 15 minutes"},{from:"now-30m",to:"now",display:"Last 30 minutes"},{from:"now-1h",to:"now",display:"Last 1 hour"},{from:"now-3h",to:"now",display:"Last 3 hours"},{from:"now-6h",to:"now",display:"Last 6 hours"},{from:"now-12h",to:"now",display:"Last 12 hours"},{from:"now-24h",to:"now",display:"Last 24 hours"},{from:"now-2d",to:"now",display:"Last 2 days"},{from:"now-7d",to:"now",display:"Last 7 days"},{from:"now-30d",to:"now",display:"Last 30 days"},{from:"now-90d",to:"now",display:"Last 90 days"},{from:"now-6M",to:"now",display:"Last 6 months"},{from:"now-1y",to:"now",display:"Last 1 year"},{from:"now-2y",to:"now",display:"Last 2 years"},{from:"now-5y",to:"now",display:"Last 5 years"},{from:"now-1d/d",to:"now-1d/d",display:"Yesterday"},{from:"now-2d/d",to:"now-2d/d",display:"Day before yesterday"},{from:"now-7d/d",to:"now-7d/d",display:"This day last week"},{from:"now-1w/w",to:"now-1w/w",display:"Previous week"},{from:"now-1M/M",to:"now-1M/M",display:"Previous month"},{from:"now-1Q/fQ",to:"now-1Q/fQ",display:"Previous fiscal quarter"},{from:"now-1y/y",to:"now-1y/y",display:"Previous year"},{from:"now-1y/fy",to:"now-1y/fy",display:"Previous fiscal year"},{from:"now/d",to:"now/d",display:"Today"},{from:"now/d",to:"now",display:"Today so far"},{from:"now/w",to:"now/w",display:"This week"},{from:"now/w",to:"now",display:"This week so far"},{from:"now/M",to:"now/M",display:"This month"},{from:"now/M",to:"now",display:"This month so far"},{from:"now/y",to:"now/y",display:"This year"},{from:"now/y",to:"now",display:"This year so far"},{from:"now/fQ",to:"now",display:"This fiscal quarter so far"},{from:"now/fQ",to:"now/fQ",display:"This fiscal quarter"},{from:"now/fy",to:"now",display:"This fiscal year so far"},{from:"now/fy",to:"now/fy",display:"This fiscal year"}],n=[{label:"January",value:0},{label:"February",value:1},{label:"March",value:2},{label:"April",value:3},{label:"May",value:4},{label:"June",value:5},{label:"July",value:6},{label:"August",value:7},{label:"September",value:8},{label:"October",value:9},{label:"November",value:10},{label:"December",value:11}]},47619:(G,R,e)=>{"use strict";e.d(R,{X:()=>r,f:()=>a});var t=e(47232),n=e(85858),s=e(53531);function a(g,i,l){return(0,t.Ar)(g)?g.isValid():n.isMathString(g)?n.isValid(g):(0,s.b)(g,{roundUp:i,timeZone:l}).isValid()}function r(g){return n.isValid(g.from)&&n.isValid(g.to)}},99225:(G,R,e)=>{"use strict";e.d(R,{Q:()=>n});var t=e(91410);function n(s,a){const r=(0,t.HD)(a);if(!r)return s;const g=r.utcOffset(s.getTime()),i=s.getTimezoneOffset(),l=g-i;return new Date(s.getTime()-l*1e3*60)}},25994:(G,R,e)=>{"use strict";e.d(R,{c:()=>a});var t=e(74848),n=e(32196),s=e(40845);const a=({direction:g="horizontal",spacing:i=2})=>{const l=(0,s.of)(r,i);return g==="vertical"?(0,t.jsx)("div",{className:l.verticalDivider}):(0,t.jsx)("hr",{className:l.horizontalDivider})};a.displayName="Divider";const r=(g,i)=>({horizontalDivider:(0,n.css)({borderTop:`1px solid ${g.colors.border.weak}`,margin:g.spacing(i,0),width:"100%"}),verticalDivider:(0,n.css)({borderRight:`1px solid ${g.colors.border.weak}`,margin:g.spacing(0,i),height:"100%"})})},69144:(G,R,e)=>{"use strict";e.d(R,{l:()=>n});var t=e(32196);const n=(s,a)=>{const r=a||"middle",g=s.colors.emphasize(s.colors.background.secondary,.15),i=s.colors.primary.border,l=s.spacing(2),d=4,c=200;let h="50%",o="50%";switch(r){case"start":{h="0%",o="0%";break}case"end":{h="100%",o="100%";break}}const m=(0,t.css)({position:"relative","&:before":{content:'""',position:"absolute",transition:s.transitions.create("border-color"),zIndex:1},"&:after":{background:g,content:'""',position:"absolute",transition:s.transitions.create("background"),transform:"translate(-50%, -50%)",borderRadius:s.shape.radius.pill,zIndex:1},"&:hover":{"&:before":{borderColor:i},"&:after":{background:i}}});return{dragHandleVertical:(0,t.cx)(m,(0,t.css)({cursor:"col-resize",width:l,"&:before":{borderRight:"1px solid transparent",height:"100%",left:h,transform:"translateX(-50%)"},"&:after":{left:h,top:"50%",height:c,width:d}})),dragHandleHorizontal:(0,t.cx)(m,(0,t.css)({height:l,cursor:"row-resize","&:before":{borderTop:"1px solid transparent",top:o,transform:"translateY(-50%)",width:"100%"},"&:after":{left:"50%",top:o,height:d,width:c}}))}}},87978:(G,R,e)=>{"use strict";e.d(R,{_:()=>y});var t=e(74848),n=e(32196),s=e(18828),a=e(85690),r=e(93225),g=e(50848),i=e(96540),l=e(13544),d=e(40845),c=e(76412),h=e(40276),o=e(69144),m=e(29158),u=e(94753),p=e(24932);const f={sm:{width:"25vw",minWidth:384},md:{width:"50vw",minWidth:568},lg:{width:"75vw",minWidth:744}};function y({children:C,onClose:b,closeOnMaskClick:T=!0,scrollableContent:S=!0,title:O,subtitle:M,width:I,size:L="md",tabs:B}){const[j,A,K]=x(),W=(0,d.of)(E),U=(0,d.of)(D,L),F=(0,d.of)(o.l),V=i.useRef(null),{dialogProps:w,titleProps:z}=(0,s.s)({},V),{overlayProps:N}=(0,r.e)({isDismissable:!1,isOpen:!0,onClose:b},V);P();const H=(0,t.jsx)("div",{className:W.content,children:C}),Q=j??I??f[L].width,X=f[L].minWidth;return(0,t.jsx)(g.A,{open:!0,onClose:b,placement:"right",getContainer:".main-view",className:W.drawerContent,rootClassName:W.drawer,classNames:{wrapper:U},styles:{wrapper:{width:Q,minWidth:X}},width:"",motion:{motionAppear:!0,motionName:W.drawerMotion},maskClassName:W.mask,maskClosable:T,maskMotion:{motionAppear:!0,motionName:W.maskMotion},children:(0,t.jsx)(a.n1,{restoreFocus:!0,contain:!0,autoFocus:!0,children:(0,t.jsxs)("div",{"aria-label":typeof O=="string"?l.Tp.components.Drawer.General.title(O):l.Tp.components.Drawer.General.title("no title"),className:W.container,...N,...w,ref:V,children:[(0,t.jsx)("div",{className:(0,n.cx)(F.dragHandleVertical,W.resizer),onMouseDown:A,onTouchStart:K}),typeof O=="string"&&(0,t.jsxs)("div",{className:(0,n.cx)(W.header,!!B&&W.headerWithTabs),children:[(0,t.jsx)("div",{className:W.actions,children:(0,t.jsx)(m.K,{name:"times",variant:"secondary",onClick:b,"data-testid":l.Tp.components.Drawer.General.close,tooltip:(0,c.t)("grafana-ui.drawer.close","Close")})}),(0,t.jsxs)("div",{className:W.titleWrapper,children:[(0,t.jsx)(u.E,{element:"h3",...z,children:O}),M&&(0,t.jsx)("div",{className:W.subtitle,"data-testid":l.Tp.components.Drawer.General.subtitle,children:M}),B&&(0,t.jsx)("div",{className:W.tabsWrapper,children:B})]})]}),typeof O!="string"&&O,S?(0,t.jsx)(h.E,{children:H}):H]})})})}function x(){const[C,b]=(0,i.useState)(void 0),T=(0,i.useCallback)(B=>{b(v(B.clientX))},[]),S=(0,i.useCallback)(B=>{const j=B.touches[0];b(v(j.clientX))},[]),O=(0,i.useCallback)(B=>{document.removeEventListener("mousemove",T),document.removeEventListener("mouseup",O)},[T]),M=(0,i.useCallback)(B=>{document.removeEventListener("touchmove",S),document.removeEventListener("touchend",M)},[S]);function I(B){B.stopPropagation(),B.preventDefault(),document.addEventListener("mousemove",T),document.addEventListener("mouseup",O)}function L(B){B.stopPropagation(),B.preventDefault(),document.addEventListener("touchmove",S),document.addEventListener("touchend",M)}return[C,I,L]}function v(C){let b=document.body.offsetWidth-(C-document.body.offsetLeft);return`${Math.min(b/document.body.clientWidth*100,98).toFixed(2)}vw`}function P(){(0,i.useEffect)(()=>{if(document.body)return document.body.classList.add("body-drawer-open"),()=>{document.body.classList.remove("body-drawer-open")}},[])}const E=C=>({container:(0,n.css)({display:"flex",flexDirection:"column",height:"100%",flex:"1 1 0",minHeight:"100%",position:"relative"}),drawer:(0,n.css)({top:0,".rc-drawer-content-wrapper":{boxShadow:C.shadows.z3}}),drawerContent:(0,n.css)({backgroundColor:`${C.colors.background.primary} !important`,display:"flex",overflow:"unset !important",flexDirection:"column"}),drawerMotion:(0,n.css)({"&-appear":{transform:"translateX(100%)",transition:"none !important","&-active":{transition:`${C.transitions.create("transform")} !important`,transform:"translateX(0)"}}}),mask:(0,n.css)({backgroundColor:"transparent !important",position:"fixed !important","&:before":{backgroundColor:`${C.components.overlay.background} !important`,backdropFilter:"blur(1px)",bottom:0,content:'""',left:0,position:"fixed",right:0,top:0}}),maskMotion:(0,n.css)({"&-appear":{opacity:0,"&-active":{opacity:1,transition:C.transitions.create("opacity")}}}),header:(0,n.css)({label:"drawer-header",flexGrow:0,padding:C.spacing(2,2,3),borderBottom:`1px solid ${C.colors.border.weak}`}),headerWithTabs:(0,n.css)({borderBottom:"none"}),actions:(0,n.css)({position:"absolute",right:C.spacing(1),top:C.spacing(1)}),titleWrapper:(0,n.css)({label:"drawer-title",overflowWrap:"break-word"}),subtitle:(0,n.css)({label:"drawer-subtitle",color:C.colors.text.secondary,paddingTop:C.spacing(1)}),content:(0,n.css)({padding:C.spacing(2),height:"100%",flexGrow:1}),tabsWrapper:(0,n.css)({label:"drawer-tabs",paddingLeft:C.spacing(2),margin:C.spacing(1,-1,-3,-3)}),resizer:(0,n.css)({top:0,left:C.spacing(-1),bottom:0,position:"absolute",zIndex:C.zIndex.modal})});function D(C,b){return(0,n.css)({label:`drawer-content-wrapper-${b}`,overflow:"unset !important",[C.breakpoints.down("md")]:{width:`calc(100% - ${C.spacing(2)}) !important`,minWidth:"0 !important"}})}},9261:(G,R,e)=>{"use strict";e.d(R,{f:()=>m});var t=e(74848),n=e(32196),s=e(34743),a=e(83505),r=e(46885),g=e(85690),i=e(96540),l=e(40845),d=e(38138),c=e(64539),h=e(27746);const o=p=>{const{className:f,options:y,value:x,onChange:v,narrow:P,variant:E,...D}=p,C=(0,l.of)(u),[b,T]=(0,i.useState)(!1),S=[(0,s.cY)(0),(0,s.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,s.BN)()],{context:O,refs:M,floatingStyles:I}=(0,a.we)({open:b,placement:"bottom-end",onOpenChange:T,middleware:S,whileElementsMounted:r.ll}),L=(0,a.kp)(O),B=(0,a.s9)(O),{getReferenceProps:j,getFloatingProps:A}=(0,a.bv)([B,L]),K=W=>{v(W),T(!1)};return(0,t.jsxs)("div",{className:C.wrapper,children:[(0,t.jsx)(h.I,{className:f,isOpen:b,narrow:P,variant:E,ref:M.setReference,...j(),...D,children:x?.label||(x?.value!=null?String(x?.value):null)}),b&&(0,t.jsx)("div",{className:C.menuWrapper,ref:M.setFloating,...A(),style:I,children:(0,t.jsx)(g.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)(d.W,{tabIndex:-1,onClose:()=>T(!1),children:y.map(W=>(0,t.jsx)(c.D,{label:W.label??String(W.value),onClick:()=>K(W),active:W.value===x?.value,ariaChecked:W.value===x?.value,ariaLabel:W.ariaLabel||W.label,disabled:W.isDisabled,component:W.component,role:"menuitemradio"},`${W.value}`))})})})]})};o.displayName="ButtonSelect";const m=(0,i.memo)(o),u=p=>({wrapper:(0,n.css)({position:"relative",display:"inline-flex"}),menuWrapper:(0,n.css)({zIndex:p.zIndex.dropdown})})},83122:(G,R,e)=>{"use strict";e.d(R,{m:()=>o});var t=e(74848),n=e(32196),s=e(34743),a=e(83505),r=e(46885),g=e(96540),i=e(86634),l=e(40845),d=e(67892),c=e(18976),h=e(17464);const o=g.memo(({children:u,overlay:p,placement:f,offset:y,onVisibleChange:x})=>{const[v,P]=(0,g.useState)(!1),E=(0,g.useRef)(null),D=(0,g.useCallback)(W=>{P(W),x?.(W)},[x]),C=[(0,s.cY)({mainAxis:y?.[0]??8,crossAxis:y?.[1]??0}),(0,s.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,s.BN)()],{context:b,refs:T,floatingStyles:S}=(0,a.we)({open:v,placement:(0,c.O)(f),onOpenChange:D,middleware:C,whileElementsMounted:r.ll}),O=(0,a.kp)(b),M=(0,a.s9)(b),{getReferenceProps:I,getFloatingProps:L}=(0,a.bv)([M,O]),B=150,j=(0,l.of)(m,B),A=()=>{D(!1)},K=W=>{W.key==="Tab"&&D(!1)};return(0,t.jsxs)(t.Fragment,{children:[g.cloneElement(u,{ref:T.setReference,...I()}),v&&(0,t.jsx)(h.ZL,{children:(0,t.jsx)(a.s3,{context:b,children:(0,t.jsx)("div",{ref:T.setFloating,style:S,onClick:A,onKeyDown:K,children:(0,t.jsx)(i.A,{nodeRef:E,appear:!0,in:!0,timeout:{appear:B,exit:0,enter:0},classNames:j,children:(0,t.jsx)("div",{ref:E,children:d.renderOrCallToRender(p,{...L()})})})})})})]})});o.displayName="Dropdown";const m=(u,p)=>({appear:(0,n.css)({opacity:"0",position:"relative",transformOrigin:"top",[u.transitions.handleMotion("no-preference")]:{transform:"scaleY(0.5)"}}),appearActive:(0,n.css)({opacity:"1",[u.transitions.handleMotion("no-preference")]:{transform:"scaleY(1)",transition:`transform ${p}ms cubic-bezier(0.2, 0, 0.2, 1), opacity ${p}ms cubic-bezier(0.2, 0, 0.2, 1)`}})})},41670:(G,R,e)=>{"use strict";e.d(R,{Z:()=>a});var t=e(74848),n=e(32196),s=e(40845);const a=({children:g})=>{const i=(0,s.of)(r);return(0,t.jsx)("div",{className:i.container,children:g})},r=g=>({container:(0,n.css)({borderLeft:`3px solid ${g.colors.info.main}`,backgroundColor:`${g.colors.background.secondary}`,padding:g.spacing(2),minWidth:"350px",borderRadius:g.shape.radius.default,marginBottom:g.spacing(4)})})},69529:(G,R,e)=>{"use strict";e.d(R,{p:()=>E});var t=e(74848),n=e(32196),s=e(8867),a=e(40845),r=e(90613),g=e(67061),i=e(94753),l=e(36348);const d=({width:b="auto",height:T})=>{const S=(0,a.of)(c);return(0,t.jsx)(s.default,{src:l,className:S.svg,height:T,width:b})};d.displayName="GrotCTA";const c=b=>({svg:(0,n.css)({"#grot-cta-cactus-1, #grot-cta-cactus-2":{fill:b.isDark?"#58558c":"#c9c5f4"}})});var h=e(96540),o=e(22687);const m=-20,u=5,p=-5,f=5,y=({width:b="auto",height:T})=>{const S=(0,h.useRef)(null),O=(0,a.of)(x);return(0,h.useEffect)(()=>{const M=I=>{if(window.matchMedia("(prefers-reduced-motion: reduce").matches)return;const L=S.current?.querySelector("#grot-not-found-arm"),B=S.current?.querySelector("#grot-not-found-magnifier"),{clientX:j,clientY:A}=I,{innerWidth:K,innerHeight:W}=window,U=A/W,F=j/K,V=v(U,m,u),w=v(F,p,f);window.requestAnimationFrame(()=>{L?.setAttribute("style",`transform: rotate(${V}deg) translateX(${w}%)`),B?.setAttribute("style",`transform: rotate(${V}deg) translateX(${w}%)`)})};return window.addEventListener("mousemove",M),()=>{window.removeEventListener("mousemove",M)}},[]),(0,t.jsx)(s.default,{innerRef:S,src:o,className:O.svg,height:T,width:b})};y.displayName="GrotNotFound";const x=b=>({svg:(0,n.css)({"#grot-not-found-arm, #grot-not-found-magnifier":{transformOrigin:"center"}})}),v=(b,T,S)=>b*(S-T)+T;var P=e(9886);const E=({button:b,children:T,image:S,message:O,hideImage:M=!1,variant:I,role:L})=>{const B=(0,a.of)(C),j=S??D(I);return(0,t.jsx)(r.a,{paddingY:4,display:"flex",direction:"column",alignItems:"center",role:L,children:(0,t.jsxs)("div",{className:B.container,children:[!M&&j,(0,t.jsxs)(g.B,{direction:"column",alignItems:"center",children:[(0,t.jsx)(i.E,{variant:"h4",textAlignment:"center",children:O}),T&&(0,t.jsx)(i.E,{color:"secondary",textAlignment:"center",children:T})]}),b]})})};function D(b){switch(b){case"call-to-action":return(0,t.jsx)(d,{width:300});case"not-found":return(0,t.jsx)(y,{width:300});case"completed":return(0,t.jsx)(s.default,{src:P,width:300});default:throw new Error(`Unknown variant: ${b}`)}}const C=b=>({container:(0,n.css)({display:"flex",flexDirection:"column",alignItems:"center",gap:b.spacing(4),maxWidth:"600px"})})},66602:(G,R,e)=>{"use strict";e.d(R,{Xc:()=>l,Xw:()=>i,tH:()=>g});var t=e(74848),n=e(96540),s=e(32631),a=e(42418),r=e(52446);class g extends n.PureComponent{constructor(){super(...arguments),this.state={error:null,errorInfo:null}}componentDidCatch(c,h){s.P?.api?.pushError(c),this.setState({error:c,errorInfo:h}),this.props.onError&&this.props.onError(c)}componentDidUpdate(c){const{dependencies:h,onRecover:o}=this.props;if(this.state.error&&h&&c.dependencies){for(let m=0;m<h.length;m++)if(h[m]!==c.dependencies[m]){this.setState({error:null,errorInfo:null}),o&&o();break}}}render(){const{children:c}=this.props,{error:h,errorInfo:o}=this.state;return c({error:h,errorInfo:o})}}class i extends n.PureComponent{static{this.defaultProps={title:"An unexpected error happened",style:"alertbox"}}render(){const{title:c,children:h,style:o,dependencies:m}=this.props;return(0,t.jsx)(g,{dependencies:m,children:({error:u,errorInfo:p})=>p?o==="alertbox"?(0,t.jsx)(a.F,{title:c||"",children:(0,t.jsxs)("details",{style:{whiteSpace:"pre-wrap"},children:[u&&u.toString(),(0,t.jsx)("br",{}),p.componentStack]})}):(0,t.jsx)(r.D,{title:c||"",error:u,errorInfo:p}):h})}}function l(d,c={}){const h=o=>(0,t.jsx)(i,{...c,children:(0,t.jsx)(d,{...o})});return h.displayName="WithErrorBoundary",h}},29678:(G,R,e)=>{"use strict";e.d(R,{y:()=>a});var t=e(74848),n=e(41987),s=e(39938);const a=({featureState:g,tooltip:i})=>{const l=r(g);return(0,t.jsx)(s.E,{text:l.text,color:l.color,icon:l.icon,tooltip:i})};function r(g){switch(g){case n.Ay.alpha:return{text:"Alpha",icon:"exclamation-triangle",color:"orange"};case n.Ay.beta:return{text:"Beta",icon:"rocket",color:"blue"};case n.Ay.experimental:return{text:"Experimental",icon:"exclamation-triangle",color:"orange"};case n.Ay.preview:return{text:"Preview",icon:"rocket",color:"blue"};case n.Ay.privatePreview:return{text:"Private preview",icon:"rocket",color:"blue"}}}},37270:(G,R,e)=>{"use strict";e.d(R,{gH:()=>m,wI:()=>f});var t=e(74848),n=e(32196),s=e(2543),a=e.n(s),r=e(96540),g=e(20978),i=e(47172),l=e(83195),d=e(40845),c=e(42418),h=e(14578),o=e(73569);function m({options:E,children:D,readAs:C,onLoad:b,fileListRenderer:T,onFileRemove:S}){const[O,M]=(0,r.useState)([]),[I,L]=(0,r.useState)([]),B=(0,l.j_)("decbytes")(E?.maxSize?E?.maxSize:0),j=(0,r.useCallback)((X,ee)=>{M(Z=>Z.map(q=>(q.id===X.id&&ee(q),q)))},[]),A=(0,r.useCallback)((X,ee,Z)=>{let q=X.map(v);if(E?.multiple===!1?M(q):M(ae=>[...ae,...q]),N(ee),E?.onDrop)E.onDrop(X,ee,Z);else for(const ae of q){const k=new FileReader,se=()=>{C?k[C](ae.file):k.readAsText(ae.file)};j(ae,te=>{te.abortUpload=()=>{k.abort()},te.retryUpload=()=>{j(ae,ne=>{ne.error=null,ne.progress=void 0}),se()}}),k.onabort=()=>{j(ae,te=>{te.error=new DOMException("Aborted")})},k.onprogress=te=>{j(ae,ne=>{ne.progress=te.loaded})},k.onload=()=>{b?.(k.result)},k.onerror=()=>{j(ae,te=>{te.error=k.error})},se()}},[b,E,C,j]),K=X=>{const ee=O.filter(Z=>X.id!==Z.id);M(ee),S?.(X)},{getRootProps:W,getInputProps:U,isDragActive:F}=(0,g.VB)({...E,useFsAccessApi:!1,onDrop:A,accept:p(E?.accept)}),V=(0,d.$j)(),w=P(V,F),z=O.map(X=>T?T(X,K):(0,t.jsx)(o.I,{file:X,removeFile:K},X.id)),N=X=>{let ee=[];X.map(Z=>{Z.errors.map(q=>{ee.findIndex(ae=>ae.code===q.code&&ae.message===q.message)===-1&&ee.push(q)})}),L(ee)},H=X=>(0,t.jsx)("div",{className:w.errorAlert,children:(0,t.jsx)(c.F,{title:"Upload failed",severity:"error",onRemove:Q,children:X.map(ee=>{switch(ee.code){case i.O4.FileTooLarge:return(0,t.jsxs)("div",{children:["File is larger than ",(0,l.cN)(B)]},ee.message+ee.code);default:return(0,t.jsx)("div",{children:ee.message},ee.message+ee.code)}})})}),Q=()=>{L([])};return(0,t.jsxs)("div",{className:w.container,children:[(0,t.jsxs)("div",{"data-testid":"dropzone",...W({className:w.dropzone}),children:[(0,t.jsx)("input",{...U()}),D??(0,t.jsx)(f,{primaryText:y(O,E)})]}),I.length>0&&H(I),(0,t.jsxs)("small",{className:(0,n.cx)(w.small,w.acceptContainer),children:[E?.maxSize&&`Max file size: ${(0,l.cN)(B)}`,E?.maxSize&&E?.accept&&(0,t.jsx)("span",{className:w.acceptSeparator,children:"|"}),E?.accept&&x(E.accept)]}),z]})}function u(E){return["txt","json","csv","xls","yml"].some(D=>E.match(D))?"text/plain":"application/octet-stream"}function p(E){return(0,s.isString)(E)?{[u(E)]:[E]}:Array.isArray(E)?E.reduce((D,C)=>{const b=u(C);return D[b]=D[b]?[...D[b],C]:[C],D},{}):E}function f({primaryText:E="Drop file here or click to upload",secondaryText:D=""}){const C=(0,d.$j)(),b=P(C);return(0,t.jsxs)("div",{className:(0,n.cx)(b.defaultDropZone),"data-testid":"file-drop-zone-default-children",children:[(0,t.jsx)(h.I,{className:(0,n.cx)(b.icon),name:"upload",size:"xl"}),(0,t.jsx)("h6",{className:(0,n.cx)(b.primaryText),children:E}),(0,t.jsx)("small",{className:b.small,children:D})]})}function y(E,D){return D?.multiple===void 0||D?.multiple?"Upload file":E.length?"Replace file":"Upload file"}function x(E){return(0,s.isString)(E)?`Accepted file type: ${E}`:Array.isArray(E)?`Accepted file types: ${E.join(", ")}`:`Accepted file types: ${Object.values(E).flat().join(", ")}`}function v(E){return{id:(0,s.uniqueId)("file"),file:E,error:null}}function P(E,D){return{container:(0,n.css)({display:"flex",flexDirection:"column",width:"100%",padding:E.spacing(2),borderRadius:E.shape.radius.default,border:`1px dashed ${E.colors.border.strong}`,backgroundColor:D?E.colors.background.secondary:E.colors.background.primary,cursor:"pointer",alignItems:"center",justifyContent:"center"}),dropzone:(0,n.css)({height:"100%",width:"100%",display:"flex",flexDirection:"column"}),defaultDropZone:(0,n.css)({textAlign:"center"}),icon:(0,n.css)({marginBottom:E.spacing(1)}),primaryText:(0,n.css)({marginBottom:E.spacing(1)}),acceptContainer:(0,n.css)({textAlign:"center",margin:0}),acceptSeparator:(0,n.css)({margin:`0 ${E.spacing(1)}`}),small:(0,n.css)({color:E.colors.text.secondary}),errorAlert:(0,n.css)({paddingTop:"10px"})}}},73569:(G,R,e)=>{"use strict";e.d(R,{I:()=>c});var t=e(74848),n=e(32196),s=e(83195),a=e(40845),r=e(53550),g=e(55852),i=e(14578),l=e(29158);const d="Remove file";function c({file:o,removeFile:m}){const u=(0,a.of)(h),{file:p,progress:f,error:y,abortUpload:x,retryUpload:v}=o,P=()=>y?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:u.error,children:y.message}),v&&(0,t.jsx)(l.K,{name:"sync",tooltip:"Retry",tooltipPlacement:"top",onClick:v}),m&&(0,t.jsx)(l.K,{className:v?u.marginLeft:"",name:"trash-alt",onClick:()=>m(o),tooltip:d})]}):f&&p.size>f?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("progress",{className:u.progressBar,max:p.size,value:f}),(0,t.jsxs)("span",{className:u.paddingLeft,children:[Math.round(f/p.size*100),"%"]}),x&&(0,t.jsx)(g.$n,{variant:"secondary",type:"button",fill:"text",onClick:x,children:"Cancel upload"})]}):m&&(0,t.jsx)(l.K,{name:"trash-alt",onClick:()=>m(o),tooltip:d,tooltipPlacement:"top"}),E=(0,s.j_)("decbytes")(p.size);return(0,t.jsxs)("div",{className:u.fileListContainer,children:[(0,t.jsxs)("span",{className:u.fileNameWrapper,children:[(0,t.jsx)(i.I,{name:"file-blank",size:"lg","aria-hidden":!0}),(0,t.jsx)("span",{className:u.padding,children:(0,r.i)(p.name)}),(0,t.jsx)("span",{children:(0,s.cN)(E)})]}),(0,t.jsx)("div",{className:u.fileNameWrapper,children:P()})]})}function h(o){return{fileListContainer:(0,n.css)({width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:o.spacing(2),border:`1px dashed ${o.colors.border.medium}`,backgroundColor:`${o.colors.background.secondary}`,marginTop:o.spacing(1)}),fileNameWrapper:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center"}),padding:(0,n.css)({padding:o.spacing(0,1)}),paddingLeft:(0,n.css)({paddingLeft:o.spacing(2)}),marginLeft:(0,n.css)({marginLeft:o.spacing(1)}),error:(0,n.css)({paddingRight:o.spacing(2),color:o.colors.error.text}),progressBar:(0,n.css)({borderRadius:o.shape.radius.default,height:"4px","::-webkit-progress-bar":{backgroundColor:o.colors.border.weak,borderRadius:o.shape.radius.default},"::-webkit-progress-value":{backgroundColor:o.colors.primary.main,borderRadius:o.shape.radius.default}})}}},73546:(G,R,e)=>{"use strict";e.d(R,{e:()=>h});var t=e(74848),n=e(32196),s=e(96540),a=e(62938),r=e(13544),g=e(40845),i=e(16797),l=e(53550),d=e(55852),c=e(14578);const h=({onFileUpload:m,className:u,children:p="Upload file",accept:f="*",size:y="md",showFileName:x})=>{const v=(0,g.of)(o(y)),[P,E]=(0,s.useState)(""),D=(0,a.A)(),C=(0,s.useCallback)(b=>{const T=b.currentTarget?.files?.[0];T&&E(T.name??""),m(b)},[m]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("input",{type:"file",id:D,className:v.fileUpload,onChange:C,multiple:!1,accept:f,"data-testid":r.Tp.components.FileUpload.inputField}),(0,t.jsxs)("label",{htmlFor:D,className:(0,n.cx)(v.labelWrapper,u),children:[(0,t.jsx)(c.I,{name:"upload",className:v.icon}),p]}),x&&P&&(0,t.jsx)("span",{"aria-label":"File name",className:v.fileName,"data-testid":r.Tp.components.FileUpload.fileNameSpan,children:(0,l.i)(P)})]})},o=m=>u=>{const p=(0,d.hs)({theme:u,variant:"primary",size:m,iconOnly:!1}),f=(0,i.getFocusStyles)(u);return{fileUpload:(0,n.css)({height:"0.1px",opacity:"0",overflow:"hidden",position:"absolute",width:"0.1px",zIndex:-1,"&:focus + label":f,"&:focus-visible + label":f}),labelWrapper:p.button,icon:p.icon,fileName:(0,n.css)({marginLeft:u.spacing(.5)})}}},67647:(G,R,e)=>{"use strict";e.d(R,{Z:()=>l});var t=e(74848),n=e(96540),s=e(54479);function a(...d){const c=n.useRef(null);return n.useEffect(()=>{d.forEach(h=>{h&&(typeof h=="function"?h(c.current):h.current=c.current)})},[d]),c}var r=e(55852),g=e(14578),i=e(10354);const l=(0,n.forwardRef)(({value:d,width:c,onChange:h,escapeRegex:o=!0,...m},u)=>{const p=(0,n.useRef)(null),f=a(u,p),y=d!==""?(0,t.jsx)(r.$n,{icon:"times",fill:"text",size:"sm",onClick:x=>{p.current?.focus(),h(""),x.stopPropagation()},children:"Clear"}):null;return(0,t.jsx)(i.p,{prefix:(0,t.jsx)(g.I,{name:"search"}),suffix:y,width:c,type:"text",value:o?(0,s.xb)(d??""):d,onChange:x=>h(o?(0,s.jD)(x.currentTarget.value):x.currentTarget.value),...m,ref:f})});l.displayName="FilterInput"},92174:(G,R,e)=>{"use strict";e.d(R,{m:()=>g});var t=e(74848),n=e(32196),s=e(40845),a=e(55852),r=e(14578);const g=({label:l,selected:d,onClick:c,icon:h="check"})=>{const o=(0,s.of)(i),m=(0,s.of)(a.my);return(0,t.jsxs)("button",{type:"button",className:(0,n.cx)(m,o.wrapper,d&&o.selected),onClick:c,children:[(0,t.jsx)("span",{children:l}),d&&(0,t.jsx)(r.I,{name:h,className:o.icon})]})},i=l=>({wrapper:(0,n.css)({background:l.colors.background.secondary,borderRadius:l.shape.radius.pill,padding:l.spacing(0,2),fontSize:l.typography.bodySmall.fontSize,fontWeight:l.typography.fontWeightMedium,lineHeight:l.typography.bodySmall.lineHeight,color:l.colors.text.secondary,display:"flex",alignItems:"center",height:"32px",position:"relative",border:`1px solid ${l.colors.background.secondary}`,whiteSpace:"nowrap","&:hover":{background:l.colors.action.hover,color:l.colors.text.primary}}),selected:(0,n.css)({color:l.colors.text.primary,background:l.colors.action.selected,"&:hover":{background:l.colors.action.focus}}),icon:(0,n.css)({marginLeft:l.spacing(.5)})})},90090:(G,R,e)=>{"use strict";e.d(R,{z:()=>a});var t=e(74848),n=e(32196),s=e(38894);const a=({label:g,tooltip:i,labelWidth:l=6,inputWidth:d=12,inputEl:c,className:h,interactive:o,...m})=>{const u=r();return(0,t.jsxs)("div",{className:(0,n.cx)(u.formField,h),children:[(0,t.jsx)(s.I,{width:l,tooltip:i,interactive:o,children:g}),c||(0,t.jsx)("input",{type:"text",className:`gf-form-input ${d?`width-${d}`:""}`,...m,disabled:m.disabled})]})};a.displayName="FormField";const r=()=>({formField:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative"})})},38894:(G,R,e)=>{"use strict";e.d(R,{I:()=>i});var t=e(74848),n=e(46942),s=e.n(n),a=e(14578),r=e(56034);const i=({children:l,isFocused:d,isInvalid:c,className:h,htmlFor:o,tooltip:m,width:u,interactive:p,...f})=>{const y=s()(h,`gf-form-label width-${u||"10"}`,{"gf-form-label--is-focused":d,"gf-form-label--is-invalid":c});return(0,t.jsxs)("label",{className:y,...f,htmlFor:o,children:[l,m&&(0,t.jsx)(r.m,{placement:"top",content:m,theme:"info",interactive:p,children:(0,t.jsx)(a.I,{name:"info-circle",size:"sm",style:{marginLeft:"10px"}})})]})}},9286:(G,R,e)=>{"use strict";e.d(R,{i:()=>s});var t=e(74848);function n(a){return a<20?.9:a<26?.8:.6}const s=({value:a,className:r,style:g,...i})=>{const l=(a.prefix??"").length>0,d=(a.suffix??"").length>0;let c;if(g&&g.fontSize&&typeof g.fontSize=="number"){const h=g.fontSize,o=n(h);c={fontSize:h*o}}return(0,t.jsx)("div",{className:r,style:g,...i,children:(0,t.jsxs)("div",{children:[l&&(0,t.jsx)("span",{children:a.prefix}),(0,t.jsx)("span",{children:a.text}),d&&(0,t.jsx)("span",{style:c,children:a.suffix})]})})};s.displayName="FormattedDisplayValue"},10880:(G,R,e)=>{"use strict";e.d(R,{S:()=>i});var t=e(74848),n=e(32196),s=e(96540),a=e(40845),r=e(16797),g=e(60029);const i=s.forwardRef(({label:d,description:c,value:h,htmlValue:o,onChange:m,disabled:u,className:p,indeterminate:f,invalid:y,...x},v)=>{const P=(0,s.useCallback)(C=>{m&&m(C)},[m]),E=(0,a.of)(l,y),D=f?"mixed":void 0;return(0,t.jsxs)("label",{className:(0,n.cx)(E.wrapper,p),children:[(0,t.jsxs)("div",{className:E.checkboxWrapper,children:[(0,t.jsx)("input",{type:"checkbox",className:(0,n.cx)(E.input,f&&E.inputIndeterminate),checked:h,disabled:u,onChange:P,value:o,"aria-checked":D,...x,ref:v}),(0,t.jsx)("span",{className:E.checkmark})]}),d&&(0,t.jsx)("span",{className:E.label,children:d}),c&&(0,t.jsx)("span",{className:E.description,children:c})]})}),l=(d,c=!1)=>{const h=(0,g.f)(d),o=2,m=1,u=p=>c?d.colors.error.border:p;return{wrapper:(0,n.css)({display:"inline-grid",alignItems:"center",columnGap:d.spacing(m),gridAutoRows:"max-content",position:"relative",verticalAlign:"middle"}),input:(0,n.css)({position:"absolute",zIndex:1,top:0,left:0,width:"100% !important",height:"100%",opacity:0,"&:focus + span, &:focus-visible + span":(0,r.getFocusStyles)(d),"&:focus:not(:focus-visible) + span":(0,r.getMouseFocusStyles)(d),"&:checked + span":{background:d.colors.primary.main,border:`1px solid ${u(d.colors.primary.main)}`,"&:hover":{background:d.colors.primary.shade},"&:after":{content:'""',position:"absolute",zIndex:2,left:"4px",top:0,width:"6px",height:"12px",border:`solid ${d.colors.primary.contrastText}`,borderWidth:"0 3px 3px 0",transform:"rotate(45deg)"}},"&:disabled + span":{backgroundColor:d.colors.action.disabledBackground,cursor:"not-allowed",border:`1px solid ${u(d.colors.action.disabledBackground)}`,"&:hover":{backgroundColor:d.colors.action.disabledBackground},"&:after":{borderColor:d.colors.action.disabledText}}}),inputIndeterminate:(0,n.css)({"&[aria-checked='mixed'] + span":{border:`1px solid ${u(d.colors.primary.main)}`,background:d.colors.primary.main,"&:hover":{background:d.colors.primary.shade},"&:after":{content:'""',position:"absolute",zIndex:2,left:"2px",right:"2px",top:"calc(50% - 1.5px)",height:"3px",border:`1.5px solid ${d.colors.primary.contrastText}`,backgroundColor:d.colors.primary.contrastText,width:"auto",transform:"none"}},"&:disabled[aria-checked='mixed'] + span":{backgroundColor:d.colors.action.disabledBackground,border:`1px solid ${u(d.colors.error.transparent)}`,"&:after":{borderColor:d.colors.action.disabledText}}}),checkboxWrapper:(0,n.css)({display:"flex",alignItems:"center",gridColumnStart:1,gridRowStart:1}),checkmark:(0,n.css)({position:"relative",zIndex:2,display:"inline-block",width:d.spacing(o),height:d.spacing(o),borderRadius:d.shape.radius.default,background:d.components.input.background,border:`1px solid ${u(d.components.input.borderColor)}`,"&:hover":{cursor:"pointer",borderColor:u(d.components.input.borderHover)}}),label:(0,n.cx)(h.label,(0,n.css)({gridColumnStart:2,gridRowStart:1,position:"relative",zIndex:2,cursor:"pointer",maxWidth:"fit-content",lineHeight:d.typography.bodySmall.lineHeight,marginBottom:0})),description:(0,n.cx)(h.description,(0,n.css)({gridColumnStart:2,gridRowStart:2,lineHeight:d.typography.bodySmall.lineHeight,marginTop:0}))}};i.displayName="Checkbox"},88575:(G,R,e)=>{"use strict";e.d(R,{D:()=>l});var t=e(74848),n=e(32196),s=e(96540),a=e(40845),r=e(67892),g=e(72093),i=e(60029);const l=s.forwardRef(({label:h,description:o,horizontal:m,invalid:u,loading:p,disabled:f,required:y,error:x,children:v,className:P,validationMessageHorizontalOverflow:E,htmlFor:D,...C},b)=>{const T=(0,a.of)(c),S=D??(0,r.getChildId)(v),O=typeof h=="string"?(0,t.jsx)(i.J,{htmlFor:S,description:o,children:`${h}${y?" *":""}`}):h,M=d({invalid:u,disabled:f,loading:p});return(0,t.jsxs)("div",{className:(0,n.cx)(T.field,m&&T.fieldHorizontal,P),...C,children:[O,(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{ref:b,children:s.cloneElement(v,M)}),u&&x&&!m&&(0,t.jsx)("div",{className:(0,n.cx)(T.fieldValidationWrapper,{[T.validationMessageHorizontalOverflow]:!!E}),children:(0,t.jsx)(g.P,{children:x})})]}),u&&x&&m&&(0,t.jsx)("div",{className:(0,n.cx)(T.fieldValidationWrapper,T.fieldValidationWrapperHorizontal,{[T.validationMessageHorizontalOverflow]:!!E}),children:(0,t.jsx)(g.P,{children:x})})]})});l.displayName="Field";function d(h){for(const o in h)h[o]===void 0&&delete h[o];return h}const c=h=>({field:(0,n.css)({display:"flex",flexDirection:"column",marginBottom:h.spacing(2)}),fieldHorizontal:(0,n.css)({flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap"}),fieldValidationWrapper:(0,n.css)({marginTop:h.spacing(.5)}),fieldValidationWrapperHorizontal:(0,n.css)({flex:"1 1 100%"}),validationMessageHorizontalOverflow:(0,n.css)({width:0,overflowX:"visible","& > *":{whiteSpace:"nowrap"}})})},84167:(G,R,e)=>{"use strict";e.d(R,{n:()=>r});var t=e(74848),n=e(32196),s=e(40845),a=e(17408);const r=({label:i,children:l,className:d,...c})=>{const h=(0,s.of)(g);return(0,t.jsxs)("fieldset",{className:(0,n.cx)(h.wrapper,d),...c,children:[i&&(0,t.jsx)(a.s,{children:i}),l]})},g=i=>({wrapper:(0,n.css)({marginBottom:i.spacing(4),"&:last-child":{marginBottom:0}})})},72093:(G,R,e)=>{"use strict";e.d(R,{P:()=>r});var t=e(74848),n=e(32196),s=e(40845),a=e(14578);const r=({children:i,horizontal:l,className:d})=>{const c=(0,s.of)(g),h=(0,n.cx)(l?c.horizontal:c.vertical,d);return(0,t.jsxs)("div",{role:"alert",className:h,children:[(0,t.jsx)(a.I,{className:c.fieldValidationMessageIcon,name:"exclamation-triangle"}),i]})},g=i=>{const l=`
      font-size: ${i.typography.size.sm};
      font-weight: ${i.typography.fontWeightMedium};
      padding: ${i.spacing(.5,1)};
      color: ${i.colors.error.contrastText};
      background: ${i.colors.error.main};
      border-radius: ${i.shape.radius.default};
      position: relative;
      display: inline-block;
      align-self: flex-start;

      a {
        color: ${i.colors.error.contrastText};
        text-decoration: underline;
      }

      a:hover {
        text-decoration: none;
      }
    `;return{vertical:(0,n.css)(l,{margin:i.spacing(.5,0,0,0),"&:before":{content:'""',position:"absolute",left:"9px",top:"-5px",width:0,height:0,borderWidth:"0 4px 5px 4px",borderColor:`transparent transparent ${i.colors.error.main} transparent`,borderStyle:"solid"}}),horizontal:(0,n.css)(l,{marginLeft:"10px","&:before":{content:'""',position:"absolute",left:"-5px",top:"9px",width:0,height:0,borderWidth:"4px 5px 4px 0",borderColor:"transparent #e02f44 transparent transparent",borderStyle:"solid"}}),fieldValidationMessageIcon:(0,n.css)({marginRight:i.spacing()})}}},51253:(G,R,e)=>{"use strict";e.d(R,{l:()=>r});var t=e(74848),n=e(32196),s=e(96540),a=e(49785);function r({defaultValues:g,onSubmit:i,validateOnMount:l=!1,validateFieldsOnMount:d,children:c,validateOn:h="onSubmit",maxWidth:o=600,...m}){const{handleSubmit:u,trigger:p,formState:f,...y}=(0,a.mN)({mode:h,defaultValues:g});return(0,s.useEffect)(()=>{l&&p(d)},[p,d,l]),(0,t.jsx)("form",{className:(0,n.css)({maxWidth:o!=="none"?o+"px":o,width:"100%"}),onSubmit:u(i),...m,children:c({errors:f.errors,formState:f,trigger:p,...y})})}},14186:(G,R,e)=>{"use strict";e.d(R,{I:()=>l});var t=e(74848),n=e(32196),s=e(96540),a=e(40845),r=e(67892),g=e(72093),i=e(76892);const l=({children:c,label:h,tooltip:o,labelWidth:m="auto",invalid:u,loading:p,disabled:f,required:y,className:x,htmlFor:v,grow:P,shrink:E,error:D,transparent:C,interactive:b,validationMessageHorizontalOverflow:T,...S})=>{const O=(0,a.$j)(),M=d(O,P,E),I=v??(0,r.getChildId)(c),L=typeof h=="string"?(0,t.jsx)(i.c,{interactive:b,width:m,tooltip:o,htmlFor:I,transparent:C,children:`${h}${y?" *":""}`}):h;return(0,t.jsxs)("div",{className:(0,n.cx)(M.container,x),...S,children:[L,(0,t.jsxs)("div",{className:M.childContainer,children:[(0,s.cloneElement)(c,{invalid:u,disabled:f,loading:p}),u&&D&&(0,t.jsx)("div",{className:(0,n.cx)(M.fieldValidationWrapper,{[M.validationMessageHorizontalOverflow]:!!T}),children:(0,t.jsx)(g.P,{children:D})})]})]})};l.displayName="InlineField";const d=(c,h,o)=>({container:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative",flex:`${h?1:0} ${o?1:0} auto`,margin:`0 ${c.spacing(.5)} ${c.spacing(.5)} 0`}),childContainer:(0,n.css)({flex:`${h?1:0} ${o?1:0} auto`}),fieldValidationWrapper:(0,n.css)({marginTop:c.spacing(.5)}),validationMessageHorizontalOverflow:(0,n.css)({width:0,overflowX:"visible","& > *":{whiteSpace:"nowrap"}})})},39268:(G,R,e)=>{"use strict";e.d(R,{C:()=>a});var t=e(74848),n=e(32196),s=e(40845);const a=({children:g,className:i,...l})=>{const d=(0,s.of)(r);return(0,t.jsx)("div",{className:(0,n.cx)(d.container,i),...l,children:g})},r=g=>({container:(0,n.css)({label:"InlineFieldRow",display:"flex",flexDirection:"row",flexWrap:"wrap",alignContent:"flex-start",rowGap:g.spacing(.5)})})},76892:(G,R,e)=>{"use strict";e.d(R,{c:()=>g});var t=e(74848),n=e(32196),s=e(40845),a=e(14578),r=e(56034);const g=({children:l,className:d,tooltip:c,width:h,transparent:o,interactive:m,as:u="label",...p})=>{const f=(0,s.of)(i,o,h);return(0,t.jsxs)(u,{className:(0,n.cx)(f.label,d),...p,children:[l,c&&(0,t.jsx)(r.m,{interactive:m,placement:"top",content:c,theme:"info",children:(0,t.jsx)(a.I,{tabIndex:0,name:"info-circle",size:"sm",className:f.icon})})]})},i=(l,d=!1,c)=>({label:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-between",flexShrink:0,padding:l.spacing(0,1),fontWeight:l.typography.fontWeightMedium,fontSize:l.typography.size.sm,backgroundColor:d?"transparent":l.colors.background.secondary,height:l.spacing(l.components.height.md),lineHeight:l.spacing(l.components.height.md),marginRight:l.spacing(.5),borderRadius:l.shape.radius.default,border:"none",width:c?c!=="auto"?`${8*c}px`:c:"100%",color:l.colors.text.primary}),icon:(0,n.css)({color:l.colors.text.secondary,marginLeft:"10px",":hover":{color:l.colors.text.primary}})})},63056:(G,R,e)=>{"use strict";e.d(R,{e:()=>a});var t=e(74848),n=e(32196),s=e(40845);const a=({children:g,className:i,grow:l,...d})=>{const c=(0,s.of)(r,l);return(0,t.jsx)("div",{className:(0,n.cx)(c.container,i),...d,children:g})};a.displayName="InlineSegmentGroup";const r=(g,i)=>({container:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative",flex:`${i?1:0} 0 auto`,marginBottom:g.spacing(.5)})})},60029:(G,R,e)=>{"use strict";e.d(R,{J:()=>r,f:()=>g});var t=e(74848),n=e(32196),s=e(40845),a=e(14578);const r=({children:i,description:l,className:d,category:c,...h})=>{const o=(0,s.of)(g),m=c?.map((u,p)=>(0,t.jsxs)("span",{className:o.categories,children:[(0,t.jsx)("span",{children:u}),(0,t.jsx)(a.I,{name:"angle-right",className:o.chevron})]},`${u}/${p}`));return(0,t.jsx)("div",{className:(0,n.cx)(o.label,d),children:(0,t.jsxs)("label",{...h,children:[(0,t.jsxs)("div",{className:o.labelContent,children:[m,i]}),l&&(0,t.jsx)("span",{className:o.description,children:l})]})})},g=i=>({label:(0,n.css)({label:"Label",fontSize:i.typography.size.sm,fontWeight:i.typography.fontWeightMedium,lineHeight:1.25,marginBottom:i.spacing(.5),color:i.colors.text.primary,maxWidth:"480px"}),labelContent:(0,n.css)({display:"flex",alignItems:"center"}),description:(0,n.css)({label:"Label-description",color:i.colors.text.secondary,fontSize:i.typography.size.sm,fontWeight:i.typography.fontWeightRegular,marginTop:i.spacing(.25),display:"block"}),categories:(0,n.css)({label:"Label-categories",display:"inline-flex",alignItems:"center"}),chevron:(0,n.css)({margin:i.spacing(0,.25)})})},91634:(G,R,e)=>{"use strict";e.d(R,{O:()=>g,p:()=>i});var t=e(74848),n=e(46942),s=e.n(n),a=e(96540),r=e(29734),g=(l=>(l.Invalid="invalid",l.Valid="valid",l))(g||{});class i extends a.PureComponent{constructor(){super(...arguments),this.state={error:null},this.validatorAsync=d=>c=>{const h=(0,r.tf)(c.target.value,d);this.setState(o=>({...o,error:h?h[0]:null}))},this.populateEventPropsWithStatus=(d,c)=>{const h={...d};return c&&Object.keys(r.Pw).forEach(o=>{((0,r.K)(o,c)||d[o])&&(h[o]=async m=>{m.persist(),(0,r.K)(o,c)&&await this.validatorAsync(c[o]).apply(this,[m]),d[o]&&d[o].apply(null,[m,this.status])})}),h}}static{this.defaultProps={className:""}}get status(){return this.state.error?"invalid":"valid"}get isInvalid(){return this.status==="invalid"}render(){const{validationEvents:d,className:c,hideErrorMessage:h,inputRef:o,...m}=this.props,{error:u}=this.state,p=s()("gf-form-input",{invalid:this.isInvalid},c),f=this.populateEventPropsWithStatus(m,d);return(0,t.jsxs)("div",{style:{flexGrow:1},children:[(0,t.jsx)("input",{...f,ref:o,className:p}),u&&!h&&(0,t.jsx)("span",{children:u})]})}}},17408:(G,R,e)=>{"use strict";e.d(R,{s:()=>r});var t=e(74848),n=e(32196),s=e(40845);const a=g=>({legend:(0,n.css)({fontSize:g.typography.h3.fontSize,fontWeight:g.typography.fontWeightRegular,margin:g.spacing(0,0,2,0)})}),r=({children:g,className:i,...l})=>{const d=(0,s.of)(a);return(0,t.jsx)("legend",{className:(0,n.cx)(d.legend,i),...l,children:g})}},94354:(G,R,e)=>{"use strict";e.d(R,{z:()=>u});var t=e(74848),n=e(32196),s=e(2543),a=e(96540),r=e(8887),g=e(40845),i=e(14578),l=e(13544),d=e(16797),c=e(56034),h=e(87266);const o=a.forwardRef(({children:f,active:y=!1,disabled:x=!1,size:v="md",onChange:P,onClick:E,id:D,name:C=void 0,description:b,fullWidth:T,"aria-label":S},O)=>{const M=(0,g.of)(m,v,T),I=(0,t.jsx)("input",{type:"radio",className:M.radio,onChange:P,onClick:E,disabled:x,id:D,checked:y,name:C,"aria-label":S,ref:O});return b?(0,t.jsxs)("div",{className:M.radioOption,"data-testid":l.Tp.components.RadioButton.container,children:[(0,t.jsx)(c.m,{content:b,placement:"bottom",children:I}),(0,t.jsx)("label",{className:M.radioLabel,htmlFor:D,title:b||S,children:f})]}):(0,t.jsxs)("div",{className:M.radioOption,"data-testid":l.Tp.components.RadioButton.container,children:[I,(0,t.jsx)("label",{className:M.radioLabel,htmlFor:D,title:b||S,children:f})]})});o.displayName="RadioButton";const m=(f,y,x)=>{const{fontSize:v,height:P,padding:E}=(0,h.SM)(y,f),D=f.colors.text.secondary,C=f.colors.text.primary,b=P*f.spacing.gridSize-4-2;return{radioOption:(0,n.css)({display:"flex",justifyContent:"space-between",position:"relative",flex:x?"1 0 0":"none",textAlign:"center"}),radio:(0,n.css)({position:"absolute",opacity:0,zIndex:2,width:"100% !important",height:"100%",cursor:"pointer","&:checked + label":{color:f.colors.text.primary,fontWeight:f.typography.fontWeightMedium,background:f.colors.action.selected,zIndex:1},"&:focus + label, &:focus-visible + label":(0,d.getFocusStyles)(f),"&:focus:not(:focus-visible) + label":(0,d.getMouseFocusStyles)(f),"&:disabled + label":{color:f.colors.text.disabled,cursor:"not-allowed"}}),radioLabel:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"center",fontSize:v,height:`${b}px`,lineHeight:`${b}px`,color:D,padding:f.spacing(0,E),borderRadius:f.shape.radius.default,background:f.colors.background.primary,cursor:"pointer",userSelect:"none",whiteSpace:"nowrap",flexGrow:1,"&:hover":{color:C}})}};function u({options:f,value:y,onChange:x,onClick:v,disabled:P,disabledOptions:E,size:D="md",id:C,className:b,fullWidth:T=!1,autoFocus:S=!1,"aria-label":O,invalid:M=!1}){const I=(0,a.useCallback)(W=>()=>{x&&x(W.value)},[x]),L=(0,a.useCallback)(W=>()=>{v&&v(W.value)},[v]),B=C??(0,s.uniqueId)("radiogroup-"),j=(0,a.useRef)(B),A=(0,g.of)(p),K=(0,a.useRef)(null);return(0,a.useEffect)(()=>{S&&K.current&&K.current.focus()},[S]),(0,t.jsx)("div",{role:"radiogroup","aria-label":O,className:(0,n.cx)(A.radioGroup,T&&A.fullWidth,M&&A.invalid,b),children:f.map((W,U)=>{const F=E&&W.value&&E.includes(W.value),V=W.icon?(0,r.Uo)(W.icon):void 0,w=!!(W.imgUrl||W.label||W.component);return(0,t.jsxs)(o,{size:D,disabled:F||P,active:y===W.value,"aria-label":W.ariaLabel,onChange:I(W),onClick:L(W),id:`option-${W.value}-${B}`,name:j.current,description:W.description,fullWidth:T,ref:y===W.value?K:void 0,children:[V&&(0,t.jsx)(i.I,{name:V,className:(0,n.cx)(w&&A.icon)}),W.imgUrl&&(0,t.jsx)("img",{src:W.imgUrl,alt:W.label,className:A.img}),W.label," ",W.component?(0,t.jsx)(W.component,{}):null]},`o.label-${U}`)})})}u.displayName="RadioButtonGroup";const p=f=>({radioGroup:(0,n.css)({backgroundColor:f.colors.background.primary,display:"inline-flex",flexDirection:"row",flexWrap:"nowrap",border:`1px solid ${f.components.input.borderColor}`,borderRadius:f.shape.radius.default,padding:"2px"}),fullWidth:(0,n.css)({display:"flex"}),icon:(0,n.css)({marginRight:"6px"}),img:(0,n.css)({width:f.spacing(2),height:f.spacing(2),marginRight:f.spacing(1)}),invalid:(0,n.css)({border:`1px solid ${f.colors.error.border}`})})},79569:(G,R,e)=>{"use strict";e.d(R,{J:()=>a});var t=e(74848),n=e(32196),s=e(40845);const a=({id:g,name:i,label:l,checked:d,value:c,disabled:h,description:o,onChange:m,...u})=>{const p=(0,s.of)(r);return(0,t.jsxs)("label",{title:o,className:p.label,children:[(0,t.jsx)("input",{...u,id:g,name:i,type:"radio",checked:d,value:c,disabled:h,className:p.input,onChange:()=>m&&m(g)}),(0,t.jsxs)("div",{children:[l,o&&(0,t.jsx)("div",{className:p.description,children:o})]})]})},r=g=>({input:(0,n.css)({position:"relative",appearance:"none",outline:"none",backgroundColor:g.colors.background.canvas,width:`${g.spacing(2)} !important`,height:g.spacing(2),border:`1px solid ${g.colors.border.medium}`,borderRadius:g.shape.radius.circle,margin:"3px 0",":checked":{backgroundColor:g.v1.palette.white,border:`5px solid ${g.colors.primary.main}`},":disabled":{backgroundColor:`${g.colors.action.disabledBackground} !important`,borderColor:g.colors.border.weak},":disabled:checked":{border:`1px solid ${g.colors.border.weak}`},":disabled:checked::after":{content:'""',width:"6px",height:"6px",backgroundColor:g.colors.text.disabled,borderRadius:g.shape.radius.circle,display:"inline-block",position:"absolute",top:"4px",left:"4px"},":focus":{outline:"none !important",boxShadow:`0 0 0 1px ${g.colors.background.canvas}, 0 0 0 3px ${g.colors.primary.main}`}}),label:(0,n.css)({fontSize:g.typography.fontSize,lineHeight:"22px",display:"grid",gridTemplateColumns:`${g.spacing(2)} auto`,gap:g.spacing(1)}),description:(0,n.css)({fontSize:g.typography.size.sm,color:g.colors.text.secondary})})},83186:(G,R,e)=>{"use strict";e.d(R,{a:()=>i});var t=e(74848),n=e(32196),s=e(2543),a=e.n(s),r=e(40845),g=e(79569);function i({name:d,id:c,options:h,value:o,onChange:m,className:u,disabled:p,disabledOptions:f=[]}){const y=(0,r.of)(l),x=c??(0,s.uniqueId)("radiogroup-list-");return(0,t.jsx)("div",{id:c,className:(0,n.cx)(y.container,u),role:"radiogroup",children:h.map((v,P)=>{const E=`${x}-${P}`,D=o&&o===v.value,C=p||f.some(T=>T===v.value),b=()=>m&&v.value&&m(v.value);return(0,t.jsx)(g.J,{id:E,name:d,label:v.label,description:v.description,checked:D,value:v.value,disabled:C,onChange:b},P)})})}const l=d=>({container:(0,n.css)({display:"grid",gap:d.spacing(1)})})},95164:(G,R,e)=>{"use strict";e.d(R,{_:()=>f});var t=e(74848),n=e(34796),s=e.n(n),a=e(96540),r=e(83195),g=e(58649),i=e(50082),l=e(52622),d=e(29413),c=e(55852),h=e(24293),o=e(47737);const m={mode:i.O.Absolute,steps:[{value:-1/0,color:"green"},{value:80,color:"red"}]};function u(y,x,v,P){const E=v!=null,D=P===l.wV.Vertical?x:y,C=Math.min(D*.15/1.5,20),b=C*1.5,T=E?x-b:x,S=Math.min(T,y);return{showLabel:E,gaugeHeight:S,titleFontSize:C}}function p(y,x,v,P){if(x.color?.mode!==h.Y.Thresholds)return[{value:x.min??g.tw,color:v.color??h.F}];const E=x.thresholds??m,D=E.mode===i.O.Percentage,C=E.steps;let b=x.min??g.tw,T=x.max??g.d1;D&&(b=0,T=100);const S=(0,o.yQ)(b,C),O=(0,o.yQ)(T,C),M=[{value:+b.toFixed(y),color:P.visualization.getColorByName(S.color)}];let I=!0;for(let L=0;L<C.length;L++){const B=C[L];if(I){S===B&&(I=!1);continue}const j=C[L-1];if(M.push({value:B.value,color:P.visualization.getColorByName(j.color)}),B===O)break}return M.push({value:+T.toFixed(y),color:P.visualization.getColorByName(O.color)}),M}class f extends a.PureComponent{constructor(){super(...arguments),this.canvasElement=null,this.renderVisualization=()=>{const{width:x,value:v,height:P,onClick:E,text:D,theme:C,orientation:b}=this.props,T=u(x,P,v.title,b),S=b===l.wV.Vertical?`${T.gaugeHeight}px`:"100%",O=(0,t.jsx)("div",{style:{height:`${T.gaugeHeight}px`,width:S},ref:M=>this.canvasElement=M});return(0,t.jsxs)(t.Fragment,{children:[E?(0,t.jsx)("button",{className:(0,c.my)(C),type:"button",onClick:E,children:O}):O,T.showLabel&&(0,t.jsx)("div",{style:{textAlign:"center",fontSize:D?.titleSize??T.titleFontSize,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",position:"relative",width:S,top:"-4px",cursor:"default"},children:v.title})]})}}static{this.defaultProps={showThresholdMarkers:!0,showThresholdLabels:!1,field:{min:0,max:100,thresholds:m}}}componentDidMount(){this.draw()}componentDidUpdate(){this.draw()}draw(){const{field:x,showThresholdLabels:v,showThresholdMarkers:P,width:E,height:D,theme:C,value:b,orientation:T}=this.props,S=u(E,D,b.title),O=T===l.wV.Vertical?S.gaugeHeight:E,M=Math.min(O,S.gaugeHeight),I=C.colors.background.secondary,L=v?1.5:1,B=Math.min(M/5.5,40)/L,j=B/5,A=(0,r.cN)(b),W=Math.min(O,M*1.3)*.9-((B+(P?j:0)+(v?10:0))*2+10),U=this.props.text?.valueSize??(0,d.Vr)(A,W,M,1,B*1.7),F=Math.max(U/2.5,12);let V=x.min??g.tw,w=x.max??g.d1,z=b.numeric;x.thresholds?.mode===i.O.Percentage&&(V=0,w=100,b.percent===void 0?z=(z-V)/(w-V)*100:z=b.percent*100);const N=x.decimals===void 0?2:x.decimals;P&&(V=+V.toFixed(N),w=+w.toFixed(N));const H={series:{gauges:{gauge:{min:V,max:w,neutralValue:x.custom?.neutral,background:{color:I},border:{color:null},shadow:{show:!1},width:B},frame:{show:!1},label:{show:!1},layout:{margin:0,thresholdWidth:0,vMargin:0},cell:{border:{width:0}},threshold:{values:p(N,x,b,C),label:{show:v,margin:j+1,font:{size:F}},show:P,width:j},value:{color:b.color,formatter:()=>A,font:{size:U,family:C.typography.fontFamily}},show:!0}}},Q={data:[[0,z]],label:b.title};try{this.canvasElement&&s().plot(this.canvasElement,[Q],H)}catch(X){console.error("Gauge rendering error",X,H,b)}}render(){return(0,t.jsx)("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",overflow:"hidden"},className:this.props.className,children:this.renderVisualization()})}}},37166:(G,R,e)=>{"use strict";e.d(R,{w:()=>i});var t=e(74848),n=e(32196),s=e(96540),a=e(40845),r=e(42418),g=e(14578);const i=s.memo(s.forwardRef(({title:d,className:c,children:h,branded:o,url:m,urlTitle:u,onDismiss:p,severity:f="info",...y},x)=>{const v=(0,a.of)(l);return(0,t.jsxs)(r.F,{severity:f,className:c,...y,ref:x,title:d,children:[(0,t.jsx)("div",{children:h}),m&&(0,t.jsxs)("a",{href:m,className:(0,n.cx)("external-link",v.docsLink),target:"_blank",rel:"noreferrer",children:[(0,t.jsx)(g.I,{name:"book"})," ",u||"Read more"]})]})}));i.displayName="InfoBox";const l=d=>({docsLink:(0,n.css)({display:"inline-block",marginTop:d.spacing(2)})})},32982:(G,R,e)=>{"use strict";e.d(R,{r:()=>c});var t=e(74848),n=e(32196),s=e(34743),a=e(83505),r=e(46885),g=e(96540),i=e(40845),l=e(14578),d=e(17464);function c({referenceElement:m,children:u,suffixIcon:p,placement:f}){const y=(0,i.of)(h),x=(0,i.$j)(),v=[(0,s.cY)(8),(0,s.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,s.BN)()],{context:P,refs:E,floatingStyles:D}=(0,a.we)({open:!0,placement:f,middleware:v,whileElementsMounted:r.ll,strategy:"fixed"});(0,g.useLayoutEffect)(()=>{E.setReference(m)},[m,E]);const{styles:C}=(0,a.DL)(P,{initial:({side:b})=>({opacity:0,transform:o(b,x)}),duration:x.transitions.duration.shortest});return(0,t.jsx)(d.ZL,{children:(0,t.jsx)("div",{style:{display:"inline-block",...D},ref:E.setFloating,"aria-live":"polite",children:(0,t.jsxs)("span",{className:(0,n.cx)(y.root),style:C,children:[u&&(0,t.jsx)("span",{children:u}),p&&(0,t.jsx)(l.I,{name:p})]})})})}const h=m=>({root:(0,n.css)({...m.typography.bodySmall,willChange:"transform",background:m.components.tooltip.background,color:m.components.tooltip.text,padding:m.spacing(.5,1.5),borderRadius:m.shape.radius.pill,display:"inline-flex",gap:m.spacing(.5),alignItems:"center"})}),o=(m,u)=>{switch(m){case"top":return`translateY(${u.spacing(1)})`;case"bottom":return`translateY(-${u.spacing(1)})`;case"left":return`translateX(${u.spacing(1)})`;case"right":return`translateX(-${u.spacing(1)})`}}},51440:(G,R,e)=>{"use strict";e.d(R,{D:()=>r});var t=e(74848),n=e(96540),s=e(29413),a=e(10354);const r=n.forwardRef((i,l)=>{const{defaultValue:d="",minWidth:c=10,maxWidth:h,onCommitChange:o,onKeyDown:m,onBlur:u,value:p,...f}=i,[y,x]=n.useState(p??d),[v,P]=n.useState(c);return(0,n.useEffect)(()=>{p&&x(p)},[p]),(0,n.useEffect)(()=>{P(g(y.toString(),c,h))},[y,c,h]),(0,t.jsx)(a.p,{...f,ref:l,value:y.toString(),onChange:E=>{x(E.currentTarget.value)},width:v,onBlur:E=>{u?u(E):o&&o(E)},onKeyDown:E=>{m?m(E):E.key==="Enter"&&o&&o(E)},"data-testid":"autosize-input"})});function g(i,l,d){if(!i)return l;const h=(0,s.kD)(i.toString(),14).width/8+3;return l&&h<l?l:d&&h>d?d:h}r.displayName="AutoSizeInput"},16504:(G,R,e)=>{"use strict";e.d(R,{e:()=>n});var t=e(49785);const n=t.xI},48840:(G,R,e)=>{"use strict";e.d(R,{j:()=>x});var t=e(74848),n=e(32196),s=e(2543),a=e(96540),r=e(32885),g=e(39070),i=e(40845),l=e(14578),d=e(19384),c=e(56034),h=e(29158);const o=(0,n.css)({display:"flex",alignItems:"center",height:"100%"});function m({row:D,__rowID:C}){return(0,t.jsx)("div",{className:o,children:(0,t.jsx)(h.K,{tooltip:"toggle row expanded","aria-controls":C,name:D.isExpanded?"angle-down":"angle-right","aria-expanded":D.isExpanded,...D.getToggleRowExpandedProps(),size:"lg"})})}function u({isAllRowsExpanded:D,toggleAllRowsExpanded:C}){return(0,t.jsx)("div",{className:o,children:(0,t.jsx)(h.K,{"aria-label":D?"Collapse all rows":"Expand all rows",name:D?"table-collapse-all":"table-expand-all",onClick:()=>C(),size:"lg",tooltip:D?"Collapse all rows":"Expand all rows",variant:"secondary"})})}const p="__expander";function f(D,C=!1){return[{id:p,Cell:m,...C&&{Header:u},disableSortBy:!0,width:0},...D.map(b=>({id:b.id,accessor:b.id,Header:b.header||(()=>null),sortType:b.sortType||"alphanumeric",disableSortBy:!b.sortType,width:b.disableGrow?0:void 0,visible:b.visible,...b.cell&&{Cell:b.cell}}))]}const y=D=>{const C=D.colors.emphasize(D.colors.background.primary,.03);return{container:(0,n.css)({display:"flex",gap:D.spacing(2),flexDirection:"column",width:"100%",overflowX:"auto"}),cell:(0,n.css)({padding:D.spacing(1),minWidth:D.spacing(3)}),table:(0,n.css)({borderRadius:D.shape.radius.default,width:"100%"}),disableGrow:(0,n.css)({width:0}),header:(0,n.css)({borderBottom:`1px solid ${D.colors.border.weak}`,minWidth:D.spacing(3),"&, & > button":{position:"relative",whiteSpace:"nowrap",padding:D.spacing(1)},"& > button":{"&:after":{content:'"\\00a0"'},width:"100%",height:"100%",background:"none",border:"none",paddingRight:D.spacing(2.5),textAlign:"left",fontWeight:D.typography.fontWeightMedium}}),row:(0,n.css)({label:"row",borderBottom:`1px solid ${D.colors.border.weak}`,"&:hover":{backgroundColor:C},"&:last-child":{borderBottom:0}}),expandedRow:(0,n.css)({label:"expanded-row-content",borderBottom:"none"}),expandedContentCell:(0,n.css)({borderBottom:`1px solid ${D.colors.border.weak}`,position:"relative",padding:D.spacing(2,2,2,5),"&:before":{content:'""',position:"absolute",width:"1px",top:0,left:"16px",bottom:D.spacing(2),background:D.colors.border.medium}}),expandedContentRow:(0,n.css)({label:"expanded-row-content"}),sortableHeader:(0,n.css)({"&&":{padding:0}})}};function x({className:D,columns:C,data:b,getRowId:T,headerTooltips:S,pageSize:O=0,renderExpandedRow:M,showExpandAll:I=!1,fetchData:L,initialSortBy:B=[]}){const j=(0,i.of)(y),A=(0,a.useMemo)(()=>f(C,I),[C,I]),K=v(),W=(0,a.useCallback)(ee=>`${K}-${ee.id}`.replace(/\s/g,""),[K]),U=[r.useSortBy,r.useExpanded],F=b.length>O,V=O>0;V&&U.push(r.usePagination);const w=(0,r.useTable)({columns:A,data:b,autoResetExpanded:!1,autoResetSortBy:!1,disableMultiSort:!0,manualSortBy:!!L,getRowId:T,initialState:{hiddenColumns:[!M&&p,...A.filter(ee=>!(!ee.visible||ee.visible(b))).map(ee=>ee.id).filter(g.zz)].filter(g.zz),sortBy:B}},...U),{getTableProps:z,getTableBodyProps:N,headerGroups:H,prepareRow:Q}=w,{sortBy:X}=w.state;return(0,a.useEffect)(()=>{L&&L({sortBy:X})},[X,L]),(0,a.useEffect)(()=>{V&&w.setPageSize(O)},[V,O,w.setPageSize,w]),(0,t.jsxs)("div",{className:j.container,children:[(0,t.jsxs)("table",{...z(),className:(0,n.cx)(j.table,D),children:[(0,t.jsx)("thead",{children:H.map(ee=>{const{key:Z,...q}=ee.getHeaderGroupProps();return(0,t.jsx)("tr",{...q,children:ee.headers.map(ae=>{const{key:k,...se}=ae.getHeaderProps(),te=S?.[ae.id];return(0,t.jsx)("th",{className:(0,n.cx)(j.header,{[j.disableGrow]:ae.width===0,[j.sortableHeader]:ae.canSort}),...se,...ae.isSorted&&{"aria-sort":ae.isSortedDesc?"descending":"ascending"},children:(0,t.jsx)(E,{column:ae,headerTooltip:te})},k)})},Z)})}),(0,t.jsx)("tbody",{...N(),children:(V?w.page:w.rows).map(ee=>{Q(ee);const{key:Z,...q}=ee.getRowProps(),ae=W(ee),k=ee.isExpanded;return(0,t.jsxs)(a.Fragment,{children:[(0,t.jsx)("tr",{...q,className:(0,n.cx)(j.row,k&&j.expandedRow),children:ee.cells.map(se=>{const{key:te,...ne}=se.getCellProps();return(0,t.jsx)("td",{className:j.cell,...ne,children:se.render("Cell",{__rowID:ae})},te)})}),k&&M&&(0,t.jsx)("tr",{...q,id:ae,className:j.expandedContentRow,children:(0,t.jsx)("td",{className:j.expandedContentCell,colSpan:ee.cells.length,children:M(ee.original)})})]},Z)})})]}),V&&F&&(0,t.jsx)("span",{children:(0,t.jsx)(d.d,{currentPage:w.state.pageIndex+1,numberOfPages:w.pageOptions.length,onNavigate:ee=>w.gotoPage(ee-1)})})]})}const v=()=>(0,a.useMemo)(()=>(0,s.uniqueId)("InteractiveTable"),[]),P=D=>({sortIcon:(0,n.css)({position:"absolute",top:D.spacing(1)}),headerTooltipIcon:(0,n.css)({marginLeft:D.spacing(.5)})});function E({column:{canSort:D,render:C,isSorted:b,isSortedDesc:T,getSortByToggleProps:S},headerTooltip:O}){const M=(0,i.of)(P),{onClick:I}=S(),L=(0,t.jsxs)(t.Fragment,{children:[C("Header"),O&&(0,t.jsx)(c.m,{theme:"info-alt",content:O.content,placement:"top-end",children:(0,t.jsx)(l.I,{className:M.headerTooltipIcon,name:O.iconName||"info-circle","data-testid":"header-tooltip-icon"})}),b&&(0,t.jsx)("span",{"aria-hidden":"true",className:M.sortIcon,children:(0,t.jsx)(l.I,{name:T?"angle-down":"angle-up"})})]});return D?(0,t.jsx)("button",{type:"button",onClick:I,children:L}):L}},24022:(G,R,e)=>{"use strict";e.d(R,{B:()=>a});var t=e(74848),n=e(96540),s=e(44533);class a extends n.PureComponent{constructor(){super(...arguments),this.wrapperRef=(0,n.createRef)(),this.renderJson=()=>{const{json:g,config:i,open:l,onDidRender:d}=this.props,c=this.wrapperRef.current,h=new s.O(g,l,i);c.hasChildNodes()?c.replaceChild(h.render(),c.lastChild):c.appendChild(h.render()),d&&d(h.json)}}static{this.defaultProps={open:3,config:{animateOpen:!0}}}componentDidMount(){this.renderJson()}componentDidUpdate(){this.renderJson()}render(){const{className:g}=this.props;return(0,t.jsx)("div",{className:g,ref:this.wrapperRef})}}},44533:(G,R,e)=>{"use strict";e.d(R,{O:()=>y});var t=e(2543);function n(x){return x.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function s(x){return!!x&&typeof x==="object"}function a(x){if(x===void 0)return"";if(x===null||typeof x=="object"&&!x.constructor)return"Object";const P=/function ([^(]*)/.exec(x.constructor.toString());return P&&P.length>1?P[1]:""}function r(x){return x===null?"null":typeof x}function g(x,v){const P=r(x);return P==="null"||P==="undefined"?P:(P==="string"&&(v='"'+n(v)+'"'),P==="function"?x.toString().replace(/[\r\n]/g,"").replace(/\{.*\}/,"")+"{\u2026}":v)}let i="";function l(x){return s(x)?(i=a(x),Array.isArray(x)&&(i+="["+x.length+"]")):i=g(x,x.toString()),i}function d(x){return`json-formatter-${x}`}function c(x,v,P){const E=document.createElement(x);return v&&E.classList.add(d(v)),P!==void 0&&(P instanceof Node?E.appendChild(P):E.appendChild(document.createTextNode(String(P)))),E}const h=/(^\d{1,4}[\.|\\/|-]\d{1,2}[\.|\\/|-]\d{1,4})(\s*(?:0?[1-9]:[0-5]|1(?=[012])\d:[0-5])\d\s*[ap]m)?$/,o=/\d{2}:\d{2}:\d{2} GMT-\d{4}/,m=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/,u=10,p=typeof window<"u"&&window.requestAnimationFrame||(x=>(x(),0)),f={animateOpen:!0,animateClose:!0};class y{constructor(v,P=1,E=f,D){this.json=v,this.open=P,this.config=E,this.key=D,this._isOpen=null,this.element=null,this.skipChildren=!1}get isOpen(){return this._isOpen!==null?this._isOpen:this.open>0}set isOpen(v){this._isOpen=v}get isDate(){return this.type==="string"&&(h.test(this.json)||m.test(this.json)||o.test(this.json))}get isUrl(){return this.type==="string"&&this.json.indexOf("http")===0}get isArray(){return Array.isArray(this.json)}get isObject(){return s(this.json)}get isEmptyObject(){return!this.keys.length&&!this.isArray}get isEmpty(){return this.isEmptyObject||this.keys&&!this.keys.length&&this.isArray}get hasKey(){return typeof this.key<"u"}get constructorName(){return a(this.json)}get type(){return r(this.json)}get keys(){return this.isObject?Object.keys(this.json).map(v=>v||'""'):[]}toggleOpen(){this.isOpen=!this.isOpen,this.element&&(this.isOpen?this.appendChildren(this.config.animateOpen):this.removeChildren(this.config.animateClose),this.element.classList.toggle(d("open")))}openAtDepth(v=1){v<0||(this.open=v,this.isOpen=v!==0,this.element&&(this.removeChildren(!1),v===0?this.element.classList.remove(d("open")):(this.appendChildren(this.config.animateOpen),this.element.classList.add(d("open")))))}isNumberArray(){return this.json.length>0&&this.json.length<4&&((0,t.isNumber)(this.json[0])||(0,t.isNumber)(this.json[1]))}renderArray(){const v=c("span");return v.appendChild(c("span","bracket","[")),this.isNumberArray()?(this.json.forEach((P,E)=>{E>0&&v.appendChild(c("span","array-comma",",")),v.appendChild(c("span","number",P))}),this.skipChildren=!0):v.appendChild(c("span","number",this.json.length)),v.appendChild(c("span","bracket","]")),v}render(v=!1){this.element=c("div","row");const P=c("a","toggler-link"),E=c("span","toggler");if(this.isObject&&P.appendChild(E),this.hasKey&&P.appendChild(c("span","key",`${this.key}:`)),this.isObject){const C=c("span","value"),b=c("span"),T=c("span","constructor-name",this.constructorName);if(b.appendChild(T),this.isArray){const S=this.renderArray();b.appendChild(S)}C.appendChild(b),P.appendChild(C)}else{const C=this.isUrl?c("a"):c("span");C.classList.add(d(this.type)),this.isDate&&C.classList.add(d("date")),this.isUrl&&(C.classList.add(d("url")),C.setAttribute("href",this.json));const b=g(this.json,this.json);C.appendChild(document.createTextNode(b)),P.appendChild(C)}const D=c("div","children");return this.isObject&&D.classList.add(d("object")),this.isArray&&D.classList.add(d("array")),this.isEmpty&&D.classList.add(d("empty")),this.config&&this.config.theme&&this.element.classList.add(d(this.config.theme)),this.isOpen&&this.element.classList.add(d("open")),v||this.element.appendChild(P),this.skipChildren?P.removeChild(E):this.element.appendChild(D),this.isObject&&this.isOpen&&this.appendChildren(),this.isObject&&P.addEventListener("click",this.toggleOpen.bind(this)),this.element}appendChildren(v=!1){const P=this.element&&this.element.querySelector(`div.${d("children")}`);if(!(!P||this.isEmpty))if(v){let E=0;const D=()=>{const C=this.keys[E],b=new y(this.json[C],this.open-1,this.config,C);P.appendChild(b.render()),E+=1,E<this.keys.length&&(E>u?D():p(D))};p(D)}else this.keys.forEach(E=>{const D=new y(this.json[E],this.open-1,this.config,E);P.appendChild(D.render())})}removeChildren(v=!1){const P=this.element&&this.element.querySelector(`div.${d("children")}`);if(v){let E=0;const D=()=>{P&&P.children.length&&(P.removeChild(P.children[0]),E+=1,E>u?D():p(D))};p(D)}else P&&(P.innerHTML="")}}},90613:(G,R,e)=>{"use strict";e.d(R,{a:()=>i});var t=e(74848),n=e(32196),s=e(96540),a=e(40845),r=e(16795),g=e(55738);const i=(0,s.forwardRef)((h,o)=>{const{children:m,margin:u,marginX:p,marginY:f,marginTop:y,marginBottom:x,marginLeft:v,marginRight:P,padding:E,paddingX:D,paddingY:C,paddingTop:b,paddingBottom:T,paddingLeft:S,paddingRight:O,display:M,backgroundColor:I,grow:L,shrink:B,basis:j,flex:A,borderColor:K,borderStyle:W,borderRadius:U,direction:F,justifyContent:V,alignItems:w,boxShadow:z,element:N,gap:H,width:Q,minWidth:X,maxWidth:ee,height:Z,minHeight:q,maxHeight:ae,...k}=h,se=(0,a.of)(c,u,p,f,y,x,v,P,E,D,C,b,T,S,O,M,I,L,B,j,A,K,W,U,F,V,w,z,H),te=(0,a.of)(g.E,Q,X,ee,Z,q,ae),ne=N??"div";return(0,t.jsx)(ne,{ref:o,className:(0,n.cx)(se.root,te),...k,children:m})});i.displayName="Box";const l=(h,o)=>{switch(h){case"error":case"success":case"info":case"warning":return o.colors[h].borderTransparent;default:return h?o.colors.border[h]:void 0}},d=(h,o)=>{switch(h){case"error":case"success":case"info":case"warning":return o.colors[h].transparent;default:return h?o.colors.background[h]:void 0}},c=(h,o,m,u,p,f,y,x,v,P,E,D,C,b,T,S,O,M,I,L,B,j,A,K,W,U,F,V,w)=>({root:(0,n.css)([(0,r.Y)(h,o,z=>({margin:h.spacing(z)})),(0,r.Y)(h,m,z=>({marginLeft:h.spacing(z),marginRight:h.spacing(z)})),(0,r.Y)(h,u,z=>({marginTop:h.spacing(z),marginBottom:h.spacing(z)})),(0,r.Y)(h,p,z=>({marginTop:h.spacing(z)})),(0,r.Y)(h,f,z=>({marginBottom:h.spacing(z)})),(0,r.Y)(h,y,z=>({marginLeft:h.spacing(z)})),(0,r.Y)(h,x,z=>({marginRight:h.spacing(z)})),(0,r.Y)(h,v,z=>({padding:h.spacing(z)})),(0,r.Y)(h,P,z=>({paddingLeft:h.spacing(z),paddingRight:h.spacing(z)})),(0,r.Y)(h,E,z=>({paddingTop:h.spacing(z),paddingBottom:h.spacing(z)})),(0,r.Y)(h,D,z=>({paddingTop:h.spacing(z)})),(0,r.Y)(h,C,z=>({paddingBottom:h.spacing(z)})),(0,r.Y)(h,b,z=>({paddingLeft:h.spacing(z)})),(0,r.Y)(h,T,z=>({paddingRight:h.spacing(z)})),(0,r.Y)(h,S,z=>({display:z})),(0,r.Y)(h,O,z=>({backgroundColor:d(z,h)})),(0,r.Y)(h,W,z=>({flexDirection:z})),(0,r.Y)(h,M,z=>({flexGrow:z})),(0,r.Y)(h,I,z=>({flexShrink:z})),(0,r.Y)(h,L,z=>({flexBasis:z})),(0,r.Y)(h,B,z=>({flex:z})),(0,r.Y)(h,A,z=>({borderStyle:z})),(0,r.Y)(h,j,z=>({borderColor:l(z,h)})),(A||j)&&{borderWidth:"1px"},(0,r.Y)(h,U,z=>({justifyContent:z})),(0,r.Y)(h,F,z=>({alignItems:z})),(0,r.Y)(h,K,z=>({borderRadius:h.shape.radius[z]})),(0,r.Y)(h,V,z=>({boxShadow:h.shadows[z]})),(0,r.Y)(h,w,z=>({gap:h.spacing(z)}))])})},71259:(G,R,e)=>{"use strict";e.d(R,{x:()=>g});var t=e(74848),n=e(32196),s=e(96540),a=e(40845),r=e(16795);const g=(0,s.forwardRef)((l,d)=>{const{alignItems:c,children:h,gap:o,columns:m,minColumnWidth:u,...p}=l,f=(0,a.of)(i,o,m,u,c);return(0,t.jsx)("div",{ref:d,...p,className:f.grid,children:h})});g.displayName="Grid";const i=(l,d,c,h,o)=>({grid:(0,n.css)([{display:"grid"},(0,r.Y)(l,d,m=>({gap:l.spacing(m)})),h&&(0,r.Y)(l,h,m=>({gridTemplateColumns:`repeat(auto-fill, minmax(${l.spacing(m)}, 1fr))`})),c&&(0,r.Y)(l,c,m=>({gridTemplateColumns:`repeat(${m}, 1fr)`})),(0,r.Y)(l,o,m=>({alignItems:m}))])})},66864:(G,R,e)=>{"use strict";e.d(R,{Gy:()=>i,PE:()=>g,gW:()=>l,mc:()=>d});var t=e(74848),n=e(32196),s=e(96540),a=e(40845),r=(m=>(m[m.Horizontal=0]="Horizontal",m[m.Vertical=1]="Vertical",m))(r||{});const g=({children:m,orientation:u=0,spacing:p="sm",justify:f="flex-start",align:y="normal",wrap:x=!1,width:v="100%",height:P="100%",...E})=>{const D=(0,a.of)(c,u,p,f,y,x);return(0,t.jsx)("div",{className:D.layout,style:{width:v,height:P},...E,children:s.Children.toArray(m).filter(Boolean).map((C,b)=>(0,t.jsx)("div",{className:D.childWrapper,children:C},b))})},i=({children:m,spacing:u,justify:p,align:f="center",wrap:y,width:x,height:v})=>(0,t.jsx)(g,{spacing:u,justify:p,orientation:0,align:f,width:x,height:v,wrap:y,children:m}),l=({children:m,spacing:u,justify:p,align:f,width:y,height:x})=>(0,t.jsx)(g,{spacing:u,justify:p,orientation:1,align:f,width:y,height:x,children:m}),d=({children:m,padding:u,margin:p,grow:f,shrink:y})=>{const x=(0,a.of)(o,u,p);return(0,t.jsx)("div",{className:(0,n.cx)(x.wrapper,f!==void 0&&(0,n.css)({flexGrow:f}),y!==void 0&&(0,n.css)({flexShrink:y})),children:m})},c=(m,u,p,f,y,x)=>{const v=p!=="none"?m.spacing(h[p]):0,P=u===0&&!x||u===1?0:`-${v}`,E=u===1?"vertical-group":"horizontal-group";return{layout:(0,n.css)({label:E,display:"flex",flexDirection:u===1?"column":"row",flexWrap:x?"wrap":"nowrap",justifyContent:f,alignItems:y,height:"100%",maxWidth:"100%",marginBottom:P}),childWrapper:(0,n.css)({label:"layoutChildrenWrapper",marginBottom:u===0&&!x?0:v,marginRight:u===0?v:0,display:"flex",alignItems:y,"&:last-child":{marginBottom:u===1?0:void 0,marginRight:u===0?0:void 0}})}},h={none:0,xs:.5,sm:1,md:2,lg:3},o=(m,u,p)=>{const f=u&&u!=="none"&&m.spacing(h[u])||0,y=p&&p!=="none"&&m.spacing(h[p])||0;return{wrapper:(0,n.css)({label:"container",margin:y,padding:f})}}},68402:(G,R,e)=>{"use strict";e.d(R,{$:()=>s});var t=e(74848),n=e(90613);const s=({v:a=0,h:r=0,layout:g})=>(0,t.jsx)(n.a,{paddingRight:r,paddingBottom:a,display:g==="inline"?"inline-block":"block"})},50720:(G,R,e)=>{"use strict";e.d(R,{N:()=>g});var t=e(74848),n=e(96540),s=e(35557),a=e(71733),r=e(80997);const g=(0,n.forwardRef)(({href:i,children:l,...d},c)=>{const h=a.I.stripBaseFromUrl(r.sQ.sanitizeUrl(i??""));return(0,t.jsx)(s.Link,{ref:c,to:h,...d,children:l})});g.displayName="Link"},72109:(G,R,e)=>{"use strict";e.d(R,{Y:()=>h});var t=e(74848),n=e(32196),s=e(96540),a=e(80997),r=e(71733),g=e(40845),i=e(14578),l=e(71356),d=e(50720);const c={h1:"xl",h2:"xl",h3:"lg",h4:"lg",h5:"md",h6:"md",body:"md",bodySmall:"xs"},h=(0,s.forwardRef)(({href:m,color:u="link",external:p=!1,inline:f=!0,variant:y="body",weight:x,icon:v,children:P,...E},D)=>{const C=a.sQ.sanitizeUrl(m??""),b=(0,g.$j)(),T=o(b,f,y,x,u),S=v||"external-link-alt";if(p)return(0,t.jsxs)("a",{href:C,ref:D,...E,target:"_blank",rel:"noreferrer",className:T,children:[P,(0,t.jsx)(i.I,{size:c[y]||"md",name:S})]});const O=r.I.stripBaseFromUrl(C);return(0,t.jsxs)(d.N,{ref:D,href:O,...E,className:T,children:[P,v&&(0,t.jsx)(i.I,{name:v,size:c[y]||"md"})]})});h.displayName="TextLink";const o=(m,u,p,f,y)=>(0,n.css)([p&&{...m.typography[p]},f&&{fontWeight:(0,l.iV)(f,m)},y&&{color:m.colors.text[y]},{alignItems:"center",gap:"0.25em",display:"inline-flex",textDecoration:"none","&:hover":{textDecoration:"underline",color:m.colors.text.link}},u&&{textDecoration:"underline","&:hover":{textDecoration:"none"}}])},85918:(G,R,e)=>{"use strict";e.d(R,{p:()=>g});var t=e(74848),n=e(32196),s=e(96540),a=e(3911);const r=(0,a.N)((i=!1)=>({list:(0,n.css)({listStyleType:"none",margin:0,padding:0}),item:(0,n.css)({display:i&&"inline-block"||"block"})}));class g extends s.PureComponent{constructor(l){super(l)}render(){const{items:l,renderItem:d,getItemKey:c,className:h,inline:o}=this.props,m=r(o);return(0,t.jsx)("ul",{className:(0,n.cx)(m.list,h),children:l.map((u,p)=>(0,t.jsx)("li",{className:m.item,children:d(u,p)},c?c(u):p))})}}},1551:(G,R,e)=>{"use strict";e.d(R,{c:()=>a});var t=e(74848),n=e(96540),s=e(85918);class a extends n.PureComponent{render(){return(0,t.jsx)(s.p,{inline:!0,...this.props})}}},33552:(G,R,e)=>{"use strict";e.d(R,{B:()=>a});var t=e(74848),n=e(96540),s=e(85918);class a extends n.PureComponent{render(){return(0,t.jsx)(s.p,{...this.props})}}},57514:(G,R,e)=>{"use strict";e.d(R,{G:()=>c});var t=e(74848),n=e(32196),s=e(40845);const a=28,r=2.4,g=500,i=4e3,l=300,d=100/a*100;function c({width:o,delay:m=l,ariaLabel:u="Loading bar"}){const p=Math.min(Math.max(Math.round(o*r),g),i),f=(0,s.of)(h,m,p),y={overflow:"hidden"};return(0,t.jsx)("div",{style:y,children:(0,t.jsx)("div",{"aria-label":u,className:f.bar})})}const h=(o,m,u)=>{const p=(0,n.keyframes)({"0%":{transform:"translateX(-100%)"},"85%, 100%":{transform:`translateX(${d}%)`}});return{bar:(0,n.css)({width:a+"%",height:1,background:"linear-gradient(90deg, rgba(110, 159, 255, 0) 0%, #6E9FFF 80.75%, rgba(110, 159, 255, 0) 100%)",transform:"translateX(-100%)",willChange:"transform",[o.transitions.handleMotion("no-preference")]:{animationName:p,animationDelay:`${m}ms`,animationTimingFunction:"linear",animationIterationCount:"infinite",animationDuration:`${u}ms`},[o.transitions.handleMotion("reduce")]:{animationName:p,animationDelay:`${m}ms`,animationTimingFunction:"linear",animationIterationCount:"infinite",animationDuration:`${4*u}ms`}})}}},76218:(G,R,e)=>{"use strict";e.d(R,{O:()=>r});var t=e(74848),n=e(96540),s=e(90182),a=e(64278);const r=({value:g,onChange:i,context:l,item:d})=>{const c=d.settings??{},h=(0,a.sE)(l.data,c?.filter),o=(0,a.m3)(h,g,void 0,void 0,c.baseNameMode),m=(0,n.useCallback)(p=>{if(!(p&&!(0,a.v3)(p.value,h)))return i(p?.value)},[h,i]),u=o.find(p=>p.value===g);return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(s.l6,{value:u,placeholder:c.placeholderText??"Select field",options:o,onChange:m,noOptionsMessage:c.noFieldsMessage,width:c.width,isClearable:c.isClearable!==!1})})}},9988:(G,R,e)=>{"use strict";e.d(R,{bx:()=>d,cH:()=>o});var t=e(74848),n=e(96540),s=e(11261),a=e(1173),r=e(85200),g=e(4025),i=e(90182);const l=(0,n.memo)(m=>{const{data:u,options:p,onChange:f,id:y}=m,x=c(u),v=h(x,p),P=(0,n.useCallback)(D=>f(D.value),[f]),E=v.find(D=>D.value===p);return(0,t.jsx)(i.l6,{inputId:y,value:E,options:v,onChange:P})});l.displayName="FieldTypeMatcherEditor";const d=[{value:s.PU.number,label:"Number",icon:(0,g.lV)(s.PU.number)},{value:s.PU.string,label:"String",icon:(0,g.lV)(s.PU.string)},{value:s.PU.time,label:"Time",icon:(0,g.lV)(s.PU.time)},{value:s.PU.boolean,label:"Boolean",icon:(0,g.lV)(s.PU.boolean)},{value:s.PU.trace,label:"Traces",icon:(0,g.lV)(s.PU.trace)},{value:s.PU.enum,label:"Enum",icon:(0,g.lV)(s.PU.enum)},{value:s.PU.other,label:"Other",icon:(0,g.lV)(s.PU.other)}],c=m=>(0,n.useMemo)(()=>{const u=new Map;for(const p of d)u.set(p.value,0);for(const p of m)for(const f of p.fields){const y=f.type||s.PU.other;let x=u.get(y);x||(x=0),u.set(y,x+1)}return u},[m]),h=(m,u)=>(0,n.useMemo)(()=>{let p=!1;const f=[];for(const y of d){const x=m.get(y.value),v=u===y.value;(x||v)&&f.push({...y,label:`${y.label} (${m.get(y.value)})`}),v&&(p=!0)}return u&&!p&&f.push({value:u,label:`${u} (No matches)`}),f},[m,u]),o={id:a.Ct.byType,component:l,matcher:r.sJ.get(a.Ct.byType),name:"Fields with type",description:"Set properties for fields of a specific type (number, string, boolean)",optionsToLabel:m=>m}},19346:(G,R,e)=>{"use strict";e.d(R,{N:()=>h,r1:()=>p});var t=e(74848),n=e(32196),s=e(96540),a=e(75059),r=e(1173),g=e(85200),i=e(52622),l=e(40845),d=e(10354),c=e(90182);const h=[{label:"==",value:i.zT.EQ},{label:"!=",value:i.zT.NEQ},{label:">",value:i.zT.GT},{label:">=",value:i.zT.GTE},{label:"<",value:i.zT.LT},{label:"<=",value:i.zT.LTE}];function o(f){return f===a.gy.allIsNull||f===a.gy.allIsZero}const m=({options:f,onChange:y})=>{const x=(0,l.of)(u),v=(0,s.useMemo)(()=>a.AS.selectOptions([f?.reducer]),[f?.reducer]),P=(0,s.useCallback)(T=>y({...f,reducer:T.value}),[f,y]),E=(0,s.useCallback)(T=>y({...f,op:T.value}),[f,y]),D=(0,s.useCallback)(T=>{const S=T.currentTarget.valueAsNumber;return y({...f,value:S})},[f,y]),C=f??{},b=o(C.reducer);return(0,t.jsxs)("div",{className:x.spot,children:[(0,t.jsx)(c.l6,{value:v.current,options:v.options,onChange:P,placeholder:"Select field reducer"}),C.reducer&&!b&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.l6,{value:h.find(T=>T.value===C.op),options:h,onChange:E,"aria-label":"Comparison operator",width:19}),(0,t.jsx)(d.p,{type:"number",value:C.value,onChange:D})]})]})},u=f=>({spot:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center",alignContent:"flex-end",gap:"4px"})}),p={id:r.Ct.byValue,component:m,matcher:g.sJ.get(r.Ct.byValue),name:"Fields with values",description:"Set properties for fields with reducer condition",optionsToLabel:f=>`${f?.reducer} ${f?.op} ${f?.value}`}},74668:(G,R,e)=>{"use strict";e.d(R,{R:()=>h,X:()=>l});var t=e(74848),n=e(96540),s=e(28240),a=e(1173),r=e(85200),g=e(90182);const i=(o,m,u)=>{if(!u)return;let p=o.find(f=>!m.some(y=>f===y));if(p)return p};function l({value:o,data:m,onChange:u,placeholder:p}){const f=(0,n.useMemo)(()=>d(m),[m]),[y,x]=(0,n.useState)({refIds:[],value:void 0}),v=(0,n.useMemo)(()=>f.find(E=>E.value===o)??i(f,y.refIds,y.value),[o,f,y]),P=(0,n.useCallback)(E=>{u(E?.value)},[u]);return(f!==y.refIds||v?.value!==y.value)&&x({refIds:f,value:v?.value}),(0,t.jsx)(g.l6,{options:f,onChange:P,isClearable:!0,placeholder:p??"Select query refId",value:v})}function d(o){const m=new Map;for(const p of o){const f=p.refId??"",y=m.get(f)??[];y.length===0&&m.set(f,y),y.push(p)}const u=[];for(const[p,f]of m.entries())u.push({value:p,label:`Query: ${p??"(missing refId)"}`,description:c(f)});return u}function c(o){return`Frames (${o.length}):
    ${o.slice(0,Math.min(3,o.length)).map(m=>(0,s.Ri)(m)).join(", ")} ${o.length>3?"...":""}`}const h={id:a.Ct.byFrameRefID,component:o=>(0,t.jsx)(l,{value:o.options,data:o.data,onChange:o.onChange}),matcher:r.sJ.get(a.Ct.byFrameRefID),name:"Fields returned by query",description:"Set properties for fields from a specific query",optionsToLabel:o=>o}},84349:(G,R,e)=>{"use strict";e.d(R,{g:()=>x});var t=e(83077),n=e(74848),s=e(96540),a=e(1173),r=e(85200),g=e(10354);const i=(0,s.memo)(v=>{const{options:P,onChange:E}=v,D=(0,s.useCallback)(C=>E(C.target.value),[E]);return(0,n.jsx)(g.p,{placeholder:"Enter regular expression",defaultValue:P,onBlur:D})});i.displayName="FieldNameByRegexMatcherEditor";const l={id:a.Ct.byRegexp,component:i,matcher:r.sJ.get(a.Ct.byRegexp),name:"Fields with name matching regex",description:"Set properties for fields with names matching a regex",optionsToLabel:v=>v};var d=e(90182),c=e(64278);const h=(0,s.memo)(v=>{const{data:P,options:E,onChange:D,id:C}=v,b=(0,c.sE)(P),T=(0,c.m3)(b,E),S=(0,s.useCallback)(M=>{if((0,c.v3)(M.value,b))return D(M.value)},[b,D]),O=T.find(M=>M.value===E);return(0,n.jsx)(d.l6,{value:O,options:T,onChange:S,inputId:C})});h.displayName="FieldNameMatcherEditor";const o={id:a.Ct.byName,component:h,matcher:r.sJ.get(a.Ct.byName),name:"Fields with name",description:"Set properties for a specific field",optionsToLabel:v=>v},m=(0,s.memo)(v=>{const{data:P,options:E,onChange:D}=v,{readOnly:C,prefix:b}=E,T=(0,c.sE)(P),S=(0,c.m3)(T,void 0),O=(0,s.useCallback)(M=>{if(Array.isArray(M))return D({...E,names:M.reduce((I,L)=>((0,c.v3)(L.value,T)&&I.push(L.value),I),[])})},[T,D,E]);if(C){const M=(E.names??[]).join(", ");return(0,n.jsx)(g.p,{value:M,readOnly:!0,disabled:!0,prefix:b})}return(0,n.jsx)(d.KF,{value:E.names,options:S,onChange:O})});m.displayName="FieldNameMatcherEditor";const u={id:a.Ct.byNames,component:m,matcher:r.sJ.get(a.Ct.byNames),name:"Fields with name",description:"Set properties for a specific field",optionsToLabel:v=>(v.names??[]).join(", "),excludeFromPicker:!0};var p=e(9988),f=e(19346),y=e(74668);const x=new t.O(()=>[o,l,p.cH,y.R,u,f.r1])},64278:(G,R,e)=>{"use strict";e.d(R,{BP:()=>g,m3:()=>l,sE:()=>i,v3:()=>r});var t=e(96540),n=e(28240),s=e(27310),a=e(4025);function r(d,c){return d?c.display.has(d)||c.raw.has(d):!1}function g(d,c){const h={display:new Set,raw:new Set,fields:new Map};for(const o of d)for(const m of o.fields){if(c&&!c(m))continue;const u=(0,n.Ct)(m,o,d);h.display.add(u),h.fields.set(u,m),m.name&&u!==m.name&&(h.raw.add(m.name),h.fields.set(m.name,m))}return h}function i(d,c){return(0,t.useMemo)(()=>g(d,c),[d,c])}function l(d,c,h,o,m){return(0,t.useMemo)(()=>{let u=!1;const p=[];if(h&&p.push(h),m===s.X4.OnlyBaseNames)for(const f of d.raw)!u&&f===c&&(u=!0),p.push({value:f,label:`${f} (base field name)`});else{for(const f of d.display){!u&&f===c&&(u=!0);const y=d.fields.get(f);(!o||o===y?.type)&&p.push({value:f,label:f,icon:y?(0,a.SS)(y):void 0})}if(m!==s.X4.ExcludeBaseNames)for(const f of d.raw)d.display.has(f)||(!u&&f===c&&(u=!0),p.push({value:f,label:`${f} (base field name)`}))}return c&&!u&&p.push({value:c,label:`${c} (not found)`}),p},[d,c,h,o,m])}},38138:(G,R,e)=>{"use strict";e.d(R,{W:()=>h});var t=e(74848),n=e(32196),s=e(96540),a=e(40845),r=e(90613),g=e(27183),i=e(59093),l=e(64539),d=e(32653);const c=s.forwardRef(({header:m,children:u,ariaLabel:p,onOpen:f,onClose:y,onKeyDown:x,...v},P)=>{const E=(0,a.of)(o),D=(0,s.useRef)(null);(0,s.useImperativeHandle)(P,()=>D.current);const[C]=(0,d.t)({isMenuOpen:!0,localRef:D,onOpen:f,onClose:y,onKeyDown:x});return(0,t.jsxs)(r.a,{...v,"aria-label":p,backgroundColor:"primary",borderRadius:"default",boxShadow:"z3",display:"inline-block",onKeyDown:C,paddingX:0,paddingY:.5,ref:D,role:"menu",tabIndex:-1,children:[m&&(0,t.jsx)("div",{className:(0,n.cx)(E.header,!!u&&s.Children.toArray(u).length>0&&E.headerBorder),children:m}),u]})});c.displayName="Menu";const h=Object.assign(c,{Item:l.D,Divider:g.N,Group:i.r}),o=m=>({header:(0,n.css)({padding:m.spacing(.5,1,1,1)}),headerBorder:(0,n.css)({borderBottom:`1px solid ${m.colors.border.weak}`})})},27183:(G,R,e)=>{"use strict";e.d(R,{N:()=>a});var t=e(74848),n=e(32196),s=e(40845);function a(){const g=(0,s.of)(r);return(0,t.jsx)("div",{className:g.divider})}const r=g=>({divider:(0,n.css)({height:1,backgroundColor:g.colors.border.weak,margin:g.spacing(.5,0)})})},59093:(G,R,e)=>{"use strict";e.d(R,{r:()=>g});var t=e(74848),n=e(32196),s=e(2543),a=e.n(s),r=e(40845);const g=({label:l,ariaLabel:d,children:c})=>{const h=(0,r.of)(i),o=`group-label-${(0,s.uniqueId)()}`;return(0,t.jsxs)("div",{role:"group","aria-labelledby":!d&&l?o:void 0,"aria-label":d,children:[l&&(0,t.jsx)("label",{id:o,className:h.groupLabel,"aria-hidden":!0,children:l}),c]})};g.displayName="MenuGroup";const i=l=>({groupLabel:(0,n.css)({color:l.colors.text.secondary,fontSize:l.typography.size.sm,padding:l.spacing(.5,1)})})},64539:(G,R,e)=>{"use strict";e.d(R,{D:()=>m});var t=e(74848),n=e(32196),s=e(96540),a=e(40845),r=e(16797),g=e(14578),i=e(67061),l=e(13544),d=e(32653);const c=p=>{if(!p)return!1;const f=p.parentElement.getBoundingClientRect(),y=p.getBoundingClientRect();return y.width!==0&&f.right+y.width+10>window.innerWidth},h=(0,s.memo)(({items:p,isOpen:f,close:y,customStyle:x})=>{const v=(0,a.of)(o),P=(0,s.useRef)(null),[E]=(0,d.t)({localRef:P,isMenuOpen:f,close:y}),[D,C]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{f&&P.current&&C(c(P.current))},[f]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:v.iconWrapper,"aria-hidden":!0,"data-testid":l.Tp.components.Menu.SubMenu.icon,children:(0,t.jsx)(g.I,{name:"angle-right",className:v.icon})}),f&&(0,t.jsx)("div",{ref:P,className:(0,n.cx)(v.subMenu,{[v.pushLeft]:D}),"data-testid":l.Tp.components.Menu.SubMenu.container,style:x,children:(0,t.jsx)("div",{tabIndex:-1,className:v.itemsWrapper,role:"menu",onKeyDown:E,children:p})})]})});h.displayName="SubMenu";const o=p=>({iconWrapper:(0,n.css)({display:"flex",flex:1,justifyContent:"end"}),icon:(0,n.css)({opacity:.7,marginLeft:p.spacing(1),color:p.colors.text.secondary}),itemsWrapper:(0,n.css)({background:p.colors.background.primary,boxShadow:p.shadows.z3,display:"inline-block",borderRadius:p.shape.radius.default}),pushLeft:(0,n.css)({right:"100%",left:"unset"}),subMenu:(0,n.css)({position:"absolute",top:0,left:"100%",zIndex:p.zIndex.dropdown})}),m=s.memo(s.forwardRef((p,f)=>{const{url:y,icon:x,label:v,description:P,ariaLabel:E,ariaChecked:D,target:C,onClick:b,className:T,active:S,disabled:O,destructive:M,childItems:I,role:L,tabIndex:B=-1,customSubMenuContainerStyles:j,shortcut:A,testId:K}=p,W=(0,a.of)(u),[U,F]=(0,s.useState)(S),[V,w]=(0,s.useState)(!1),z=(0,s.useCallback)(()=>{O||(w(!0),F(!0))},[O]),N=(0,s.useCallback)(()=>{O||(w(!1),F(!1))},[O]),H=I&&I.length>0,Q=H?"div":y===void 0?"button":"a",X=(0,n.cx)({[W.item]:!0,[W.active]:U,[W.disabled]:O,[W.destructive]:M&&!O},T),ee={[Q==="button"?"disabled":"aria-disabled"]:O,...Q==="a"&&O&&{href:void 0,onClick:void 0},...O&&{tabIndex:-1,"data-disabled":O}},Z=(0,s.useRef)(null);(0,s.useImperativeHandle)(f,()=>Z.current);const q=se=>{switch(se.key){case"ArrowRight":se.preventDefault(),se.stopPropagation(),H&&(w(!0),F(!0));break;default:break}},ae=()=>{w(!1),F(!1),Z?.current?.focus()},k=!!(A&&A.length>0);return(0,t.jsxs)(Q,{target:C,className:X,rel:C==="_blank"?"noopener noreferrer":void 0,href:y,onClick:se=>{H&&!V&&(se.preventDefault(),se.stopPropagation()),b?.(se)},onMouseEnter:z,onMouseLeave:N,onKeyDown:q,role:y?L:L||"menuitem","data-role":"menuitem",ref:Z,"data-testid":K,"aria-label":E,"aria-checked":D,tabIndex:B,...ee,children:[(0,t.jsxs)(i.B,{direction:"row",justifyContent:"flex-start",alignItems:"center",children:[x&&(0,t.jsx)(g.I,{name:x,className:W.icon,"aria-hidden":!0}),(0,t.jsx)("span",{className:W.ellipsis,children:v}),(0,t.jsxs)("div",{className:(0,n.cx)(W.rightWrapper,{[W.withShortcut]:k}),children:[k&&(0,t.jsxs)("div",{className:W.shortcut,children:[(0,t.jsx)(g.I,{name:"keyboard",title:"keyboard shortcut"}),A]}),H&&(0,t.jsx)(h,{items:I,isOpen:V,close:ae,customStyle:j})]})]}),P&&(0,t.jsx)("div",{className:(0,n.cx)(W.description,W.ellipsis,{[W.descriptionWithIcon]:x!==void 0}),children:P}),p.component?(0,t.jsx)(p.component,{}):null]})}));m.displayName="MenuItem";const u=p=>({item:(0,n.css)({background:"none",cursor:"pointer",whiteSpace:"nowrap",color:p.colors.text.primary,display:"flex",flexDirection:"column",alignItems:"stretch",padding:p.spacing(.5,2),minHeight:p.spacing(4),margin:0,border:"none",width:"100%",position:"relative","&:hover, &:focus-visible":{background:p.colors.action.hover,color:p.colors.text.primary,textDecoration:"none"},"&:focus-visible":(0,r.getFocusStyles)(p)}),active:(0,n.css)({background:p.colors.action.hover}),destructive:(0,n.css)({color:p.colors.error.text,svg:{color:p.colors.error.text},"&:hover, &:focus, &:focus-visible":{background:p.colors.error.main,color:p.colors.error.contrastText,svg:{color:p.colors.error.contrastText}}}),disabled:(0,n.css)({color:p.colors.action.disabledText,label:"menu-item-disabled","&:hover, &:focus, &:focus-visible":{cursor:"not-allowed",background:"none",color:p.colors.action.disabledText}}),icon:(0,n.css)({opacity:.7,color:p.colors.text.secondary}),rightWrapper:(0,n.css)({display:"flex",alignItems:"center",marginLeft:"auto"}),withShortcut:(0,n.css)({minWidth:p.spacing(10.5)}),shortcut:(0,n.css)({display:"flex",alignItems:"center",gap:p.spacing(1),marginLeft:p.spacing(2),color:p.colors.text.secondary,opacity:.7}),description:(0,n.css)({...p.typography.bodySmall,color:p.colors.text.secondary,textAlign:"start"}),descriptionWithIcon:(0,n.css)({marginLeft:p.spacing(3)}),ellipsis:(0,n.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})})},32653:(G,R,e)=>{"use strict";e.d(R,{t:()=>r});var t=e(96540),n=e(94701);const s=(g,i)=>(g%i+i)%i,a=-1,r=({localRef:g,isMenuOpen:i,close:l,onOpen:d,onClose:c,onKeyDown:h})=>{const[o,m]=(0,t.useState)(a);return(0,t.useEffect)(()=>{i&&m(0)},[i]),(0,t.useEffect)(()=>{const p=g?.current?.querySelectorAll('[data-role="menuitem"]:not([data-disabled])');p?.[o]?.focus(),p?.forEach((f,y)=>{f.tabIndex=y===o?0:-1})},[g,o]),(0,n.A)(()=>{d?.(m)}),[p=>{const f=g?.current?.querySelectorAll('[data-role="menuitem"]:not([data-disabled])'),y=f?.length??0;switch(p.key){case"ArrowUp":p.preventDefault(),p.stopPropagation(),m(s(o-1,y));break;case"ArrowDown":p.preventDefault(),p.stopPropagation(),m(s(o+1,y));break;case"ArrowLeft":p.preventDefault(),p.stopPropagation(),m(a),l?.();break;case"Home":p.preventDefault(),p.stopPropagation(),m(0);break;case"End":p.preventDefault(),p.stopPropagation(),m(y-1);break;case"Enter":p.preventDefault(),p.stopPropagation(),f?.[o]?.click();break;case"Escape":c?.();break;case"Tab":p.preventDefault(),c?.();break;default:break}h?.(p)}]}},37390:(G,R,e)=>{"use strict";e.d(R,{a:()=>u});var t=e(74848),n=e(32196),s=e(18828),a=e(85690),r=e(93225),g=e(59875),i=e(96540),l=e(40845),d=e(76412),c=e(29158),h=e(67061),o=e(29473),m=e(88448);function u(y){const{title:x,children:v,isOpen:P=!1,closeOnEscape:E=!0,closeOnBackdropClick:D=!0,className:C,contentClassName:b,onDismiss:T,onClickBackdrop:S,trapFocus:O=!0}=y,M=(0,l.of)(m.o),I=(0,i.useRef)(null),{overlayProps:L,underlayProps:B}=(0,r.e)({isKeyboardDismissDisabled:!E,isOpen:P,onClose:T},I),{dialogProps:j,titleProps:A}=(0,s.s)({},I);if(!P)return null;const K=(0,n.cx)(M.modalHeader,typeof x!="string"&&M.modalHeaderWithTabs);return(0,t.jsxs)(g.Sf,{children:[(0,t.jsx)("div",{role:"presentation",className:M.modalBackdrop,onClick:S||(D?T:void 0),...B}),(0,t.jsx)(a.n1,{contain:O,autoFocus:!0,restoreFocus:!0,children:(0,t.jsxs)("div",{className:(0,n.cx)(M.modal,C),ref:I,...L,...j,children:[(0,t.jsxs)("div",{className:K,children:[typeof x=="string"&&(0,t.jsx)(f,{...y,title:x,id:A.id}),typeof x!="string"&&x,(0,t.jsx)("div",{className:M.modalHeaderClose,children:(0,t.jsx)(c.K,{name:"times",size:"xl",onClick:T,"aria-label":(0,d.t)("grafana-ui.modal.close-tooltip","Close")})})]}),(0,t.jsx)("div",{className:(0,n.cx)(M.modalContent,b),children:v})]})})]})}function p({leftItems:y,children:x}){const v=(0,l.of)(m.o);return y?(0,t.jsx)("div",{className:v.modalButtonRow,children:(0,t.jsxs)(h.B,{justifyContent:"space-between",children:[(0,t.jsx)(h.B,{justifyContent:"flex-start",gap:2,children:y}),(0,t.jsx)(h.B,{justifyContent:"flex-end",gap:2,children:x})]})}):(0,t.jsx)("div",{className:v.modalButtonRow,children:(0,t.jsx)(h.B,{justifyContent:"flex-end",gap:2,wrap:"wrap",children:x})})}u.ButtonRow=p;function f({icon:y,iconTooltip:x,title:v,id:P}){return(0,t.jsx)(o.r,{icon:y,iconTooltip:x,title:v,id:P})}},29473:(G,R,e)=>{"use strict";e.d(R,{r:()=>a});var t=e(74848),n=e(40845),s=e(88448);const a=({icon:r,iconTooltip:g,title:i,children:l,id:d})=>{const c=(0,n.of)(s.o);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h2",{className:c.modalHeaderTitle,id:d,children:i}),l]})}},25897:(G,R,e)=>{"use strict";e.d(R,{J:()=>r});var t=e(74848),n=e(40675),s=e(63021),a=e(29473);const r=({icon:g,title:i,tabs:l,activeTab:d,onChangeTab:c})=>(0,t.jsx)(a.r,{icon:g,title:i,children:(0,t.jsx)(s.U,{hideBorder:!0,children:l.map((h,o)=>(0,t.jsx)(n.o,{label:h.label,icon:h.icon,suffix:h.tabSuffix,active:h.value===d,onChangeTab:()=>c(h)},`${h.value}-${o}`))})})},71678:(G,R,e)=>{"use strict";e.d(R,{$s:()=>g,EO:()=>r,YO:()=>a,wE:()=>s});var t=e(74848),n=e(96540);const s=n.createContext({component:null,props:{},showModal:()=>{},hideModal:()=>{}});class a extends n.Component{constructor(l){super(l),this.showModal=(d,c)=>{this.setState({component:d,props:c})},this.hideModal=()=>{this.setState({component:null,props:{}})},this.state={component:l.component||null,props:l.props||{},showModal:this.showModal,hideModal:this.hideModal}}render(){return(0,t.jsx)(s.Provider,{value:this.state,children:this.props.children})}}const r=()=>(0,t.jsx)(s.Consumer,{children:({component:i,props:l})=>i?(0,t.jsx)(i,{...l}):null}),g=s.Consumer},88448:(G,R,e)=>{"use strict";e.d(R,{o:()=>n});var t=e(32196);const n=s=>{const a=s.shape.radius.default;return{modal:(0,t.css)({position:"fixed",zIndex:s.zIndex.modal,background:s.colors.background.primary,boxShadow:s.shadows.z3,borderRadius:a,border:`1px solid ${s.colors.border.weak}`,backgroundClip:"padding-box",outline:"none",width:"750px",maxWidth:"100%",left:0,right:0,marginLeft:"auto",marginRight:"auto",top:"10%",maxHeight:"80%",display:"flex",flexDirection:"column"}),modalBackdrop:(0,t.css)({position:"fixed",zIndex:s.zIndex.modalBackdrop,top:0,right:0,bottom:0,left:0,backgroundColor:s.components.overlay.background,backdropFilter:"blur(1px)"}),modalHeader:(0,t.css)({label:"modalHeader",display:"flex",alignItems:"center",minHeight:"42px",margin:s.spacing(1,2,0,2)}),modalHeaderWithTabs:(0,t.css)({borderBottom:`1px solid ${s.colors.border.weak}`}),modalHeaderTitle:(0,t.css)({fontSize:s.typography.size.lg,margin:s.spacing(0,4,0,1),display:"flex",alignItems:"center",position:"relative",top:"2px"}),modalHeaderIcon:(0,t.css)({marginRight:s.spacing(2),fontSize:"inherit","&:before":{verticalAlign:"baseline"}}),modalHeaderClose:(0,t.css)({height:"100%",display:"flex",alignItems:"center",color:s.colors.text.secondary,flexGrow:1,justifyContent:"flex-end"}),modalContent:(0,t.css)({overflow:"auto",padding:s.spacing(3),width:"100%"}),modalButtonRow:(0,t.css)({paddingTop:s.spacing(3)})}}},99544:(G,R,e)=>{"use strict";e.d(R,{O:()=>n});var t=e(19716);function n(s){const a="${"+s.value+"}",r=s.value===s.label?s.origin:`${s.label} / ${s.origin}`;return{label:a,kind:t.q.Property,detail:r,documentation:s.documentation}}},95247:(G,R,e)=>{"use strict";e.d(R,{d:()=>h});var t=e(74848),n=e(32196),s=e(96540),a=e(13544),r=e(40845),g=e(16797),i=e(14578),l=e(29158),d=e(50720),c=e(15068);const h=(0,s.memo)(({title:m,section:u,parent:p,pageIcon:f,onGoBack:y,children:x,titleHref:v,parentHref:P,leftItems:E,isFullscreen:D,className:C,"aria-label":b,buttonOverflowAlignment:T="right",forceShowLeftItems:S=!1})=>{const O=(0,r.of)(o),M=(0,n.cx)("page-toolbar",O.toolbar,{"page-toolbar--fullscreen":D,[O.noPageIcon]:!f},C),I=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:O.truncateText,children:m}),u&&(0,t.jsxs)("span",{className:O.pre,children:[" / ",u]})]});return(0,t.jsxs)("nav",{className:M,"aria-label":b,children:[(0,t.jsxs)("div",{className:O.leftWrapper,children:[f&&!y&&(0,t.jsx)("div",{className:O.pageIcon,children:(0,t.jsx)(i.I,{name:f,size:"lg","aria-hidden":!0})}),y&&(0,t.jsx)("div",{className:O.pageIcon,children:(0,t.jsx)(l.K,{name:"arrow-left",tooltip:"Go back (Esc)",tooltipPlacement:"bottom",size:"xxl","data-testid":a.Tp.components.BackButton.backArrow,onClick:y})}),(0,t.jsxs)("nav",{"aria-label":"Search links",className:O.navElement,children:[p&&P&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(d.N,{"aria-label":`Search dashboard in the ${p} folder`,className:(0,n.cx)(O.titleText,O.parentLink,O.titleLink,O.truncateText),href:P,children:[p," ",(0,t.jsx)("span",{className:O.parentIcon})]}),v&&(0,t.jsx)("span",{className:(0,n.cx)(O.titleText,O.titleDivider),"aria-hidden":!0,children:"/"})]}),(m||!!E?.length)&&(0,t.jsxs)("div",{className:O.titleWrapper,children:[m&&(0,t.jsx)("h1",{className:O.h1Styles,children:v?(0,t.jsx)(d.N,{"aria-label":"Search dashboard by name",className:(0,n.cx)(O.titleText,O.titleLink),href:v,children:I}):(0,t.jsx)("div",{className:O.titleText,children:I})}),E?.map((L,B)=>(0,t.jsx)("div",{className:(0,n.cx)(O.leftActionItem,{[O.forceShowLeftActionItems]:S}),children:L},B))]})]})]}),(0,t.jsx)(c.U,{alignment:T,children:s.Children.toArray(x).filter(Boolean)})]})});h.displayName="PageToolbar";const o=m=>{const{spacing:u,typography:p}=m,f=(0,g.getFocusStyles)(m);return{pre:(0,n.css)({whiteSpace:"pre"}),toolbar:(0,n.css)({alignItems:"center",background:m.colors.background.canvas,display:"flex",gap:m.spacing(2),justifyContent:"space-between",padding:m.spacing(1.5,2),[m.breakpoints.down("md")]:{paddingLeft:"53px"}}),noPageIcon:(0,n.css)({[m.breakpoints.down("md")]:{paddingLeft:m.spacing(2)}}),leftWrapper:(0,n.css)({display:"flex",flexWrap:"nowrap",maxWidth:"70%"}),pageIcon:(0,n.css)({display:"none",[m.breakpoints.up("sm")]:{display:"flex",paddingRight:m.spacing(1),alignItems:"center"}}),truncateText:(0,n.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),titleWrapper:(0,n.css)({display:"flex",margin:0,minWidth:0}),navElement:(0,n.css)({display:"flex",alignItems:"center",minWidth:0}),h1Styles:(0,n.css)({margin:u(0,1,0,0),lineHeight:"inherit",flexGrow:1,minWidth:0}),parentIcon:(0,n.css)({marginLeft:m.spacing(.5)}),titleText:(0,n.css)({display:"flex",fontSize:p.size.lg,margin:0,borderRadius:m.shape.radius.default}),titleLink:(0,n.css)({"&:focus-visible":f}),titleDivider:(0,n.css)({padding:u(0,.5,0,.5),display:"none",[m.breakpoints.up("md")]:{display:"unset"}}),parentLink:(0,n.css)({display:"none",[m.breakpoints.up("md")]:{display:"unset",flex:1}}),leftActionItem:(0,n.css)({display:"none",alignItems:"center",paddingRight:u(.5),[m.breakpoints.up("md")]:{display:"flex"}}),forceShowLeftActionItems:(0,n.css)({display:"flex"})}}},19384:(G,R,e)=>{"use strict";e.d(R,{d:()=>i});var t=e(74848),n=e(32196),s=e(96540),a=e(40845),r=e(55852),g=e(14578);const i=({currentPage:d,numberOfPages:c,onNavigate:h,hideWhenSinglePage:o,showSmallVersion:m,className:u})=>{const p=(0,a.of)(l),f=m?1:8,y=(0,s.useMemo)(()=>{const x=[...new Array(c).keys()],v=c>f,P=(E,D)=>(0,t.jsx)("li",{className:p.item,children:(0,t.jsx)(r.$n,{size:"sm",variant:D,onClick:()=>h(E),children:E})},E);return x.reduce((E,D)=>{const C=D+1,b=C===d?"primary":"secondary",T=f,S=c-f+1,O=S-T,M=C===1||C===c,I=O>-1&&d>=T&&d<=S,L=m?1:3,B=m?0:2;return v?M||d<T&&C<T||O>=0&&d>S&&C>S||O<0&&d>=T&&C>S||I&&C>=d-B&&C<=d+B?E.push(P(C,b)):(C===T&&d<T||C===S&&d>S||I&&(C===d-L||C===d+L))&&E.push((0,t.jsx)("li",{className:p.item,children:(0,t.jsx)(g.I,{className:p.ellipsis,name:"ellipsis-v"})},C)):E.push(P(C,b)),E},[])},[d,c,h,f,m,p.ellipsis,p.item]);return o&&c<=1?null:(0,t.jsx)("div",{className:(0,n.cx)(p.container,u),children:(0,t.jsxs)("ol",{children:[(0,t.jsx)("li",{className:p.item,children:(0,t.jsx)(r.$n,{"aria-label":"previous page",size:"sm",variant:"secondary",onClick:()=>h(d-1),disabled:d===1,children:(0,t.jsx)(g.I,{name:"angle-left"})})}),y,(0,t.jsx)("li",{className:p.item,children:(0,t.jsx)(r.$n,{"aria-label":"next page",size:"sm",variant:"secondary",onClick:()=>h(d+1),disabled:d===c,children:(0,t.jsx)(g.I,{name:"angle-right"})})})]})})},l=()=>({container:(0,n.css)({float:"right"}),item:(0,n.css)({display:"inline-block",paddingLeft:"10px",marginBottom:"5px"}),ellipsis:(0,n.css)({transform:"rotate(90deg)"})})},89963:(G,R,e)=>{"use strict";e.d(R,{I:()=>i});var t=e(74848),n=e(32196),s=e(13544),a=e(40845),r=e(14578),g=e(56034);const i=({onCancel:c,loading:h})=>{const o=window.matchMedia("(prefers-reduced-motion: reduce)").matches,m=(0,a.of)(d);return h?(0,t.jsx)(g.m,{content:"Cancel query",children:(0,t.jsx)(r.I,{className:(0,n.cx)(m.spin,{[m.clickable]:!!c}),name:o?"hourglass":"sync",size:"sm",onClick:c,"data-testid":s.Tp.components.LoadingIndicator.icon})}):null},l=(0,n.keyframes)({"0%":{transform:"rotate(0deg) scaleX(-1)"},"100%":{transform:"rotate(359deg) scaleX(-1)"}}),d=c=>({clickable:(0,n.css)({cursor:"pointer"}),spin:(0,n.css)({[c.transitions.handleMotion("no-preference")]:{animation:`${l} 3s linear infinite`}})})},79041:(G,R,e)=>{"use strict";e.d(R,{XF:()=>a,d2:()=>r,e4:()=>s});var t=e(96540),n=e(18226);const s=(0,t.createContext)({eventsScope:"global",eventBus:new n.o}),a=s.Provider,r=()=>(0,t.useContext)(s)},91052:(G,R,e)=>{"use strict";e.d(R,{NR:()=>A});var t=e(89963),n=e(74848),s=e(32196),a=e(96540),r=e(42941),g=e(49185),i=e(39070),l=e(13544),d=e(40845),c=e(16797);function h({children:K,delay:W}){const[U,F]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{window.setTimeout(()=>{F(!0)},W)},[K,W]),(0,n.jsx)(n.Fragment,{children:U?K:null})}var o=e(14578),m=e(57514),u=e(94753),p=e(56034),f=e(83122),y=e(27746);function x({menu:K,title:W,placement:U="bottom",offset:F,dragClassCancel:V,menuButtonClass:w,onOpenMenu:z}){const N=W?l.Tp.components.Panels.Panel.menu(W):"panel-menu-button",H=(0,a.useCallback)(Q=>{Q&&z&&z()},[z]);return(0,n.jsx)(f.m,{overlay:K,placement:U,offset:F,onVisibleChange:H,children:(0,n.jsx)(y.I,{"aria-label":`Menu for panel with ${W?`title ${W}`:"no title"}`,title:"Menu",icon:"ellipsis-v",iconSize:"md",narrow:!0,"data-testid":N,className:(0,s.cx)(w,V)})})}function v({menu:K,title:W,dragClass:U,children:F,offset:V=-32,onOpenMenu:w}){const z=(0,d.of)(P),N=(0,a.useRef)(null),H=l.Tp.components.Panels.Panel.HoverWidget,Q=(0,a.useCallback)(ee=>{N.current?.setPointerCapture(ee.pointerId)},[]),X=(0,a.useCallback)(ee=>{N.current?.releasePointerCapture(ee.pointerId)},[]);return F===void 0||a.Children.count(F)===0?null:(0,n.jsxs)("div",{className:(0,s.cx)(z.container,"show-on-hover"),style:{top:V},"data-testid":H.container,children:[U&&(0,n.jsx)("div",{className:(0,s.cx)(z.square,z.draggable,U),onPointerDown:Q,onPointerUp:X,ref:N,"data-testid":H.dragIcon,children:(0,n.jsx)(o.I,{name:"expand-arrows",className:z.draggableIcon})}),F,K&&(0,n.jsx)(x,{menu:K,title:W,placement:"bottom",menuButtonClass:z.menuButton,onOpenMenu:w})]})}function P(K){return{container:(0,s.css)({label:"hover-container-widget",[K.transitions.handleMotion("no-preference","reduce")]:{transition:"all .1s linear"},display:"flex",position:"absolute",zIndex:1,right:0,boxSizing:"content-box",alignItems:"center",background:K.colors.background.secondary,color:K.colors.text.primary,border:`1px solid ${K.colors.border.weak}`,borderRadius:K.shape.radius.default,height:K.spacing(4),boxShadow:K.shadows.z1}),square:(0,s.css)({display:"flex",justifyContent:"center",alignItems:"center",width:K.spacing(4),height:"100%"}),draggable:(0,s.css)({cursor:"move",[K.breakpoints.down("md")]:{display:"none"}}),menuButton:(0,s.css)({background:"inherit",border:"none","&:hover":{background:K.colors.secondary.main}}),draggableIcon:(0,s.css)({transform:"rotate(45deg)",color:K.colors.text.secondary,"&:hover":{color:K.colors.text.primary}})}}var E=e(55852);const D=(0,a.forwardRef)(({className:K,children:W,href:U,onClick:F,target:V,title:w,...z},N)=>{const H=(0,d.of)(C);return U?(0,n.jsx)("a",{ref:N,href:U,onClick:F,target:V,title:w,className:(0,s.cx)(H.linkItem,K),...z,children:W}):F?(0,n.jsx)(E.$n,{ref:N,className:(0,s.cx)(H.item,K),variant:"secondary",fill:"text",onClick:F,children:W}):(0,n.jsx)("span",{ref:N,className:(0,s.cx)(H.item,K),...z,children:W})});D.displayName="TitleItem";const C=K=>{const W=(0,s.css)({color:`${K.colors.text.secondary}`,label:"panel-header-item",cursor:"auto",border:"none",borderRadius:`${K.shape.radius.default}`,padding:`${K.spacing(0,1)}`,height:`${K.spacing(K.components.panel.headerHeight)}`,display:"flex",alignItems:"center",justifyContent:"center","&:focus, &:focus-visible":{...(0,c.getFocusStyles)(K),zIndex:1},"&: focus:not(:focus-visible)":(0,c.getMouseFocusStyles)(K),"&:hover ":{boxShadow:`${K.shadows.z1}`,background:`${K.colors.background.secondary}`,color:`${K.colors.text.primary}`}});return{item:W,linkItem:(0,s.cx)(W,(0,s.css)({cursor:"pointer"}))}};function b({description:K,className:W}){const U=(0,d.of)(T),F=()=>{const V=typeof K=="function"?K():K;return(0,n.jsx)("div",{className:"panel-info-content markdown-html",children:(0,n.jsx)("div",{dangerouslySetInnerHTML:{__html:V}})})};return K!==""?(0,n.jsx)(p.m,{interactive:!0,content:F,children:(0,n.jsx)(D,{className:(0,s.cx)(W,U.description),children:(0,n.jsx)(o.I,{name:"info-circle",size:"md"})})}):null}const T=K=>({description:(0,s.css)({code:{whiteSpace:"normal",wordWrap:"break-word"},"pre > code":{display:"block"}})});function S({message:K,onClick:W,ariaLabel:U="status"}){const F=(0,d.of)(O);return(0,n.jsx)(y.I,{className:F.buttonStyles,onClick:W,variant:"destructive",icon:"exclamation-triangle",iconSize:"md",tooltip:K||"","aria-label":U,"data-testid":l.Tp.components.Panels.Panel.status("error")})}const O=K=>{const{headerHeight:W,padding:U}=K.components.panel;return{buttonStyles:(0,s.css)({label:"panel-header-state-button",display:"flex",alignItems:"center",justifyContent:"center",padding:K.spacing(U),width:K.spacing(W),height:K.spacing(W),borderRadius:K.shape.radius.default})}};function M({width:K,height:W,children:U,padding:F="md",title:V="",description:w="",displayMode:z="default",titleItems:N,menu:H,dragClass:Q,dragClassCancel:X,hoverHeader:ee=!1,hoverHeaderOffset:Z,loadingState:q,statusMessage:ae,statusMessageOnClick:k,leftItems:se,actions:te,onCancelQuery:ne,onOpenMenu:le,collapsible:re=!1,collapsed:de,onToggleCollapse:oe,onFocus:J,onMouseMove:ce,onMouseEnter:pe}){const xe=(0,d.$j)(),fe=(0,d.of)(j),Ee=(0,a.useId)(),Se=(0,a.useId)().replace(/:/g,"_"),ye=!ee,[Ve,Me]=(0,r.A)(!0);de===void 0&&(de=!Ve);const Ce="show-on-hover",Ue=z==="transparent",Ae=L(xe,ye),{contentStyle:we,innerWidth:We,innerHeight:_e}=B(F,xe,Ae,de,W,K),at={height:Ae,cursor:Q?"move":"auto"},ut={width:K,height:de?void 0:W},[Tt,{width:It}]=(0,g.A)();se&&(te=se);const ge=typeof V=="string"?l.Tp.components.Panels.Panel.title(V):"Panel",Ie=(0,n.jsxs)(n.Fragment,{children:[!re&&V&&(0,n.jsx)("div",{className:fe.title,children:(0,n.jsx)(u.E,{element:"h2",variant:"h6",truncate:!0,title:typeof V=="string"?V:void 0,id:Se,children:V})}),re&&(0,n.jsx)("div",{className:fe.title,children:(0,n.jsx)(u.E,{element:"h2",variant:"h6",children:(0,n.jsxs)("button",{type:"button",className:fe.clearButtonStyles,onClick:()=>{Me(),oe&&oe(!de)},"aria-expanded":!de,"aria-controls":de?void 0:Ee,children:[(0,n.jsx)(o.I,{name:de?"angle-right":"angle-down","aria-hidden":!!V,"aria-label":V?void 0:"toggle collapse panel"}),(0,n.jsx)(u.E,{variant:"h6",truncate:!0,id:Se,children:V})]})})}),(0,n.jsxs)("div",{className:(0,s.cx)(fe.titleItems,X),"data-testid":"title-items-container",children:[(0,n.jsx)(b,{description:w,className:X}),N]}),q===i.Gu.Streaming&&(0,n.jsx)(p.m,{content:ne?"Stop streaming":"Streaming",children:(0,n.jsx)(D,{className:X,"data-testid":"panel-streaming",onClick:ne,children:(0,n.jsx)(o.I,{name:"circle-mono",size:"md",className:fe.streaming})})}),q===i.Gu.Loading&&ne&&(0,n.jsx)(h,{delay:2e3,children:(0,n.jsx)(p.m,{content:"Cancel query",children:(0,n.jsx)(D,{className:(0,s.cx)(X,fe.pointer),"data-testid":"panel-cancel-query",onClick:ne,children:(0,n.jsx)(o.I,{name:"sync-slash",size:"md"})})})}),(0,n.jsx)("div",{className:fe.rightAligned,children:te&&(0,n.jsx)("div",{className:fe.rightActions,children:I(te,ue=>ue)})})]});return(0,n.jsxs)("section",{className:(0,s.cx)(fe.container,{[fe.transparentContainer]:Ue}),style:ut,"aria-labelledby":V?Se:void 0,"data-testid":ge,tabIndex:0,onFocus:J,onMouseMove:ce,onMouseEnter:pe,ref:Tt,children:[(0,n.jsx)("div",{className:fe.loadingBarContainer,children:q===i.Gu.Loading?(0,n.jsx)(m.G,{width:It,ariaLabel:"Panel loading bar"}):null}),ee&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v,{menu:H,title:typeof V=="string"?V:void 0,offset:Z,dragClass:Q,onOpenMenu:le,children:Ie}),ae&&(0,n.jsx)("div",{className:fe.errorContainerFloating,children:(0,n.jsx)(S,{message:ae,onClick:k,ariaLabel:"Panel status"})})]}),ye&&(0,n.jsxs)("div",{className:(0,s.cx)(fe.headerContainer,Q),style:at,"data-testid":"header-container",children:[ae&&(0,n.jsx)("div",{className:X,children:(0,n.jsx)(S,{message:ae,onClick:k,ariaLabel:"Panel status"})}),Ie,H&&(0,n.jsx)(x,{menu:H,title:typeof V=="string"?V:void 0,placement:"bottom-end",menuButtonClass:(0,s.cx)(fe.menuItem,X,Ce),onOpenMenu:le})]}),!de&&(0,n.jsx)("div",{id:Ee,"data-testid":l.Tp.components.Panels.Panel.content,className:(0,s.cx)(fe.content,W===void 0&&fe.containNone),style:we,children:typeof U=="function"?U(We,_e):U})]})}const I=(K,W)=>{const U=a.Children.toArray(K).filter(Boolean);return U.length>0?W(U):null},L=(K,W)=>W?K.spacing.gridSize*K.components.panel.headerHeight:0,B=(K,W,U,F,V,w)=>{const z=(K==="md"?W.components.panel.padding:0)*W.spacing.gridSize,N=z*2,H=1*2;let Q=0;w&&(Q=w-N-H);let X=0;return V&&(X=V-U-N-H),F&&(X=U),{contentStyle:{padding:z},innerWidth:Q,innerHeight:X}},j=K=>{const{background:W,borderColor:U,padding:F}=K.components.panel;return{container:(0,s.css)({label:"panel-container",backgroundColor:W,border:`1px solid ${U}`,position:"relative",borderRadius:K.shape.radius.default,height:"100%",display:"flex",flexDirection:"column",".show-on-hover":{opacity:"0",visibility:"hidden"},"&:focus-visible, &:hover":{".show-on-hover":{opacity:"1",visibility:"visible"}},"&:focus-visible":(0,c.getFocusStyles)(K),"&:focus-within:not(:focus)":{".show-on-hover":{visibility:"visible",opacity:"1"}}}),transparentContainer:(0,s.css)({label:"panel-transparent-container",backgroundColor:"transparent",border:"1px solid transparent",boxSizing:"border-box","&:hover":{border:`1px solid ${U}`}}),loadingBarContainer:(0,s.css)({label:"panel-loading-bar-container",position:"absolute",top:0,width:"100%",zIndex:1}),containNone:(0,s.css)({contain:"none"}),content:(0,s.css)({label:"panel-content",flexGrow:1,contain:"size layout"}),headerContainer:(0,s.css)({label:"panel-header",display:"flex",alignItems:"center"}),pointer:(0,s.css)({cursor:"pointer"}),streaming:(0,s.css)({label:"panel-streaming",marginRight:0,color:K.colors.success.text,"&:hover":{color:K.colors.success.text}}),title:(0,s.css)({label:"panel-title",display:"flex",padding:K.spacing(0,F),minWidth:0,"& > h2":{minWidth:0}}),items:(0,s.css)({display:"flex"}),item:(0,s.css)({display:"flex",justifyContent:"center",alignItems:"center"}),hiddenMenu:(0,s.css)({visibility:"hidden"}),menuItem:(0,s.css)({label:"panel-menu",border:"none",background:K.colors.secondary.main,"&:hover":{background:K.colors.secondary.shade}}),errorContainerFloating:(0,s.css)({label:"error-container",position:"absolute",left:0,top:0,zIndex:1}),rightActions:(0,s.css)({display:"flex",padding:K.spacing(0,F),gap:K.spacing(1)}),rightAligned:(0,s.css)({label:"right-aligned-container",marginLeft:"auto",display:"flex",alignItems:"center"}),titleItems:(0,s.css)({display:"flex",height:"100%"}),clearButtonStyles:(0,s.css)({alignItems:"center",display:"flex",gap:K.spacing(.5),background:"transparent",border:"none",padding:0,maxWidth:"100%"})}},A=M;A.LoadingIndicator=t.I,A.TitleItem=D},88895:(G,R,e)=>{"use strict";e.d(R,{B:()=>t});var t=(n=>(n.ToggleSelection="select",n.AppendToSelection="append",n))(t||{})},52494:(G,R,e)=>{"use strict";e.d(R,{_:()=>a});var t=e(74848),n=e(32196),s=e(40845);const a=({children:g,className:i,...l})=>{const d=(0,s.of)(r);return(0,t.jsx)("div",{className:(0,n.cx)(d,i),...l,children:g})},r=g=>(0,n.css)({backgroundColor:g.components.panel.background,border:`1px solid ${g.components.panel.borderColor}`,borderRadius:g.shape.radius.default})},98624:(G,R,e)=>{"use strict";e.d(R,{B:()=>r});var t=e(74848),n=e(43429),s=e(39938);const a={[n.kv.grafana]:"grafana",[n.kv.commercial]:"shield",[n.kv.community]:"shield",DEFAULT:"shield-exclamation"},r=({status:i,color:l,signatureType:d,signatureOrg:c,...h})=>{const o=g(i,d,c);return(0,t.jsx)(s.E,{text:o.text,color:o.color,icon:o.icon,tooltip:o.tooltip,...h})};r.displayName="PluginSignatureBadge";function g(i,l,d){i||(i=n.Ac.invalid);const c=a[l||""]||a.DEFAULT;switch(i){case n.Ac.internal:return{text:"Core",color:"blue",tooltip:"Core plugin that is bundled with Grafana"};case n.Ac.valid:return{text:l||"Signed",icon:l?c:"lock",color:"green",tooltip:"Signed and verified plugin"};case n.Ac.invalid:return{text:"Invalid signature",icon:"exclamation-triangle",color:"red",tooltip:"Invalid plugin signature"};case n.Ac.modified:return{text:"Modified signature",icon:"exclamation-triangle",color:"red",tooltip:"Valid signature but content has been modified"};case n.Ac.missing:return{text:"Missing signature",icon:"exclamation-triangle",color:"red",tooltip:"Missing plugin signature"};default:return{text:"Unsigned",icon:"exclamation-triangle",color:"red",tooltip:"Unsigned external plugin"}}}},20084:(G,R,e)=>{"use strict";e.d(R,{X:()=>D});var t=e(74848),n=e(32196),s=e(46942),a=e.n(s),r=e(2543),g=e.n(r),i=e(96540),l=e(52845),d=e(29317),c=e(13544),h=e(80903),o=e(4269),m=e(88295),u=e(74738),p=e(31589),f=e(1020),y=e(99453),x=e(40845),v=e(16797),P=e(72307);class E extends i.PureComponent{constructor(T){super(T),this.lastExecutedValue=null,this.mounted=!1,this.editor=null,this.onChange=(L,B)=>{const j=L.document!==this.state.value.document,A=this.state.value;this.props.onRichValueChange&&this.props.onRichValueChange(L),this.setState({value:L},()=>{if(j){const K=l.default.serialize(A)!==l.default.serialize(L);K&&B&&this.runOnChangeAndRunQuery(),K&&!B&&this.runOnChangeDebounced()}})},this.runOnChange=()=>{const{onChange:L}=this.props,B=l.default.serialize(this.state.value);L&&L(this.cleanText(B))},this.runOnRunQuery=()=>{const{onRunQuery:L}=this.props;L&&(L(),this.lastExecutedValue=this.state.value)},this.runOnChangeAndRunQuery=()=>{this.runOnChange(),this.runOnRunQuery()},this.handleBlur=(L,B,j)=>{const{onBlur:A}=this.props;if(A)A();else{const K=this.lastExecutedValue?l.default.serialize(this.lastExecutedValue):"",W=l.default.serialize(B.value);K!==W&&this.runOnChangeAndRunQuery()}return j()},this.runOnChangeDebounced=(0,r.debounce)(this.runOnChange,500);const{onTypeahead:S,cleanText:O,portalOrigin:M,onWillApplySuggestion:I}=T;this.plugins=[(0,h.Pz)({onTypeahead:S,cleanText:O,portalOrigin:M,onWillApplySuggestion:I}),(0,o.U)({handler:this.runOnChangeAndRunQuery}),(0,m.O)(),(0,u.v)(),(0,p.l)(),(0,f.T)(),(0,y.s)(),...T.additionalPlugins||[]].filter(L=>L),this.state={suggestions:[],typeaheadContext:null,typeaheadPrefix:"",typeaheadText:"",value:(0,P.mO)(T.query||"",T.syntax)}}static{this.defaultProps={onBlur:()=>{}}}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}componentDidUpdate(T,S){const{query:O,syntax:M,syntaxLoaded:I}=this.props;if(!T.syntaxLoaded&&I&&this.editor){const B=this.editor.insertText(" ").deleteBackward(1);this.onChange(B.value,!0)}const{value:L}=this.state;O!==T.query&&O!==l.default.serialize(L)&&this.setState({value:(0,P.mO)(O||"",M)})}cleanText(T){return T.replace(/[\r]/g,"")}render(){const{disabled:T,theme:S}=this.props,O=a()("slate-query-field__wrapper",{"slate-query-field__wrapper--disabled":T}),M=C(S);return(0,t.jsx)("div",{className:(0,n.cx)(O,M.wrapper),children:(0,t.jsx)("div",{className:"slate-query-field","data-testid":c.Tp.components.QueryField.container,children:(0,t.jsx)(d.Editor,{ref:I=>this.editor=I,schema:P.yx,autoCorrect:!1,readOnly:this.props.disabled,onBlur:this.handleBlur,onClick:this.props.onClick,onChange:I=>{this.onChange(I.value,!1)},placeholder:this.props.placeholder,plugins:this.plugins,spellCheck:!1,value:this.state.value})})})}}const D=(0,x.cV)(E),C=b=>{const T=(0,v.getFocusStyles)(b);return{wrapper:(0,n.css)({"&:focus-within":T})}}},11134:(G,R,e)=>{"use strict";e.d(R,{cC:()=>h,cb:()=>c});var t=e(74848),n=e(91e3),s=e(96540),a=e(70416),r=e(13544),g=e(76412),i=e(19727),l=e(9261),d=e(27746);const c=["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"];class h extends s.PureComponent{constructor(p){super(p),this.onChangeSelect=f=>{const{onIntervalChanged:y}=this.props;y&&f.value!=null&&y(f.value)}}static{this.offOption={label:"Off",value:"",ariaLabel:"Turn off auto refresh"}}static{this.liveOption={label:"Live",value:"LIVE",ariaLabel:"Turn on live streaming"}}static{this.autoOption={label:"Auto",value:"auto",ariaLabel:"Select refresh from the query range"}}static{this.isLive=p=>p===h.liveOption.value}getVariant(){return this.props.isLive||this.props.primary?"primary":this.props.isOnCanvas?"canvas":"default"}render(){const{onRefresh:p,intervals:f,tooltip:y,value:x,text:v,isLoading:P,noIntervalPicker:E,width:D,showAutoInterval:C}=this.props,b=x||"",T=this.getVariant(),S=m({intervals:f,showAutoInterval:C}),O=S.find(({value:F})=>F===b),M=o(h.offOption.value);let I=O||M;I.label===M.label&&(I={value:""});const L=I.ariaLabel,B=(0,g.t)("refresh-picker.aria-label.duration-selected","Choose refresh time interval with current interval {{durationAriaLabel}} selected",{durationAriaLabel:L}),j=(0,g.t)("refresh-picker.aria-label.choose-interval","Auto refresh turned off. Choose refresh time interval"),A=I.value===""?j:B,K=(0,g.t)("refresh-picker.tooltip.interval-selected","Set auto refresh interval"),W=(0,g.t)("refresh-picker.tooltip.turned-off","Auto refresh off"),U=I.value===""?W:K;return(0,t.jsxs)(i.e,{className:"refresh-picker",children:[(0,t.jsx)(d.I,{"aria-label":v,tooltip:y,onClick:p,variant:T,icon:P?"spinner":"sync",style:D?{width:D}:void 0,"data-testid":r.Tp.components.RefreshPicker.runButtonV2,children:v}),!E&&(0,t.jsx)(l.f,{value:I,options:S,onChange:this.onChangeSelect,variant:T,"data-testid":r.Tp.components.RefreshPicker.intervalButtonV2,"aria-label":A,tooltip:U})]})}}function o(u){switch(u){case h.liveOption.value:return{label:(0,g.t)("refresh-picker.live-option.label","Live"),value:u,ariaLabel:(0,g.t)("refresh-picker.live-option.aria-label","Turn on live streaming")};case h.offOption.value:return{label:(0,g.t)("refresh-picker.off-option.label","Off"),value:u,ariaLabel:(0,g.t)("refresh-picker.off-option.aria-label","Turn off auto refresh")};case h.autoOption.value:return{label:(0,g.t)("refresh-picker.auto-option.label",h.autoOption.label),value:u,ariaLabel:(0,g.t)("refresh-picker.auto-option.aria-label",h.autoOption.ariaLabel)}}return{label:u,value:u}}function m({intervals:u=c,showAutoInterval:p=!1}={}){const f=u.map(y=>{const x=(0,a.E9)(y),v=(0,n.a)(x);return{label:y,value:y,ariaLabel:v}});return p&&f.unshift(o(h.autoOption.value)),f.unshift(o(h.offOption.value)),f}},44522:(G,R,e)=>{"use strict";e.d(R,{I:()=>s});var t=e(96540),n=e(80997);function s({component:a,content:r,...g}){return t.createElement(a||"span",{dangerouslySetInnerHTML:{__html:n.sQ.sanitize(r)},...g})}},56286:(G,R,e)=>{"use strict";e.d(R,{L:()=>l});var t=e(74848),n=e(32196),s=e(2543),a=e.n(s),r=e(55852),g=e(90090);const i=()=>({noRadiusInput:(0,n.css)({borderBottomRightRadius:"0 !important",borderTopRightRadius:"0 !important"}),noRadiusButton:(0,n.css)({borderBottomLeftRadius:"0 !important",borderTopLeftRadius:"0 !important"})}),l=({label:d="Password",labelWidth:c,inputWidth:h=12,onReset:o,isConfigured:m,tooltip:u,placeholder:p="Password",interactive:f,...y})=>{const x=i();return(0,t.jsx)(g.z,{label:d,tooltip:u,interactive:f,labelWidth:c,inputEl:m?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("input",{type:"text",className:(0,n.cx)(`gf-form-input width-${h}`,x.noRadiusInput),disabled:!0,value:"configured",...(0,s.omit)(y,"value")}),(0,t.jsx)(r.$n,{onClick:o,variant:"secondary",type:"button",children:"Reset"})]}):(0,t.jsx)("input",{type:"password",className:`gf-form-input width-${h}`,placeholder:p,...y})})};l.displayName="SecretFormField"},9226:(G,R,e)=>{"use strict";e.d(R,{L4:()=>i});var t=e(74848),n=e(55852),s=e(10354),a=e(67061);const r="configured",g="Reset",i=({isConfigured:l,onReset:d,...c})=>(0,t.jsxs)(a.B,{children:[!l&&(0,t.jsx)(s.p,{...c,type:"password"}),l&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.p,{...c,type:"text",disabled:!0,value:r}),(0,t.jsx)(n.$n,{onClick:d,variant:"secondary",children:g})]})]})},58724:(G,R,e)=>{"use strict";e.d(R,{lp:()=>h});var t=e(74848),n=e(32196),s=e(40845),a=e(55852),r=e(90613),g=e(67061),i=e(21744);const l="configured",d="Reset",c=o=>({configuredStyle:(0,n.css)({minHeight:o.spacing(o.components.height.md),paddingTop:o.spacing(.5),resize:"none"})}),h=({isConfigured:o,onReset:m,...u})=>{const p=(0,s.of)(c);return(0,t.jsxs)(g.B,{children:[(0,t.jsxs)(r.a,{children:[!o&&(0,t.jsx)(i.f,{...u}),o&&(0,t.jsx)(i.f,{...u,rows:1,disabled:!0,value:l,className:(0,n.cx)(p.configuredStyle)})]}),o&&(0,t.jsx)(a.$n,{onClick:m,variant:"secondary",children:d})]})}},38401:(G,R,e)=>{"use strict";e.d(R,{Y:()=>c});var t=e(74848),n=e(32196),s=e(2543),a=e.n(s),r=e(40845),g=e(76892),i=e(13102),l=e(86997),d=e(2336);function c({options:h,value:o,onChange:m,Component:u,className:p,allowCustomValue:f,allowEmptyValue:y,placeholder:x,disabled:v,inputMinWidth:P,inputPlaceholder:E,onExpandedChange:D,autofocus:C=!1,...b}){const[T,S,O,M]=(0,d.Q)(C,D),I=P?Math.max(P,S):S,L=(0,r.of)(l.m);if(!O){const B=(0,s.isObject)(o)?o.label:o,j=B!=null?String(B):void 0;return(0,t.jsx)(T,{disabled:v,Component:u||(0,t.jsx)(g.c,{className:(0,n.cx)(L.segment,{[L.queryPlaceholder]:x!==void 0&&!o,[L.disabled]:v},p),children:j||x})})}return(0,t.jsx)(i.a,{...b,value:o&&!(0,s.isObject)(o)?{value:o}:o,placeholder:E,options:h,width:I,onClickOutside:()=>M(!1),allowCustomValue:f,allowEmptyValue:y,onChange:B=>{M(!1),m(B)}})}},83684:(G,R,e)=>{"use strict";e.d(R,{s:()=>o});var t=e(74848),n=e(32196),s=e(2543),a=e.n(s),r=e(41053),g=e(40845),i=e(76412),l=e(76892),d=e(13102),c=e(86997),h=e(2336);function o({value:u,onChange:p,loadOptions:f,reloadOptionsOnChange:y=!1,Component:x,className:v,allowCustomValue:P,allowEmptyValue:E,disabled:D,placeholder:C,inputMinWidth:b,inputPlaceholder:T,autofocus:S=!1,onExpandedChange:O,noOptionMessageHandler:M=m,...I}){const[L,B]=(0,r.A)(f,[f]),[j,A,K,W]=(0,h.Q)(S,O),U=b?Math.max(b,A):A,F=(0,g.of)(c.m);if(!K){const V=(0,s.isObject)(u)?u.label:u,w=V!=null?String(V):void 0;return(0,t.jsx)(j,{onClick:y?void 0:B,disabled:D,Component:x||(0,t.jsx)(l.c,{className:(0,n.cx)(F.segment,{[F.queryPlaceholder]:C!==void 0&&!u,[F.disabled]:D},v),children:w||C})})}return(0,t.jsx)(d.a,{...I,value:u&&!(0,s.isObject)(u)?{value:u}:u,placeholder:T,options:L.value??[],loadOptions:y?B:void 0,width:U,noOptionsMessage:M(L),allowCustomValue:P,allowEmptyValue:E,onClickOutside:()=>{W(!1)},onChange:V=>{W(!1),p(V)}})}function m(u){return u.loading?(0,i.t)("grafana-ui.segment-async.loading","Loading options..."):u.error?(0,i.t)("grafana-ui.segment-async.error","Failed to load options"):(0,i.t)("grafana-ui.segment-async.no-options","No options found")}},57752:(G,R,e)=>{"use strict";e.d(R,{o:()=>h});var t=e(74848),n=e(32196),s=e(96540),a=e(37151),r=e(40845),g=e(29413),i=e(76892),l=e(86997),d=e(2336);const c=14;function h({value:o,onChange:m,Component:u,className:p,placeholder:f,inputPlaceholder:y,disabled:x,autofocus:v=!1,onExpandedChange:P,...E}){const D=(0,s.useRef)(null),[C,b]=(0,s.useState)(o),[T,S]=(0,s.useState)((0,g.kD)((o||"").toString(),c).width),[O,,M,I]=(0,d.Q)(v,P),L=(0,r.of)(l.m);if((0,a.A)(D,()=>{I(!1),m(C)}),!M)return(0,t.jsx)(O,{disabled:x,Component:u||(0,t.jsx)(i.c,{className:(0,n.cx)(L.segment,{[L.queryPlaceholder]:f!==void 0&&!C,[L.disabled]:x},p),children:o||f})});const B=(0,n.css)({width:`${Math.max(T+20,32)}px`});return(0,t.jsx)("input",{...E,ref:D,autoFocus:!0,className:(0,n.cx)("gf-form gf-form-input",B),value:C,placeholder:y,onChange:j=>{const{width:A}=(0,g.kD)(j.target.value,c);S(A),b(j.target.value)},onBlur:()=>{I(!1),m(C)},onKeyDown:j=>{[13,27].includes(j.keyCode)&&(I(!1),m(C))}})}},64765:(G,R,e)=>{"use strict";e.d(R,{L:()=>g});var t=e(74848),n=e(32196),s=e(40845),a=e(39268),r=e(76892);const g=({label:l,htmlFor:d,children:c,fill:h})=>{const o=(0,s.of)(i);return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(a.C,{children:[(0,t.jsx)(r.c,{htmlFor:d,width:12,className:o.label,children:l}),c,h&&(0,t.jsx)("div",{className:o.fill,children:(0,t.jsx)(r.c,{children:""})})]})})},i=l=>({label:(0,n.css)({color:l.colors.primary.text}),fill:(0,n.css)({flexGrow:1,marginBottom:l.spacing(.5)})})},13102:(G,R,e)=>{"use strict";e.d(R,{a:()=>r});var t=e(74848),n=e(96540),s=e(40845),a=e(90182);function r({value:g,placeholder:i="",options:l=[],onChange:d,onClickOutside:c,loadOptions:h=void 0,width:o,noOptionsMessage:m="",allowCustomValue:u=!1,allowEmptyValue:p=!1,...f}){const y=(0,n.useRef)(null),x=(0,s.$j)();let v=o>0?o/x.spacing.gridSize:void 0,P,E={};return h?(P=a.DW,E={loadOptions:h,defaultOptions:!0}):P=a.l6,(0,t.jsx)("div",{...f,ref:y,children:(0,t.jsx)(P,{width:v,noOptionsMessage:m,placeholder:i,autoFocus:!0,isOpen:!0,onChange:d,options:l,value:g,closeMenuOnSelect:!1,onCloseMenu:()=>{if(y&&y.current){const D=y.current.querySelector('input[id^="react-select-"]');D&&(D.value||p)?d({value:D.value,label:D.value}):c()}},allowCustomValue:u,...E})})}},86997:(G,R,e)=>{"use strict";e.d(R,{m:()=>n});var t=e(32196);const n=s=>{const a="v1"in s?s.v1.palette:s.palette;return{segment:(0,t.css)({cursor:"pointer",width:"auto"}),queryPlaceholder:(0,t.css)({color:a.gray2}),disabled:(0,t.css)({cursor:"not-allowed",opacity:.65,boxShadow:"none"})}}},2336:(G,R,e)=>{"use strict";e.d(R,{Q:()=>r});var t=e(74848),n=e(96540),s=e(40845),a=e(55852);const r=(g,i)=>{const l=(0,n.useRef)(null),d=(0,s.of)(a.my),[c,h]=(0,n.useState)(g),[o,m]=(0,n.useState)(0),u=f=>{h(f),i&&i(f)};return[({Component:f,onClick:y,disabled:x})=>(0,t.jsx)("button",{type:"button",className:d,ref:l,disabled:x,onClick:()=>{u(!0),l&&l.current&&m(l.current.clientWidth*1.25),y?.()},children:f}),o,c,u]}},67570:(G,R,e)=>{"use strict";e.d(R,{u:()=>m});var t=e(2543),n=e.n(t),s=e(96540),a=e(13752),r=e(62467),g=e(11150),i=e(96083),l=e(63720),d=e(59099),c=e(54479),h=e(11134);function o(u){return{label:u,value:stringToMs(u)}}class m extends s.PureComponent{constructor(p){super(p),this.propsSubject=new a.B,this.subscription=null}componentDidMount(){this.subscription=this.propsSubject.pipe((0,l.n)(p=>h.cC.isLive(p.interval)?(0,r.of)({}):p.loading?g.t:(0,i.Y)((0,c.dc)(p.interval))),(0,d.M)(()=>this.props.func())).subscribe(),this.propsSubject.next(this.props)}componentDidUpdate(p){h.cC.isLive(p.interval)&&h.cC.isLive(this.props.interval)||(0,t.isEqual)(p,this.props)||this.propsSubject.next(this.props)}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe(),this.propsSubject.unsubscribe()}render(){return null}}},63250:(G,R,e)=>{"use strict";e.d(R,{I1:()=>v,_$:()=>p,gl:()=>o});var t=e(2543),n=e.n(t),s=e(47070),a=e(75059),r=e(50082),g=e(62398),i=e(24293),l=e(90708),d=e(47737),c=e(52622);const h=["reduceOptions","orientation"];function o(D,C,b){let T=D.options;if(D.fieldConfig=D.fieldConfig||{defaults:{},overrides:[]},C==="singlestat"&&b.angular)return u(D,b);if(C==="graph")return m(D,b);for(const S of h)b.hasOwnProperty(S)&&(T[S]=(0,t.cloneDeep)(b[S]));return T}function m(D,C){const b=C.angular,T={orientation:s.wV.Auto,reduceOptions:{values:!1,calcs:[]},legend:{displayMode:c.lm.List,showLegend:!0,placement:"bottom",calcs:[]}};if(b.xaxis?.mode==="series"){D.fieldConfig={...D.fieldConfig,defaults:{...D.fieldConfig.defaults,color:{mode:"palette-classic"}}},b.xaxis.values&&(T.reduceOptions.calcs=E(b.xaxis.values));const S=b.legend;if(S){if(S.show?T.legend.displayMode=S.alignAsTable?c.lm.Table:c.lm.List:T.legend.showLegend=!1,S.rightSide&&(T.legend.placement="right"),S.values){const O=(0,t.pickBy)(S,t.identity);T.legend.calcs=P(O)}S.sideWidth&&(T.legend.width=S.sideWidth)}}return T}function u(D,C){const b=C.angular,T=a.AS.getIfExists(b.valueName),S={reduceOptions:{calcs:[T?T.id:a.gy.mean]},orientation:s.wV.Horizontal},O={};if(b.format&&(O.unit=b.format),b.tableColumn&&(S.reduceOptions.fields=`/^${b.tableColumn}$/`),b.nullPointMode&&(O.nullValueMode=b.nullPointMode),b.nullText&&(O.noValue=b.nullText),(b.decimals||b.decimals===0)&&(O.decimals=b.decimals),b.thresholds&&b.colors){const I=b.thresholds.split(",").map(B=>Number(B.trim())),L=[];for(const B of b.colors){const j=L.length-1;j>=0?L.push({value:I[j],color:B}):L.push({value:-1/0,color:B})}O.thresholds={mode:r.O.Absolute,steps:L}}const M=(0,g.bh)(b,O.thresholds);return M&&M.length&&(O.mappings=M),b.gauge&&b.gauge.show&&(O.min=b.gauge.minValue,O.max=b.gauge.maxValue),D.fieldConfig.defaults=O,S}function p(D){if(!D.options)return{};const C=parseFloat(D.pluginVersion||"6.1");let b=D.options;C<6.2&&(b=y(b)),C<6.3&&(b=f(b));const{fieldOptions:T}=b;if(C<6.6&&T){if(T&&T.override){const{override:M,...I}=b.fieldOptions;b={...b,fieldOptions:{...I,overrides:[]}}}let S=T?.defaults?.thresholds;S?delete T.defaults.thresholds:(S=T?.thresholds,delete T.thresholds),S&&(T.defaults.thresholds={mode:r.O.Absolute,steps:S});const{defaults:O}=T;O.color&&typeof O.color=="string"&&(O.color={mode:i.Y.Fixed,fixedColor:O.color}),(0,l.BF)(O)}if(C<7&&(D.fieldConfig=D.fieldConfig||{defaults:{},overrides:[]},D.fieldConfig={defaults:T&&T.defaults?{...D.fieldConfig.defaults,...T.defaults}:D.fieldConfig.defaults,overrides:T&&T.overrides?[...D.fieldConfig.overrides,...T.overrides]:D.fieldConfig.overrides},T&&(b.reduceOptions={values:T.values,limit:T.limit,calcs:T.calcs}),delete b.fieldOptions),C<7.1){const S=D.fieldConfig.defaults.title;S!=null&&(D.fieldConfig.defaults.displayName=S,delete D.fieldConfig.defaults.title)}if(C<8){const S=D.fieldConfig?.defaults;let O=S?.unit;O==="percent"?((0,t.isNumber)(S.min)||(S.min=0),(0,t.isNumber)(S.max)||(S.max=100)):O==="percentunit"&&((0,t.isNumber)(S.min)||(S.min=0),(0,t.isNumber)(S.max)||(S.max=1))}return b}function f(D){const{fieldOptions:C}=D;if(!C)return D;const{mappings:b,...T}=D.fieldOptions;let S;return D.thresholds&&(S={mode:r.O.Absolute,steps:x(D.thresholds)}),{...D,fieldOptions:{...T,defaults:{...C.defaults,mappings:b,thresholds:S}}}}function y(D){const{valueOptions:C}=D;if(!C)return D;const b={},T={};if(b.mappings=D.valueMappings,b.thresholds=D.thresholds,b.defaults=T,T.unit=C.unit,T.decimals=C.decimals,C.stat){const O=a.AS.get(C.stat);O&&(b.calcs=[O.id])}T.min=D.minValue,T.max=D.maxValue;const S={...D,fieldOptions:b};return(0,t.omit)(S,"valueMappings","thresholds","valueOptions","minValue","maxValue")}function x(D){if(!D||!D.length)return;const C=D.map(b=>({value:b.value===null?-1/0:b.value,color:b.color}));return(0,d.RU)(C),C[0].value=-1/0,C}function v(D){return(0,g.bh)(D)}function P(D){const C=[];for(const b in D){const T=a.AS.getIfExists(b);T&&C.push(T.id)}return C}function E(D){const C=[];return D?.forEach(b=>{Object.values(a.gy).includes(b)?C.push(b):b==="current"?C.push(a.gy.lastNotNull):b==="total"?C.push(a.gy.sum):b==="avg"&&C.push(a.gy.mean)}),D?C:[a.gy.sum]}},47097:(G,R,e)=>{"use strict";e.d(R,{F:()=>o});var t=e(74848),n=e(32196),s=e(52762),a=e(10434),r=e(96540),g=e(40845),i=e(80427);const l=m=>{const{value:u,children:p,visible:f,placement:y,tipFormatter:x,...v}=m,P=(0,r.useRef)(null),E=(0,r.useRef)(null),D=(0,g.of)(d);function C(){E.current!==null&&cancelAnimationFrame(E.current)}function b(){E.current=requestAnimationFrame(()=>{P.current?.forceAlign()})}return(0,r.useEffect)(()=>(f?b():C(),C),[u,f]),(0,t.jsx)(i.A,{overlayClassName:D.tooltip,placement:y,overlay:x??u,overlayInnerStyle:{minHeight:"auto"},ref:P,visible:f,...v,children:p})},d=m=>({tooltip:(0,n.css)({position:"absolute",display:"block",visibility:"visible",fontSize:m.typography.bodySmall.fontSize,opacity:.9,padding:3,zIndex:m.zIndex.tooltip})}),c=l;var h=e(24849);const o=({min:m,max:u,onChange:p,onAfterChange:f,orientation:y="horizontal",reverse:x,step:v,formatTooltipResult:P,value:E,tooltipAlwaysVisible:D=!0})=>{const C=(0,r.useCallback)(M=>{p?.(typeof M=="number"?[M,M]:M)},[p]),b=(0,r.useCallback)(M=>{f?.(typeof M=="number"?[M,M]:M)},[f]),T=y==="horizontal",S=(0,g.of)(h.$,T),O=(M,I)=>(0,t.jsx)(c,{value:I.value,visible:D||I.dragging,tipFormatter:P?()=>P(I.value):void 0,placement:T?"top":"right",children:M});return(0,t.jsxs)("div",{className:(0,n.cx)(S.container,S.slider),children:[(0,t.jsx)(s.Global,{styles:S.tooltip}),(0,t.jsx)(a.A,{min:m,max:u,step:v,defaultValue:E,range:!0,onChange:C,onChangeComplete:b,vertical:!T,reverse:x,handleRender:O})]})};o.displayName="RangeSlider"},77014:(G,R,e)=>{"use strict";e.d(R,{A:()=>d});var t=e(74848),n=e(32196),s=e(52762),a=e(10434),r=e(96540),g=e(40845),i=e(10354),l=e(24849);const d=({min:c,max:h,onChange:o,onAfterChange:m,orientation:u="horizontal",reverse:p,step:f,value:y,ariaLabelForHandle:x,marks:v,included:P})=>{const E=u==="horizontal",D=(0,g.of)(l.$,E,!!v),C=a.A,[b,T]=(0,r.useState)(y??c),S=(0,r.useCallback)(j=>{const A=typeof j=="number"?j:j[0];T(A),o?.(A)},[T,o]),O=(0,r.useCallback)(j=>{let A=+j.target.value;Number.isNaN(A)&&(A=0),T(A),o&&o(A),m&&m(A)},[o,m]),M=(0,r.useCallback)(j=>{const A=+j.target.value;A>h?T(h):A<c&&T(c)},[h,c]),I=(0,r.useCallback)(j=>{const A=typeof j=="number"?j:j[0];m?.(A)},[m]),L=E?[]:[D.sliderInputVertical],B=E?[]:[D.sliderInputFieldVertical];return(0,t.jsxs)("div",{className:(0,n.cx)(D.container,D.slider),children:[(0,t.jsx)(s.Global,{styles:D.tooltip}),(0,t.jsxs)("div",{className:(0,n.cx)(D.sliderInput,...L),children:[(0,t.jsx)(C,{min:c,max:h,step:f,defaultValue:y,value:b,onChange:S,onChangeComplete:I,vertical:!E,reverse:p,ariaLabelForHandle:x,marks:v,included:P}),(0,t.jsx)(i.p,{type:"text",className:(0,n.cx)(D.sliderInputField,...B),value:b,onChange:O,onBlur:M,min:c,max:h})]})]})};d.displayName="Slider"},24849:(G,R,e)=>{"use strict";e.d(R,{$:()=>a});var t=e(32196),n=e(52762),s=e(12415);const a=(r,g,i=!1)=>{const{spacing:l}=r,d=r.colors.border.strong,c=r.colors.primary.main,h=r.colors.primary.main,m=`box-shadow: 0px 0px 0px 6px ${r.colors.primary.transparent}`;return{container:(0,t.css)({width:"100%",margin:g?"inherit":l(1,3,1,1),paddingBottom:g&&i?r.spacing(1):"inherit",height:g?"auto":"100%"}),slider:(0,t.css)`
      .rc-slider {
        display: flex;
        flex-grow: 1;
        margin-left: 7px; // half the size of the handle to align handle to the left on 0 value
      }
      .rc-slider-mark {
        top: ${r.spacing(1.75)};
      }
      .rc-slider-mark-text {
        color: ${r.colors.text.disabled};
        font-size: ${r.typography.bodySmall.fontSize};
      }
      .rc-slider-mark-text-active {
        color: ${r.colors.text.primary};
      }
      .rc-slider-handle {
        border: none;
        background-color: ${h};
        box-shadow: ${r.shadows.z1};
        cursor: pointer;
        opacity: 1;
      }

      .rc-slider-handle:hover,
      .rc-slider-handle:active,
      .rc-slider-handle-click-focused:focus {
        ${m};
      }

      // The triple class names is needed because that's the specificity used in the source css :(
      .rc-slider-handle-dragging.rc-slider-handle-dragging.rc-slider-handle-dragging,
      .rc-slider-handle:focus-visible {
        box-shadow: 0 0 0 5px ${r.colors.text.primary};
      }

      .rc-slider-dot,
      .rc-slider-dot-active {
        background-color: ${r.colors.text.primary};
        border-color: ${r.colors.text.primary};
      }

      .rc-slider-track {
        background-color: ${c};
      }
      .rc-slider-rail {
        background-color: ${d};
        cursor: pointer;
      }
    `,tooltip:(0,n.css)`
      body {
        .rc-slider-tooltip {
          cursor: grab;
          user-select: none;
          z-index: ${r.zIndex.tooltip};
        }

        .rc-slider-tooltip-inner {
          color: ${r.colors.text.primary};
          background-color: transparent !important;
          border-radius: 0;
          box-shadow: none;
        }

        .rc-slider-tooltip-placement-top .rc-slider-tooltip-arrow {
          display: none;
        }

        .rc-slider-tooltip-placement-top {
          padding: 0;
        }
      }
    `,sliderInput:(0,t.css)({display:"flex",flexDirection:"row",alignItems:"center",width:"100%"}),sliderInputVertical:(0,t.css)({flexDirection:"column",height:"100%",".rc-slider":{margin:0,order:2}}),sliderInputField:(0,t.css)({marginLeft:r.spacing(3),width:"60px",input:{textAlign:"center"}}),sliderInputFieldVertical:(0,t.css)({margin:`0 0 ${r.spacing(3)} 0`,order:1})}}},5926:(G,R,e)=>{"use strict";e.d(R,{O:()=>y});var t=e(74848),n=e(2543),s=e(96540),a=e(39624),r=e(21423),g=e(11261),i=e(8066),l=e(52622),d=e(81297),c=e(51336),h=e(16895),o=e(73060),m=e(14236),u=e(46294);function p(x,v){const P=x.y.values.length,E={...x.y.config,...v},D=x.x??{name:"",values:[...Array(P).keys()],type:g.PU.number,config:{}};let C={refId:"sparkline",fields:[D,{...x.y,config:E}],length:P};return(0,o.g2)(D.values)||(C=(0,m.ES)(C,0)),(0,u.M)({frame:C,refFieldPseudoMin:x.timeRange?.from.valueOf(),refFieldPseudoMax:x.timeRange?.to.valueOf()})}const f={drawStyle:l.GR.Line,showPoints:l.yL.Auto,axisPlacement:l.vM.Hidden,pointSize:2};class y extends s.PureComponent{constructor(v){super(v);const P=p(v.sparkline,v.config);this.state={data:(0,h.bq)(P,(0,h.ro)(P)),alignedDataFrame:P,configBuilder:this.prepareConfig(P)}}static getDerivedStateFromProps(v,P){const E=p(v.sparkline,v.config),D=(0,a.C)(E);return D?{...P,data:(0,h.bq)(D,(0,h.ro)(D)),alignedDataFrame:D}:{...P}}componentDidUpdate(v,P){const{alignedDataFrame:E}=this.state;if(!E)return;let D=!1;if(v.sparkline!==this.props.sparkline){const C=!(0,r.bW)(this.state.alignedDataFrame,P.alignedDataFrame),b=!(0,n.isEqual)(E.fields[1].state?.range,P.alignedDataFrame.fields[1].state?.range);D=C||b}else D=!(0,n.isEqual)(v.config,this.props.config);D&&this.setState({configBuilder:this.prepareConfig(E)})}getYRange(v){let{min:P,max:E}=this.state.alignedDataFrame.fields[1].state?.range;const D=+this.state.alignedDataFrame.fields[1].config?.noValue;return Number.isNaN(D)||(P=Math.min(P,+D),E=Math.max(E,+D)),P===E?(P===0?E=100:(P=0,E*=2),[P,E]):[Math.max(P,v.config.min??-1/0),Math.min(E,v.config.max??1/0)]}prepareConfig(v){const{theme:P}=this.props,E=new c.e;E.setCursor({show:!1,x:!1,y:!1});const D=v.fields[0];E.addScale({scaleKey:"x",orientation:l.Lt.Horizontal,direction:l.ON.Right,isTime:!1,range:()=>{const{sparkline:C}=this.props;if(C.x){if(C.timeRange&&C.x.type===g.PU.time)return[C.timeRange.from.valueOf(),C.timeRange.to.valueOf()];const b=C.x.values;return[b[0],b[b.length-1]]}return[0,C.y.values.length-1]}}),E.addAxis({scaleKey:"x",theme:P,placement:l.vM.Hidden});for(let C=0;C<v.fields.length;C++){const b=v.fields[C],T=b.config,S={...f,...T.custom};if(b===D||b.type!==g.PU.number)continue;const O=T.unit||"__fixed";E.addScale({scaleKey:O,orientation:l.Lt.Vertical,direction:l.ON.Up,range:()=>this.getYRange(b)}),E.addAxis({scaleKey:O,theme:P,placement:l.vM.Hidden});const M=(0,i.Qi)(b),I=M.getCalculator(b,P)(0,0),L=S.drawStyle===l.GR.Points?l.yL.Always:S.showPoints;E.addSeries({pxAlign:!1,scaleKey:O,theme:P,colorMode:M,thresholds:T.thresholds,drawStyle:S.drawStyle,lineColor:S.lineColor??I,lineWidth:S.lineWidth,lineInterpolation:S.lineInterpolation,showPoints:L,pointSize:S.pointSize,fillOpacity:S.fillOpacity,fillColor:S.fillColor,lineStyle:S.lineStyle,gradientMode:S.gradientMode,spanNulls:S.spanNulls})}return E}render(){const{data:v,configBuilder:P}=this.state,{width:E,height:D}=this.props;return(0,t.jsx)(d.Z,{data:v,config:P,width:E,height:D})}}},21633:(G,R,e)=>{"use strict";e.d(R,{h:()=>h});var t=e(32196),n=e(2543),s=e.n(n),a=e(96540),r=e(40845),g=e(69144);const i=.3,l=new Set(["ArrowUp","ArrowDown"]),d=new Set(["ArrowLeft","ArrowRight"]),c={row:{dim:"width",axis:"clientX",min:"minWidth",max:"maxWidth"},column:{dim:"height",axis:"clientY",min:"minHeight",max:"maxHeight"}};function h(f){const{direction:y,initialSize:x=.5,dragPosition:v="middle",onResizing:P,onSizeChanged:E}=f,D=16,C=(0,a.useRef)(null),b=(0,a.useRef)(null),T=(0,a.useRef)(null),S=(0,a.useRef)(null),O=(0,a.useRef)(null),M=(0,a.useRef)("1fr"),I=(0,a.useRef)(void 0),L=(0,a.useRef)(void 0),B=c[y].dim,j=c[y].axis,A=c[y].min,K=c[y].max;u(S.current,ne=>{for(const le of ne){if(!le.target.isSameNode(S.current)||!b.current)return;const re=b.current.getBoundingClientRect()[B],de=m(b.current);C.current.ariaValueNow=o(re,de[A],de[K])}},500,[K,A,y,B]);const W=(0,a.useRef)(null),U=(0,a.useCallback)(ne=>{b.current&&(M.current=b.current.getBoundingClientRect()[B],O.current=S.current.getBoundingClientRect()[B],W.current=ne[j],C.current.setPointerCapture(ne.pointerId),I.current=m(b.current),L.current=void 0)},[B,j]),F=(0,a.useCallback)(ne=>{if(W.current!==null&&M.current!=="1fr"){const le=ne[j]-W.current,re=I.current,de=(0,n.clamp)(M.current+le,re[A],re[K]),oe=de/(O.current-D);b.current.style.flexGrow=`${oe}`,T.current.style.flexGrow=`${1-oe}`,C.current.ariaValueNow=o(de,re[A],re[K]),P?.(oe,de)}},[D,j,A,K,P]),V=(0,a.useCallback)(ne=>{ne.preventDefault(),ne.stopPropagation(),C.current.releasePointerCapture(ne.pointerId),W.current=null,typeof M.current=="number"&&E?.(parseFloat(b.current.style.flexGrow),M.current)},[E]),w=(0,a.useRef)(new Set),z=(0,a.useRef)(null),N=(0,a.useCallback)(ne=>{if(w.current.size===0){z.current=null;return}else if(M.current==="1fr")return;const de=(ne-(z.current??ne))*i;let oe=0;y==="row"?(w.current.has("ArrowLeft")&&(oe-=de),w.current.has("ArrowRight")&&(oe+=de)):(w.current.has("ArrowUp")&&(oe-=de),w.current.has("ArrowDown")&&(oe+=de));const J=I.current,ce=b.current.getBoundingClientRect()[B],pe=(0,n.clamp)(ce+oe,J[A],J[K]),xe=pe/(O.current-D);b.current.style.flexGrow=`${xe}`,T.current.style.flexGrow=`${1-xe}`,C.current.ariaValueNow=o(pe,J[A],J[K]),P?.(xe,pe),z.current=ne,window.requestAnimationFrame(N)},[y,D,A,K,B,P]),H=(0,a.useCallback)(ne=>{if(!b.current||!T.current||!C.current||!S.current)return;if(ne.key==="Enter"){L.current===void 0?(L.current=b.current.style.flexGrow,b.current.style.flexGrow="0",T.current.style.flexGrow="1"):(b.current.style.flexGrow=L.current,T.current.style.flexGrow=`${1-parseFloat(L.current)}`,L.current=void 0);return}else if(ne.key==="Home"){I.current=m(b.current),O.current=S.current.getBoundingClientRect()[B];const re=I.current[A]/(O.current-D);b.current.style.flexGrow=`${re}`,T.current.style.flexGrow=`${1-re}`,C.current.ariaValueNow="0";return}else if(ne.key==="End"){I.current=m(b.current),O.current=S.current.getBoundingClientRect()[B];const re=I.current[K]/(O.current-D);b.current.style.flexGrow=`${re}`,T.current.style.flexGrow=`${1-re}`,C.current.ariaValueNow="100";return}if(!(y==="column"&&l.has(ne.key)||y==="row"&&d.has(ne.key))||w.current.has(ne.key))return;if(L.current=void 0,ne.preventDefault(),ne.stopPropagation(),M.current=b.current.getBoundingClientRect()[B],O.current=S.current.getBoundingClientRect()[B],I.current=m(b.current),!w.current.has(ne.key)){const re=w.current.size===0;w.current.add(ne.key),re&&window.requestAnimationFrame(N)}},[y,N,D,K,B,A]),Q=(0,a.useCallback)(ne=>{y==="row"&&!d.has(ne.key)||y==="column"&&!l.has(ne.key)||(w.current.delete(ne.key),typeof M.current=="number"&&E?.(parseFloat(b.current.style.flexGrow),M.current))},[y,E]),X=(0,a.useCallback)(()=>{if(!b.current||!T.current)return;b.current.style.flexGrow="0.5",T.current.style.flexGrow="0.5";const ne=m(b.current);I.current=ne,M.current=b.current.getBoundingClientRect()[B],C.current.ariaValueNow=`${o(M.current,ne[A],ne[K])}`},[K,B,A]),ee=(0,a.useCallback)(()=>{w.current.size>0&&(w.current.clear(),W.current=null,typeof M.current=="number"&&E?.(parseFloat(b.current.style.flexGrow),M.current))},[E]),Z=(0,r.of)(p,y),q=(0,r.of)(g.l,v),ae=y==="column"?q.dragHandleHorizontal:q.dragHandleVertical,k=(0,a.useId)(),se={flexGrow:(0,n.clamp)(x??.5,0,1),[A]:"min-content"},te={flexGrow:(0,n.clamp)(1-x,0,1),[A]:"min-content"};return{containerProps:{ref:S,className:Z.container},primaryProps:{ref:b,className:Z.panel,style:se},secondaryProps:{ref:T,className:Z.panel,style:te},splitterProps:{onPointerUp:V,onPointerDown:U,onPointerMove:F,onKeyDown:H,onKeyUp:Q,onDoubleClick:X,onBlur:ee,ref:C,style:{[B]:`${D}px`},role:"separator","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":x*100,"aria-controls":`start-panel-${k}`,"aria-label":"Pane resize widget",tabIndex:0,className:ae}}}function o(f,y,x){return`${(0,n.clamp)((f-y)/(x-y)*100,0,100)}`}function m(f){const y=document.body.style.overflow,x=f.style.width,v=f.style.height,P=f.style.flexGrow;document.body.style.overflow="hidden",f.style.flexGrow="0";const{width:E,height:D}=f.getBoundingClientRect();f.style.flexGrow="100";const{width:C,height:b}=f.getBoundingClientRect();return document.body.style.overflow=y,f.style.width=x,f.style.height=v,f.style.flexGrow=P,{minWidth:E,maxWidth:C,minHeight:D,maxHeight:b}}function u(f,y,x=0,v){const P=(0,n.throttle)(y,x);(0,a.useLayoutEffect)(()=>{if(!f)return;const E=new ResizeObserver(P);return E.observe(f,{box:"device-pixel-content-box"}),()=>E.disconnect()},v)}function p(f,y){return{container:(0,t.css)({display:"flex",flexDirection:y==="row"?"row":"column",width:"100%",flexGrow:1,overflow:"hidden"}),panel:(0,t.css)({display:"flex",position:"relative",flexBasis:0})}}},42734:(G,R,e)=>{"use strict";e.d(R,{S:()=>i});var t=e(74848),n=e(2543),s=e.n(n),a=e(96540),r=e(75059),g=e(90182);class i extends a.PureComponent{constructor(){super(...arguments),this.checkInput=()=>{const{stats:d,allowMultiple:c,defaultStat:h,onChange:o}=this.props,m=r.AS.list(d);if(m.length!==d.length){const u=m.map(f=>f.id),p=(0,n.difference)(d,u);console.warn("Unknown stats",p,d),o(m.map(f=>f.id))}!c&&d.length>1&&(console.warn("Removing extra stat",d),o([d[0]])),h&&d.length<1&&o([h])},this.onSelectionChange=d=>{const{onChange:c}=this.props;Array.isArray(d)?c(d.map(h=>h.value)):c(d&&d.value?[d.value]:[])}}static{this.defaultProps={allowMultiple:!1}}componentDidMount(){this.checkInput()}componentDidUpdate(d){this.checkInput()}render(){const{stats:d,allowMultiple:c,defaultStat:h,placeholder:o,className:m,menuPlacement:u,width:p,inputId:f,filterOptions:y}=this.props,x=r.AS.selectOptions(d,y);return(0,t.jsx)(g.l6,{value:x.current,className:m,isClearable:!h,isMulti:c,width:p,isSearchable:!0,options:x.options,placeholder:o,onChange:this.onSelectionChange,menuPlacement:u,inputId:f})}}},15292:(G,R,e)=>{"use strict";e.d(R,{K:()=>h,d:()=>c});var t=e(74848),n=e(32196),s=e(2543),a=e.n(s),r=e(96540),g=e(95344),i=e(40845),l=e(16797),d=e(14578);const c=(0,r.forwardRef)(({value:m,checked:u,onChange:p,id:f,label:y,disabled:x,invalid:v=!1,...P},E)=>{u&&(0,g.l)("Switch","checked prop","value");const D=(0,i.of)(o),C=(0,r.useRef)(f||(0,s.uniqueId)("switch-"));return(0,t.jsxs)("div",{className:(0,n.cx)(D.switch,v&&D.invalid),children:[(0,t.jsx)("input",{type:"checkbox",disabled:x,checked:m,onChange:b=>{!x&&p?.(b)},id:C.current,...P,ref:E}),(0,t.jsx)("label",{htmlFor:C.current,"aria-label":y??"Toggle switch",children:(0,t.jsx)(d.I,{name:"check",size:"xs"})})]})});c.displayName="Switch";const h=(0,r.forwardRef)(({transparent:m,className:u,showLabel:p,label:f,value:y,id:x,invalid:v,...P},E)=>{const D=(0,i.of)(o,m);return(0,t.jsxs)("div",{className:(0,n.cx)(D.inlineContainer,u,P.disabled&&D.disabled,v&&D.invalid),children:[p&&(0,t.jsx)("label",{htmlFor:x,className:(0,n.cx)(D.inlineLabel,y&&D.inlineLabelEnabled,"inline-switch-label"),children:f}),(0,t.jsx)(c,{...P,id:x,label:f,ref:E,value:y})]})});h.displayName="Switch";const o=(m,u)=>({switch:(0,n.css)({width:"32px",height:"16px",position:"relative",lineHeight:1,input:{height:"100%",width:"100% !important",opacity:0,zIndex:-1e3,position:"absolute","&:checked + label":{background:m.colors.primary.main,borderColor:m.colors.primary.main,"&:hover":{background:m.colors.primary.shade},svg:{transform:"translate3d(17px, -50%, 0)",background:m.colors.primary.contrastText,color:m.colors.primary.main}},"&:disabled + label":{background:m.colors.action.disabledBackground,borderColor:m.colors.border.weak,cursor:"not-allowed",svg:{background:m.colors.text.disabled}},"&:disabled:checked + label":{background:m.colors.primary.transparent,svg:{color:m.colors.primary.contrastText}},"&:focus + label, &:focus-visible + label":(0,l.getFocusStyles)(m),"&:focus:not(:focus-visible) + label":(0,l.getMouseFocusStyles)(m)},label:{width:"100%",height:"100%",cursor:"pointer",borderRadius:m.shape.radius.pill,background:m.components.input.background,border:`1px solid ${m.components.input.borderColor}`,transition:"all 0.3s ease","&:hover":{borderColor:m.components.input.borderHover},svg:{position:"absolute",display:"block",color:"transparent",width:"12px",height:"12px",borderRadius:m.shape.radius.circle,background:m.colors.text.secondary,boxShadow:m.shadows.z1,top:"50%",transform:"translate3d(1px, -50%, 0)",transition:"transform 0.2s cubic-bezier(0.19, 1, 0.22, 1)","@media (forced-colors: active)":{border:`1px solid ${m.colors.primary.contrastText}`}}}}),inlineContainer:(0,n.css)({padding:m.spacing(0,1),height:m.spacing(m.components.height.md),display:"inline-flex",alignItems:"center",background:u?"transparent":m.components.input.background,border:`1px solid ${u?"transparent":m.components.input.borderColor}`,borderRadius:m.shape.radius.default,"&:hover":{border:`1px solid ${u?"transparent":m.components.input.borderHover}`,".inline-switch-label":{color:m.colors.text.primary}}}),disabled:(0,n.css)({backgroundColor:"rgba(204, 204, 220, 0.04)",color:"rgba(204, 204, 220, 0.6)",border:"1px solid rgba(204, 204, 220, 0.04)"}),inlineLabel:(0,n.css)({cursor:"pointer",paddingRight:m.spacing(1),color:m.colors.text.secondary,whiteSpace:"nowrap"}),inlineLabelEnabled:(0,n.css)({color:m.colors.text.primary}),invalid:(0,n.css)({"input + label, input:checked + label, input:hover + label":{border:`1px solid ${m.colors.error.border}`}})})},60734:(G,R,e)=>{"use strict";e.d(R,{q:()=>c});var t=e(74848),n=e(32196),s=e(96540),a=e(29158),r=e(63021),g=e(40675),i=e(40980),l=e(40845),d=e(40276);function c({tabs:o,defaultTab:m,closeIconTooltip:u,onClose:p,testId:f}){const[y,x]=(0,s.useState)(o.some(C=>C.value===m)?m:o[0].value),v=(0,l.of)(h),P=(0,l.$j)(),E=C=>{x(C.value)},D=`calc(100% - (${P.components.menuTabs.height}px + ${P.spacing(1)}))`;return(0,t.jsxs)("div",{className:v.container,"data-testid":f,children:[(0,t.jsxs)(r.U,{className:v.tabs,children:[o.map(C=>(0,t.jsx)(g.o,{label:C.label,active:C.value===y,onChangeTab:()=>E(C),icon:C.icon},C.value)),(0,t.jsx)(a.K,{className:v.close,onClick:p,name:"times",tooltip:u??"Close"})]}),(0,t.jsx)(d.E,{autoHeightMin:D,autoHeightMax:D,children:(0,t.jsx)(i.J,{className:v.tabContent,children:o.find(C=>C.value===y)?.content})})]})}const h=o=>({container:(0,n.css)({height:"100%"}),tabContent:(0,n.css)({padding:o.spacing(2),backgroundColor:o.colors.background.primary,height:"100%"}),close:(0,n.css)({position:"absolute",right:"16px",top:"5px",cursor:"pointer",fontSize:o.typography.size.lg}),tabs:(0,n.css)({paddingTop:o.spacing(1),borderColor:o.colors.border.weak,ul:{marginLeft:o.spacing(2)}})})},92015:(G,R,e)=>{"use strict";e.d(R,{u:()=>l,d:()=>c});var t=e(74848),n=e(96540),s=e(75059),a=e(13544),r=e(32196);const g=h=>{const o=(0,r.css)({width:"100%",listStyle:"none"}),m=(0,r.css)({width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between"});return h.value&&!Array.isArray(h.value)?(0,t.jsx)("span",{children:h.value}):h.value&&Array.isArray(h.value)&&h.value.length>0?(0,t.jsx)("ul",{className:o,children:h.value.map((u,p)=>{const f=Object.keys(u)[0];return(0,t.jsxs)("li",{className:m,children:[(0,t.jsx)("span",{children:f}),(0,t.jsx)("span",{children:u[f]})]},p)})}):i},i=()=>(0,t.jsx)("span",{children:"\xA0"});function l(h){const{totalColumnsWidth:o,footerGroups:m,isPaginationVisible:u,tableStyles:p}=h,f=a.Tp.components.Panels.Visualization.Table;return(0,t.jsx)("div",{style:{position:u?"relative":"absolute",width:o?`${o}px`:"100%",bottom:"0px"},children:m.map(y=>{const{key:x,...v}=y.getFooterGroupProps();return(0,n.createElement)("div",{className:p.tfoot,...v,key:x,"data-testid":f.footer},y.headers.map(P=>d(P,p)))})})}function d(h,o){const{key:m,...u}=h.getHeaderProps();return u?(u.style=u.style??{},u.style.position="absolute",u.style.justifyContent=h.justifyContent,(0,t.jsx)("div",{className:o.headerCell,...u,children:h.render("Footer")},m)):null}function c(h,o,m){if(o===void 0)return i;if(m){if(o[h]===void 0)return i;const u=s.AS.get(s.gy.count).name;return g({value:[{[u]:String(o[h])}]})}return g({value:o[h]})}},30355:(G,R,e)=>{"use strict";e.d(R,{a:()=>m,t:()=>o});var t=e(74848),n=e(58563),s=e(14236),a=e(83195),r=e(11261),g=e(52622),i=e(40845),l=e(29413),d=e(9286),c=e(5926),h=e(57021);const o={type:g.ob.Sparkline,drawStyle:g.GR.Line,lineInterpolation:g.dx.Smooth,lineWidth:1,fillOpacity:17,gradientMode:g.on.Hue,pointSize:2,barAlignment:g.Nj.Center,showPoints:g.yL.Never,hideValue:!1},m=f=>{const{field:y,innerWidth:x,tableStyles:v,cell:P,cellProps:E,timeRange:D}=f,C=u(P.value),b=(0,i.$j)();if(!C)return(0,t.jsx)("div",{...E,className:v.cellContainer,children:y.config.noValue||"no data"});C.x&&!C.x.config.interval&&C.x.values.length>1&&(C.x.config.interval=C.x.values[1]-C.x.values[0]),C.y.values=C.y.values.map(B=>Number.isFinite(B)?B:null);const T=(0,n.AP)(C.y);C.y.config.min=T.min,C.y.config.max=T.max,C.y.state={range:T},C.timeRange=D;const S=p(y),O={color:y.config.color,custom:{...o,...S}},M=y.config.custom?.cellOptions?.hideValue;let I=0,L=null;if(!M){const B=(0,s.LI)(P.value)?P.value.value:null,j=y.display(B),A=(0,h.zi)(y,j,P.row.index);I=(0,l.kD)((0,a.cN)(A),16).width+b.spacing.gridSize,L=(0,t.jsx)(d.i,{style:{width:`${I-b.spacing.gridSize}px`,textAlign:"right",marginRight:b.spacing(1)},value:j})}return(0,t.jsxs)("div",{...E,className:v.cellContainer,children:[L,(0,t.jsx)("div",{children:(0,t.jsx)(c.O,{width:x-I,height:v.cellHeightInner,sparkline:C,config:O,theme:v.theme})})]})};function u(f){if(Array.isArray(f))return{y:{name:"test",type:r.PU.number,values:f,config:{}}};if((0,s.ci)(f)){const y=f.fields.find(v=>v.type===r.PU.time),x=f.fields.find(v=>v.type===r.PU.number);if(y&&x)return{x:y,y:x}}}function p(f){let y=(0,h.bk)(f);if(y.type===g.ob.Auto&&(y={...y,type:g.ob.Sparkline}),y.type===g.ob.Sparkline)return y;throw new Error(`Expected options type ${g.ob.Sparkline} but got ${y.type}`)}},77093:(G,R,e)=>{"use strict";e.d(R,{X:()=>Se});var t=e(74848),n=e(96540),s=e(32885),a=e(75059),r=e(11261),g=e(19845),i=e(13544),l=e(52622),d=e(40845),c=e(40276),h=e(19384),o=e(92015),m=e(4025),u=e(14578),p=e(32196),f=e(13840),y=e(91793),x=e(83195),v=e(67061),P=e(67647),E=e(9261),D=e(10880),C=e(60029);const b=28,T=b*5,S={Contains:{label:"Contains",value:"Contains",description:"Contains"},"=":{label:"=",value:"=",description:"Equals"},"!=":{label:"!=",value:"!=",description:"Not equals"},">":{label:">",value:">",description:"Greater"},">=":{label:">=",value:">=",description:"Greater or Equal"},"<":{label:"<",value:"<",description:"Less"},"<=":{label:"<=",value:"<=",description:"Less or Equal"},Expression:{label:"Expression",value:"Expression",description:'Bool Expression (Char $ represents the column value in the expression, e.g. "$ >= 10 && $ <= 12")'}},O=Object.values(S),M=S.Contains,I=S.Expression,L=ye=>{if(ye=ye.trim().replace(/\\/g,""),/^(\d{4}-\d{2}-\d{2}|\d{4}\/\d{2}\/\d{2})/.test(ye)){const Ce=new Date(ye);if(!isNaN(Ce.getTime())){const Ue=(0,x.j_)("dateTimeAsIso");return(0,x.cN)(Ue(Ce.getTime()))}}const Ve=parseFloat(ye);if(!isNaN(Ve))return Ve;const Me=ye.toLowerCase();return Me==="true"||Me==="false"?Me==="true":ye},B=({options:ye,values:Ve,caseSensitive:Me,showOperators:Ce,onChange:Ue,searchFilter:Ae,setSearchFilter:we,operator:We,setOperator:_e})=>{const at=(0,n.useMemo)(()=>new RegExp(Ae,Me?void 0:"i"),[Ae,Me]),ut=(0,n.useMemo)(()=>ye.filter(be=>{if(!Ce||!Ae||We.value===M.value)return be.label===void 0?!1:at.test(be.label);if(We.value===I.value){if(be.value===void 0)return!1;try{const Ke=Ae.replace(/\\/g,""),ze=new Function("$",`'use strict'; return ${Ke};`),nt=L(be.value);return ze(nt)}catch{}return!1}else{if(be.value===void 0)return!1;const Ke=L(be.value),ze=L(Ae);switch(We.value){case"=":return Ke===ze;case"!=":return Ke!==ze;case">":return Ke>ze;case">=":return Ke>=ze;case"<":return Ke<ze;case"<=":return Ke<=ze}return!1}}),[ye,at,Ce,We,Ae]),Tt=(0,n.useMemo)(()=>ut.filter(be=>Ve.includes(be)),[ut,Ve]),It=(0,n.useMemo)(()=>ut.length===Tt.length,[ut,Tt]),ge=(0,n.useMemo)(()=>Tt.length>0&&ut.length>Tt.length,[ut,Tt]),Ie=(0,n.useMemo)(()=>Tt.length?`${Tt.length} selected`:"Select all",[Tt]),ue=(0,n.useMemo)(()=>ut.length!==Tt.length?"Add all displayed values to the filter":"Remove all displayed values from the filter",[ut,Tt]),me=(0,d.of)(A),Ne=(0,d.$j)().spacing.gridSize,Fe=(0,n.useMemo)(()=>Math.min(ut.length*b,T)+Ne,[Ne,ut.length]),Be=(0,n.useCallback)(be=>Ke=>{const ze=Ke.currentTarget.checked?Ve.concat(be):Ve.filter(nt=>nt.value!==be.value);Ue(ze)},[Ue,Ve]),he=(0,n.useCallback)(()=>{if(ut.length===Tt.length){const be=Ve.filter(Ke=>!ut.includes(Ke));Ue(be)}else{const be=[...new Set([...Ve,...ut])];Ue(be)}},[Ue,Ve,ut,Tt]);return(0,t.jsxs)(v.B,{direction:"column",gap:.25,children:[!Ce&&(0,t.jsx)(P.Z,{placeholder:"Filter values",onChange:we,value:Ae}),Ce&&(0,t.jsxs)(v.B,{direction:"row",gap:0,children:[(0,t.jsx)(E.f,{variant:"canvas",options:O,onChange:_e,value:We,tooltip:We.description}),(0,t.jsx)(P.Z,{placeholder:"Filter values",onChange:we,value:Ae})]}),ut.length>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.Y1,{height:Fe,itemCount:ut.length,itemSize:b,itemData:{items:ut,values:Tt,onCheckedChanged:Be,className:me.filterListRow},width:"100%",className:me.filterList,children:j}),(0,t.jsxs)(v.B,{direction:"column",gap:.25,children:[(0,t.jsx)("div",{className:(0,p.cx)(me.selectDivider)}),(0,t.jsx)("div",{className:(0,p.cx)(me.filterListRow),children:(0,t.jsx)(D.S,{value:It,indeterminate:ge,label:Ie,description:ue,onChange:he})})]})]}):(0,t.jsx)(C.J,{className:me.noValuesLabel,children:"No values"})]})};function j({index:ye,style:Ve,data:{onCheckedChanged:Me,items:Ce,values:Ue,className:Ae}}){const we=Ce[ye],{value:We,label:_e}=we,at=Ue.find(ut=>ut.value===We)!==void 0;return(0,t.jsx)("div",{className:Ae,style:Ve,title:_e,children:(0,t.jsx)(D.S,{value:at,label:_e,onChange:Me(we)})})}const A=ye=>({filterList:(0,p.css)({label:"filterList"}),filterListRow:(0,p.css)({label:"filterListRow",cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",padding:ye.spacing(.5),":hover":{backgroundColor:ye.colors.action.hover}}),selectDivider:(0,p.css)({label:"selectDivider",width:"100%",borderTop:`1px solid ${ye.colors.border.medium}`,padding:ye.spacing(.5,2)}),noValuesLabel:(0,p.css)({paddingTop:ye.spacing(1)})});var K=e(8866),W=e(29158),U=e(55852),F=e(57021);const V=({column:{preFilteredRows:ye,filterValue:Ve,setFilter:Me},onClose:Ce,field:Ue,searchFilter:Ae,setSearchFilter:we,operator:We,setOperator:_e})=>{const at=(0,d.$j)(),ut=(0,n.useMemo)(()=>(0,F.MY)(ye,Ue),[ye,Ue]),Tt=(0,n.useMemo)(()=>(0,F.Yz)(ut),[ut]),It=(0,n.useMemo)(()=>(0,F.Sj)(Tt,Ve),[Tt,Ve]),[ge,Ie]=(0,n.useState)(It),[ue,me]=(0,n.useState)(!1),Pe=(0,n.useCallback)(be=>Ce(),[Ce]),Ne=(0,n.useCallback)(be=>{const Ke=ge.length?ge:void 0;Me(Ke),Ce()},[Me,ge,Ce]),Fe=(0,n.useCallback)(be=>{Me(void 0),Ce()},[Me,Ce]),Be=(0,n.useMemo)(()=>Ve!==void 0,[Ve]),he=(0,d.of)(w);return(0,t.jsx)(K.N,{onClick:Pe,useCapture:!0,children:(0,t.jsx)("div",{className:(0,p.cx)(he.filterContainer),onClick:z,children:(0,t.jsxs)(v.B,{direction:"column",gap:3,children:[(0,t.jsxs)(v.B,{direction:"column",gap:.5,children:[(0,t.jsxs)(v.B,{justifyContent:"space-between",alignItems:"center",children:[(0,t.jsx)(C.J,{className:he.label,children:"Filter by values:"}),(0,t.jsx)(W.K,{name:"text-fields",tooltip:"Match case",style:{color:ue?at.colors.text.link:at.colors.text.disabled},onClick:()=>{me(be=>!be)}})]}),(0,t.jsx)("div",{className:(0,p.cx)(he.listDivider)}),(0,t.jsx)(B,{onChange:Ie,values:ge,options:Tt,caseSensitive:ue,showOperators:!0,searchFilter:Ae,setSearchFilter:we,operator:We,setOperator:_e})]}),(0,t.jsxs)(v.B,{gap:3,children:[(0,t.jsxs)(v.B,{children:[(0,t.jsx)(U.$n,{size:"sm",onClick:Ne,children:"Ok"}),(0,t.jsx)(U.$n,{size:"sm",variant:"secondary",onClick:Pe,children:"Cancel"})]}),Be&&(0,t.jsx)(v.B,{children:(0,t.jsx)(U.$n,{fill:"text",size:"sm",onClick:Fe,children:"Clear filter"})})]})]})})})},w=ye=>({filterContainer:(0,p.css)({label:"filterContainer",width:"100%",minWidth:"250px",height:"100%",maxHeight:"400px",backgroundColor:ye.colors.background.primary,border:`1px solid ${ye.colors.border.weak}`,padding:ye.spacing(2),boxShadow:ye.shadows.z3,borderRadius:ye.shape.radius.default}),listDivider:(0,p.css)({label:"listDivider",width:"100%",borderTop:`1px solid ${ye.colors.border.medium}`,padding:ye.spacing(.5,2)}),label:(0,p.css)({marginBottom:0})}),z=ye=>{ye.stopPropagation()},N=({column:ye,field:Ve,tableStyles:Me})=>{const Ce=(0,n.useRef)(null),[Ue,Ae]=(0,n.useState)(!1),we=(0,d.of)(H),We=(0,n.useMemo)(()=>!!ye.filterValue,[ye.filterValue]),_e=(0,n.useCallback)(()=>Ae(!0),[Ae]),at=(0,n.useCallback)(()=>Ae(!1),[Ae]),[ut,Tt]=(0,n.useState)(""),[It,ge]=(0,n.useState)(M);return!Ve||!Ve.config.custom?.filterable?null:(0,t.jsxs)("button",{className:(0,p.cx)(Me.headerFilter,We?we.filterIconEnabled:we.filterIconDisabled),ref:Ce,type:"button",onClick:_e,children:[(0,t.jsx)(u.I,{name:"filter"}),Ue&&Ce.current&&(0,t.jsx)(f.A,{content:(0,t.jsx)(V,{column:ye,tableStyles:Me,field:Ve,onClose:at,searchFilter:ut,setSearchFilter:Tt,operator:It,setOperator:ge}),placement:"bottom-start",referenceElement:Ce.current,show:!0})]})},H=ye=>({filterIconEnabled:(0,p.css)({label:"filterIconEnabled",color:ye.colors.primary.text}),filterIconDisabled:(0,p.css)({label:"filterIconDisabled",color:ye.colors.text.disabled})}),Q=ye=>{const{headerGroups:Ve,showTypeIcons:Me,tableStyles:Ce}=ye,Ue=i.Tp.components.Panels.Visualization.Table;return(0,t.jsx)("div",{role:"rowgroup",className:Ce.headerRow,children:Ve.map(Ae=>{const{key:we,...We}=Ae.getHeaderGroupProps();return(0,n.createElement)("div",{className:Ce.thead,...We,key:we,"aria-label":Ue.header,role:"row"},Ae.headers.map((_e,at)=>X(_e,Ce,Me)))})})};function X(ye,Ve,Me){const{key:Ce,...Ue}=ye.getHeaderProps(),Ae=ye.field??null,we=Ae?.config.custom;ye.canResize&&(Ue.style.userSelect=ye.isResizing?"none":"auto"),Ue.style.position="absolute",Ue.style.justifyContent=ye.justifyContent,Ue.style.left=ye.totalLeft;let We=ye.render("Header"),_e=ye.canSort&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("button",{...ye.getSortByToggleProps(),className:Ve.headerCellLabel,children:[Me&&(0,t.jsx)(u.I,{name:(0,m.SS)(Ae),title:Ae?.type,size:"sm",className:Ve.typeIcon}),(0,t.jsx)("div",{children:We}),ye.isSorted&&(ye.isSortedDesc?(0,t.jsx)(u.I,{size:"lg",name:"arrow-down",className:Ve.sortIcon}):(0,t.jsx)(u.I,{name:"arrow-up",size:"lg",className:Ve.sortIcon}))]}),ye.canFilter&&(0,t.jsx)(N,{column:ye,tableStyles:Ve,field:Ae})]});return _e&&we?.headerComponent?_e=(0,t.jsx)(we.headerComponent,{field:Ae,defaultContent:_e}):we?.headerComponent&&(We=(0,t.jsx)(we.headerComponent,{field:Ae,defaultContent:We})),(0,t.jsxs)("div",{className:Ve.headerCell,...Ue,role:"columnheader",children:[ye.canSort&&_e,!ye.canSort&&We,!ye.canSort&&ye.canFilter&&(0,t.jsx)(N,{column:ye,tableStyles:Ve,field:Ae}),ye.canResize&&(0,t.jsx)("div",{...ye.getResizerProps(),className:Ve.resizeHandle})]},Ce)}var ee=e(64423),Z=e(56978),q=e(69129),ae=e(79041);function k({tableStyles:ye,nestedData:Ve,rowIndex:Me,width:Ce,cellHeight:Ue}){const Ae=Ve.values,we=[],We=(0,d.$j)(),_e=(0,d.of)(se);let at=ye.rowHeight+We.spacing.gridSize;return Ae[Me].forEach((ut,Tt)=>{const It=!!ut.meta?.custom?.noHeader,ge=ye.rowHeight*(ut.length+(It?0:1)),Ie={height:ge,paddingLeft:F.jV,position:"absolute",top:at};at+=ge+We.spacing.gridSize,we.push((0,t.jsx)("div",{style:Ie,children:(0,t.jsx)(Se,{data:ut,width:Ce-F.jV,height:ye.rowHeight*(ut.length+1),noHeader:It,cellHeight:Ue})},`subTable_${Me}_${Tt}`))}),(0,t.jsx)("div",{className:_e.subTables,children:we})}const se=ye=>({subTables:(0,p.css)({"&:before":{content:'""',position:"absolute",width:"1px",top:ye.spacing(5),left:ye.spacing(1),bottom:ye.spacing(2),background:ye.colors.border.medium}})});function te(ye,Ve,Me){return ye.values[Ve].reduce((Ae,we)=>{if(we.length){const We=!!we.meta?.custom?.noHeader;return Ae+Me.rowHeight*(we.length+(We?0:1))+8}return Ae},Me.rowHeight)??Me.rowHeight}var ne=e(49618);const le=ye=>{const{data:Ve,rows:Me,headerHeight:Ce,footerPaginationEnabled:Ue,rowHeight:Ae,itemCount:we,pageIndex:We,tableState:_e,prepareRow:at,onCellFilterAdded:ut,width:Tt,cellHeight:It=l.qM.Sm,timeRange:ge,tableStyles:Ie,nestedDataField:ue,listHeight:me,listRef:Pe,enableSharedCrosshair:Ne=!1,initialRowIndex:Fe=void 0,headerGroups:Be,longestField:he}=ye,[be,Ke]=(0,n.useState)(Fe);Fe===void 0&&be!==void 0&&Ke(void 0);const ze=(0,d.$j)(),nt=(0,ae.d2)();let tt=null;window.OffscreenCanvas!==void 0&&(tt=new OffscreenCanvas(256,1024).getContext("2d")),tt!=null&&(tt.font=`${ze.typography.fontSize}px ${ze.typography.body.fontFamily}`);const ot=(0,n.useMemo)(()=>{const Je=Ve.fields.find(it=>it.type===r.PU.time);return Je?(0,F.HY)(Je):0},[Ve]),gt=(0,n.useCallback)((Je,it)=>{if(!nt||!Ne||!(0,g.S1)(it))return;const St=it.fields.find(zt=>zt.type===r.PU.time);nt.eventBus.publish(new q.b_({point:{time:St.values[Je]}}))},[Ne,nt]),He=(0,n.useCallback)(()=>{!nt||!Ne||nt.eventBus.publish(new q.ql)},[Ne,nt]),et=(0,n.useCallback)(Je=>{if(Je.payload.point?.time&&Je.payload.rowIndex!==void 0){const it=Ve.fields.find(Qt=>Qt.type===r.PU.time),St=it.values[Je.payload.rowIndex],zt=Je.payload.point.time;if((0,F.Iy)(zt,St,ot)){Ke(Je.payload.rowIndex);return}const Kt=it.values.findIndex(Qt=>(0,F.Iy)(zt,Qt,ot));if(Kt!==-1){Ke(Kt);return}Ke(void 0)}},[Ve.fields,ot]);(0,n.useEffect)(()=>{if(!nt||!Ne||!(0,g.S1)(Ve)||Ue)return;const Je=new ee.yU;return Je.add(nt.eventBus.getStream(q.b_).pipe((0,Z.B)(250)).subscribe({next:it=>{nt.eventBus!==it.origin&&et(it)}})),Je.add(nt.eventBus.getStream(q.ql).pipe((0,Z.B)(250)).subscribe({next:it=>{nt.eventBus!==it.origin&&Ke(void 0)}})),()=>{Je.unsubscribe()}},[Ve,Ne,Ue,et,nt]);let rt;if(be!==void 0){const Je=Me.findIndex(it=>it.index===be);Je!==-1&&(rt=Ce+(Je-1)*Ae)}const ht=(0,n.useCallback)(Je=>_e.pageIndex*_e.pageSize+Je,[_e.pageIndex,_e.pageSize]);let ft,De;for(const Je of Ve.fields){const it=Je.config.custom,St=it!==void 0&&it.cellOptions!==void 0;St&&it.cellOptions.type===l.ob.ColorBackground&&it.cellOptions.applyToRow&&(ft=zt=>{const Kt=Je.display(Je.values.get(zt));return(0,F.HW)(Ie,it.cellOptions,Kt)}),St&&(it.cellOptions.type===l.ob.Auto||it.cellOptions.type===l.ob.ColorBackground||it.cellOptions.type===l.ob.ColorText)&&it.cellOptions.wrapText?De=Je:he!==void 0&&(De=he)}const Te=(0,n.useCallback)(({index:Je,style:it,rowHighlightIndex:St})=>{const zt=ht(Je),Kt=Me[zt];let Qt={};at(Kt);const an=_e.expanded[Kt.id]?(0,p.css)({"&:hover":{background:"inherit"}}):{},Nn=ue&&_e.expanded[Kt.id];if(St!==void 0&&Kt.index===St&&(it={...it,backgroundColor:ze.components.table.rowSelected},Qt={"aria-selected":"true"}),ft){const{bgColor:ss,textColor:ds}=ft(Kt.index);it.background=ss,it.color=ds}if(De){const ds=Ve.fields.filter(gs=>!gs.config.custom?.hidden).findIndex(gs=>gs.name===De.name),Ms=ze.typography.body.lineHeight*ze.typography.fontSize,Bs=(0,F.M2)(De.values[Je],Be[0].headers[ds],tt,Ms,Ie.rowHeight);it.height=Bs.height}const{key:zn,...Yn}=Kt.getRowProps({style:it,...Qt});return(0,t.jsxs)("div",{...Yn,className:(0,p.cx)(Ie.row,an),onMouseEnter:()=>gt(Je,Ve),onMouseLeave:He,children:[Nn&&(0,t.jsx)(k,{nestedData:ue,tableStyles:Ie,rowIndex:Kt.index,width:Tt,cellHeight:It}),Kt.cells.map((ss,ds)=>(0,t.jsx)(ne.n,{tableStyles:Ie,cell:ss,onCellFilterAdded:ut,columnIndex:ds,columnCount:Kt.cells.length,timeRange:ge,frame:Ve,rowStyled:ft!==void 0,rowExpanded:Nn,textWrapped:De!==void 0,height:Number(it.height)},ds))]},zn)},[It,Ve,ue,ut,gt,He,at,ht,Me,_e.expanded,Ie,De,ze.components.table.rowSelected,ze.typography.fontSize,ze.typography.body.lineHeight,ge,Tt,ft,Be,tt]),Oe=Je=>{const it=ht(Je),St=Me[it];if(_e.expanded[St.id]&&ue)return te(ue,St.index,Ie);if(De){const Kt=Ve.fields.filter(an=>!an.config.custom?.hidden).findIndex(an=>an.name===De.name),Qt=ze.typography.fontSize*ze.typography.body.lineHeight;return(0,F.M2)(De.values[Je],Be[0].headers[Kt],tt,Qt,Ie.rowHeight).height}return Ie.rowHeight},Ye=Je=>{const{scrollTop:it}=Je.currentTarget;Pe.current!==null&&Pe.current.scrollTo(it)},Ge=Object.keys(_e.expanded).join("|");return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(c.A,{onScroll:Ye,hideHorizontalTrack:!0,scrollTop:rt,children:(0,t.jsx)(y._m,{height:me,itemCount:we,itemSize:Oe,width:"100%",ref:Pe,style:{overflow:void 0},children:({index:Je,style:it})=>Te({index:Je,style:it,rowHighlightIndex:be})},`${Ae}${We}${Ge}`)})})};function re(ye,Ve){(0,n.useEffect)(()=>{if(ye.current&&Ve.current){const Me=ye.current.querySelector(".track-vertical"),Ce=Ve.current.firstChild;Ce&&Me&&(Me.remove(),Ce instanceof HTMLElement&&(Ce.querySelector(":scope > .track-vertical")?.remove(),Ce.append(Me)))}})}function de(ye,Ve,Me,Ce){const Ue=JSON.stringify(Object.keys(ye.expanded));(0,n.useEffect)(()=>{let Ae=0;Ce||(Number.isFinite(ye.lastExpandedOrCollapsedIndex)&&(Ae=ye.lastExpandedOrCollapsedIndex),Ae=ye.pageIndex===0?Ae-1:Ae-ye.pageIndex-ye.pageIndex*ye.pageSize),Ve.current?.resetAfterIndex(Math.max(Ae,0))},[ye.lastExpandedOrCollapsedIndex,ye.pageSize,ye.pageIndex,Ve,Me,Ue,Ce])}var oe=e(28240);function J({onColumnResize:ye,onSortByChange:Ve,data:Me}){return(0,n.useCallback)((Ce,Ue)=>{switch(Ue.type){case"columnDoneResizing":if(ye){const we=Ce.columnResizing?.headerIdWidths?.[0]?.[0],We=parseInt(we,10),_e=Math.round(Ce.columnResizing.columnWidths?.[we]),at=Me.fields?.[We];if(!at)return Ce;const ut=(0,oe.Ct)(at,Me);ye(ut,_e)}case"toggleSortBy":if(Ve){const Ae=[];for(const we of Ce.sortBy){const We=Me.fields[parseInt(we.id,10)];We&&Ae.push({displayName:(0,oe.Ct)(We,Me),desc:we.desc})}Ve(Ae)}case"toggleRowExpanded":if(Ue.id)return{...Ce,lastExpandedOrCollapsedIndex:parseInt(Ue.id,10)}}return Ce},[Me,ye,Ve])}function ce(ye,Ve){const Me={};if(ye){Me.sortBy=[];for(const Ce of ye)for(const Ue of Ve)Ue.Header===Ce.displayName&&Me.sortBy.push({id:Ue.id,desc:Ce.desc})}return Me}var pe=e(69770);const xe=150,fe=36,Ee="No data",Se=(0,n.memo)(ye=>{const{ariaLabel:Ve,data:Me,height:Ce,onCellFilterAdded:Ue,width:Ae,columnMinWidth:we=xe,noHeader:We,resizable:_e=!0,initialSortBy:at,footerOptions:ut,showTypeIcons:Tt,footerValues:It,enablePagination:ge,cellHeight:Ie=l.qM.Sm,timeRange:ue,enableSharedCrosshair:me=!1,initialRowIndex:Pe=void 0,fieldConfig:Ne}=ye,Fe=(0,n.useRef)(null),Be=(0,n.useRef)(null),he=(0,n.useRef)(null),be=(0,d.$j)(),Ke=(0,pe.k)(be,Ie),ze=We?0:Ke.rowHeight,[nt,tt]=(0,n.useState)(It),ot=Ne?.defaults?.noValue??Ee,gt=(0,n.useMemo)(()=>{const Hn=fe;let Qn=0;if(!nt)return 0;for(const mt of nt)Array.isArray(mt)&&mt.length>Qn&&(Qn=mt.length);return Qn>1?Hn*Qn:Hn},[nt]),He=(0,n.useMemo)(()=>Me.fields.length?Array(Me.length).fill(0):[],[Me]),et=!!(ut?.countRows&&ut.reducer&&ut.reducer.length&&ut.reducer[0]===a.gy.count),rt=Me.fields.find(Hn=>Hn.type===r.PU.nestedFrames),ht=rt!==void 0,ft=(0,n.useMemo)(()=>(0,F.GH)(Me,Ae,we,ht,nt,et),[Me,Ae,we,nt,ht,et]),De=(0,n.useRef)(),Te=J({...ye,onSortByChange:Hn=>{De.current(!1),ye.onSortByChange&&ye.onSortByChange(Hn)}}),Oe=!!Me.meta?.uniqueRowIdFields?.length,Ye=(0,n.useMemo)(()=>{const Hn={columns:ft,data:He,disableResizing:!_e,stateReducer:Te,autoResetPage:!1,initialState:ce(at,ft),autoResetFilters:!1,sortTypes:{number:F.Ok,"alphanumeric-insensitive":F.IM}};return Oe&&(Hn.getRowId=(Qn,mt)=>(0,g.t9)(Me,mt),Hn.autoResetExpanded=!1),Hn},[at,ft,He,_e,Te,Oe,Me]),{getTableProps:Ge,headerGroups:Je,footerGroups:it,rows:St,prepareRow:zt,totalColumnsWidth:Kt,page:Qt,state:an,gotoPage:Nn,setPageSize:zn,pageOptions:Yn,toggleAllRowsExpanded:ss}=(0,s.useTable)(Ye,s.useFilters,s.useSortBy,s.useAbsoluteLayout,s.useResizeColumns,s.useExpanded,s.usePagination),ds=an;De.current=ss,(0,n.useEffect)(()=>{ut||tt(It)},[It,ut]),(0,n.useEffect)(()=>{if(!ut)return;if(!ut.show){tt(void 0);return}if(et){const Qn=[];Qn[0]=St.length.toString()??Me.length.toString(),tt(Qn);return}const Hn=(0,F.Ux)(Je[0].headers,(0,F.XX)(St),ut,be);tt(Hn)},[ut,be,an.filters,Me]);let Ms=Ce-(ze+gt);ge&&(Ms-=Ke.cellHeight);const Bs=Math.round(Ms/Ke.rowHeight)-1;(0,n.useEffect)(()=>{Bs<=0||zn(Bs)},[Bs,zn]),(0,n.useEffect)(()=>{Me.length/Bs<an.pageIndex&&Nn(0)},[Me]),de(ds,Fe,Me,Oe),re(he,Be);const gs=(0,n.useCallback)(Hn=>{Nn(Hn-1)},[Nn]),Zn=ge?Qt.length:St.length;let Ls=null;if(ge){const Hn=an.pageIndex*an.pageSize+1;let Qn=Hn+an.pageSize-1;const mt=Ae<550;Qn>Me.length&&(Qn=Me.length),Ls=(0,t.jsxs)("div",{className:Ke.paginationWrapper,children:[(0,t.jsx)(h.d,{currentPage:an.pageIndex+1,numberOfPages:Yn.length,showSmallVersion:mt,onNavigate:gs}),mt?null:(0,t.jsxs)("div",{className:Ke.paginationSummary,children:[Hn," - ",Qn<St.length?Qn:St.length," of ",St.length," rows"]})]})}const Ln=(0,F.O4)(Ne,Me);return(0,t.jsxs)("div",{...Ge(),className:Ke.table,"aria-label":Ve,role:"table",ref:Be,style:{width:Ae,height:Ce},children:[(0,t.jsx)(c.E,{hideVerticalTrack:!0,children:(0,t.jsxs)("div",{className:Ke.tableContentWrapper(Kt),children:[!We&&(0,t.jsx)(Q,{headerGroups:Je,showTypeIcons:Tt,tableStyles:Ke}),Zn>0?(0,t.jsx)("div",{"data-testid":i.Tp.components.Panels.Visualization.Table.body,ref:he,children:(0,t.jsx)(le,{headerGroups:Je,data:Me,rows:St,width:Ae,cellHeight:Ie,headerHeight:ze,rowHeight:Ke.rowHeight,itemCount:Zn,pageIndex:an.pageIndex,listHeight:Ms,listRef:Fe,tableState:an,prepareRow:zt,timeRange:ue,onCellFilterAdded:Ue,nestedDataField:rt,tableStyles:Ke,footerPaginationEnabled:!!ge,enableSharedCrosshair:me,initialRowIndex:Pe,longestField:Ln})}):(0,t.jsx)("div",{style:{height:Ce-ze,width:Ae},className:Ke.noData,children:ot}),nt&&(0,t.jsx)(o.u,{isPaginationVisible:!!ge,footerValues:nt,footerGroups:it,totalColumnsWidth:Kt,tableStyles:Ke})]})}),Ls]})});Se.displayName="Table"},49618:(G,R,e)=>{"use strict";e.d(R,{n:()=>n});var t=e(74848);const n=({cell:s,tableStyles:a,onCellFilterAdded:r,timeRange:g,userProps:i,frame:l,rowStyled:d,rowExpanded:c,textWrapped:h,height:o})=>{const m=s.getCellProps(),u=s.column.field;if(!u?.display)return null;if(m.style){m.style.wordBreak="break-word",m.style.minWidth=m.style.width;const f=s.column.justifyContent;f==="flex-end"&&!u.config.unit?(m.style.textAlign="right",m.style.direction="rtl",m.style.unicodeBidi="plaintext"):m.style.justifyContent=f}let p=(typeof s.column.width=="number"?s.column.width:24)-a.cellPadding*2;return(0,t.jsx)(t.Fragment,{children:s.render("Cell",{field:u,tableStyles:a,onCellFilterAdded:r,cellProps:m,innerWidth:p,timeRange:g,userProps:i,frame:l,rowStyled:d,rowExpanded:c,textWrapped:h,height:o})})}},69770:(G,R,e)=>{"use strict";e.d(R,{k:()=>n});var t=e(32196);function n(a,r){const g=a.colors.border.weak,i=a.colors.primary.border,l=6,d=s(a,r,l),c=d+2,h=28,o=(m,u,p,f,y,x,v,P,E)=>(0,t.css)({label:f?"cellContainerOverflow":"cellContainerNoOverflow",padding:`${l}px`,width:"100%",height:E?"auto !important":`${c-1}px`,wordBreak:v?"break-all":"inherit",display:"flex",...y?{overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap"}:{},alignItems:"center",borderRight:`1px solid ${g}`,color:P?"inherit":m??void 0,background:P?void 0:u??void 0,backgroundClip:"padding-box","&:last-child:not(:only-child)":{borderRight:"none"},"&:hover":{overflow:f&&!v?"visible":void 0,width:x||!f?"auto":"auto !important",height:(x||f)&&!v?"auto !important":`${c-1}px`,minHeight:`${c-1}px`,wordBreak:x?"break-word":void 0,whiteSpace:x&&f?"normal":"nowrap",boxShadow:f?`0 0 2px ${a.colors.primary.main}`:void 0,background:P?"inherit":p??a.colors.background.primary,zIndex:1,".cellActions":{color:"#FFF",visibility:"visible",opacity:1,width:"auto",background:"rgba(0, 0, 0, 0.6)"}},a:{color:"inherit"},".cellActions":{display:"flex",position:f?void 0:"absolute",top:f?void 0:"1px",right:f?void 0:0,margin:f?a.spacing(0,-.5,0,.5):"auto",visibility:"hidden",opacity:0,width:0,alignItems:"center",height:"100%",padding:a.spacing(1,.5,1,1),background:u?"none":"rgba(0, 0, 0, 0.5)",svg:{color:m}},".cellActionsLeft":{right:"auto !important",left:0},".cellActionsTransparent":{background:"none"}});return{theme:a,cellHeight:d,buildCellContainerStyle:o,cellPadding:l,cellHeightInner:d-l*2,rowHeight:c,table:(0,t.css)({height:"100%",width:"100%",overflow:"auto",display:"flex",flexDirection:"column"}),thead:(0,t.css)({label:"thead",height:`${h}px`,overflowY:"auto",overflowX:"hidden",position:"relative"}),tfoot:(0,t.css)({label:"tfoot",height:`${h}px`,borderTop:`1px solid ${g}`,overflowY:"auto",overflowX:"hidden",position:"relative"}),headerRow:(0,t.css)({label:"row",borderBottom:`1px solid ${g}`}),headerCell:(0,t.css)({height:"100%",padding:`0 ${l}px`,overflow:"hidden",whiteSpace:"nowrap",display:"flex",alignItems:"center",fontWeight:a.typography.fontWeightMedium,"&:last-child":{borderRight:"none"}}),headerCellLabel:(0,t.css)({border:"none",padding:0,background:"inherit",cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontWeight:a.typography.fontWeightMedium,display:"flex",alignItems:"center",marginRight:a.spacing(.5),"&:hover":{textDecoration:"underline",color:a.colors.text.link}}),cellContainerText:o(void 0,void 0,void 0,!0,!0),cellContainerTextNoOverflow:o(void 0,void 0,void 0,!1,!0),cellContainer:o(void 0,void 0,void 0,!0,!1),cellContainerNoOverflow:o(void 0,void 0,void 0,!1,!1),cellText:(0,t.css)({overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap"}),sortIcon:(0,t.css)({marginLeft:a.spacing(.5)}),cellLink:(0,t.css)({cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap",color:a.colors.text.link,fontWeight:a.typography.fontWeightMedium,paddingRight:a.spacing(1.5),"&:hover":{textDecoration:"underline",color:a.colors.text.link}}),cellLinkForColoredCell:(0,t.css)({cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap",fontWeight:a.typography.fontWeightMedium,textDecoration:"underline"}),imageCellLink:(0,t.css)({cursor:"pointer",overflow:"hidden",height:"100%"}),headerFilter:(0,t.css)({background:"transparent",border:"none",label:"headerFilter",padding:0}),paginationWrapper:(0,t.css)({display:"flex",height:`${d}px`,justifyContent:"center",alignItems:"center",width:"100%",li:{marginBottom:0}}),paginationSummary:(0,t.css)({color:a.colors.text.secondary,fontSize:a.typography.bodySmall.fontSize,display:"flex",justifyContent:"flex-end",padding:a.spacing(0,1,0,2)}),tableContentWrapper:m=>{const u=m!==void 0?`${m}px`:"100%";return(0,t.css)({label:"tableContentWrapper",width:u,display:"flex",flexDirection:"column"})},row:(0,t.css)({label:"row",borderBottom:`1px solid ${g}`,"&:hover":{backgroundColor:a.components.table.rowHoverBackground},"&:last-child":{borderBottom:0}}),imageCell:(0,t.css)({height:"100%"}),resizeHandle:(0,t.css)({label:"resizeHandle",cursor:"col-resize !important",display:"inline-block",background:i,opacity:0,[a.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 0.2s ease-in-out"},width:"8px",height:"100%",position:"absolute",right:"-4px",borderRadius:a.shape.radius.default,top:0,touchAction:"none","&:hover":{opacity:1}}),typeIcon:(0,t.css)({marginRight:a.spacing(1),color:a.colors.text.secondary}),noData:(0,t.css)({alignItems:"center",display:"flex",height:"100%",justifyContent:"center",width:"100%"}),expanderCell:(0,t.css)({display:"flex",flexDirection:"column",justifyContent:"center",height:`${c}px`,cursor:"pointer"})}}function s(a,r,g){const i=a.typography.fontSize,l=a.typography.body.lineHeight;switch(r){case"md":return 42;case"lg":return 48;case"sm":default:return g*2+i*l}}},88407:(G,R,e)=>{"use strict";e.d(R,{Zi:()=>n,mc:()=>t});const t="=",n="!="},57021:(G,R,e)=>{"use strict";e.d(R,{jV:()=>le,HY:()=>Tt,MY:()=>ce,XX:()=>Ue,zi:()=>at,HW:()=>It,bk:()=>we,GH:()=>de,Sj:()=>Ee,Ux:()=>Me,j1:()=>re,O4:()=>Ie,M2:()=>ge,Iy:()=>ut,o7:()=>We,IM:()=>Se,Ok:()=>ye,Yz:()=>xe});var t=e(2543),n=e(47078),s=e.n(n),a=e(84140),r=e(11261),g=e(28240),i=e(14236),l=e(19845),d=e(83195),c=e(75059),h=e(57875),o=e(52622),m=e(24284),u=e(74848),p=e(50082),f=e(58563),y=e(47070),x=e(97696),v=e(59796);const P={mode:p.O.Absolute,steps:[{color:"blue",value:-1/0},{color:"green",value:20}]},E=ue=>{const{field:me,innerWidth:Pe,tableStyles:Ne,cell:Fe,cellProps:Be,row:he}=ue,be=me.display(Fe.value),Ke=we(me);let ze=(0,f.xg)(me,!1);ze.thresholds||(ze={...ze,thresholds:P});let nt=o.eX.Gradient,tt;Ke.type===o.ob.Gauge&&(nt=Ke.mode??o.eX.Gradient,tt=Ke.valueDisplayMode!==void 0?Ke.valueDisplayMode:o.$l.Text);const ot=()=>(0,t.isFunction)(me.getLinks)?me.getLinks({valueRowIndex:he.index}):[],gt=!!ot().length,He=at(me,be,Fe.row.index),et=rt=>{const{openMenu:ht,targetClassName:ft}=rt;return(0,u.jsx)(x.xE,{width:Pe,height:Ne.cellHeightInner,field:ze,display:me.display,text:{valueSize:14},value:be,orientation:y.wV.Horizontal,theme:Ne.theme,alignmentFactors:He,onClick:ht,className:ft,itemSpacing:1,lcdCellWidth:8,displayMode:nt,valueDisplayMode:tt})};return(0,u.jsxs)("div",{...Be,className:Ne.cellContainer,children:[gt&&(0,u.jsx)(v.e,{links:ot,style:{display:"flex",width:"100%"},children:rt=>et(rt)}),!gt&&et({})]})};var D=e(90914);const C=ue=>{const{field:me,row:Pe,cellProps:Ne,tableStyles:Fe}=ue,Be=(0,D.k)(me,Pe);return(0,u.jsx)("div",{...Ne,className:Fe.cellContainerText,children:Be&&Be.map((he,be)=>(0,u.jsx)("span",{className:Fe.cellLink,onClick:he.onClick,children:(0,u.jsx)("a",{href:he.href,target:he.target,children:he.title})},be))})};var b=e(32196),T=e(96540),S=e(40845),O=e(55852),M=e(29158),I=e(67061),L=e(76412),B=e(10534),j=e(87978),A=e(32372),K=e(63021),W=e(40675),U=(ue=>(ue.code="code",ue.text="text",ue))(U||{});function F({value:ue,onDismiss:me,mode:Pe}){let Ne=ue;const[Fe,Be]=(0,T.useState)(Pe);if((0,t.isString)(ue)){const nt=ue.trim();if(nt[0]==="{"||nt[0]==="["||Pe==="code")try{ue=JSON.parse(ue),Ne=JSON.stringify(ue,null,"  ")}catch(tt){console.log("Failed to parse JSON in Table cell inspector (this will cause JSON to not print nicely): ",tt.message)}}else Ne=JSON.stringify(ue);let he=Ne;const be=[{label:"Plain text",value:"text"},{label:"Code editor",value:"code"}],Ke=()=>{Be(Fe==="text"?"code":"text")},ze=(0,u.jsx)(K.U,{children:be.map((nt,tt)=>(0,u.jsx)(W.o,{label:nt.label,active:nt.value===Fe,onChangeTab:Ke},`${nt.value}-${tt}`))});return(0,u.jsx)(j._,{onClose:me,title:"Inspect value",tabs:ze,children:(0,u.jsxs)(I.B,{direction:"column",gap:2,children:[(0,u.jsx)(B.b,{icon:"copy",getText:()=>he,style:{marginLeft:"auto",width:"200px"},children:(0,u.jsx)(L.x,{i18nKey:"grafana-ui.table.copy",children:"Copy to Clipboard"})}),Fe==="code"?(0,u.jsx)(A.B,{width:"100%",height:500,language:"json",showLineNumbers:!0,showMiniMap:(he&&he.length)>100,value:he,readOnly:!0,wordWrap:!0}):(0,u.jsx)("pre",{children:he})]})})}var V=e(88407);function w({field:ue,cell:me,previewMode:Pe,showFilters:Ne,onCellFilterAdded:Fe}){const[Be,he]=(0,T.useState)(!1),be=re(ue)==="flex-end",Ke=!!ue.config.custom?.inspect,ze={size:"sm",tooltipPlacement:"top"},nt=(0,T.useCallback)(ot=>{Fe&&Fe({key:ue.name,operator:V.mc,value:me.value})},[me,ue,Fe]),tt=(0,T.useCallback)(ot=>{Fe&&Fe({key:ue.name,operator:V.Zi,value:me.value})},[me,ue,Fe]);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:`cellActions${be?" cellActionsLeft":""}`,children:(0,u.jsxs)(I.B,{gap:.5,children:[Ke&&(0,u.jsx)(M.K,{name:"eye",tooltip:"Inspect value",onClick:()=>{he(!0)},...ze}),Ne&&(0,u.jsx)(M.K,{name:"search-plus",onClick:nt,tooltip:"Filter for value",...ze}),Ne&&(0,u.jsx)(M.K,{name:"search-minus",onClick:tt,tooltip:"Filter out value",...ze})]})}),Be&&(0,u.jsx)(F,{mode:Pe,value:me.value,onDismiss:()=>{he(!1)}})]})}const z=ue=>{const{field:me,cell:Pe,tableStyles:Ne,row:Fe,cellProps:Be,frame:he,rowStyled:be,rowExpanded:Ke,textWrapped:ze,height:nt}=ue,tt=!!me.config.custom?.inspect,ot=me.display(Pe.value),gt=ue.onCellFilterAdded&&me.config.filterable,He=gt&&Pe.value!==void 0||tt,et=we(me),rt=!!(0,D.k)(me,Fe)?.length,ht=(0,S.of)(O.Ez),[ft,De]=(0,T.useState)(!1);let Te;const Oe=140,Ye=()=>{De(!1)},Ge=()=>{De(!0)};if(et.type===o.ob.Custom){const Qt=et.cellComponent;Te=(0,u.jsx)(Qt,{field:me,value:Pe.value,rowIndex:Fe.index,frame:he})}else T.isValidElement(Pe.value)?Te=Pe.value:Te=(0,d.cN)(ot);const Je=typeof Te=="string",it=ot.text.length<=Oe&&/\s/.test(ot.text),St=N(Ne,et,ot,tt,Je,it,ze,be,Ke);if(Je){let Qt=Be.style?.justifyContent;Qt==="flex-end"?Be.style={...Be.style,textAlign:"right"}:Qt==="center"&&(Be.style={...Be.style,textAlign:"center"})}nt&&(Be.style={...Be.style,height:nt}),ze&&(Be.style={...Be.style,textWrap:"wrap"});const{key:zt,...Kt}=Be;return(0,u.jsxs)("div",{...Kt,onMouseEnter:He?Ge:void 0,onMouseLeave:He?Ye:void 0,className:St,children:[!rt&&(Je?`${Te}`:(0,u.jsx)("div",{className:Ne.cellText,children:Te})),rt&&(0,u.jsx)(v.e,{links:()=>(0,D.k)(me,Fe)||[],children:Qt=>Qt.openMenu?(0,u.jsx)("button",{className:(0,b.cx)(ht,H(Ne,et,Qt.targetClassName)),onClick:Qt.openMenu,children:Te}):(0,u.jsx)("div",{className:H(Ne,et,Qt.targetClassName),children:Te})}),ft&&He&&(0,u.jsx)(w,{...ue,previewMode:U.text,showFilters:gt})]},zt)};function N(ue,me,Pe,Ne=!1,Fe=!1,Be=!1,he=!1,be=!1,Ke=!1){let ze,nt,tt;const ot=It(ue,me,Pe);return ze=ot.textColor,nt=ot.bgColor,tt=ot.bgHoverColor,ue.buildCellContainerStyle(ze,nt,tt,!Ne,Fe,Be,he,be,Ke)}function H(ue,me,Pe){return me.type===o.ob.Auto?(0,b.cx)(ue.cellLink,Pe):(0,b.cx)(ue.cellLinkForColoredCell,Pe)}var Q=e(92015),X=e(64136),ee=e(27430);function Z(ue){const{cell:me,tableStyles:Pe,cellProps:Ne}=ue;let Fe="";return me.value instanceof ee.A?Fe=new X.A().writeGeometry(me.value,{featureProjection:"EPSG:3857",dataProjection:"EPSG:4326"}):me.value!=null&&(Fe=`${me.value}`),(0,u.jsx)("div",{...Ne,className:Pe.cellContainer,children:(0,u.jsx)("div",{className:Pe.cellText,style:{fontFamily:"monospace"},children:Fe})})}const q=10,ae=ue=>{const{field:me,cell:Pe,tableStyles:Ne,row:Fe,cellProps:Be}=ue,he=we(me),{title:be,alt:Ke}=he.type===o.ob.Image?he:{title:void 0,alt:void 0},ze=me.display(Pe.value),nt=!!(0,D.k)(me,Fe)?.length,tt=(0,u.jsx)("img",{style:{height:Ne.cellHeight-q,width:"auto"},src:ze.text,className:Ne.imageCell,alt:Ke,title:be});return(0,u.jsxs)("div",{...Be,className:Ne.cellContainer,children:[!nt&&tt,nt&&(0,u.jsx)(v.e,{style:{height:Ne.cellHeight-q,width:"auto"},links:()=>(0,D.k)(me,Fe)||[],children:ot=>ot.openMenu?(0,u.jsx)("div",{onClick:ot.openMenu,role:"button",tabIndex:0,onKeyDown:gt=>{gt.key==="Enter"&&ot.openMenu&&ot.openMenu(gt)},children:tt}):tt})]})};function k(ue){const{cell:me,tableStyles:Pe,cellProps:Ne,field:Fe,row:Be}=ue,he=!!Fe.config.custom?.inspect,be=(0,b.css)({cursor:"pointer",fontFamily:"monospace"});let Ke=me.value,ze=Ke;if((0,t.isString)(Ke))try{Ke=JSON.parse(Ke)}catch{}else ze=JSON.stringify(Ke,null," ");const nt=!!(0,D.k)(Fe,Be)?.length,tt=(0,S.of)(O.Ez);return(0,u.jsxs)("div",{...Ne,className:he?Pe.cellContainerNoOverflow:Pe.cellContainer,children:[(0,u.jsxs)("div",{className:(0,b.cx)(Pe.cellText,be),children:[!nt&&(0,u.jsx)("div",{className:Pe.cellText,children:ze}),nt&&(0,u.jsx)(v.e,{links:()=>(0,D.k)(Fe,Be)||[],children:ot=>ot.openMenu?(0,u.jsx)(O.$n,{className:(0,b.cx)(tt),onClick:ot.openMenu,children:ze}):(0,u.jsx)(u.Fragment,{children:ze})})]}),he&&(0,u.jsx)(w,{...ue,previewMode:U.code})]})}var se=e(14578);function te({row:ue,tableStyles:me}){return(0,u.jsx)("div",{className:me.expanderCell,...ue.getToggleRowExpandedProps(),children:(0,u.jsx)(se.I,{"aria-label":ue.isExpanded?"Collapse row":"Expand row",name:ue.isExpanded?"angle-down":"angle-right",size:"lg"})})}var ne=e(30355);const le=50;function re(ue){if(!ue)return"flex-start";if(ue.config.custom)switch(ue.config.custom.align){case"right":return"flex-end";case"left":return"flex-start";case"center":return"center"}return ue.type===r.PU.number?"flex-end":"flex-start"}function de(ue,me,Pe,Ne,Fe,Be){const he=[];let be=0;Ne&&(he.push({Header:()=>null,id:"expander",Cell:te,width:le,minWidth:le,filter:(ze,nt,tt)=>[],justifyContent:"left",field:ue.fields[0],sortType:"basic"}),me-=le);for(const[ze,nt]of ue.fields.entries()){const tt=nt.config.custom||{};if(tt.hidden||nt.type===r.PU.nestedFrames)continue;tt.width?me-=tt.width:be++;const ot=He=>{switch(He){case r.PU.number:case r.PU.frame:return"number";case r.PU.time:return"basic";default:return"alphanumeric-insensitive"}},gt=oe(tt.cellOptions?.type,nt);he.push({Cell:gt,id:ze.toString(),field:nt,Header:tt.hideHeader?"":(0,g.Ct)(nt,ue),accessor:(He,et)=>nt.values[et],sortType:ot(nt.type),width:tt.width,minWidth:tt.minWidth??Pe,filter:s()(J(nt)),justifyContent:re(nt),Footer:(0,Q.d)(ze,Fe,Be)})}let Ke=me/be;for(let ze=be;ze>0;ze--)for(const nt of he)!nt.width&&nt.minWidth>Ke&&(nt.width=nt.minWidth,me-=nt.width,be-=1,Ke=me/be);for(const ze of he)ze.width||(ze.width=Ke),ze.minWidth=50;return he}function oe(ue,me){switch(ue){case o.ob.Custom:case o.ob.ColorText:case o.ob.ColorBackground:return z;case o.ob.Image:return ae;case o.ob.Gauge:return E;case o.ob.Sparkline:return ne.a;case o.ob.JSONView:return k;case o.ob.DataLinks:return C}if(me.type===r.PU.geo)return Z;if(me.type===r.PU.frame){const Pe=me.values[0];return(0,i.ci)(Pe)&&(0,l.aH)(Pe)?ne.a:k}return me.type===r.PU.other?k:z}function J(ue){return function(me,Pe,Ne){return me.length===0||!Ne||!ue?me:me.filter(Fe=>{if(!Fe.values.hasOwnProperty(Pe))return!1;const Be=pe(Fe,ue);return Ne.find(he=>he.value===Be)!==void 0})}}function ce(ue,me){if(!me||ue.length===0)return{};const Pe={};for(let Ne=0;Ne<ue.length;Ne++){const Fe=pe(ue[Ne],me);Pe[Fe||"(Blanks)"]=Fe}return Pe}function pe(ue,me){if(!me||!ue)return"";const Pe=me.values[ue.index],Ne=me.display?me.display(Pe):Pe;return me.display?(0,d.cN)(Ne):Ne}function xe(ue){return Object.keys(ue).reduce((me,Pe)=>me.concat({value:ue[Pe],label:Pe}),[]).sort(fe)}function fe(ue,me){return ue.label===void 0&&me.label===void 0?0:ue.label===void 0&&me.label!==void 0?-1:ue.label!==void 0&&me.label===void 0?1:ue.label<me.label?-1:ue.label>me.label?1:0}function Ee(ue,me){return me?ue.filter(Pe=>me.some(Ne=>Ne.value===Pe.value)):[]}function Se(ue,me,Pe){return String(ue.values[Pe]).localeCompare(String(me.values[Pe]),void 0,{sensitivity:"base"})}function ye(ue,me,Pe){const Ne=Ve(ue.values[Pe]),Fe=Ve(me.values[Pe]);return Ne===Fe?0:Ne>Fe?1:-1}function Ve(ue){return(0,i.LI)(ue)?ue.value??Number.NEGATIVE_INFINITY:ue==null||ue===""||isNaN(ue)?Number.NEGATIVE_INFINITY:typeof ue=="number"?ue:Number(ue)}function Me(ue,me,Pe,Ne){return _e(ue),ue.map((Fe,Be)=>{if(Fe?.field?.type!==r.PU.number)return Be===0&&Pe.reducer&&Pe.reducer.length>0?c.AS.get(Pe.reducer[0]).name:void 0;let he=(0,t.clone)(Fe.field);return he.values=me[Fe.id],he.state=void 0,Fe.field=he,Pe.fields&&Pe.fields.length>0?Pe.fields.find(Ke=>Ke===Fe?.field?.name)?Ce(Fe.field,Pe.reducer,Ne):void 0:Ce(Fe.field,Pe.reducer||[],Ne)})}function Ce(ue,me,Pe){const Ne=me[0];if(Ne===void 0)return"";const Fe=ue.display??(0,h.J)({field:ue,theme:Pe}),Be=(0,c.Nw)({field:ue,reducers:me})[Ne];return c.AS.get(Ne).preservesUnits?(0,d.cN)(Fe(Be)):(0,d.cN)({text:Be})}function Ue(ue){const me=[];for(const Pe in ue)for(const[Ne,Fe]of Object.entries(ue[Pe].values))me[Ne]===void 0&&(me[Ne]=[]),me[Ne].push(Fe);return me}const Ae={type:o.ob.Auto};function we(ue){return ue.config.custom?.displayMode?We(ue.config.custom?.displayMode):ue.config.custom?.cellOptions?ue.config.custom.cellOptions:Ae}function We(ue){switch(ue){case"basic":case"gradient-gauge":case"lcd-gauge":let me=o.eX.Basic;return ue==="gradient-gauge"?me=o.eX.Gradient:ue==="lcd-gauge"&&(me=o.eX.Lcd),{type:o.ob.Gauge,mode:me};case"color-background":case"color-background-solid":let Pe=o.Wq.Basic;return ue==="color-background"&&(Pe=o.Wq.Gradient),{type:o.ob.ColorBackground,mode:Pe};default:return{type:ue}}}function _e(ue){const me=ue.findIndex((Pe,Ne)=>Pe?.id!==String(Ne));me===-1||ue[me]?.id==="expander"||(ue.splice(me,0,{id:String(me)}),_e(ue))}function at(ue,me,Pe){let Ne=ue.state?.alignmentFactors;if(Ne)return(0,d.cN)(Ne).length<(0,d.cN)(me).length&&(Ne={...me},ue.state.alignmentFactors=Ne),Ne;{Ne={...me};const Fe=Math.min(ue.values.length,Pe+1e3);for(let Be=Pe+1;Be<Fe;Be++){const he=ue.display(ue.values[Be]);(0,d.cN)(Ne).length>(0,d.cN)(he).length&&(Ne.text=me.text)}return ue.state?ue.state.alignmentFactors=Ne:ue.state={alignmentFactors:Ne},Ne}}function ut(ue,me,Pe){return Math.abs(Math.floor(ue)-me)<Pe}function Tt(ue){let me=-Number.MAX_VALUE,Pe=Number.MAX_VALUE;if(ue.values.length<2)return 0;for(let Ne=0;Ne<ue.values.length;Ne++){const Fe=ue.values[Ne];Fe>me&&(me=Fe),Fe<Pe&&(Pe=Fe)}return(me-Pe)/ue.values.length}function It(ue,me,Pe){const Ne=ue.theme.isDark?1:-.7;let Fe,Be,he;if(me.type===o.ob.ColorText)Fe=Pe.color;else if(me.type===o.ob.ColorBackground){const be=me.mode??o.Wq.Gradient;if(be===o.Wq.Basic)Fe=(0,m.mZ)(Pe.color,ue.theme.isDark),Be=(0,a.A)(Pe.color).toRgbString(),he=(0,a.A)(Pe.color).setAlpha(1).toRgbString();else if(be===o.Wq.Gradient){const Ke=(0,a.A)(Pe.color).setAlpha(1).toRgbString(),ze=(0,a.A)(Pe.color).darken(10*Ne).spin(5);Fe=(0,m.mZ)(Pe.color,ue.theme.isDark),Be=`linear-gradient(120deg, ${ze.toRgbString()}, ${Pe.color})`,he=`linear-gradient(120deg, ${ze.setAlpha(1).toRgbString()}, ${Ke})`}}return{textColor:Fe,bgColor:Be,bgHoverColor:he}}function ge(ue,me,Pe,Ne,Fe){const Be=Number(me?.width??300),he=1.17,be=42;if(Pe!==null&&typeof ue=="string"){const Ke=ue.split(/\s/),ze=[];let nt="",tt=0,ot=0;for(let et=0;et<Ke.length;et++){const rt=Ke[et];let ht=Pe.measureText(nt+" "+rt).width;ht<Be?(nt+=" "+rt,tt++):(ze.push({width:ht,line:nt}),nt=rt,tt=0)}for(let et=0;et<ze.length;et++)if(ze[et].width>Be){let rt=Math.floor(ze[et].width/Be)-1;ot+=rt}let gt=ze.length+ot,He=38;return gt>5?He=gt*Ne*he:He=gt*Ne+be,{width:Be,height:He}}return{width:Be,height:Fe}}function Ie(ue,me){let Pe;if(ue!==void 0&&ue.defaults.custom!==void 0&&ue.defaults.custom.cellOptions.wrapText){const Fe=me.fields.filter(Be=>Be.type===r.PU.string);if(Fe.length>=1&&Fe[0].values.length>0){const Be=Fe[0].values.length;let he=0;if(Be<=30)for(const be of Fe){const Ke=be.values[0].length;Ke>he&&(he=Ke,Pe=be)}else for(const be of Fe){const Ke=(0,t.sampleSize)(be.values,3),ze=(Ke[0]?.length+Ke[1]?.length+Ke[2]?.length)/3;ze>he&&(he=ze,Pe=be)}}}return Pe}},53402:(G,R,e)=>{"use strict";e.d(R,{p:()=>r});var t=e(74848),n=e(32196),s=e(83195),a=e(40845);const r=({value:i})=>{const l=(0,a.of)(g);return(0,t.jsx)("span",{className:l.counter,children:(0,s.Hg)(i,0).text})},g=i=>({counter:(0,n.css)({label:"counter",marginLeft:i.spacing(1),borderRadius:i.spacing(3),backgroundColor:i.colors.action.hover,padding:i.spacing(.25,1),color:i.colors.text.secondary,fontWeight:i.typography.fontWeightMedium,fontSize:i.typography.size.sm})})},40675:(G,R,e)=>{"use strict";e.d(R,{o:()=>c});var t=e(74848),n=e(32196),s=e(96540),a=e(13544),r=e(40845),g=e(16797),i=e(55852),l=e(14578),d=e(53402);const c=s.forwardRef(({label:o,active:m,icon:u,onChangeTab:p,counter:f,suffix:y,className:x,href:v,...P},E)=>{const D=(0,r.of)(h),C=(0,r.of)(i.my),b=()=>(0,t.jsxs)(t.Fragment,{children:[u&&(0,t.jsx)(l.I,{name:u}),o,typeof f=="number"&&(0,t.jsx)(d.p,{value:f}),y&&(0,t.jsx)(y,{className:D.suffix})]}),S={className:(0,n.cx)(C,D.link,m?D.activeStyle:D.notActive),"data-testid":a.Tp.components.Tab.title(o),...P,onClick:p,role:"tab","aria-selected":m};return v?(0,t.jsx)("div",{className:D.item,children:(0,t.jsx)("a",{...S,href:v,ref:E,children:b()})}):(0,t.jsx)("div",{className:D.item,children:(0,t.jsx)("button",{...S,type:"button",ref:E,children:b()})})});c.displayName="Tab";const h=o=>({item:(0,n.css)({listStyle:"none",position:"relative",display:"flex",whiteSpace:"nowrap",padding:o.spacing(.5)}),link:(0,n.css)({color:o.colors.text.secondary,padding:o.spacing(1,1.5,.5),borderRadius:o.shape.radius.default,display:"block",height:"100%",svg:{marginRight:o.spacing(1)},"&:focus-visible":(0,g.getFocusStyles)(o),"&::before":{display:"block",content:'" "',position:"absolute",left:0,right:0,height:"4px",borderRadius:o.shape.radius.default,bottom:0}}),notActive:(0,n.css)({"a:hover, &:hover, &:focus":{color:o.colors.text.primary,"&::before":{backgroundColor:o.colors.action.hover}}}),activeStyle:(0,n.css)({label:"activeTabStyle",color:o.colors.text.primary,overflow:"hidden","&::before":{backgroundImage:o.colors.gradients.brandHorizontal}}),suffix:(0,n.css)({marginLeft:o.spacing(1)})})},40980:(G,R,e)=>{"use strict";e.d(R,{J:()=>a});var t=e(74848),n=e(32196),s=e(40845);const a=({children:g,className:i,...l})=>{const d=(0,s.of)(r);return(0,t.jsx)("div",{...l,className:(0,n.cx)(d.tabContent,i),children:g})},r=g=>({tabContent:(0,n.css)({background:g.colors.background.primary})})},63021:(G,R,e)=>{"use strict";e.d(R,{U:()=>r});var t=e(74848),n=e(32196),s=e(96540),a=e(40845);const r=(0,s.forwardRef)(({children:i,className:l,hideBorder:d=!1},c)=>{const h=(0,a.of)(g);return(0,t.jsx)("div",{className:(0,n.cx)(h.tabsWrapper,d&&h.noBorder,l),ref:c,children:(0,t.jsx)("div",{className:h.tabs,role:"tablist",children:i})})}),g=i=>({tabsWrapper:(0,n.css)({borderBottom:`1px solid ${i.colors.border.weak}`,overflowX:"auto"}),noBorder:(0,n.css)({borderBottom:0}),tabs:(0,n.css)({position:"relative",display:"flex",height:`${i.components.menuTabs.height}px`,alignItems:"center"})});r.displayName="TabsBar"},78369:(G,R,e)=>{"use strict";e.d(R,{v:()=>h});var t=e(74848),n=e(32196),s=e(96540),a=e(70255),r=e(40845),g=e(69613),i=e(72129),l=e(14578);const d=(0,s.forwardRef)(({name:u,onClick:p,icon:f,className:y,colorIndex:x,...v},P)=>{const E=(0,r.$j)(),D=m(E,u,x),C=T=>{T.preventDefault(),T.stopPropagation(),p?.(u,T)},b=(0,n.cx)(D.wrapper,y,{[D.hover]:p!==void 0});return p?(0,t.jsxs)("button",{...v,className:b,onClick:C,ref:P,children:[f&&(0,t.jsx)(l.I,{name:f}),u]}):(0,t.jsxs)("span",{...v,className:b,ref:P,children:[f&&(0,t.jsx)(l.I,{name:f}),u]})});d.displayName="Tag";const c=({rootProps:u})=>{const p=(0,r.of)(o);return(0,t.jsx)(a.A,{width:60,height:22,containerClassName:p.container,...u})},h=(0,i.j)(d,c),o=()=>({container:(0,n.css)({lineHeight:1})}),m=(u,p,f)=>{let y;return f===void 0?y=(0,g.MC)(p):y=(0,g.yC)(f),{wrapper:(0,n.css)({appearance:"none",borderStyle:"none",fontWeight:u.typography.fontWeightMedium,fontSize:u.typography.size.sm,lineHeight:u.typography.bodySmall.lineHeight,verticalAlign:"baseline",backgroundColor:y.color,color:u.v1.palette.gray98,whiteSpace:"pre",textShadow:"none",padding:"3px 6px",borderRadius:u.shape.radius.default}),hover:(0,n.css)({"&:hover":{opacity:.85,cursor:"pointer"}})}}},64149:(G,R,e)=>{"use strict";e.d(R,{L:()=>d});var t=e(74848),n=e(32196),s=e(96540),a=e(40845),r=e(72129),g=e(78369);const i=(0,s.memo)((0,s.forwardRef)(({displayMax:o,tags:m,icon:u,onClick:p,className:f,getAriaLabel:y,getColorIndex:x},v)=>{const P=(0,a.$j)(),E=h(P,!!(o&&o>0)),D=m.length,C=o?m.slice(0,o):m;return(0,t.jsxs)("ul",{className:(0,n.cx)(E.wrapper,f),"aria-label":"Tags",ref:v,children:[C.map((b,T)=>(0,t.jsx)("li",{className:E.li,children:(0,t.jsx)(g.v,{name:b,icon:u,onClick:p,"aria-label":y?.(b,T),"data-tag-id":T,colorIndex:x?.(b,T)})},b)),o&&o>0&&D-o>0&&(0,t.jsxs)("span",{className:E.moreTagsLabel,children:["+ ",D-o]})]})}));i.displayName="TagList";const l=({rootProps:o})=>{const m=(0,a.of)(c);return(0,t.jsxs)("div",{className:m.container,...o,children:[(0,t.jsx)(g.v.Skeleton,{}),(0,t.jsx)(g.v.Skeleton,{})]})},d=(0,r.j)(i,l),c=o=>({container:(0,n.css)({display:"flex",gap:o.spacing(1)})}),h=(o,m)=>({wrapper:(0,n.css)({position:"relative",alignItems:m?"center":"unset",display:"flex",flex:"1 1 auto",flexWrap:"wrap",flexShrink:m?0:1,justifyContent:"flex-end",gap:"6px"}),moreTagsLabel:(0,n.css)({color:o.colors.text.secondary,fontSize:o.typography.size.sm}),li:(0,n.css)({listStyle:"none"})})},79924:(G,R,e)=>{"use strict";e.d(R,{u:()=>h});var t=e(74848),n=e(32196),s=e(96540),a=e(40845),r=e(55852),g=e(10354),i=e(69613),l=e(29158);const d=({name:m,disabled:u,onRemove:p})=>{const{color:f,borderColor:y}=(0,s.useMemo)(()=>(0,i.MC)(m),[m]),x=(0,a.of)(c);return(0,t.jsxs)("li",{className:x.itemStyle,style:{backgroundColor:f,borderColor:y},children:[(0,t.jsx)("span",{className:x.nameStyle,children:m}),(0,t.jsx)(l.K,{name:"times",size:"lg",disabled:u,tooltip:`Remove "${m}" tag`,onClick:()=>p(m),className:x.buttonStyles})]})},c=m=>{const u=m.spacing.gridSize*3;return{itemStyle:(0,n.css)({display:"flex",gap:"3px",alignItems:"center",height:`${u}px`,lineHeight:`${u-2}px`,color:"#fff",borderWidth:"1px",borderStyle:"solid",borderRadius:m.shape.radius.default,padding:`0 ${m.spacing(.5)}`,whiteSpace:"nowrap",textShadow:"none",fontWeight:500,fontSize:m.typography.size.sm}),nameStyle:(0,n.css)({maxWidth:"25ch",textOverflow:"ellipsis",overflow:"hidden"}),buttonStyles:(0,n.css)({margin:0,"&:hover::before":{display:"none"}})}},h=({placeholder:m="New tag (enter key to add)",tags:u=[],onChange:p,width:f,className:y,disabled:x,addOnBlur:v,invalid:P,id:E})=>{const[D,C]=(0,s.useState)(""),b=(0,a.of)(o),T=(0,a.$j)(),S=(0,s.useCallback)(B=>{C(B.target.value)},[]),O=B=>{p(u.filter(j=>j!==B))},M=B=>{B?.preventDefault(),u.includes(D)||p(u.concat(D)),C("")},I=()=>{v&&D&&M()},L=B=>{B.key==="Enter"&&D!==""&&M(B)};return(0,t.jsxs)("div",{className:(0,n.cx)(b.wrapper,y,f?(0,n.css)({width:T.spacing(f)}):""),children:[(0,t.jsx)(g.p,{id:E,disabled:x,placeholder:m,onChange:S,value:D,onKeyDown:L,onBlur:I,invalid:P,suffix:(0,t.jsx)(r.$n,{fill:"text",className:b.addButtonStyle,onClick:M,size:"md",disabled:D.length<=0,children:"Add"})}),u?.length>0&&(0,t.jsx)("ul",{className:b.tags,children:u.map(B=>(0,t.jsx)(d,{name:B,onRemove:O,disabled:x},B))})]})},o=m=>({wrapper:(0,n.css)({minHeight:m.spacing(4),display:"flex",flexDirection:"column",gap:m.spacing(1),flexWrap:"wrap"}),tags:(0,n.css)({display:"flex",justifyContent:"flex-start",flexWrap:"wrap",gap:m.spacing(.5)}),addButtonStyle:(0,n.css)({margin:`0 -${m.spacing(1)}`})})},21744:(G,R,e)=>{"use strict";e.d(R,{f:()=>g});var t=e(74848),n=e(32196),s=e(96540),a=e(40845),r=e(87266);const g=(0,s.forwardRef)(({invalid:l,className:d,...c},h)=>{const o=(0,a.of)(i,l);return(0,t.jsx)("textarea",{...c,className:(0,n.cx)(o.textarea,d),ref:h})}),i=(l,d=!1)=>({textarea:(0,n.cx)((0,r.Xb)(l),(0,r.gm)(l),(0,n.css)({display:"block",borderRadius:l.shape.radius.default,padding:`${l.spacing.gridSize/4}px ${l.spacing.gridSize}px`,width:"100%",borderColor:d?l.colors.error.border:l.components.input.borderColor}))});g.displayName="TextArea"},60782:(G,R,e)=>{"use strict";e.d(R,{G:()=>c});var t=e(74848),n=e(32196),s=e(34743),a=e(83505),r=e(46885),g=e(96540),i=e(40845),l=e(18976),d=e(29158);const c=(0,g.memo)(({children:o,theme:m="info",placement:u="auto",content:p,title:f,closeButton:y=!0,onClose:x,footer:v,fitContent:P=!1,onOpen:E,show:D})=>{const C=(0,g.useRef)(null),b=(0,i.$j)(),T=(0,i.of)(h),S=T[m],[O,M]=(0,g.useState)(D),I=D??O,L=[(0,s.cY)(8),(0,s.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,s.BN)(),(0,s.UE)({element:C})],{context:B,refs:j,floatingStyles:A}=(0,a.we)({open:I,placement:(0,l.O)(u),onOpenChange:V=>{D===void 0&&M(V),V?E?.():x?.()},middleware:L,whileElementsMounted:r.ll,strategy:"fixed"}),K=(0,a.kp)(B),W=(0,a.s9)(B),{getReferenceProps:U,getFloatingProps:F}=(0,a.bv)([W,K]);return(0,t.jsxs)(t.Fragment,{children:[(0,g.cloneElement)(o,{ref:j.setReference,tabIndex:0,"aria-expanded":I,...U()}),I&&(0,t.jsx)(a.s3,{context:B,modal:!1,closeOnFocusOut:!1,children:(0,t.jsxs)("div",{"data-testid":"toggletip-content",className:(0,n.cx)(S.container,{[T.fitContent]:P}),ref:j.setFloating,style:A,...F(),children:[(0,t.jsx)(a.ie,{strokeWidth:.3,stroke:b.colors.border.weak,className:S.arrow,ref:C,context:B}),!!f&&(0,t.jsx)("div",{className:S.header,children:f}),y&&(0,t.jsx)("div",{className:S.headerClose,children:(0,t.jsx)(d.K,{"aria-label":"Close",name:"times","data-testid":"toggletip-header-close",onClick:()=>{M(!1),x?.()}})}),(0,t.jsxs)("div",{className:S.body,children:[(typeof p=="string"||(0,g.isValidElement)(p))&&p,typeof p=="function"&&p({})]}),!!v&&(0,t.jsx)("div",{className:S.footer,children:v})]})})]})});c.displayName="Toggletip";const h=o=>{const m=(0,l.f)(o,o.colors.background.primary,o.colors.border.weak,o.components.tooltip.text,{topBottom:2,rightLeft:2}),u=(0,l.f)(o,o.colors.error.main,o.colors.error.main,o.colors.error.contrastText,{topBottom:2,rightLeft:2});return{info:m,error:u,fitContent:(0,n.css)({maxWidth:"fit-content"})}}},27746:(G,R,e)=>{"use strict";e.d(R,{I:()=>h});var t=e(74848),n=e(32196),s=e(96540),a=e(8887),r=e(13544),g=e(40845),i=e(16797),l=e(55852),d=e(14578),c=e(56034);const h=(0,s.forwardRef)(({tooltip:p,icon:f,iconSize:y,className:x,children:v,imgSrc:P,imgAlt:E,fullWidth:D,isOpen:C,narrow:b,variant:T="default",iconOnly:S,"aria-label":O,isHighlighted:M,...I},L)=>{const B=(0,g.of)(u),j=(0,n.cx)({[B.button]:!0,[B.buttonFullWidth]:D,[B.narrow]:b},B[T],x),A=(0,n.cx)({[B.content]:!0,[B.contentWithIcon]:!!f,[B.contentWithRightIcon]:C!==void 0}),K=(0,t.jsxs)("button",{ref:L,className:j,"aria-label":o(O,p),"aria-expanded":C,...I,children:[m(f,y),P&&(0,t.jsx)("img",{className:B.img,src:P,alt:E??""}),v&&!S&&(0,t.jsx)("div",{className:A,children:v}),C===!1&&(0,t.jsx)(d.I,{name:"angle-down"}),C===!0&&(0,t.jsx)(d.I,{name:"angle-up"}),M&&(0,t.jsx)("div",{className:B.highlight})]});return p?(0,t.jsx)(c.m,{ref:L,content:p,placement:"bottom",children:K}):K});h.displayName="ToolbarButton";function o(p,f){return p||(f?r.Tp.components.PageToolbar.item(f):void 0)}function m(p,f){return p?(0,a.n6)(p)?(0,t.jsx)(d.I,{name:p,size:`${f||"lg"}`}):p:null}const u=p=>{const f=(0,l.U_)(p,"primary","solid"),y=(0,l.U_)(p,"destructive","solid"),x=(0,n.css)({color:p.colors.text.primary,background:p.colors.secondary.main,"&:hover":{color:p.colors.text.primary,background:p.colors.secondary.shade,border:`1px solid ${p.colors.border.medium}`}});return{button:(0,n.css)({label:"toolbar-button",position:"relative",display:"flex",alignItems:"center",height:p.spacing(p.components.height.md),padding:p.spacing(0,1),borderRadius:p.shape.radius.default,lineHeight:`${p.components.height.md*p.spacing.gridSize-2}px`,fontWeight:p.typography.fontWeightMedium,border:`1px solid ${p.colors.secondary.border}`,whiteSpace:"nowrap",[p.transitions.handleMotion("no-preference","reduce")]:{transition:p.transitions.create(["background","box-shadow","border-color","color"],{duration:p.transitions.duration.short})},"&:focus, &:focus-visible":{...(0,i.getFocusStyles)(p),zIndex:1},"&:focus:not(:focus-visible)":(0,i.getMouseFocusStyles)(p),"&:hover":{boxShadow:p.shadows.z1},"&[disabled], &:disabled":{cursor:"not-allowed",opacity:p.colors.action.disabledOpacity,background:p.colors.action.disabledBackground,boxShadow:"none","&:hover":{color:p.colors.text.disabled,background:p.colors.action.disabledBackground,boxShadow:"none"}}}),default:(0,n.css)({color:p.colors.text.secondary,background:"transparent",border:"1px solid transparent","&:hover":{color:p.colors.text.primary,background:p.colors.background.secondary}}),canvas:x,active:(0,n.cx)(x,(0,n.css)({"&::before":{display:"block",content:'" "',position:"absolute",left:0,right:0,height:"2px",bottom:0,borderRadius:p.shape.radius.default,backgroundImage:p.colors.gradients.brandHorizontal}})),primary:(0,n.css)(f),destructive:(0,n.css)(y),narrow:(0,n.css)({padding:p.spacing(0,.5)}),img:(0,n.css)({width:"16px",height:"16px",marginRight:p.spacing(1)}),buttonFullWidth:(0,n.css)({flexGrow:1}),content:(0,n.css)({display:"flex",flexGrow:1}),contentWithIcon:(0,n.css)({display:"none",paddingLeft:p.spacing(1),[`@media ${i.mediaUp(p.v1.breakpoints.md)}`]:{display:"block"}}),contentWithRightIcon:(0,n.css)({paddingRight:p.spacing(.5)}),highlight:(0,n.css)({backgroundColor:p.colors.success.main,borderRadius:p.shape.radius.circle,width:"6px",height:"6px",position:"absolute",top:"-3px",right:"-3px",zIndex:1})}}},15068:(G,R,e)=>{"use strict";e.d(R,{U:()=>c});var t=e(74848),n=e(32196),s=e(18828),a=e(85690),r=e(93225),g=e(96540),i=e(40845),l=e(17464),d=e(27746);const c=(0,g.forwardRef)(({alignment:o="left",className:m,children:u,...p},f)=>{const y=g.Children.toArray(u).filter(L=>L!=null),[x,v]=(0,g.useState)(Array(y.length).fill(!1)),P=(0,g.useRef)(null),[E,D]=(0,g.useState)(!1),C=(0,g.useRef)(null),b=(0,g.createRef)(),{overlayProps:T}=(0,r.e)({onClose:()=>D(!1),isDismissable:!0,isOpen:E,shouldCloseOnInteractOutside:L=>{const B=(0,l.gF)();return!C.current?.contains(L)&&!B.contains(L)}},b),{dialogProps:S}=(0,s.s)({},b),O=(0,i.$j)(),M=o==="left"?x.indexOf(!1)-1:x.length,I=h(O,M,o);return(0,g.useLayoutEffect)(()=>{const L=new IntersectionObserver(B=>{B.forEach(j=>{if(j.target instanceof HTMLElement&&j.target.parentNode){const A=Array.prototype.indexOf.call(j.target.parentNode.children,j.target);v(K=>{const W=[...K];return W[A]=j.isIntersecting,W})}})},{threshold:1,root:P.current});return P.current&&Array.from(P.current.children).forEach(B=>{B instanceof HTMLElement&&B!==C.current&&L.observe(B)}),()=>L.disconnect()},[u]),(0,t.jsxs)("div",{ref:P,className:(0,n.cx)(I.container,m),...p,children:[y.map((L,B)=>(0,t.jsx)("div",{style:{order:B,visibility:x[B]?"visible":"hidden"},className:I.childWrapper,children:L},B)),x.includes(!1)&&(0,t.jsxs)("div",{ref:C,className:I.overflowButton,children:[(0,t.jsx)(d.I,{variant:E?"active":"default",tooltip:"Show more items",onClick:()=>D(!E),icon:"ellipsis-v",iconOnly:!0,narrow:!0}),E&&(0,t.jsx)(a.n1,{contain:!0,autoFocus:!0,children:(0,t.jsx)("div",{className:I.overflowItems,ref:b,...T,...S,children:y.map((L,B)=>!x[B]&&L)})})]})]})});c.displayName="ToolbarButtonRow";const h=(o,m,u)=>({overflowButton:(0,n.css)({order:m}),overflowItems:(0,n.css)({alignItems:"center",backgroundColor:o.colors.background.primary,borderRadius:o.shape.radius.default,boxShadow:o.shadows.z2,display:"flex",flexWrap:"wrap",gap:o.spacing(1),marginTop:o.spacing(1),maxWidth:"80vw",padding:o.spacing(.5,1),position:"absolute",right:0,top:"100%",width:"max-content",zIndex:o.zIndex.dropdown}),container:(0,n.css)({alignItems:"center",display:"flex",gap:o.spacing(1),justifyContent:u==="left"?"flex-start":"flex-end",minWidth:0,position:"relative"}),childWrapper:(0,n.css)({alignItems:"center",display:"flex",gap:o.spacing(1)})})},13840:(G,R,e)=>{"use strict";e.d(R,{A:()=>d});var t=e(74848),n=e(34743),s=e(83505),a=e(46885),r=e(96540),g=e(40845),i=e(18976),l=e(17464);function d({content:c,show:h,placement:o,className:m,wrapperClassName:u,referenceElement:p,renderArrow:f,...y}){const x=(0,g.$j)(),v=(0,r.useRef)(null),P=[(0,n.cY)(8),(0,n.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,n.BN)()];f&&P.push((0,n.UE)({element:v}));const{context:E,refs:D,floatingStyles:C}=(0,s.we)({open:h,placement:(0,i.O)(o),middleware:P,whileElementsMounted:a.ll,strategy:"fixed"});(0,r.useLayoutEffect)(()=>{D.setReference(p)},[p,D]);const{styles:b}=(0,s.DL)(E,{initial:()=>({opacity:0}),duration:x.transitions.duration.enteringScreen});return h?(0,t.jsx)(l.ZL,{children:(0,t.jsx)("div",{ref:D.setFloating,style:{...C,...b},className:u,...y,children:(0,t.jsxs)("div",{className:m,children:[f&&(0,t.jsx)(s.ie,{fill:x.colors.border.weak,ref:v,context:E}),typeof c=="string"&&c,r.isValidElement(c)&&r.cloneElement(c),typeof c=="function"&&c({})]})})}):void 0}},95868:(G,R,e)=>{"use strict";e.d(R,{I:()=>n});var t=e(96540);class n extends t.Component{constructor(){super(...arguments),this.hideTimeout=null,this.state={show:!1},this.showPopper=()=>{this.hideTimeout&&clearTimeout(this.hideTimeout),this.setState({show:!0})},this.hidePopper=()=>{this.hideTimeout=setTimeout(()=>{this.setState({show:!1})},this.props.hideAfter)}}render(){const{children:a,content:r,placement:g="auto"}=this.props,{show:i}=this.state;return a(this.showPopper,this.hidePopper,{show:i,placement:g,content:r})}}},5313:(G,R,e)=>{"use strict";e.d(R,{z:()=>a});var t=e(74848),n=e(96540);function s(r,g){const i=[];return r.forEach(l=>{i.push(l.start,l.end+1)}),i[0]!==0&&i.unshift(0),i[i.length-1]!==g&&i.push(g),i}const a=r=>{let{highlightParts:g,text:i,highlightClassName:l}=r;if(!g?.length)return null;let d=[],c=s(g,i.length),h=g[0].start===0;for(let o=1;o<c.length;o++){let m=c[o-1],u=c[o];d.push((0,n.createElement)(h?"mark":"span",{key:o-1,className:h?l:void 0},i.substring(m,u))),h=!h}return(0,t.jsx)("div",{children:d})}},2056:(G,R,e)=>{"use strict";e.d(R,{p:()=>g});var t=e(74848),n=e(96540),s=e(83195),a=e(3988);function r(i){return`Custom unit: ${i}`}class g extends n.PureComponent{constructor(){super(...arguments),this.onChange=l=>{this.props.onChange(l.value)}}render(){const{value:l,width:d}=this.props;let c;const o=(0,s.Ke)().map(m=>{const u=m.submenu.map(p=>{const f={label:p.text,value:p.value};return p.value===l&&(c=f),f});return{label:m.text,value:m.text,items:u}});return l&&!c&&(c={value:l,label:l}),(0,t.jsx)(a.v,{width:d,initialValue:c&&c.label,allowCustomValue:!0,changeOnSelect:!1,formatCreateLabel:r,options:o,placeholder:"Choose",isClearable:!0,onSelect:this.props.onChange})}}},12942:(G,R,e)=>{"use strict";e.d(R,{e:()=>r});var t=e(74848),n=e(32196),s=e(40845),a=e(16795);const r=({src:i,alt:l,width:d,height:c})=>{const h=(0,s.of)(g,d,c);return(0,t.jsx)("img",{className:h.image,src:i,alt:l})},g=(i,l=3,d=3)=>({image:(0,n.css)([(0,a.Y)(i,l,c=>({width:i.spacing(c)})),(0,a.Y)(i,d,c=>({height:i.spacing(c)})),{borderRadius:i.shape.radius.circle}])})},99635:(G,R,e)=>{"use strict";e.d(R,{n:()=>d});var t=e(74848),n=e(32196),s=e(96540),a=e(47232),r=e(40845),g=e(56034);const i=o=>{const u=(0,a.KQ)(o).diff((0,a.KQ)(),"hours",!1);return`Active last ${(Math.floor(-u/24)+1)*24}h`},l=o=>{if(!o)return"";const[m,u]=o.split(" ");return`${m?.[0]??""}${u?.[0]??""}`.toUpperCase()},d=({userView:o,className:m,children:u,onClick:p,showTooltip:f=!0})=>{const{user:y,lastActiveAt:x}=o,v=(0,a.KQ)(x).diff((0,a.KQ)(),"minutes",!0)>=-15,P=(0,r.$j)(),E=(0,s.useMemo)(()=>h(P,v),[P,v]),D=(0,t.jsx)("button",{type:"button",onClick:p,className:(0,n.cx)(E.container,p&&E.pointer,m),"aria-label":`${y.name} icon`,children:u?(0,t.jsx)("div",{className:(0,n.cx)(E.content,E.textContent),children:u}):y.avatarUrl?(0,t.jsx)("img",{className:E.content,src:y.avatarUrl,alt:`${y.name} avatar`}):(0,t.jsx)("div",{className:(0,n.cx)(E.content,E.textContent),children:l(y.name)})});if(f){const C=(0,t.jsxs)("div",{className:E.tooltipContainer,children:[(0,t.jsx)("div",{className:E.tooltipName,children:y.name}),(0,t.jsx)("div",{className:E.tooltipDate,children:v?(0,t.jsxs)("div",{className:E.dotContainer,children:[(0,t.jsx)("span",{children:"Active last 15m"}),(0,t.jsx)("span",{className:E.dot})]}):i(x)})]});return(0,t.jsx)(g.m,{content:C,children:D})}else return D},c=o=>`0 0 0 1px ${o}`,h=(o,m)=>{const u=m?o.colors.primary.main:o.colors.border.medium,p=m?o.colors.primary.text:o.colors.border.strong;return{container:(0,n.css)({padding:0,width:"30px",height:"30px",background:"none",border:"none",borderRadius:o.shape.radius.circle,"& > *":{borderRadius:o.shape.radius.circle}}),content:(0,n.css)({lineHeight:"24px",maxWidth:"100%",border:`3px ${o.colors.background.primary} solid`,boxShadow:c(u),backgroundClip:"padding-box","&:hover":{boxShadow:c(p)}}),textContent:(0,n.css)({background:o.colors.background.primary,padding:0,color:o.colors.text.secondary,textAlign:"center",fontSize:o.typography.size.sm,"&:focus":{boxShadow:c(u)}}),tooltipContainer:(0,n.css)({textAlign:"center",padding:o.spacing(0,1)}),tooltipName:(0,n.css)({fontWeight:o.typography.fontWeightBold}),tooltipDate:(0,n.css)({fontWeight:o.typography.fontWeightRegular}),dotContainer:(0,n.css)({display:"flex",alignItems:"center"}),dot:(0,n.css)({height:"6px",width:"6px",backgroundColor:o.colors.primary.main,borderRadius:o.shape.radius.circle,display:"inline-block",marginLeft:o.spacing(1)}),pointer:(0,n.css)({cursor:"pointer"})}}},51986:(G,R,e)=>{"use strict";e.d(R,{i:()=>i});var t=e(74848),n=e(96540),s=e(13544),a=e(40845),r=e(55852),g=e(90182);function i({"aria-label":l,label:d,icon:c,options:h,onChange:o,variant:m,minWidth:u=16,size:p="sm",isFullWidth:f=!0,menuPlacement:y,fill:x,buttonCss:v}){const[P,E]=(0,n.useState)(!1),D=(0,a.$j)();return(0,t.jsxs)(t.Fragment,{children:[!P&&(0,t.jsx)(r.$n,{size:p||"sm",className:v,icon:c||"plus",onClick:()=>E(!0),variant:m,fill:x,fullWidth:f,"data-testid":s.Tp.components.ValuePicker.button(l??d),children:d}),P&&(0,t.jsx)("span",{style:{minWidth:D.spacing(u),flexGrow:f?1:void 0},children:(0,t.jsx)(g.l6,{placeholder:d,options:h,"aria-label":s.Tp.components.ValuePicker.select(l??d),isOpen:!0,onCloseMenu:()=>E(!1),autoFocus:!0,onChange:C=>{E(!1),o(C)},menuPlacement:y})})]})}},67266:(G,R,e)=>{"use strict";e.d(R,{KU:()=>i});var t=e(74848),n=e(32196),s=e(49185),a=e(40845),r=e(16797),g=e(40276);const i=({width:c,height:h,legend:o,children:m})=>{const u=(0,a.$j)(),p=(0,a.of)(l),f={display:"flex",width:`${c}px`,height:`${h}px`},[y,x]=(0,s.A)();if(!o)return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{style:f,className:p.viz,children:m(c,h)})});let{placement:v,maxHeight:P="35%",maxWidth:E="60%"}=o.props;document.body.clientWidth<u.breakpoints.values.lg&&(v="bottom");let D=null;const C={};switch(v){case"bottom":f.flexDirection="column",C.maxHeight=P,x.height&&(D={width:c,height:h-x.height});break;case"right":f.flexDirection="row",C.maxWidth=E,x.width&&(D={width:c-x.width,height:h}),o.props.width&&(C.width=o.props.width,D={width:c-o.props.width,height:h});break}return D?.width===0&&(D.width=c),D?.height===0&&(D.height=h),(0,t.jsxs)("div",{style:f,children:[(0,t.jsx)("div",{className:p.viz,children:D&&m(D.width,D.height)}),(0,t.jsx)("div",{style:C,ref:y,children:(0,t.jsx)(g.E,{hideHorizontalTrack:!0,children:o})})]})},l=c=>({viz:(0,n.css)({flexGrow:2,borderRadius:c.shape.radius.default,"&:focus-visible":(0,r.getFocusStyles)(c)})}),d=({children:c})=>(0,t.jsx)(t.Fragment,{children:c});i.Legend=d},94536:(G,R,e)=>{"use strict";e.d(R,{p:()=>g});var t=e(74848),n=e(32196),s=e(96540),a=e(8066),r=e(40845);const g=s.memo(s.forwardRef(({color:l,className:d,gradient:c,lineStyle:h,...o},m)=>{const u=(0,r.$j)(),p=(0,r.of)(i);let f;if(c){const x=a.uf.get(c).getColors?.(u);x?.length?f=`linear-gradient(90deg, ${x.join(", ")})`:f=u.visualization.getColorByName("")}else f=l;let y;return h?.fill==="dot"&&!c?y={backgroundImage:`radial-gradient(circle at 2px 2px, ${l} 2px, transparent 0)`,backgroundSize:"4px 4px",backgroundRepeat:"space"}:h?.fill==="dash"&&!c?y={backgroundImage:`linear-gradient(to right, ${l} 100%, transparent 0%)`,backgroundSize:"6px 4px",backgroundRepeat:"space"}:y={background:f,borderRadius:u.shape.radius.pill},(0,t.jsx)("div",{"data-testid":"series-icon",ref:m,className:(0,n.cx)(d,p.forcedColors,p.container),style:y,...o})})),i=l=>({container:(0,n.css)({marginRight:"8px",display:"inline-block",width:"14px",height:"4px"}),forcedColors:(0,n.css)({"@media (forced-colors: active)":{forcedColorAdjust:"none"}})});g.displayName="SeriesIcon"},96516:(G,R,e)=>{"use strict";e.d(R,{t:()=>S});var t=e(74848),n=e(96540),s=e(69129),a=e(52622),r=e(79041),g=e(88895),i=e(32196),l=e(40845),d=e(1551),c=e(33552),h=e(34375);const o=({items:O,itemRenderer:M,onLabelMouseOver:I,onLabelMouseOut:L,onLabelClick:B,placement:j,className:A,readonly:K})=>{const W=(0,l.of)(m);M||(M=F=>(0,t.jsx)(h.M,{item:F,onLabelClick:B,onLabelMouseOver:I,onLabelMouseOut:L,readonly:K}));const U=F=>`${F.getItemKey?F.getItemKey():F.label}`;switch(j){case"right":{const F=(V,w)=>(0,t.jsx)("span",{className:W.itemRight,children:M(V,w)});return(0,t.jsx)("div",{className:(0,i.cx)(W.rightWrapper,A),children:(0,t.jsx)(c.B,{items:O,renderItem:F,getItemKey:U})})}case"bottom":default:{const F=O.filter(z=>z.yAxis===1),V=O.filter(z=>z.yAxis!==1),w=(z,N)=>(0,t.jsx)("span",{className:W.itemBottom,children:M(z,N)});return(0,t.jsxs)("div",{className:(0,i.cx)(W.bottomWrapper,A),children:[F.length>0&&(0,t.jsx)("div",{className:W.section,children:(0,t.jsx)(d.c,{items:F,renderItem:w,getItemKey:U})}),V.length>0&&(0,t.jsx)("div",{className:(0,i.cx)(W.section,W.sectionRight),children:(0,t.jsx)(d.c,{items:V,renderItem:w,getItemKey:U})})]})}}};o.displayName="VizLegendList";const m=O=>{const M=(0,i.css)({paddingRight:"10px",display:"flex",fontSize:O.typography.bodySmall.fontSize,whiteSpace:"nowrap"});return{itemBottom:M,itemRight:(0,i.cx)(M,(0,i.css)({marginBottom:O.spacing(.5)})),rightWrapper:(0,i.css)({padding:O.spacing(.5)}),bottomWrapper:(0,i.css)({display:"flex",flexWrap:"wrap",justifyContent:"space-between",width:"100%",padding:O.spacing(.5),gap:"15px 25px"}),section:(0,i.css)({display:"flex"}),sectionRight:(0,i.css)({justifyContent:"flex-end",flexGrow:1,flexBasis:"50%"})}};var u=e(14578),p=e(83195),f=e(16797),y=e(94134);const x=({item:O,onLabelClick:M,onLabelMouseOver:I,onLabelMouseOut:L,className:B,readonly:j})=>{const A=(0,l.of)(v),K=(0,n.useCallback)(F=>{I&&I(O,F)},[O,I]),W=(0,n.useCallback)(F=>{L&&L(O,F)},[O,L]),U=(0,n.useCallback)(F=>{M&&M(O,F)},[O,M]);return(0,t.jsxs)("tr",{className:(0,i.cx)(A.row,B),children:[(0,t.jsx)("td",{children:(0,t.jsxs)("span",{className:A.itemWrapper,children:[(0,t.jsx)(y.R,{color:O.color,seriesName:O.fieldName??O.label,readonly:j,lineStyle:O.lineStyle}),(0,t.jsxs)("button",{disabled:j,type:"button",title:O.label,onBlur:W,onFocus:K,onMouseOver:K,onMouseOut:W,onClick:j?void 0:U,className:(0,i.cx)(A.label,O.disabled&&A.labelDisabled),children:[O.label," ",O.yAxis===2&&(0,t.jsx)("span",{className:A.yAxisLabel,children:"(right y-axis)"})]})]})}),O.getDisplayValues&&O.getDisplayValues().map((F,V)=>(0,t.jsx)("td",{className:A.value,children:(0,p.cN)(F)},`${F.title}-${V}`))]})};x.displayName="LegendTableItem";const v=O=>{const M=f.hoverColor(O.colors.background.primary,O);return{row:(0,i.css)({label:"LegendRow",fontSize:O.v1.typography.size.sm,borderBottom:`1px solid ${O.colors.border.weak}`,td:{padding:O.spacing(.25,1),whiteSpace:"nowrap"},"&:hover":{background:M}}),label:(0,i.css)({label:"LegendLabel",whiteSpace:"nowrap",background:"none",border:"none",fontSize:"inherit",padding:0,maxWidth:"600px",textOverflow:"ellipsis",overflow:"hidden",userSelect:"text"}),labelDisabled:(0,i.css)({label:"LegendLabelDisabled",color:O.colors.text.disabled}),itemWrapper:(0,i.css)({display:"flex",whiteSpace:"nowrap",alignItems:"center"}),value:(0,i.css)({textAlign:"right"}),yAxisLabel:(0,i.css)({color:O.colors.text.secondary})}},P="Name",E=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}).compare,D=({items:O,sortBy:M,sortDesc:I,itemRenderer:L,className:B,onToggleSort:j,onLabelClick:A,onLabelMouseOver:K,onLabelMouseOut:W,readonly:U,isSortable:F})=>{const V=(0,l.of)(C),w={};F&&(w[P]="");for(const z of O)if(z.getDisplayValues)for(const N of z.getDisplayValues())w[N.title??"?"]=N.description??"";if(M!=null){let z=new Map;O.forEach(H=>{if(M!==P&&H.getDisplayValues){const Q=H.getDisplayValues().find(ee=>ee.title===M),X=Q==null||Number.isNaN(Q.numeric)?-1/0:Q.numeric;z.set(H,X)}});let N=I?-1:1;M===P?O.sort((H,Q)=>N*E(H.label,Q.label)):O.sort((H,Q)=>{const X=z.get(H)??0,ee=z.get(Q)??0;return N*(X-ee)})}return L||(L=(z,N)=>(0,t.jsx)(x,{item:z,onLabelClick:A,onLabelMouseOver:K,onLabelMouseOut:W,readonly:U},`${z.label}-${N}`)),(0,t.jsxs)("table",{className:(0,i.cx)(V.table,B),children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[!F&&(0,t.jsx)("th",{}),Object.keys(w).map(z=>(0,t.jsxs)("th",{title:w[z],className:(0,i.cx)(V.header,j&&V.headerSortable,F&&V.nameHeader,{[V.withIcon]:M===z}),onClick:()=>{j&&j(z)},children:[z,M===z&&(0,t.jsx)(u.I,{size:"xs",name:I?"angle-down":"angle-up"})]},z))]})}),(0,t.jsx)("tbody",{children:O.map(L)})]})},C=O=>({table:(0,i.css)({width:"100%","th:first-child":{width:"100%",borderBottom:`1px solid ${O.colors.border.weak}`}}),header:(0,i.css)({color:O.colors.primary.text,fontWeight:O.typography.fontWeightMedium,borderBottom:`1px solid ${O.colors.border.weak}`,padding:O.spacing(.25,1,.25,1),fontSize:O.typography.bodySmall.fontSize,textAlign:"right",whiteSpace:"nowrap"}),nameHeader:(0,i.css)({textAlign:"left",paddingLeft:"30px"}),withIcon:(0,i.css)({paddingRight:"4px"}),headerSortable:(0,i.css)({cursor:"pointer"})});var b=e(29995),T=e(44895);function S({items:O,thresholdItems:M,mappingItems:I,displayMode:L,sortBy:B,seriesVisibilityChangeBehavior:j=b.K.Isolate,sortDesc:A,onLabelClick:K,onToggleSort:W,placement:U,className:F,itemRenderer:V,readonly:w,isSortable:z}){const{eventBus:N,onToggleSeriesVisibility:H,onToggleLegendSort:Q}=(0,r.d2)(),X=(0,n.useCallback)((ae,k)=>{N?.publish({type:s.b_.type,payload:{raw:k,x:0,y:0,dataId:ae.label}})},[N]),ee=(0,n.useCallback)((ae,k)=>{N?.publish({type:s.ql.type,payload:{raw:k,x:0,y:0,dataId:ae.label}})},[N]),Z=(0,n.useCallback)((ae,k)=>{K&&K(ae,k),H&&H(ae.fieldName??ae.label,j===b.K.Hide?g.B.AppendToSelection:(0,T.W)(k))},[H,K,j]),q=(0,n.useCallback)(ae=>(0,t.jsx)(o,{className:F,placement:U,onLabelMouseOver:X,onLabelMouseOut:ee,onLabelClick:Z,itemRenderer:V,readonly:w,items:ae}),[F,U,X,ee,Z,V,w]);switch(L){case a.lm.Table:return(0,t.jsx)(D,{className:F,items:O,placement:U,sortBy:B,sortDesc:A,onLabelClick:Z,onToggleSort:W||Q,onLabelMouseOver:X,onLabelMouseOut:ee,itemRenderer:V,readonly:w,isSortable:z});case a.lm.List:const ae=M&&M.length>1,k=I&&I.length>0;return(0,t.jsxs)(t.Fragment,{children:[!ae&&(!k||O.length>1)&&q(O),ae&&q(M),k&&q(I)]});default:return null}}S.displayName="VizLegend"},34375:(G,R,e)=>{"use strict";e.d(R,{M:()=>o});var t=e(74848),n=e(32196),s=e(96540),a=e(13544),r=e(40845),g=e(94134),i=e(2543),l=e(83195),d=e(1551);const c=({stats:u})=>{const p=(0,r.of)(h);return u.length===0?null:(0,t.jsx)(d.c,{className:p.list,items:u,renderItem:f=>(0,t.jsxs)("div",{className:p.item,title:f.description,children:[f.title&&`${(0,i.capitalize)(f.title)}:`," ",(0,l.cN)(f)]})})},h=()=>({list:(0,n.css)({flexGrow:1,textAlign:"right"}),item:(0,n.css)({marginLeft:"8px"})});c.displayName="VizLegendStatsList";const o=({item:u,onLabelClick:p,onLabelMouseOver:f,onLabelMouseOut:y,className:x,readonly:v})=>{const P=(0,r.of)(m),E=(0,s.useCallback)(b=>{f&&f(u,b)},[u,f]),D=(0,s.useCallback)(b=>{y&&y(u,b)},[u,y]),C=(0,s.useCallback)(b=>{p&&p(u,b)},[u,p]);return(0,t.jsxs)("div",{className:(0,n.cx)(P.itemWrapper,u.disabled&&P.itemDisabled,x),"data-testid":a.Tp.components.VizLegend.seriesName(u.label),children:[(0,t.jsx)(g.R,{seriesName:u.fieldName??u.label,color:u.color,gradient:u.gradient,readonly:v,lineStyle:u.lineStyle}),(0,t.jsx)("button",{disabled:v,type:"button",onBlur:D,onFocus:E,onMouseOver:E,onMouseOut:D,onClick:C,className:P.label,children:u.label}),u.getDisplayValues&&(0,t.jsx)(c,{stats:u.getDisplayValues()})]})};o.displayName="VizLegendListItem";const m=u=>({label:(0,n.css)({label:"LegendLabel",whiteSpace:"nowrap",background:"none",border:"none",fontSize:"inherit",padding:0,userSelect:"text"}),itemDisabled:(0,n.css)({label:"LegendLabelDisabled",color:u.colors.text.disabled}),itemWrapper:(0,n.css)({label:"LegendItemWrapper",display:"flex",whiteSpace:"nowrap",alignItems:"center",flexGrow:1}),value:(0,n.css)({textAlign:"right"}),yAxisLabel:(0,n.css)({color:u.v1.palette.gray2})})},94134:(G,R,e)=>{"use strict";e.d(R,{R:()=>g});var t=e(74848),n=e(96540),s=e(83598),a=e(79041),r=e(94536);const g=(0,n.memo)(({seriesName:i,color:l,gradient:d,readonly:c,lineStyle:h})=>{const{onSeriesColorChange:o}=(0,a.d2)(),m=(0,n.useCallback)(u=>o(i,u),[i,o]);return i&&o&&l&&!c?(0,t.jsx)(s.Dp,{color:l,onChange:m,enableNamedColors:!0,children:({ref:u,showColorPicker:p,hideColorPicker:f})=>(0,t.jsx)(r.p,{color:l,className:"pointer",ref:u,onClick:p,onMouseLeave:f,lineStyle:h})}):(0,t.jsx)(r.p,{color:l,gradient:d,lineStyle:h})});g.displayName="VizLegendSeriesIcon"},29995:(G,R,e)=>{"use strict";e.d(R,{K:()=>t});var t=(n=>(n[n.Isolate=0]="Isolate",n[n.Hide=1]="Hide",n))(t||{})},44895:(G,R,e)=>{"use strict";e.d(R,{W:()=>n});var t=e(88895);function n(s){return s.ctrlKey||s.metaKey||s.shiftKey?t.B.AppendToSelection:t.B.ToggleSelection}},12509:(G,R,e)=>{"use strict";e.d(R,{S:()=>i});var t=e(74848),n=e(2543),s=e(96540),a=e(47070);const r=(d,c,h,o)=>{const m=g(d,c,o),u=g(c,d,o),p=Math.max(m,u);let f=Math.floor(d/p),y=Math.ceil(o/f);f=Math.ceil(o/y);const x=f-(f*y-o),v=d/x-h+h/x;return{width:d/f-h+h/f,height:c/y-h+h/y,widthOnLastRow:v,xCount:f,yCount:y}};function g(d,c,h){const o=Math.ceil(Math.sqrt(h*d/c));return Math.floor(o*c/d)*o<h?c/Math.ceil(o*c/d):d/o}class i extends s.PureComponent{static{this.defaultProps={itemSpacing:8}}constructor(c){super(c),this.state={values:c.getValues()}}componentDidUpdate(c){const{renderCounter:h,source:o}=this.props;(h!==c.renderCounter||o!==c.source)&&this.setState({values:this.props.getValues()})}getOrientation(){const{orientation:c,width:h,height:o}=this.props;return c===a.wV.Auto?h>o?a.wV.Vertical:a.wV.Horizontal:c}renderGrid(){const{renderValue:c,height:h,width:o,itemSpacing:m,getAlignmentFactors:u,orientation:p}=this.props,{values:f}=this.state,y=r(o,h,m,f.length),x=u?u(f,y.width,y.height):{};let v=0,P=0,E=[];for(let D=0;D<f.length;D++){const C=f[D],T=P===y.yCount-1?y.widthOnLastRow:y.width,S=y.height,O=v*T+m*v,M=P*S+m*P,I={position:"absolute",left:O,top:M,width:`${T}px`,height:`${S}px`};E.push((0,t.jsx)("div",{style:I,children:c({value:C,width:T,height:S,alignmentFactors:x,orientation:p,count:f.length})},D)),v++,v===y.xCount&&(v=0,P++)}return(0,t.jsx)("div",{style:{position:"relative"},children:E})}render(){const{renderValue:c,height:h,width:o,itemSpacing:m,getAlignmentFactors:u,autoGrid:p,orientation:f,maxVizHeight:y,minVizWidth:x,minVizHeight:v}=this.props,{values:P}=this.state;if(p&&f===a.wV.Auto)return this.renderGrid();const E={display:"flex"},D={display:"flex",overflow:`${x?"auto":"hidden"} ${v?"auto":"hidden"}`};let C=h,b=o;const T=this.getOrientation();switch(T){case a.wV.Horizontal:const O=(h+m)/P.length-m;D.flexDirection="column",D.height=`${h}px`,D.overflowX="hidden",E.marginBottom=`${m}px`,b=o,C=(0,n.clamp)(O,v??0,y??O);break;case a.wV.Vertical:D.flexDirection="row",D.justifyContent="space-between",D.overflowY="hidden",E.marginRight=`${m}px`,C=h,b=Math.max(o/P.length-m+m/P.length,x??0)}E.width=`${b}px`,E.height=`${C}px`;const S=u?u(P,b,C):{};return(0,t.jsx)("div",{style:D,children:P.map((O,M)=>(0,t.jsx)("div",{style:l(E,M,P.length),children:c({value:O,width:b,height:C,alignmentFactors:S,orientation:T,count:P.length})},M))})}}function l(d,c,h){return c===h-1?{...d,marginRight:0,marginBottom:0}:d}},3139:(G,R,e)=>{"use strict";e.d(R,{g:()=>g,o:()=>i});var t=e(74848),n=e(32196),s=e(40845),a=e(94536);const r=l=>({icon:(0,n.css)({marginRight:l.spacing(1),verticalAlign:"middle"}),seriesTable:(0,n.css)({display:"table"}),seriesTableRow:(0,n.css)({display:"table-row",fontSize:l.typography.bodySmall.fontSize}),seriesTableCell:(0,n.css)({display:"table-cell"}),label:(0,n.css)({wordBreak:"break-all"}),value:(0,n.css)({paddingLeft:l.spacing(2),textAlign:"right"}),activeSeries:(0,n.css)({fontWeight:l.typography.fontWeightBold,color:l.colors.text.maxContrast}),timestamp:(0,n.css)({fontWeight:l.typography.fontWeightBold,fontSize:l.typography.bodySmall.fontSize})}),g=({color:l,label:d,value:c,isActive:h})=>{const o=(0,s.of)(r);return(0,t.jsxs)("div",{"data-testid":"SeriesTableRow",className:(0,n.cx)(o.seriesTableRow,h&&o.activeSeries),children:[l&&(0,t.jsx)("div",{className:o.seriesTableCell,children:(0,t.jsx)(a.p,{color:l,className:o.icon})}),d&&(0,t.jsx)("div",{className:(0,n.cx)(o.seriesTableCell,o.label),children:d}),c&&(0,t.jsx)("div",{className:(0,n.cx)(o.seriesTableCell,o.value),children:c})]})},i=({timestamp:l,series:d})=>{const c=(0,s.of)(r);return(0,t.jsxs)(t.Fragment,{children:[l&&(0,t.jsx)("div",{className:c.timestamp,"aria-label":"Timestamp",children:l}),d.map((h,o)=>(0,t.jsx)(g,{isActive:h.isActive,label:h.label,color:h.color,value:h.value},`${h.label}-${o}`))]})}},69503:(G,R,e)=>{"use strict";e.d(R,{o:()=>l});var t=e(74848),n=e(32196),s=e(96540),a=e(52908),r=e(40845),g=e(16797),i=e(10875);const l=({position:{x:c,y:h},offset:{x:o,y:m},children:u,allowPointerEvents:p=!1,className:f,...y})=>{const x=(0,s.useRef)(null),[v,P]=(0,s.useState)({width:0,height:0}),{width:E,height:D}=(0,a.A)(),[C,b]=(0,s.useState)({x:c+o,y:h+m}),T=(0,s.useMemo)(()=>new ResizeObserver(O=>{for(let M of O){const I=Math.floor(M.contentRect.width+16),L=Math.floor(M.contentRect.height+2*8);(v.width!==I||v.height!==L)&&P({width:Math.min(I,E),height:Math.min(L,D)})}}),[v,E,D]);(0,s.useLayoutEffect)(()=>(x.current&&T.observe(x.current),()=>{T.disconnect()}),[T]),(0,s.useLayoutEffect)(()=>{if(x&&x.current){const{x:O,y:M}=(0,i.Ju)(c,h,v.width,v.height,o,m,E,D);b({x:O,y:M})}},[E,D,c,o,h,m,v]);const S=(0,r.of)(d);return(0,t.jsx)("div",{ref:x,style:{position:"fixed",left:0,pointerEvents:p?"auto":"none",top:0,transform:`translate(${C.x}px, ${C.y}px)`,transition:"transform ease-out 0.1s"},"aria-live":"polite","aria-atomic":"true",...y,className:(0,n.cx)(S.wrapper,f),children:u})};l.displayName="VizTooltipContainer";const d=c=>({wrapper:(0,n.css)((0,g.getTooltipContainerStyles)(c))})},79871:(G,R,e)=>{"use strict";e.d(R,{Ev:()=>s,fX:()=>t,lJ:()=>n});var t=(a=>(a.series="series",a.value="value",a.hexagon="hexagon",a.pie_1_4="pie_1_4",a.pie_2_4="pie_2_4",a.pie_3_4="pie_3_4",a.marker_sm="marker_sm",a.marker_md="marker_md",a.marker_lg="marker_lg",a))(t||{}),n=(a=>(a.hidden="hidden",a.first="first",a.leading="leading",a.trailing="trailing",a))(n||{});const s="series"},10875:(G,R,e)=>{"use strict";e.d(R,{Ju:()=>i,L$:()=>l,cp:()=>o});var t=e(11261),n=e(8066),s=e(83195),a=e(24293),r=e(52622),g=e(79871);const i=(m=0,u=0,p=0,f=0,y=0,x=0,v=0,P=0)=>{let E=m,D=u;const C=Math.max(m+y+p-(v-y),0),b=Math.abs(Math.min(m-y-p-y,0)),T=C>0,S=b>0,O=Math.max(u+x+f-(P-x),0),M=Math.abs(Math.min(u-x-f-x,0)),I=O>0,L=M>0;return T&&S?E=C>b?y:v-y-p:T?E=m-y-p:E=m+y,I&&L?D=O>M?x:P-x-f:I?D=u-x-f:D=u+x,{x:E,y:D}},l=(m,u)=>{switch(m){case g.fX.value:return u.value;case g.fX.hexagon:return u.hexagon;case g.fX.pie_1_4:return u.pie_1_4;case g.fX.pie_2_4:return u.pie_2_4;case g.fX.pie_3_4:return u.pie_3_4;case g.fX.marker_sm:return u.marker_sm;case g.fX.marker_md:return u.marker_md;case g.fX.marker_lg:return u.marker_lg;default:return u.value}},d=(m,u)=>m.numeric-u.numeric,c=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),h=(m,u)=>c.compare(`${m.value}`,`${u.value}`),o=(m,u,p,f,y,x,v=P=>!0)=>{let P=[],E=!0;for(let D=0;D<m.length;D++){const C=m[D];if(C===u||C.type===t.PU.time||!v(C)||C.config.custom?.hideFrom?.tooltip||C.config.custom?.hideFrom?.viz||y===r.$N.Single&&f!==D)continue;let b=p[D];if(b==null)continue;C.type===t.PU.number||C.type===t.PU.boolean||C.type===t.PU.enum||(E=!1);const T=m[D].values[b];if(T==null&&C.config.noValue==null)continue;const S=C.display(T),O=Number.isNaN(S.numeric)?x===r.xB.Descending?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER:S.numeric,M=(0,n.Qi)(C);let I=g.fX.series,L=g.lJ.first;M.isByValue&&(I=g.fX.value,L=g.lJ.trailing),P.push({label:C.state?.displayName??C.name,value:(0,s.cN)(S),color:S.color??a.F,colorIndicator:I,colorPlacement:L,isActive:y===r.$N.Multi&&f===D,numeric:O,lineStyle:C.config.custom?.lineStyle})}if(x!==r.xB.None&&P.length>1){const D=E?d:h,C=x===r.xB.Descending?-1:1;P.sort((b,T)=>C*D(b,T))}return P}},96129:(G,R,e)=>{"use strict";e.d(R,{FcD:()=>hn.F,ibS:()=>Xa,Ivu:()=>Qs.Iv,DWK:()=>Qs.DW,gZN:()=>Qs.gZ,p0K:()=>Be,Dd_:()=>Mt.D,euF:()=>br.e,Exy:()=>Fa.E,xEy:()=>Hn.xE,eX$:()=>Gs.eX,yVm:()=>Zn.yV,ypG:()=>Zn.yp,$p8:()=>Zn.$p,F8C:()=>Zn.F8,SV3:()=>Zn.SV,azJ:()=>sn.a,jQM:()=>Ar.J,$nd:()=>se.$n,HRi:()=>le,e2v:()=>Cs.e,fHW:()=>fs.f,cbd:()=>pn.c,ZpM:()=>Ts.Z,Q_j:()=>is.Q,vxQ:()=>ae.v,KmA:()=>kt.K,Sc0:()=>Rn.S,NqN:()=>wt.N,bLJ:()=>q.b,BYM:()=>gt.B,q0m:()=>et.q,MU_:()=>es.M,SDm:()=>Sn.S,skP:()=>ce.sk,itl:()=>pe.i,ZFl:()=>z.Z,uoB:()=>tt.u,mcf:()=>Ca.mc,tzH:()=>On.t,a2C:()=>Sn.a,phK:()=>ss.p,Pli:()=>cr.P,EZm:()=>y.E,Rsn:()=>Pt.R,lZ_:()=>zs.l,ebG:()=>Ks.e,eHD:()=>xs.e,tco:()=>gr.t,lrV:()=>We.l,lS2:()=>_e.l,K7n:()=>at.K,etH:()=>N.e,cGx:()=>Qr.c,_s:()=>un._,msM:()=>ks.m,Z7I:()=>fe.Z,ppr:()=>Ee.p,tHk:()=>Za.tH,XwR:()=>Za.Xw,DaU:()=>Na.D,Kur:()=>Io.K,aaz:()=>Oo.a,sN5:()=>Ur.s,AVJ:()=>vn.A,yKR:()=>Ua.y,ep7:()=>Ra,D0$:()=>ge.D,ED_:()=>va,nA8:()=>Ze,nVY:()=>Un.n,PgM:()=>ys.P,gHy:()=>Wn.gH,wIj:()=>Wn.wI,IBq:()=>bs.I,ef9:()=>jn.e,ZYI:()=>qt.Z,mKT:()=>nt.m,lVW:()=>In.l,i7I:()=>Ds.i,Vpd:()=>yt,_I2:()=>Ln._,TS0:()=>eo,Hdp:()=>Jr.H,io8:()=>Jr.i,ovZ:()=>ba,MTY:()=>dn,IK5:()=>jo,xA9:()=>Fn.x,GyY:()=>Ca.Gy,Int:()=>r.I,K0:()=>w.K,w4Q:()=>la.w,IP5:()=>$a.I,CeB:()=>$s.C,IjS:()=>Lr.I,c2B:()=>As.c,e8d:()=>ws.e,KYK:()=>Ha.K,r0T:()=>de.r,pde:()=>bt.p,eyo:()=>Es.e,jDF:()=>Tt.j,BJ$:()=>wa.B,OoN:()=>Ea.O,Z7z:()=>Ro.Z,JU7:()=>ts.J,rRI:()=>so,OYG:()=>n.O,s$2:()=>Vn.s,N_E:()=>Bt.N,z9$:()=>se.z9,B8B:()=>ut.B,GmG:()=>J.G,_ae:()=>oe._,pH9:()=>co.p,W1t:()=>An.W,rXV:()=>qn.r,Drp:()=>cs.D,aFV:()=>ht.a,rQ0:()=>ft.r,EOs:()=>Ye.EO,OHP:()=>Te,JXd:()=>De.J,wEe:()=>Ye.wE,$sz:()=>Ye.$s,YO7:()=>Ye.YO,KFt:()=>Qs.KF,dAS:()=>Ge.d,dKS:()=>be.d,NRL:()=>fn.NR,oQQ:()=>yn.I,_wj:()=>Nr._,XFg:()=>wn.XF,e4W:()=>wn.e4,$sV:()=>Br.$,Bjr:()=>La.B,AMh:()=>Q.A,IE3:()=>H.I,ZLI:()=>ee.ZL,qB2:()=>ee.qB,Xjo:()=>ot.X,JBW:()=>ca.J,zWQ:()=>nr.z,a0s:()=>st.a,F16:()=>Jn.F,m3b:()=>He.m,cCp:()=>Ve.cC,NBP:()=>vs.N,IUm:()=>gs.I,L47:()=>Gs.L4,L44:()=>rn.L4,lpq:()=>tn.lp,YAX:()=>_a.Y,Y4n:()=>Kn.Y,sYD:()=>us.s,oyW:()=>Gn.o,Lrm:()=>Dt.L,a$h:()=>ps.a,l6P:()=>Qs.l6,KAb:()=>Qs.KA,o5c:()=>Ps.o5,Dpi:()=>ce.Dp,o0L:()=>xe.o,tJM:()=>xe.t,pMY:()=>ma.p,o95:()=>on.o,gNl:()=>on.g,KHN:()=>xn.K,Bd:()=>Tr.B,u3P:()=>Je.u,nfS:()=>Pn.n,Apm:()=>Bn.A,$xS:()=>$n.$,OW$:()=>Ls.O,y$y:()=>cn.y,BJc:()=>Cn.B,SPA:()=>ye.S,dOG:()=>Ha.d,jDu:()=>vt.j,ozo:()=>zn.o,JSC:()=>Bs.J,qtX:()=>Z.q,XIK:()=>it.X,bwN:()=>Qt,U05:()=>Nn.U,vwO:()=>Ke.v,LYX:()=>ze.L,um3:()=>It.u,EYj:()=>_t.E,fs1:()=>zt.f,YqK:()=>Wt.Y,R3l:()=>Ue.R,xSz:()=>Me.xS,bYj:()=>as.b,fD2:()=>Ce.f,$64:()=>Me.$6,ZOC:()=>mo,U7r:()=>Ae.U,XNj:()=>Js.X,Gff:()=>X.G,IBt:()=>hs.I,Uhs:()=>fa.U,m_M:()=>P.m,TkQ:()=>pi,xlH:()=>Ao.xl,piP:()=>Mo.pi,ZCE:()=>lo.Z,eEE:()=>io.e,pKo:()=>Se.p,nys:()=>ja.n,iyp:()=>oa.i,gWJ:()=>Ca.gW,sMJ:()=>ds,ipx:()=>Qs.ip,KUk:()=>Xn.KU,tZ2:()=>Ut.t,MJh:()=>nn.M,SdN:()=>ln.S,nRt:()=>mt,oNG:()=>Qn.o,l69:()=>we.l,nuT:()=>Os.n,_XZ:()=>kr._,jnT:()=>Uo,Myc:()=>sa,myI:()=>se.my,I1_:()=>Zt.I1,cbf:()=>Ve.cb,gso:()=>na.g,Hut:()=>Ts.H,lBN:()=>To.l,na7:()=>bt.n,gF8:()=>ee.gF,Jq4:()=>Vs.J,rLY:()=>we.r,ti9:()=>jr.t,YnM:()=>Xr,JcZ:()=>ho,mYT:()=>qs,aLN:()=>v.A,Xb:()=>ms.Xb,_$q:()=>Zt._$,glJ:()=>Zt.gl,IyU:()=>Xo,d2s:()=>wn.d2,hrX:()=>So.h,OOt:()=>rt.O,Xc0:()=>Za.Xc});var t=e(90090),n=e(91634),s=e(74848),a=e(28581),r=e(14578);const g=xt=>{const Et=xt.selectProps.menuIsOpen;return(0,s.jsx)(a.c.IndicatorsContainer,{...xt,children:(0,s.jsx)(r.I,{name:Et?"angle-up":"angle-down",style:{marginTop:"7px"}})})},i=g,l=xt=>{const{children:Et}=xt;return(0,s.jsx)(a.c.NoOptionsMessage,{...xt,children:(0,s.jsx)("div",{className:"gf-form-select-box__desc-option",children:(0,s.jsx)("div",{className:"gf-form-select-box__desc-option__body",children:Et})})})},d=l;var c=e(46942),h=e.n(c),o=e(96540),m=e(46005),u=e(8539),p=e(66963),f=e(60578),y=e(40276),x=e(62235),v=e(23731),P=e(56034);const E=xt=>{const{children:Et,isSelected:At,data:Jt}=xt;return(0,s.jsx)(a.c.Option,{...xt,children:(0,s.jsxs)("div",{className:"gf-form-select-box__desc-option",children:[Jt.imgUrl&&(0,s.jsx)("img",{className:"gf-form-select-box__desc-option__img",src:Jt.imgUrl,alt:""}),(0,s.jsxs)("div",{className:"gf-form-select-box__desc-option__body",children:[(0,s.jsx)("div",{children:Et}),Jt.description&&(0,s.jsx)("div",{className:"gf-form-select-box__desc-option__desc",children:Jt.description})]}),At&&(0,s.jsx)(r.I,{name:"check","aria-hidden":"true"})]})})},D=null;var C=e(32196),b=e(3911),T=e(40845);const S=(0,b.N)(xt=>({header:(0,C.css)({display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%",borderBottom:`1px solid ${xt.colors.background.secondary}`,"&:hover":{color:xt.colors.text.maxContrast}}),label:(0,C.css)({flexGrow:1}),icon:(0,C.css)({paddingRight:"2px"})}));class O extends o.PureComponent{constructor(){super(...arguments),this.state={expanded:!1},this.onToggleChildren=()=>{this.setState(Et=>({expanded:!Et.expanded}))}}componentDidMount(){if(this.props.data.expanded)this.setState({expanded:!0});else if(this.props.selectProps&&this.props.selectProps.value){const{value:Et}=this.props.selectProps.value;Et&&this.props.options.some(At=>At.value===Et)&&this.setState({expanded:!0})}}componentDidUpdate(Et){Et.selectProps.inputValue!==""&&this.setState({expanded:!0})}render(){const{children:Et,label:At,theme:Jt}=this.props,{expanded:Xt}=this.state,$t=S(Jt);return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:$t.header,onClick:this.onToggleChildren,role:"presentation",children:[(0,s.jsx)("span",{className:$t.label,children:At}),(0,s.jsx)(r.I,{className:$t.icon,name:Xt?"angle-up":"angle-down"})]}),Xt&&Et]})}}const M=(0,T.cV)(O),I=xt=>(0,s.jsx)(a.c.MenuList,{...xt,children:(0,s.jsx)(y.E,{autoHide:!1,autoHeightMax:"inherit",children:xt.children})});class L extends o.PureComponent{static{this.contextType=f.D}static{this.defaultProps={className:"",isDisabled:!1,isSearchable:!0,isClearable:!1,isMulti:!1,openMenuOnFocus:!1,autoFocus:!1,isLoading:!1,backspaceRemovesValue:!0,maxMenuHeight:300,tabSelectsValue:!0,allowCustomValue:!1,components:{Option:E,SingleValue:x.K,IndicatorsContainer:i,MenuList:I,Group:M}}}render(){const{defaultValue:Et,getOptionLabel:At,getOptionValue:Jt,onChange:Xt,options:$t,placeholder:gn,width:mn,value:Tn,className:Dn,isDisabled:kn,isLoading:Us,isSearchable:ls,isClearable:Ns,backspaceRemovesValue:xa,isMulti:Oa,autoFocus:ia,openMenuOnFocus:rr,onBlur:Qa,maxMenuHeight:or,noOptionsMessage:Ya,isOpen:vr,components:aa,tooltipContent:_n,tabSelectsValue:ra,onCloseMenu:ns,onOpenMenu:ga,allowCustomValue:da,formatCreateLabel:pa,"aria-label":ua}=this.props;let Sa="";mn&&(Sa="width-"+mn);let Ba=m.Ay;const hr={};da&&(Ba=p.A,hr.formatCreateLabel=pa??(yr=>yr));const sr=h()("gf-form-input","gf-form-input--form-dropdown",Sa,Dn),Sr={...L.defaultProps.components,...aa};return(0,s.jsx)(j,{onCloseMenu:ns,onOpenMenu:ga,tooltipContent:_n,isOpen:vr,children:(yr,xo)=>(0,s.jsx)(Ba,{captureMenuScroll:!1,classNamePrefix:"gf-form-select-box",className:sr,components:Sr,defaultValue:Et,value:Tn,getOptionLabel:At,getOptionValue:Jt,menuShouldScrollIntoView:!1,isSearchable:ls,onChange:Xt,options:$t,placeholder:gn||"Choose",styles:(0,v.A)(this.context),isDisabled:kn,isLoading:Us,isClearable:Ns,autoFocus:ia,onBlur:Qa,openMenuOnFocus:rr,maxMenuHeight:or,noOptionsMessage:Ya,isMulti:Oa,backspaceRemovesValue:xa,menuIsOpen:vr,onMenuOpen:yr,onMenuClose:xo,tabSelectsValue:ra,"aria-label":ua,...hr})})}}class B extends o.PureComponent{static{this.contextType=f.D}static{this.defaultProps={className:"",components:{},loadingMessage:()=>"Loading...",isDisabled:!1,isClearable:!1,isMulti:!1,isSearchable:!0,backspaceRemovesValue:!0,autoFocus:!1,openMenuOnFocus:!1,maxMenuHeight:300}}render(){const{defaultValue:Et,getOptionLabel:At,getOptionValue:Jt,onChange:Xt,placeholder:$t,width:gn,value:mn,className:Tn,loadOptions:Dn,defaultOptions:kn,isLoading:Us,loadingMessage:ls,noOptionsMessage:Ns,isDisabled:xa,isSearchable:Oa,isClearable:ia,backspaceRemovesValue:rr,autoFocus:Qa,onBlur:or,openMenuOnFocus:Ya,maxMenuHeight:vr,isMulti:aa,tooltipContent:_n,onCloseMenu:ra,onOpenMenu:ns,isOpen:ga}=this.props;let da="";gn&&(da="width-"+gn);const pa=h()("gf-form-input","gf-form-input--form-dropdown",da,Tn);return(0,s.jsx)(j,{onCloseMenu:ra,onOpenMenu:ns,tooltipContent:_n,isOpen:ga,children:(ua,Sa)=>(0,s.jsx)(u.A,{captureMenuScroll:!1,classNamePrefix:"gf-form-select-box",className:pa,components:{Option:E,SingleValue:x.K,IndicatorsContainer:i,NoOptionsMessage:d},defaultValue:Et,value:mn,getOptionLabel:At,getOptionValue:Jt,menuShouldScrollIntoView:!1,onChange:Xt,loadOptions:Dn,isLoading:Us,defaultOptions:kn,placeholder:$t||"Choose",styles:(0,v.A)(this.context),loadingMessage:ls,noOptionsMessage:Ns,isDisabled:xa,isSearchable:Oa,isClearable:ia,autoFocus:Qa,onBlur:or,openMenuOnFocus:Ya,maxMenuHeight:vr,isMulti:aa,backspaceRemovesValue:rr})})}}class j extends o.PureComponent{constructor(){super(...arguments),this.state={isOpenInternal:!1},this.onOpenMenu=()=>{const{onOpenMenu:Et}=this.props;Et&&Et(),this.setState({isOpenInternal:!0})},this.onCloseMenu=()=>{const{onCloseMenu:Et}=this.props;Et&&Et(),this.setState({isOpenInternal:!1})}}render(){const{children:Et,isOpen:At,tooltipContent:Jt}=this.props,{isOpenInternal:Xt}=this.state;let $t;return(Xt||At)&&($t=!1),Jt?(0,s.jsx)(P.m,{show:$t,content:Jt,placement:"bottom",children:(0,s.jsx)("div",{children:Et(this.onOpenMenu,this.onCloseMenu)})}):(0,s.jsx)("div",{children:Et(this.onOpenMenu,this.onCloseMenu)})}}const A=null;var K=e(2543);class W extends o.PureComponent{constructor(){super(...arguments),this.state={id:(0,K.uniqueId)()},this.internalOnChange=Et=>{Et.stopPropagation(),this.props.onChange(Et)}}render(){const{labelClass:Et="",switchClass:At="",label:Jt,checked:Xt,disabled:$t,transparent:gn,className:mn,theme:Tn,tooltip:Dn,tooltipPlacement:kn}=this.props,Us=F(Tn),ls=this.state.id,Ns=`gf-form-label ${Et} ${gn?"gf-form-label--transparent":""} pointer`,xa=(0,C.cx)(Us.switch,At,{[Us.switchTransparent]:gn});return(0,s.jsx)("div",{className:Us.container,children:(0,s.jsxs)("label",{htmlFor:ls,className:(0,C.cx)("gf-form",Us.labelContainer,mn),children:[Jt&&(0,s.jsxs)("div",{className:Ns,children:[Jt,Dn&&(0,s.jsx)(P.m,{placement:kn||"auto",content:Dn,theme:"info",children:(0,s.jsx)(r.I,{name:"info-circle",size:"sm",style:{marginLeft:"10px"}})})]}),(0,s.jsxs)("div",{className:xa,children:[(0,s.jsx)("input",{disabled:$t,id:ls,type:"checkbox",checked:Xt,onChange:this.internalOnChange}),(0,s.jsx)("span",{className:Us.slider})]})]})})}}const U=(0,T.cV)(W),F=xt=>{const Et=(0,C.css)({background:xt.v1.palette.gray1,borderRadius:xt.shape.radius.pill,height:"16px",width:"32px",display:"block",position:"relative","&::before":{position:"absolute",content:"''",height:"12px",width:"12px",left:"2px",top:"2px",background:xt.components.input.background,transition:"0.4s",borderRadius:xt.shape.radius.circle,boxShadow:xt.shadows.z1}});return{container:(0,C.css)({display:"flex",flexShrink:0}),labelContainer:(0,C.css)({display:"flex",cursor:"pointer",marginRight:xt.spacing(.5)}),switch:(0,C.css)({display:"flex",position:"relative",width:"56px",height:xt.spacing(4),background:xt.components.input.background,border:`1px solid ${xt.components.input.borderColor}`,borderRadius:xt.shape.radius.default,alignItems:"center",justifyContent:"center",input:{opacity:0,width:0,height:0},[`input:checked + .${Et}`]:{background:xt.colors.primary.main},[`input:checked + .${Et}::before`]:{transform:"translateX(16px)"}}),switchTransparent:(0,C.css)({background:"transparent",border:0,width:"40px"}),slider:Et}};var V=e(56286),w=e(29158),z=e(82702),N=e(91605),H=e(95868),Q=e(13840),X=e(60782),ee=e(17464),Z=e(60734),q=e(10534),ae=e(3988),k=e(16401),se=e(55852),te=e(58898),ne=e(30958);const le=xt=>{const{onChange:Et,className:At,loadData:Jt,icon:Xt,buttonProps:$t,hideDownIcon:gn,variant:mn,disabled:Tn,...Dn}=xt,kn=(0,T.of)(re),Us=(0,T.of)(ne.T);let ls=xt.children;return gn||(ls=[xt.children,(0,s.jsx)(r.I,{name:"angle-down",className:kn.icons.right},"down-icon")]),(0,s.jsx)(k.A,{onChange:(0,te.k)(Et),loadData:(0,te.W)(Jt),dropdownClassName:(0,C.cx)(Us.dropdown,kn.popup),...Dn,expandIcon:null,children:(0,s.jsx)(se.$n,{icon:Xt,disabled:Tn,variant:mn,...$t??{},children:ls})})};le.displayName="ButtonCascader";const re=xt=>({popup:(0,C.css)({label:"popup",zIndex:xt.zIndex.dropdown}),icons:{right:(0,C.css)({margin:"1px 0 0 4px"}),left:(0,C.css)({margin:"-1px 4px 0 0"})}});var de=e(32982),oe=e(39558),J=e(57514),ce=e(83598),pe=e(99128),xe=e(70104),fe=e(41670),Ee=e(69529),Se=e(2056),ye=e(42734),Ve=e(11134),Me=e(15666),Ce=e(3799),Ue=e(66070),Ae=e(20333),we=e(15648),We=e(56181),_e=e(98239),at=e(63383),ut=e(33552),Tt=e(48840),It=e(79924),ge=e(88575);const Ie=(0,o.memo)(()=>{const xt=(0,T.of)(ue);return(0,s.jsxs)("div",{className:xt.ellipsis,children:[(0,s.jsx)("span",{className:xt.firstDot,children:"."}),(0,s.jsx)("span",{className:xt.secondDot,children:"."}),(0,s.jsx)("span",{className:xt.thirdDot,children:"."})]})});Ie.displayName="EllipsisAnimated";const ue=xt=>({ellipsis:(0,C.css)({display:"inline"}),firstDot:(0,C.css)({[xt.transitions.handleMotion("no-preference","reduce")]:{animation:`${me} 2s linear infinite`}}),secondDot:(0,C.css)({[xt.transitions.handleMotion("no-preference","reduce")]:{animation:`${Pe} 2s linear infinite`}}),thirdDot:(0,C.css)({[xt.transitions.handleMotion("no-preference","reduce")]:{animation:`${Ne} 2s linear infinite`}})}),me=(0,C.keyframes)`
  0% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,Pe=(0,C.keyframes)`
  0% {
    opacity: 0;
  }
  21% {
    opacity: 0.5;
  }
  22% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,Ne=(0,C.keyframes)`
  0% {
    opacity: 0;
  }
  43% {
    opacity: 0.5;
  }
  44% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,Fe=2*1e3;function Be(xt){const{invalid:Et,loading:At,onFinishChange:Jt,saveErrorMessage:Xt="Error saving this value",error:$t,children:gn,disabled:mn,...Tn}=xt,[Dn,kn]=o.useState({isLoading:!1,showSuccess:!1,showError:Et}),Us=(0,o.useRef)(null);o.useEffect(()=>{let ia;if(Dn.showSuccess){const rr=Dn.showError?0:Fe;ia=setTimeout(()=>{kn({...Dn,showSuccess:!1})},rr)}return()=>{window.clearTimeout(ia)}},[Dn]);const ls=(0,o.useCallback)(ia=>{Et||(kn({...Dn,isLoading:!0,showSuccess:!1}),Jt(ia).then(()=>{kn({isLoading:!1,showSuccess:!0,showError:!1})}).catch(()=>{kn({...Dn,isLoading:!1,showError:!0})}))},[Et,Dn,Jt]),Ns=(0,o.useMemo)(()=>(0,K.debounce)(ls,600,{leading:!1}),[ls]),xa=Et||Dn.showError||void 0,Oa=(0,T.of)(he);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ge.D,{...Tn,loading:At||void 0,invalid:xa,disabled:mn,error:$t||Dn.showError&&Xt,ref:Us,className:Oa.widthFitContent,children:o.cloneElement(gn(ia=>{Ns(ia)}))}),Dn.isLoading&&(0,s.jsxs)(de.r,{referenceElement:Us.current,placement:"right",children:["Saving ",(0,s.jsx)(Ie,{})]}),Dn.showSuccess&&(0,s.jsx)(de.r,{suffixIcon:"check",referenceElement:Us.current,placement:"right",children:"Saved!"})]})}Be.displayName="AutoSaveField";const he=()=>({widthFitContent:(0,C.css)({width:"fit-content"})});var be=e(19384),Ke=e(78369),ze=e(64149),nt=e(92174),tt=e(96374),ot=e(20084),gt=e(32372),He=e(85828),et=e(19716),rt=e(99544),ht=e(37390),ft=e(29473),De=e(25897);const Te=({children:xt})=>{const Et=(0,T.of)(Oe);return(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:Et.header,children:(0,s.jsx)("div",{className:Et.content,children:xt})})})},Oe=xt=>({header:(0,C.css)({display:"flex",margin:xt.spacing(0,0,3,0)}),content:(0,C.css)({flexGrow:1})});var Ye=e(71678),Ge=e(95247),Je=e(67570),it=e(77093),St=e(72436),zt=e(21744);class Kt extends o.PureComponent{constructor(Et){super(Et),this.readCSV=(0,K.debounce)(()=>{const{config:Xt}=this.props,{text:$t}=this.state;this.setState({data:(0,St.Jh)($t,{config:Xt})})},150),this.onTextChange=Xt=>{this.setState({text:Xt.target.value})};const{text:At,config:Jt}=Et;this.state={text:At,data:(0,St.Jh)(At,{config:Jt})}}componentDidUpdate(Et,At){const{text:Jt}=this.state;(Jt!==At.text||this.props.config!==Et.config)&&this.readCSV(),this.props.text!==Et.text&&this.props.text!==Jt&&this.setState({text:this.props.text}),this.state.data!==At.data&&this.props.onSeriesParsed(this.state.data,this.state.text)}render(){const{width:Et,height:At,theme:Jt}=this.props,{data:Xt}=this.state,$t=an(Jt);return(0,s.jsxs)("div",{className:$t.tableInputCsv,children:[(0,s.jsx)(zt.f,{style:{width:Et,height:At},placeholder:"Enter CSV here...",value:this.state.text,onChange:this.onTextChange,className:$t.textarea}),Xt&&(0,s.jsx)("footer",{className:$t.footer,children:Xt.map((gn,mn)=>(0,s.jsxs)("span",{children:["Rows:",gn.length,", Columns:",gn.fields.length," \xA0",(0,s.jsx)(r.I,{name:"check-circle"})]},mn))})]})}}const Qt=(0,T.cV)(Kt);Qt.displayName="TableInputCSV";const an=(0,b.N)(xt=>({tableInputCsv:(0,C.css)({position:"relative"}),textarea:(0,C.css)({height:"100%",width:"100%"}),footer:(0,C.css)({position:"absolute",bottom:"15px",right:"15px",border:"1px solid #222",background:xt.colors.success.main,padding:`1px ${xt.spacing(.5)}`,fontSize:"80%"})}));var Nn=e(63021),zn=e(40675),Yn=e(13544),ss=e(53402);const ds=(0,o.forwardRef)(({label:xt,active:Et,icon:At,counter:Jt,className:Xt,suffix:$t,onChangeTab:gn,href:mn,...Tn},Dn)=>{const kn=(0,T.of)(Ms),Us=()=>(0,s.jsxs)(s.Fragment,{children:[At&&(0,s.jsx)(r.I,{name:At}),xt,typeof Jt=="number"&&(0,s.jsx)(ss.p,{value:Jt}),$t&&(0,s.jsx)($t,{className:kn.suffix})]}),ls=(0,C.cx)(kn.link,Et&&kn.activeStyle);return(0,s.jsx)("a",{href:mn,className:ls,...Tn,onClick:gn,"aria-label":Tn["aria-label"]||Yn.Tp.components.Tab.title(xt),role:"tab","aria-selected":Et,ref:Dn,children:Us()})});ds.displayName="Tab";const Ms=xt=>({link:(0,C.css)({padding:"6px 12px",display:"block",height:"100%",cursor:"pointer",position:"relative",color:xt.colors.text.primary,svg:{marginRight:xt.spacing(1)},"&:hover, &:focus":{textDecoration:"underline"}}),activeStyle:(0,C.css)({label:"activeTabStyle",color:xt.colors.text.maxContrast,overflow:"hidden","&::before":{display:"block",content:'" "',position:"absolute",left:0,width:"4px",bottom:"2px",top:"2px",borderRadius:xt.shape.radius.default,backgroundImage:"linear-gradient(0deg, #f05a28 30%, #fbca0a 99%)"}}),suffix:(0,C.css)({marginLeft:xt.spacing(1)})});var Bs=e(40980),gs=e(44522),Zn=e(37494),Ls=e(5926),Ln=e(95164),Hn=e(97696),Qn=e(69503);const mt=({content:xt,position:Et,offset:At})=>{const Jt=(0,T.of)(Yt);return Et?(0,s.jsx)(ee.ZL,{className:Jt.portal,children:(0,s.jsx)(Qn.o,{position:Et,offset:At||{x:0,y:0},children:xt})}):null};mt.displayName="VizTooltip";const Yt=()=>({portal:(0,C.css)({position:"absolute",top:0,left:0,pointerEvents:"none",width:"100%",height:"100%"})});var on=e(3139),ln=e(12509),fn=e(91052),yn=e(89963),wn=e(79041),Xn=e(67266),xn=e(29995),Ut=e(96516),nn=e(34375),hn=e(42418);class dn extends o.Component{constructor(Et){super(Et),this.onSeriesToggle=this.onSeriesToggle.bind(this),this.state={hiddenSeries:[],toggledSeries:Et.series}}componentDidUpdate(Et){const{series:At}=this.props;(0,K.isEqual)(Et.series,At)||this.setState({hiddenSeries:[],toggledSeries:At})}onSeriesToggle(Et,At){const{series:Jt,onHiddenSeriesChanged:Xt}=this.props,{hiddenSeries:$t}=this.state;if(At.ctrlKey||At.metaKey||At.shiftKey){const Dn=$t.indexOf(Et)>-1?$t.filter(Us=>Us!==Et):$t.concat([Et]),kn=Jt.map(Us=>({...Us,isVisible:Dn.indexOf(Us.label)===-1}));this.setState({hiddenSeries:Dn,toggledSeries:kn},()=>Xt?Xt(Dn):void 0);return}const gn=Jt.map(Dn=>Dn.label),mn=$t.length+1===gn.length?[]:(0,K.difference)(gn,[Et]),Tn=Jt.map(Dn=>({...Dn,isVisible:mn.indexOf(Dn.label)===-1}));this.setState({hiddenSeries:mn,toggledSeries:Tn},()=>Xt?Xt(mn):void 0)}render(){const{children:Et}=this.props,{toggledSeries:At}=this.state;return Et({onSeriesToggle:this.onSeriesToggle,toggledSeries:At})}}var Sn=e(82762),es=e(57418),Pt=e(14689);function Ze({links:xt}){const Et=(0,T.of)(lt);if(xt.length===1)return(0,s.jsx)(Pt.R,{link:xt[0]});const At=xt.filter(Xt=>Xt.target==="_blank"),Jt=xt.filter(Xt=>Xt.target==="_self");return(0,s.jsxs)(s.Fragment,{children:[Jt.map((Xt,$t)=>(0,s.jsx)(Pt.R,{link:Xt},$t)),(0,s.jsxs)("div",{className:Et.wrapper,children:[(0,s.jsx)("p",{className:Et.externalLinksHeading,children:"External links"}),At.map((Xt,$t)=>(0,s.jsxs)("a",{href:Xt.href,target:Xt.target,className:Et.externalLink,children:[(0,s.jsx)(r.I,{name:"external-link-alt"}),Xt.title]},$t))]})]})}const lt=xt=>({wrapper:(0,C.css)({flexBasis:"150px",width:"100px",marginTop:xt.spacing(1)}),externalLinksHeading:(0,C.css)({color:xt.colors.text.secondary,fontWeight:xt.typography.fontWeightRegular,fontSize:xt.typography.size.sm,margin:0}),externalLink:(0,C.css)({color:xt.colors.text.link,fontWeight:xt.typography.fontWeightRegular,display:"block",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis","&:hover":{textDecoration:"underline"},div:{marginRight:xt.spacing(1)}})}),yt=({className:xt,children:Et})=>{const At=(0,T.of)(Nt);return(0,s.jsx)("div",{className:(0,C.cx)(At,xt),children:Et})},Nt=()=>(0,C.css)({display:"flex",button:{flexGrow:1,justifyContent:"center"},"> *":{flexGrow:1},label:{flexGrow:1,textAlign:"center"}});var wt=e(8866),Zt=e(63250),pn=e(76442),On=e(28122),An=e(38138),qn=e(59093),cs=e(64539),Os=e(51686),xs=e(64919),zs=e(64078),Ks=e(59796),ma=e(94536),la=e(37166),Ua=e(29678);const Ra=(0,o.memo)((0,o.forwardRef)(({title:xt,featureState:Et,...At},Jt)=>{const Xt=(0,T.of)(Pa),$t=Et?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:Xt.badge,children:(0,s.jsx)(Ua.y,{featureState:Et})}),(0,s.jsx)("h3",{children:xt})]}):(0,s.jsx)("h3",{children:xt});return(0,s.jsx)(la.w,{branded:!0,title:$t,urlTitle:"Read documentation",ref:Jt,...At})}));Ra.displayName="FeatureInfoBox";const Pa=xt=>({badge:(0,C.css)({marginBottom:xt.spacing(1)})});var wa=e(24022),Ea=e(44533),Za=e(66602),Na=e(52446),gr=e(91409),cr=e(11184),Ha=e(15292),$a=e(14186);function Xa({options:xt,onOptionsChange:Et}){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h3",{className:"page-heading",children:"Alerting"}),(0,s.jsx)("div",{className:"gf-form-group",children:(0,s.jsx)("div",{className:"gf-form-inline",children:(0,s.jsx)("div",{className:"gf-form",children:(0,s.jsx)($a.I,{labelWidth:29,label:"Manage alert rules in Alerting UI",disabled:xt.readOnly,tooltip:"Manage alert rules for this data source. To manage other alerting resources, add an Alertmanager data source.",children:(0,s.jsx)(Ha.K,{value:xt.jsonData.manageAlerts!==!1,onChange:At=>Et({...xt,jsonData:{...xt.jsonData,manageAlerts:At.currentTarget.checked}})})})})})})]})}var _a=e(17081),vt=e(95180),kt=e(28623),cn=e(62930),vn=e(31511),Pn=e(72960),Kn=e(38401),us=e(83684),Gn=e(57752),ps=e(13102),Dt=e(64765),un=e(87978),Bn=e(77014),Jn=e(47097),In=e(51253),ms=e(87266),Es=e(16504),Cs=e(19727),hs=e(27746),fa=e(15068),oa=e(51986),na=e(84349),Bt=e(50720),Wt=e(72109),_t=e(94753),sn=e(90613),Cn=e(67061),Fn=e(71259),$n=e(68402),ts=e(60029),Vn=e(17408),Un=e(84167),ys=e(72093),ws=e(63056),As=e(76892),$s=e(39268),Hs=e(49785);const va=({name:xt,control:Et,children:At,...Jt})=>{const{fields:Xt,append:$t,prepend:gn,remove:mn,swap:Tn,move:Dn,insert:kn}=(0,Hs.jz)({control:Et,name:xt,...Jt});return At({fields:Xt,append:$t,prepend:gn,remove:mn,swap:Tn,move:Dn,insert:kn})};var Qs=e(90182),Ps=e(12681),Vs=e(88824),Js=e(62883),Ca=e(66864),Fa=e(39938),nr=e(94354),ca=e(79569),st=e(83186),bt=e(10354),Mt=e(51440),qt=e(67647),rn=e(9226),tn=e(58724),Rn=e(10880),jn=e(73546),Wn=e(37270),bs=e(73569),as=e(54230),vs=e(5308),Ts=e(10860),is=e(81507),Ds=e(9286),fs=e(9261),ks=e(83122),La=e(98624),ja=e(99635),br=e(12942),Lr=e(38894),Qr=e(25994),To=e(69144),So=e(21633),jr=e(52198),Gs=e(52622),io=e(51336),Mo=e(30501),lo=e(81297),Br=e(24182),Oo=e(78226),co=e(6967),kr=e(97620),Ao=e(38761),Io=e(68268),Ro=e(23117),Ur=e(52811),Tr=e(88895),Ar=e(54438),Nr=e(52494),Wr=e(34796),Yr=e.n(Wr),pr=e(61443),Jr=e(33083),qa=e(83195),Ga=e(28240),uo=e(72724),dr=e(42994);const Lo=(xt,Et)=>{let At=0,Jt=xt.values.length-1,Xt;for(;;){if(At>Jt)return Math.max(Jt,0);Xt=Math.floor((At+Jt)/2);const $t=xt.values[Xt];if($t===Et)return Xt;$t&&$t<Et?At=Xt+1:Jt=Xt-1}},Zr=(xt,Et,At,Jt)=>{let Xt,$t,gn,mn,Tn;const Dn=[];let kn,Us;for(Xt=0;Xt<xt.length;Xt++){$t=xt[Xt];const ls=Et[Xt];gn=Lo(ls,At),mn=At-ls.values[gn],Tn=ls.values[gn],(kn===void 0||mn>=0&&(mn<kn||kn<0)||mn<0&&mn>kn)&&(kn=mn,Us=ls.display?(0,qa.cN)(ls.display(Tn)):Tn);const Ns=$t.display($t.values[gn]);Dn.push({value:(0,qa.cN)(Ns),datapointIndex:gn,seriesIndex:Xt,color:Ns.color,label:(0,Ga.Ct)($t),time:ls.display?(0,qa.cN)(ls.display(Tn)):Tn})}return{results:Dn,time:Us}},Xr=(xt,Et)=>(0,uo.LE)(xt,{format:Et?.options?.timeformat,timeZone:Et?.options?.timezone}),ho=(xt,Et,At)=>{if(Et&&At&&xt){const Jt=At-Et,Xt=Jt/xt/1e3,$t=86400010,gn=31536e6;return Xt<=10?dr.WC.interval.millisecond:Xt<=45?dr.WC.interval.second:Jt<=$t?dr.WC.interval.minute:Xt<=8e4?dr.WC.interval.hour:Jt<=gn?dr.WC.interval.day:Xt<=31536e3?dr.WC.interval.month:dr.WC.interval.year}return dr.WC.interval.minute},_r=({dimensions:xt,activeDimensions:Et,pos:At,timeZone:Jt})=>{let Xt=null;if(Et.xAxis===null)return null;Et.yAxis&&(Xt=Et.yAxis[0]);const $t=Et.xAxis[1]?(0,pr.WK)(xt.xAxis,Et.xAxis[0],Et.xAxis[1]):At.x,gn=Zr(xt.yAxis.columns,xt.xAxis.columns,$t,Jt),mn=gn.time,Tn=gn.results.map((Dn,kn)=>({color:Dn.color,label:Dn.label,value:Dn.value,isActive:Xt===kn}));return(0,s.jsx)(on.o,{series:Tn,timestamp:mn})};_r.displayName="MultiModeGraphTooltip";const qr=({dimensions:xt,activeDimensions:Et,timeZone:At})=>{if(Et.yAxis===null||Et.yAxis[1]===void 0||Et.xAxis===null||Et.xAxis[1]===void 0)return null;const Jt=(0,pr.WK)(xt.xAxis,Et.xAxis[0],Et.xAxis[1]),Xt=(0,pr.P4)(xt.xAxis,Et.xAxis[0]),$t=Xt.display?(0,qa.cN)(Xt.display(Jt)):Jt,gn=(0,pr.P4)(xt.yAxis,Et.yAxis[0]),mn=(0,pr.WK)(xt.yAxis,Et.yAxis[0],Et.yAxis[1]),Tn=gn.display,Dn=Tn(mn);return(0,s.jsx)(on.o,{series:[{color:Dn.color,label:(0,Ga.Ct)(gn),value:(0,qa.cN)(Dn)}],timestamp:$t})};qr.displayName="SingleModeGraphTooltip";const fo=({mode:xt=Gs.$N.Single,dimensions:Et,activeDimensions:At,pos:Jt,timeZone:Xt})=>!At||!At.xAxis?null:xt==="single"?(0,s.jsx)(qr,{dimensions:Et,activeDimensions:At,timeZone:Xt}):(0,s.jsx)(_r,{dimensions:Et,activeDimensions:At,pos:Jt,timeZone:Xt});fo.displayName="GraphTooltip";class eo extends o.PureComponent{constructor(){super(...arguments),this.state={isTooltipVisible:!1,isContextVisible:!1},this.element=null,this.$element=null,this.onPlotSelected=(Et,At)=>{const{onHorizontalRegionSelected:Jt}=this.props;Jt&&Jt(At.xaxis.from,At.xaxis.to)},this.onPlotHover=(Et,At,Jt)=>{this.setState({isTooltipVisible:!0,activeItem:Jt,pos:At})},this.onPlotClick=(Et,At,Jt)=>{this.setState({isContextVisible:!0,isTooltipVisible:!1,contextItem:Jt,contextPos:At})},this.renderTooltip=()=>{const{children:Et,series:At,timeZone:Jt}=this.props,{pos:Xt,activeItem:$t,isTooltipVisible:gn}=this.state;let mn;if(!gn||!Xt||At.length===0||(o.Children.forEach(Et,ia=>{if(mn)return;(ia&&ia.type&&(ia.type.displayName||ia.type.name))===mt.displayName&&(mn=ia)}),!mn))return null;const Tn=mn.props,Dn=Tn.mode||"single";if(!$t&&Dn==="single")return null;const kn=Tn.tooltipComponent||fo,Us=$t?$t.series.seriesIndex:0,ls=$t?$t.dataIndex:void 0,Ns={xAxis:[Us,ls],yAxis:$t?[$t.series.seriesIndex,$t.dataIndex]:null},xa={dimensions:{xAxis:(0,pr.r4)("xAxis",At.map(ia=>ia.timeField)),yAxis:(0,pr.r4)("yAxis",At.map(ia=>ia.valueField))},activeDimensions:Ns,pos:Xt,mode:Tn.mode||Gs.$N.Single,timeZone:Jt},Oa=o.createElement(kn,{...xa});return o.cloneElement(mn,{content:Oa,position:{x:Xt.pageX,y:Xt.pageY},offset:{x:10,y:10}})},this.renderContextMenu=()=>{const{series:Et}=this.props,{contextPos:At,contextItem:Jt,isContextVisible:Xt}=this.state;if(!Xt||!At||!Jt||Et.length===0)return null;const $t=Jt?Jt.series.seriesIndex:0,gn=Jt?Jt.dataIndex:void 0,mn={xAxis:[$t,gn],yAxis:Jt?[Jt.series.seriesIndex,Jt.dataIndex]:null},Tn={xAxis:(0,pr.r4)("xAxis",Et.map(ls=>ls.timeField)),yAxis:(0,pr.r4)("yAxis",Et.map(ls=>ls.valueField))},Dn=()=>this.setState({isContextVisible:!1}),kn=()=>({datapoint:Jt.datapoint,dataIndex:Jt.dataIndex,series:Jt.series,seriesIndex:Jt.series.seriesIndex,pageX:At.pageX,pageY:At.pageY}),Us={x:At.pageX,y:At.pageY,onClose:Dn,getContextMenuSource:kn,timeZone:this.props.timeZone,dimensions:Tn,contextDimensions:mn};return(0,s.jsx)(Jr.H,{...Us})},this.getBarWidth=()=>{const{series:Et}=this.props;return Math.min(...Et.map(At=>At.timeStep))}}static{this.defaultProps={showLines:!0,showPoints:!1,showBars:!1,isStacked:!1,lineWidth:1}}componentDidUpdate(Et,At){Et!==this.props&&this.draw()}componentDidMount(){this.draw(),this.element&&(this.$element=Yr()(this.element),this.$element.bind("plotselected",this.onPlotSelected),this.$element.bind("plothover",this.onPlotHover),this.$element.bind("plotclick",this.onPlotClick))}componentWillUnmount(){this.$element&&this.$element.unbind("plotselected",this.onPlotSelected)}getYAxes(Et){return Et.length===0?[{show:!0,min:-1,max:1}]:(0,K.uniqBy)(Et.map(At=>{const Jt=At.yAxis?At.yAxis.index:1,Xt=At.yAxis&&At.yAxis.min&&!isNaN(At.yAxis.min)?At.yAxis.min:null,$t=At.yAxis&&At.yAxis.tickDecimals&&!isNaN(At.yAxis.tickDecimals)?At.yAxis.tickDecimals:null;return{show:!0,index:Jt,position:Jt===1?"left":"right",min:Xt,tickDecimals:$t}}),At=>At.index)}draw(){if(this.element===null)return;const{width:Et,series:At,timeRange:Jt,showLines:Xt,showBars:$t,showPoints:gn,isStacked:mn,lineWidth:Tn,timeZone:Dn,onHorizontalRegionSelected:kn}=this.props;if(!Et)return;const Us=Et/100,ls=Jt.from.valueOf(),Ns=Jt.to.valueOf(),xa=this.getYAxes(At),Oa={legend:{show:!1},series:{stack:mn,lines:{show:Xt,lineWidth:Tn,zero:!1},points:{show:gn,fill:1,fillColor:!1,radius:2},bars:{show:$t,fill:1,barWidth:$t?this.getBarWidth()/1.5:1,zero:!1,lineWidth:Tn},shadowSize:0},xaxis:{timezone:Dn,show:!0,mode:"time",min:ls,max:Ns,label:"Datetime",ticks:Us,timeformat:ho(Us,ls,Ns),tickFormatter:Xr},yaxes:xa,grid:{minBorderMargin:0,markings:[],backgroundColor:null,borderWidth:0,hoverable:!0,clickable:!0,color:"#a1a1a1",margin:{left:0,right:0},labelMarginX:0,mouseActiveRadius:30},selection:{mode:kn?"x":null,color:"#666"},crosshair:{mode:"x"}};try{Yr().plot(this.element,At.filter(ia=>ia.isVisible),Oa)}catch(ia){throw console.error("Graph rendering error",ia,Oa,At),new Error("Error rendering panel")}}render(){const{ariaLabel:Et,height:At,width:Jt,series:Xt}=this.props,$t=Xt.length===0,gn=this.renderTooltip(),mn=this.renderContextMenu();return(0,s.jsxs)("div",{className:"graph-panel","aria-label":Et,children:[(0,s.jsx)("div",{className:"graph-panel__chart",ref:Tn=>this.element=Tn,style:{height:At,width:Jt},onMouseLeave:()=>{this.setState({isTooltipVisible:!1})}}),$t&&(0,s.jsx)("div",{className:"datapoints-warning",children:"No data"}),gn,mn]})}}const go=null,po=(xt,Et=!1,At=!1)=>{const Jt=xt.reduce(($t,gn)=>$t+(gn[1]||0),0)===0,Xt=!xt.reduce(($t,gn)=>$t&&gn[1]!==null,!0);return Et&&Xt||At&&Jt},jo=xt=>{const{series:Et,timeRange:At,width:Jt,height:Xt,showBars:$t,showLines:gn,showPoints:mn,sortLegendBy:Tn,sortLegendDesc:Dn,legendDisplayMode:kn,legendVisibility:Us,placement:ls,onSeriesToggle:Ns,onToggleSort:xa,hideEmpty:Oa,hideZero:ia,isStacked:rr,lineWidth:Qa,onHorizontalRegionSelected:or,timeZone:Ya,children:vr,ariaLabel:aa}=xt,{graphContainer:_n,wrapper:ra,legendContainer:ns}=(0,T.of)(Qe,xt.placement),ga=Et.reduce((da,pa)=>po(pa.data,Oa,ia)?da:da.concat([{label:pa.label,color:pa.color||"",disabled:!pa.isVisible,yAxis:pa.yAxis.index,getDisplayValues:()=>pa.info||[]}]),[]);return(0,s.jsxs)("div",{className:ra,"aria-label":aa,children:[(0,s.jsx)("div",{className:_n,children:(0,s.jsx)(eo,{series:Et,timeRange:At,timeZone:Ya,showLines:gn,showPoints:mn,showBars:$t,width:Jt,height:Xt,isStacked:rr,lineWidth:Qa,onHorizontalRegionSelected:or,children:vr})}),Us&&(0,s.jsx)("div",{className:ns,children:(0,s.jsx)(y.E,{hideHorizontalTrack:!0,children:(0,s.jsx)(Ut.t,{items:ga,displayMode:kn,placement:ls,sortBy:Tn,sortDesc:Dn,onLabelClick:(da,pa)=>{Ns&&Ns(da.label,pa)},onToggleSort:xa})})})]})},Qe=(xt,Et)=>({wrapper:(0,C.css)({display:"flex",flexDirection:Et==="bottom"?"column":"row"}),graphContainer:(0,C.css)({minHeight:"65%",flexGrow:1}),legendContainer:(0,C.css)({padding:"10px 0",maxHeight:Et==="bottom"?"35%":"none"})});var je=e(64423),qe=e(99165),dt=e(85200),Lt=e(1173),Vt=e(11261),Gt=e(69129),en=e(26272),bn=e(16895),En=e(73060);const rs={threshold:(xt,Et,At)=>xt+At,midpoint:(xt,Et,At)=>(xt+Et)/2,plusone:(xt,Et,At)=>xt+1};function js(xt){if(xt.frame.length===0)return xt.frame;let Et=!0,{frame:At,refFieldName:Jt,refFieldPseudoMax:Xt,refFieldPseudoMin:$t,insertMode:gn}=xt;gn||(gn=rs.threshold);const mn=ea(At,Jt);if(mn==null)return At;mn.state={...mn.state,nullThresholdApplied:!0};const Tn=At.fields.map(kn=>kn.config.custom?.insertNulls||mn.config.interval||null),Dn=new Set(Tn);if(Dn.delete(null),Dn.size===0)return At;if(Dn.size===1){const kn=Dn.values().next().value;if(kn<=0)return At;const Us=mn.values,ls=At.fields.map(xa=>xa.values),Ns=Xs(Us,ls,kn,$t,Xt,gn,Et);return Ns===ls?At:{...At,length:Ns[0].length,fields:At.fields.map((xa,Oa)=>({...xa,values:Ns[Oa]}))}}return At}function Xs(xt,Et,At,Jt=null,Xt=null,$t,gn){const mn=xt.length,Tn=[];if(Jt!=null&&Jt<xt[0]){let ls=Math.ceil((xt[0]-Jt)/At),Ns=xt[0]-ls*At;for(;Ns<xt[0];)Tn.push($t(Ns-At,Ns,At)),Ns+=At}Tn.push(xt[0]);let Dn=xt[0];for(let ls=1;ls<mn;ls++){const Ns=xt[ls];for(;Ns-Dn>At&&(Tn.push($t(Dn,Ns,At)),Dn+=At,!!gn););Tn.push(Ns),Dn=Ns}if(Xt!=null&&Xt>Dn)for(;Dn+At<Xt;)Tn.push($t(Dn,Xt,At)),Dn+=At;const kn=Tn.length;if(kn===mn)return Et;const Us=[];for(let ls of Et){let Ns;if(ls!==xt){Ns=Array(kn);for(let xa=0,Oa=0;xa<kn;xa++)Ns[xa]=xt[Oa]===Tn[xa]?ls[Oa++]:null}else Ns=Tn;Us.push(Ns)}return Us}function Ss(xt,Et,At){let Jt,Xt;for(let $t=0;$t<Et.length;$t++)if(Et[$t]==null)Xt==null&&Jt!=null&&(Xt=$t);else{if(Xt!=null){if(xt[$t]-Jt<At)for(;Xt<$t;)Et[Xt++]=void 0;Xt=null}Jt=xt[$t]}return Et}function Ys(xt){return xt.type===Vt.PU.number&&xt.config.custom?.drawStyle===Gs.GR.Bars&&!xt.config.custom?.hideFrom?.viz}function ea(xt,Et){return xt.fields.find(At=>Et!=null?At.name===Et:At.type===Vt.PU.time)}function _s(xt,Et){const At=ea(xt,Et);let Jt=At?.values;for(let Xt=0;Xt<xt.fields.length;Xt++){let $t=xt.fields[Xt];if($t===At||Ys($t))continue;let gn=$t.config.custom?.spanNulls;typeof gn=="number"&&gn!==-1&&Jt&&($t.values=Ss(Jt,$t.values,gn))}return xt}function qs(xt,Et,At){let Jt;e:for(let mn of xt)for(let Tn of mn.fields)if(Et.x(Tn,mn,xt)){Jt=Tn;break e}xt=xt.map(mn=>Jt?.state?.nullThresholdApplied?mn:js({frame:mn,refFieldName:Jt.name,refFieldPseudoMin:At?.from.valueOf(),refFieldPseudoMax:At?.to.valueOf()}));let Xt=0;xt.forEach(mn=>{mn.fields.forEach(Tn=>{Ys(Tn)&&(Tn.config.custom={...Tn.config.custom,spanNulls:-1},Xt++)})});let $t=1/0;Xt>1&&xt.forEach(mn=>{if(!mn.fields.some(Ys))return;const Tn=Jt.values;for(let Dn=0;Dn<Tn.length;Dn++)Dn>0&&($t=Math.min($t,Tn[Dn]-Tn[Dn-1]))});let gn=(0,En.Fd)({frames:xt,joinBy:Et.x,keep:Et.y,keepOriginIndices:!0});return gn?(gn=_s(gn,Jt.name),$t!==1/0&&(gn.fields.forEach((mn,Tn)=>{let Dn=mn.values;if(Tn===0){let kn=Dn[Dn.length-1];Dn.push(kn+$t,kn+2*$t)}else Ys(mn)?Dn.push(null,null):Dn.push(void 0,void 0)}),gn.length+=2),gn):null}function sa(xt,Et){const At="na",Jt=`${xt.min!==void 0?xt.min:At}-${xt.max!==void 0?xt.max:At}`,Xt=`${xt.custom?.axisSoftMin!==void 0?xt.custom.axisSoftMin:At}-${xt.custom?.axisSoftMax!==void 0?xt.custom.axisSoftMax:At}`,$t=`${xt.custom?.axisPlacement!==void 0?xt.custom?.axisPlacement:Gs.vM.Auto}`,gn=xt.unit??Ur.s,mn=xt.custom?.scaleDistribution?Va(xt.custom.scaleDistribution):Gs.L4.Linear,Tn=xt.custom?.axisLabel?xt.custom.axisLabel:At;return`${gn}/${Jt}/${Xt}/${$t}/${mn}/${Tn}/${Et}`}function Va(xt){return xt.type===Gs.L4.Log?`${xt.type}${xt.log}`:xt.type}function Zs(xt,Et,At=[]){for(const Jt of At)if(typeof Jt=="function"){if(!Jt(xt,Et))return!1}else if(Et[Jt]!==xt[Jt])return!1;return!0}class ba extends o.Component{constructor(Et){super(Et),this.panelContext={},this.subscription=new je.yU,this.getTimeRange=()=>this.props.timeRange;let At=this.prepState(Et);At.alignedData=At.config.prepData([At.alignedFrame]),this.state=At,this.plotInstance=o.createRef()}static{this.contextType=wn.e4}prepState(Et,At=!0){let Jt=null;const{frames:Xt,fields:$t,preparePlotFrame:gn}=Et,Tn=(gn||qs)(Xt,$t||{x:dt.sJ.get(Lt.Ct.firstTimeField).get({}),y:dt.sJ.get(Lt.Ct.byTypes).get(new Set([Vt.PU.number,Vt.PU.enum]))},Et.timeRange);if((0,bn.uY)("GraphNG",!1,"data aligned",Tn),Tn){let Dn=this.state?.config;At&&(Dn=Et.prepConfig(Tn,this.props.frames,this.getTimeRange),(0,bn.uY)("GraphNG",!1,"config prepared",Dn)),Jt={alignedFrame:Tn,config:Dn},(0,bn.uY)("GraphNG",!1,"data prepared",Jt.alignedData)}return Jt}handleCursorUpdate(Et){const At=Et.payload?.point?.time,Jt=this.plotInstance.current;if(Jt&&At){const Xt=Jt.valToPos(At,"x");let $t;if(Xt&&($t=(0,bn.sw)(Jt,Jt.posToIdx(Xt))),!$t||!Xt)return;Jt.setCursor({left:Xt,top:$t})}}componentDidMount(){this.panelContext=this.context;const{eventBus:Et}=this.panelContext;this.subscription.add(Et.getStream(Gt.b_).pipe((0,qe.c)(50)).subscribe({next:At=>{Et!==At.origin&&this.handleCursorUpdate(At)}})),this.subscription.add(Et.getStream(en.kb).pipe((0,qe.c)(50)).subscribe({next:At=>this.handleCursorUpdate(At)})),this.subscription.add(Et.getStream(Gt.ql).pipe((0,qe.c)(50)).subscribe({next:()=>{const At=this.plotInstance?.current;At&&!At.cursor._lock&&At.setCursor({left:-10,top:-10})}}))}componentDidUpdate(Et){const{frames:At,structureRev:Jt,timeZone:Xt,propsToDiff:$t}=this.props,gn=!Zs(Et,this.props,$t);if(At!==Et.frames||gn||Xt!==Et.timeZone){let mn=this.prepState(this.props,!1);mn&&((this.state.config===void 0||Xt!==Et.timeZone||Jt!==Et.structureRev||!Jt||gn)&&(mn.config=this.props.prepConfig(mn.alignedFrame,this.props.frames,this.getTimeRange),(0,bn.uY)("GraphNG",!1,"config recreated",mn.config)),mn.alignedData=mn.config.prepData([mn.alignedFrame]),this.setState(mn))}}componentWillUnmount(){this.subscription.unsubscribe()}render(){const{width:Et,height:At,children:Jt,renderLegend:Xt}=this.props,{config:$t,alignedFrame:gn,alignedData:mn}=this.state;return $t?(0,s.jsx)(Xn.KU,{width:Et,height:At,legend:Xt($t),children:(Tn,Dn)=>(0,s.jsx)(lo.Z,{config:$t,data:mn,width:Tn,height:Dn,plotRef:kn=>this.plotInstance.current=kn,children:Jt?Jt($t,gn):null})}):null}}var ur=e(36613),Ma=e(57875),Ta=e(8066),ya=e(24293),mr=e(94624),to=e(74863);const di=new Set(["bytes","bits","kbytes","mbytes","gbytes","tbytes","pbytes","binBps","binbps","KiBs","Kibits","MiBs","Mibits","GiBs","Gibits","TiBs","Tibits","PiBs","Pibits"]),Bo=Array(53);for(let xt=0;xt<Bo.length;xt++)Bo[xt]=2**xt;const no=(xt,Et=1)=>xt==null?"-":xt.toFixed(Et),ui={drawStyle:Gs.GR.Line,showPoints:Gs.yL.Auto,axisPlacement:Gs.vM.Auto},hi=({frame:xt,theme:Et,timeZones:At,getTimeRange:Jt,sync:Xt,allFrames:$t,renderers:gn,tweakScale:mn=Dn=>Dn,tweakAxis:Tn=Dn=>Dn})=>{const Dn="__global_",kn=new io.e(At[0]);let Us;kn.setPrepData(aa=>(Us=aa[0],(0,bn.bq)(aa[0],kn.getStackingGroups())));const ls=xt.fields[0];if(!ls)return kn;const Ns="x";let xa="";const Oa=ls.config.custom?.axisPlacement!==Gs.vM.Hidden?Gs.vM.Bottom:Gs.vM.Hidden,ia=ls.config.custom?.axisPlacement!==Gs.vM.Hidden;if(ls.type===Vt.PU.time){kn.addScale({scaleKey:Ns,orientation:Gs.Lt.Horizontal,direction:Gs.ON.Right,isTime:!0,range:()=>{const _n=Jt();return[_n.from.valueOf(),_n.to.valueOf()]}});const aa=At.length>1?(_n,ra)=>ra.map((ns,ga)=>ga<2?null:ns):void 0;for(let _n=0;_n<At.length;_n++){const ra=At[_n];kn.addAxis({scaleKey:Ns,isTime:!0,placement:Oa,show:ia,label:ls.config.custom?.axisLabel,timeZone:ra,theme:Et,grid:{show:_n===0&&ls.config.custom?.axisGridShow},filter:aa})}At.length>1&&kn.addHook("drawAxes",_n=>{_n.ctx.save(),_n.ctx.fillStyle=Et.colors.text.primary,_n.ctx.textAlign="left",_n.ctx.textBaseline="bottom";let ra=0;_n.axes.forEach(ns=>{if(ns.side===2){let ga=ns._pos+ns._size;_n.ctx.fillText(At[ra],_n.bbox.left,ga*ur.A.pxRatio),ra++}}),_n.ctx.restore()})}else kn.addScale({scaleKey:Ns,orientation:Gs.Lt.Horizontal,direction:Gs.ON.Right,range:(aa,_n,ra)=>[ls.config.min??_n,ls.config.max??ra]}),kn.addAxis({scaleKey:Ns,placement:Oa,show:ia,label:ls.config.custom?.axisLabel,theme:Et,grid:{show:ls.config.custom?.axisGridShow},formatValue:(aa,_n)=>(0,qa.cN)(ls.display(aa,_n))});let rr=gn?.flatMap(aa=>Object.values(aa.fieldMap).filter(_n=>aa.indicesOnly.indexOf(_n)===-1))??[],Qa;for(let aa=1;aa<xt.fields.length;aa++){const _n=xt.fields[aa],ra={..._n.config,custom:{...ui,..._n.config.custom}},ns=ra.custom;if(_n===ls||_n.type!==Vt.PU.number&&_n.type!==Vt.PU.enum)continue;let ga=_n.display??no;_n.config.custom?.stacking?.mode===Gs.gs.Percent&&(ga=(0,Ma.J)({field:{..._n,config:{..._n.config,unit:"percentunit"}},theme:Et}));const da=sa(ra,_n.type),pa=(0,Ta.Qi)(_n),Sa=(0,Ta.lz)(_n,Et).color;if(kn.addScale(mn({scaleKey:da,orientation:Gs.Lt.Vertical,direction:Gs.ON.Up,distribution:ns.scaleDistribution?.type,log:ns.scaleDistribution?.log,linearThreshold:ns.scaleDistribution?.linearThreshold,min:_n.config.min,max:_n.config.max,softMin:ns.axisSoftMin,softMax:ns.axisSoftMax,centeredZero:ns.axisCenteredZero,range:ns.stacking?.mode===Gs.gs.Percent?(Wa,xr,fr)=>(xr=xr<0?-1:0,fr=fr>0?1:0,[xr,fr]):_n.type===Vt.PU.enum?(Wa,xr,fr)=>[-1,_n.config.type.enum.text.length]:void 0,decimals:_n.config.decimals},_n)),xa||(xa=da),ns.axisPlacement!==Gs.vM.Hidden){let Wa;ns.axisColorMode===Gs.Y$.Series&&(pa.isByValue&&_n.config.custom?.gradientMode===Gs.on.Scheme&&pa.id===ya.Y.Thresholds?Wa=(0,to.pl)(1,Et,pa,_n.config.thresholds):Wa=Sa);const xr={border:{show:ns.axisBorderShow||!1,width:1/devicePixelRatio,stroke:Wa||Et.colors.text.primary},ticks:{show:ns.axisBorderShow||!1,stroke:Wa||Et.colors.text.primary},color:Wa||Et.colors.text.primary};let fr,ka,ir;if(di.has(ra.unit))fr=Bo;else if(_n.type===Vt.PU.enum){let lr=_n.config.type.enum.text;ir=lr.map((Er,Pr)=>Pr),ka=lr}kn.addAxis(Tn({scaleKey:da,label:ns.axisLabel,size:ns.axisWidth,placement:ns.axisPlacement??Gs.vM.Auto,formatValue:(lr,Er)=>(0,qa.cN)(ga(lr,Er)),theme:Et,grid:{show:ns.axisGridShow},decimals:_n.config.decimals,distr:ns.scaleDistribution?.type,splits:ir,values:ka,incrs:fr,...xr},_n))}const Ba=ns.drawStyle===Gs.GR.Points?Gs.yL.Always:ns.showPoints;let hr=()=>null;ns.spanNulls!==!0&&(hr=(Wa,xr,fr,ka)=>{let ir=[],lr=Wa.series[xr];if(!fr&&ka&&ka.length){const[Er,Pr]=lr.idxs,Eo=Wa.data[0],Kr=Wa.data[xr],Wo=Math.round(Wa.valToPos(Eo[Er],"x",!0)),ao=Math.round(Wa.valToPos(Eo[Pr],"x",!0));ka[0][0]===Wo&&ir.push(Er);for(let wr=0;wr<ka.length;wr++){let qo=ka[wr],ei=ka[wr+1];if(ei&&qo[1]===ei[0]){let $r=Wa.posToIdx(qo[1],!0);if(Kr[$r]==null)for(let Vr=1;Vr<100;Vr++){if(Kr[$r+Vr]!=null){$r+=Vr;break}if(Kr[$r-Vr]!=null){$r-=Vr;break}}ir.push($r)}}ka[ka.length-1][1]===ao&&ir.push(Pr)}return ir.length?ir:null});let{fillOpacity:sr}=ns,Sr=null,yr=null;if(_n.state?.origin){Qa||(Qa=Jo(xt,$t));const Wa=$t[_n.state.origin.frameIndex],xr=Wa?.fields[_n.state.origin.fieldIndex],fr=(0,Ga.Ct)(xr??_n,Wa,$t);if(rr.indexOf(fr)>=0)Sr=()=>null,yr=()=>{};else if(ns.transform===Gs.NU.Constant){const ka=ur.A.paths.linear();Sr=(ir,lr)=>{const Er=ir._data,Pr=Jt();let Eo=[Pr.from.valueOf(),Pr.to.valueOf()],Kr=Er[lr].find(wr=>wr!=null),Wo=[Kr,Kr],ao=Er.slice();return ao[0]=Eo,ao[lr]=Wo,ka({...ir,_data:ao},lr,0,1)}}if(ns.fillBelowTo){const ka=xt.fields.find(Pr=>ns.fillBelowTo===Pr.name||ns.fillBelowTo===Pr.config?.displayNameFromDS||ns.fillBelowTo===(0,Ga.Ct)(Pr,xt,$t)),ir=ka?(0,Ga.Ct)(ka,xt,$t):ns.fillBelowTo,lr=Qa.get(fr),Er=Qa.get(ir);(0,K.isNumber)(Er)&&(0,K.isNumber)(lr)?(kn.addBand({series:[lr,Er],fill:void 0}),sr||(sr=35)):sr=0}}let xo;pa.id===ya.Y.Thresholds&&(xo=Wa=>(0,Ta.lz)(Us.fields[Wa],Et).color),kn.addSeries({pathBuilder:Sr,pointsBuilder:yr,scaleKey:da,showPoints:Ba,pointsFilter:hr,colorMode:pa,fillOpacity:sr,theme:Et,dynamicSeriesColor:xo,drawStyle:ns.drawStyle,lineColor:ns.lineColor??Sa,lineWidth:ns.lineWidth,lineInterpolation:ns.lineInterpolation,lineStyle:ns.lineStyle,barAlignment:ns.barAlignment,barWidthFactor:ns.barWidthFactor,barMaxWidth:ns.barMaxWidth,pointSize:ns.pointSize,spanNulls:ns.spanNulls||!1,show:!ns.hideFrom?.viz,gradientMode:ns.gradientMode,thresholds:ra.thresholds,hardMin:_n.config.min,hardMax:_n.config.max,softMin:ns.axisSoftMin,softMax:ns.axisSoftMax,dataFrameFieldIndex:_n.state?.origin}),ns.thresholdsStyle&&ra.thresholds&&(ns.thresholdsStyle.mode??Gs.Ly.Off)!==Gs.Ly.Off&&kn.addThresholds({config:ns.thresholdsStyle,thresholds:ra.thresholds,scaleKey:da,theme:Et,hardMin:_n.config.min,hardMax:_n.config.max,softMin:ns.axisSoftMin,softMax:ns.axisSoftMax})}let or=(0,bn.ro)(xt);kn.setStackingGroups(or),gn?.forEach(aa=>{Qa||(Qa=Jo(xt,$t));let _n={};for(let ra in aa.fieldMap){let ns=aa.fieldMap[ra];_n[ra]=Qa.get(ns)}aa.init(kn,_n)}),kn.scaleKeys=[Ns,xa];const Ya=15;let vr={dataIdx:(aa,_n,ra,ns)=>{let ga=aa.data[_n];if(ga[ra]==null){let da=null,pa=null,ua;for(ua=ra;da==null&&ua-- >0;)ga[ua]!=null&&(da=ua);for(ua=ra;pa==null&&ua++<ga.length;)ga[ua]!=null&&(pa=ua);let Sa=aa.data[0],Ba=aa.valToPos(ns,"x"),hr=pa==null?1/0:aa.valToPos(Sa[pa],"x"),sr=da==null?-1/0:aa.valToPos(Sa[da],"x"),Sr=Ba-sr,yr=hr-Ba;Sr<=yr?Sr<=Ya&&(ra=da):yr<=Ya&&(ra=pa)}return ra}};return Xt&&Xt()!==mr.y.Off&&(vr.sync={key:Dn,scales:[Ns,null]}),kn.setCursor(vr),kn};function Jo(xt,Et){const At=new Map;return xt.fields.forEach((Jt,Xt)=>{const $t=Jt.state?.origin;if($t){const gn=Et[$t.frameIndex]?.fields[$t.fieldIndex];gn&&At.set((0,Ga.Ct)(gn,Et[$t.frameIndex],Et),Xt)}}),At}const fi=["legend","options","theme"];class Zo extends o.Component{constructor(){super(...arguments),this.prepConfig=(Et,At,Jt)=>{const{sync:Xt}=this.context,{theme:$t,timeZone:gn,renderers:mn,tweakAxis:Tn,tweakScale:Dn}=this.props;return hi({frame:Et,theme:$t,timeZones:Array.isArray(gn)?gn:[gn],getTimeRange:Jt,sync:Xt,allFrames:At,renderers:mn,tweakScale:Dn,tweakAxis:Tn})},this.renderLegend=Et=>{const{legend:At,frames:Jt}=this.props;return!Et||At&&!At.showLegend||!(0,Br.t)(Et,Jt)?null:(0,s.jsx)(Br.$,{data:Jt,config:Et,...At})}}static{this.contextType=wn.e4}render(){return(0,s.jsx)(ba,{...this.props,prepConfig:this.prepConfig,propsToDiff:fi,renderLegend:this.renderLegend})}}const mo=(0,T.cV)(Zo);mo.displayName="TimeSeries";const za=(0,o.createContext)({}),Xo=()=>{const{data:xt,dimFields:Et,mapSeriesIndexToDataFrameFieldIndex:At}=(0,o.useContext)(za),Jt=(0,o.useCallback)(()=>{const Xt=Et.x;let $t=null;for(let gn=0;gn<xt.fields.length;gn++)if(Xt(xt.fields[gn],xt,[xt])){$t=xt.fields[gn];break}return $t},[xt,Et]);return{dimFields:Et,mapSeriesIndexToDataFrameFieldIndex:At,getXAxisField:Jt,alignedData:xt}},Fr=5,vo=xt=>xt!=null&&!xt.ctrlKey&&!xt.metaKey,Uo=({onZoom:xt,config:Et,withZoomY:At=!1})=>((0,o.useLayoutEffect)(()=>{let Jt=!1,Xt=!1;At&&Et.addHook("init",$t=>{$t.over.addEventListener("mousedown",gn=>{if(vo(gn)&&gn.button===0&&gn.shiftKey){Xt=!0,$t.cursor.drag.x=!1,$t.cursor.drag.y=!0;let mn=Tn=>{$t.cursor.drag.x=!0,$t.cursor.drag.y=!1,document.removeEventListener("mouseup",mn,!0)};document.addEventListener("mouseup",mn,!0)}},!0)}),Et.addHook("setSelect",$t=>{const gn=$t.scales.x.ori===0;if(vo($t.cursor.event)){if(At&&Xt){if($t.select.height>=Fr){for(let mn in $t.scales)if(mn!=="x"){const Tn=gn?$t.posToVal($t.select.top,mn):$t.posToVal($t.select.left+$t.select.width,mn),Dn=gn?$t.posToVal($t.select.top+$t.select.height,mn):$t.posToVal($t.select.left,mn);$t.setScale(mn,{min:Dn,max:Tn})}Jt=!0}Xt=!1}else if($t.select.width>=Fr){const mn=gn?$t.posToVal($t.select.left,"x"):$t.posToVal($t.select.top+$t.select.height,"x"),Tn=gn?$t.posToVal($t.select.left+$t.select.width,"x"):$t.posToVal($t.select.top,"x");xt({from:mn,to:Tn}),Jt=!1}}$t.setSelect({left:0,width:0,top:0,height:0},!1)}),Et.setCursor({bind:{dblclick:$t=>()=>{if(!vo($t.cursor.event))return null;if(At&&Jt){for(let gn in $t.scales)gn!=="x"&&$t.setScale(gn,{min:null,max:null});Jt=!1}else{let gn=$t.scales.x;const mn=gn.min,Tn=gn.max,Dn=(Tn-mn)/2;xt({from:mn-Dn,to:Tn+Dn})}return null}}})},[Et,xt,At]),null);var _o=e(1604),gi=e(14588);const No=10,pi=({mode:xt=Gs.$N.Single,sortOrder:Et=Gs.xB.None,sync:At,timeZone:Jt,config:Xt,renderTooltip:$t,...gn})=>{const mn=(0,o.useRef)(),Tn=(0,T.$j)(),[Dn,kn]=(0,o.useState)(null),[Us,ls]=(0,o.useState)(null),[Ns,xa]=(0,o.useState)([]),[Oa,ia]=(0,o.useState)(null),[rr,Qa]=(0,o.useState)(!1),or=(0,_o.A)();let Ya=null;const vr=(0,T.of)(yo);if((0,o.useLayoutEffect)(()=>{let ga;const da=()=>{or()&&(Qa(!0),mn.current?.root.classList.add("plot-active"))},pa=()=>{or()&&(ia(null),Qa(!1),mn.current?.root.classList.remove("plot-active"))};return Xt.addHook("syncRect",(ua,Sa)=>ga=Sa),Xt.addHook("init",ua=>{mn.current=ua,ua.over.addEventListener("mouseenter",da),ua.over.addEventListener("mouseleave",pa),Ya=ua.root.closest("[tabindex]"),Ya&&(Ya.addEventListener("focus",da),Ya.addEventListener("blur",pa)),At&&At()===mr.y.Crosshair&&ua.root.classList.add("shared-crosshair")}),Xt.addHook("setLegend",ua=>{or()&&(ls(ua.legend.idx),xa(ua.legend.idxs.slice()))}),Xt.addHook("setCursor",ua=>{if(!ga||!or())return;const{x:Sa,y:Ba}=vi(ua,ga);ia(Sa!==void 0&&Ba!==void 0?{x:Sa,y:Ba}:null)}),Xt.addHook("setSeries",(ua,Sa)=>{or()&&kn(Sa)}),()=>{ia(null),mn.current&&(mn.current.over.removeEventListener("mouseleave",pa),mn.current.over.removeEventListener("mouseenter",da),Ya&&(Ya.removeEventListener("focus",da),Ya.removeEventListener("blur",pa)))}},[Xt,ia,Qa,ls,xa]),Us===null||!rr&&At&&At()===mr.y.Crosshair)return null;let aa=gn.data.fields[0];if(!aa)return null;const _n=aa.display||(0,Ma.J)({field:aa,timeZone:Jt,theme:Tn});let ra=null,ns=_n(aa.values[Us]).text;if($t)ra=$t(gn.data,Dn,Us);else{if(xt===Gs.$N.Single&&Dn!==null){const ga=gn.data.fields[Dn];if(!ga)return null;const da=Ns?.[Dn]??Us;ns=_n(aa.values[da]).text;const ua=(ga.display||(0,Ma.J)({field:ga,timeZone:Jt,theme:Tn}))(ga.values[da]);ra=(0,s.jsx)(on.o,{series:[{color:ua.color||ya.F,label:(0,Ga.Ct)(ga,gn.data,gn.frames),value:ua?(0,qa.cN)(ua):null}],timestamp:ns})}if(xt===Gs.$N.Multi){let ga=[];const da=gn.data,pa=da.fields,ua=[];for(let Sa=0;Sa<pa.length;Sa++){const Ba=da.fields[Sa];if(!Ba||Ba===aa||Ba.type===Vt.PU.time||Ba.type!==Vt.PU.number||Ba.config.custom?.hideFrom?.tooltip||Ba.config.custom?.hideFrom?.viz)continue;const hr=gn.data.fields[Sa].values[Ns[Sa]],sr=Ba.display(hr);ua.push(hr),ga.push({color:sr.color||ya.F,label:(0,Ga.Ct)(Ba,da,gn.frames),value:sr?(0,qa.cN)(sr):null,isActive:Dn===Sa})}if(Et!==Gs.xB.None){const Sa=[...ga],Ba=gi.sortValues(Et);ga.sort((hr,sr)=>{const Sr=Sa.indexOf(hr),yr=Sa.indexOf(sr);return Ba(ua[Sr],ua[yr])})}ra=(0,s.jsx)(on.o,{series:ga,timestamp:ns})}}return(0,s.jsx)(ee.ZL,{className:rr?vr.tooltipWrapper:void 0,children:ra&&Oa&&(0,s.jsx)(Qn.o,{position:{x:Oa.x,y:Oa.y},offset:{x:No,y:No},children:ra})})};function mi({left:xt,top:Et},At){return xt===void 0||Et===void 0?!1:xt<0||xt>At.width||Et<0||Et>At.height}function vi(xt,Et){let At,Jt;const Xt=xt.cursor.left||0,$t=xt.cursor.top||0;if(mi(xt.cursor,Et)){const gn=xt.posToIdx(Xt);if($t<0||$t>Et.height){let mn=(0,bn.sw)(xt,gn);mn&&(Jt=Et.top+mn,Xt>=0&&Xt<=Et.width&&(At=Et.left+xt.valToPos(xt.data[0][xt.posToIdx(Xt)],xt.series[0].scale)))}}else At=Et.left+Xt,Jt=Et.top+$t;return{x:At,y:Jt}}const yo=xt=>({tooltipWrapper:(0,C.css)({"z-index":xt.zIndex.portal+1+" !important"})}),so={SecretFormField:V.L,FormField:t.z,Select:L,AsyncSelect:B,IndicatorsContainer:g,NoOptionsMessage:l,Input:n.p,Switch:U}},81297:(G,R,e)=>{"use strict";e.d(R,{Z:()=>d});var t=e(74848),n=e(96540),s=e(36613),a=e(16895),r=e(7650);function g(c,h){return h.width===c.width&&h.height===c.height}function i(c,h){return h.data===c.data}function l(c,h){return h.config===c.config}class d extends n.Component{constructor(h){super(h),this.plotContainer=(0,n.createRef)(),this.plotCanvasBBox=(0,n.createRef)(),this.state={plot:null}}reinitPlot(){let{width:h,height:o,plotRef:m}=this.props;if(this.state.plot?.destroy(),h===0&&o===0)return;this.props.config.addHook("setSize",f=>{f.over});const u={width:Math.floor(this.props.width),height:Math.floor(this.props.height),...this.props.config.getConfig()};(0,a.uY)("UPlot",!1,"Reinitializing plot",u);const p=new s.A(u,this.props.data,this.plotContainer.current);m&&m(p),this.setState({plot:p})}componentDidMount(){this.reinitPlot()}componentWillUnmount(){this.state.plot?.destroy()}componentDidUpdate(h){let{plot:o}=this.state;g(h,this.props)?l(h,this.props)?i(h,this.props)||o?.setData(this.props.data):this.reinitPlot():o?.setSize({width:Math.floor(this.props.width),height:Math.floor(this.props.height)})}render(){return(0,t.jsxs)("div",{style:{position:"relative"},children:[(0,t.jsx)("div",{ref:this.plotContainer,"data-testid":"uplot-main-div"}),this.props.children]})}}},24182:(G,R,e)=>{"use strict";e.d(R,{$:()=>h,t:()=>c});var t=e(74848),n=e(96540),s=e(28240),a=e(8066),r=e(52622),g=e(40845),i=e(67266),l=e(96516),d=e(16895);function c(o,m){return o.getSeries().some(u=>{const p=u.props.dataFrameFieldIndex;if(!p)return!1;const f=m[p.frameIndex]?.fields[p.fieldIndex];return!(!f||f.config.custom?.hideFrom?.legend)})}const h=(0,n.memo)(({data:o,config:m,placement:u,calcs:p,displayMode:f,...y})=>{const x=(0,g.$j)(),v=m.getSeries().map(P=>{const E=P.props,D=E.dataFrameFieldIndex,C=m.getAxisPlacement(P.props.scaleKey);if(!D)return;const b=o[D.frameIndex]?.fields[D.fieldIndex];if(!b||b.config.custom?.hideFrom?.legend)return;const T=(0,s.Ct)(b,o[D.frameIndex],o),O=(0,a.lz)(b,x).color;return{disabled:!(E.show??!0),fieldIndex:D,color:O,label:T,yAxis:C===r.vM.Left||C===r.vM.Bottom?1:2,getDisplayValues:()=>(0,d.UO)(p,b,x),getItemKey:()=>`${T}-${D.frameIndex}-${D.fieldIndex}`,lineStyle:E.lineStyle}}).filter(P=>P!==void 0);return(0,t.jsx)(i.KU.Legend,{placement:u,...y,children:(0,t.jsx)(l.t,{placement:u,items:v,displayMode:f,sortBy:y.sortBy,sortDesc:y.sortDesc,isSortable:!0})})});h.displayName="PlotLegend"},52198:(G,R,e)=>{"use strict";e.d(R,{t:()=>n});var t=e(52622);const n={drawStyle:[{label:"Lines",value:t.GR.Line},{label:"Bars",value:t.GR.Bars},{label:"Points",value:t.GR.Points}],lineInterpolation:[{description:"Linear",value:t.dx.Linear,icon:"gf-interpolation-linear"},{description:"Smooth",value:t.dx.Smooth,icon:"gf-interpolation-smooth"},{description:"Step before",value:t.dx.StepBefore,icon:"gf-interpolation-step-before"},{description:"Step after",value:t.dx.StepAfter,icon:"gf-interpolation-step-after"}],barAlignment:[{description:"Before",value:t.Nj.Before,icon:"gf-bar-alignment-before"},{description:"Center",value:t.Nj.Center,icon:"gf-bar-alignment-center"},{description:"After",value:t.Nj.After,icon:"gf-bar-alignment-after"}],showPoints:[{label:"Auto",value:t.yL.Auto,description:"Show points when the density is low"},{label:"Always",value:t.yL.Always},{label:"Never",value:t.yL.Never}],axisPlacement:[{label:"Auto",value:t.vM.Auto,description:"First field on the left, everything else on the right"},{label:"Left",value:t.vM.Left},{label:"Right",value:t.vM.Right},{label:"Hidden",value:t.vM.Hidden}],fillGradient:[{label:"None",value:t.on.None},{label:"Opacity",value:t.on.Opacity,description:"Enable fill opacity gradient"},{label:"Hue",value:t.on.Hue,description:"Small color hue gradient"},{label:"Scheme",value:t.on.Scheme,description:"Use color scheme to define gradient"}],stacking:[{label:"Off",value:t.gs.None},{label:"Normal",value:t.gs.Normal},{label:"100%",value:t.gs.Percent}],thresholdsDisplayModes:[{label:"Off",value:t.Ly.Off},{label:"As lines",value:t.Ly.Line},{label:"As lines (dashed)",value:t.Ly.Dashed},{label:"As filled regions",value:t.Ly.Area},{label:"As filled regions and lines",value:t.Ly.LineAndArea},{label:"As filled regions and lines (dashed)",value:t.Ly.DashedAndArea}]}},30501:(G,R,e)=>{"use strict";e.d(R,{Zj:()=>y,pi:()=>d,zH:()=>f});var t=e(83195),n=e(97706),s=e(42994),a=e(72724),r=e(52622),g=e(29413),i=e(52811),l=e(93060);const d=12,c=150,h=30,o=15,m=40,u=18,p=8;class f extends i.R{merge(C){this.props.size=(0,l.Y)("max",this.props.size,C.size),this.props.label||(this.props.label=C.label),this.props.placement===r.vM.Auto&&(this.props.placement=C.placement)}getConfig(){let{scaleKey:C,label:b,show:T=!0,placement:S=r.vM.Auto,grid:O={show:!0},ticks:M,space:I,filter:L,gap:B=5,formatValue:j,splits:A,values:K,incrs:W,isTime:U,timeZone:F,theme:V,tickLabelRotation:w,size:z,color:N,border:H,decimals:Q,distr:X=r.L4.Linear}=this.props;const ee=`${d}px ${V.typography.fontFamily}`,Z=V.isDark?"rgba(240, 250, 255, 0.09)":"rgba(0, 10, 23, 0.09)";(0,t.j9)(C)&&(A=[0,1]),Q===0&&X===r.L4.Linear&&(L=(ae,k)=>k.map(se=>Number.isInteger(se)?se:null));let q={scale:C,show:T,stroke:N??V.colors.text.primary,side:E(S),font:ee,size:z??((ae,k,se)=>P(ae,k,se)),rotate:w,gap:B,labelGap:0,grid:{show:O.show,stroke:Z,width:1/devicePixelRatio},ticks:Object.assign({show:!0,stroke:H?.show?N??V.colors.text.primary:Z,width:1/devicePixelRatio,size:4},M),splits:A,values:K,space:I??((ae,k,se,te,ne)=>v(ae,k,se,te,ne,j)),filter:L,incrs:W};return H?.show&&(q.border={stroke:N??V.colors.text.primary,width:1/devicePixelRatio,...H}),b!=null&&b.length>0&&(q.label=b,q.labelSize=d+p,q.labelFont=ee,q.labelGap=p),K?q.values=K:U?q.values=x:j&&(q.values=(ae,k,se,te,ne)=>{let le=(0,n.E)((0,n.h)(ne,6));return k.map(re=>j(re,le>0?le:void 0))}),q.timeZone=F,q}}const y={second:1e3,minute:60*1e3,hour:60*60*1e3,day:24*60*60*1e3,month:28*24*60*60*1e3,year:365*24*60*60*1e3};function x(D,C,b,T,S){const O=D.axes[b],M="timeZone"in O&&typeof O.timeZone=="string"?O.timeZone:void 0,I=D.scales.x,L=(I?.max??0)-(I?.min??0),B=Math.round(y.year/y.day)*y.day,j=Math.round(S/y.day)*y.day;let A=s.WC.interval.year;return S<y.second?A=s.WC.interval.millisecond:S<=y.minute?A=s.WC.interval.second:L<=y.day?A=s.WC.interval.minute:S<=y.day?A=s.WC.interval.hour:L<y.year?A=s.WC.interval.day:j===B?A=s.WC.interval.year:S<=y.year&&(A=s.WC.interval.month),C.map(K=>K==null?"":(0,a.LE)(K,{format:A,timeZone:M}))}function v(D,C,b,T,S,O){const M=D.axes[C],I=D.scales[M.scale];if(M.side!==2||!I)return S<=c?o:h;const L=S/m,B=(T-b)/L,j=Math.max(Math.abs(b),Math.abs(T));let A="";if(I.time)A=x(D,[j],C,m,B)[0];else if(O!=null)A=O(j);else return m;return(0,g.kD)(A,d).width+u}function P(D,C,b){const T=D.axes[b];let S=T.ticks.size;if(T.side===2)S+=T.gap+d;else if(C?.length){let O=C.reduce((I,L)=>Math.max(I,(0,g.kD)(L,d).width),0);const M=Math.min(D.width*.4,O);S+=T.gap+T.labelGap+M}return Math.ceil(S)}function E(D){switch(D){case r.vM.Top:return 0;case r.vM.Right:return 1;case r.vM.Bottom:return 2;case r.vM.Left:}return 3}},51336:(G,R,e)=>{"use strict";e.d(R,{e:()=>P});var t=e(2543),n=e(36613),s=e(43127),a=e(91410),r=e(52622),g=e(16895),i=e(30501),l=e(93060),d=e(24293),c=e(23596),h=e(52811),o=e(74863);class m extends h.R{getConfig(){const{facets:D,drawStyle:C,pathBuilder:b,pointsBuilder:T,pointsFilter:S,lineInterpolation:O,lineWidth:M,lineStyle:I,barAlignment:L,barWidthFactor:B,barMaxWidth:j,showPoints:A,pointSize:K,scaleKey:W,pxAlign:U,spanNulls:F,show:V=!0}=this.props;let w={},z=this.getLineColor();w.stroke=z,w.width=M,I&&I.fill!=="solid"&&(I.fill==="dot"&&(w.cap="round"),w.dash=I.dash??[10,10]),b!=null?w.paths=b:C===r.GR.Points?w.paths=()=>null:C!=null&&(w.paths=(Q,X,ee,Z)=>p(C,O,L,B,j)(Q,X,ee,Z));const N=typeof z=="string"?z:(Q,X)=>Q.series[X]._stroke,H={points:{stroke:N,fill:N,size:!K||K<M?void 0:K,filter:S}};return T!=null?H.points.show=T:C===r.GR.Points?H.points.show=!0:A===r.yL.Auto?C===r.GR.Bars&&(H.points.show=!1):A===r.yL.Never?H.points.show=!1:A===r.yL.Always&&(H.points.show=!0),{scale:W,facets:D,spanGaps:typeof F=="number"?!1:F,value:()=>"",pxAlign:U,show:V,fill:this.getFill(),...w,...H}}getLineColor(){const{lineColor:D,gradientMode:C,colorMode:b,thresholds:T,theme:S,hardMin:O,hardMax:M,softMin:I,softMax:L,dynamicSeriesColor:B}=this.props;return C===r.on.None&&B?(j,A)=>B(A)??D??d.F:C===r.on.Scheme&&b?.id!==d.Y.Fixed?(0,o.pl)(1,S,b,T,O,M,I,L):C===r.on.Hue?(0,o.B5)(D??d.F,1,S):D??d.F}getFill(){const{lineColor:D,fillColor:C,gradientMode:b,fillOpacity:T,colorMode:S,thresholds:O,theme:M,hardMin:I,hardMax:L,softMin:B,softMax:j,dynamicSeriesColor:A}=this.props;if(C)return C;const K=b??r.on.None,W=(T??0)/100;if(K===r.on.None&&A&&W>0)return(U,F)=>{let V=U.series[F]._stroke;return c.MV.alpha(V??"",W)};switch(K){case r.on.Opacity:return(0,o.WO)(C??D,W);case r.on.Hue:return(0,o.B5)(C??D,W,M);case r.on.Scheme:if(S?.id!==d.Y.Fixed)return(0,o.pl)(W,M,S,O,I,L,B,j);default:if(W>0)return c.MV.alpha(D??"",W)}}}let u;function p(E,D,C=r.Nj.Center,b=.6,T=200){const S=n.A.paths;if(u||(u={linear:S.linear(),smooth:S.spline(),stepBefore:S.stepped({align:-1}),stepAfter:S.stepped({align:1})}),E===r.GR.Bars){let O=`bars|${C}|${b}|${T}`;return u[O]||(u[O]=S.bars({size:[b,T],align:C})),u[O]}else if(E===r.GR.Line){if(D===r.dx.StepBefore)return u.stepBefore;if(D===r.dx.StepAfter)return u.stepAfter;if(D===r.dx.Smooth)return u.smooth}return u.linear}var f=e(84140),y=e(50082);function x(E){const D=E.config.mode===r.Ly.Dashed||E.config.mode===r.Ly.DashedAndArea?[10,10]:[];function C(A,K,W,U){let F=A.ctx,V=0;for(let w=0;w<W.length;w++)if(W[w].color==="transparent"){V=w;break}F.lineWidth=2,F.setLineDash(D);for(let w=1;w<W.length;w++){const z=W[w];let N;V>=w&&w>0?N=(0,f.A)(U.visualization.getColorByName(W[w-1].color)):N=(0,f.A)(U.visualization.getColorByName(z.color)),N.getAlpha()===1&&N.setAlpha(.7);let H=Math.round(A.bbox.left),Q=Math.round(A.valToPos(z.value,K,!0)),X=Math.round(A.bbox.left+A.bbox.width),ee=Math.round(A.valToPos(z.value,K,!0));F.beginPath(),F.moveTo(H,Q),F.lineTo(X,ee),F.strokeStyle=N.toString(),F.stroke()}}function b(A,K,W,U){let F=A.ctx,V=(0,o.Z8)(A,K,W.map(w=>{let z=(0,f.A)(U.visualization.getColorByName(w.color));return z.getAlpha()===1&&z.setAlpha(.15),[w.value,z.toString()]}),!0);F.fillStyle=V,F.fillRect(A.bbox.left,A.bbox.top,A.bbox.width,A.bbox.height)}const{scaleKey:T,thresholds:S,theme:O,config:M,hardMin:I,hardMax:L,softMin:B,softMax:j}=E;return A=>{const K=A.ctx,{min:W,max:U}=A.scales.x,{min:F,max:V}=A.scales[T];if(W==null||U==null||F==null||V==null)return;let{steps:w,mode:z}=S;if(z===y.O.Percentage){let[N,H]=(0,o.EJ)(A,T,I,L,B,j),Q=H-N;w=w.map(X=>({...X,value:N+Q*(X.value/100)}))}switch(K.save(),M.mode){case r.Ly.Line:case r.Ly.Dashed:C(A,T,w,O);break;case r.Ly.Area:b(A,T,w,O);break;case r.Ly.LineAndArea:case r.Ly.DashedAndArea:b(A,T,w,O),C(A,T,w,O)}K.restore()}}const v={drag:{setScale:!1},points:{size:(E,D)=>E.series[D].points.size*2,width:(E,D,C)=>C/4},focus:{prox:30}};class P{constructor(D=s.lE){this.uid=Math.random().toString(36).slice(2),this.series=[],this.axes={},this.scales=[],this.bands=[],this.stackingGroups=[],this.hasLeftAxis=!1,this.hooks={},this.tz=void 0,this.mode=1,this.frames=void 0,this.thresholds={},this.padding=void 0,this.prepData=void 0,this.scaleKeys=["",""],this.tzDate=C=>{let b=new Date(C);return this.tz?n.A.tzDate(b,this.tz):b},this.tz=(0,a.QZ)(D,Date.now())?.ianaName}addHook(D,C){(0,g.uY)("UPlotConfigBuilder",!1,"addHook",D),this.hooks[D]||(this.hooks[D]=[]),this.hooks[D].push(C)}addThresholds(D){this.thresholds[D.scaleKey]||(this.thresholds[D.scaleKey]=D,this.addHook("drawClear",x(D)))}addAxis(D){D.placement=D.placement??r.vM.Auto,D.grid=D.grid??{};let C=D.scaleKey;if(C==="x"&&(C+=D.timeZone??""),this.axes[C]){this.axes[C].merge(D);return}D.placement===r.vM.Auto&&(D.placement=this.hasLeftAxis?r.vM.Right:r.vM.Left),D.placement===r.vM.Left&&(this.hasLeftAxis=!0),D.placement===r.vM.Hidden&&(D.grid.show=!1,D.size=0),this.axes[C]=new i.zH(D)}getAxisPlacement(D){return this.axes[D]?.props.placement??r.vM.Left}setCursor(D){this.cursor=(0,t.merge)({},this.cursor,D)}setMode(D){this.mode=D}setSelect(D){this.select=D}addSeries(D){this.series.push(new m(D))}getSeries(){return this.series}addScale(D){const C=this.scales.find(b=>b.props.scaleKey===D.scaleKey);if(C){C.merge(D);return}this.scales.push(new l.G(D))}addBand(D){this.bands.push(D)}setStackingGroups(D){this.stackingGroups=D}getStackingGroups(){return this.stackingGroups}setPrepData(D){this.prepData=C=>(this.frames=C,D(C,this.getStackingGroups()))}setPadding(D){this.padding=D}getConfig(){if(this.cachedConfig)return this.cachedConfig;const D={...g.NN,mode:this.mode,series:[this.mode===2?null:{value:()=>""}]};D.axes=this.ensureNonOverlappingAxes(Object.values(this.axes)).map(b=>b.getConfig()),D.series=[...D.series,...this.series.map(b=>b.getConfig())],D.scales=this.scales.reduce((b,T)=>({...b,...T.getConfig()}),{}),D.hooks=this.hooks,D.select=this.select;const C=(b="")=>(T,S)=>{let O=T.series[S].points._stroke;if(typeof O!="string"){let M=this.frames[0].fields[S];O=M.display(M.values[T.cursor.idxs[S]]).color}return O+b};return D.cursor=(0,t.merge)({},v,{points:{stroke:C("80"),fill:C()}},this.cursor),D.tzDate=this.tzDate,Array.isArray(this.padding)&&(D.padding=this.padding),this.stackingGroups.forEach(b=>{(0,g.Tz)(b).forEach(T=>{this.addBand(T)})}),this.bands.length&&(D.bands=this.bands),this.cachedConfig=D,D}ensureNonOverlappingAxes(D){const C=D.find(S=>S.props.scaleKey==="x"),b=D.filter(S=>S.props.grid?.show===void 0),T=b.findIndex(S=>S.props.placement===r.vM.Left||S.props.placement===r.vM.Right||S.props.placement===r.vM.Bottom&&S!==C);for(let S=0;S<b.length;S++)b[S]===C||S===T?b[S].props.grid.show=!0:b[S].props.grid.show=!1;return D}}},93060:(G,R,e)=>{"use strict";e.d(R,{G:()=>g,Y:()=>i});var t=e(36613),n=e(77678),s=e(83195),a=e(52622),r=e(52811);class g extends r.R{merge(d){this.props.min=i("min",this.props.min,d.min),this.props.max=i("max",this.props.max,d.max)}getConfig(){let{isTime:d,scaleKey:c,min:h,max:o,softMin:m,softMax:u,range:p,direction:f,orientation:y,centeredZero:x,decimals:v}=this.props;const P=this.props.distribution,E=d?{}:{distr:P===a.L4.Symlog?4:P===a.L4.Log?3:P===a.L4.Ordinal?2:1,log:P===a.L4.Log||P===a.L4.Symlog?this.props.log??2:void 0,asinh:P===a.L4.Symlog?this.props.linearThreshold??1:void 0};if(P===a.L4.Log){let L=this.props.log,B=L===2?Math.log2:Math.log10;h!=null&&(h<=0?h=null:h=L**Math.floor(B(h))),o!=null&&(o<=0?o=null:o=L**Math.ceil(B(o))),m!=null&&(m<=0?m=null:m=L**Math.floor(B(m))),u!=null&&(u<=0?u=null:u=L**Math.ceil(B(u)))}let D=m==null?3:1,C=u==null?3:1;const b={min:{pad:.1,hard:h??-1/0,soft:m||0,mode:D},max:{pad:.1,hard:o??1/0,soft:u||0,mode:C}};let T=m==null&&h!=null,S=u==null&&o!=null,O=T&&S;const M=(L,B,j,A)=>{const K=L.scales[A];let W=[B,j];if(!O&&B==null&&j==null)return W;let U=K.log??10;if(K.distr===1||K.distr===2||K.distr===4){if(x){let F=Math.abs(B),V=Math.abs(j),w=Math.max(F,V);w===0&&(w=80),B=-w,j=w}K.distr===4?W=t.A.rangeAsinh(B,j,U,!0):W=t.A.rangeNum(T?h:B,S?o:j,b)}else K.distr===3&&(W=t.A.rangeLog(h??B,o??j,U,!0));if(v===0)if(K.distr===1||K.distr===2)W[0]=(0,n.rs)(W[0],1),W[1]=(0,n.Uh)(W[1],1);else if(K.distr===3){let F=K.log===2?Math.log2:Math.log10;if(W[0]<=1)W[0]=1;else{let w=Math.floor(F(W[0]));W[0]=U**w}let V=Math.ceil(F(W[1]));W[1]=U**V,W[0]===W[1]&&(W[1]*=U)}else K.distr===4&&(W[0]=(0,n.rs)(W[0],1),W[1]=(0,n.Uh)(W[1],1));return(K.distr===1||K.distr===4)&&(T&&(W[0]=h),S&&(W[1]=o)),W[0]>=W[1]&&(W[0]=K.distr===3?1:0,W[1]=100),W};let I=!d&&!O;return(0,s.j9)(c)&&(I=!1,p=[0,1]),{[c]:{time:d,auto:I,range:p??M,dir:f,ori:y,...E}}}}function i(l,d,c){const h=d!=null,o=c!=null;return h?o?l==="min"?d<c?d:c:d>c?d:c:d:c}},74863:(G,R,e)=>{"use strict";e.d(R,{B5:()=>d,EJ:()=>m,WO:()=>l,Z8:()=>h,pl:()=>p});var t=e(84140),n=e(23596),s=e(24293),a=e(50082),r=e(52622),g=e(29413);function i(f,y,x){let v=0,P=0,E=0,D=0;return f===3?(P=y.top,D=y.top+y.height):f===2?(v=y.left+y.width,E=y.left):f===1?(P=y.top+y.height,D=y.top):f===0&&(v=y.left,E=y.left+y.width),x.createLinearGradient(v,P,E,D)}function l(f,y){return(x,v)=>{const P=(0,g.Yc)(),E=i(x.scales.x.ori===r.Lt.Horizontal?3:2,x.bbox,P);return E.addColorStop(0,n.MV.alpha(f,y)),E.addColorStop(1,n.MV.alpha(f,0)),E}}function d(f,y,x){return(v,P)=>{const E=(0,g.Yc)(),D=i(v.scales.x.ori===r.Lt.Horizontal?3:2,v.bbox,E),C=(0,t.A)(f).spin(-25).darken(5),b=(0,t.A)(f).saturate(20).spin(20).brighten(10);return x.isDark?(D.addColorStop(0,b.lighten(10).setAlpha(y).toString()),D.addColorStop(1,C.darken(10).setAlpha(y).toString())):(D.addColorStop(0,b.lighten(10).setAlpha(y).toString()),D.addColorStop(1,C.setAlpha(y).toString())),D}}var c=(f=>(f[f.Right=0]="Right",f[f.Up=1]="Up",f[f.Left=2]="Left",f[f.Down=3]="Down",f))(c||{});function h(f,y,x,v=!1){let P=f.scales[y],E=null,D=null;for(let W=0;W<x.length;W++){let U=x[W][0];if((U<=P.min||E==null)&&(E=W),D=W,U>=P.max)break}if(E===D)return x[E][1];let C=x[E][0],b=x[D][0];C===-1/0&&(C=P.min),b===1/0&&(b=P.max);let T=Math.round(f.valToPos(C,y,!0)),S=Math.round(f.valToPos(b,y,!0)),O=T-S;if(O===0)return x[D][1];let M,I,L,B;f.scales.x.ori===r.Lt.Horizontal?(M=L=0,I=T,B=S):(I=B=0,M=T,L=S);let A=(0,g.Yc)().createLinearGradient(M,I,L,B),K;for(let W=E;W<=D;W++){let U=x[W],F=W===E?T:W===D?S:Math.round(f.valToPos(U[0],y,!0)),V=(T-F)/O;v&&W>E&&A.addColorStop(V,K),A.addColorStop(V,K=U[1])}return A}function o(f,y){let x=f.scales[y],v=1/0,P=-1/0;return f.series.forEach((E,D)=>{if(E.show&&E.scale===y)if(E.min==null){let C=f.data[D];for(let b=0;b<C.length;b++)C[b]!=null&&(v=Math.min(v,C[b]),P=Math.max(P,C[b]))}else v=Math.min(v,E.min),P=Math.max(P,E.max)}),P===v&&(v=x.min,P=x.max),[v,P]}function m(f,y,x,v,P,E){let D=x??P??null,C=v??E??null;if(D==null||C==null){let[b,T]=o(f,y);D=D??b??0,C=C??T??100}return[D,C]}function u(f){return f==="transparent"||f[0]==="#"&&f.slice(-2)==="00"}function p(f,y,x,v,P,E,D,C){if(!x)throw Error("Missing colorMode required for color scheme gradients");if(!v)throw Error("Missing thresholds required for color scheme gradients");return(b,T)=>{let S=b.series[T].scale,O="";if(x.id===s.Y.Thresholds)if(v.mode===a.O.Absolute){const M=v.steps.map(I=>[I.value,u(I.color)?"#0000":n.MV.alpha(y.visualization.getColorByName(I.color),f)]);O=h(b,S,M,!0)}else{const[M,I]=m(b,S,P,E,D,C),L=I-M,B=v.steps.map(j=>[M+L*(j.value/100),n.MV.alpha(y.visualization.getColorByName(j.color),f)]);O=h(b,S,B,!0)}else if(x.getColors){const M=x.getColors(y),[I,L]=m(b,S,P,E,D,C),B=L-I,j=M.map((A,K)=>[I+B*(K/(M.length-1)),n.MV.alpha(y.visualization.getColorByName(A),f)]);O=h(b,S,j,!1)}return O}}},78226:(G,R,e)=>{"use strict";e.d(R,{a:()=>g});var t=e(74848),n=e(96540),s=e(1604),a=e(6967),r=e(97620);function g({id:i,events:l,renderEventMarker:d,mapEventToXYCoords:c,config:h}){const o=(0,n.useRef)(),[m,u]=(0,n.useState)(0),p=(0,s.A)();(0,n.useLayoutEffect)(()=>{h.addHook("init",y=>{o.current=y}),h.addHook("draw",()=>{p()&&u(y=>y+1)})},[h,u]);const f=(0,n.useMemo)(()=>{const y=[];if(!o.current||l.length===0)return y;for(let x=0;x<l.length;x++){const v=l[x];for(let P=0;P<v.length;P++){const E=c(v,{fieldIndex:P,frameIndex:x});E&&y.push((0,n.createElement)(a.p,{...E,key:`${i}-marker-${x}-${P}`},d(v,{fieldIndex:P,frameIndex:x})))}}return(0,t.jsx)(t.Fragment,{children:y})},[l,d,m]);return o.current?(0,t.jsx)(r._,{left:o.current.bbox.left/window.devicePixelRatio,top:o.current.bbox.top/window.devicePixelRatio,children:f}):null}},6967:(G,R,e)=>{"use strict";e.d(R,{p:()=>n});var t=e(74848);const n=({x:s,y:a,children:r})=>(0,t.jsx)("div",{style:{position:"absolute",top:`${a}px`,left:`${s}px`},children:r})},97620:(G,R,e)=>{"use strict";e.d(R,{_:()=>a});var t=e(74848),n=e(32196),s=e(96540);const a=({children:r,left:g,top:i})=>{const l=(0,s.useMemo)(()=>(0,n.css)({position:"absolute",overflow:"visible",left:`${g}px`,top:`${i}px`}),[g,i]);return(0,t.jsx)("div",{className:l,children:r})}},55129:(G,R,e)=>{"use strict";e.d(R,{M:()=>s});var t=e(52622),n=e(52811);function s(r,g){const i="na",l=`${r.min!==void 0?r.min:i}-${r.max!==void 0?r.max:i}`,d=`${r.custom?.axisSoftMin!==void 0?r.custom.axisSoftMin:i}-${r.custom?.axisSoftMax!==void 0?r.custom.axisSoftMax:i}`,c=`${r.custom?.axisPlacement!==void 0?r.custom?.axisPlacement:t.vM.Auto}`,h=r.unit??n.s,o=r.custom?.scaleDistribution?a(r.custom.scaleDistribution):t.L4.Linear,m=r.custom?.axisLabel?r.custom.axisLabel:i;return`${h}/${l}/${d}/${c}/${o}/${m}/${g}`}function a(r){return r.type===t.L4.Log?`${r.type}${r.log}`:r.type}},96287:(G,R,e)=>{"use strict";e.d(R,{J:()=>r});var t=e(74848),n=e(32196),s=e(29158),a=e(40845);const r=({onClick:i,"aria-label":l,style:d})=>{const c=(0,a.of)(g);return(0,t.jsx)(s.K,{"aria-label":l??"Close",className:c,name:"times",onClick:i,style:d})},g=i=>(0,n.css)({position:"absolute",margin:"0px",right:5,top:6})},68268:(G,R,e)=>{"use strict";e.d(R,{K:()=>l});var t=e(2543),n=e.n(t),s=e(96540),a=e(64423),r=e(99165),g=e(69129),i=e(26272);const l=({config:d,eventBus:c,frame:h})=>{const o=(0,s.useRef)(h);return o.current=h,(0,s.useLayoutEffect)(()=>{let m=null;const u={point:{time:null},data:o.current};d.addHook("init",D=>{m=D});let p=null;d.addHook("setSeries",(D,C)=>{p=C}),d.addHook("setLegend",()=>{if(!(m.cursor.event==null)){let C=m.cursor.idxs.find(b=>b!=null);if(C==null)E();else{let b=C,T=p,S=m.data[0]??m.data[1][0];u.point.time=S[b],u.rowIndex=b??void 0,u.columnIndex=T??void 0,u.data=o.current;let O=m.cursor.top;u.point.panelRelY=O===0?.001:O>0?O/m.rect.height:1,P()}}});function f(D){const C=D.payload?.point?.time;if(C){const b=m.valToPos(C,"x");m.setCursor({left:b,top:m.rect.height/2})}}const y=new a.yU,x=new g.b_(u).setTags(["uplot"]),v=new g.ql().setTags(["uplot"]);let P=(0,t.throttle)(()=>{c.publish(x)},100),E=(0,t.throttle)(()=>{c.publish(v)},100);return y.add(c.getStream(g.b_).subscribe({next:D=>{c===D.origin||D.tags?.has("uplot")||f(D)}})),y.add(c.getStream(i.kb).subscribe({next:D=>f(D)})),y.add(c.getStream(g.ql).pipe((0,r.c)(50)).subscribe({next:D=>{c===D.origin||D.tags?.has("uplot")||m.cursor._lock||m.setCursor({left:-10,top:-10})}})),()=>{y.unsubscribe()}},[d]),null}},23117:(G,R,e)=>{"use strict";e.d(R,{Z:()=>l});var t=e(2543),n=e.n(t),s=e(96540);const a=.1,r=2,g=new Set(["ArrowRight","ArrowLeft","ArrowUp","ArrowDown","Shift"," "]),i=d=>{let c=d.root,h=new Set,o=null,m=null;if(!c)return;c.tabIndex=0;const u=(E,D)=>{const{cursor:C}=d;if(C.left===void 0||C.top===void 0)return;const{width:b,height:T}=d.over.style,[S,O]=[Math.floor(parseFloat(b)),Math.floor(parseFloat(T))];d.setCursor({left:(0,t.clamp)(C.left+E,0,S),top:(0,t.clamp)(C.top+D,0,O)})},p=E=>{if(h.size===0||!d){m=null;return}const b=(E-(m??E))*a;let T=0,S=0;h.has("ArrowUp")&&(S-=b),h.has("ArrowDown")&&(S+=b),h.has("ArrowLeft")&&(T-=b),h.has("ArrowRight")&&(T+=b),h.has("Shift")&&(T*=r,S*=r),u(T,S);const{cursor:O}=d;if(h.has(" ")&&O){const M=Number(d.over.style.height.slice(0,-2));d.setSelect({left:O.left<o?O.left:o,top:0,width:Math.abs(O.left-(o??O.left)),height:M},!1)}m=E,window.requestAnimationFrame(p)},f=E=>{if(E.key==="Tab"){d.setCursor({left:-5,top:-5});return}if(!g.has(E.key))return;if(E.preventDefault(),E.stopPropagation(),!h.has(E.key)){const C=h.size===0;h.add(E.key),o=E.key===" "&&o===null?d.cursor.left:o,C&&window.requestAnimationFrame(p)}},y=E=>{g.has(E.key)&&(h.delete(E.key),E.key===" "&&(E.preventDefault(),E.stopPropagation(),d.setSelect(d.select),o=null))},x=()=>{if(!c?.matches(":focus-visible"))return;const E=parseFloat(d.over.style.width),D=parseFloat(d.over.style.height);d.setCursor({left:E/2,top:D/2})},v=()=>{m=null,o=null,h.clear(),d.setSelect({left:0,top:0,width:0,height:0},!1)};c.addEventListener("keydown",f),c.addEventListener("keyup",y),c.addEventListener("focus",x),c.addEventListener("blur",v);const P=()=>{c?.removeEventListener("keydown",f),c?.removeEventListener("keyup",y),c?.removeEventListener("focus",x),c?.removeEventListener("blur",v),c=null};(d.hooks.destroy??=[]).push(P)},l=({config:d})=>((0,s.useLayoutEffect)(()=>d.addHook("init",i),[d]),null)},38761:(G,R,e)=>{"use strict";e.d(R,{b3:()=>h,xl:()=>f});var t=e(74848),n=e(32196),s=e(96540),a=e(40961),r=e(73134),g=e(40845),i=e(17464),l=e(96287);const d=void 0,c=10;var h=(x=>(x[x.xOne=0]="xOne",x[x.xAll=1]="xAll",x[x.xyOne=2]="xyOne",x))(h||{});function o(x,v){return{...x,...v,style:{...x.style,...v.style}}}function m(){return{style:{transform:"",pointerEvents:"none"},isHovering:!1,isPinned:!1,contents:null,plot:null,dismiss:()=>{}}}const u=5,p=x=>x!=null&&!x.ctrlKey&&!x.metaKey,f=({config:x,hoverMode:v,render:P,clientZoom:E=!1,queryZoom:D,onSelectRange:C,maxWidth:b,syncMode:T=r.yV.Off,syncScope:S="global"})=>{const O=(0,s.useRef)(null),M=(0,s.useRef)(null);M.current==null&&(M.current=(0,i.gF)());const[{plot:I,isHovering:L,isPinned:B,contents:j,style:A,dismiss:K},W]=(0,s.useReducer)(o,null,m),U=(0,s.useRef)(),F=(0,g.of)(y,b),V=(0,s.useRef)(P);return V.current=P,(0,s.useLayoutEffect)(()=>{U.current={width:0,height:0,observer:new ResizeObserver(Ce=>{let Ue=U.current;for(const Ae of Ce)Ae.borderBoxSize?.length>0?(Ue.width=Ae.borderBoxSize[0].inlineSize,Ue.height=Ae.borderBoxSize[0].blockSize):(Ue.width=Ae.contentRect.width,Ue.height=Ae.contentRect.height)})};let w=!1,z=!1,N=I,H=L,Q=!1,X=B,ee=A,Z=!1;const q=T===r.yV.Tooltip;T!==r.yV.Off&&x.scales[0].props.isTime&&x.setCursor({sync:{key:S,scales:["x",null]}});const ae=()=>{re?H=Z&&Q&&q:H=le!=null||v===1&&Q};let k=0,se=0,te=null,ne=I?.cursor.idxs.slice(),le=null,re=!1,de=!1,oe=!1;const J=(Ce=!1)=>{de||(H?queueMicrotask(pe):setTimeout(pe,100),de=!0),Ce&&(oe=!0)},ce=Ce=>{O.current.contains(Ce.target)||xe()},pe=()=>{de=!1,oe&&(ee={pointerEvents:X?"all":"none"},N.cursor._lock=X,X?(document.addEventListener("mousedown",ce,!0),document.addEventListener("keydown",ce,!0)):(document.removeEventListener("mousedown",ce,!0),document.removeEventListener("keydown",ce,!0)),oe=!1);let Ce={style:ee,isPinned:X,isHovering:H,contents:H||te!=null?V.current(N,ne,le,X,xe,te,re):null,dismiss:xe};W(Ce),te=null},xe=()=>{let Ce=X;X=!1,H=!1,N.setCursor({left:-10,top:-10}),J(Ce)};x.addHook("init",Ce=>{W({plot:N=Ce}),E&&Ce.over.addEventListener("mousedown",Ue=>{if(p(Ue)&&Ue.button===0&&Ue.shiftKey){z=!0,Ce.cursor.drag.x=!1,Ce.cursor.drag.y=!0;let Ae=we=>{Ce.cursor.drag.x=!0,Ce.cursor.drag.y=!1,document.removeEventListener("mouseup",Ae,!0)};document.addEventListener("mouseup",Ae,!0)}},!0),Ce.over.addEventListener("click",Ue=>{if(Ue.target===Ce.over)if(Ue.ctrlKey||Ue.metaKey){let Ae;Ce.scales.x.ori===0?Ae=Ce.posToVal(Ce.cursor.left,"x"):Ae=Ce.posToVal(Ce.select.top+Ce.select.height,"x"),te={from:Ae,to:Ae},J(!1)}else H&&le!=null&&!X&&setTimeout(()=>{X=!0,J(!0)},0)})}),x.addHook("setSelect",Ce=>{const Ue=Ce.scales.x.ori===0;if(!re&&(E||D!=null))if(p(Ce.cursor.event)){if(C!=null){let Ae=[];const we=!!Ce.cursor.drag.y,We=!!Ce.cursor.drag.x;let _e=null,at=[];We&&(_e={from:Ue?Ce.posToVal(Ce.select.left,"x"):Ce.posToVal(Ce.select.top+Ce.select.height,"x"),to:Ue?Ce.posToVal(Ce.select.left+Ce.select.width,"x"):Ce.posToVal(Ce.select.top,"x")}),we&&x.scales.forEach(ut=>{const Tt=ut.props.scaleKey;if(Tt!=="x"){let It={from:Ue?Ce.posToVal(Ce.select.top+Ce.select.height,Tt):Ce.posToVal(Ce.select.left+Ce.select.width,Tt),to:Ue?Ce.posToVal(Ce.select.top,Tt):Ce.posToVal(Ce.select.left,Tt)};at.push(It)}}),We?we?Ae=at.map(ut=>({x:_e,y:ut})):Ae=[{x:_e}]:we&&(Ae=at.map(ut=>({y:ut}))),C(Ae)}else if(E&&z){if(Ce.select.height>=u){for(let Ae in Ce.scales)if(Ae!=="x"){const we=Ue?Ce.posToVal(Ce.select.top,Ae):Ce.posToVal(Ce.select.left+Ce.select.width,Ae),We=Ue?Ce.posToVal(Ce.select.top+Ce.select.height,Ae):Ce.posToVal(Ce.select.left,Ae);Ce.setScale(Ae,{min:We,max:we})}w=!0}z=!1}else if(D!=null&&Ce.select.width>=u){const Ae=Ue?Ce.posToVal(Ce.select.left,"x"):Ce.posToVal(Ce.select.top+Ce.select.height,"x"),we=Ue?Ce.posToVal(Ce.select.left+Ce.select.width,"x"):Ce.posToVal(Ce.select.top,"x");D({from:Ae,to:we}),w=!1}}else te={from:Ue?Ce.posToVal(Ce.select.left,"x"):Ce.posToVal(Ce.select.top+Ce.select.height,"x"),to:Ue?Ce.posToVal(Ce.select.left+Ce.select.width,"x"):Ce.posToVal(Ce.select.top,"x")},J(!0);Ce.setSelect({left:0,width:0,top:0,height:0},!1)}),(E||D!=null)&&x.setCursor({bind:{dblclick:Ce=>()=>{if(!p(Ce.cursor.event))return null;if(E&&w){for(let Ue in Ce.scales)Ue!=="x"&&Ce.setScale(Ue,{min:null,max:null});w=!1}else if(D!=null){let Ue=Ce.scales.x;const Ae=Ue.min,we=Ue.max,We=(we-Ae)/2;D({from:Ae-We,to:we+We})}return null}}}),x.addHook("setData",Ce=>{w=!1,z=!1,X&&xe()}),x.addHook("setSeries",(Ce,Ue)=>{le=Ue,re=Ce.cursor.event==null,ae(),J()}),x.addHook("setLegend",Ce=>{ne=N?.cursor.idxs.slice(),Q=ne.some((Ae,we)=>we>0&&Ae!=null),re=Ce.cursor.event==null;let Ue=H;ae(),(H||H!==Ue)&&J()});const fe=16;let Ee=0,Se=0;const ye=()=>{H&&!X&&xe(),Ee=window.innerWidth-fe,Se=window.innerHeight-fe},Ve=()=>{Z=N.rect.bottom<=Se&&N.rect.top>=0&&N.rect.left>=0&&N.rect.right<=Ee};ye(),x.addHook("ready",Ve),x.addHook("setCursor",Ce=>{if(re=Ce.cursor.event==null,!H)return;let{left:Ue=-10,top:Ae=-10}=Ce.cursor;if(Ue>=0||Ae>=0){let we=Ce.rect.left+Ue,We=Ce.rect.top+Ae,_e="",{width:at,height:ut}=U.current;at+=c,ut+=c,se!==0?We+ut<Se||We-ut<0?se=0:se!==-ut&&(se=-ut):We+ut>Se&&We-ut>=0&&(se=-ut),k!==0?we+at<Ee||we-at<0?k=0:k!==-at&&(k=-at):we+at>Ee&&we-at>=0&&(k=-at);const Tt=we+(k===0?c:-c),It=We+(se===0?c:-c);_e=`translateX(${Tt}px) ${k===0?"":"translateX(-100%)"} translateY(${It}px) ${se===0?"":"translateY(-100%)"}`,O.current!=null?O.current.style.transform=_e:(ee.transform=_e,J())}});const Me=Ce=>{Ve(),H&&Ce.target instanceof Node&&Ce.target.contains(N.root)&&xe()};return window.addEventListener("resize",ye),window.addEventListener("scroll",Me,!0),()=>{window.removeEventListener("resize",ye),window.removeEventListener("scroll",Me,!0),document.removeEventListener("mousedown",ce,!0),document.removeEventListener("keydown",ce,!0)}},[x]),(0,s.useLayoutEffect)(()=>{const w=U.current;if(O.current!=null){w.observer.observe(O.current);const{width:z,height:N}=O.current.getBoundingClientRect();w.width=z,w.height=N;let H=I.cursor.event;if(H!=null){const Q=H.type!=="mousemove";Q&&(H=new MouseEvent("mousemove",{view:window,bubbles:!0,cancelable:!0,clientX:H.clientX,clientY:H.clientY,screenX:H.screenX,screenY:H.screenY})),!(Q?!1:performance.now()-H.timeStamp>16)&&I.over.dispatchEvent(H)}else I.setCursor({left:I.cursor.left,top:I.cursor.top},!0)}else w.width=0,w.height=0},[L]),I&&L?(0,a.createPortal)((0,t.jsxs)("div",{className:(0,n.cx)(F.tooltipWrapper,B&&F.pinned),style:A,"aria-live":"polite","aria-atomic":"true",ref:O,children:[B&&(0,t.jsx)(l.J,{onClick:K}),j]}),M.current):null},y=(x,v)=>({tooltipWrapper:(0,n.css)({top:0,left:0,zIndex:x.zIndex.portal,whiteSpace:"pre",borderRadius:x.shape.radius.default,position:"fixed",background:x.colors.background.primary,border:`1px solid ${x.colors.border.weak}`,boxShadow:x.shadows.z2,userSelect:"text",maxWidth:v??"none"}),pinned:(0,n.css)({boxShadow:x.shadows.z3})})},52811:(G,R,e)=>{"use strict";e.d(R,{R:()=>n,s:()=>t});const t="__fixed";class n{constructor(a){this.props=a}}},16895:(G,R,e)=>{"use strict";e.d(R,{NN:()=>c,Tz:()=>o,UO:()=>x,bq:()=>u,ro:()=>m,sw:()=>p,uY:()=>P});var t=e(11261),n=e(50311),s=e(75059),a=e(57875),r=e(52622),g=e(40621),i=e(91040),l=e(55129);const d=(E,D,C)=>{let b=D%2?C[0]||C[2]:C[1]||C[3];return C[D]||!b?0:8},c={ms:1,focus:{alpha:1},cursor:{focus:{prox:30}},legend:{show:!1},padding:[d,d,d,d],series:[],hooks:{}};var h=(E=>(E[E.Pos=1]="Pos",E[E.Neg=-1]="Neg",E))(h||{});function o(E){let D=[],{series:C,dir:b}=E,T=C.length-1,S=C.slice().reverse();return S.forEach((O,M)=>{if(M!==T){let I=S[M+1];D.push({series:[O,I],dir:-1*b})}}),D}function m(E){let D=new Map;return E.fields.forEach(({config:C,values:b,type:T},S)=>{if(S===0)return;let{custom:O}=C;if(O==null||O.hideFrom?.viz)return;let{stacking:M}=O;if(M==null)return;let{mode:I,group:L}=M;if(I===r.gs.None)return;let B=O.transform,j=f(B,b),A=O.drawStyle,K=A===r.GR.Bars?O.barAlignment:A===r.GR.Line?O.lineInterpolation:null,W=`${j}|${I}|${L}|${(0,l.M)(C,T)}|${A}|${K}`,U=D.get(W);U==null&&(U={series:[],dir:j},D.set(W,U)),U.series.push(S)}),[...D.values()]}function u(E,D,C){let b=Array(E.fields.length),T=D.length,S=E.length,O=T>0?Array(S).fill(0):[],M=T>0?Array(S).fill(!1):[],I=Array.from({length:T},()=>O.slice()),L=Array.from({length:T},()=>M.slice());if(D.forEach((B,j)=>{let A=L[j];B.series.forEach(K=>{let W=E.fields[K];if(W.config.custom?.hideFrom?.viz)return;let U=W.values;for(let F=0;F<S;F++)U[F]!=null&&(A[F]=!0)})}),E.fields.forEach((B,j)=>{let A=B.values;if(j===0){B.type===t.PU.time?b[0]=(0,n.ks)(B).values:b[0]=A;return}let{custom:K}=B.config;if(!K||K.hideFrom?.viz){b[j]=A;return}if(K.transform===r.NU.Constant){let U=A.findIndex(V=>V!=null),F=A[U];A=Array(A.length).fill(void 0),A[U]=F}else if(A=A.slice(),K.transform===r.NU.NegativeY)for(let U=0;U<A.length;U++)A[U]!=null&&(A[U]*=-1);let W=K.stacking?.mode;if(!W||W===r.gs.None)b[j]=A;else{let U=D.findIndex(z=>z.series.indexOf(j)>-1),F=I[U],V=L[U],w=b[j]=Array(S);for(let z=0;z<S;z++){let N=A[z];N!=null?w[z]=F[z]+=N:w[z]=V[z]?F[z]:N}}}),C){let B=b.map((j,A)=>{let K=D.findIndex(W=>W.series.indexOf(A)>-1);return K!==-1?I[K]:j});C({totals:B})}return E.fields.forEach((B,j)=>{if(j===0||B.config.custom?.hideFrom?.viz)return;if(B.config.custom?.stacking?.mode===r.gs.Percent){let K=D.findIndex(V=>V.series.indexOf(j)>-1),W=I[K],U=D[K],F=b[j];for(let V=0;V<S;V++){let w=F[V];w!=null&&(F[V]=W[V]===0?0:U.dir*(w/W[V]))}}}),b}function p(E,D){let C,b=1,T=1,S=E.data[1][D],O=E.data[1][D];for(let M=1;M<E.data.length;M++){const L=E.data[M][D];L!=null&&(S==null?S=L:L>S&&(S=E.data[M][D],b=M),O==null?O=L:L<O&&(O=E.data[M][D],T=M))}return O==null&&S==null?C=void 0:O!=null&&S!=null?C=(E.valToPos(O,E.series[T].scale)+E.valToPos(S,E.series[b].scale))/2:C=E.valToPos(O||S,E.series[b||T].scale),C!==void 0&&C<0&&(C=E.bbox.height/devicePixelRatio),C}function f(E,D){const C=y(D);return E===r.NU.NegativeY?C?1:-1:C?-1:1}function y(E,D=100){const C=E.length;if(C===0)return!1;let b=0,T=C-1;for(;b<=T&&E[b]==null;)b++;for(;T>=b&&E[T]==null;)T--;let S=0,O=0;if(T>=b){const M=Math.max(1,Math.floor((T-b+1)/D));for(let I=b;I<=T;I+=M){const L=E[I];L!=null&&typeof L=="number"&&(L<0||Object.is(L,-0)?S++:L>0&&O++)}if(S>O)return!0}return!1}const x=(E,D,C)=>{if(!E?.length)return[];const b=M=>M==null?"-":M.toFixed(1),T=D.display??b;let S=null;const O=(0,s.Nw)({field:D,reducers:E});return E.map(M=>{const I=s.AS.get(M);let L=T;return I.id===s.gy.diffperc&&(L=(0,a.J)({field:{...D,config:{...D.config,unit:"percent"}},theme:C})),(I.id===s.gy.count||I.id===s.gy.changeCount||I.id===s.gy.distinctCount)&&(S||(S=(0,a.J)({field:{...D,config:{...D.config,unit:"none"}},theme:C})),L=S),{...L(O[M]),title:I.name,description:I.description}})},v=(0,i.h)("uPlot"),P=v.logger;(0,g.h)("graphng",void 0,v)},33083:(G,R,e)=>{"use strict";e.d(R,{H:()=>o,i:()=>m});var t=e(74848),n=e(32196),s=e(61443),a=e(72724),r=e(28122),g=e(9286),i=e(66864),l=e(59093),d=e(64539),c=e(94536),h=e(40845);const o=({getContextMenuSource:p,timeZone:f,itemsGroup:y,dimensions:x,contextDimensions:v,...P})=>{const E=p(),D=y?y.map(T=>({...T,items:T.items?.filter(S=>S.label)})):[],C=()=>{if(!E)return null;let T;if(x?.yAxis&&v?.yAxis?.[1]){const O=(0,s.WK)(x.yAxis,v.yAxis[0],v.yAxis[1]),M=E.series.valueField.display;T=M(O)}const S=(0,a.LE)(E.datapoint[0],{defaultWithMS:E.series.hasMsResolution,timeZone:f});return(0,t.jsx)(m,{timestamp:S,seriesColor:E.series.color,displayName:E.series.alias||E.series.label,displayValue:T})},b=()=>D?.map((T,S)=>(0,t.jsx)(l.r,{label:T.label,children:(T.items||[]).map(O=>(0,t.jsx)(d.D,{url:O.url,label:O.label,target:O.target,icon:O.icon,active:O.active,onClick:O.onClick},`${O.label}`))},`${T.label}${S}`));return(0,t.jsx)(r.t,{...P,renderMenuItems:b,renderHeader:C})},m=({timestamp:p,seriesColor:f,displayName:y,displayValue:x})=>{const v=(0,h.of)(u);return(0,t.jsxs)("div",{className:v.wrapper,children:[(0,t.jsx)("strong",{children:p}),(0,t.jsxs)(i.Gy,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(c.p,{color:f}),(0,t.jsx)("span",{className:v.displayName,children:y})]}),x&&(0,t.jsx)(g.i,{value:x})]})]})};function u(p){return{wrapper:(0,n.css)({padding:p.spacing(.5,1),fontSize:p.typography.size.sm,zIndex:p.zIndex.tooltip}),displayName:(0,n.css)({whiteSpace:"nowrap",paddingLeft:p.spacing(.5)})}}},8984:(G,R,e)=>{"use strict";e.r(R),e.d(R,{ALERTING_COLOR:()=>a.xj,Alert:()=>t.FcD,AlertingSettings:()=>t.ibS,AsyncMultiSelect:()=>t.Ivu,AsyncSelect:()=>t.DWK,AsyncVirtualizedSelect:()=>t.gZN,AutoSaveField:()=>t.p0K,AutoSizeInput:()=>t.Dd_,Avatar:()=>t.euF,AxisPlacement:()=>l.vM,Badge:()=>t.Exy,BarAlignment:()=>l.Nj,BarGauge:()=>t.xEy,BarGaugeDisplayMode:()=>t.eX$,BarValueVisibility:()=>l.TC,BigValue:()=>t.yVm,BigValueColorMode:()=>t.ypG,BigValueGraphMode:()=>t.$p8,BigValueJustifyMode:()=>t.F8C,BigValueTextMode:()=>t.SV3,Box:()=>t.azJ,BracesPlugin:()=>i.e1,BrowserLabel:()=>t.jQM,Button:()=>t.$nd,ButtonCascader:()=>t.HRi,ButtonGroup:()=>t.e2v,ButtonSelect:()=>t.fHW,CallToActionCard:()=>t.cbd,Card:()=>t.ZpM,CardContainer:()=>t.Q_j,Cascader:()=>t.vxQ,CertificationKey:()=>t.KmA,Checkbox:()=>t.Sc0,ClearPlugin:()=>i.vJ,ClickOutsideWrapper:()=>t.NqN,ClipboardButton:()=>t.bLJ,ClipboardPlugin:()=>i.sW,CodeEditor:()=>t.BYM,CodeEditorSuggestionItemKind:()=>t.q0m,CollapsableSection:()=>t.MU_,Collapse:()=>t.SDm,ColorPicker:()=>t.skP,ColorPickerInput:()=>t.itl,ConfirmButton:()=>t.ZFl,ConfirmModal:()=>t.uoB,Container:()=>t.mcf,ContextMenu:()=>t.tzH,ControlledCollapse:()=>t.a2C,Counter:()=>t.phK,CustomHeadersSettings:()=>t.Pli,CustomScrollbar:()=>t.EZm,DEFAULT_ANNOTATION_COLOR:()=>a.Mk,DOMUtil:()=>a.bk,DataLinkButton:()=>t.Rsn,DataLinkInput:()=>t.lZ_,DataLinksContextMenu:()=>t.ebG,DataLinksInlineEditor:()=>t.eHD,DataSourceHttpSettings:()=>t.tco,DatePicker:()=>t.lrV,DatePickerWithInput:()=>t.lS2,DateTimePicker:()=>t.K7n,DeleteButton:()=>t.etH,Divider:()=>t.cGx,DrawStyle:()=>l.yg,Drawer:()=>t._s,Dropdown:()=>t.msM,EmptySearchResult:()=>t.Z7I,EmptyState:()=>t.ppr,ErrorBoundary:()=>t.tHk,ErrorBoundaryAlert:()=>t.XwR,ErrorWithStack:()=>t.DaU,EventBusPlugin:()=>t.Kur,EventsCanvas:()=>t.aaz,EventsWithValidation:()=>a.Pw,FIXED_UNIT:()=>t.sN5,FadeTransition:()=>t.AVJ,FeatureBadge:()=>t.yKR,FeatureInfoBox:()=>t.ep7,Field:()=>t.D0$,FieldArray:()=>t.ED_,FieldLinkList:()=>t.nA8,FieldSet:()=>t.nVY,FieldValidationMessage:()=>t.PgM,FileDropzone:()=>t.gHy,FileDropzoneDefaultChildren:()=>t.wIj,FileListItem:()=>t.IBq,FileUpload:()=>t.ef9,FilterInput:()=>t.ZYI,FilterPill:()=>t.mKT,Form:()=>t.lVW,FormattedValueDisplay:()=>t.i7I,FullWidthButtonContainer:()=>t.Vpd,Gauge:()=>t._I2,GlobalStyles:()=>r.kH,Graph:()=>t.TS0,GraphContextMenu:()=>t.Hdp,GraphContextMenuHeader:()=>t.io8,GraphGradientMode:()=>l.on,GraphNG:()=>t.ovZ,GraphSeriesToggler:()=>t.MTY,GraphThresholdsStyleMode:()=>l.Ly,GraphWithLegend:()=>t.IK5,Grid:()=>t.xA9,HorizontalGroup:()=>t.GyY,Icon:()=>t.Int,IconButton:()=>t.K0,IndentationPlugin:()=>i.TA,InfoBox:()=>t.w4Q,InlineField:()=>t.IP5,InlineFieldRow:()=>t.CeB,InlineFormLabel:()=>t.IjS,InlineLabel:()=>t.c2B,InlineSegmentGroup:()=>t.e8d,InlineSwitch:()=>t.KYK,InlineToast:()=>t.r0T,Input:()=>t.pde,InputControl:()=>t.eyo,InteractiveTable:()=>t.jDF,JSONFormatter:()=>t.BJ$,JsonExplorer:()=>t.OoN,KeyboardPlugin:()=>t.Z7z,Label:()=>t.JU7,LegacyForms:()=>t.rRI,LegacyInputStatus:()=>t.OYG,Legend:()=>t.s$2,LegendDisplayMode:()=>l.lm,LineInterpolation:()=>l.dx,Link:()=>t.N_E,LinkButton:()=>t.z9$,List:()=>t.B8B,LoadingBar:()=>t.GmG,LoadingPlaceholder:()=>t._ae,Marker:()=>t.pH9,Menu:()=>t.W1t,MenuGroup:()=>t.rXV,MenuItem:()=>t.Drp,Modal:()=>t.aFV,ModalHeader:()=>t.rQ0,ModalRoot:()=>t.EOs,ModalTabContent:()=>t.OHP,ModalTabsHeader:()=>t.JXd,ModalsContext:()=>t.wEe,ModalsController:()=>t.$sz,ModalsProvider:()=>t.YO7,MultiSelect:()=>t.KFt,NO_DATA_COLOR:()=>a.nO,NewlinePlugin:()=>i.Om,NodeGraphDataFrameFieldNames:()=>a.uc,OK_COLOR:()=>a.Xw,PENDING_COLOR:()=>a.ct,PageToolbar:()=>t.dAS,Pagination:()=>t.dKS,PanelChrome:()=>t.NRL,PanelChromeLoadingIndicator:()=>t.oQQ,PanelContainer:()=>t._wj,PanelContextProvider:()=>t.XFg,PanelContextRoot:()=>t.e4W,PlotLegend:()=>t.$sV,PluginSignatureBadge:()=>t.Bjr,PointVisibility:()=>l.nT,Popover:()=>t.AMh,PopoverController:()=>t.IE3,Portal:()=>t.ZLI,PortalContainer:()=>t.qB2,QueryField:()=>t.Xjo,REGION_FILL_ALPHA:()=>a.UJ,RadioButtonDot:()=>t.JBW,RadioButtonGroup:()=>t.zWQ,RadioButtonList:()=>t.a0s,RangeSlider:()=>t.F16,ReactMonacoEditor:()=>t.m3b,ReactUtils:()=>a.zt,RefreshPicker:()=>t.cCp,RelativeTimeRangePicker:()=>t.NBP,RenderUserContentAsHTML:()=>t.IUm,RunnerPlugin:()=>i.Ul,SCHEMA:()=>a.yx,ScaleDirection:()=>l.ON,ScaleDistribution:()=>t.L47,ScaleOrientation:()=>l.Lt,SearchFunctionType:()=>a.Tt,SecretInput:()=>t.L44,SecretTextArea:()=>t.lpq,SecureSocksProxySettings:()=>t.YAX,Segment:()=>t.Y4n,SegmentAsync:()=>t.sYD,SegmentInput:()=>t.oyW,SegmentSection:()=>t.Lrm,SegmentSelect:()=>t.a$h,Select:()=>t.l6P,SelectContainer:()=>t.KAb,SelectMenuOptions:()=>t.o5c,SelectionShortcutsPlugin:()=>i.l9,SeriesColorPicker:()=>t.Dpi,SeriesColorPickerPopover:()=>t.o0L,SeriesColorPickerPopoverWithTheme:()=>t.tJM,SeriesIcon:()=>t.pMY,SeriesTable:()=>t.o95,SeriesTableRow:()=>t.gNl,SeriesVisibilityChangeBehavior:()=>t.KHN,SeriesVisibilityChangeMode:()=>t.Bd,SetInterval:()=>t.u3P,SlatePrism:()=>i.De,SlideOutTransition:()=>t.nfS,Slider:()=>t.Apm,Space:()=>t.$xS,Sparkline:()=>t.OW$,Spinner:()=>t.y$y,Stack:()=>t.BJc,StackingMode:()=>l.gs,StatsPicker:()=>t.SPA,SuggestionsPlugin:()=>i.Pz,Switch:()=>t.dOG,TLSAuthSettings:()=>t.jDu,Tab:()=>t.ozo,TabContent:()=>t.JSC,TabbedContainer:()=>t.qtX,Table:()=>t.XIK,TableCellDisplayMode:()=>l.ob,TableInputCSV:()=>t.bwN,TabsBar:()=>t.U05,Tag:()=>t.vwO,TagList:()=>t.LYX,TagsInput:()=>t.um3,Text:()=>t.EYj,TextArea:()=>t.fs1,TextLink:()=>t.YqK,ThemeContext:()=>r.Dx,TimeOfDayPicker:()=>t.R3l,TimePickerTooltip:()=>t.xSz,TimeRangeInput:()=>t.bYj,TimeRangeLabel:()=>t.fD2,TimeRangePicker:()=>t.$64,TimeSeries:()=>t.ZOC,TimeZonePicker:()=>t.U7r,ToggleAllState:()=>t.XNj,Toggletip:()=>t.Gff,ToolbarButton:()=>t.IBt,ToolbarButtonRow:()=>t.Uhs,Tooltip:()=>t.m_M,TooltipDisplayMode:()=>l.$N,TooltipPlugin:()=>t.TkQ,TooltipPlugin2:()=>t.xlH,UPLOT_AXIS_FONT_SIZE:()=>t.piP,UPlotChart:()=>t.ZCE,UPlotConfigBuilder:()=>t.eEE,UnitPicker:()=>t.pKo,UserIcon:()=>t.nys,ValuePicker:()=>t.iyp,VerticalGroup:()=>t.gWJ,VerticalTab:()=>t.sMJ,VirtualizedSelect:()=>t.ipx,VizLayout:()=>t.KUk,VizLegend:()=>t.tZ2,VizLegendListItem:()=>t.MJh,VizRepeater:()=>t.SdN,VizTooltip:()=>t.nRt,VizTooltipContainer:()=>t.oNG,WeekStartPicker:()=>t.l69,WithContextMenu:()=>t.nuT,XYCanvas:()=>t._XZ,ZoomPlugin:()=>t.jnT,ansicolor:()=>a.DB,attachDebugger:()=>a.hF,buildScaleKey:()=>t.Myc,calculateFontSize:()=>a.Vr,clearButtonStyles:()=>t.myI,colors:()=>a.Tj,commonOptionsBuilder:()=>g.j,convertOldAngularValueMapping:()=>t.I1_,createLogger:()=>a.h,defaultIntervals:()=>t.cbf,fieldMatchersUI:()=>t.gso,fuzzyMatch:()=>a.It,getCanvasContext:()=>a.Yc,getCardStyles:()=>t.Hut,getCellLinks:()=>a.kl,getDragStyles:()=>t.lBN,getInputStyles:()=>t.na7,getPortalContainer:()=>t.gF8,getScrollbarWidth:()=>a.XJ,getSelectStyles:()=>t.Jq4,getTagColor:()=>a.yC,getTagColorIndexFromName:()=>a.JF,getTagColorsFromName:()=>a.MC,getTextColorForAlphaBackground:()=>a.mZ,getTextColorForBackground:()=>a.sg,getTheme:()=>r.O4,getWeekStart:()=>t.rLY,graphFieldOptions:()=>t.ti9,graphTickFormatter:()=>t.YnM,graphTimeFormat:()=>t.JcZ,hasValidationEvent:()=>a.K,isCompactUrl:()=>a.Fr,linkModelToContextMenuItems:()=>a.Jl,makeFragment:()=>a.dF,makeValue:()=>a.mO,measureText:()=>a.kD,mockTheme:()=>r.mG,mockThemeContext:()=>r.fq,preparePlotFrame:()=>t.mYT,regexValidation:()=>a.RP,resetSelectStyles:()=>t.aLN,sharedInputStyle:()=>t.Xb,sharedSingleStatMigrationHandler:()=>t._$q,sharedSingleStatPanelChangedHandler:()=>t.glJ,sortedColors:()=>a.Ih,styleMixins:()=>r.YF,stylesFactory:()=>r.N3,useForceUpdate:()=>a.CH,useGraphNGContext:()=>t.IyU,usePanelContext:()=>t.d2s,useSplitter:()=>t.hrX,useStyles:()=>r.IS,useStyles2:()=>r.of,useTheme:()=>r.DP,useTheme2:()=>r.$j,validate:()=>a.tf,variableSuggestionToCodeEditorSuggestion:()=>t.OOt,withErrorBoundary:()=>t.Xc0,withTheme:()=>r.SL,withTheme2:()=>r.cV});var t=e(96129),n=e(80186),s={};for(const d in n)["default","Alert","AlertingSettings","AsyncMultiSelect","AsyncSelect","AsyncVirtualizedSelect","AutoSaveField","AutoSizeInput","Avatar","Badge","BarGauge","BarGaugeDisplayMode","BigValue","BigValueColorMode","BigValueGraphMode","BigValueJustifyMode","BigValueTextMode","Box","BrowserLabel","Button","ButtonCascader","ButtonGroup","ButtonSelect","CallToActionCard","Card","CardContainer","Cascader","CertificationKey","Checkbox","ClickOutsideWrapper","ClipboardButton","CodeEditor","CodeEditorSuggestionItemKind","CollapsableSection","Collapse","ColorPicker","ColorPickerInput","ConfirmButton","ConfirmModal","Container","ContextMenu","ControlledCollapse","Counter","CustomHeadersSettings","CustomScrollbar","DataLinkButton","DataLinkInput","DataLinksContextMenu","DataLinksInlineEditor","DataSourceHttpSettings","DatePicker","DatePickerWithInput","DateTimePicker","DeleteButton","Divider","Drawer","Dropdown","EmptySearchResult","EmptyState","ErrorBoundary","ErrorBoundaryAlert","ErrorWithStack","EventBusPlugin","EventsCanvas","FIXED_UNIT","FadeTransition","FeatureBadge","FeatureInfoBox","Field","FieldArray","FieldLinkList","FieldSet","FieldValidationMessage","FileDropzone","FileDropzoneDefaultChildren","FileListItem","FileUpload","FilterInput","FilterPill","Form","FormattedValueDisplay","FullWidthButtonContainer","Gauge","Graph","GraphContextMenu","GraphContextMenuHeader","GraphNG","GraphSeriesToggler","GraphWithLegend","Grid","HorizontalGroup","Icon","IconButton","InfoBox","InlineField","InlineFieldRow","InlineFormLabel","InlineLabel","InlineSegmentGroup","InlineSwitch","InlineToast","Input","InputControl","InteractiveTable","JSONFormatter","JsonExplorer","KeyboardPlugin","Label","LegacyForms","LegacyInputStatus","Legend","Link","LinkButton","List","LoadingBar","LoadingPlaceholder","Marker","Menu","MenuGroup","MenuItem","Modal","ModalHeader","ModalRoot","ModalTabContent","ModalTabsHeader","ModalsContext","ModalsController","ModalsProvider","MultiSelect","PageToolbar","Pagination","PanelChrome","PanelChromeLoadingIndicator","PanelContainer","PanelContextProvider","PanelContextRoot","PlotLegend","PluginSignatureBadge","Popover","PopoverController","Portal","PortalContainer","QueryField","RadioButtonDot","RadioButtonGroup","RadioButtonList","RangeSlider","ReactMonacoEditor","RefreshPicker","RelativeTimeRangePicker","RenderUserContentAsHTML","ScaleDistribution","SecretInput","SecretTextArea","SecureSocksProxySettings","Segment","SegmentAsync","SegmentInput","SegmentSection","SegmentSelect","Select","SelectContainer","SelectMenuOptions","SeriesColorPicker","SeriesColorPickerPopover","SeriesColorPickerPopoverWithTheme","SeriesIcon","SeriesTable","SeriesTableRow","SeriesVisibilityChangeBehavior","SeriesVisibilityChangeMode","SetInterval","SlideOutTransition","Slider","Space","Sparkline","Spinner","Stack","StatsPicker","Switch","TLSAuthSettings","Tab","TabContent","TabbedContainer","Table","TableInputCSV","TabsBar","Tag","TagList","TagsInput","Text","TextArea","TextLink","TimeOfDayPicker","TimePickerTooltip","TimeRangeInput","TimeRangeLabel","TimeRangePicker","TimeSeries","TimeZonePicker","ToggleAllState","Toggletip","ToolbarButton","ToolbarButtonRow","Tooltip","TooltipPlugin","TooltipPlugin2","UPLOT_AXIS_FONT_SIZE","UPlotChart","UPlotConfigBuilder","UnitPicker","UserIcon","ValuePicker","VerticalGroup","VerticalTab","VirtualizedSelect","VizLayout","VizLegend","VizLegendListItem","VizRepeater","VizTooltip","VizTooltipContainer","WeekStartPicker","WithContextMenu","XYCanvas","ZoomPlugin","buildScaleKey","clearButtonStyles","convertOldAngularValueMapping","defaultIntervals","fieldMatchersUI","getCardStyles","getDragStyles","getInputStyles","getPortalContainer","getSelectStyles","getWeekStart","graphFieldOptions","graphTickFormatter","graphTimeFormat","preparePlotFrame","resetSelectStyles","sharedInputStyle","sharedSingleStatMigrationHandler","sharedSingleStatPanelChangedHandler","useGraphNGContext","usePanelContext","useSplitter","variableSuggestionToCodeEditorSuggestion","withErrorBoundary"].indexOf(d)<0&&(s[d]=()=>n[d]);e.d(R,s);var a=e(67985),r=e(7918),g=e(42482),i=e(50955),l=e(49149)},38248:(G,R,e)=>{"use strict";e.d(R,{W:()=>m,r:()=>c});var t=e(74848),n=e(11261),s=e(27310),a=e(52622),r=e(88575),g=e(94354),i=e(10354),l=e(90182),d=e(52198);function c(u,p,f){const y=["Axis"];u.addRadio({path:"axisPlacement",name:"Placement",category:y,defaultValue:d.t.axisPlacement[0].value,settings:{options:d.t.axisPlacement}}).addTextInput({path:"axisLabel",name:"Label",category:y,defaultValue:"",settings:{placeholder:"Optional text",expandTemplateVars:!0},showIf:x=>x.axisPlacement!==a.vM.Hidden,shouldApply:x=>x.type!==n.PU.time&&x.type!==n.PU.string}).addNumberInput({path:"axisWidth",name:"Width",category:y,settings:{placeholder:"Auto"},showIf:x=>x.axisPlacement!==a.vM.Hidden}).addRadio({path:"axisGridShow",name:"Show grid lines",category:y,defaultValue:void 0,settings:{options:[{value:void 0,label:"Auto"},{value:!0,label:"On"},{value:!1,label:"Off"}]},showIf:x=>x.axisPlacement!==a.vM.Hidden}).addRadio({path:"axisColorMode",name:"Color",category:y,defaultValue:a.Y$.Text,settings:{options:[{value:a.Y$.Text,label:"Text"},{value:a.Y$.Series,label:"Series"}]},showIf:x=>x.axisPlacement!==a.vM.Hidden}).addBooleanSwitch({path:"axisBorderShow",name:"Show border",category:y,defaultValue:!1,showIf:x=>x.axisPlacement!==a.vM.Hidden}),u.addCustomEditor({id:"scaleDistribution",path:"scaleDistribution",name:"Scale",category:y,editor:m,override:m,defaultValue:{type:a.L4.Linear},shouldApply:x=>x.type===n.PU.number,process:s.hS}).addBooleanSwitch({path:"axisCenteredZero",name:"Centered zero",category:y,defaultValue:!1,showIf:x=>x.scaleDistribution?.type!==a.L4.Log}).addNumberInput({path:"axisSoftMin",name:"Soft min",defaultValue:p.axisSoftMin,category:y,settings:{placeholder:"See: Standard options > Min"}}).addNumberInput({path:"axisSoftMax",name:"Soft max",defaultValue:p.axisSoftMax,category:y,settings:{placeholder:"See: Standard options > Max"}})}const h=[{label:"Linear",value:a.L4.Linear},{label:"Logarithmic",value:a.L4.Log},{label:"Symlog",value:a.L4.Symlog}],o=[{label:"2",value:2},{label:"10",value:10}],m=({value:u,onChange:p})=>{const f=u?.type??a.L4.Linear,y=u?.log??2;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{marginBottom:16},children:(0,t.jsx)(g.z,{value:f,options:h,onChange:x=>{p({...u,type:x,log:x===a.L4.Linear?void 0:y})}})}),(f===a.L4.Log||f===a.L4.Symlog)&&(0,t.jsx)(r.D,{label:"Log base",children:(0,t.jsx)(l.l6,{options:o,value:y,onChange:x=>{p({...u,log:x.value})}})}),f===a.L4.Symlog&&(0,t.jsx)(r.D,{label:"Linear threshold",children:(0,t.jsx)(i.p,{placeholder:"1",value:u?.linearThreshold,onChange:x=>{p({...u,linearThreshold:Number(x.currentTarget.value)})}})})]})}},11404:(G,R,e)=>{"use strict";e.d(R,{e:()=>l});var t=e(74848),n=e(2543),s=e.n(n),a=e(96540),r=e(92174),g=e(67061);const i=({value:d,onChange:c})=>{const h=(0,a.useCallback)(o=>{c({...d,[o]:!d[o]})},[d,c]);return(0,t.jsx)(g.B,{gap:.5,children:Object.keys(d).map(o=>{const m=o;return(0,t.jsx)(r.m,{icon:d[m]?"eye-slash":"eye",onClick:()=>h(m),label:(0,n.startCase)(m),selected:d[m]},m)})})};function l(d){d.addCustomEditor({id:"hideFrom",name:"Hide in area",category:["Series"],path:"hideFrom",defaultValue:{tooltip:!1,viz:!1,legend:!1},editor:i,override:i,shouldApply:()=>!0,hideFromDefaults:!0,process:c=>c})}},22680:(G,R,e)=>{"use strict";e.d(R,{H:()=>s});var t=e(69550),n=e(52622);function s(a,r=!0,g=!0){a.addBooleanSwitch({path:"legend.showLegend",name:"Visibility",category:["Legend"],description:"",defaultValue:g}).addRadio({path:"legend.displayMode",name:"Mode",category:["Legend"],description:"",defaultValue:n.lm.List,settings:{options:[{value:n.lm.List,label:"List"},{value:n.lm.Table,label:"Table"}]},showIf:i=>i.legend.showLegend}).addRadio({path:"legend.placement",name:"Placement",category:["Legend"],description:"",defaultValue:"bottom",settings:{options:[{value:"bottom",label:"Bottom"},{value:"right",label:"Right"}]},showIf:i=>i.legend.showLegend}).addNumberInput({path:"legend.width",name:"Width",category:["Legend"],settings:{placeholder:"Auto"},showIf:i=>i.legend.showLegend&&i.legend.placement==="right"}),r&&a.addCustomEditor({id:"legend.calcs",path:"legend.calcs",name:"Values",category:["Legend"],description:"Select values or calculations to show in legend",editor:t.D.get("stats-picker").editor,defaultValue:[],settings:{allowMultiple:!0},showIf:i=>i.legend.showLegend!==!1})}},56675:(G,R,e)=>{"use strict";e.d(R,{I:()=>h,m:()=>c});var t=e(74848),n=e(27310),s=e(11261),a=e(52622),r=e(94354),g=e(29158),i=e(10354),l=e(67061),d=e(52198);const c=({value:o,context:m,onChange:u,item:p})=>(0,t.jsxs)(l.B,{children:[(0,t.jsx)(r.z,{value:o?.mode||a.gs.None,options:p.settings?.options??[],onChange:f=>{u({...o,mode:f})}}),m.isOverride&&o?.mode&&o?.mode!==a.gs.None&&(0,t.jsx)(i.p,{type:"text",placeholder:"Group",suffix:(0,t.jsx)(g.K,{name:"question-circle",tooltip:"Name of the stacking group",tooltipPlacement:"top"}),defaultValue:o?.group,onChange:f=>{u({...o,group:f.currentTarget.value.trim()})}})]});function h(o,m,u=["Graph styles"]){o.addCustomEditor({id:"stacking",path:"stacking",name:"Stack series",category:u,defaultValue:m,editor:c,override:c,settings:{options:d.t.stacking},process:n.hS,shouldApply:p=>p.type===s.PU.number})}},71242:(G,R,e)=>{"use strict";e.d(R,{I:()=>t});function t(n,s=!0){s&&n.addNumberInput({path:"text.titleSize",category:["Text size"],name:"Title",settings:{placeholder:"Auto",integer:!1,min:1,max:200},defaultValue:void 0}),n.addNumberInput({path:"text.valueSize",category:["Text size"],name:"Value",settings:{placeholder:"Auto",integer:!1,min:1,max:200},defaultValue:void 0})}},89654:(G,R,e)=>{"use strict";e.d(R,{D:()=>n});var t=e(52622);function n(s,a=!1,r=!1,g){const i=["Tooltip"],l=a?[{value:t.$N.Single,label:"Single"},{value:t.$N.None,label:"Hidden"}]:[{value:t.$N.Single,label:"Single"},{value:t.$N.Multi,label:"All"},{value:t.$N.None,label:"Hidden"}],d=[{value:t.xB.None,label:"None"},{value:t.xB.Ascending,label:"Ascending"},{value:t.xB.Descending,label:"Descending"}];s.addRadio({path:"tooltip.mode",name:"Tooltip mode",category:i,defaultValue:g?.tooltip?.mode??t.$N.Single,settings:{options:l}}).addRadio({path:"tooltip.sort",name:"Values sort order",category:i,defaultValue:g?.tooltip?.sort??t.xB.None,showIf:c=>c.tooltip?.mode===t.$N.Multi,settings:{options:d}}),r&&s.addNumberInput({path:"tooltip.hoverProximity",name:"Hover proximity",description:"How close the cursor must be to a point to trigger the tooltip, in pixels",category:i,settings:{integer:!0},showIf:c=>c.tooltip?.mode!==t.$N.None}),s.addNumberInput({path:"tooltip.maxWidth",name:"Max width",category:i,settings:{integer:!0},showIf:c=>c.tooltip?.mode!==t.$N.None}).addNumberInput({path:"tooltip.maxHeight",name:"Max height",category:i,defaultValue:void 0,settings:{integer:!0},showIf:c=>c.tooltip?.mode===t.$N.Multi})}},42482:(G,R,e)=>{"use strict";e.d(R,{j:()=>t});var t={};e.r(t),e.d(t,{ScaleDistributionEditor:()=>n.W,StackingEditor:()=>i.m,addAxisConfig:()=>n.r,addHideFrom:()=>s.e,addLegendOptions:()=>a.H,addStackingConfig:()=>i.I,addTextSizeOptions:()=>g.I,addTooltipOptions:()=>r.D});var n=e(38248),s=e(11404),a=e(22680),r=e(89654),g=e(71242),i=e(56675)},49149:(G,R,e)=>{"use strict";e.d(R,{$N:()=>t.$N,Lt:()=>t.Lt,Ly:()=>t.Ly,Nj:()=>t.Nj,ON:()=>t.ON,TC:()=>t.yL,dx:()=>t.dx,gs:()=>t.gs,lm:()=>t.lm,nT:()=>t.yL,ob:()=>t.ob,on:()=>t.on,vM:()=>t.vM,yg:()=>t.GR});var t=e(52622)},74738:(G,R,e)=>{"use strict";e.d(R,{v:()=>t});function t(){return{onKeyDown(n,s,a){const r=s.value;if(r.selection.isExpanded)return a();if(n.key==="k"&&n.ctrlKey){n.preventDefault();const g=r.anchorText.text,i=r.selection.anchor.offset,d=g.length-i;return s.deleteForward(d),!0}return a()}}}},99453:(G,R,e)=>{"use strict";e.d(R,{s:()=>s});const t=(a,r,g)=>{if(!a.length)return;const i=a.slice(0,-1).join("").length+a.length-1;return a.join(`
`).slice(r,i+g)},n=a=>a?.replace(/[\uFEFF]/g,"");function s(){const a={onCopy(r,g,i){r.preventDefault();const{document:l,selection:d}=g.value,{start:{offset:c},end:{offset:h}}=d,o=l.getLeafBlocksAtRange(d).toArray().map(u=>u.text),m=n(t(o,c,h));return m&&r.clipboardData&&r.clipboardData.setData("Text",m),!0},onPaste(r,g,i){if(r.preventDefault(),r.clipboardData){const d=n(r.clipboardData.getData("Text"))?.split(`
`);if(d&&d.length){g.insertText(d[0]);for(const c of d.slice(1))g.splitBlock().insertText(c)}}return!0}};return{...a,onCut(r,g,i){return a.onCopy(r,g,i),g.deleteAtRange(g.value.selection),!0}}}},1020:(G,R,e)=>{"use strict";e.d(R,{T:()=>c});var t=e(57746),n=e(82611),s=e(52845);const a=(0,t.Sn)("mod+["),r=(0,t.Sn)("shift+tab"),g=(0,t.Sn)("mod+]"),i="  ",l=(h,o,m)=>{const{startBlock:u,endBlock:p,selection:{start:{offset:f,key:y},end:{offset:x,key:v}}}=o.value;if(s.default.serialize(o.value)==="")return;h.preventDefault();const P=u.getFirstText();P&&f===0&&y===P.key&&x===P.text.length&&v===P.key||!u.equals(p)?d(o,"right"):o.insertText(i)},d=(h,o)=>{const m=h.value.selection,u=h.value.document.getLeafBlocksAtRange(m).toArray();if(o==="left")for(const p of u){const f=p.text.length-p.text.trimLeft().length,y=p.getFirstText().key,x={anchor:{key:y,offset:f,path:[]},focus:{key:y,offset:f,path:[]}};h.deleteBackwardAtRange(n.Range.create(x),Math.min(i.length,f))}else{const{startText:p}=h.value,f=p.text.slice(0,m.start.offset),y=/^\s*$/.test(f);for(const x of u)h.insertTextByKey(x.getFirstText().key,0,i);y&&h.moveStartBackward(i.length)}};function c(){return{onKeyDown(h,o,m){if(a(h)||r(h))h.preventDefault(),d(o,"left");else if(g(h))h.preventDefault(),d(o,"right");else if(h.key==="Tab")l(h,o,m);else return m();return!0}}}},50955:(G,R,e)=>{"use strict";e.d(R,{e1:()=>a,vJ:()=>r.v,sW:()=>g.s,TA:()=>i.T,Om:()=>l.O,Ul:()=>d.U,l9:()=>c.l,De:()=>h.D,Pz:()=>o.Pz});var t=e(62938);const n={"[":"]","{":"}","(":")"},s="brace_match";function a(){return{onKeyDown(m,u,p){const{value:f}=u;switch(m.key){case"(":case"{":case"[":{const{start:{offset:y,key:x},end:{offset:v,key:P},focus:{offset:E}}=f.selection,D=f.focusText.text;if(f.selection.isExpanded)return m.preventDefault(),u.insertTextByKey(x,y,m.key).insertTextByKey(P,v+1,n[m.key]).moveEndBackward(1),!0;if(E===D.length||D[E]===" "||Object.values(n).includes(D[E])){m.preventDefault();const C=n[m.key],b={key:`${s}-${(0,t.A)()}`,type:`${s}-${C}`,anchor:{key:x,offset:y,object:"point"},focus:{key:P,offset:v+1,object:"point"},object:"annotation"};return u.insertText(m.key).insertText(C).addAnnotation(b).moveBackward(1),!0}break}case")":case"}":case"]":{const y=f.anchorText.text,x=f.selection.anchor.offset,v=y[x],P=m.key,E=`${s}-${P}`,D=f.annotations.find(C=>C?.type===E&&C.anchor.key===f.anchorText.key);if(D&&v===P&&!f.selection.isExpanded)return m.preventDefault(),u.moveFocusForward(1).removeAnnotation(D).moveAnchorForward(1),!0;break}case"Backspace":{const y=f.anchorText.text,x=f.selection.anchor.offset,v=y[x-1],P=y[x];if(n[v]&&n[v]===P)return m.preventDefault(),u.deleteBackward(1).deleteForward(1).focus(),!0}default:break}return p()}}}var r=e(74738),g=e(99453),i=e(1020),l=e(88295),d=e(4269),c=e(31589),h=e(41781),o=e(80903)},88295:(G,R,e)=>{"use strict";e.d(R,{O:()=>n});function t(s){let a=s.length-s.trimLeft().length;if(a){let r=s[0];for(;--a;)r+=s[0];return r}return""}function n(){return{onKeyDown(s,a,r){const g=a.value;if(g.selection.isExpanded)return r();if(s.key==="Enter"){s.preventDefault();const{startBlock:i}=g,l=i.text,d=t(l);return a.splitBlock().insertText(d).focus()}return r()}}}},4269:(G,R,e)=>{"use strict";e.d(R,{U:()=>t});function t({handler:n}){return{onKeyDown(s,a,r){return n&&s.key==="Enter"&&(s.shiftKey||s.ctrlKey)?(s.preventDefault(),n(s),a):r()}}}},31589:(G,R,e)=>{"use strict";e.d(R,{l:()=>s});var t=e(57746);const n=(0,t.Sn)("mod+l");function s(){return{onKeyDown(a,r,g){if(n(a)){a.preventDefault();const{focusBlock:i,document:l}=r.value;r.moveAnchorToStartOfBlock(),l.getNextBlock(i.key)?r.moveFocusToStartOfNextBlock():r.moveFocusToEndOfText()}else return g();return!0}}}},84694:(G,R,e)=>{"use strict";e.d(R,{A:()=>n});const n="prism-token"},41781:(G,R,e)=>{"use strict";e.d(R,{D:()=>o,R:()=>f});var t=e(28848),n=e.n(t),s=e(82611),a=e(84694),r=e(74848),g=e(49568);function i(y){return y.object==="block"&&y.type==="code_block"}function l(y){return"javascript"}function d(y,x,v){const{decoration:P}=y;if(P.type!==a.A)return v();const E=P.data.get("className");return(0,r.jsx)("span",{className:E,children:y.children})}class c extends(0,g.Record)({onlyIn:i,getSyntax:l,renderDecoration:d}){constructor(x){super(x)}}const h=c;function o(y={},x=n().languages){const v=new h(y);return{decorateNode:(P,E,D)=>{if(!v.onlyIn(P))return D();const C=s.Block.create(P),b=v.getSyntax(C),T=x[b];if(!T)return[];const O=C.getTexts().map(B=>B&&B.getText()).join(`
`),M=n().tokenize(O,T),I=f(M),L=E.value.data.set("tokens",I);return E.setData(L),m(v,M,C)},renderDecoration:(P,E,D)=>v.renderDecoration({children:P.children,decoration:P.decoration},E,D)}}function m(y,x,v){const P=v.getTexts(),E=[];let D=0,C=0;return P.forEach(b=>{C=D+b.getText().length;let T=0;function S(O,M){if(typeof O=="string"){if(M){const I=u({text:b,textStart:D,textEnd:C,start:T,end:T+O.length,className:`prism-token token ${M}`,block:v});I&&E.push(I)}T+=O.length}else if(M=`${M} ${O.type}`,O.alias&&(M+=" "+O.alias),typeof O.content=="string"){const I=u({text:b,textStart:D,textEnd:C,start:T,end:T+O.content.length,className:`prism-token token ${M}`,block:v});I&&E.push(I),T+=O.content.length}else for(let I=0;I<O.content.length;I+=1)S(O.content[I],M)}x.forEach(S),D=C+1}),E}function u({text:y,textStart:x,textEnd:v,start:P,end:E,className:D,block:C}){return P>=v||E<=x?null:(P=Math.max(P,x),E=Math.min(E,v),P-=x,E-=x,C.createDecoration({object:"decoration",anchor:{key:y.key,offset:P,object:"point"},focus:{key:y.key,offset:E,object:"point"},type:a.A,data:{className:D}}))}function p(y){return typeof y=="string"?[{content:y,types:[],aliases:[]}]:Array.isArray(y)?y.flatMap(x=>p(x)):y instanceof n().Token?p(y.content).flatMap(x=>{let v=[];return typeof y.alias=="string"?v=[y.alias]:v=y.alias??[],{content:x.content,types:[y.type,...x.types],aliases:[...v,...x.aliases]}}):[]}function f(y){const x=p(y);if(!x.length)return[];const v=x[0];v.prev=null,v.next=x.length>=2?x[1]:null,v.offsets={start:0,end:v.content.length};for(let E=1;E<x.length-1;E++)x[E].prev=x[E-1],x[E].next=x[E+1],x[E].offsets={start:x[E-1].offsets.end,end:x[E-1].offsets.end+x[E].content.length};const P=x[x.length-1];return P.prev=x.length>=2?x[x.length-2]:null,P.next=null,P.offsets={start:x.length>=2?x[x.length-2].offsets.end:0,end:x.length>=2?x[x.length-2].offsets.end+P.content.length:P.content.length},x}},80903:(G,R,e)=>{"use strict";e.d(R,{Pz:()=>A});var t=e(74848),n=e(2543),s=e(32196),a=e(96540),r=e(40961),g=e(91793),i=e(60578),l=e(50774),d=e(49579);const c=U=>U.reduce((F,{items:V,label:w})=>(F.push({label:w,kind:l.I.GroupTitle}),V.reduce((z,N)=>(z.push(N),z),F)),[]),h=U=>U.reduce((F,V)=>F.length<V.label.length?V.label:F,""),o=(U,F,V)=>{const w=(0,d.A)(V,{font:U.typography.fontFamilyMonospace,fontSize:U.typography.bodySmall.fontSize,fontWeight:"normal"}),z=u(w.width,U),N=m(w.height,U),H=p(N,F);return{listWidth:z,listHeight:H,itemHeight:N}},m=(U,F)=>{const V=F.spacing.gridSize*2;return U+V},u=(U,F)=>{const V=F.spacing.gridSize*3;return Math.min(Math.max(U+V,200),800)},p=(U,F)=>{const V=Math.min(F.length,10),w=100,z=V*U;return Math.max(z,w)};var f=e(36663),y=e(40845);const x=(U,F,V)=>({typeaheadItem:(0,s.css)({label:"type-ahead-item",zIndex:11,padding:U.spacing(1,1,1,2),border:U.colors.border.medium,overflowY:"scroll",overflowX:"hidden",outline:"none",background:U.colors.background.secondary,color:U.colors.text.secondary,boxShadow:`0 0 20px ${U.v1.colors.dropdownShadow}`,visibility:V===!0?"visible":"hidden",width:"250px",minHeight:`${F+parseInt(U.spacing(.25),10)}px`,position:"relative",wordBreak:"break-word"})}),v=({item:U,height:F})=>{const V=U&&!!U.documentation,w=U?U.label:"",z=(0,f.G)(U?.documentation),N=(0,y.$j)(),H=x(N,F,V);return(0,t.jsxs)("div",{className:(0,s.cx)([H.typeaheadItem]),children:[(0,t.jsx)("b",{children:w}),(0,t.jsx)("hr",{}),(0,t.jsx)("div",{dangerouslySetInnerHTML:{__html:z}})]})};var P=e(23257),E=e.n(P),D=e(5313);const C=U=>({typeaheadItem:(0,s.css)({border:"none",background:"none",textAlign:"left",label:"type-ahead-item",height:"auto",fontFamily:U.typography.fontFamilyMonospace,padding:U.spacing(1,1,1,2),fontSize:U.typography.bodySmall.fontSize,textOverflow:"ellipsis",overflow:"hidden",zIndex:11,display:"block",whiteSpace:"nowrap",cursor:"pointer",[U.transitions.handleMotion("no-preference","reduce")]:{transition:"color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), border-color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), background 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), padding 0.15s cubic-bezier(0.645, 0.045, 0.355, 1)"}}),typeaheadItemSelected:(0,s.css)({label:"type-ahead-item-selected",backgroundColor:U.colors.background.secondary}),typeaheadItemMatch:(0,s.css)({label:"type-ahead-item-match",color:U.v1.palette.yellow,borderBottom:`1px solid ${U.v1.palette.yellow}`,padding:"inherit",background:"inherit"}),typeaheadItemGroupTitle:(0,s.css)({label:"type-ahead-item-group-title",color:U.colors.text.secondary,fontSize:U.typography.bodySmall.fontSize,lineHeight:U.typography.body.lineHeight,padding:U.spacing(1)})}),b=U=>{const F=(0,y.of)(C),{isSelected:V,item:w,prefix:z,style:N,onMouseEnter:H,onMouseLeave:Q,onClickItem:X}=U,ee=V?(0,s.cx)([F.typeaheadItem,F.typeaheadItemSelected]):(0,s.cx)([F.typeaheadItem]),Z=(0,s.cx)([F.typeaheadItemMatch]),q=(0,s.cx)([F.typeaheadItemGroupTitle]),ae=w.label||"";return w.kind===l.I.GroupTitle?(0,t.jsx)("li",{className:q,style:N,children:(0,t.jsx)("span",{children:ae})}):(0,t.jsx)("li",{role:"none",children:(0,t.jsx)("button",{role:"menuitem",className:ee,style:N,onMouseDown:X,onMouseEnter:H,onMouseLeave:Q,type:"button",children:w.highlightParts!==void 0?(0,t.jsx)(D.z,{text:ae,highlightClassName:Z,highlightParts:w.highlightParts}):(0,t.jsx)(E(),{textToHighlight:ae,searchWords:[z??""],autoEscape:!0,highlightClassName:Z})})})},T=(U,F)=>U-F*Math.floor(U/F);class S extends a.PureComponent{constructor(){super(...arguments),this.listRef=(0,a.createRef)(),this.state={hoveredItem:null,typeaheadIndex:null,allItems:[],listWidth:-1,listHeight:-1,itemHeight:-1},this.componentDidMount=()=>{this.props.menuRef&&this.props.menuRef(this),document.addEventListener("selectionchange",this.handleSelectionChange);const F=c(this.props.groupedItems),V=h(F),{listWidth:w,listHeight:z,itemHeight:N}=o(this.context,F,V);this.setState({listWidth:w,listHeight:z,itemHeight:N,allItems:F})},this.componentWillUnmount=()=>{document.removeEventListener("selectionchange",this.handleSelectionChange)},this.handleSelectionChange=()=>{this.forceUpdate()},this.componentDidUpdate=(F,V)=>{if(this.state.typeaheadIndex!==null&&V.typeaheadIndex!==this.state.typeaheadIndex&&this.listRef&&this.listRef.current){if(this.state.typeaheadIndex===1){this.listRef.current.scrollToItem(0);return}this.listRef.current.scrollToItem(this.state.typeaheadIndex)}if((0,n.isEqual)(F.groupedItems,this.props.groupedItems)===!1){const w=c(this.props.groupedItems),z=h(w),{listWidth:N,listHeight:H,itemHeight:Q}=o(this.context,w,z);this.setState({listWidth:N,listHeight:H,itemHeight:Q,allItems:w,typeaheadIndex:null})}},this.onMouseEnter=F=>{this.setState({hoveredItem:F})},this.onMouseLeave=()=>{this.setState({hoveredItem:null})},this.moveMenuIndex=F=>{const V=this.state.allItems.length;if(V){const w=this.state.typeaheadIndex||0;let z=T(w+F,V);this.state.allItems[z].kind===l.I.GroupTitle&&(z=T(z+F,V)),this.setState({typeaheadIndex:z});return}},this.insertSuggestion=()=>{this.props.onSelectSuggestion&&this.state.typeaheadIndex!==null&&this.props.onSelectSuggestion(this.state.allItems[this.state.typeaheadIndex])}}static{this.contextType=i.D}get menuPosition(){if(!window.getSelection)return"";const F=window.getSelection(),V=F&&F.anchorNode;if(V&&V.parentElement){const w=V.parentElement.getBoundingClientRect(),z=window.scrollX,N=window.scrollY;return`position: absolute; display: flex; top: ${w.top+N+w.height+6}px; left: ${w.left+z-2}px`}return""}render(){const{prefix:F,isOpen:V=!1,origin:w}=this.props,{allItems:z,listWidth:N,listHeight:H,itemHeight:Q,hoveredItem:X,typeaheadIndex:ee}=this.state,Z=M(this.context),q=X||ee,ae=z[X||ee||0];return(0,t.jsxs)(O,{origin:w,isOpen:V,style:this.menuPosition,children:[(0,t.jsx)("ul",{role:"menu",className:Z.typeahead,"data-testid":"typeahead",children:(0,t.jsx)(g.Y1,{ref:this.listRef,itemCount:z.length,itemSize:Q,itemKey:k=>{const se=z&&z[k];return se?`${k}-${se.label}`:`${k}`},width:N,height:H,children:({index:k,style:se})=>{const te=z&&z[k];return te?(0,t.jsx)(b,{onClickItem:()=>this.props.onSelectSuggestion?this.props.onSelectSuggestion(te):{},isSelected:ee===null?!1:z[ee]===te,item:te,prefix:F,style:se,onMouseEnter:()=>this.onMouseEnter(k),onMouseLeave:this.onMouseLeave}):null}})}),q&&(0,t.jsx)(v,{height:H,item:ae})]})}}class O extends a.PureComponent{constructor(F){super(F);const{index:V=0,origin:w="query",style:z}=F;this.node=document.createElement("div"),this.node.setAttribute("style",z),this.node.classList.add(`slate-typeahead-${w}-${V}`),document.body.appendChild(this.node)}componentWillUnmount(){document.body.removeChild(this.node)}render(){return this.props.isOpen?(this.node.setAttribute("style",this.props.style),this.node.classList.add("slate-typeahead--open"),r.createPortal(this.props.children,this.node)):(this.node.classList.remove("slate-typeahead--open"),null)}}const M=U=>({typeahead:(0,s.css)({position:"relative",zIndex:U.zIndex.typeahead,borderRadius:U.shape.radius.default,border:`1px solid ${U.components.panel.borderColor}`,maxHeight:"66vh",overflowY:"scroll",overflowX:"hidden",outline:"none",listStyle:"none",background:U.components.panel.background,color:U.colors.text.primary,boxShadow:U.shadows.z2,strong:{color:U.v1.palette.yellow}})});var I=e(72307),L=e(75071),B=e(84694);const j=250;function A({onTypeahead:U,cleanText:F,onWillApplySuggestion:V,portalOrigin:w}){let z,N={groupedItems:[],typeaheadPrefix:"",typeaheadContext:"",typeaheadText:""};const H=(0,n.debounce)(K,j),Q=X=>{N={...N,...X}};return{onBlur:(X,ee,Z)=>(N={...N,groupedItems:[]},Z()),onClick:(X,ee,Z)=>(N={...N,groupedItems:[]},Z()),onKeyDown:(X,ee,Z)=>{const ae=N.groupedItems.length;switch(X.key){case"Escape":{if(ae)return X.preventDefault(),N={...N,groupedItems:[]},ee.insertText("");break}case"ArrowDown":case"ArrowUp":if(ae){X.preventDefault(),z.moveMenuIndex(X.key==="ArrowDown"?1:-1);return}break;case"Enter":{if(!(X.shiftKey||X.ctrlKey)&&ae)return X.preventDefault(),z.insertSuggestion();break}case"Tab":{if(ae)return X.preventDefault(),z.insertSuggestion();break}default:{X.key.length===1&&H(ee,Q,U,F);break}}return Z()},commands:{selectSuggestion:(X,ee)=>{const Z=N.groupedItems;if(!Z||!Z.length)return X;const q=X.applyTypeahead(ee);return H(X,Q,U,F),q},applyTypeahead:(X,ee)=>{let Z=ee.insertText||ee.label;const q=ee.kind==="function",ae=ee.move||0,k=ae>0?ae:0,se=ae<0?-ae:0,{typeaheadPrefix:te,typeaheadText:ne,typeaheadContext:le}=N;V&&(Z=V(Z,{groupedItems:N.groupedItems,typeaheadContext:le,typeaheadPrefix:te,typeaheadText:ne}));const{forward:re,backward:de}=W(Z,te,ne,q,ee.deleteBackwards,F);if(Z.match(/\n/)){const oe=(0,I.dF)(Z);return X.deleteBackward(de).deleteForward(re).insertFragment(oe).focus(),X}return N={...N,groupedItems:[]},X.snapshotSelection().deleteBackward(de).deleteForward(re).insertText(Z).moveForward(k).moveBackward(se).focus(),X}},renderEditor(X,ee,Z){if(ee.value.selection.isExpanded)return Z();const q=Z();return(0,t.jsxs)(t.Fragment,{children:[q,(0,t.jsx)(S,{menuRef:ae=>z=ae,origin:w,prefix:N.typeaheadPrefix,isOpen:!!N.groupedItems.length,groupedItems:N.groupedItems,onSelectSuggestion:ee.selectSuggestion})]})}}}const K=async(U,F,V,w)=>{if(!V)return;const{value:z}=U,{selection:N}=z,H=z.document.getClosestBlock(z.focusBlock.key),Q=z.selection.start.offset-1,X=H&&H.getDecorations(U),ee=X?X.filter(de=>de.start.offset<=Q&&de.end.offset>Q&&de.type===B.A).toArray():[],Z=X&&X.filter(de=>de.end.offset<=Q&&de.type===B.A&&de.data.get("className").includes("label-key")).last(),q=Z&&z.focusText.text.slice(Z.start.offset,Z.end.offset),ae=ee.map(de=>de.data.get("className")).join(" ").split(" ").filter(de=>de.length);let k=z.focusText.text,se=k.slice(0,N.focus.offset);ee.length&&(k=z.focusText.text.slice(ee[0].start.offset,ee[0].end.offset),se=z.focusText.text.slice(ee[0].start.offset,N.focus.offset));const te=se.match(/(?:!?=~?"?|")(.*)/);te?se=te[1]:w&&(se=w(se));const{suggestions:ne,context:le}=await V({prefix:se,text:k,value:z,wrapperClasses:ae,labelKey:q||void 0,editor:U}),re=ne.map(de=>{if(!de.items)return de;const oe=de.searchFunctionType||(de.prefixMatch?L.T.Prefix:L.T.Word),J=L.H[oe];let ce={...de};return se&&(de.skipFilter||(ce.items=ce.items.filter(pe=>(pe.filterText||pe.label).length>=se.length),ce.items=J(ce.items,se)),ce.items=ce.items.filter(pe=>!(pe.insertText===se||(pe.filterText??pe.label)===se))),de.skipSort||(ce.items=(0,n.sortBy)(ce.items,pe=>pe.sortText===void 0?pe.sortValue!==void 0?pe.sortValue:pe.label:pe.sortText||pe.label)),ce}).filter(de=>de.items&&de.items.length);F({groupedItems:re,typeaheadPrefix:se,typeaheadContext:le,typeaheadText:k}),U.blur().focus()};function W(U,F,V,w,z,N){const H=z||F.length,Q=N?N(V):V,X=V.indexOf(F),ee=X>-1?Q.length-X-F.length:Q.length-F.length;return{forward:!!(F&&ee>0||U===V)&&!w?ee+X:0,backward:H}}},57108:(G,R,e)=>{"use strict";e.d(R,{k:()=>j});var t=e(74848),n=e(52762),s=e(40845);function a(A){return(0,n.css)({".sr-only":{position:"absolute",width:"1px",height:"1px",padding:0,margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",border:0}})}function r(A){return(0,n.css)({".alert-state-paused, .alert-state-pending":{color:A.colors.text.secondary,fontWeight:A.typography.fontWeightMedium},".alert-state-ok":{color:A.colors.success.text,fontWeight:A.typography.fontWeightMedium},".alert-state-warning":{color:A.colors.warning.text,fontWeight:A.typography.fontWeightMedium},".alert-state-critical":{color:A.colors.error.text,fontWeight:A.typography.fontWeightMedium}})}function g(A){return(0,n.css)({".panel-options-group":{borderBottom:`1px solid ${A.colors.border.weak}`},".panel-options-group__header":{padding:A.spacing(1,2,1,1),position:"relative",display:"flex",alignItems:"center",cursor:"pointer",fontWeight:500,color:A.colors.text.primary,"&:hover":{background:A.colors.emphasize(A.colors.background.primary,.03)}},".panel-options-group__icon":{color:A.colors.text.secondary,marginRight:A.spacing(1),padding:A.spacing(0,.9,0,.6)},".panel-options-group__title":{position:"relative"},".panel-options-group__body":{padding:A.spacing(1,2,1,4)}})}function i(A){return(0,n.css)({".card-section":{marginBottom:A.spacing(4)},".card-list":{display:"flex",flexDirection:"row",flexWrap:"wrap",listStyleType:"none"},".card-item":{display:"block",height:"100%",background:A.colors.background.secondary,boxShadow:"none",padding:A.spacing(2),borderRadius:"4px","&:hover":{background:A.colors.emphasize(A.colors.background.secondary,.03)},".label-tag":{marginLeft:A.spacing(1),fontSize:"11px",padding:"2px 6px"}},".card-item-body":{display:"flex",overflow:"hidden"},".card-item-details":{overflow:"hidden"},".card-item-header":{marginBottom:A.spacing(2)},".card-item-type":{color:A.colors.text.secondary,textTransform:"uppercase",fontSize:A.typography.size.sm,fontWeight:A.typography.fontWeightMedium},".card-item-badge":{margin:"6px 0"},".card-item-notice":{fontSize:A.typography.size.sm},".card-item-name":{color:A.colors.text.primary,overflow:"hidden",textOverflow:"ellipsis",width:"100%"},".card-item-label":{marginLeft:A.spacing(1)},".card-item-sub-name":{color:A.colors.text.secondary,overflow:"hidden",textOverflow:"ellipsis",width:"100%"},".card-item-sub-name--header":{color:A.colors.text.secondary,textTransform:"uppercase",marginBottom:A.spacing(2),fontSize:A.typography.size.sm,fontWeight:"bold"},".card-list-layout-grid":{".card-item-type":{display:"inline-block"},".card-item-notice":{fontSize:A.typography.size.sm,display:"inline-block",marginLeft:A.spacing(2)},".card-item-header-action":{float:"right"},".card-item-wrapper":{width:"100%",padding:A.spacing(0,2,2,0)},".card-item-wrapper--clickable":{cursor:"pointer"},".card-item-figure":{margin:A.spacing(0,2,2,0),height:"80px",img:{width:"80px"}},".card-item-name":{fontSize:A.typography.h3.fontSize},[A.breakpoints.up("md")]:{".card-item-wrapper":{width:"50%"}},[A.breakpoints.up("lg")]:{".card-item-wrapper":{width:"33.333333%"}},"&.card-list-layout-grid--max-2-col":{[A.breakpoints.up("lg")]:{".card-item-wrapper":{width:"50%"}}}},".card-list-layout-list":{".card-item-wrapper":{padding:0,width:"100%",marginBottom:A.spacing(1)},".card-item-wrapper--clickable":{cursor:"pointer"},".card-item":{borderRadius:"2px"},".card-item-header":{float:"right",textAlign:"right"},".card-item-figure":{margin:A.spacing(0,2,0,0),img:{width:"48px"}},".card-item-name":{fontSize:A.typography.h4.fontSize},".card-item-sub-name":{fontSize:A.typography.size.sm},".layout-selector":{marginRight:0}}})}function l(A){return(0,n.css)({"code, pre, kbd, samp":{...A.typography.code,fontSize:A.typography.bodySmall.fontSize,backgroundColor:A.colors.background.primary,color:A.colors.text.primary,border:`1px solid ${A.colors.border.medium}`,borderRadius:"4px"},code:{whiteSpace:"nowrap",padding:"2px 5px",margin:"0 2px"},pre:{display:"block",margin:A.spacing(0,0,2),lineHeight:A.typography.body.lineHeight,wordBreak:"break-all",wordWrap:"break-word",whiteSpace:"pre-wrap",overflow:"auto",padding:"10px",code:{padding:0,color:"inherit",whiteSpace:"pre-wrap",backgroundColor:"transparent",border:0}}})}function d(A){return(0,n.css)({".react-resizable-handle":{visibility:"hidden"},".react-grid-item, #grafana-portal-container":{touchAction:"initial !important","&:hover":{".react-resizable-handle":{visibility:"visible"}}},[A.breakpoints.down("md")]:{".react-grid-layout":{height:"unset !important"},".react-grid-item":{display:"block !important",transitionProperty:"none !important",position:"unset !important",transform:"translate(0px, 0px) !important",marginBottom:A.spacing(2)},".panel-repeater-grid-item":{height:"auto !important"}},".react-grid-item.react-grid-placeholder":{boxShadow:`0 0 4px ${A.colors.primary.border} !important`,background:`${A.colors.primary.transparent} !important`,zIndex:"-1 !important",opacity:"unset !important"},".react-grid-item > .react-resizable-handle::after":{borderRight:`2px solid ${A.isDark?A.v1.palette.gray1:A.v1.palette.gray3} !important`,borderBottom:`2px solid ${A.isDark?A.v1.palette.gray1:A.v1.palette.gray3} !important`},".react-grid-item.resizing.panel, .react-grid-item.panel.dropdown-menu-open, .react-grid-item.react-draggable-dragging.panel":{zIndex:A.zIndex.dropdown},".react-grid-item.cssTransforms":{transitionProperty:"none !important"},[A.transitions.handleMotion("no-preference")]:{".react-grid-layout--enable-move-animations":{".react-grid-item.cssTransforms":{transitionProperty:"transform !important"}}}})}function c(A){return(0,n.css)({".delta-html":{background:A.colors.background.secondary,paddingTop:"5px",paddingBottom:"5px",userSelect:"none"},".diff-line":{color:A.colors.text.primary,fontFamily:A.typography.fontFamilyMonospace,fontSize:A.typography.size.sm,lineHeight:2,marginBottom:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",position:"relative","&:after":{left:"-40px"}},".diff-line-number":{color:A.colors.text.secondary,display:"inline-block",fontSize:A.typography.size.xs,lineHeight:2.3,textAlign:"right",width:"30px"},".diff-line-number-hide":{visibility:"hidden"},".diff-line-icon":{color:A.colors.text.primary,fontSize:A.typography.size.xs,float:"right",position:"relative",top:"2px",right:"10px"},".diff-json-new, .diff-json-old, .diff-json-deleted, .diff-json-added":{color:A.v1.palette.gray5,".diff-line-number":{color:A.colors.text.primary}},".diff-json-new":{backgroundColor:A.isDark?"#457740":"#664e33"},".diff-json-old":{backgroundColor:A.isDark?"#a04338":"#5a372a"},".diff-json-added":{backgroundColor:A.colors.primary.shade},".diff-json-deleted":{backgroundColor:A.colors.error.shade},".diff-value":{userSelect:"all"},".diff-circle":{marginRight:"0.5em","*":{marginBottom:"1px"}},".diff-circle-changed":{color:"#f59433"},".diff-circle-added":{color:"#29d761"},".diff-circle-deleted":{color:"#fd474a"},".diff-item-added, .diff-item-deleted":{listStyle:"none"},".diff-group":{background:A.colors.background.secondary,fontSize:"16px",fontStyle:"normal",padding:"10px 15px",margin:A.spacing(2,0),".diff-group":{padding:"0 5px"}},".diff-group-name":{display:"inline-block",width:"100%",fontSize:"16px",paddingLeft:"1.75em",margin:"0 0 14px 0"},".diff-summary-key":{paddingLeft:"0.25em"},".diff-list":{paddingLeft:"40px",".diff-list":{paddingLeft:0}},".diff-item":{color:A.v1.palette.gray2,lineHeight:2.5,"> div":{display:"inline"}},".diff-item-changeset":{listStyle:"none"},".diff-label":{backgroundColor:A.colors.action.hover,borderRadius:"3px",color:A.colors.text.primary,display:"inline",fontSize:`${A.typography.fontSize}px`,margin:"0 5px",padding:"3px 8px"},".diff-linenum":{float:"right"},".diff-arrow":{color:A.colors.text.primary},".diff-block":{width:"100%",display:"inline-block"},".diff-block-title":{fontSize:"16px",display:"inline-block"},".diff-title":{fontSize:"16px"},".diff-change-container":{margin:"0 0",paddingLeft:"3em",paddingRight:0},".diff-change-group":{width:"100%",color:A.colors.text.primary,marginBottom:"14px"},".diff-change-item":{display:"inline-block"},".diff-change-title":{fontSize:"16px"},".bullet-position-container":{position:"relative",left:"-6px"},".diff-list-circle":{marginBottom:"3px"}})}var h=e(16797);function o(A){return(0,n.css)({"*, *::before, *::after":{boxSizing:"inherit"},"[tabindex='-1']:focus":{outline:"none !important"},html:{MsOverflowStyle:"scrollbar",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)",boxSizing:"border-box",height:"100%",fontSize:`${A.typography.htmlFontSize}px`,fontFamily:A.typography.fontFamily,lineHeight:A.typography.body.lineHeight,fontKerning:"normal"},":root":{colorScheme:A.colors.mode},body:{height:"100%",width:"100%",position:"unset",color:A.colors.text.primary,backgroundColor:A.colors.background.canvas,overflowY:"auto !important",paddingRight:"0 !important","@media print":{overflow:"visible"},"@page":{margin:0,size:"auto",padding:0},...A.typography.body},"h1, .h1":m(A.typography.h1),"h2, .h2":m(A.typography.h2),"h3, .h3":m(A.typography.h3),"h4, .h4":m(A.typography.h4),"h5, .h5":m(A.typography.h5),"h6, .h6":m(A.typography.h6),p:{margin:A.spacing(0,0,2)},textarea:{overflow:"auto",resize:"vertical"},button:{letterSpacing:A.typography.body.letterSpacing,"&:focus-visible":(0,h.getFocusStyles)(A),"&:focus":{outline:"none"}},label:{display:"inline-block"},figure:{margin:A.spacing(0,0,2)},img:{verticalAlign:"middle"},fieldset:{minWidth:0,padding:0,margin:0,border:0},legend:{display:"block",width:"100%",padding:0,marginBottom:A.spacing(1),fontSize:A.spacing(3),lineHeight:"inherit",border:0},"small, .small":{fontSize:A.typography.bodySmall.fontSize,fontWeight:"normal"},"b, strong":{fontWeight:A.typography.fontWeightMedium},em:{fontStyle:"italic",color:A.colors.text.primary},cite:{fontStyle:"normal"},blockquote:{padding:A.spacing(0,0,0,2),margin:A.spacing(0,0,2),borderLeft:`5px solid ${A.v1.palette.gray3}`,p:{marginBottom:0,fontSize:A.typography.fontSize*1.25,fontWeight:300,lineHeight:1.25},small:{display:"block",lineHeight:A.typography.body.lineHeight,color:A.v1.palette.gray2,"&:before":{content:"'\\2014 \\00A0'"}}},"q:before, q:after, blockquote:before, blockquote:after":{content:"''"},address:{display:"block",marginBottom:A.spacing(2),fontStyle:"normal",lineHeight:A.typography.body.lineHeight},"a.external-link":{color:A.colors.text.link,textDecoration:"normal","&:hover":{color:A.colors.text.link,textDecoration:"underline"}},".link":{color:A.colors.text.primary,cursor:"pointer"},".link:hover":{color:A.colors.text.maxContrast},".pointer":{cursor:"pointer"},"audio, canvas, progress, video":{display:"inline-block",verticalAlign:"baseline"},"audio:not([controls])":{display:"none",height:0},"abbr[title]":{borderBottom:"1px dotted",cursor:"help"},dfn:{fontStyle:"italic"},"sub, sup":{fontSize:"75%",lineHeight:0,position:"relative",verticalAlign:"baseline"},sup:{top:"-0.5em"},sub:{bottom:"-0.25em"},hr:{marginTop:A.spacing(2),marginBottom:A.spacing(2),border:0,borderTop:`1px solid ${A.colors.border.medium}`},"mark, .mark":{background:A.colors.warning.main},"ul, ol, dl":{marginTop:0,marginBottom:0,padding:0},"ul ul, ul ol, ol ol, ol ul":{marginBottom:0},li:{lineHeight:A.typography.body.lineHeight},dd:{marginBottom:A.spacing(1),marginLeft:0},"dt, dd":{lineHeight:A.typography.body.lineHeight},dt:{fontWeight:A.typography.fontWeightMedium},"button, input, optgroup, select, textarea":{borderRadius:0,color:"inherit",font:"inherit",lineHeight:"inherit",margin:0},optgroup:{fontWeight:"bold"},'button, html input[type="button"], input[type="submit"]':{WebkitAppearance:"button",cursor:"pointer"},'input[type="search"]':{WebkitAppearance:"none"},'input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration':{WebkitAppearance:"none"},table:{backgroundColor:"transparent",borderCollapse:"collapse",borderSpacing:0},caption:{paddingTop:A.spacing(.5),paddingBottom:A.spacing(.5),color:A.colors.text.secondary,textAlign:"left",captionSide:"bottom"},th:{fontWeight:A.typography.fontWeightMedium,textAlign:"left"},"td, th":{padding:0},".muted":{color:A.colors.text.secondary},"a.muted:hover, a.muted:focus":{color:A.colors.text.primary},".text-warning":{color:A.colors.warning.text,"&:hover, &:focus":{color:A.colors.emphasize(A.colors.warning.text,.15)}},".text-error":{color:A.colors.error.text,"&:hover, &:focus":{color:A.colors.emphasize(A.colors.error.text,.15)}},".text-success":{color:"$success-text-color","&:hover, &:focus":{color:A.colors.emphasize(A.colors.success.text,.15)}},a:{cursor:"pointer",color:A.colors.text.primary,textDecoration:"none","&:focus":{outline:"none"},"&:focus-visible":(0,h.getFocusStyles)(A),"&:[disabled]":{cursor:"default",pointerEvents:"none !important"}},"[role='button']":{cursor:"pointer"},"[hidden]":{display:"none !important"},"a, area, button, [role='button'], input, label, select, summary, textarea":{touchAction:"manipulation"},".text-link":{textDecoration:"underline"},".text-left":{textAlign:"left"},".text-right":{textAlign:"right"},".text-center":{textAlign:"center"},".highlight-search-match":{background:A.components.textHighlight.background,color:A.components.textHighlight.text,padding:0},".template-variable":{color:A.colors.primary.text},".modal-header-title":{fontSize:A.typography.size.lg,float:"left",paddingTop:A.spacing(1),margin:A.spacing(0,2)}})}function m(A){return{margin:0,fontSize:A.fontSize,lineHeight:A.lineHeight,fontWeight:A.fontWeight,letterSpacing:A.letterSpacing,fontFamily:A.fontFamily,marginBottom:"0.45em"}}function u(A){return(0,n.css)({"iframe.intercom-borderless-frame":{colorScheme:A.colors.mode}})}function p(A){return(0,n.css)({".filter-table *":{boxSizing:"border-box"},".filter-table":{width:"100%",borderCollapse:"separate",tbody:{"tr:nth-child(odd)":{background:A.colors.emphasize(A.colors.background.primary,.02)}},th:{width:"auto",padding:A.spacing(.5,1),textAlign:"left",lineHeight:"30px",height:"30px",whiteSpace:"nowrap"},td:{padding:A.spacing(.5,1),lineHeight:"30px",height:"30px",whiteSpace:"nowrap"},".link-td":{padding:0,lineHeight:"30px",height:"30px",whiteSpace:"nowrap",a:{display:"block",padding:A.spacing(0,1),height:"30px"}},".ellipsis":{display:"block",width:"100%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},".expanded":{borderColor:A.components.panel.background},".expanded > td":{paddingBottom:0},".filter-table__avatar":{width:"25px",height:"25px",borderRadius:"50%"},"&--hover":{"tbody tr:hover":{background:A.colors.emphasize(A.colors.background.primary,.05)}}}})}function f(A){const K=typeof window<"u"&&window.__grafana_public_path__,W=K?`${K}fonts/`:"public/fonts/";return(0,n.css)([{"@font-face":{fontFamily:"Roboto Mono",fontStyle:"normal",fontWeight:400,fontDisplay:"swap",src:`url('${W}roboto/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSh0mQ.woff2') format('woff2')`,unicodeRange:"U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD"}},{"@font-face":{fontFamily:"Roboto Mono",fontStyle:"normal",fontWeight:500,fontDisplay:"swap",src:`url('${W}roboto/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSh0mQ.woff2') format('woff2')`,unicodeRange:"U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD"}},{"@font-face":{fontFamily:"Inter",fontStyle:"normal",fontWeight:400,fontDisplay:"swap",src:`url('${W}inter/Inter-Regular.woff2') format('woff2')`}},{"@font-face":{fontFamily:"Inter",fontStyle:"normal",fontWeight:500,fontDisplay:"swap",src:`url('${W}inter/Inter-Medium.woff2') format('woff2')`}}])}function y(A){return(0,n.css)({"input, button, select, textarea":{fontFamily:A.typography.body.fontFamily,fontSize:A.typography.body.fontSize,fontWeight:A.typography.body.fontWeight,lineHeight:A.typography.body.lineHeight},"input, select":{backgroundColor:A.components.input.background,color:A.components.input.text,border:"none",boxShadow:"none"},"input, textarea":{"&::placeholder":{color:A.colors.text.disabled}},'input[type="number"]::-webkit-outer-spin-button, input[type="number"]::-webkit-inner-spin-button':{WebkitAppearance:"none",margin:0},'input[type="number"]':{MozAppearance:"textfield"},'select, input[type="file"]':{height:A.components.height.md,lineHeight:A.components.height.md},select:{width:"220px",border:`1px solid ${A.components.input.borderColor}`,backgroundColor:A.components.input.background},"select[multiple], select[size], textarea":{height:"auto"},'select:focus, input[type="file"]:focus, input[type="radio"]:focus, input[type="checkbox"]:focus':{outline:"5px auto -webkit-focus-ring-color",outlineOffset:"-2px"},"input[type='file'], input[type='image'], input[type='submit'], input[type='reset'], input[type='button'], input[type='radio'], input[type='checkbox']":{width:"auto"},"input[disabled], select[disabled], textarea[disabled], input[readonly], select[readonly], textarea[readonly]":{cursor:"not-allowed",backgroundColor:A.colors.action.disabledBackground},'input[type="radio"][disabled], input[type="checkbox"][disabled], input[type="radio"][readonly], input[type="checkbox"][readonly]':{cursor:"not-allowed",backgroundColor:"transparent"},"input:-webkit-autofill, input:-webkit-autofill:hover, input:-webkit-autofill:focus, input:-webkit-autofill, textarea:-webkit-autofill, textarea:-webkit-autofill:hover, textarea:-webkit-autofill:focus, select:-webkit-autofill, select:-webkit-autofill:hover, select:-webkit-autofill:focus":{WebkitBoxShadow:`0 0 0px 1000px ${A.components.input.background} inset !important`,WebkitTextFillColor:A.components.input.text,boxShadow:`0 0 0px 1000px ${A.components.input.background} inset`,border:`1px solid ${A.components.input.background}`},".gf-form":{display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative",marginBottom:A.spacing(.5),"&--offset-1":{marginLeft:A.spacing(2)},"&--grow":{flexGrow:1},"&--flex-end":{justifyContent:"flex-end"},"&--align-center":{alignContent:"center"},"&--alt":{flexDirection:"column",alignItems:"flex-start",".gf-form-label":{padding:"4px 0"}}},".gf-form--has-input-icon":{position:"relative",marginRight:A.spacing(.5),".gf-form-input-icon":{position:"absolute",top:"8px",fontSize:A.typography.size.lg,left:"10px",color:A.colors.text.disabled},"> input":{paddingLeft:"35px","&:focus + .gf-form-input-icon":{color:A.colors.text.secondary}},".Select--multi .Select-multi-value-wrapper, .Select-placeholder":{paddingLeft:"30px"}},".gf-form-disabled":{color:A.colors.text.secondary,".gf-form-select-wrapper::after":{color:A.colors.text.secondary},"a, .gf-form-input":{color:A.colors.text.secondary}},".gf-form-group":{marginBottom:A.spacing(5)},".gf-form-inline":{display:"flex",flexDirection:"row",flexWrap:"wrap",alignContent:"flex-start","&--nowrap":{flexWrap:"nowrap"},"&--xs-view-flex-column":{flexDirection:"row",flexWrap:"nowrap",[A.breakpoints.down("sm")]:{flexDirection:"column"}},".select-container":{marginRight:A.spacing(.5)},".gf-form-spacing":{marginRight:A.spacing(.5)}},".gf-form-button-row":{paddingTop:A.spacing(3),"a, button":{marginRight:A.spacing(2)}},".gf-form-label":{display:"flex",alignItems:"center",padding:A.spacing(0,1),flexShrink:0,fontWeight:A.typography.fontWeightMedium,fontSize:A.typography.size.sm,backgroundColor:A.colors.background.secondary,height:"32px",lineHeight:"32px",marginRight:A.spacing(.5),borderRadius:A.shape.radius.default,justifyContent:"space-between",border:"none","&--grow":{flexGrow:1},"&--transparent":{backgroundColor:"transparent",border:0,textAlign:"right",paddingLeft:0},"&--variable":{color:A.colors.primary.text,background:A.components.panel.background,border:`1px solid ${A.components.panel.borderColor}`},"&--btn":{border:"none",borderRadius:A.shape.radius.default,"&:hover":{background:A.colors.background.secondary,color:A.colors.text.primary}},"&:disabled":{color:A.colors.text.secondary}},".gf-form-label + .gf-form-label":{marginRight:A.spacing(.5)},".gf-form-pre":{display:"block !important",flexGrow:1,margin:0,marginRight:A.spacing(.5),border:"1px solid transparent",borderLeft:"none",borderRadius:A.shape.radius.default},".gf-form-textarea":{maxWidth:"650px"},".gf-form-input":{display:"block",width:"100%",height:"32px",padding:A.spacing(0,1),fontSize:A.typography.size.md,lineHeight:"18px",color:A.components.input.text,backgroundColor:A.components.input.background,backgroundImage:"none",backgroundClip:"padding-box",border:`1px solid ${A.components.input.borderColor}`,borderRadius:A.shape.radius.default,marginRight:A.spacing(.5),whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis","&textarea":{overflow:"auto",whiteSpace:"pre-wrap",padding:`6px ${A.spacing(1)}`,minHeight:"32px",height:"auto"},"&::-ms-expand":{backgroundColor:"transparent",border:0,display:"none"},"&:focus":{borderColor:A.colors.primary.border,outline:"none"},"&::placeholder":{color:A.colors.text.disabled,opacity:1},"&:disabled, &[readonly]":{backgroundColor:A.colors.action.disabledBackground,opacity:1},"&:disabled":{cursor:"not-allowed"},"&.gf-size-auto":{width:"auto"},"&--dropdown":{paddingRight:A.spacing(3),position:"relative",display:"flex",alignItems:"center","&::after":{position:"absolute",top:"36%",right:"11px",fontSize:"11px",backgroundColor:"transparent",color:A.colors.text.primary,font:`normal normal normal ${A.typography.size.sm}/1 FontAwesome`,content:'"\f0d7"',pointerEvents:"none"}},"&--has-help-icon":{paddingRight:A.spacing(4)}},".gf-form-select-wrapper":{position:"relative",backgroundColor:A.components.input.background,marginRight:A.spacing(.5),".gf-form-select-icon":{position:"absolute",zIndex:1,top:"50%",marginTop:"-7px","+ .gf-form-input":{position:"relative",zIndex:2,paddingLeft:A.spacing(4),backgroundColor:"transparent",option:{color:A.v1.palette.black}}},".gf-form-input":{marginRight:0,lineHeight:"32px"},"select.gf-form-input":{textIndent:"0.01px",textOverflow:"''",paddingRight:A.spacing(4),appearance:"none","&:-moz-focusring":{outline:"none",color:"transparent",textShadow:`0 0 0 ${A.colors.text.primary}`},"&.ng-empty":{color:A.colors.text.secondary}},"&::after":{position:"absolute",top:"36%",right:"11px",backgroundColor:"transparent",color:A.colors.text.primary,font:`normal normal normal ${A.typography.size.sm}/1 FontAwesome`,content:'"\f0d7"',pointerEvents:"none",fontSize:"11px"},"&--has-help-icon":{"&::after":{right:A.spacing(4)}}},".gf-form--v-stretch":{alignItems:"stretch"},".gf-form-btn":{padding:A.spacing(0,1),marginRight:A.spacing(.5),lineHeight:"18px",fontSize:A.typography.size.sm,flexShrink:0,flexGrow:0},".gf-form-help-icon":{flexGrow:0,color:A.colors.text.secondary,"&:hover":{color:A.colors.text.primary}},".cta-form":{position:"relative",padding:A.spacing(3),backgroundColor:A.colors.background.secondary,marginBottom:A.spacing(3),borderTop:`3px solid ${A.colors.success.main}`},".input-small":{width:"90px"}})}function x(A){return(0,n.css)({".json-formatter-row":{fontFamily:"monospace","&, a, a:hover":{color:A.colors.text.primary,textDecoration:"none"},".json-formatter-row":{marginLeft:A.spacing(2)},".json-formatter-children":{"&.json-formatter-empty":{opacity:.5,marginLeft:A.spacing(2),"&::after":{display:"none"},"&.json-formatter-object::after":{content:"'No properties'"},"&.json-formatter-array::after":{content:"'[]'"}}},".json-formatter-string":{color:A.isDark?"#23d662":"green",whiteSpace:"pre-wrap",wordWrap:"break-word",wordBreak:"break-all"},".json-formatter-number":{color:A.isDark?A.colors.primary.text:A.colors.primary.main},".json-formatter-boolean":{color:A.isDark?A.colors.primary.text:A.colors.error.main},".json-formatter-null":{color:A.isDark?"#eec97d":"#855a00"},".json-formatter-undefined":{color:A.isDark?"rgb(239, 143, 190)":"rgb(202, 11, 105)"},".json-formatter-function":{color:A.isDark?"#fd48cb":"#ff20ed"},".json-formatter-url":{textDecoration:"underline",color:A.isDark?"#027bff":A.colors.primary.main,cursor:"pointer"},".json-formatter-bracket":{color:A.isDark?"#9494ff":A.colors.primary.main},".json-formatter-key":{color:A.isDark?"#23a0db":"#00008b",cursor:"pointer",paddingRight:A.spacing(.25),marginRight:A.spacing(.5)},".json-formatter-constructor-name":{cursor:"pointer"},".json-formatter-array-comma":{marginRight:A.spacing(.5)},".json-formatter-toggler":{lineHeight:"16px",fontSize:A.typography.size.xs,verticalAlign:"middle",opacity:.6,cursor:"pointer",paddingRight:A.spacing(.25),"&::after":{display:"inline-block",transition:"transform 100ms ease-in",content:"'\u25BA'"}},"> a > .json-formatter-preview-text":{opacity:0,transition:"opacity 0.15s ease-in",fontStyle:"italic"},"&:hover > a > .json-formatter-preview-text":{opacity:.6},"&.json-formatter-open":{"> .json-formatter-toggler-link .json-formatter-toggler::after":{transform:"rotate(90deg)"},"> .json-formatter-children::after":{display:"inline-block"},"> a > .json-formatter-preview-text":{display:"none"},"&.json-formatter-empty::after":{display:"block"}}}})}function v(A){return(0,n.css)({".gf-form-select-box__control":{width:"100%",marginRight:A.spacing(.5),backgroundColor:A.components.input.background,border:`1px solid ${A.components.input.borderColor}`,borderRadius:A.shape.radius.default,color:A.components.input.text,cursor:"default",height:A.spacing(4),outline:"none",overflow:"hidden",position:"relative"},".gf-form-select-box__control--is-focused":{backgroundColor:A.components.input.background,borderColor:A.colors.primary.border,outline:"none",boxShadow:`inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px ${A.colors.primary.border}`},".gf-form-select-box__control--is-disabled":{backgroundColor:A.colors.action.disabledBackground},".gf-form-select-box__control--menu-right":{".gf-form-select-box__menu":{right:0,left:"unset"}},".gf-form-select-box__input":{input:{lineHeight:"inherit"}},".gf-form-select-box__menu":{background:A.colors.background.primary,boxShadow:A.shadows.z3,position:"absolute",zIndex:A.zIndex.dropdown,minWidth:"100%","&-notice--no-options":{backgroundColor:A.components.input.background,padding:"10px"}},".gf-form-select-box__menu-list":{overflowY:"auto",maxHeight:"300px",maxWidth:"600px"},".tag-filter .gf-form-select-box__menu":{width:"100%"},".gf-form-select-box__multi-value":{display:"inline",margin:"0 6px 0 0",cursor:"pointer"},".gf-form-select-box__multi-value__remove":{textAlign:"center",display:"inline-block",marginLeft:"2px",position:"relative"},".gf-form-select-box__multi-value__label":{display:"inline",verticalAlign:"middle"},".gf-form-select-box__option":{borderLeft:"2px solid transparent",whiteSpace:"nowrap",backgroundColor:A.components.input.background,"&.gf-form-select-box__option--is-focused":{color:A.colors.text.primary,background:A.colors.action.hover,borderImage:A.colors.gradients.brandVertical,borderImageSlice:1,borderStyle:"solid",borderTop:0,borderRight:0,borderBottom:0,borderLeftWidth:"2px"},"&.gf-form-select-box__option--is-selected":{".fa":{color:A.colors.text.primary}}},".gf-form-select-box__placeholder":{color:A.colors.text.disabled},".gf-form-select-box__control--is-focused .gf-form-select-box__placeholder":{display:"none"},".gf-form-select-box__value-container":{display:"inline-block",padding:"6px 20px 6px 10px",verticalAlign:"middle","> div":{display:"inline-block",verticalAlign:"middle"}},".gf-form-select-box__indicators":{position:"absolute",height:"100%",right:"8px",top:"1px",display:"inline-block",textAlign:"right"},".gf-form-input--form-dropdown":{padding:0,border:0,overflow:"visible",position:"relative"},".gf-form--has-input-icon":{".gf-form-select-box__value-container":{paddingLeft:"30px"}},".gf-form-select-box__desc-option":{display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%"},".gf-form-select-box__desc-option__body":{display:"flex",flexDirection:"column",flexGrow:1,paddingRight:"10px",fontWeight:A.typography.fontWeightMedium},".gf-form-select-box__desc-option__desc":{fontWeight:"normal",fontSize:A.typography.bodySmall.fontSize,color:A.colors.text.secondary},".gf-form-select-box__desc-option__img":{width:"16px",marginRight:"10px"},".gf-form-select-box__option-group__header":{display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%",borderBottom:`1px solid ${A.v1.palette.dark9}`,textTransform:"capitalize",".fa":{paddingRight:"2px"}},".gf-form-select-box-button-select":{height:"auto"},".select-button":{display:"flex",alignItems:"center"}})}function P(A){return(0,n.css)({".markdown-html":{img:{maxWidth:"100%"},"ul, ol":{paddingLeft:A.spacing(3),marginBottom:A.spacing(2)},table:{marginBottom:A.spacing(2),"td, th":{padding:A.spacing(.5,1)},th:{fontWeight:A.typography.fontWeightMedium,background:A.colors.background.secondary}},"table, th, td":{border:`1px solid ${A.colors.border.medium}`,borderCollapse:"collapse"},a:{color:A.colors.text.link,textDecoration:"none","&:hover":{color:A.colors.text.link,textDecoration:"underline"}},"p:last-child":{marginBottom:0},"table:last-child, ul:last-child, ol:last-child":{marginBottom:0}}})}function E(A){const K=A.breakpoints.values.xxl+A.spacing.gridSize*2+A.components.sidemenu.width;return(0,n.css)({".grafana-app":{display:"flex",flexDirection:"column",height:"100vh"},".main-view":{display:"flex",flexDirection:"column",flexGrow:1,position:"relative",minWidth:0},".page-scrollbar-content":{display:"flex",minHeight:"100%",flexDirection:"column",width:"100%",height:"100%"},".page-container":{flexGrow:1,flexBasis:"100%",paddingLeft:A.spacing(2),paddingRight:A.spacing(2),[A.breakpoints.up("sm")]:{margin:A.spacing(0,1)},[A.breakpoints.up("md")]:{margin:A.spacing(0,2)},[`@media (min-width: ${K}px)`]:{maxWidth:`${A.breakpoints.values.xxl}px`,marginLeft:"auto",marginRight:"auto",width:"100%"}},".page-full":{marginLeft:A.spacing(2),paddingLeft:A.spacing(2),paddingRight:A.spacing(2)},".page-body":{padding:A.spacing(1),background:A.components.panel.background,border:`1px solid ${A.components.panel.borderColor}`,marginBottom:"32px",[A.breakpoints.up("md")]:{padding:A.spacing(2)},[A.breakpoints.up("lg")]:{padding:A.spacing(3)}},".page-heading":{fontSize:A.typography.h4.fontSize,marginTop:0,marginBottom:A.spacing(2)},".page-action-bar":{marginBottom:A.spacing(2),display:"flex",alignItems:"flex-start",gap:A.spacing(2)},".page-action-bar--narrow":{marginBottom:0},".page-action-bar__spacer":{width:A.spacing(2),flexGrow:1},".page-sub-heading":{marginBottom:A.spacing(2)},".page-sub-heading-icon":{marginLeft:A.spacing(1),marginTop:A.spacing(.5)},".page-hidden":{display:"none"}})}function D(A){return(0,n.css)({".query-editor-row":{marginBottom:"2px","&--disabled":{".query-keyword":{color:A.colors.text.secondary}}},".query-keyword":{fontWeight:A.typography.fontWeightMedium,color:`${A.colors.primary.text} !important`},".query-part":{backgroundColor:A.colors.background.secondary,"&:hover":{background:A.colors.emphasize(A.colors.background.secondary,.03)}},".query-segment-operator":{color:`${A.v1.palette.orange} !important`},".tight-form-func":{background:A.colors.background.secondary},'input[type="text"].tight-form-func-param':{fontSize:A.typography.bodySmall.fontSize,background:"transparent",border:"none",margin:0,padding:0},".tight-form-func-controls":{textAlign:"center",".fa-arrow-left":{float:"left",position:"relative",top:2},".fa-arrow-right":{float:"right",position:"relative",top:2},".fa-remove":{marginLeft:"10px"}}})}function C(A){return(0,n.css)({".rc-time-picker-input,.rc-time-picker-panel-input-wrap,.rc-time-picker-panel-inner":{backgroundColor:A.components.input.background,color:A.colors.text.secondary,borderColor:A.components.input.borderColor,fontSize:A.typography.body.fontSize},".rc-time-picker-input":{padding:A.spacing(0,1),height:A.spacing(4)},".rc-time-picker-panel":{width:"176px"},".rc-time-picker-panel-select":{width:"50%","&:only-child":{width:"100%"},".rc-time-picker-panel-select-option-selected":{backgroundColor:A.colors.background.secondary},"li:hover":{backgroundColor:A.colors.background.secondary}},".rc-time-picker-panel-narrow":{maxWidth:"none"}})}var b=e(72129);const T=A=>(0,n.css)({".react-loading-skeleton":b.Q});function S(A){return(0,n.css)({".slate-query-field":{fontSize:A.typography.fontSize,fontFamily:A.typography.fontFamilyMonospace,height:"auto",wordBreak:"break-word",overflow:"auto"},".slate-query-field__wrapper":{position:"relative",display:"inline-block",padding:"6px 8px",minHeight:"32px",width:"100%",color:A.colors.text.primary,backgroundColor:A.components.input.background,backgroundImage:"none",border:`1px solid ${A.components.input.borderColor}`,borderRadius:A.shape.radius.default,transition:"all 0.3s",lineHeight:"18px"},".slate-query-field__wrapper--disabled":{backgroundColor:"inherit",cursor:"not-allowed"},".slate-typeahead":{".typeahead":{position:"relative",zIndex:A.zIndex.typeahead,borderRadius:A.shape.radius.default,border:`1px solid ${A.components.panel.borderColor}`,maxHeight:"66vh",overflowY:"scroll",overflowX:"hidden",outline:"none",listStyle:"none",background:A.components.panel.background,color:A.colors.text.primary,boxShadow:A.shadows.z2},".typeahead-group__title":{color:A.colors.text.secondary,fontSize:A.typography.size.sm,lineHeight:A.typography.body.lineHeight,padding:A.spacing(1)},".typeahead-item":{height:"auto",fontFamily:A.typography.fontFamilyMonospace,padding:A.spacing(1,1,1,2),fontSize:A.typography.size.sm,textOverflow:"ellipsis",overflow:"hidden",zIndex:1,display:"block",whiteSpace:"nowrap",cursor:"pointer",transition:"color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), border-color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), background 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), padding 0.15s cubic-bezier(0.645, 0.045, 0.355, 1)"},".typeahead-item__selected":{backgroundColor:A.isDark?A.v1.palette.dark9:A.v1.palette.gray6,".typeahead-item-hint":{fontSize:A.typography.size.xs,color:A.colors.text.primary,whiteSpace:"normal"}},".typeahead-match":{color:A.v1.palette.yellow,borderBottom:`1px solid ${A.v1.palette.yellow}`,padding:"inherit",background:"inherit"}},".slate-query-field, .prism-syntax-highlight":{".token.comment, .token.block-comment, .token.prolog, .token.doctype, .token.cdata":{color:A.colors.text.secondary},".token.variable, .token.entity":{color:A.colors.text.primary},".token.property, .token.tag, .token.constant, .token.symbol, .token.deleted":{color:A.colors.error.text},".token.attr-value, .token.selector, .token.string, .token.char, .token.builtin, .token.inserted":{color:A.colors.success.text},".token.boolean, .token.number, .token.operator, .token.url":{color:"#fe85fc"},".token.function, .token.attr-name, .token.function-name, .token.atrule, .token.keyword, .token.class-name":{color:A.colors.primary.text},".token.punctuation, .token.regex, .token.important":{color:A.v1.palette.orange},".token.important":{fontWeight:"normal"},".token.bold":{fontWeight:"bold"},".token.italic":{fontStyle:"italic"},".token.entity":{cursor:"help"},".namespace":{opacity:.7}}})}function O(A){return(0,n.css)({".uplot":{fontFamily:"inherit"},".u-select":{background:"rgba(120, 120, 130, 0.2)"},".u-hz .u-cursor-x, .u-vt .u-cursor-y":{borderRight:"1px dashed rgba(120, 120, 130, 0.5)"},".u-hz .u-cursor-y, .u-vt .u-cursor-x":{borderBottom:"1px dashed rgba(120, 120, 130, 0.5)"},".shared-crosshair:not(.plot-active) .u-cursor-pt":{display:"none !important"}})}function M(A,K,W="#fff",U="0px 1px 0 rgba(0, 0, 0, 0.1)"){return{backgroundColor:A,backgroundImage:`linear-gradient(to bottom, ${A}, ${K})`,backgroundRepeat:"repeat-x",color:W,textShadow:U,borderColor:A,"&:hover, &:focus, &:active, &.active, &.disabled, &[disabled]":{color:W,backgroundImage:"none",backgroundColor:A}}}function I(A,K,W,U){return{padding:`${A} ${K}`,fontSize:W,borderRadius:U}}function L(A,K){let W={};for(let U=1;U<=K;U++){const F=`${A.spacing(2*U)} !important`;W[`.width-${U}`]={width:F},W[`.max-width-${U}`]={maxWidth:F,flexGrow:1},W[`.min-width-${U}`]={minWidth:F},W[`.offset-width-${U}`]={marginLeft:F}}return W}function B(A){return(0,n.css)({".highlight-word":{color:A.v1.palette.orange},".hide":{display:"none"},".show":{display:"block"},".invisible":{visibility:"hidden !important"},".absolute":{position:"absolute"},".flex-grow-1":{flexGrow:1},".flex-shrink-1":{flexShrink:1},".flex-shrink-0":{flexShrink:0},".center-vh":{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",justifyItems:"center"},".btn":{display:"inline-flex",alignItems:"center",justifyContent:"center",fontWeight:A.typography.fontWeightMedium,lineHeight:A.typography.body.lineHeight,textAlign:"center",verticalAlign:"middle",cursor:"pointer",border:"none",height:`${A.spacing.gridSize*A.components.height.md}px`,...I(A.spacing(0),A.spacing(2),`${A.typography.fontSize}px`,A.shape.radius.default),"&, &:active, &.active":{"&:focus, &.focus":{outline:"none"}},"&:focus, &:hover":{textDecoration:"none"},"&.focus":{textDecoration:"none"},"&:active, &.active":{backgroundImage:"none",outline:0},"&.disabled, &[disabled], &:disabled":{cursor:"not-allowed",opacity:.65,boxShadow:"none",pointerEvents:"none"}},".btn-small":{...I(A.spacing(.5),A.spacing(1),A.typography.size.sm,A.shape.radius.default),height:`${A.spacing.gridSize*A.components.height.sm}px`},".btn-mini":{...I(A.spacing(.5),A.spacing(1),A.typography.size.sm,A.shape.radius.default),height:`${A.spacing.gridSize*A.components.height.sm}px`},".btn-success, .btn-primary":{...M(A.colors.primary.main,A.colors.primary.shade)},".btn-danger":{...M(A.colors.error.main,A.colors.error.shade)},".btn-secondary":{...M(A.colors.secondary.main,A.colors.secondary.shade,A.colors.text.primary)},".btn-inverse":{...M(A.isDark?A.v1.palette.dark6:A.v1.palette.gray5,A.isDark?A.v1.palette.dark5:A.v1.palette.gray4,A.colors.text.primary),"&":{boxShadow:"none"}},".typeahead":{zIndex:A.zIndex.typeahead},...L(A,30),".row":{display:"flex",flexWrap:"wrap",marginLeft:`calc(${A.spacing(4)} / -2)`,marginRight:`calc(${A.spacing(4)} / -2)`},".container":{marginLeft:"auto",marginRight:"auto",paddingLeft:`calc(${A.spacing(4)} / 2)`,paddingRight:`calc(${A.spacing(4)} / 2)`,[A.breakpoints.up("sm")]:{maxWidth:A.breakpoints.values.sm},[A.breakpoints.up("md")]:{maxWidth:A.breakpoints.values.md},[A.breakpoints.up("lg")]:{maxWidth:A.breakpoints.values.lg},[A.breakpoints.up("xl")]:{maxWidth:A.breakpoints.values.xl}}})}function j(){const A=(0,s.$j)();return(0,t.jsx)(n.Global,{styles:[a(A),g(A),r(A),l(A),c(A),d(A),o(A),u(A),p(A),f(A),y(A),x(A),i(A),P(A),E(A),D(A),C(A),T(A),S(A),O(A),B(A),v(A)]})}},7918:(G,R,e)=>{"use strict";e.d(R,{kH:()=>l.k,Dx:()=>t.D,O4:()=>r,mG:()=>g,fq:()=>n.fq,YF:()=>d,N3:()=>i.N,IS:()=>n.IS,of:()=>n.of,DP:()=>n.DP,$j:()=>n.$j,SL:()=>n.SL,cV:()=>n.cV});var t=e(60578),n=e(40845),s=e(75972);let a;const r=(c="dark")=>a?a(c):(0,s.a)({colors:{mode:c}}).v1,g=c=>(a=c,()=>{a=null});var i=e(3911),l=e(57108),d=e(16797)},50774:(G,R,e)=>{"use strict";e.d(R,{I:()=>t});var t=(n=>(n.GroupTitle="GroupTitle",n))(t||{})},29621:()=>{"use strict"},80186:(G,R,e)=>{"use strict";e.r(R),e.d(R,{CompletionItemKind:()=>r.I,getAvailableIcons:()=>l.GO,getFieldTypeIcon:()=>l.SS,getFieldTypeIconName:()=>l.lV,isIconSize:()=>l.rJ,toIconName:()=>l.Uo});var t=e(64611),n=e.n(t),p={};for(const f in t)f!=="default"&&(p[f]=()=>t[f]);e.d(R,p);var s=e(11866),a=e.n(s),p={};for(const f in s)f!=="default"&&(p[f]=()=>s[f]);e.d(R,p);var r=e(50774),g=e(29621),i=e.n(g),p={};for(const f in g)["default","CompletionItemKind"].indexOf(f)<0&&(p[f]=()=>g[f]);e.d(R,p);var l=e(4025),d=e(19932),c=e.n(d),p={};for(const f in d)["default","CompletionItemKind","getAvailableIcons","getFieldTypeIcon","getFieldTypeIconName","isIconSize","toIconName"].indexOf(f)<0&&(p[f]=()=>d[f]);e.d(R,p);var h=e(72389),o=e.n(h),p={};for(const f in h)["default","CompletionItemKind","getAvailableIcons","getFieldTypeIcon","getFieldTypeIconName","isIconSize","toIconName"].indexOf(f)<0&&(p[f]=()=>h[f]);e.d(R,p);var m=e(65484),u=e.n(m),p={};for(const f in m)["default","CompletionItemKind","getAvailableIcons","getFieldTypeIcon","getFieldTypeIconName","isIconSize","toIconName"].indexOf(f)<0&&(p[f]=()=>m[f]);e.d(R,p)},11866:()=>{"use strict"},65484:()=>{"use strict"},19932:()=>{"use strict"},72389:()=>{"use strict"},64611:()=>{"use strict"},40321:(G,R,e)=>{"use strict";e.d(R,{Q:()=>t});const t=(n,s)=>{n.key==="Tab"||n.altKey||n.ctrlKey||n.metaKey||(n.stopPropagation(),n.key==="Escape"&&s())}},24284:(G,R,e)=>{"use strict";e.d(R,{Ih:()=>y,Mk:()=>r,Tj:()=>h,UJ:()=>c,Xw:()=>g,ct:()=>d,mZ:()=>f,nO:()=>l,sg:()=>p,xj:()=>i});var t=e(2543),n=e.n(t),s=e(84140);const a=4,r="rgba(0, 211, 255, 1)",g="rgba(11, 237, 50, 1)",i="rgba(237, 46, 24, 1)",l="rgba(150, 150, 150, 1)",d="rgba(247, 149, 32, 1)",c=.09,h=["#7EB26D","#EAB839","#6ED0E0","#EF843C","#E24D42","#1F78C1","#BA43A9","#705DA0","#508642","#CCA300","#447EBC","#C15C17","#890F02","#0A437C","#6D1F62","#584477","#B7DBAB","#F4D598","#70DBED","#F9BA8F","#F29191","#82B5D8","#E5A8E2","#AEA2E0","#629E51","#E5AC0E","#64B0C8","#E0752D","#BF1B00","#0A50A1","#962D82","#614D93","#9AC48A","#F2C96D","#65C5DB","#F9934E","#EA6460","#5195CE","#D683CE","#806EB7","#3F6833","#967302","#2F575E","#99440A","#58140C","#052B51","#511749","#3F2B5B","#E0F9D7","#FCEACA","#CFFAFF","#F9E2D2","#FCE2DE","#BADFF4","#F9D9F9","#DEDAF7"];function o(x){const v=(0,t.map)(x,m),P=(0,t.sortBy)(v,["h"]),E=(0,t.chunk)(P,a),D=(0,t.map)(E,b=>(0,t.sortBy)(b,"l")),C=(0,t.flattenDeep)((0,t.zip)(...D));return(0,t.map)(C,u)}function m(x){return(0,s.A)(x).toHsl()}function u(x){return(0,s.A)(x).toHexString()}function p(x){return(0,s.A)(x).getBrightness()>180?"rgb(32, 34, 38)":"rgb(247, 248, 250)"}function f(x,v){const P=(0,s.A)(x),E=P.getBrightness();return P.getAlpha()<.3?v?"rgb(247, 248, 250)":"rgb(32, 34, 38)":E>180?"rgb(32, 34, 38)":"rgb(247, 248, 250)"}let y=o(h)},14555:(G,R,e)=>{"use strict";e.d(R,{F:()=>n,J:()=>t});const t=s=>s().map(a=>({label:a.title,ariaLabel:a.title,url:a.href,target:a.target,icon:`${a.target==="_blank"?"external-link-alt":"link"}`,onClick:a.onClick})),n=s=>/\/explore\?.*&(left|right)=\[(.*\,){2,}(.*){1}\]/.test(s)},40621:(G,R,e)=>{"use strict";e.d(R,{h:()=>t});function t(n,s,a){}},53550:(G,R,e)=>{"use strict";e.d(R,{i:()=>t});function t(n){const a=n.lastIndexOf("."),r=n.substring(a),g=n.substring(0,a);return g.length<16?n:`${g.substring(0,16)}...${r}`}},9830:(G,R,e)=>{"use strict";e.d(R,{I:()=>s});var t=e(2543),n=e.n(t);function s(a,r){let g=0,i=a.indexOf(r);r=r.replace(/\s/g,"");const l=[];if(i!==-1)return{distance:0,found:!0,ranges:[{start:i,end:i+r.length-1}]};for(const d of r){const c=a.indexOf(d,i);if(c===-1)return{distance:1/0,ranges:[],found:!1};if(i!==-1&&(g+=c-i),i=c+1,l.length===0)l.push({start:c,end:c});else{const h=(0,t.last)(l);c===h.end+1?h.end++:l.push({start:c,end:c})}}return{distance:g,ranges:l,found:!0}}},67985:(G,R,e)=>{"use strict";e.d(R,{xj:()=>r.xj,Mk:()=>r.Mk,bk:()=>t,Pw:()=>g.Pw,nO:()=>r.nO,uc:()=>v,Xw:()=>r.Xw,ct:()=>r.ct,UJ:()=>r.UJ,zt:()=>a,yx:()=>i.yx,Tt:()=>p.T,DB:()=>f.DB,hF:()=>x.h,Vr:()=>m.Vr,Tj:()=>r.Tj,h:()=>y.h,It:()=>P.I,Yc:()=>m.Yc,kl:()=>o.k,XJ:()=>h,yC:()=>d.yC,JF:()=>d.JF,MC:()=>d.MC,mZ:()=>r.mZ,sg:()=>r.sg,K:()=>g.K,Fr:()=>l.F,Jl:()=>l.J,dF:()=>i.dF,mO:()=>i.mO,kD:()=>m.kD,RP:()=>g.RP,Ih:()=>r.Ih,CH:()=>u.C,tf:()=>g.tf});var t={};e.r(t),e.d(t,{getNextCharacter:()=>s,getPreviousCousin:()=>n}),typeof window<"u"&&"Element"in window&&!Element.prototype.closest&&(Element.prototype.closest=function(E){const D=(this.document||this.ownerDocument).querySelectorAll(E);let C=this,b;do{for(b=D.length;--b>=0&&D.item(b)!==C;);C=C.parentElement}while(b<0&&C);return C});function n(E,D){let C=E.parentElement.previousSibling,b;for(;C;){if(b=C.querySelector(D),b)return b;C=C.previousSibling}}function s(E){const D=(E||window).getSelection();if(!D||!D.anchorNode)return null;const C=D.getRangeAt(0),b=D.anchorNode.textContent,T=C.startOffset;return b.slice(T,T+1)}var a=e(67892),r=e(24284),g=e(29734),i=e(72307),l=e(14555),d=e(69613);let c=null;function h(){if(c!==null)return c;if(typeof document<"u"){const E=document.createElement("div"),D={width:"100px",height:"100px",position:"absolute",top:"-9999px",overflow:"scroll",MsOverflowStyle:"scrollbar"};Object.keys(D).map(C=>{E.style[C]=D[C]}),document.body.appendChild(E),c=E.offsetWidth-E.clientWidth,document.body.removeChild(E)}else c=0;return c||0}var o=e(90914),m=e(29413),u=e(69731),p=e(75071),f=e(88838),y=e(91040),x=e(40621),v=(E=>(E.id="id",E.title="title",E.subTitle="subTitle",E.mainStat="mainStat",E.secondaryStat="secondaryStat",E.source="source",E.target="target",E.detail="detail__",E.arc="arc__",E.color="color",E))(v||{}),P=e(9830)},91040:(G,R,e)=>{"use strict";e.d(R,{h:()=>a});var t=e(2543),n=e.n(t);const s=(0,t.throttle)((...r)=>{console.log(...r)},500),a=r=>{let g=!1;return typeof window<"u"&&(g=window.localStorage.getItem("grafana.debug")==="true"),{logger:(i,l=!1,...d)=>{},enable:()=>g=!0,disable:()=>g=!1,isEnabled:()=>g}}},29413:(G,R,e)=>{"use strict";e.d(R,{Vr:()=>i,Yc:()=>r,kD:()=>g});let t;const n=new Map,s=500;let a="";function r(){return t||(t=document.createElement("canvas").getContext("2d")),t}function g(l,d,c=400){const h=`${c} ${d}px 'Inter'`,o=l+h,m=n.get(o);if(m)return m;const u=r();a!==h&&(u.font=a=h);const p=u.measureText(l);return n.size===s&&n.clear(),n.set(o,p),p}function i(l,d,c,h,o,m){const u=g(l,14,m),p=d/(u.width+2)*14,f=c/h,y=Math.min(f,p);return Math.min(y,o??y)}},67892:(G,R,e)=>{"use strict";e.r(R),e.d(R,{getChildId:()=>n,renderOrCallToRender:()=>s});var t=e(96540);function n(a){let r;const g=t.Children.only(a);return"id"in g?.props?r=g.props.id:"inputId"in g.props&&(r=g?.props.inputId),typeof r=="string"?r:void 0}function s(a,r){if(t.isValidElement(a)||typeof a=="string"||typeof a=="number")return a;if(typeof a=="function"&&r)return a(r);throw new Error(`${a} is not a React element nor a function that returns React element`)}},75071:(G,R,e)=>{"use strict";e.d(R,{H:()=>g,T:()=>n});var t=e(9830),n=(i=>(i.Word="Word",i.Prefix="Prefix",i.Fuzzy="Fuzzy",i))(n||{});const g={Word:(i,l)=>i.filter(d=>(d.filterText||d.label).includes(l)),Prefix:(i,l)=>i.filter(d=>(d.filterText||d.label).startsWith(l)),Fuzzy:(i,l)=>(l=l.toLowerCase(),i.filter(d=>{const{distance:c,ranges:h,found:o}=(0,t.I)(d.label.toLowerCase(),l);return o?(d.sortValue=c,d.highlightParts=h,!0):!1}))}},72129:(G,R,e)=>{"use strict";e.d(R,{Q:()=>a,j:()=>r});var t=e(74848),n=e(32196);const a={animationName:(0,n.keyframes)({"0%":{opacity:0},"100%":{opacity:1}}),animationDelay:"100ms",animationTimingFunction:"ease-in",animationDuration:"100ms",animationFillMode:"backwards"},r=(g,i)=>Object.assign(g,{Skeleton:d=>(0,t.jsx)(i,{...d,rootProps:{style:a}})})},72307:(G,R,e)=>{"use strict";e.d(R,{dF:()=>s,mO:()=>a,yx:()=>n});var t=e(82611);const n={document:{nodes:[{match:[{type:"paragraph"},{type:"code_block"},{type:"code_line"}]}]},inlines:{}},s=(r,g)=>{const i=r.split(`
`).map(d=>t.Block.create({type:"code_line",nodes:[t.Text.create(d)]})),l=t.Block.create({data:{syntax:g},type:"code_block",nodes:i});return t.Document.create({nodes:[l]})},a=(r,g)=>{const i=s(r,g);return t.Value.create({document:i})}},90914:(G,R,e)=>{"use strict";e.d(R,{k:()=>t});const t=(n,s)=>{let a;if(n.getLinks&&(a=n.getLinks({valueRowIndex:s.index})),!!a){for(let r=0;r<a?.length;r++)if(a[r].onClick){const g=a[r].onClick;a[r].onClick=i=>{i.ctrlKey||i.metaKey||i.shiftKey||(i.preventDefault(),g(i,{field:n,rowIndex:s.index}))}}return a}}},69613:(G,R,e)=>{"use strict";e.d(R,{JF:()=>s,MC:()=>a,yC:()=>r});const t=["#D32D20","#1E72B8","#B240A2","#705DA0","#466803","#497A3C","#3D71AA","#B15415","#890F02","#6E6E6E","#0A437C","#6D1F62","#584477","#4C7A3F","#2F4F4F","#BF1B00","#7662B1","#8A2EB8","#517A00","#000000","#3F6833","#2F575E","#99440A","#AE561A","#0E4AB4","#58140C","#052B51","#511749","#3F2B5B"],n=["#FF7368","#459EE7","#E069CF","#9683C6","#6C8E29","#76AC68","#6AA4E2","#E7823D","#AF3528","#9B9B9B","#3069A2","#934588","#7E6A9D","#88C477","#557575","#E54126","#A694DD","#B054DE","#8FC426","#262626","#658E59","#557D84","#BF6A30","#FF9B53","#3470DA","#7E3A32","#2B5177","#773D6F","#655181"];function s(l=""){const d=g(l.toLowerCase());return Math.abs(d%t.length)}function a(l=""){const d=s(l);return r(d)}function r(l){return{color:t[l],borderColor:n[l]}}function g(l){let d=5381;for(let c=0;c<l.length;c++)d=(d<<5)+d+l.charCodeAt(c);return d}var i={getTagColorsFromName:a}},69731:(G,R,e)=>{"use strict";e.d(R,{C:()=>n});var t=e(96540);function n(){const[s,a]=(0,t.useState)(0);return(0,t.useCallback)(()=>a(r=>r+1),[])}},29734:(G,R,e)=>{"use strict";e.d(R,{K:()=>s,Pw:()=>t,RP:()=>a,tf:()=>n});var t=(r=>(r.onBlur="onBlur",r.onFocus="onFocus",r.onChange="onChange",r))(t||{});const n=(r,g)=>{const i=g.reduce((l,d)=>d.rule(r)?l:l.concat(d.errorMessage),[]);return i.length>0?i:null},s=(r,g)=>g&&g[r],a=(r,g)=>({rule:i=>!!i.match(r),errorMessage:g||"Value is not valid"})},85957:(G,R,e)=>{"use strict";e.d(R,{Nz:()=>ca,J3:()=>Fa,Pl:()=>nr});var t=e(74848),n=e(1503),s=e(96540),a=e(71468),r=e(24180),g=e(35557),i=e(54148),l=e(39601),d=e(14110),c=e(32264),h=e(66602),o=e(57108),m=e(17464),u=e(37171),p=e(99140),f=e(95344),y=e(7376),x=e(81634),v=e(17172),P=e(19347),E=e(72574),D=e(10096),C=e(14792),b=e(74856),T=e(71500),S=e(29304);async function O(){if(c.$.angularSupportEnabled){const{AngularApp:st}=await Promise.all([e.e(9362),e.e(7808),e.e(8888)]).then(e.bind(e,27808)),bt=new st;bt.init(),bt.bootstrap()}else(0,y.w)({load:(st,bt,Mt)=>({destroy:()=>{},digest:()=>{},getScope:()=>({})})}),(0,x.j)({get:st=>{switch(st){case"backendSrv":return(0,f.l)("getLegacyAngularInjector","backendSrv","use getBackendSrv() in @grafana/runtime"),(0,v.AI)();case"contextSrv":return(0,f.l)("getLegacyAngularInjector","contextSrv"),D.TP;case"dashboardSrv":return(0,f.l)("getLegacyAngularInjector","getDashboardSrv"),(0,C.UA)();case"datasourceSrv":return(0,f.l)("getLegacyAngularInjector","datasourceSrv","use getDataSourceSrv() in @grafana/runtime"),(0,P.l)();case"linkSrv":return(0,f.l)("getLegacyAngularInjector","linkSrv"),(0,S.mQ)();case"validationSrv":return(0,f.l)("getLegacyAngularInjector","validationSrv"),T.P;case"timeSrv":return(0,f.l)("getLegacyAngularInjector","timeSrv"),(0,b.jG)();case"templateSrv":return(0,f.l)("getLegacyAngularInjector","templateSrv","use getTemplateSrv() in @grafana/runtime"),(0,E.w)()}throw"Angular is disabled.  Unable to expose: "+st}})}var M=e(76888),I=e(83733),L=e(66899),B=e.n(L),j=e(32196),A=e(71733),K=e(64388),W=e(40845),U=e(55852),F=e(52446),V=e(21780);function w({error:st,errorInfo:bt}){const Mt=(0,i.zy)(),qt=st?.name==="ChunkLoadError",rn=(0,W.of)(z);return(0,s.useEffect)(()=>{qt&&Mt.search.indexOf("chunkNotFound")===-1&&(window.location.href=A.I.getUrlForPartial(Mt,{chunkNotFound:!0}))},[Mt,qt]),(0,t.jsx)(V.YW,{navId:"error",layout:K.k.Canvas,children:(0,t.jsxs)("div",{className:rn.container,children:[qt&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{children:"Unable to find application file"}),(0,t.jsx)("br",{}),(0,t.jsx)("h2",{className:"page-heading",children:"Grafana has likely been updated. Please try reloading the page."}),(0,t.jsx)("br",{}),(0,t.jsx)(U.$n,{size:"md",variant:"secondary",icon:"repeat",onClick:()=>window.location.reload(),children:"Reload"}),(0,t.jsx)(F.D,{title:"Error details",error:st,errorInfo:bt})]}),!qt&&(0,t.jsx)(F.D,{title:"An unexpected error happened",error:st,errorInfo:bt})]})})}const z=st=>({container:(0,j.css)({width:"500px",margin:st.spacing(8,"auto")})});var N=e(8484);function H(){const st=(0,W.of)(q);return(0,t.jsx)("div",{className:st.container,"aria-live":"polite",role:"status","aria-label":(0,N.t)("bouncing-loader.label","Loading"),children:(0,t.jsx)("div",{className:st.bounce,children:(0,t.jsx)("img",{alt:"",src:"public/img/grafana_icon.svg",className:st.logo})})})}const Q=(0,j.keyframes)({"0%":{opacity:0,animationTimingFunction:"cubic-bezier(0, 0, 0.5, 1)"},"100%":{opacity:1}}),X=(0,j.keyframes)({"0%":{opacity:0},"50%":{opacity:1},"100%":{opacity:0}}),ee=(0,j.keyframes)({"from, to":{transform:"translateY(0px)",animationTimingFunction:"cubic-bezier(0.3, 0, 0.1, 1)"},"50%":{transform:"translateY(-50px)",animationTimingFunction:"cubic-bezier(0.9, 0, 0.7, 1)"}}),Z=(0,j.keyframes)({"0%":{transform:"scaleX(1.3) scaleY(0.8)",animationTimingFunction:"cubic-bezier(0.3, 0, 0.1, 1)"},"15%":{transform:"scaleX(0.75) scaleY(1.25)",animationTimingFunction:"cubic-bezier(0, 0, 0.7, 0.75)"},"55%":{transform:"scaleX(1.05) scaleY(0.95)",animationTimingFunction:"cubic-bezier(0.9, 0, 1, 1)"},"95%":{transform:"scaleX(0.75) scaleY(1.25)",animationTimingFunction:"cubic-bezier(0, 0, 0, 1)"},"100%":{transform:"scaleX(1.3) scaleY(0.8)",animationTimingFunction:"cubic-bezier(0, 0, 0.7, 1)"}}),q=st=>({container:(0,j.css)({opacity:0,[st.transitions.handleMotion("no-preference")]:{animationName:Q,animationIterationCount:1,animationDuration:"0.9s",animationDelay:"0.5s",animationFillMode:"forwards"},[st.transitions.handleMotion("reduce")]:{animationName:X,animationIterationCount:"infinite",animationDuration:"4s",animationDelay:"0.5s"}}),bounce:(0,j.css)({textAlign:"center",[st.transitions.handleMotion("no-preference")]:{animationName:ee,animationDuration:"0.9s",animationIterationCount:"infinite"}}),logo:(0,j.css)({display:"inline-block",[st.transitions.handleMotion("no-preference")]:{animationName:Z,animationDuration:"0.9s",animationIterationCount:"infinite"},width:"60px",height:"60px"})});function ae(){const st=(0,W.of)(k);return(0,t.jsx)("div",{className:st.loadingPage,children:(0,t.jsx)(H,{})})}const k=st=>({loadingPage:(0,j.css)({backgroundColor:st.colors.background.primary,flex:1,flexDrection:"column",display:"flex",justifyContent:"center",alignItems:"center"})});function se(st){const{chrome:bt,keybindings:Mt}=(0,M.Il)();return bt.setMatchedRoute(st.route),(0,s.useLayoutEffect)(()=>{Mt.clearAndInitGlobalBindings(st.route)},[Mt,st.route]),(0,s.useEffect)(()=>(ne(st.route),le(),(0,l.Lc)("GrafanaRoute",!1,"Mounted",st.route),()=>{(0,l.Lc)("GrafanaRoute",!1,"Unmounted",st.route),ne(st.route,!0)}),[]),(0,s.useEffect)(()=>{le(),(0,d.Jy)(),(0,l.Lc)("GrafanaRoute",!1,"Updated",st)}),(0,l.Lc)("GrafanaRoute",!1,"Rendered",st.route),(0,t.jsx)(h.tH,{children:({error:qt,errorInfo:rn})=>qt?(0,t.jsx)(w,{error:qt,errorInfo:rn}):(0,t.jsx)(s.Suspense,{fallback:(0,t.jsx)(ae,{}),children:(0,t.jsx)(st.route.component,{...st,queryParams:(0,l.SE)(st.location.search)})})})}function te(st){return st.pageClass?st.pageClass.split(" "):[]}function ne(st,bt=!1){for(const Mt of te(st))bt?document.body.classList.remove(Mt):document.body.classList.add(Mt)}function le(){document.body.classList.remove("sidemenu-open--xs");const st=document.getElementById("tooltip");st?.parentElement?.removeChild(st);const bt=document.querySelectorAll(".tooltip");for(let Mt=0;Mt<bt.length;Mt++){const qt=bt[Mt];qt.parentElement?.removeChild(qt)}for(const Mt of B().drops)Mt.destroy()}var re=e(11848),de=e(16233),oe=e(96378),J=e(62625),ce=e(78731),pe=e(42418),xe=e(3911);class fe extends s.PureComponent{constructor(){super(...arguments),this.styles=Ee(c.$.theme2),this.state={},this.initListener=()=>{const bt=(0,ce.oF)();bt&&(this.subscription=bt.getConnectionState().subscribe({next:Mt=>{this.setState({show:!Mt})}}))}}componentDidMount(){}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe()}render(){const{show:bt}=this.state;return bt?!de.TP.isSignedIn||!c.$.liveEnabled||de.TP.user.orgRole===J.X.None?null:(0,t.jsx)("div",{className:this.styles.foot,children:(0,t.jsx)(pe.F,{severity:"warning",className:this.styles.warn,title:"connection to server is lost..."})}):null}}const Ee=(0,xe.N)(st=>({foot:(0,j.css)({position:"fixed",bottom:0,left:0,right:0,zIndex:1e4,cursor:"wait",margin:st.spacing(2)}),warn:(0,j.css)({maxWidth:"400px",margin:"auto"})}));var Se=e(49658),ye=e(17929),Ve=e(67061),Me=e(71678),Ce=e(21633),Ue=e(29158);const Ae=(0,s.forwardRef)((st,bt)=>(0,t.jsx)("div",{id:"ngRoot",ref:bt,dangerouslySetInnerHTML:{__html:"<grafana-app ng-cloak></grafana-app>"}}));Ae.displayName="AngularRoot";var we=e(46942),We=e.n(we),_e=e(60619),at=e(33390),ut=e(18828),Tt=e(85690),It=e(93225),ge=e(14578),Ie=e(57514),ue=e(69529),me=e(65178),Pe=e(35822);const Ne=0,Fe=st=>{const bt=s.useRef(null),Mt=s.useRef(null),qt=s.useRef(st.items);qt.current=st.items;const rn=(0,Pe.useVirtual)({size:qt.current.length,parentRef:Mt}),{query:tn,search:Rn,currentRootActionId:jn,activeIndex:Wn,options:bs}=(0,n.useKBar)(is=>({search:is.searchQuery,currentRootActionId:is.currentRootActionId,activeIndex:is.activeIndex}));s.useEffect(()=>{const is=Ds=>{Ds.key==="ArrowUp"||Ds.ctrlKey&&Ds.key==="p"?(Ds.preventDefault(),tn.setActiveIndex(fs=>{let ks=fs>Ne?fs-1:fs;if(typeof qt.current[ks]=="string"){if(ks===0)return fs;ks-=1}return ks})):Ds.key==="ArrowDown"||Ds.ctrlKey&&Ds.key==="n"?(Ds.preventDefault(),tn.setActiveIndex(fs=>{let ks=fs<qt.current.length-1?fs+1:fs;if(typeof qt.current[ks]=="string"){if(ks===qt.current.length-1)return fs;ks+=1}return ks})):Ds.key==="Enter"&&(Ds.preventDefault(),bt.current?.click())};return window.addEventListener("keydown",is),()=>window.removeEventListener("keydown",is)},[tn]);const{scrollToIndex:as}=rn;s.useEffect(()=>{as(Wn,{align:Wn<=1?"end":"auto"})},[Wn,as]),s.useEffect(()=>{tn.setActiveIndex(typeof st.items[Ne]=="string"?Ne+1:Ne)},[Rn,jn,st.items,tn]);const vs=s.useCallback((is,Ds)=>{if(typeof Ds=="string")return;const fs=Ds.url;Ds.command?(Ds.command.perform(Ds),tn.toggle()):fs?is.ctrlKey||is.metaKey||is.shiftKey||tn.toggle():(tn.setSearch(""),tn.setCurrentRootAction(Ds.id)),bs.callbacks?.onSelectAction?.(Ds)},[tn,bs]),Ts=(0,me.usePointerMovedSinceMount)();return(0,t.jsx)("div",{ref:Mt,style:{maxHeight:st.maxHeight||400,position:"relative",overflow:"auto"},children:(0,t.jsx)("div",{role:"listbox",id:n.KBAR_LISTBOX,style:{height:`${rn.totalSize}px`,width:"100%"},children:rn.virtualItems.map(is=>{const Ds=qt.current[is.index],{target:fs,url:ks}=Ds,La=typeof Ds!="string"&&{onPointerMove:()=>Ts&&Wn!==is.index&&tn.setActiveIndex(is.index),onPointerDown:()=>tn.setActiveIndex(is.index),onClick:Qr=>vs(Qr,Ds)},ja=is.index===Wn,br={id:(0,n.getListboxItemId)(is.index),role:"option","aria-selected":ja,style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${is.start}px)`},...La},Lr=s.cloneElement(st.onRender({item:Ds,active:ja}),{ref:is.measureRef});return ks?(0,t.jsx)("a",{href:typeof ks=="function"?ks(Rn):ks,target:fs,ref:ja?bt:null,...br,children:Lr},is.index):(0,t.jsx)("div",{ref:ja?bt:null,...br,children:Lr},is.index)})})})},Be=s.forwardRef(({action:st,active:bt,currentRootActionId:Mt},qt)=>{const rn=s.useMemo(()=>{if(!Mt)return st.ancestors;const Wn=st.ancestors.findIndex(bs=>bs.id===Mt);return st.ancestors.slice(Wn+1)},[st.ancestors,Mt]),tn=(0,W.of)(he);let Rn=st.name;const jn=Wn=>!!(Wn.command?.perform||Wn.url);return st.children.length&&!jn(st)&&!Rn.endsWith("...")&&(Rn+="..."),(0,t.jsx)("div",{ref:qt,className:(0,j.cx)(tn.row,bt&&tn.activeRow),children:(0,t.jsxs)("div",{className:tn.actionContainer,children:[st.icon,(0,t.jsxs)("div",{className:tn.textContainer,children:[rn.map(Wn=>(0,t.jsx)(s.Fragment,{children:!jn(Wn)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:tn.breadcrumbAncestor,children:Wn.name}),(0,t.jsx)("span",{className:tn.breadcrumbSeparator,children:"\u203A"})]})},Wn.id)),(0,t.jsx)("span",{children:Rn})]}),st.subtitle&&(0,t.jsx)("span",{className:tn.subtitleText,children:st.subtitle})]})})});Be.displayName="ResultItem";const he=st=>({row:(0,j.css)({padding:st.spacing(1,2),display:"flex",alightItems:"center",justifyContent:"space-between",cursor:"pointer",position:"relative",borderRadius:st.shape.radius.default,margin:st.spacing(0,1)}),activeRow:(0,j.css)({color:st.colors.text.maxContrast,background:st.colors.emphasize(st.colors.background.primary,.03),"&:before":{display:"block",content:'" "',position:"absolute",left:0,top:0,bottom:0,width:st.spacing(.5),borderRadius:st.shape.radius.default,backgroundImage:st.colors.gradients.brandVertical}}),actionContainer:(0,j.css)({display:"flex",gap:st.spacing(1),alignItems:"baseline",fontSize:st.typography.fontSize,width:"100%"}),textContainer:(0,j.css)({display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),breadcrumbAncestor:(0,j.css)({color:st.colors.text.secondary}),breadcrumbSeparator:(0,j.css)({color:st.colors.text.secondary,marginLeft:st.spacing(1),marginRight:st.spacing(1)}),subtitleText:(0,j.css)({...st.typography.bodySmall,color:st.colors.text.secondary,display:"block",flexBasis:"20%",flexGrow:1,flexShrink:0,maxWidth:"fit-content",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})});var be=e(76459),Ke=e.n(be),ze=e(62301),nt=e(65812);const tt=6,ot=5,gt=4,He=3,et=2,rt=1,ht=100,ft=5,De=Ke()(Oe,200);async function Te(){if(!de.TP.user.isSignedIn)return[];const st=(await ze.A.getDashboardOpened()).slice(0,ft),Mt=(await(0,nt.getGrafanaSearcher)().search({kind:["dashboard"],limit:ft,uid:st})).view.toArray();return Mt.sort((rn,tn)=>{const Rn=st.indexOf(rn.uid),jn=st.indexOf(tn.uid);return Rn-jn}),Mt.map(rn=>{const{url:tn,name:Rn}=rn;return{id:`recent-dashboards${tn}`,name:`${Rn}`,section:(0,N.t)("command-palette.section.recent-dashboards","Recent dashboards"),priority:tt,url:tn}})}async function Oe(st){if(st.length===0||!de.TP.user.isSignedIn&&!c.$.bootData.settings.anonymousEnabled)return[];const bt=await(0,nt.getGrafanaSearcher)().search({kind:["dashboard","folder"],query:st,limit:ht});return bt.view.map(qt=>{const{url:rn,name:tn,kind:Rn,location:jn}=qt;return{id:`go/${Rn}${rn}`,name:`${tn}`,section:Rn==="dashboard"?(0,N.t)("command-palette.section.dashboard-search-results","Dashboards"):(0,N.t)("command-palette.section.folder-search-results","Folders"),priority:rt,url:rn,subtitle:bt.view.dataFrame.meta?.custom?.locationInfo[jn]?.name}})}function Ye(st,bt){const[Mt,qt]=(0,s.useState)([]),[rn,tn]=(0,s.useState)(!1),Rn=(0,s.useRef)(0);return(0,s.useEffect)(()=>{const jn=Date.now();bt&&st.length>0?(tn(!0),De(st).then(Wn=>{jn>Rn.current&&(qt(Wn),tn(!1),Rn.current=jn)})):(qt([]),tn(!1),Rn.current=jn)},[bt,st]),{searchResults:Mt,isFetchingSearchResults:rn}}var Ge=e(31678),Je=e(29795),it=e(2769);function St(st){return"navModel."+st.id}function zt(st,bt=[]){const Mt=[];for(let qt of st){qt.id==="help"&&(qt=(0,Je.CS)({...qt}),delete qt.url);const{url:rn,target:tn,text:Rn,isCreateAction:jn,children:Wn,onClick:bs,keywords:as}=qt,vs=!!Wn?.length;if(!(rn||bs||vs))continue;let Ts=rn;rn&&(qt.id==="connections-add-new-connection"||qt.id==="standalone-plugin-page-/connections/add-new-connection")&&(Ts=La=>{const ja=as?.find(br=>br.toLowerCase().includes(La.toLowerCase()));return ja?`${rn}?search=${ja}`:rn});const is=jn?(0,N.t)("command-palette.section.actions","Actions"):(0,N.t)("command-palette.section.pages","Pages"),Ds=jn?ot:gt,fs=bt.map(La=>La.text).join(" > "),ks={id:St(qt),name:Rn,section:is,url:Ts,target:tn,parent:bt.length>0&&!jn?St(bt[bt.length-1]):void 0,perform:bs,keywords:as?.join(" "),priority:Ds,subtitle:jn?void 0:fs};if(Mt.push(ks),Wn?.length){const La=zt(Wn,[...bt,qt]);Mt.push(...La)}}return Mt}const Kt=(st,bt)=>{const Mt=[{id:"preferences/theme",name:(0,N.t)("command-palette.action.change-theme","Change theme..."),keywords:"interface color dark light",section:(0,N.t)("command-palette.section.preferences","Preferences"),priority:He},{id:"preferences/dark-theme",name:(0,N.t)("command-palette.action.dark-theme","Dark"),keywords:"dark theme",perform:()=>(0,it.K)("dark"),parent:"preferences/theme",priority:He},{id:"preferences/light-theme",name:(0,N.t)("command-palette.action.light-theme","Light"),keywords:"light theme",perform:()=>(0,it.K)("light"),parent:"preferences/theme",priority:He}],qt=zt(st);return[...Mt,...bt,...qt]};var Qt=e(74135),an=e(71798);const Nn={};function zn(){const{links:st}=(0,an.U)({extensionPointId:Qt.S.CommandPalette,context:Nn,limitPerPlugin:3});return(0,s.useMemo)(()=>st.map(bt=>({section:bt.category??"Extensions",priority:et,id:bt.id,name:bt.title,target:bt.path,perform:()=>bt.onClick&&bt.onClick()})),[st])}function Yn(st){const[bt,Mt]=(0,s.useState)([]),[qt,rn]=(0,s.useState)([]),tn=zn(),Rn=(0,Ge.useSelector)(jn=>jn.navBarTree);return(0,s.useEffect)(()=>{const jn=Kt(Rn,tn);Mt(jn)},[Rn,tn]),(0,s.useEffect)(()=>{st||Te().then(jn=>rn(jn)).catch(jn=>{console.error("Error loading recent dashboard actions",jn)})},[st]),st?bt:[...qt,...bt]}var ss=e(53076);const ds={name:"none",priority:n.Priority.NORMAL};function Ms(st,bt){return bt.priority-st.priority}function Bs(){const{search:st,actions:bt,rootActionId:Mt}=(0,n.useKBar)(as=>({search:as.searchQuery,actions:as.actions,rootActionId:as.currentRootActionId})),qt=s.useMemo(()=>Object.keys(bt).reduce((as,vs)=>{const Ts=bt[vs];if(!Ts.parent&&!Mt&&as.push(Ts),Ts.id===Mt)for(let is=0;is<Ts.children.length;is++)as.push(Ts.children[is]);return as},[]).sort(Ms),[bt,Mt]),rn=s.useCallback(as=>{let vs=[];for(let Ts=0;Ts<as.length;Ts++)vs.push(as[Ts]);return function Ts(is,Ds=vs){for(let fs=0;fs<is.length;fs++)if(is[fs].children.length>0){let ks=is[fs].children;for(let La=0;La<ks.length;La++)Ds.push(ks[La]);Ts(is[fs].children,Ds)}return Ds}(as)},[]),tn=!st,Rn=s.useMemo(()=>tn?qt:rn(qt),[rn,qt,tn]),jn=gs(Rn,st),Wn=s.useMemo(()=>{let as={},vs=[],Ts=[];for(let Ds=0;Ds<jn.length;Ds++){const fs=jn[Ds],ks=fs.action,La=fs.score||n.Priority.NORMAL,ja={name:typeof ks.section=="string"?ks.section:ks.section?.name||ds.name,priority:typeof ks.section=="string"?La:ks.section?.priority||0+La};as[ja.name]||(as[ja.name]=[],vs.push(ja)),as[ja.name].push({priority:ks.priority+La,action:ks})}Ts=vs.sort(Ms).map(Ds=>({name:Ds.name,actions:as[Ds.name].sort(Ms).map(fs=>fs.action)}));let is=[];for(let Ds=0;Ds<Ts.length;Ds++){let fs=Ts[Ds];fs.name!==ds.name&&is.push(fs.name);for(let ks=0;ks<fs.actions.length;ks++)is.push(fs.actions[ks])}return is},[jn]),bs=s.useMemo(()=>Mt,[Wn]);return s.useMemo(()=>({results:Wn,rootActionId:bs}),[bs,Wn])}function gs(st,bt){const Mt=Ls(),qt=s.useMemo(()=>({filtered:st,search:bt}),[st,bt]),{filtered:rn,search:tn}=(0,me.useThrottledValue)(qt);return s.useMemo(()=>{if(tn.trim()==="")return rn.map(Wn=>({score:0,action:Wn}));const Rn=rn.map(({name:Wn,keywords:bs})=>`${Wn} ${bs??""}`.toLowerCase()),jn=[];if(tn.length>Zn){const Wn=tn.toLowerCase();for(let bs=0;bs<Rn.length;bs++){const vs=Rn[bs].indexOf(Wn);if(vs>-1){const Ts=vs*-1,is=rn[bs];jn.push({score:Ts,action:is})}}}else{const Wn=Mt.split(tn).length,bs=1/0,as=Wn<5?4:0,[,vs,Ts]=Mt.search(Rn,tn,as,bs);if(vs&&Ts)for(let is=0;is<Ts.length;is++){const Ds=Ts[is],fs=Ts.length-is,ks=rn[vs.idx[Ds]];jn.push({score:fs,action:ks})}}return jn},[rn,tn,Mt])}const Zn=25;function Ls(){const st=s.useRef();return st.current||(st.current=new ss.A({intraMode:0,intraIns:0})),st.current}function Ln(){const st=(0,W.of)(Qn),{query:bt,showing:Mt,searchQuery:qt}=(0,n.useKBar)(as=>({showing:as.visualState===n.VisualState.showing,searchQuery:as.searchQuery})),rn=Yn(qt);(0,n.useRegisterActions)(rn,[rn]);const{searchResults:tn,isFetchingSearchResults:Rn}=Ye(qt,Mt),jn=(0,s.useRef)(null),{overlayProps:Wn}=(0,It.e)({isOpen:Mt,onClose:()=>bt.setVisualState(n.VisualState.animatingOut)},jn),{dialogProps:bs}=(0,ut.s)({},jn);return(0,s.useEffect)(()=>{Mt&&(0,d.rR)("command_palette_opened")},[Mt]),rn.length>0?(0,t.jsx)(n.KBarPortal,{children:(0,t.jsx)(n.KBarPositioner,{className:st.positioner,children:(0,t.jsx)(n.KBarAnimator,{className:st.animator,children:(0,t.jsx)(Tt.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsxs)("div",{...Wn,...bs,children:[(0,t.jsxs)("div",{className:st.searchContainer,children:[(0,t.jsx)(ge.I,{name:"search",size:"md"}),(0,t.jsx)(n.KBarSearch,{defaultPlaceholder:(0,N.t)("command-palette.search-box.placeholder","Search or jump to..."),className:st.search}),(0,t.jsx)("div",{className:st.loadingBarContainer,children:Rn&&(0,t.jsx)(Ie.G,{width:500,delay:0})})]}),(0,t.jsx)("div",{className:st.resultsContainer,children:(0,t.jsx)(Hn,{isFetchingSearchResults:Rn,searchResults:tn})})]})})})})}):null}const Hn=({isFetchingSearchResults:st,searchResults:bt})=>{const{results:Mt,rootActionId:qt}=Bs(),rn=(0,W.of)(Qn),tn=(0,N.t)("command-palette.section.dashboard-search-results","Dashboards"),Rn=(0,N.t)("command-palette.section.folder-search-results","Folders"),jn=(0,s.useMemo)(()=>bt.filter(vs=>vs.id.startsWith("go/dashboard")).map(vs=>new n.ActionImpl(vs,{store:{}})),[bt]),Wn=(0,s.useMemo)(()=>bt.filter(vs=>vs.id.startsWith("go/folder")).map(vs=>new n.ActionImpl(vs,{store:{}})),[bt]),bs=(0,s.useMemo)(()=>{const vs=[...Mt];return Wn.length>0&&(vs.push(Rn),vs.push(...Wn)),jn.length>0&&(vs.push(tn),vs.push(...jn)),vs},[Mt,tn,jn,Rn,Wn]);return!st&&bs.length===0?(0,t.jsx)(ue.p,{variant:"not-found",role:"alert",message:(0,N.t)("command-palette.empty-state.message","No results found")}):(0,t.jsx)(Fe,{items:bs,maxHeight:650,onRender:({item:vs,active:Ts})=>{const is=bs[0]===vs;return typeof vs=="string"?(0,t.jsx)("div",{className:(0,j.cx)(rn.sectionHeader,is&&rn.sectionHeaderFirst),children:vs}):(0,t.jsx)(Be,{action:vs,active:Ts,currentRootActionId:qt})}})},Qn=st=>({positioner:(0,j.css)({zIndex:st.zIndex.portal,marginTop:"0px",paddingTop:"4px !important","&::before":{content:'""',position:"fixed",top:0,right:0,bottom:0,left:0,background:st.components.overlay.background,backdropFilter:"blur(1px)"}}),animator:(0,j.css)({maxWidth:st.breakpoints.values.md,width:"100%",background:st.colors.background.primary,color:st.colors.text.primary,borderRadius:st.shape.radius.default,border:`1px solid ${st.colors.border.weak}`,overflow:"hidden",boxShadow:st.shadows.z3}),loadingBarContainer:(0,j.css)({position:"absolute",left:0,right:0,bottom:0}),searchContainer:(0,j.css)({alignItems:"center",background:st.components.input.background,borderBottom:`1px solid ${st.colors.border.weak}`,display:"flex",gap:st.spacing(1),padding:st.spacing(1,2),position:"relative"}),search:(0,j.css)({fontSize:st.typography.fontSize,width:"100%",boxSizing:"border-box",outline:"none",border:"none",color:st.components.input.text}),spinner:(0,j.css)({height:"22px"}),resultsContainer:(0,j.css)({paddingBottom:st.spacing(1)}),sectionHeader:(0,j.css)({padding:st.spacing(1.5,2,2,2),fontSize:st.typography.bodySmall.fontSize,fontWeight:st.typography.fontWeightMedium,color:st.colors.text.secondary,borderTop:`1px solid ${st.colors.border.weak}`,marginTop:st.spacing(1)}),sectionHeaderFirst:(0,j.css)({paddingBottom:st.spacing(1),borderTop:"none",marginTop:0})});var mt=e(53001),Yt=e(59875),on=e(86634),ln=e(32209),fn=e(13390),yn=e(27746),wn=e(28215);function Xn({href:st,isCurrent:bt,text:Mt,index:qt,flexGrow:rn}){const tn=(0,W.of)(xn),Rn=()=>{(0,d.rR)("grafana_breadcrumb_clicked",{url:st})};return(0,t.jsx)("li",{className:tn.breadcrumbWrapper,style:{flexGrow:rn},children:bt?(0,t.jsx)("span",{"data-testid":fn.X.Breadcrumbs.breadcrumb(Mt),className:tn.breadcrumb,"aria-current":"page",title:Mt,children:Mt}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("a",{onClick:Rn,"data-testid":fn.X.Breadcrumbs.breadcrumb(Mt),className:(0,j.cx)(tn.breadcrumb,tn.breadcrumbLink),title:Mt,href:st,children:Mt}),(0,t.jsx)("div",{className:tn.separator,"aria-hidden":!0,children:(0,t.jsx)(ge.I,{name:"angle-right"})})]})})}const xn=st=>({breadcrumb:(0,j.css)({display:"block",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",color:st.colors.text.secondary}),breadcrumbLink:(0,j.css)({color:st.colors.text.primary,"&:hover":{textDecoration:"underline"}}),breadcrumbWrapper:(0,j.css)({alignItems:"center",color:st.colors.text.primary,display:"flex",flex:1,gap:st.spacing(.5),minWidth:0,maxWidth:"max-content",padding:st.spacing(.5,0,.5,.5),[st.breakpoints.down("sm")]:{display:"none","&:nth-last-child(2)":{display:"flex",minWidth:"40px"},"&:last-child":{display:"flex"}}}),separator:(0,j.css)({color:st.colors.text.secondary})});function Ut({breadcrumbs:st,className:bt}){const Mt=(0,W.of)(hn);return(0,t.jsx)("nav",{"aria-label":"Breadcrumbs",className:bt,children:(0,t.jsx)("ol",{className:Mt.breadcrumbs,children:st.map((qt,rn)=>(0,s.createElement)(Xn,{...qt,isCurrent:rn===st.length-1,key:rn,index:rn,flexGrow:nn(rn,st.length)}))})})}function nn(st,bt){return bt<5&&st>0&&st<bt-2||bt>6&&st>1&&st<bt-3?4:10}const hn=st=>({breadcrumbs:(0,j.css)({display:"flex",alignItems:"center",flexWrap:"nowrap",overflow:"hidden"})});var dn=e(3984),Sn=e(57571),es=e(10804);const Pt="mega-menu-toggle";function Ze({actions:st,searchBarHidden:bt,sectionNav:Mt,pageNav:qt,onToggleMegaMenu:rn,onToggleSearchBar:tn,onToggleKioskMode:Rn}){const{chrome:jn}=(0,M.Il)(),Wn=jn.useState(),bs=(0,Ge.useSelector)(Ts=>Ts.navIndex)[wn.Id],as=(0,W.of)(lt),vs=(0,dn.Z)(Mt,qt,bs);return(0,t.jsxs)("div",{"data-testid":fn.X.NavToolbar.container,className:as.pageToolbar,children:[(0,t.jsx)("div",{className:as.menuButton,children:(0,t.jsx)(Ue.K,{id:Pt,name:"bars",tooltip:Wn.megaMenuOpen?(0,N.t)("navigation.toolbar.close-menu","Close menu"):(0,N.t)("navigation.toolbar.open-menu","Open menu"),tooltipPlacement:"bottom",size:"xl",onClick:rn,"data-testid":fn.X.NavBar.Toggle.button})}),(0,t.jsx)(Ut,{breadcrumbs:vs,className:as.breadcrumbsWrapper}),(0,t.jsxs)("div",{className:as.actions,children:[st,bt&&(0,t.jsx)(yn.I,{onClick:Rn,narrow:!0,title:(0,N.t)("navigation.toolbar.enable-kiosk","Enable kiosk mode"),icon:"monitor"}),st&&(0,t.jsx)(es.K,{}),(0,t.jsx)(yn.I,{onClick:tn,narrow:!0,title:(0,N.t)("navigation.toolbar.toggle-search-bar","Toggle top search bar"),children:(0,t.jsx)(ge.I,{name:bt?"angle-down":"angle-up",size:"xl"})})]})]})}const lt=st=>({breadcrumbsWrapper:(0,j.css)({display:"flex",overflow:"hidden",[st.breakpoints.down("sm")]:{minWidth:"50%"}}),pageToolbar:(0,j.css)({height:Sn.l,display:"flex",padding:st.spacing(0,1,0,2),alignItems:"center",borderBottom:`1px solid ${st.colors.border.weak}`}),menuButton:(0,j.css)({display:"flex",alignItems:"center",marginRight:st.spacing(1)}),actions:(0,j.css)({label:"NavToolbar-actions",display:"flex",alignItems:"center",flexWrap:"nowrap",justifyContent:"flex-end",paddingLeft:st.spacing(1),flexGrow:1,gap:st.spacing(1),minWidth:0,".body-drawer-open &":{display:"none"}})});function yt({}){const st=(0,W.$j)(),{chrome:bt}=(0,M.Il)(),Mt=bt.useState(),qt=Mt.searchBarHidden||Mt.kioskMode===Ge.KioskMode.TV,rn=(0,s.useRef)(null),tn=(0,s.useRef)(null),Rn=st.transitions.duration.shortest,jn=(0,W.of)(wt,Rn),Wn=Mt.megaMenuOpen&&!Mt.megaMenuDocked,bs=()=>bt.setMegaMenuOpen(!1),{overlayProps:as,underlayProps:vs}=(0,It.e)({isDismissable:!0,isOpen:!0,onClose:bs,shouldCloseOnInteractOutside:Ds=>!document.getElementById(Pt)?.contains(Ds)},rn),{dialogProps:Ts}=(0,ut.s)({},rn),is=(0,W.of)(Nt,qt);return(0,t.jsx)("div",{className:is.wrapper,children:(0,t.jsxs)(Yt.Sf,{children:[(0,t.jsx)(on.A,{nodeRef:rn,in:Wn,unmountOnExit:!0,classNames:jn.overlay,timeout:{enter:Rn,exit:0},children:(0,t.jsx)(Tt.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)(ln.A,{className:is.menu,onClose:bs,ref:rn,...as,...Ts})})}),(0,t.jsx)(on.A,{nodeRef:tn,in:Wn,unmountOnExit:!0,classNames:jn.backdrop,timeout:{enter:Rn,exit:0},children:(0,t.jsx)("div",{ref:tn,className:is.backdrop,...vs})})]})})}const Nt=(st,bt)=>{let Mt=bt?Sn.l:Sn.l*2;return c.$.featureToggles.singleTopNav&&(Mt=0),{backdrop:(0,j.css)({backdropFilter:"blur(1px)",backgroundColor:st.components.overlay.background,bottom:0,left:0,position:"fixed",right:0,top:bt||c.$.featureToggles.singleTopNav?0:Sn.l,zIndex:st.zIndex.modalBackdrop,[st.breakpoints.up("md")]:{top:Mt}}),menu:(0,j.css)({display:"flex",bottom:0,flexDirection:"column",left:0,right:0,zIndex:st.zIndex.modal,position:"fixed",top:bt||c.$.featureToggles.singleTopNav?0:Sn.l,backgroundColor:st.colors.background.primary,flex:"1 1 0",[st.breakpoints.up("md")]:{right:"unset",top:Mt}}),wrapper:(0,j.css)({position:"fixed",display:"grid",gridAutoFlow:"column",height:"100%",zIndex:st.zIndex.sidemenu})}},wt=(st,bt)=>{const Mt={[st.transitions.handleMotion("no-preference")]:{transitionDuration:`${bt}ms`,transitionTimingFunction:st.transitions.easing.easeInOut},[st.breakpoints.down("md")]:{overflow:"hidden"}},qt={...Mt,transitionProperty:"box-shadow, width",".scrollbar-view":{overflow:"hidden !important"}},rn={...Mt,transitionProperty:"opacity"},tn={width:"100%",[st.breakpoints.up("md")]:{borderRight:`1px solid ${st.colors.border.weak}`,boxShadow:st.shadows.z3,width:ln.J}},Rn={boxShadow:"none",width:0},jn={opacity:1},Wn={opacity:0};return{backdrop:{enter:(0,j.css)(Wn),enterActive:(0,j.css)(rn,jn),enterDone:(0,j.css)(jn)},overlay:{enter:(0,j.css)(Rn),enterActive:(0,j.css)(qt,tn),enterDone:(0,j.css)(tn)}}};var Zt=e(70944),pn=e(13544),On=e(19727);const An=({label:st,onClick:bt,onDismiss:Mt})=>{const qt=(0,W.of)(qn);return(0,t.jsxs)(On.e,{className:qt.buttonGroup,children:[(0,t.jsx)(U.$n,{icon:"angle-left",size:"sm",variant:"primary",fill:"outline",onClick:bt,title:st,className:qt.mainDismissableButton,"data-testid":pn.Tp.components.ReturnToPrevious.backButton,children:st}),(0,t.jsx)(U.$n,{icon:"times","aria-label":(0,N.t)("return-to-previous.dismissable-button","Close"),variant:"primary",fill:"outline",size:"sm",onClick:Mt,"data-testid":pn.Tp.components.ReturnToPrevious.dismissButton})]})},qn=st=>({mainDismissableButton:(0,j.css)({width:"100%","> span":{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"270px",display:"inline-block"}}),buttonGroup:(0,j.css)({width:"fit-content",backgroundColor:st.colors.background.secondary})});An.displayName="DismissableButton";const cs=({href:st,title:bt})=>{const Mt=(0,W.of)(Os),{chrome:qt}=(0,M.Il)(),rn=(0,s.useCallback)(()=>{l.Ny.push(st),qt.clearReturnToPrevious("clicked")},[st,qt]),tn=(0,s.useCallback)(()=>{qt.clearReturnToPrevious("dismissed")},[qt]);return(0,t.jsx)("div",{className:Mt.returnToPrevious,"data-testid":pn.Tp.components.ReturnToPrevious.buttonGroup,children:(0,t.jsx)(An,{label:(0,N.t)("return-to-previous.button.label","Back to {{title}}",{title:bt}),onClick:rn,onDismiss:tn})})},Os=st=>({returnToPrevious:(0,j.css)({label:"return-to-previous",display:"flex",justifyContent:"center",left:"50%",transform:"translateX(-50%)",zIndex:st.zIndex.tooltip,position:"fixed",bottom:st.spacing.x4,boxShadow:st.shadows.z3})});cs.displayName="ReturnToPrevious";var xs=e(2543),zs=e(83122),Ks=e(2913),ma=e(19361),la=e(42941),Ua=e(87978),Ra=e(94753),Pa=e(62372),wa=e(49185),Ea=e(69386),Za=e(4172);function Na({feedUrl:st}){const bt=(0,W.of)(gr),{state:Mt,getNews:qt}=(0,Za.n)(st),[rn,tn]=(0,wa.A)();return(0,s.useEffect)(()=>{qt()},[qt]),Mt.error?(0,t.jsx)("div",{className:bt.innerWrapper,children:Mt.error&&Mt.error.message}):(0,t.jsxs)("div",{ref:rn,children:[Mt.loading?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Ea.K.Skeleton,{showImage:!0,width:tn.width}),(0,t.jsx)(Ea.K.Skeleton,{showImage:!0,width:tn.width}),(0,t.jsx)(Ea.K.Skeleton,{showImage:!0,width:tn.width}),(0,t.jsx)(Ea.K.Skeleton,{showImage:!0,width:tn.width}),(0,t.jsx)(Ea.K.Skeleton,{showImage:!0,width:tn.width})]}):(0,t.jsx)(t.Fragment,{children:tn.width>0&&Mt.value?.map((Rn,jn)=>(0,t.jsx)(Ea.K,{index:jn,showImage:!0,width:tn.width,data:Mt.value},jn))}),(0,t.jsx)("div",{className:bt.grot,children:(0,t.jsx)("a",{href:"https://grafana.com/blog/",target:"_blank",rel:"noreferrer",title:"Go to Grafana labs blog",children:(0,t.jsx)("img",{src:"public/img/grot-news.svg",alt:"Grot reading news"})})})]})}const gr=st=>({innerWrapper:(0,j.css)({width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}),grot:(0,j.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:st.spacing(5,0),img:{width:"186px",height:"186px"}})});function cr({className:st}){const[bt,Mt]=(0,la.A)(!1),qt=(0,W.of)(Ha);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(yn.I,{className:st,onClick:Mt,iconOnly:!0,icon:"rss","aria-label":"News"}),bt&&(0,t.jsx)(Ua._,{title:(0,t.jsxs)("div",{className:qt.title,children:[(0,t.jsx)(Ra.E,{element:"h2",children:(0,N.t)("news.title","Latest from the blog")}),(0,t.jsx)("a",{href:"https://grafana.com/blog/",target:"_blank",rel:"noreferrer",title:"Go to Grafana labs blog",className:qt.grot,children:(0,t.jsx)("img",{src:"public/img/grot-news.svg",alt:"Grot reading news"})}),(0,t.jsx)("div",{className:qt.actions,children:(0,t.jsx)(Ue.K,{name:"times",variant:"secondary",onClick:Mt,"data-testid":pn.Tp.components.Drawer.General.close,tooltip:(0,N.t)("news.drawer.close","Close Drawer")})})]}),onClose:Mt,size:"md",children:(0,t.jsx)(Na,{feedUrl:Pa.$})})]})}const Ha=st=>({title:(0,j.css)({display:"flex",alignItems:"center",justifyContent:"center",gap:st.spacing(2),borderBottom:`1px solid ${st.colors.border.weak}`}),grot:(0,j.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:st.spacing(2,0),img:{width:"75px",height:"75px"}}),actions:(0,j.css)({position:"absolute",right:st.spacing(1),top:st.spacing(2)})});var $a=e(38138);function Xa(st){const bt=[];for(const Mt of st)Mt.isCreateAction&&bt.push(Mt),Mt.children&&bt.push(...Xa(Mt.children));return bt}const _a=({})=>{const st=(0,W.of)(vt),bt=(0,W.$j)(),Mt=(0,Ge.useSelector)(Ts=>Ts.navBarTree),qt=bt.breakpoints.values.sm,[rn,tn]=(0,s.useState)(!1),[Rn,jn]=(0,s.useState)(!window.matchMedia(`(min-width: ${qt}px)`).matches),Wn=(0,s.useMemo)(()=>Xa(Mt),[Mt]),bs=c.$.featureToggles.singleTopNav,as=Wn.length>0&&(!bs||!Rn);(0,_e.Y)({breakpoint:qt,onChange:Ts=>{jn(!Ts.matches)}});const vs=()=>(0,t.jsx)($a.W,{children:Wn.map((Ts,is)=>(0,t.jsx)($a.W.Item,{url:Ts.url,label:Ts.text,onClick:()=>(0,d.rR)("grafana_menu_item_clicked",{url:Ts.url,from:"quickadd"})},is))});return as?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(zs.m,{overlay:vs,placement:"bottom-end",onVisibleChange:tn,children:(0,t.jsx)(yn.I,{iconOnly:!0,icon:Rn?"plus-circle":"plus",isOpen:Rn?void 0:rn,"aria-label":"New"})}),(0,t.jsx)(es.K,{className:st.separator})]}):null},vt=st=>({buttonContent:(0,j.css)({alignItems:"center",display:"flex"}),buttonText:(0,j.css)({[st.breakpoints.down("md")]:{display:"none"}}),separator:(0,j.css)({[st.breakpoints.down("sm")]:{display:"none"}})});var kt=e(80997);function cn(){const st=(0,i.zy)(),bt=(0,W.of)(vn);let Mt=kt.sQ.sanitizeUrl(A.I.getUrlForPartial(st,{forceLogin:"true"}));return Mt.startsWith("//")&&(Mt=Mt.replace(/\/+/g,"/")),(0,t.jsx)("a",{className:bt.link,href:Mt,target:"_self",children:"Sign in"})}const vn=st=>({link:(0,j.css)({paddingRight:st.spacing(1),whiteSpace:"nowrap","&:hover":{textDecoration:"underline"}})});var Pn=e(64539);function Kn({node:st}){const bt=(0,W.of)(us),Mt=(0,Je.J0)((0,xs.cloneDeep)(st),!1);return Mt?(0,t.jsx)($a.W,{header:(0,t.jsxs)("div",{onClick:qt=>qt.stopPropagation(),className:bt.header,children:[(0,t.jsx)("div",{children:Mt.text}),Mt.subTitle&&(0,t.jsx)("div",{className:bt.subTitle,children:Mt.subTitle})]}),children:Mt.children?.map(qt=>qt.url?(0,t.jsx)(Pn.D,{url:qt.url,label:qt.text,icon:qt.icon,target:qt.target},qt.id):(0,t.jsx)(Pn.D,{icon:qt.icon,onClick:qt.onClick,label:qt.text},qt.id))}):null}const us=st=>({header:(0,j.css)({fontSize:st.typography.h5.fontSize,fontWeight:st.typography.h5.fontWeight,padding:st.spacing(.5,1),whiteSpace:"nowrap"}),subTitle:(0,j.css)({color:st.colors.text.secondary,fontSize:st.typography.bodySmall.fontSize})});var Gn=e(10354),ps=e(16797),Dt=e(63917);function un(){const st=(0,W.$j)(),bt=c.$.featureToggles.singleTopNav,{query:Mt}=(0,n.useKBar)(jn=>({kbarSearchQuery:jn.searchQuery,kbarIsOpen:jn.visualState===n.VisualState.showing})),qt=bt?st.breakpoints.values.lg:st.breakpoints.values.sm,[rn,tn]=(0,s.useState)(!window.matchMedia(`(min-width: ${qt}px)`).matches);(0,_e.Y)({breakpoint:qt,onChange:jn=>{tn(!jn.matches)}});const Rn=()=>{Mt.toggle()};return rn?(0,t.jsx)(yn.I,{iconOnly:!0,icon:"search","aria-label":(0,N.t)("nav.search.placeholderCommandPalette","Search or jump to..."),onClick:Rn}):(0,t.jsx)(Bn,{onClick:Rn})}function Bn({onClick:st}){const bt=(0,W.of)(Jn),Mt=(0,s.useMemo)(()=>(0,Dt.gn)(),[]);return(0,t.jsx)("div",{className:bt.wrapper,children:(0,t.jsxs)("div",{className:bt.inputWrapper,children:[(0,t.jsx)("div",{className:bt.prefix,children:(0,t.jsx)(ge.I,{name:"search"})}),(0,t.jsx)("button",{className:bt.fakeInput,onClick:st,children:(0,N.t)("nav.search.placeholderCommandPalette","Search or jump to...")}),(0,t.jsxs)("div",{className:bt.suffix,children:[(0,t.jsx)(ge.I,{name:"keyboard"}),(0,t.jsxs)(Ra.E,{variant:"bodySmall",children:[Mt,"+k"]})]})]})})}const Jn=st=>{const bt=(0,Gn.n)({theme:st});return{wrapper:bt.wrapper,inputWrapper:bt.inputWrapper,prefix:bt.prefix,suffix:(0,j.css)([bt.suffix,{display:"flex",gap:st.spacing(.5)}]),fakeInput:(0,j.css)([bt.input,{textAlign:"left",paddingLeft:28,color:st.colors.text.disabled,"&:focus":{outline:"unset",boxShadow:"unset"},"&:focus-visible":(0,j.css)`
          ${(0,ps.focusCss)(st)}
        `}]),button:(0,j.css)({width:"100%",textAlign:"center","> *":{width:"100%",textAlign:"center",justifyContent:"center",gap:"1ch"}})}},In=(0,s.memo)(function({onToggleMegaMenu:bt,onToggleKioskMode:Mt,pageNav:qt,sectionNav:rn}){const{chrome:tn}=(0,M.Il)(),Rn=tn.useState(),jn=!Rn.chromeless&&Rn.megaMenuDocked&&Rn.megaMenuOpen,Wn=(0,W.of)(ms,jn),bs=(0,Ge.useSelector)(fs=>fs.navIndex),as=(0,xs.cloneDeep)(bs.help),vs=as?(0,Je.CS)(as):void 0,Ts=bs.profile,is=(0,Ge.useSelector)(fs=>fs.navIndex)[wn.Id],Ds=(0,dn.Z)(rn,qt,is);return(0,t.jsxs)("div",{className:Wn.layout,children:[(0,t.jsxs)(Ve.B,{minWidth:0,gap:.5,alignItems:"center",children:[!jn&&(0,t.jsx)(yn.I,{narrow:!0,onClick:bt,tooltip:(0,N.t)("navigation.megamenu.open","Open menu"),children:(0,t.jsxs)(Ve.B,{gap:0,alignItems:"center",children:[(0,t.jsx)(ma.M.MenuLogo,{className:Wn.img}),(0,t.jsx)(ge.I,{size:"sm",name:"angle-down"})]})}),(0,t.jsx)(Ut,{breadcrumbs:Ds,className:Wn.breadcrumbsWrapper})]}),(0,t.jsxs)(Ve.B,{gap:.5,alignItems:"center",children:[(0,t.jsx)(un,{}),(0,t.jsx)(_a,{}),vs&&(0,t.jsx)(zs.m,{overlay:()=>(0,t.jsx)(Kn,{node:vs}),placement:"bottom-end",children:(0,t.jsx)(yn.I,{iconOnly:!0,icon:"question-circle","aria-label":"Help"})}),Ks.$W.newsFeedEnabled&&(0,t.jsx)(cr,{}),!D.TP.user.isSignedIn&&(0,t.jsx)(cn,{}),Ts&&(0,t.jsx)(zs.m,{overlay:()=>(0,t.jsx)(Kn,{node:Ts}),placement:"bottom-end",children:(0,t.jsx)(yn.I,{className:Wn.profileButton,imgSrc:D.TP.user.gravatarUrl,imgAlt:"User avatar","aria-label":"Profile"})}),(0,t.jsx)(yn.I,{className:Wn.kioskToggle,onClick:Mt,narrow:!0,"aria-label":"Enable kiosk mode",children:(0,t.jsx)(ge.I,{name:"angle-up",size:"xl"})})]})]})}),ms=(st,bt)=>({layout:(0,j.css)({height:Sn.l,display:"flex",gap:st.spacing(2),alignItems:"center",padding:st.spacing(0,1),paddingLeft:bt?st.spacing(3.5):st.spacing(.75),borderBottom:`1px solid ${st.colors.border.weak}`,justifyContent:"space-between",[st.breakpoints.up("lg")]:{gridTemplateColumns:"2fr minmax(440px, 1fr)",display:"grid",justifyContent:"flex-start"}}),breadcrumbsWrapper:(0,j.css)({display:"flex",overflow:"hidden",[st.breakpoints.down("sm")]:{minWidth:"40%"}}),img:(0,j.css)({alignSelf:"center",height:st.spacing(3),width:st.spacing(3)}),profileButton:(0,j.css)({padding:st.spacing(0,.25),img:{borderRadius:st.shape.radius.circle,height:"24px",marginRight:0,width:"24px"}}),kioskToggle:(0,j.css)({[st.breakpoints.down("lg")]:{display:"none"}})});var Es=e(13884);function Cs({children:st,align:bt="left"}){const Mt=(0,W.of)(hs),rn=(0,W.$j)().breakpoints.values.sm,[tn,Rn]=(0,s.useState)(!window.matchMedia(`(min-width: ${rn}px)`).matches);return(0,_e.Y)({breakpoint:rn,onChange:jn=>{Rn(!jn.matches)}}),tn?(0,t.jsx)(t.Fragment,{children:st}):(0,t.jsx)("div",{"data-testid":"wrapper",className:(0,j.cx)(Mt.wrapper,{[Mt[bt]]:bt==="right"}),children:st})}const hs=st=>({wrapper:(0,j.css)({display:"flex",gap:st.spacing(.5),alignItems:"center"}),right:(0,j.css)({justifyContent:"flex-end"}),left:(0,j.css)({}),center:(0,j.css)({})}),fa=(0,s.memo)(function(){const bt=(0,W.of)(oa),Mt=(0,Ge.useSelector)(Wn=>Wn.navIndex),qt=(0,i.zy)(),rn=(0,xs.cloneDeep)(Mt.help),tn=rn?(0,Je.CS)(rn):void 0,Rn=Mt.profile;let jn=Ks.$W.appSubUrl||"/";return!Ks.$W.bootData.user.isSignedIn&&!Ks.$W.anonymousEnabled&&(jn=kt.sQ.sanitizeUrl(A.I.getUrlForPartial(qt,{forceLogin:"true"}))),(0,t.jsxs)("div",{className:bt.layout,children:[(0,t.jsxs)(Cs,{children:[(0,t.jsx)("a",{className:bt.logo,href:jn,title:"Go to home",children:(0,t.jsx)(ma.M.MenuLogo,{className:bt.img})}),(0,t.jsx)(Es.N,{}),(0,t.jsx)(mt.Dh,{})]}),(0,t.jsx)(Cs,{children:(0,t.jsx)(un,{})}),(0,t.jsxs)(Cs,{align:"right",children:[(0,t.jsx)(_a,{}),tn&&(0,t.jsx)(zs.m,{overlay:()=>(0,t.jsx)(Kn,{node:tn}),placement:"bottom-end",children:(0,t.jsx)(yn.I,{iconOnly:!0,icon:"question-circle","aria-label":"Help"})}),Ks.$W.newsFeedEnabled&&(0,t.jsx)(cr,{}),!D.TP.user.isSignedIn&&(0,t.jsx)(cn,{}),Rn&&(0,t.jsx)(zs.m,{overlay:()=>(0,t.jsx)(Kn,{node:Rn}),placement:"bottom-end",children:(0,t.jsx)(yn.I,{className:bt.profileButton,imgSrc:D.TP.user.gravatarUrl,imgAlt:"User avatar","aria-label":"Profile"})})]})]})}),oa=st=>({layout:(0,j.css)({height:Sn.l,display:"flex",gap:st.spacing(1),alignItems:"center",padding:st.spacing(0,1,0,2),borderBottom:`1px solid ${st.colors.border.weak}`,justifyContent:"space-between",[st.breakpoints.up("sm")]:{gridTemplateColumns:"1.5fr minmax(240px, 1fr) 1.5fr",display:"grid",justifyContent:"flex-start"}}),img:(0,j.css)({height:st.spacing(3),width:st.spacing(3)}),logo:(0,j.css)({display:"flex"}),profileButton:(0,j.css)({padding:st.spacing(0,.25),img:{borderRadius:st.shape.radius.circle,height:"24px",marginRight:0,width:"24px"}})});function na({children:st}){const{chrome:bt}=(0,M.Il)(),Mt=bt.useState(),qt=Mt.searchBarHidden||Mt.kioskMode===Ge.KioskMode.TV,rn=(0,W.$j)(),tn=(0,W.of)(Bt,qt),Rn=rn.breakpoints.values.xl,jn=at.A.getBool(Zt.hE,!0),Wn=!Mt.chromeless&&Mt.megaMenuDocked&&Mt.megaMenuOpen,bs=(0,mt.fX)(),as=!!(bs?.isEnabled&&bs?.isPanelOpened),vs=c.$.featureToggles.singleTopNav;(0,_e.Y)({breakpoint:Rn,onChange:ja=>{jn&&(bt.setMegaMenuDocked(ja.matches,!1),bt.setMegaMenuOpen(ja.matches?at.A.getBool(Zt.k0,Mt.megaMenuOpen):!1))}});const Ts=(0,j.cx)({[tn.content]:!0,[tn.contentNoSearchBar]:qt,[tn.contentChromeless]:Mt.chromeless}),is=()=>{bt.setMegaMenuOpen(!Mt.megaMenuOpen)},{pathname:Ds,search:fs}=l.Ny.getLocation(),ks=Ds+fs,La=Mt.returnToPrevious&&ks!==Mt.returnToPrevious.href;return(0,s.useEffect)(()=>{Mt.returnToPrevious&&ks===Mt.returnToPrevious.href&&bt.clearReturnToPrevious("auto_dismissed")},[bt,ks]),(0,s.useEffect)(()=>{const ja=(0,l.SE)(fs);bt.setKioskModeFromUrl(ja.kiosk)},[bt,fs]),(0,t.jsxs)("div",{className:We()("main-view",{"main-view--search-bar-hidden":qt&&!Mt.chromeless,"main-view--chrome-hidden":Mt.chromeless}),children:[!Mt.chromeless&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(U.z9,{className:tn.skipLink,href:"#pageContent",children:"Skip to main content"}),vs&&Wn&&(0,t.jsx)(ln.A,{className:tn.dockedMegaMenu,onClose:()=>bt.setMegaMenuOpen(!1)}),(0,t.jsx)("header",{className:(0,j.cx)(tn.topNav,vs&&Wn&&tn.topNavMenuDocked),children:vs?(0,t.jsx)(In,{sectionNav:Mt.sectionNav.node,pageNav:Mt.pageNav,onToggleMegaMenu:is,onToggleKioskMode:bt.onToggleKioskMode}):(0,t.jsxs)(t.Fragment,{children:[!qt&&(0,t.jsx)(fa,{}),(0,t.jsx)(Ze,{searchBarHidden:qt,sectionNav:Mt.sectionNav.node,pageNav:Mt.pageNav,actions:Mt.actions,onToggleSearchBar:bt.onToggleSearchBar,onToggleMegaMenu:is,onToggleKioskMode:bt.onToggleKioskMode})]})})]}),(0,t.jsx)("div",{className:Ts,children:(0,t.jsxs)("div",{className:tn.panes,children:[!vs&&Wn&&(0,t.jsx)(ln.A,{className:tn.dockedMegaMenu,onClose:()=>bt.setMegaMenuOpen(!1)}),!Mt.chromeless&&(0,t.jsx)("div",{className:(0,j.cx)(tn.scopesDashboardsContainer,{[tn.scopesDashboardsContainerDocked]:Wn}),children:(0,t.jsx)(mt.T3,{})}),(0,t.jsx)("main",{className:(0,j.cx)(tn.pageContainer,{[tn.pageContainerMenuDocked]:Wn||as,[tn.pageContainerMenuDockedScopes]:Wn&&as}),id:"pageContent",children:st})]})}),!Mt.chromeless&&!Mt.megaMenuDocked&&(0,t.jsx)(yt,{}),!Mt.chromeless&&(0,t.jsx)(Ln,{}),La&&Mt.returnToPrevious&&(0,t.jsx)(cs,{href:Mt.returnToPrevious.href,title:Mt.returnToPrevious.title})]})}const Bt=(st,bt)=>{const Mt=c.$.featureToggles.singleTopNav;return{content:(0,j.css)({display:"flex",flexDirection:"column",paddingTop:Mt?Sn.l:Sn.l*2,flexGrow:1,height:"auto"}),contentNoSearchBar:(0,j.css)({paddingTop:Sn.l}),contentChromeless:(0,j.css)({paddingTop:0}),dockedMegaMenu:(0,j.css)({background:st.colors.background.primary,borderRight:`1px solid ${st.colors.border.weak}`,display:"none",width:ln.J,[st.breakpoints.up("xl")]:{display:"block"}},{position:"fixed",height:`calc(100% - ${bt?Sn.l:Sn.l*2}px)`,zIndex:2},Mt&&{height:"100%",top:0}),scopesDashboardsContainer:(0,j.css)({position:"fixed",height:`calc(100% - ${bt||Mt?Sn.l:Sn.l*2}px)`,zIndex:1}),scopesDashboardsContainerDocked:(0,j.css)({left:ln.J}),topNav:(0,j.css)({display:"flex",position:"fixed",zIndex:st.zIndex.navbarFixed,left:0,right:0,background:st.colors.background.primary,flexDirection:"column"}),topNavMenuDocked:(0,j.css)({left:ln.J}),panes:(0,j.css)({display:"flex",flexDirection:"column",flexGrow:1,label:"page-panes"}),pageContainerMenuDocked:(0,j.css)({paddingLeft:ln.J}),pageContainerMenuDockedScopes:(0,j.css)({paddingLeft:`calc(${ln.J} * 2)`}),pageContainer:(0,j.css)({label:"page-container",display:"flex",flexDirection:"column",flexGrow:1}),skipLink:(0,j.css)({position:"fixed",top:-1e3,":focus":{left:st.spacing(1),top:st.spacing(1),zIndex:st.zIndex.portal}})}};var Wt=e(26272),_t=e(82467),sn=e(28138),Cn=e(16001),Fn=e(3169),$n=e(94701);function ts({appNotification:st,onClearNotification:bt}){const Mt=(0,W.of)(Vn);(0,$n.A)(()=>{setTimeout(()=>{bt(st.id)},Ge.timeoutMap[st.severity])});const qt=st.component||st.text||st.traceId;return(0,t.jsx)(pe.F,{severity:st.severity,title:st.title,onRemove:()=>bt(st.id),elevated:!0,children:qt&&(0,t.jsxs)("div",{className:Mt.wrapper,children:[(0,t.jsx)("span",{children:st.component||st.text}),st.traceId&&(0,t.jsxs)("span",{className:Mt.trace,children:["Trace ID: ",st.traceId]})]})})}function Vn(st){return{wrapper:(0,j.css)({display:"flex",flexDirection:"column"}),trace:(0,j.css)({fontSize:st.typography.pxToRem(10)})}}function Un(){const st=(0,Ge.useSelector)(rn=>(0,Cn.fX)(rn.appNotifications)),bt=(0,Ge.useDispatch)(),Mt=(0,W.of)(ys);(0,s.useEffect)(()=>{sn.A.on(Wt.r1.alertWarning,rn=>bt((0,_t.dx)((0,Fn.q8)(...rn)))),sn.A.on(Wt.r1.alertSuccess,rn=>bt((0,_t.dx)((0,Fn.tZ)(...rn)))),sn.A.on(Wt.r1.alertError,rn=>bt((0,_t.dx)((0,Fn.gi)(...rn)))),sn.A.on(Wt.r1.alertInfo,rn=>bt((0,_t.dx)((0,Fn.Cf)(...rn))))},[bt]);const qt=rn=>{bt((0,_t.Do)(rn))};return(0,t.jsx)("div",{className:Mt.wrapper,children:(0,t.jsx)(Ve.B,{direction:"column",children:st.map((rn,tn)=>(0,t.jsx)(ts,{appNotification:rn,onClearNotification:qt},`${rn.id}-${tn}`))})})}function ys(st){return{wrapper:(0,j.css)({label:"app-notifications-list",zIndex:st.zIndex.portal,minWidth:400,maxWidth:600,position:"fixed",right:6,top:88})}}var ws=e(96374),As=e(28444);function $s(st){const[bt,Mt]=(0,s.useState)({component:null,props:{}}),qt=(0,s.useMemo)(()=>{function rn(Rn,jn){Mt({component:Rn,props:jn})}function tn(){Mt({component:null,props:{}})}return{component:bt.component,props:{...bt.props,isOpen:!0,onDismiss:tn},showModal:rn,hideModal:tn}},[bt]);return(0,s.useEffect)(()=>{sn.A.subscribe(As.S8,({payload:tn})=>{Mt({component:tn.component,props:tn.props})}),sn.A.subscribe(As.bY,tn=>{Hs(tn,Mt)});let rn="";l.Ny.getHistory().listen(tn=>{tn.pathname!==rn&&Mt({component:null,props:{}}),rn=tn.pathname})},[]),(0,t.jsx)(Me.wE.Provider,{value:qt,children:st.children})}function Hs({payload:st},bt){const{confirmText:Mt,onConfirm:qt=()=>{},onDismiss:rn,text2:tn,altActionText:Rn,onAltAction:jn,noText:Wn,text:bs,text2htmlBind:as,yesText:vs="Yes",icon:Ts,title:is="Confirm",yesButtonVariant:Ds}=st,fs=()=>bt({component:null,props:{}}),ks={confirmText:vs,confirmButtonVariant:Ds,confirmationText:Mt,icon:Ts,title:is,body:bs,description:tn&&as?kt.sQ.sanitize(tn):tn,isOpen:!0,dismissText:Wn,onConfirm:()=>{qt(),fs()},onDismiss:()=>{rn?.(),fs()},onAlternative:jn?()=>{jn(),fs()}:void 0,alternativeText:Rn};bt({component:ws.u,props:ks})}var va=e(96615);function Qs(st){return(0,t.jsx)(r.Ix,{history:l.Ny.getHistory(),children:(0,t.jsx)(l._K,{service:l.Ny,children:(0,t.jsx)(g.CompatRouter,{children:(0,t.jsxs)($s,{children:[(0,t.jsxs)(na,{children:[(0,t.jsx)(Ae,{}),(0,t.jsx)(Un,{}),(0,t.jsxs)(Ve.B,{gap:0,grow:1,direction:"column",children:[st.pageBanners.map((bt,Mt)=>(0,t.jsx)(bt,{},Mt.toString())),st.routes]}),st.bodyRenderHooks.map((bt,Mt)=>(0,t.jsx)(bt,{},Mt.toString()))]}),(0,t.jsx)(Me.EO,{})]})})})})}function Ps(st){const{activePluginId:bt,closeApp:Mt}=(0,I.f)();let{containerProps:qt,primaryProps:rn,secondaryProps:tn,splitterProps:Rn}=(0,Ce.h)({direction:"row",initialSize:.6,dragPosition:"end"});function jn(as){return{...as,style:{...as.style,overflow:"auto",minWidth:"unset",minHeight:"unset"}}}rn=jn(rn),tn=jn(tn);const Wn=(0,W.of)(Vs,Sn.l*2),bs=new l.K9(ye.sC({initialEntries:["/"]}));return(0,t.jsxs)("div",{...bt?qt:{className:Wn.dummyWrapper},children:[(0,t.jsx)("div",{...bt?rn:{className:Wn.dummyWrapper},children:(0,t.jsx)(Qs,{...st})}),bt&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{...Rn}),(0,t.jsx)("div",{...tn,children:(0,t.jsx)(r.Ix,{history:bs.getHistory(),children:(0,t.jsx)(l._K,{service:bs,children:(0,t.jsxs)(g.CompatRouter,{children:[(0,t.jsx)(o.k,{}),(0,t.jsxs)("div",{className:Wn.secondAppWrapper,children:[(0,t.jsx)("div",{className:Wn.secondAppToolbar,children:(0,t.jsx)(Ue.K,{size:"lg",style:{margin:"8px"},name:"times","aria-label":"close",onClick:()=>Mt(bt)})}),(0,t.jsx)(va.Ay,{pluginId:bt})]})]})})})})]})]})}const Vs=(st,bt)=>({secondAppWrapper:(0,j.css)({label:"secondAppWrapper",display:"flex",height:"100%",paddingTop:bt||0,flexGrow:1,flexDirection:"column"}),secondAppToolbar:(0,j.css)({label:"secondAppToolbar",display:"flex",justifyContent:"flex-end"}),dummyWrapper:(0,j.css)({label:"dummyWrapper",display:"flex",height:"100vh",flexDirection:"column"})});let Js=[],Ca=[];function Fa(st){Js.push(st)}function nr(st){Ca.push(st)}class ca extends s.Component{constructor(bt){super(bt),this.renderRoute=Mt=>{const qt=Mt.roles?Mt.roles():[];return(0,t.jsx)(g.CompatRoute,{exact:Mt.exact===void 0?!0:Mt.exact,sensitive:Mt.sensitive===void 0?!1:Mt.sensitive,path:Mt.path,render:rn=>{const tn=l.Ny.getLocation();return qt?.length&&!qt.some(Rn=>de.TP.hasRole(Rn))?(0,t.jsx)(i.C5,{replace:!0,to:"/"}):(0,t.jsx)(se,{...rn,route:Mt,location:tn})}},Mt.path)},this.state={}}async componentDidMount(){await O(),this.setState({ready:!0}),$(".preloader").remove()}renderRoutes(){return(0,t.jsx)(r.dO,{children:(0,u.kz)().map(bt=>this.renderRoute(bt))})}render(){const{app:bt}=this.props,{ready:Mt}=this.state;(0,l.Lc)("AppWrapper",!1,"rendering");const qt=tn=>{(0,d.rR)("command_palette_action_selected",{actionId:tn.id,actionName:tn.name})},rn={routes:Mt&&this.renderRoutes(),pageBanners:Ca,bodyRenderHooks:Js};return(0,t.jsx)(a.Provider,{store:p.M_,children:(0,t.jsx)(h.Xw,{style:"page",children:(0,t.jsx)(M.YE.Provider,{value:bt.context,children:(0,t.jsx)(oe.N,{value:c.$.theme2,children:(0,t.jsxs)(n.KBarProvider,{actions:[],options:{enableHistory:!0,callbacks:{onSelectAction:qt}},children:[(0,t.jsx)(o.k,{}),(0,t.jsx)(I.j.Provider,{value:re.L,children:(0,t.jsx)(Se.AZ,{registries:bt.pluginExtensionsRegistries,children:(0,t.jsxs)("div",{className:"grafana-app",children:[c.$.featureToggles.appSidecar?(0,t.jsx)(Ps,{...rn}):(0,t.jsx)(Qs,{...rn}),(0,t.jsx)(fe,{}),(0,t.jsx)(m.qB,{})]})})})]})})})})})}}},91950:(G,R,e)=>{"use strict";e.d(R,{A:()=>s,f:()=>r});var t=e(2543),n=e.n(t);class s{constructor(i){if(this.columns=[],this.columnMap={},this.rows=[],this.type="table",i){if(i.columns)for(const l of i.columns)this.addColumn(l);if(i.rows)for(const l of i.rows)this.addRow(l)}}sort(i){i.col===null||i.col===void 0||this.columns.length<=i.col||(this.rows.sort((l,d)=>(l=l[i.col],d=d[i.col],+(l==null)-+(d==null)||+(l>d)||-(l<d))),i.desc&&this.rows.reverse(),this.columns[i.col].sort=!0,this.columns[i.col].desc=i.desc)}addColumn(i){this.columnMap[i.text]||(this.columns.push(i),this.columnMap[i.text]=i)}addRow(i){this.rows.push(i)}}function a(g,i,l){let d=!1;for(let c=0;c<g.length;c++)if(i[c]!==void 0&&l[c]!==void 0){if(i[c]!==l[c])return!1}else(i[c]===void 0||l[c]===void 0)&&(d=!0);return d}function r(g,...i){const l=g||new s;if(arguments.length===1)return l;if(arguments.length===2)return l.columns=i[0].hasOwnProperty("columns")?[...i[0].columns]:[],l.rows=i[0].hasOwnProperty("rows")?[...i[0].rows]:[],l;const d=i.filter(f=>!!f.columns),c={},h=d.slice().reduce((f,y)=>(y.columns.forEach(x=>{const{text:v}=x;c[v]===void 0&&(c[v]=f.length,f.push(x))}),f),[]),o=d.map(f=>f.columns.map(y=>c[y.text])),m=d.reduce((f,y,x)=>{const v=o[x];return y.rows.forEach(P=>{const E=[];v.forEach((D,C)=>{E[D]=P[C]}),f.push(E)}),f},[]),u={},p=m.reduce((f,y,x)=>{if(!u[x]){let v=x+1;for(;v<m.length;){const P=(0,t.findIndex)(m,E=>a(h,y,E),v);if(P>-1){const E=m[P];for(let D=0;D<h.length;D++)y[D]===void 0&&E[D]!==void 0&&(y[D]=E[D]);u[P]=E,v=P+1}else break}f.push(y)}return f},[]);return l.columns=h,l.rows=p,l}},97007:(G,R,e)=>{"use strict";e.d(R,{N:()=>n});var t=e(65307);const n=(0,t.VP)("core/cleanUpState")},82467:(G,R,e)=>{"use strict";e.d(R,{Do:()=>t.Do,Vz:()=>n.Vz,YA:()=>n.YA,dx:()=>t.dx});var t=e(16001),n=e(28215)},74868:(G,R,e)=>{"use strict";e.d(R,{x:()=>W});var t=e(74848),n=e(32196),s=e(2543),a=e(96540),r=e(40845),g=e(68402),i=e(90613),l=e(94753),d=e(55852),c=e(9025),h=e(8484),o=e(27677),m=e(43907),u=e(67061),p=e(90182),f=e(25469),y=e(17172);class x extends a.Component{constructor(X){super(X),this.state={isLoading:!1},this.search=this.search.bind(this),this.debouncedSearch=(0,s.debounce)(this.search,300,{leading:!0,trailing:!0})}search(X){return this.setState({isLoading:!0}),(0,s.isNil)(X)&&(X=""),(0,y.AI)().get("/api/serviceaccounts/search").then(ee=>ee.serviceAccounts.map(Z=>({id:Z.id,value:Z.id,label:Z.login,imgUrl:Z.avatarUrl,login:Z.login}))).finally(()=>{this.setState({isLoading:!1})})}render(){const{className:X,onSelected:ee,inputId:Z}=this.props,{isLoading:q}=this.state;return(0,t.jsx)("div",{className:"service-account-picker","data-testid":"serviceAccountPicker",children:(0,t.jsx)(p.DW,{isClearable:!0,className:X,inputId:Z,isLoading:q,defaultOptions:!0,loadOptions:this.debouncedSearch,onChange:ee,placeholder:"Start typing to search for service accounts",noOptionsMessage:"No service accounts found","aria-label":"Service Account picker"})})}}var v=e(98742);class P extends a.Component{constructor(X){super(X),this.state={isLoading:!1},this.search=this.search.bind(this),this.debouncedSearch=(0,s.debounce)(this.search,300,{leading:!0,trailing:!0})}search(X){return this.setState({isLoading:!0}),(0,s.isNil)(X)&&(X=""),(0,y.AI)().get(`/api/org/users/lookup?query=${X}&limit=100`).then(ee=>ee.map(Z=>({id:Z.userId,value:Z.userId,label:Z.login,imgUrl:Z.avatarUrl,login:Z.login}))).finally(()=>{this.setState({isLoading:!1})})}render(){const{className:X,onSelected:ee,inputId:Z}=this.props,{isLoading:q}=this.state;return(0,t.jsx)("div",{className:"user-picker","data-testid":"userPicker",children:(0,t.jsx)(p.DW,{isClearable:!0,className:X,inputId:Z,isLoading:q,defaultOptions:!0,loadOptions:this.debouncedSearch,onChange:ee,placeholder:"Start typing to search for user",noOptionsMessage:"No users found","aria-label":"User picker"})})}}var E=e(24897),D=(Q=>(Q.None="None",Q.Team="Team",Q.User="User",Q.ServiceAccount="ServiceAccount",Q.BuiltInRole="builtInRole",Q))(D||{});const C=({title:Q=(0,h.t)("access-control.add-permission.title","Add permission for"),permissions:X,assignments:ee,onAdd:Z,onCancel:q})=>{const[ae,k]=(0,a.useState)(D.None),[se,te]=(0,a.useState)(0),[ne,le]=(0,a.useState)(0),[re,de]=(0,a.useState)(""),[oe,J]=(0,a.useState)(""),ce=(0,a.useMemo)(()=>{const xe=[];return ee.users&&xe.push({value:D.User,label:(0,h.t)("access-control.add-permission.user-label","User")}),ee.serviceAccounts&&xe.push({value:D.ServiceAccount,label:(0,h.t)("access-control.add-permission.serviceaccount-label","Service Account")}),ee.teams&&xe.push({value:D.Team,label:(0,h.t)("access-control.add-permission.team-label","Team")}),ee.builtInRoles&&xe.push({value:D.BuiltInRole,label:(0,h.t)("access-control.add-permission.role-label","Role")}),xe},[ee]);(0,a.useEffect)(()=>{X.length>0&&J(X[0])},[X]);const pe=()=>ae===D.Team&&se>0||ae===D.User&&ne>0||ae===D.ServiceAccount&&ne>0||D.BuiltInRole&&E.XT.hasOwnProperty(re);return(0,t.jsxs)("div",{className:"cta-form","aria-label":"Permissions slider",children:[(0,t.jsx)(f.J,{onClick:q}),(0,t.jsx)("h5",{children:Q}),(0,t.jsx)("form",{name:"addPermission",onSubmit:xe=>{xe.preventDefault(),Z({userId:ne,teamId:se,builtInRole:re,permission:oe,target:ae})},children:(0,t.jsxs)(u.B,{gap:1,direction:"row",children:[(0,t.jsx)(p.l6,{"aria-label":"Role to add new permission to",value:ae,options:ce,onChange:xe=>k(xe.value),disabled:ce.length===0,width:"auto"}),ae===D.User&&(0,t.jsx)(P,{onSelected:xe=>le(xe?.value||0)}),ae===D.ServiceAccount&&(0,t.jsx)(x,{onSelected:xe=>le(xe?.value||0)}),ae===D.Team&&(0,t.jsx)(v.e,{onSelected:xe=>te(xe.value?.id||0)}),ae===D.BuiltInRole&&(0,t.jsx)(p.l6,{"aria-label":"Built-in role picker",options:Object.values(E.XT).filter(xe=>xe!==E.XT.None).map(xe=>({value:xe,label:xe})),onChange:xe=>de(xe.value||""),width:"auto"}),(0,t.jsx)(p.l6,{"aria-label":"Permission Level",width:"auto",value:X.find(xe=>xe===oe),options:X.map(xe=>({label:xe,value:xe})),onChange:xe=>J(xe.value||"")}),(0,t.jsx)(d.$n,{type:"submit",disabled:!pe(),children:(0,t.jsx)(h.x6,{i18nKey:"access-control.add-permissions.save",children:"Save"})})]})})]})};var b=e(56034),T=e(14578);const S=({item:Q,permissionLevels:X,canSet:ee,onRemove:Z,onChange:q})=>{const ae=(0,r.of)(B);return(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:O(Q)}),(0,t.jsx)("td",{children:I(Q)}),(0,t.jsx)("td",{children:Q.isInherited&&(0,t.jsx)("em",{className:ae.inherited,children:"Inherited from folder"})}),(0,t.jsx)("td",{children:(0,t.jsx)(p.l6,{disabled:!ee||!Q.isManaged,onChange:k=>q(Q,k.value),value:X.find(k=>k===Q.permission),options:X.map(k=>({value:k,label:k}))})}),(0,t.jsx)("td",{children:Q.warning?(0,t.jsx)(b.m,{content:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.a,{marginBottom:1,children:Q.warning}),L(Q)]}),children:(0,t.jsx)(T.I,{name:"exclamation-triangle",className:ae.warning})}):(0,t.jsx)(b.m,{content:L(Q),children:(0,t.jsx)(T.I,{name:"info-circle"})})}),(0,t.jsx)("td",{children:Q.isManaged?(0,t.jsx)(d.$n,{size:"sm",icon:"times",variant:"destructive",disabled:!ee,onClick:()=>Z(Q),"aria-label":`Remove permission for ${M(Q)}`}):(0,t.jsx)(b.m,{content:Q.isInherited?"Inherited Permission":"Provisioned Permission",children:(0,t.jsx)(d.$n,{size:"sm",icon:"lock","aria-label":"Locked permission indicator"})})})]})},O=Q=>Q.teamId?(0,t.jsx)("img",{className:"filter-table__avatar",src:Q.teamAvatarUrl,alt:`Avatar for team ${Q.teamId}`}):Q.userId?(0,t.jsx)("img",{className:"filter-table__avatar",src:Q.userAvatarUrl,alt:`Avatar for user ${Q.userId}`}):(0,t.jsx)(T.I,{size:"xl",name:"shield"}),M=Q=>Q.userId?Q.userLogin:Q.teamId?Q.team:Q.builtInRole,I=Q=>Q.userId?(0,t.jsxs)("span",{children:[Q.userLogin," "]},"name"):Q.teamId?(0,t.jsxs)("span",{children:[Q.team," "]},"name"):Q.builtInRole?(0,t.jsxs)("span",{children:[Q.builtInRole," "]},"name"):(0,t.jsx)("span",{},"name"),L=Q=>`Actions: ${[...new Set(Q.actions)].sort().join(" ")}`,B=Q=>({warning:(0,n.css)({color:Q.colors.warning.main}),inherited:(0,n.css)({color:Q.colors.text.secondary,flexWrap:"nowrap"})}),j=({title:Q,items:X,compareKey:ee,permissionLevels:Z,canSet:q,onRemove:ae,onChange:k})=>{const se=(0,a.useMemo)(()=>{const te={};for(let ne of X){const le=ne[ee];if(!te[le]){te[le]=ne;continue}if(ne.actions.length>te[le].actions.length){te[le]=ne;continue}ne.actions.length===te[le].actions.length&&!ne.isInherited&&(te[le]=ne)}return Object.keys(te).map(ne=>te[ne])},[X,ee]);return se.length===0?null:(0,t.jsx)("div",{children:(0,t.jsxs)("table",{className:"filter-table gf-form-group",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{style:{width:"1%"}}),(0,t.jsx)("th",{children:Q}),(0,t.jsx)("th",{style:{width:"1%"}}),(0,t.jsx)("th",{style:{width:"40%"},children:(0,t.jsx)(h.x6,{i18nKey:"access-control.permission-list.permission",children:"Permission"})}),(0,t.jsx)("th",{style:{width:"1%"}}),(0,t.jsx)("th",{style:{width:"1%"}})]})}),(0,t.jsx)("tbody",{children:se.map((te,ne)=>(0,t.jsx)(S,{item:te,onRemove:ae,onChange:k,canSet:q,permissionLevels:Z},`${ne}-${te.userId}`))})]})})},A="",K={permissions:[],assignments:{teams:!1,users:!1,serviceAccounts:!1,builtInRoles:!1}},W=({title:Q=(0,h.t)("access-control.permissions.title","Permissions"),buttonLabel:X=(0,h.t)("access-control.permissions.add-label","Add a permission"),emptyLabel:ee=(0,h.t)("access-control.permissions.no-permissions","There are no permissions"),resource:Z,resourceId:q,canSetPermissions:ae,addPermissionTitle:k,getWarnings:se,epilogue:te})=>{const ne=(0,r.of)(H),[le,re]=(0,a.useState)(!1),[de,oe]=(0,a.useState)([]),[J,ce]=(0,a.useState)(K),pe=(0,a.useCallback)(async()=>{let We=await F(Z,q);se&&(We=se(We)),oe(We)},[Z,q,se]);(0,a.useEffect)(()=>{U(Z).then(We=>(ce(We),pe()))},[Z,q,pe]);const xe=We=>{let _e=null;We.target===D.User||We.target===D.ServiceAccount?_e=V(Z,q,We.userId,We.permission):We.target===D.Team?_e=w(Z,q,We.teamId,We.permission):We.target===D.BuiltInRole&&(_e=z(Z,q,We.builtInRole,We.permission)),_e!==null&&_e.then(pe)},fe=We=>{let _e=null;We.userId?_e=V(Z,q,We.userId,A):We.teamId?_e=w(Z,q,We.teamId,A):We.isServiceAccount&&We.userId?_e=V(Z,q,We.userId,A):We.builtInRole&&(_e=z(Z,q,We.builtInRole,A)),_e!==null&&_e.then(pe)},Ee=(We,_e)=>{We.permission!==_e&&(We.userId?xe({permission:_e,userId:We.userId,target:D.User}):We.isServiceAccount?xe({permission:_e,userId:We.userId,target:D.User}):We.teamId?xe({permission:_e,teamId:We.teamId,target:D.Team}):We.builtInRole&&xe({permission:_e,builtInRole:We.builtInRole,target:D.BuiltInRole}))},Se=(0,a.useMemo)(()=>(0,s.sortBy)(de.filter(We=>We.teamId),["team","isManaged"]),[de]),ye=(0,a.useMemo)(()=>(0,s.sortBy)(de.filter(We=>We.userId&&!We.isServiceAccount),["userLogin","isManaged"]),[de]),Ve=(0,a.useMemo)(()=>(0,s.sortBy)(de.filter(We=>We.userId&&We.isServiceAccount),["userLogin","isManaged"]),[de]),Me=(0,a.useMemo)(()=>(0,s.sortBy)(de.filter(We=>We.builtInRole),["builtInRole","isManaged"]),[de]),Ce=(0,h.t)("access-control.permissions.role","Role"),Ue=(0,h.t)("access-control.permissions.user","User"),Ae=(0,h.t)("access-control.permissions.serviceaccount","Service Account"),we=(0,h.t)("access-control.permissions.team","Team");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[ae&&Z==="folders"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.x6,{i18nKey:"access-control.permissions.permissions-change-warning",children:"This will change permissions for this folder and all its descendants. In total, this will affect:"}),(0,t.jsx)(m.x,{selectedItems:{folder:{[q]:!0},dashboard:{},panel:{},$all:!1}}),(0,t.jsx)(g.$,{v:2})]}),de.length===0&&(0,t.jsx)(i.a,{children:(0,t.jsx)(l.E,{children:ee})}),(0,t.jsx)(j,{title:Ce,items:Me,compareKey:"builtInRole",permissionLevels:J.permissions,onChange:Ee,onRemove:fe,canSet:ae}),(0,t.jsx)(j,{title:Ue,items:ye,compareKey:"userLogin",permissionLevels:J.permissions,onChange:Ee,onRemove:fe,canSet:ae}),(0,t.jsx)(j,{title:Ae,items:Ve,compareKey:"userLogin",permissionLevels:J.permissions,onChange:Ee,onRemove:fe,canSet:ae}),(0,t.jsx)(j,{title:we,items:Se,compareKey:"team",permissionLevels:J.permissions,onChange:Ee,onRemove:fe,canSet:ae}),ae&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.$n,{className:ne.addPermissionButton,variant:"primary",onClick:()=>re(!0),icon:"plus",children:X},"add-permission"),(0,t.jsx)(c.a,{in:le,children:(0,t.jsx)(C,{title:k,onAdd:xe,permissions:J.permissions,assignments:J.assignments,onCancel:()=>re(!1)})})]})]}),te&&te(de)]})},U=async Q=>{try{return await(0,o.AI)().get(`/api/access-control/${Q}/description`)}catch(X){return console.error("failed to load resource description: ",X),K}},F=(Q,X)=>(0,o.AI)().get(`/api/access-control/${Q}/${X}`),V=(Q,X,ee,Z)=>N(Q,X,"users",ee,Z),w=(Q,X,ee,Z)=>N(Q,X,"teams",ee,Z),z=(Q,X,ee,Z)=>N(Q,X,"builtInRoles",ee,Z),N=(Q,X,ee,Z,q)=>(0,o.AI)().post(`/api/access-control/${Q}/${X}/${ee}/${Z}`,{permission:q}),H=Q=>({breakdown:(0,n.css)({...Q.typography.bodySmall,color:Q.colors.text.secondary,marginBottom:Q.spacing(2)}),addPermissionButton:(0,n.css)({marginBottom:Q.spacing(2)})})},9025:(G,R,e)=>{"use strict";e.d(R,{a:()=>i});var t=e(74848),n=e(96540),s=e(22669);const a="200px",r=200,g={transition:`max-height ${r}ms ease-in-out`,overflow:"hidden"},i=({children:l,in:d,maxHeight:c=a,style:h=g})=>{const o=(0,n.useRef)(null),m={exited:{maxHeight:0},entering:{maxHeight:c},entered:{maxHeight:"unset",overflow:"visible"},exiting:{maxHeight:0}};return(0,t.jsx)(s.Ay,{in:d,timeout:r,nodeRef:o,children:u=>(0,t.jsx)("div",{style:{...h,...m[u]},ref:o,children:l})})}},70944:(G,R,e)=>{"use strict";e.d(R,{dk:()=>p,hE:()=>m,k0:()=>u});var t=e(24120),n=e(49426),s=e(64388),a=e(26272),r=e(32264),g=e(14110),i=e(39601),l=e(28138),d=e(8484),c=e(33390);function h(y,x){if(y===x)return!0;if(!(y instanceof Object)||!(x instanceof Object))return!1;const v=Object.keys(y),P=v.length;for(let E=0;E<P;E++)if(!(v[E]in x))return!1;for(let E=0;E<P;E++)if(y[v[E]]!==x[v[E]])return!1;return P===Object.keys(x).length}var o=e(31678);const m="grafana.navigation.docked",u="grafana.navigation.open";class p{constructor(){this.searchBarStorageKey="SearchBar_Hidden",this.routeChangeHandled=!0,this.megaMenuDocked=!!(window.innerWidth>=r.$.theme2.breakpoints.values.xl&&c.A.getBool(m,window.innerWidth>=r.$.theme2.breakpoints.values.xxl)),this.sessionStorageData=window.sessionStorage.getItem("returnToPrevious"),this.returnToPreviousData=this.sessionStorageData?JSON.parse(this.sessionStorageData):void 0,this.state=new n.t({chromeless:!0,sectionNav:{node:{text:(0,d.t)("nav.home.title","Home")},main:{text:""}},searchBarHidden:c.A.getBool(this.searchBarStorageKey,!1),megaMenuOpen:this.megaMenuDocked&&c.A.getBool(u,!0),megaMenuDocked:this.megaMenuDocked,kioskMode:null,layout:s.k.Canvas,returnToPrevious:this.returnToPreviousData}),this.setReturnToPrevious=x=>{const v=this.state.getValue().returnToPrevious;(0,g.rR)("grafana_return_to_previous_button_created",{page:x.href,previousPage:v?.href}),this.update({returnToPrevious:x}),window.sessionStorage.setItem("returnToPrevious",JSON.stringify(x))},this.clearReturnToPrevious=x=>{const v=this.state.getValue().returnToPrevious;v&&(0,g.rR)("grafana_return_to_previous_button_dismissed",{action:x,page:v.href}),this.update({returnToPrevious:void 0}),window.sessionStorage.removeItem("returnToPrevious")},this.setMegaMenuOpen=x=>{const{megaMenuDocked:v}=this.state.getValue();v&&c.A.set(u,x),(0,g.rR)("grafana_mega_menu_open",{state:x}),this.update({megaMenuOpen:x})},this.setMegaMenuDocked=(x,v=!0)=>{v&&c.A.set(m,x),(0,g.rR)("grafana_mega_menu_docked",{state:x}),this.update({megaMenuDocked:x})},this.onToggleSearchBar=()=>{const{searchBarHidden:x,kioskMode:v}=this.state.getValue(),P=!x;c.A.set(this.searchBarStorageKey,P),v&&i.Ny.partial({kiosk:null}),this.update({searchBarHidden:P,kioskMode:null})},this.onToggleKioskMode=()=>{const x=this.getNextKioskMode();this.update({kioskMode:x}),i.Ny.partial({kiosk:this.getKioskUrlValue(x)})}}setMatchedRoute(x){this.currentRoute!==x&&(this.currentRoute=x,this.routeChangeHandled=!1)}update(x){const v=this.state.getValue(),P={...v};this.routeChangeHandled||(P.actions=void 0,P.pageNav=void 0,P.sectionNav={node:{text:(0,d.t)("nav.home.title","Home")},main:{text:""}},P.chromeless=this.currentRoute?.chromeless,P.layout=s.k.Standard,this.routeChangeHandled=!0),Object.assign(P,x),P.chromeless=P.kioskMode===o.KioskMode.Full||this.currentRoute?.chromeless,this.ignoreStateUpdate(P,v)||this.state.next(P)}ignoreStateUpdate(x,v){return!!(h(x,v)||(x.sectionNav!==v.sectionNav||x.pageNav!==v.pageNav)&&x.actions===v.actions&&x.layout===v.layout&&f(x.sectionNav.node,v.sectionNav.node)&&f(x.pageNav,v.pageNav))}useState(){return(0,t.A)(this.state,this.state.getValue())}exitKioskMode(){this.update({kioskMode:void 0}),i.Ny.partial({kiosk:null})}setKioskModeFromUrl(x){let v;switch(x){case"tv":v=o.KioskMode.TV;break;case"1":case!0:v=o.KioskMode.Full}v&&v!==this.state.getValue().kioskMode&&this.update({kioskMode:v})}getKioskUrlValue(x){switch(x){case o.KioskMode.TV:return"tv";case o.KioskMode.Full:return!0;default:return null}}getNextKioskMode(){const{kioskMode:x,searchBarHidden:v}=this.state.getValue();return v||x===o.KioskMode.TV||r.$.featureToggles.singleTopNav?(l.A.emit(a.r1.alertInfo,[(0,d.t)("navigation.kiosk.tv-alert","Press ESC to exit kiosk mode")]),o.KioskMode.Full):x?null:o.KioskMode.TV}}function f(y,x){if(y===x)return!0;const v=y?.children?.find(E=>E.active),P=x?.children?.find(E=>E.active);return y?.text===x?.text&&y?.url===x?.url&&v?.url===P?.url&&f(y?.parentItem,x?.parentItem)}},75269:(G,R,e)=>{"use strict";e.d(R,{H:()=>s});var t=e(96540),n=e(76888);const s=t.memo(({actions:a})=>{const{chrome:r}=(0,n.Il)();return(0,t.useLayoutEffect)(()=>{r.update({actions:a})}),null});s.displayName="TopNavUpdate"},32209:(G,R,e)=>{"use strict";e.d(R,{J:()=>z,A:()=>N});var t=e(74848),n=e(32196),s=e(96540),a=e(54148),r=e(13544),g=e(32264),i=e(14110),l=e(40845),d=e(14578),c=e(29158),h=e(40276),o=e(67061),m=e(76888),u=e(8484),p=e(91219),f=e(8856),y=e(31678),x=e(27746),v=e(19361),P=e(13884),E=e(57571);function D({handleMegaMenu:Q,handleDockedMenu:X,onClose:ee}){const Z=(0,l.$j)(),{chrome:q}=(0,m.Il)(),ae=q.useState(),k=C(Z);return(0,t.jsxs)("div",{className:k.header,children:[(0,t.jsxs)(o.B,{alignItems:"center",minWidth:0,gap:.25,children:[(0,t.jsx)(x.I,{narrow:!0,onClick:Q,tooltip:(0,u.t)("navigation.megamenu.close","Close menu"),children:(0,t.jsx)(v.M.MenuLogo,{className:k.img})}),(0,t.jsx)(P.N,{})]}),(0,t.jsx)(c.K,{id:"dock-menu-button",className:k.dockMenuButton,tooltip:ae.megaMenuDocked?(0,u.t)("navigation.megamenu.undock","Undock menu"):(0,u.t)("navigation.megamenu.dock","Dock menu"),name:"web-section-alt",onClick:X,variant:"secondary"}),(0,t.jsx)(c.K,{className:k.mobileCloseButton,tooltip:(0,u.t)("navigation.megamenu.close","Close menu"),name:"times",onClick:ee,size:"xl",variant:"secondary"})]})}D.displayName="MegaMenuHeader";const C=Q=>({dockMenuButton:(0,n.css)({display:"none",[Q.breakpoints.up("xl")]:{display:"inline-flex"}}),header:(0,n.css)({alignItems:"center",borderBottom:`1px solid ${Q.colors.border.weak}`,display:"flex",gap:Q.spacing(1),justifyContent:"space-between",padding:Q.spacing(0,1,0,.75),height:E.l,minHeight:E.l}),img:(0,n.css)({alignSelf:"center",height:Q.spacing(3),width:Q.spacing(3)}),mobileCloseButton:(0,n.css)({[Q.breakpoints.up("md")]:{display:"none"}})});var b=e(78685),T=e(8887),S=e(94753),O=e(18759);const M=({children:Q})=>{const X=(0,l.of)(I);return(0,t.jsxs)(t.Fragment,{children:[Q,(0,t.jsx)("span",{className:X.highlight})]})},I=Q=>({highlight:(0,n.css)({backgroundColor:Q.colors.success.main,borderRadius:Q.shape.radius.circle,width:"6px",height:"6px",display:"inline-block;",position:"absolute",top:"50%",transform:"translateY(-50%)"})});var L=e(50720);function B({children:Q,isActive:X,onClick:ee,target:Z,url:q,onPin:ae,isPinned:k}){const se=(0,l.$j)(),te=j(se,X),ne=!Z&&q.startsWith("/")?L.N:"a",le=(0,t.jsxs)("div",{className:te.linkContent,children:[Q,Z==="_blank"&&(0,t.jsx)(d.I,{"data-testid":"external-link-icon",name:"external-link-alt"})]});return(0,t.jsxs)("div",{className:(0,n.cx)(te.wrapper,{[te.wrapperActive]:X,[te.wrapperBookmark]:g.$.featureToggles.pinNavItems}),children:[(0,t.jsx)(ne,{"data-testid":r.Tp.components.NavMenu.item,className:te.container,href:q,target:Z,onClick:ee,...X&&{"aria-current":"page"},children:le}),g.$.featureToggles.pinNavItems&&q&&q!=="/bookmarks"&&(0,t.jsx)(c.K,{name:"bookmark",className:"pin-icon",iconType:k?"solid":"default",onClick:()=>ae(q),"aria-label":k?(0,u.t)("navigation.item.remove-bookmark","Remove from Bookmarks"):(0,u.t)("navigation.item.add-bookmark","Add to Bookmarks")})]})}B.displayName="MegaMenuItemText";const j=(Q,X)=>({wrapper:(0,n.css)({display:"flex",justifyContent:"space-between",width:"100%",height:"100%"}),wrapperBookmark:(0,n.css)({".pin-icon":{display:"none"},"&:hover, &:focus-within":{a:{width:"calc(100% - 20px)"},".pin-icon":{display:"inline-flex"}}}),wrapperActive:(0,n.css)({backgroundColor:Q.colors.background.secondary,borderTopRightRadius:Q.shape.radius.default,borderBottomRightRadius:Q.shape.radius.default,position:"relative","&::before":{backgroundImage:Q.colors.gradients.brandVertical,borderRadius:Q.shape.radius.default,content:'" "',display:"block",height:"100%",position:"absolute",transform:"translateX(-50%)",width:Q.spacing(.5)}}),container:(0,n.css)({alignItems:"center",color:X?Q.colors.text.primary:Q.colors.text.secondary,height:"100%",position:"relative",width:"100%","&:hover, &:focus-visible":{color:Q.colors.text.primary,textDecoration:"underline"},"&:focus-visible":{boxShadow:"none",outline:`2px solid ${Q.colors.primary.main}`,outlineOffset:"-2px",transition:"none"}}),linkContent:(0,n.css)({alignItems:"center",display:"flex",gap:"0.5rem",height:"100%",width:"100%",justifyContent:"space-between"})});var A=e(29795);const K=2;function W({link:Q,activeItem:X,level:ee=0,onClick:Z,onPin:q,isPinned:ae}){const{chrome:k}=(0,m.Il)(),te=k.useState().megaMenuDocked,ne=(0,a.zy)(),le=Q.highlightText?M:s.Fragment,re=(0,A.m0)(Q,X),de=Q===X||ee===K&&re,[oe,J]=(0,b.A)(`grafana.navigation.expanded[${Q.text}]`,!!re),ce=ee<K&&!!(F(Q)||Q.emptyMessage),pe=(0,s.useRef)(null),xe=g.$.featureToggles.singleTopNav,fe=(0,l.of)(U);if((0,s.useEffect)(()=>{re&&J(!0)},[re,ne,te,J]),(0,s.useEffect)(()=>{de&&pe.current&&V(pe.current)&&pe.current.scrollIntoView({block:"center"})},[de]),!Q.url)return null;let Ee=null;Q.icon?Ee=(0,t.jsx)(d.I,{className:fe.icon,name:(0,T.Uo)(Q.icon)??"link",size:"lg"}):Q.img&&(Ee=(0,t.jsx)(o.B,{width:3,justifyContent:"center",children:(0,t.jsx)("img",{className:fe.img,src:Q.img,alt:""})}));function Se(Ve){return xe?Ve?"angle-up":"angle-down":Ve?"angle-down":"angle-right"}const ye=(0,t.jsx)("div",{className:fe.collapseButtonWrapper,children:ce&&(0,t.jsx)(c.K,{"aria-label":`${oe?"Collapse":"Expand"} section ${Q.text}`,className:fe.collapseButton,onClick:()=>J(!oe),name:Se(!!oe),size:"md",variant:"secondary"})});return(0,t.jsxs)("li",{ref:pe,className:fe.listItem,children:[(0,t.jsxs)("div",{className:(0,n.cx)(fe.menuItem,{[fe.menuItemWithIcon]:!!(ee===0&&Ee)}),children:[ee!==0&&(0,t.jsx)(O.T,{level:ee===K?ee-1:ee,spacing:3}),ee===K&&(0,t.jsx)("div",{className:fe.itemConnector}),!xe&&ye,(0,t.jsx)("div",{className:fe.collapsibleSectionWrapper,children:(0,t.jsx)(B,{isActive:de,onClick:()=>{Q.onClick?.(),Z?.()},target:Q.target,url:Q.url,onPin:()=>q(Q),isPinned:ae(Q.url),children:(0,t.jsxs)("div",{className:(0,n.cx)(fe.labelWrapper,{[fe.hasActiveChild]:re,[fe.labelWrapperWithIcon]:!!(ee===0&&Ee)}),children:[ee===0&&Ee&&(0,t.jsx)(le,{children:Ee}),(0,t.jsx)(S.E,{truncate:!0,children:Q.text})]})})}),xe&&ye]}),ce&&oe&&(0,t.jsx)("ul",{className:fe.children,children:F(Q)?Q.children.filter(Ve=>!Ve.isCreateAction).map(Ve=>(0,t.jsx)(W,{link:Ve,activeItem:X,onClick:Z,level:ee+1,onPin:q,isPinned:ae},`${Q.text}-${Ve.text}`)):(0,t.jsx)("div",{className:fe.emptyMessage,"aria-live":"polite",children:Q.emptyMessage})})]})}const U=Q=>({icon:(0,n.css)({width:Q.spacing(3)}),img:(0,n.css)({height:Q.spacing(2),width:Q.spacing(2)}),listItem:(0,n.css)({flex:1,maxWidth:"100%"}),menuItem:(0,n.css)({display:"flex",alignItems:"center",gap:Q.spacing(1),height:Q.spacing(4),paddingLeft:Q.spacing(.5),position:"relative"}),menuItemWithIcon:(0,n.css)({paddingLeft:Q.spacing(0)}),collapseButtonWrapper:(0,n.css)({display:"flex",justifyContent:"center",width:Q.spacing(3),flexShrink:0}),itemConnector:(0,n.css)({position:"relative",height:"100%",width:Q.spacing(1.5),"&::before":{borderLeft:`1px solid ${Q.colors.border.medium}`,content:'""',height:"100%",right:0,position:"absolute",transform:"translateX(50%)"}}),collapseButton:(0,n.css)({margin:0}),collapsibleSectionWrapper:(0,n.css)({alignItems:"center",display:"flex",flex:1,height:"100%",minWidth:0}),labelWrapper:(0,n.css)({display:"flex",alignItems:"center",gap:Q.spacing(2),minWidth:0,paddingLeft:Q.spacing(1)}),labelWrapperWithIcon:(0,n.css)({paddingLeft:Q.spacing(.5)}),hasActiveChild:(0,n.css)({color:Q.colors.text.primary}),children:(0,n.css)({display:"flex",listStyleType:"none",flexDirection:"column"}),emptyMessage:(0,n.css)({color:Q.colors.text.secondary,fontStyle:"italic",padding:Q.spacing(1,1.5,1,7)})});function F(Q){return!!(Q.children&&Q.children.length>0)}function V(Q){const X=Q.getBoundingClientRect();return X.bottom<0||X.top>=window.innerHeight}var w=e(21286);const z="300px",N=(0,s.memo)((0,s.forwardRef)(({onClose:Q,...X},ee)=>{const Z=(0,y.useSelector)(xe=>xe.navBarTree),q=(0,l.of)(H),ae=(0,a.zy)(),{chrome:k}=(0,m.Il)(),se=(0,y.useDispatch)(),te=k.useState(),[ne]=(0,f.o)(),le=(0,w.s)(),re=Z.filter(xe=>xe.id!=="profile"&&xe.id!=="help").map(xe=>(0,A.J0)(xe,te.megaMenuDocked));if(g.$.featureToggles.pinNavItems){const xe=(0,A.Wk)(re,"/bookmarks");xe&&(xe.children=le.reduce((fe,Ee)=>{const Se=(0,A.Wk)(re,Ee);if(!Se)return fe;const ye={id:Se.id,text:Se.text,url:Se.url,parentItem:{id:"bookmarks",text:"Bookmarks"}};return fe.push((0,A.J0)(ye,te.megaMenuDocked)),fe},[]))}const de=(0,A.A6)(re,te.sectionNav.node,ae.pathname),oe=()=>{k.setMegaMenuOpen(!te.megaMenuOpen)},J=()=>{k.setMegaMenuDocked(!te.megaMenuDocked),te.megaMenuDocked&&k.setMegaMenuOpen(!1),setTimeout(()=>{document.getElementById(te.megaMenuDocked?"mega-menu-toggle":"dock-menu-button")?.focus()})},ce=(0,s.useCallback)(xe=>!xe||!le?.length?!1:le?.includes(xe),[le]),pe=xe=>{const fe=xe.url;if(fe&&g.$.featureToggles.pinNavItems){const Ee=ce(fe),Se=Ee?le.filter(Ve=>fe!==Ve):[...le,fe],ye=Ee?"grafana_nav_item_unpinned":"grafana_nav_item_pinned";(0,i.rR)(ye,{path:fe}),ne({patchPrefsCmd:{navbar:{bookmarkUrls:Se}}}).then(Ve=>{Ve.error||se((0,p.ve)({item:xe,isSaved:!Ee}))})}};return(0,t.jsxs)("div",{"data-testid":r.Tp.components.NavMenu.Menu,ref:ee,...X,children:[g.$.featureToggles.singleTopNav?(0,t.jsx)(D,{handleDockedMenu:J,handleMegaMenu:oe,onClose:Q}):(0,t.jsxs)("div",{className:q.mobileHeader,children:[(0,t.jsx)(d.I,{name:"bars",size:"xl"}),(0,t.jsx)(c.K,{tooltip:(0,u.t)("navigation.megamenu.close","Close menu"),name:"times",onClick:Q,size:"xl",variant:"secondary"})]}),(0,t.jsx)("nav",{className:q.content,children:(0,t.jsx)(h.E,{showScrollIndicators:!0,hideHorizontalTrack:!0,children:(0,t.jsx)("ul",{className:q.itemList,"aria-label":(0,u.t)("navigation.megamenu.list-label","Navigation"),children:re.map((xe,fe)=>(0,t.jsxs)(o.B,{direction:fe===0?"row-reverse":"row",alignItems:"start",children:[fe===0&&!g.$.featureToggles.singleTopNav&&(0,t.jsx)(c.K,{id:"dock-menu-button",className:q.dockMenuButton,tooltip:te.megaMenuDocked?(0,u.t)("navigation.megamenu.undock","Undock menu"):(0,u.t)("navigation.megamenu.dock","Dock menu"),name:"web-section-alt",onClick:J,variant:"secondary"}),(0,t.jsx)(W,{link:xe,isPinned:ce,onClick:te.megaMenuDocked?void 0:Q,activeItem:de,onPin:pe})]},xe.text))})})})]})}));N.displayName="MegaMenu";const H=Q=>({content:(0,n.css)({display:"flex",flexDirection:"column",height:"100%",minHeight:0,position:"relative"}),mobileHeader:(0,n.css)({display:"flex",justifyContent:"space-between",padding:Q.spacing(1,1,1,2),borderBottom:`1px solid ${Q.colors.border.weak}`,[Q.breakpoints.up("md")]:{display:"none"}}),itemList:(0,n.css)({boxSizing:"border-box",display:"flex",flexDirection:"column",listStyleType:"none",padding:Q.spacing(1,1,2,1),[Q.breakpoints.up("md")]:{width:z}}),dockMenuButton:(0,n.css)({display:"none",position:"relative",top:Q.spacing(1),[Q.breakpoints.up("xl")]:{display:"inline-flex"}})})},21286:(G,R,e)=>{"use strict";e.d(R,{s:()=>a});var t=e(96540),n=e(32264),s=e(8856);const a=()=>{const r=(0,s.Pj)(void 0,{skip:!n.$.bootData.user.isSignedIn}),g=(0,t.useMemo)(()=>r.data?.navbar?.bookmarkUrls||[],[r]);return n.$.featureToggles.pinNavItems?g:[]}},29795:(G,R,e)=>{"use strict";e.d(R,{A6:()=>o,CS:()=>d,J0:()=>c,Wk:()=>u,m0:()=>h});var t=e(14110),n=e(32264),s=e(8484),a=e(28215),r=e(28444),g=e(28138),i=e(38645),l=e(93522);const d=p=>{let f=p.children||[];if(p.id==="help"){const y=()=>{g.A.publish(new r.S8({component:l.N}))};p.children=[...f,...(0,i.Dd)(),...m(),{id:"keyboard-shortcuts",text:(0,s.t)("nav.help/keyboard-shortcuts","Keyboard shortcuts"),icon:"keyboard",onClick:y}]}return p},c=(p,f)=>{const y={...p},x=y.onClick;return y.onClick=()=>{(0,t.rR)("grafana_navigation_item_clicked",{path:y.url??y.id,menuIsDocked:f,itemIsBookmarked:!!(n.$.featureToggles.pinNavItems&&y?.parentItem?.id==="bookmarks"),bookmarkToggleOn:!!n.$.featureToggles.pinNavItems}),x?.()},y.children&&(y.children=y.children.map(v=>c(v,f))),y},h=(p,f)=>!!p.children?.some(y=>y===f?!0:h(y,f)),o=(p,f,y)=>{const{id:x,parentItem:v}=f;if(y==="/")return p.find(P=>P.id===a.Id);if(f.id!=="profile"){for(const P of p){const E=!!(P.id&&P.id===x),D=P.text===f.text&&P.url===f.url;if(E||D)return P;if(P.children){const C=o(P.children,f);if(C)return C}}if(v)return o(p,v)}};function m(){const{buildInfo:p,licenseInfo:f}=n.$,y=f.stateInfo?` (${f.stateInfo})`:"",x=[];return x.push({target:"_blank",id:"version",text:`${p.edition}${y}`,url:f.licenseUrl,icon:"external-link-alt"}),p.hasUpdate&&x.push({target:"_blank",id:"updateVersion",text:"New version available!",icon:"download-alt",url:"https://grafana.com/grafana/download?utm_source=grafana_footer"}),x}function u(p,f){for(const y of p){if(y.url===f)return y;if(y.children?.length){const x=u(y.children,f);if(x)return x}}return null}},10804:(G,R,e)=>{"use strict";e.d(R,{K:()=>a});var t=e(74848),n=e(32196),s=e(40845);function a({className:g,leftActionsSeparator:i}){const l=(0,s.of)(r);return i?(0,t.jsx)("div",{className:(0,n.cx)(g,l.leftActionsSeparator)}):(0,t.jsx)("div",{className:(0,n.cx)(g,l.line)})}const r=g=>({leftActionsSeparator:(0,n.css)({display:"flex",flexGrow:1}),line:(0,n.css)({width:1,backgroundColor:g.colors.border.medium,height:24})})},13884:(G,R,e)=>{"use strict";e.d(R,{N:()=>P});var t=e(74848),n=e(32196),s=e(96540),a=e(39601),r=e(32264),g=e(40845),i=e(94753),l=e(60619),d=e(16233),c=e(32931),h=e(31678),o=e(19361),m=e(51986);function u({orgs:D,onSelectChange:C}){const b=(0,g.of)(p);return(0,t.jsx)(m.i,{"aria-label":"Change organization",variant:"secondary",buttonCss:b.buttonCss,size:"md",label:"",fill:"text",isFullWidth:!1,options:D.map(T=>({label:T.name,description:T.role,value:T})),onChange:C,icon:"building"})}const p=D=>({buttonCss:(0,n.css)({color:D.colors.text.secondary,"&:hover":{color:D.colors.text.primary}})});var f=e(90182),y=e(14578);function x({orgs:D,onSelectChange:C}){const b=(0,g.of)(v),{orgName:T,orgId:S,orgRole:O}=d.TP.user,[M,I]=(0,s.useState)(()=>({label:T,value:{role:O,orgId:S,name:T},description:O})),L=B=>{I(B),C(B)};return(0,t.jsx)(f.l6,{"aria-label":"Change organization",width:"auto",value:M,prefix:(0,t.jsx)(y.I,{className:"prefix-icon",name:"building"}),className:b.select,options:D.map(B=>({label:B.name,description:B.role,value:B})),onChange:L})}const v=D=>({select:(0,n.css)({border:"none",background:"none",color:D.colors.text.secondary,"&:hover":{color:D.colors.text.primary,"& .prefix-icon":(0,n.css)({color:D.colors.text.primary})}})});function P(){const D=(0,g.$j)(),C=(0,h.useDispatch)(),b=(0,h.useSelector)(B=>B.organization.userOrgs),T=(0,g.of)(E),S=B=>{B.value&&((0,c.bA)(B.value.orgId),a.Ny.push(`/?orgId=${B.value.orgId}`),window.location.reload())};(0,s.useEffect)(()=>{d.TP.isSignedIn&&C((0,c.wV)())},[C]);const O=D.breakpoints.values.sm,[M,I]=(0,s.useState)(!r.$.featureToggles.singleTopNav&&!window.matchMedia(`(min-width: ${O}px)`).matches);if((0,l.Y)({breakpoint:O,onChange:B=>{I(!r.$.featureToggles.singleTopNav&&!B.matches)}}),b?.length<=1)return r.$.featureToggles.singleTopNav?(0,t.jsx)("span",{className:T.brandTitle,children:(0,t.jsx)(i.E,{truncate:!0,children:o.M.AppTitle})}):null;const L=M?u:x;return(0,t.jsx)(L,{orgs:b,onSelectChange:S})}const E=D=>({brandTitle:(0,n.css)({paddingLeft:D.spacing(1)})})},57571:(G,R,e)=>{"use strict";e.d(R,{l:()=>t});const t=40},19361:(G,R,e)=>{"use strict";e.d(R,{M:()=>d});var t=e(74848),n=e(32196),s=e(23596),a=e(40845);const r=({className:c,logo:h})=>(0,t.jsx)("img",{className:c,src:`${h||"public/img/grafana_icon.svg"}`,alt:"Grafana"}),g=({className:c,children:h})=>{const o=(0,a.$j)(),m=(0,n.css)({"&:before":{content:'""',position:"fixed",left:0,right:0,bottom:0,top:0,background:`url(public/img/g8_login_${o.isDark?"dark":"light"}.svg)`,backgroundPosition:"top center",backgroundSize:"auto",backgroundRepeat:"no-repeat",opacity:0,transition:"opacity 3s ease-in-out",[o.breakpoints.up("md")]:{backgroundPosition:"center",backgroundSize:"cover"}}});return(0,t.jsx)("div",{className:(0,n.cx)(m,c),children:h})},i=({className:c})=>(0,t.jsx)("img",{className:c,src:"public/img/grafana_icon.svg",alt:"Grafana"}),l=()=>{const c=(0,a.$j)();return(0,n.css)({background:s.MV.alpha(c.colors.background.primary,.7),backgroundSize:"cover"})};class d{static{this.LoginLogo=r}static{this.LoginBackground=g}static{this.MenuLogo=i}static{this.LoginBoxBackground=l}static{this.AppTitle="Grafana"}static{this.LoginTitle="Welcome to Grafana"}static{this.HideEdition=!1}static{this.GetLoginSubTitle=()=>null}}},3984:(G,R,e)=>{"use strict";e.d(R,{Z:()=>t});function t(n,s,a){const r=[];let g=!1,i;function l(d,c=!1){if(g)return;const h=d.url?.split("?")??["",""];let o=h[0];const m=new URLSearchParams(h[1]);if(m.has("editview")&&(o+=`?editview=${m.get("editview")}`),a&&o===a.url){r.unshift({text:a.text,href:d.url??""}),g=!0;return}const u=o.length>0&&i===o;if(i=o,!d.hideFromBreadcrumbs&&!(c&&u)){const f=d.children?.findIndex(y=>y.active)??-1;if(f>0){const y=d.children?.[f];y&&r.unshift({text:y.text,href:y.url??""})}r.unshift({text:d.text,href:d.url??""})}d.parentItem&&l(d.parentItem)}return s&&l(s),l(n,!0),r}},25469:(G,R,e)=>{"use strict";e.d(R,{J:()=>r});var t=e(74848),n=e(32196),s=e(40845),a=e(29158);const r=({onClick:i,"aria-label":l,style:d})=>{const c=(0,s.of)(g);return(0,t.jsx)(a.K,{"aria-label":l??"Close",className:c,name:"times",onClick:i,style:d,tooltip:"Close"})},g=i=>(0,n.css)({position:"absolute",right:i.spacing(.5),top:i.spacing(1)})},27921:(G,R,e)=>{"use strict";e.d(R,{A:()=>n});var t=e(96540);const n=s=>(0,t.lazy)(s)},38645:(G,R,e)=>{"use strict";e.d(R,{DH:()=>h,Dd:()=>l,wi:()=>o});var t=e(74848),n=e(32196),s=e(96540),a=e(32264),r=e(40845),g=e(14578),i=e(8484);let l=()=>[{target:"_blank",id:"documentation",text:(0,i.t)("nav.help/documentation","Documentation"),icon:"document-info",url:"https://grafana.com/docs/grafana/latest/?utm_source=grafana_footer"},{target:"_blank",id:"support",text:(0,i.t)("nav.help/support","Support"),icon:"question-circle",url:"https://grafana.com/products/enterprise/?utm_source=grafana_footer"},{target:"_blank",id:"community",text:(0,i.t)("nav.help/community","Community"),icon:"comments-alt",url:"https://community.grafana.com/?utm_source=grafana_footer"}];function d(p){return{hasReleaseNotes:!0,isBeta:p.includes("-beta")}}function c(p){const{buildInfo:f,licenseInfo:y}=a.$,x=[],v=y.stateInfo?` (${y.stateInfo})`:"";if(p||x.push({target:"_blank",id:"license",text:`${f.edition}${v}`,url:y.licenseUrl}),f.hideVersion)return x;const{hasReleaseNotes:P}=d(f.version);return x.push({target:"_blank",id:"version",text:f.versionString,url:P?"https://github.com/grafana/grafana/blob/main/CHANGELOG.md":void 0}),f.hasUpdate&&x.push({target:"_blank",id:"updateVersion",text:"New version available!",icon:"download-alt",url:"https://grafana.com/grafana/download?utm_source=grafana_footer"}),x}function h(p){l=p}const o=(0,s.memo)(({customLinks:p,hideEdition:f})=>{const y=(p||l()).concat(c(f)),x=(0,r.of)(u);return(0,t.jsx)("footer",{className:x.footer,children:(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)("ul",{className:x.list,children:y.map((v,P)=>(0,t.jsx)("li",{className:x.listItem,children:(0,t.jsx)(m,{item:v})},P))})})})});o.displayName="Footer";function m({item:p}){const f=p.url?(0,t.jsx)("a",{href:p.url,target:p.target,rel:"noopener noreferrer",id:p.id,children:p.text}):p.text;return(0,t.jsxs)(t.Fragment,{children:[p.icon&&(0,t.jsx)(g.I,{name:p.icon})," ",f]})}const u=p=>({footer:(0,n.css)({...p.typography.bodySmall,color:p.colors.text.primary,display:"block",padding:p.spacing(2,0),position:"relative",width:"98%","a:hover":{color:p.colors.text.maxContrast,textDecoration:"underline"},[p.breakpoints.down("md")]:{display:"none"}}),list:(0,n.css)({listStyle:"none"}),listItem:(0,n.css)({display:"inline-block","&:after":{content:"' | '",padding:p.spacing(0,1)},"&:last-child:after":{content:"''",paddingLeft:0}})})},35339:(G,R,e)=>{"use strict";e.d(R,{F:()=>l});var t=e(74848),n=e(32196),s=e(96540),a=e(24180),r=e(54148),g=e(37390),i=e(55852);const l=({confirmRedirect:c,onDiscard:h,onLocationChange:o})=>{const[m,u]=(0,s.useState)(!1),[p,f]=(0,s.useState)(null),[y,x]=(0,s.useState)(!1);(0,s.useEffect)(()=>{const D=C=>{c&&(C.preventDefault(),C.returnValue="")};return window.addEventListener("beforeunload",D),()=>{window.removeEventListener("beforeunload",D)}},[c]);const v=D=>{const C=window.location.pathname,b=D.pathname;if(C===b)return!0;const T=o?.(D);let S=c&&!y;return T!==void 0&&(S=S&&T),S?(u(!0),f(D),!1):(T&&h(),!0)},P=()=>{u(!1),f(null)},E=()=>{u(!1),x(!0),h()};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.XG,{when:!0,message:v}),p&&y&&(0,t.jsx)(r.C5,{replace:!0,to:p}),(0,t.jsx)(d,{isOpen:m,onDiscard:E,onBackToForm:P})]})},d=({onDiscard:c,onBackToForm:h,isOpen:o})=>(0,t.jsxs)(g.a,{isOpen:o,title:"Leave page?",onDismiss:h,icon:"exclamation-triangle",className:(0,n.css)({width:"500px"}),children:[(0,t.jsx)("h5",{children:"Changes that you made may not be saved."}),(0,t.jsxs)(g.a.ButtonRow,{children:[(0,t.jsx)(i.$n,{variant:"secondary",onClick:h,fill:"outline",children:"Continue editing"}),(0,t.jsx)(i.$n,{variant:"destructive",onClick:c,children:"Discard unsaved changes"})]})]})},18759:(G,R,e)=>{"use strict";e.d(R,{T:()=>r});var t=e(74848),n=e(32196),s=e(40845),a=e(16795);function r({children:i,spacing:l,level:d}){const c=(0,s.of)(g,l,d);return(0,t.jsx)("span",{className:(0,n.css)(c.indentor),children:i})}const g=(i,l,d)=>({indentor:(0,n.css)((0,a.Y)(i,l,c=>({paddingLeft:i.spacing(c*d)})))})},61680:(G,R,e)=>{"use strict";e.d(R,{b:()=>a});var t=e(74848),n=e(96540),s=e(33390);const a=r=>{const{children:g,storageKey:i,defaultValue:l}=r,[d,c]=(0,n.useState)({value:s.A.getObject(r.storageKey,r.defaultValue)});(0,n.useEffect)(()=>{const m=u=>{u.key===i&&c({value:s.A.getObject(r.storageKey,r.defaultValue)})};return window.addEventListener("storage",m),()=>{window.removeEventListener("storage",m)}});const h=m=>{try{s.A.setObject(i,m)}catch(u){console.error(u)}c({value:m})},o=()=>{try{s.A.delete(i)}catch(m){console.log(m)}c({value:l})};return(0,t.jsx)(t.Fragment,{children:g(d.value,h,o)})}},27673:(G,R,e)=>{"use strict";e.d(R,{A:()=>n});var t=e(96540);function n({children:a,onSetScrollRef:r,divId:g}){const i=(0,t.useRef)(null);return(0,t.useEffect)(()=>{r&&r(new s(document.documentElement))},[i,r]),a}class s{constructor(r){this.element=r}get scrollTop(){return this.element.scrollTop}scrollTo(r,g,i=0){if(!(this.element.scrollHeight-this.element.clientHeight-g>=0)&&i<10){requestAnimationFrame(()=>this.scrollTo(r,g,i+1));return}this.element.scrollTo(r,g)}}},60188:(G,R,e)=>{"use strict";e.d(R,{Q:()=>i});var t=e(74848),n=e(2543),s=e.n(n),a=e(96540),r=e(10354),g=e(88575);class i extends a.PureComponent{constructor(){super(...arguments),this.state={text:"",inputCorrected:!1},this.inputRef=a.createRef(),this.updateValue=()=>{const d=this.inputRef.current?.value;let c=!1,h="";const o=this.props.min,m=this.props.max;let u=d!==""?Number(d):void 0;u&&!Number.isNaN(u)&&(o!=null&&u<o?(h=o.toString(),c=!0):m!=null&&u>m?(h=m.toString(),c=!0):h=d??"",this.setState({text:h,inputCorrected:c})),c&&this.updateValueDebounced(),!Number.isNaN(u)&&u!==this.props.value&&this.props.onChange(u)},this.updateValueDebounced=(0,n.debounce)(this.updateValue,500),this.onChange=d=>{this.setState({text:d.currentTarget.value}),this.updateValueDebounced()},this.onKeyPress=d=>{d.key==="Enter"&&this.updateValue()}}componentDidMount(){this.setState({text:isNaN(this.props.value)?"":`${this.props.value}`})}componentDidUpdate(d){if(this.props.value!==d.value){const c=isNaN(this.props.value)?"":`${this.props.value}`;c!==this.state.text&&this.setState({text:c})}}renderInput(){return(0,t.jsx)(r.p,{type:"number",ref:this.inputRef,min:this.props.min,max:this.props.max,step:this.props.step,autoFocus:this.props.autoFocus,value:this.state.text,onChange:this.onChange,onBlur:this.updateValue,onKeyPress:this.onKeyPress,placeholder:this.props.placeholder,disabled:this.props.fieldDisabled,width:this.props.width,suffix:this.props.suffix})}render(){const{inputCorrected:d}=this.state;if(d){let c="",{min:h,max:o}=this.props;return o==null?h!=null&&(c=`< ${h}`):h!=null?c=`${h} < > ${o}`:c=`> ${o}`,(0,t.jsx)(g.D,{invalid:d,error:`Out of range ${c}`,validationMessageHorizontalOverflow:!0,style:{direction:"rtl"},children:this.renderInput()})}return this.renderInput()}}},77268:(G,R,e)=>{"use strict";e.d(R,{a:()=>i});var t=e(74848),n=e(32196),s=e(40845),a=e(83598),r=e(29158),g=e(83876);const i=({value:d,settings:c,onChange:h,details:o})=>{const m=(0,s.$j)(),u=(0,s.of)(l);return(0,t.jsx)(a.sk,{color:d??"",onChange:h,enableNamedColors:c?.enableNamedColors!==!1,children:({ref:p,showColorPicker:f,hideColorPicker:y})=>(0,t.jsxs)("div",{className:u.spot,children:[(0,t.jsx)("div",{className:u.colorPicker,children:(0,t.jsx)(g.q,{ref:p,onClick:f,onMouseLeave:y,color:d?m.visualization.getColorByName(d):m.components.input.borderColor})}),o&&(0,t.jsxs)(t.Fragment,{children:[d?(0,t.jsx)("span",{className:u.colorText,onClick:f,children:d}):(0,t.jsx)("span",{className:u.placeholderText,onClick:f,children:c?.placeholder??"Select color"}),c?.isClearable&&d&&(0,t.jsx)(r.K,{name:"times",onClick:()=>h(void 0),tooltip:"Clear settings"})]})]})})},l=d=>({spot:(0,n.css)({cursor:"pointer",color:d.colors.text.primary,background:d.components.input.background,padding:"3px",height:d.v1.spacing.formInputHeight,border:`1px solid ${d.components.input.borderColor}`,display:"flex",flexDirection:"row",alignItems:"center",alignContent:"flex-end","&:hover":{border:`1px solid ${d.components.input.borderHover}`}}),colorPicker:(0,n.css)({padding:`0 ${d.spacing(1)}`}),colorText:(0,n.css)({flexGrow:2}),placeholderText:(0,n.css)({flexGrow:2,color:d.colors.text.secondary})})},72626:(G,R,e)=>{"use strict";e.d(R,{w:()=>a});var t=e(74848),n=e(96540),s=e(60188);const a=({value:r,onChange:g,item:i})=>{const{settings:l}=i,d=(0,n.useCallback)(c=>{g(l?.integer&&c!==void 0?Math.floor(c):c)},[g,l?.integer]);return(0,t.jsx)(s.Q,{value:r,min:l?.min,max:l?.max,step:l?.step,placeholder:l?.placeholder,onChange:d})}},79648:(G,R,e)=>{"use strict";e.d(R,{H:()=>ge,u:()=>Ie});var t=e(74848),n=e(69550),s=e(27310),a=e(11261),r=e(50082),g=e(32264),i=e(15292),l=e(94354),d=e(20333),c=e(76218),h=e(96540),o=e(32196),m=e(2543),u=e(47737),p=e(60578),f=e(24284),y=e(10354),x=e(83598),v=e(29158),P=e(55852),E=e(60029),D=e(3911);const C=[{value:r.O.Absolute,label:"Absolute",description:"Pick thresholds based on the absolute values"},{value:r.O.Percentage,label:"Percentage",description:"Pick threshold based on the percent between min/max"}];class b extends h.PureComponent{constructor(me){super(me),this.onAddThreshold=()=>{const{steps:Ne}=this.state;let Fe=0;Ne.length>1&&(Fe=Ne[Ne.length-1].value+10);let Be=f.Tj.filter(Ke=>!Ne.some(ze=>ze.color===Ke))[1];Be||(Be="#CCCCCC");const he={value:Fe,color:Be,key:T++},be=[...Ne,he];(0,u.RU)(be),this.setState({steps:be},()=>{this.latestThresholdInputRef.current&&this.latestThresholdInputRef.current.focus(),this.onChange()})},this.onRemoveThreshold=Ne=>{const{steps:Fe}=this.state;Fe.length&&Ne.key!==Fe[0].key&&this.setState({steps:Fe.filter(Be=>Be.key!==Ne.key)},this.onChange)},this.onChangeThresholdValue=(Ne,Fe)=>{const Be=Ne.target.value.replace(/,/g,"."),he=parseFloat(Be),be=isNaN(he)?"":he,Ke=this.state.steps.map(ze=>(ze.key===Fe.key&&(ze={...ze,value:be}),ze));Ke.length&&(Ke[0].value=-1/0),(0,u.RU)(Ke),this.setState({steps:Ke})},this.onChangeThresholdColor=(Ne,Fe)=>{const{steps:Be}=this.state,he=Be.map(be=>(be.key===Ne.key&&(be={...be,color:Fe}),be));this.setState({steps:he},this.onChange)},this.onBlur=()=>{const Ne=[...this.state.steps];(0,u.RU)(Ne),this.setState({steps:Ne},this.onChange)},this.onChange=()=>{this.props.onChange(O(this.props.thresholds,this.state.steps))},this.onModeChanged=Ne=>{this.props.onChange({...this.props.thresholds,mode:Ne})};const Pe=S(me.thresholds.steps);Pe[0].value=-1/0,this.state={steps:Pe},this.latestThresholdInputRef=h.createRef()}renderInput(me,Pe,Ne){const Fe=this.props.thresholds.mode===r.O.Percentage,Be=`Threshold ${Ne+1}`;return isFinite(me.value)?(0,t.jsx)(y.p,{type:"number",step:"0.0001",onChange:he=>this.onChangeThresholdValue(he,me),value:me.value,"aria-label":Be,ref:Ne===0?this.latestThresholdInputRef:null,onBlur:this.onBlur,prefix:(0,t.jsxs)("div",{className:Pe.inputPrefix,children:[(0,t.jsx)("div",{className:Pe.colorPicker,children:(0,t.jsx)(x.sk,{color:me.color,onChange:he=>this.onChangeThresholdColor(me,he),enableNamedColors:!0})}),Fe&&(0,t.jsx)("div",{className:Pe.percentIcon,children:"%"})]}),suffix:(0,t.jsx)(v.K,{className:Pe.trashIcon,name:"trash-alt",onClick:()=>this.onRemoveThreshold(me),tooltip:`Remove ${Be}`})},Fe.toString()):(0,t.jsx)(y.p,{type:"text",value:"Base","aria-label":Be,disabled:!0,prefix:(0,t.jsx)("div",{className:Pe.colorPicker,children:(0,t.jsx)(x.sk,{color:me.color,onChange:he=>this.onChangeThresholdColor(me,he),enableNamedColors:!0})})})}render(){const{thresholds:me}=this.props,{steps:Pe}=this.state;return(0,t.jsx)(p.D.Consumer,{children:Ne=>{const Fe=M(Ne);return(0,t.jsxs)("div",{className:Fe.wrapper,children:[(0,t.jsx)(P.$n,{size:"sm",icon:"plus",onClick:()=>this.onAddThreshold(),variant:"secondary",className:Fe.addButton,fullWidth:!0,children:"Add threshold"}),(0,t.jsx)("div",{className:Fe.thresholds,children:Pe.slice(0).reverse().map((Be,he)=>(0,t.jsx)("div",{className:Fe.item,children:this.renderInput(Be,Fe,he)},`${Be.key}`))}),(0,t.jsxs)("div",{children:[(0,t.jsx)(E.J,{description:"Percentage means thresholds relative to min & max",children:"Thresholds mode"}),(0,t.jsx)(l.z,{options:C,onChange:this.onModeChanged,value:me.mode})]})]})}})}}let T=100;function S(ue){return(!ue||ue.length===0)&&(ue=[{value:-1/0,color:"green"}]),ue.filter((me,Pe)=>(0,m.isNumber)(me.value)||Pe===0).map(me=>({color:me.color,value:me.value===null?-1/0:me.value,key:T++}))}function O(ue,me){return{mode:ue.mode??r.O.Absolute,steps:me.map(Ne=>{const{key:Fe,...Be}=Ne;return Be})}}const M=(0,D.N)(ue=>({wrapper:(0,o.css)`
      display: flex;
      flex-direction: column;
    `,thresholds:(0,o.css)`
      display: flex;
      flex-direction: column;
      margin-bottom: ${ue.spacing(2)};
    `,item:(0,o.css)`
      margin-bottom: ${ue.spacing(1)};

      &:last-child {
        margin-bottom: 0;
      }
    `,colorPicker:(0,o.css)`
      padding: 0 ${ue.spacing(1)};
    `,addButton:(0,o.css)`
      margin-bottom: ${ue.spacing(1)};
    `,percentIcon:(0,o.css)`
      font-size: ${ue.typography.bodySmall.fontSize};
      color: ${ue.colors.text.secondary};
    `,inputPrefix:(0,o.css)`
      display: flex;
      align-items: center;
    `,trashIcon:(0,o.css)`
      color: ${ue.colors.text.secondary};
      cursor: pointer;
      margin-right: 0;

      &:hover {
        color: ${ue.colors.text};
      }
    `}));class I extends h.PureComponent{constructor(me){super(me)}render(){const{onChange:me}=this.props;let Pe=this.props.value;return Pe||(Pe={mode:r.O.Percentage,steps:[]}),(0,t.jsx)(b,{thresholds:Pe,onChange:me})}}var L=e(25019),B=e(40845),j=e(66864),A=e(14578),K=e(37390),W=e(80744),U=e(25148),F=e(91076),V=e(51986),w=e(90182);function z({mapping:ue,index:me,onChange:Pe,onRemove:Ne,onDuplicate:Fe,showIconPicker:Be}){const{key:he,result:be,id:Ke}=ue,ze=(0,B.of)(N),nt=(0,h.useRef)(null),tt=(0,h.useCallback)(Ge=>{const Je={...ue,result:{...ue.result}};Ge(Je),Pe(me,Je)},[ue,me,Pe]);(0,h.useEffect)(()=>{nt.current&&ue.isNew&&(nt.current.focus(),tt(Ge=>{Ge.isNew=!1}))},[ue,nt,tt]);const ot=Ge=>{tt(Je=>{Je.result.color=Ge})},gt=()=>{tt(Ge=>{Ge.result.color=void 0})},He=Ge=>{tt(Je=>{Je.result.icon=Ge})},et=()=>{tt(Ge=>{Ge.result.icon=void 0})},rt=Ge=>{tt(Je=>{Je.key=Ge.currentTarget.value})},ht=Ge=>{tt(Je=>{Je.result.text=Ge.currentTarget.value})},ft=Ge=>{tt(Je=>{Je.from=parseFloat(Ge.currentTarget.value)})},De=Ge=>{tt(Je=>{Je.to=parseFloat(Ge.currentTarget.value)})},Te=Ge=>{tt(Je=>{Je.pattern=Ge.currentTarget.value})},Oe=Ge=>{tt(Je=>{Je.specialMatch=Ge.value})},Ye=[{label:"Null",value:L.W.Null,description:"Matches null and undefined values"},{label:"NaN",value:L.W.NaN,description:"Matches against Number.NaN (not a number)"},{label:"Null + NaN",value:L.W.NullAndNaN,description:"Matches null, undefined and NaN"},{label:"True",value:L.W.True,description:"Boolean true values"},{label:"False",value:L.W.False,description:"Boolean false values"},{label:"Empty",value:L.W.Empty,description:"Empty string"}];return(0,t.jsx)(F.sx,{draggableId:Ke,index:me,children:Ge=>(0,t.jsxs)("tr",{className:ze.dragRow,ref:Ge.innerRef,...Ge.draggableProps,children:[(0,t.jsx)("td",{children:(0,t.jsx)("div",{className:ze.dragHandle,...Ge.dragHandleProps,children:(0,t.jsx)(A.I,{name:"draggabledots",size:"lg"})})}),(0,t.jsx)("td",{className:ze.typeColumn,children:ue.type}),(0,t.jsxs)("td",{children:[ue.type===L.d.ValueToText&&(0,t.jsx)(y.p,{ref:nt,type:"text",value:he??"",onChange:rt,placeholder:"Exact value to match"}),ue.type===L.d.RangeToText&&(0,t.jsxs)("div",{className:ze.rangeInputWrapper,children:[(0,t.jsx)(y.p,{type:"number",value:ue.from??"",placeholder:"Range start",onChange:ft,prefix:"From"}),(0,t.jsx)(y.p,{type:"number",value:ue.to??"",placeholder:"Range end",onChange:De,prefix:"To"})]}),ue.type===L.d.RegexToText&&(0,t.jsx)(y.p,{type:"text",value:ue.pattern??"",placeholder:"Regular expression",onChange:Te}),ue.type===L.d.SpecialValue&&(0,t.jsx)(w.l6,{value:Ye.find(Je=>Je.value===ue.specialMatch),options:Ye,onChange:Oe})]}),(0,t.jsx)("td",{children:(0,t.jsx)(y.p,{type:"text",value:be.text??"",onChange:ht,placeholder:"Optional display text"})}),(0,t.jsxs)("td",{className:ze.textAlignCenter,children:[be.color&&(0,t.jsxs)(j.Gy,{spacing:"sm",justify:"center",children:[(0,t.jsx)(x.sk,{color:be.color,onChange:ot,enableNamedColors:!0}),(0,t.jsx)(v.K,{name:"times",onClick:gt,tooltip:"Remove color",tooltipPlacement:"top"})]}),!be.color&&(0,t.jsx)(x.sk,{color:"gray",onChange:ot,enableNamedColors:!0,children:Je=>(0,t.jsx)(P.$n,{variant:"primary",fill:"text",onClick:Je.showColorPicker,ref:Je.ref,size:"sm",children:"Set color"})})]}),Be&&(0,t.jsx)("td",{className:ze.textAlignCenter,children:(0,t.jsxs)(j.Gy,{spacing:"sm",justify:"center",children:[(0,t.jsx)(U.n,{onChange:He,onClear:et,value:be.icon,size:W.Iy.SMALL,folderName:W.Iu.Icon,mediaType:W.zu.Icon,color:be.color}),be.icon&&(0,t.jsx)(v.K,{name:"times",onClick:et,tooltip:"Remove icon",tooltipPlacement:"top"})]})}),(0,t.jsx)("td",{className:ze.textAlignCenter,children:(0,t.jsxs)(j.Gy,{spacing:"sm",children:[(0,t.jsx)(v.K,{name:"copy",onClick:()=>Fe(me),"data-testid":"duplicate-value-mapping","aria-label":"Duplicate value mapping",tooltip:"Duplicate"}),(0,t.jsx)(v.K,{name:"trash-alt",onClick:()=>Ne(me),"data-testid":"remove-value-mapping","aria-label":"Delete value mapping",tooltip:"Delete"})]})})]})},Ke)}const N=ue=>({dragRow:(0,o.css)({position:"relative"}),dragHandle:(0,o.css)({cursor:"grab","&:focus-visible&:after":{bottom:0,content:'""',left:0,position:"absolute",right:0,top:0,outline:`2px solid ${ue.colors.primary.main}`,outlineOffset:"-2px"}}),rangeInputWrapper:(0,o.css)({display:"flex","> div:first-child":{marginRight:ue.spacing(2)}}),regexInputWrapper:(0,o.css)({display:"flex","> div:first-child":{marginRight:ue.spacing(2)}}),typeColumn:(0,o.css)({textTransform:"capitalize",textAlign:"center",width:"1%"}),textAlignCenter:(0,o.css)({textAlign:"center"})});function H({value:ue,onChange:me,onClose:Pe,showIconPicker:Ne}){const Fe=(0,B.of)(Q),[Be,he]=(0,h.useState)([]);(0,h.useEffect)(()=>{he(ae(ue))},[ue]);const be=He=>{if(!ue||!He.destination)return;const et=[...Be],rt=et[He.source.index];et.splice(He.source.index,1),et.splice(He.destination.index,0,rt),he(et)},Ke=(He,et)=>{const rt=[...Be];rt.splice(He,1,et),he(rt)},ze=He=>{const et=[...Be];et.splice(He,1),he(et)},nt=[{label:"Value",value:L.d.ValueToText,description:"Match a specific text value"},{label:"Range",value:L.d.RangeToText,description:"Match a numerical range of values"},{label:"Regex",value:L.d.RegexToText,description:"Match a regular expression with replacement"},{label:"Special",value:L.d.SpecialValue,description:"Match on null, NaN, boolean and empty values"}],tt=He=>{he([...Be,ee({type:He.value,result:{},isNew:!0})])},ot=He=>{const et=Z(Be[He]),rt=[...Be];rt.splice(He,0,{...et});for(let ht=He;ht<Be.length;ht++)rt[ht].result.index=ht;he(rt)},gt=()=>{me(q(Be)),Pe()};return(0,h.useEffect)(()=>{ue?.length||tt({value:L.d.ValueToText})},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:Fe.tableWrap,children:(0,t.jsxs)("table",{className:Fe.editTable,children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{style:{width:"1%"}}),(0,t.jsx)("th",{style:{width:"40%",textAlign:"left"},colSpan:2,children:"Condition"}),(0,t.jsx)("th",{style:{textAlign:"left"},children:"Display text"}),(0,t.jsx)("th",{style:{width:"10%"},children:"Color"}),Ne&&(0,t.jsx)("th",{style:{width:"10%"},children:"Icon"}),(0,t.jsx)("th",{style:{width:"1%"}})]})}),(0,t.jsx)(F.JY,{onDragEnd:be,children:(0,t.jsx)(F.gL,{droppableId:"sortable-field-mappings",direction:"vertical",children:He=>(0,t.jsxs)("tbody",{ref:He.innerRef,...He.droppableProps,children:[Be.map((et,rt)=>(0,t.jsx)(z,{mapping:et,index:rt,onChange:Ke,onRemove:ze,onDuplicate:ot,showIconPicker:Ne},et.id)),He.placeholder]})})})]})}),(0,t.jsxs)(K.a.ButtonRow,{leftItems:(0,t.jsx)(V.i,{label:"Add a new mapping",variant:"secondary",size:"md",icon:"plus",menuPlacement:"auto",minWidth:40,options:nt,onChange:tt}),children:[(0,t.jsx)(P.$n,{variant:"secondary",fill:"outline",onClick:Pe,children:"Cancel"}),(0,t.jsx)(P.$n,{variant:"primary",onClick:gt,children:"Update"})]})]})}const Q=ue=>({tableWrap:(0,o.css)`
    max-height: calc(80vh - 170px);
    min-height: 40px;
    overflow: auto;
  `,editTable:(0,o.css)({width:"100%",marginBottom:ue.spacing(2),"thead th":{textAlign:"center"},"tbody tr:hover":{background:ue.colors.action.hover}," th, td":{padding:ue.spacing(1)}})});function X(){return(0,m.uniqueId)("mapping-")}function ee(ue){return{type:L.d.ValueToText,result:{},id:X(),...ue}}function Z(ue){return{...ee(ue),id:X()}}function q(ue){const me=[],Pe={type:L.d.ValueToText,options:{}};return ue.forEach((Ne,Fe)=>{const Be={...Ne.result,index:Fe};switch((!Be.text||Be.text.trim().length===0)&&(Be.text=void 0),Ne.type){case L.d.ValueToText:Ne.key!=null&&(Pe.options[Ne.key]=Be);break;case L.d.RangeToText:Ne.from!=null&&Ne.to!=null&&me.push({type:Ne.type,options:{from:Ne.from,to:Ne.to,result:Be}});break;case L.d.RegexToText:Ne.pattern!=null&&me.push({type:Ne.type,options:{pattern:Ne.pattern,result:Be}});break;case L.d.SpecialValue:me.push({type:Ne.type,options:{match:Ne.specialMatch,result:Be}})}}),Object.keys(Pe.options).length>0&&me.unshift(Pe),me}function ae(ue){const me=[];if(ue)for(const Pe of ue)switch(Pe.type){case L.d.ValueToText:for(const Ne in Pe.options)me.push(ee({type:Pe.type,result:Pe.options[Ne],key:Ne}));break;case L.d.RangeToText:me.push(ee({type:Pe.type,result:Pe.options.result,from:Pe.options.from??0,to:Pe.options.to??0}));break;case L.d.RegexToText:me.push(ee({type:Pe.type,result:Pe.options.result,pattern:Pe.options.pattern}));break;case L.d.SpecialValue:me.push(ee({type:Pe.type,result:Pe.options.result,specialMatch:Pe.options.match??L.W.Null}))}return me.sort((Pe,Ne)=>(Pe.result.index??0)>(Ne.result.index??0)?1:-1),me}const k=(0,h.memo)(ue=>{const{value:me,onChange:Pe,item:Ne}=ue,Fe=(0,B.of)(se),Be=Ne.settings?.icon,[he,be]=(0,h.useState)(!1),Ke=(0,h.useCallback)(()=>{be(!1)},[be]),ze=(0,h.useMemo)(()=>ae(me),[me]),nt=(0,h.useCallback)((ot,gt)=>{ze[gt].result.color=ot,Pe(q(ze))},[ze,Pe]),tt=(0,h.useCallback)((ot,gt)=>{ze[gt].result.icon=ot,Pe(q(ze))},[ze,Pe]);return(0,t.jsxs)(j.gW,{children:[(0,t.jsx)("table",{className:Fe.compactTable,children:(0,t.jsx)("tbody",{children:ze.map((ot,gt)=>(0,t.jsxs)("tr",{children:[(0,t.jsxs)("td",{children:[ot.type===L.d.ValueToText&&ot.key,ot.type===L.d.RangeToText&&(0,t.jsxs)("span",{children:["[",ot.from," - ",ot.to,"]"]}),ot.type===L.d.RegexToText&&ot.pattern,ot.type===L.d.SpecialValue&&ot.specialMatch]}),(0,t.jsx)("td",{children:(0,t.jsx)(A.I,{name:"arrow-right"})}),(0,t.jsx)("td",{children:ot.result.text}),ot.result.color&&(0,t.jsx)("td",{children:(0,t.jsx)(x.sk,{color:ot.result.color,onChange:He=>nt(He,gt),enableNamedColors:!0})}),Be&&ot.result.icon&&(0,t.jsx)("td",{"data-testid":"iconPicker",children:(0,t.jsx)(U.n,{onChange:He=>tt(He,gt),value:ot.result.icon,size:W.Iy.SMALL,folderName:W.Iu.Icon,mediaType:W.zu.Icon,color:ot.result.color})})]},gt.toString()))})}),(0,t.jsxs)(P.$n,{variant:"secondary",size:"sm",fullWidth:!0,onClick:()=>be(!0),children:[ze.length>0&&(0,t.jsx)("span",{children:"Edit value mappings"}),ze.length===0&&(0,t.jsx)("span",{children:"Add value mappings"})]}),(0,t.jsx)(K.a,{isOpen:he,title:"Value mappings",onDismiss:Ke,className:Fe.modal,closeOnBackdropClick:!1,children:(0,t.jsx)(H,{value:me,onChange:Pe,onClose:Ke,showIconPicker:Be})})]})});k.displayName="ValueMappingsEditor";const se=ue=>({modal:(0,o.css)({width:"980px"}),compactTable:(0,o.css)({width:"100%","tbody td":{padding:ue.spacing(.5)}})});var te=e(59429);const ne=({value:ue,onChange:me,item:Pe})=>{const{placeholder:Ne,isClearable:Fe}=Pe?.settings??{},Be=(0,h.useCallback)(he=>{me(he?.value?.uid)},[me]);return(0,t.jsx)(te.b,{isClearable:Fe,defaultOptions:!0,onChange:Be,placeholder:Ne,value:ue})};var le=e(91890),re=e(13762);const de=({value:ue,onChange:me,context:Pe})=>(0,t.jsx)(re.G,{actions:ue,onChange:me,data:Pe.data,getSuggestions:()=>Pe.getSuggestions?Pe.getSuggestions(le.uP.Values):[]});var oe=e(77268),J=e(8066),ce=e(24293),pe=e(88575);const xe=({value:ue,onChange:me,item:Pe,id:Ne})=>{const Fe=(0,B.$j)(),Be=(0,B.of)(Ee),he=(0,J.Hs)(ue?.mode),Ke=(Pe.settings?.byValueSupport?J.uf.list():J.uf.list().filter(gt=>!gt.isByValue)).filter(gt=>!gt.excludeFromPicker).map(gt=>{let He=gt.isByValue?" (by value)":"";return{value:gt.id,label:`${gt.name}${He}`,description:gt.description,isContinuous:gt.isContinuous,isByValue:gt.isByValue,component(){return(0,t.jsx)(fe,{mode:gt,theme:Fe})}}}),ze=gt=>{me({...ue,mode:gt.value})},nt=gt=>{me({...ue,mode:ot,fixedColor:gt})},tt=gt=>{me({...ue,mode:ot,seriesBy:gt})},ot=ue?.mode??ce.Y.Thresholds;if(ot===ce.Y.Fixed||ot===ce.Y.Shades)return(0,t.jsxs)("div",{className:Be.group,children:[(0,t.jsx)(w.l6,{minMenuHeight:200,options:Ke,value:ot,onChange:ze,className:Be.select,inputId:Ne}),(0,t.jsx)(oe.a,{value:ue?.fixedColor,onChange:nt})]});if(Pe.settings?.bySeriesSupport&&he.isByValue){const gt=[{label:"Last",value:"last"},{label:"Min",value:"min"},{label:"Max",value:"max"}];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{marginBottom:Fe.spacing(2)},children:(0,t.jsx)(w.l6,{minMenuHeight:200,options:Ke,value:ot,onChange:ze,inputId:Ne})}),(0,t.jsx)(pe.D,{label:"Color series by",children:(0,t.jsx)(l.z,{value:ue?.seriesBy??"last",options:gt,onChange:tt})})]})}return(0,t.jsx)(w.l6,{minMenuHeight:200,options:Ke,value:ot,onChange:ze,inputId:Ne})},fe=({mode:ue,theme:me})=>{if(!ue.getColors)return null;const Pe=ue.getColors(me).map(me.visualization.getColorByName),Ne={height:"8px",width:"100%",margin:"2px 0",borderRadius:"3px",opacity:1};if(ue.isContinuous)Ne.background=`linear-gradient(90deg, ${Pe.join(",")})`;else{let Fe="",Be="";for(let he=0;he<Pe.length;he++){const be=Pe[he];if(Fe==="")Fe=`linear-gradient(90deg, ${be} 0%`;else{const ze=he/(Pe.length-1)*100;Fe+=`, ${Be} ${ze}%, ${be} ${ze}%`}Be=be}Ne.background=Fe}return(0,t.jsx)("div",{style:Ne})},Ee=ue=>({group:(0,o.css)({display:"flex"}),select:(0,o.css)({marginRight:ue.spacing(1),flexGrow:1})});var Se=e(64919);const ye=({value:ue,onChange:me,context:Pe})=>(0,t.jsx)(Se.e,{links:ue,onChange:me,data:Pe.data,getSuggestions:()=>Pe.getSuggestions?Pe.getSuggestions(le.uP.Values):[]});class Ve extends h.PureComponent{constructor(){super(...arguments),this.state={isLoading:!0,options:[]},this.updateOptions=async()=>{const{item:me}=this.props,{settings:Pe}=me;let Ne=me.settings?.options||[];Pe?.getOptions&&(Ne=await Pe.getOptions(this.props.context)),this.state.options!==Ne&&this.setState({isLoading:!1,options:Ne})}}componentDidMount(){this.updateOptions()}componentDidUpdate(me){const Pe=me.item?.settings,Ne=this.props.item?.settings;if(Pe!==Ne)this.updateOptions();else if(Ne?.getOptions){const Fe=me.context?.data,Be=this.props.context?.data;Fe!==Be&&this.updateOptions()}}render(){const{options:me,isLoading:Pe}=this.state,{value:Ne,onChange:Fe,item:Be}=this.props,{settings:he}=Be;return(0,t.jsx)(w.KF,{isLoading:Pe,value:Ne,defaultValue:Ne,allowCustomValue:he?.allowCustomValue,onChange:be=>{Fe(be.map(Ke=>Ke.value).flatMap(Ke=>Ke!==void 0?[Ke]:[]))},options:me})}}var Me=e(72626);class Ce extends h.PureComponent{constructor(){super(...arguments),this.state={isLoading:!0,options:[]},this.updateOptions=async()=>{const{item:me}=this.props,{settings:Pe}=me;let Ne=me.settings?.options||[];Pe?.getOptions&&(Ne=await Pe.getOptions(this.props.context)),this.state.options!==Ne&&this.setState({isLoading:!1,options:Ne})}}componentDidMount(){this.updateOptions()}componentDidUpdate(me){const Pe=me.item?.settings,Ne=this.props.item?.settings;if(Pe!==Ne)this.updateOptions();else if(Ne?.getOptions){const Fe=me.context?.data,Be=this.props.context?.data;Fe!==Be&&this.updateOptions()}}render(){const{options:me,isLoading:Pe}=this.state,{value:Ne,onChange:Fe,item:Be}=this.props,{settings:he}=Be;let be=me.find(Ke=>Ke.value===Ne);return!be&&Ne&&(be={label:`${Ne}`,value:Ne}),(0,t.jsx)(w.l6,{isLoading:Pe,value:be,defaultValue:Ne,allowCustomValue:he?.allowCustomValue,isClearable:he?.isClearable,onChange:Ke=>Fe(Ke?.value),options:me})}}var Ue=e(57602),Ae=e(42734);const we=({value:ue,onChange:me,item:Pe,id:Ne})=>(0,t.jsx)(Ae.S,{stats:ue,onChange:me,allowMultiple:!!Pe.settings?.allowMultiple,defaultStat:Pe.settings?.defaultStat,inputId:Ne});var We=e(29286);class _e extends h.PureComponent{constructor(){super(...arguments),this.state={showAdd:!1},this.onRemoveString=me=>{const{value:Pe,onChange:Ne}=this.props,Fe=[...Pe];Fe.splice(me,1),Ne(Fe)},this.onValueChange=(me,Pe)=>{if("key"in me&&me.key!=="Enter")return;const{value:Ne,onChange:Fe}=this.props,Be=me.currentTarget.value.trim();if(Pe<0){Be&&(me.currentTarget.value="",Fe([...Ne,Be])),this.setState({showAdd:!1});return}if(!Be)return this.onRemoveString(Pe);const he=[...Ne];he[Pe]=Be,Fe(he)}}render(){const{value:me,item:Pe}=this.props,{showAdd:Ne}=this.state,Fe=at(g.$.theme2),Be=Pe.settings?.placeholder||"Add text";return(0,t.jsxs)("div",{children:[me.map((he,be)=>(0,t.jsx)(y.p,{className:Fe.textInput,defaultValue:he||"",onBlur:Ke=>this.onValueChange(Ke,be),onKeyDown:Ke=>this.onValueChange(Ke,be),suffix:(0,t.jsx)(A.I,{className:Fe.trashIcon,name:"trash-alt",onClick:()=>this.onRemoveString(be)})},`${be}/${he}`)),Ne?(0,t.jsx)(y.p,{autoFocus:!0,className:Fe.textInput,placeholder:Be,defaultValue:"",onBlur:he=>this.onValueChange(he,-1),onKeyDown:he=>this.onValueChange(he,-1),suffix:(0,t.jsx)(A.I,{name:"plus-circle"})}):(0,t.jsx)(P.$n,{icon:"plus",size:"sm",variant:"secondary",onClick:()=>this.setState({showAdd:!0}),children:Be})]})}}const at=(0,D.N)(ue=>({textInput:(0,o.css)({marginBottom:"5px","&:hover":{border:`1px solid ${ue.components.input.borderHover}`}}),trashIcon:(0,o.css)({color:ue.colors.text.secondary,cursor:"pointer","&:hover":{color:ue.colors.text.primary}})}));var ut=e(2056);function Tt({value:ue,onChange:me,item:Pe}){const Ne=(0,B.of)(It);return Pe?.settings?.isClearable&&ue!=null?(0,t.jsxs)("div",{className:Ne.wrapper,children:[(0,t.jsx)("span",{className:Ne.first,children:(0,t.jsx)(ut.p,{value:ue,onChange:me})}),(0,t.jsx)(v.K,{name:"times",onClick:()=>me(void 0),tooltip:"Clear unit selection"})]}):(0,t.jsx)(ut.p,{value:ue,onChange:me})}const It=ue=>({wrapper:(0,o.css)({width:"100%",display:"flex",flexDirection:"row",alignItems:"center"}),first:(0,o.css)({marginRight:ue.spacing(1),flexGrow:2})}),ge=()=>{const ue={id:"number",name:"Number",description:"Allows numeric values input",editor:Me.w},me={id:"slider",name:"Slider",description:"Allows numeric values input",editor:Ue.G},Pe={id:"text",name:"Text",description:"Allows string values input",editor:We.g},Ne={id:"strings",name:"String array",description:"An array of strings",editor:_e},Fe={id:"boolean",name:"Boolean",description:"Allows boolean values input",editor(De){const{id:Te,...Oe}=De;return(0,t.jsx)(i.d,{...Oe,onChange:Ye=>De.onChange(Ye.currentTarget.checked)})}},Be={id:"select",name:"Select",description:"Allows option selection",editor:Ce},he={id:"multi-select",name:"Multi select",description:"Allows for multiple option selection",editor:Ve},be={id:"radio",name:"Radio",description:"Allows option selection",editor(De){return(0,t.jsx)(l.z,{...De,options:De.item.settings?.options})}},Ke={id:"unit",name:"Unit",description:"Allows unit input",editor:Tt},ze={id:"color",name:"Color",description:"Allows color selection",editor(De){return(0,t.jsx)(oe.a,{value:De.value,onChange:De.onChange,settings:De.item.settings,details:!0})}},nt={id:"fieldColor",name:"Field Color",description:"Field color selection",editor:xe},tt={id:"links",name:"Links",description:"Allows defining data links",editor:ye},ot={id:"actions",name:"Actions",description:"Allows defining actions",editor:de},gt={id:"stats-picker",name:"Stats Picker",editor:we,description:""},He={id:"timezone",name:"Time zone",description:"Time zone selection",editor:d.U},et={id:"field-name",name:"Field name",description:"Allows selecting a field name from a data frame",editor:c.O};return[Pe,ue,me,Fe,be,Be,Ke,tt,ot,gt,Ne,He,nt,ze,he,et,{id:"dashboard-uid",name:"Dashboard",description:"Select dashboard",editor:ne},{id:"mappings",name:"Mappings",description:"Allows defining value mappings",editor:k},{id:"thresholds",name:"Thresholds",description:"Allows defining thresholds",editor:I}]},Ie=()=>{const ue=["Standard options"],me={id:"displayName",path:"displayName",name:"Display name",description:"Change the field or series name",editor:n.D.get("text").editor,override:n.D.get("text").editor,process:s.AM,settings:{placeholder:"none",expandTemplateVars:!0},shouldApply:()=>!0,category:ue},Pe={id:"unit",path:"unit",name:"Unit",description:"",editor:n.D.get("unit").editor,override:n.D.get("unit").editor,process:s.OU,settings:{placeholder:"none"},shouldApply:()=>!0,category:ue},Ne={id:"fieldMinMax",path:"fieldMinMax",name:"Field min/max",description:"Calculate min max per field",editor:n.D.get("boolean").editor,override:n.D.get("boolean").editor,process:s.FM,shouldApply:et=>et.type===a.PU.number,showIf:et=>et.min===void 0||et.max===void 0,category:ue},Fe={id:"min",path:"min",name:"Min",description:"Leave empty to calculate based on all values",editor:n.D.get("number").editor,override:n.D.get("number").editor,process:s.m0,settings:{placeholder:"auto"},shouldApply:et=>et.type===a.PU.number,category:ue},Be={id:"max",path:"max",name:"Max",description:"Leave empty to calculate based on all values",editor:n.D.get("number").editor,override:n.D.get("number").editor,process:s.m0,settings:{placeholder:"auto"},shouldApply:et=>et.type===a.PU.number,category:ue},he={id:"decimals",path:"decimals",name:"Decimals",editor:n.D.get("number").editor,override:n.D.get("number").editor,process:s.m0,settings:{placeholder:"auto",min:0,max:15,integer:!0},shouldApply:et=>et.type===a.PU.number,category:ue},be={id:"noValue",path:"noValue",name:"No value",description:"What to show when there is no value",editor:n.D.get("text").editor,override:n.D.get("text").editor,process:s.OU,settings:{placeholder:"-"},shouldApply:()=>!0,category:ue},Ke=g.$.featureToggles.vizActions?"Data links and actions":"Data links",ze={id:"links",path:"links",name:"Data links",editor:n.D.get("links").editor,override:n.D.get("links").editor,process:s.Ch,settings:{placeholder:"-"},shouldApply:()=>!0,category:[Ke],getItemsCount:et=>et?et.length:0},nt={id:"actions",path:"actions",name:"Actions",editor:n.D.get("actions").editor,override:n.D.get("actions").editor,process:s.cz,settings:{placeholder:"-"},shouldApply:()=>!0,category:[Ke],getItemsCount:et=>et?et.length:0,showIf:()=>g.$.featureToggles.vizActions},tt={id:"color",path:"color",name:"Color scheme",editor:n.D.get("fieldColor").editor,override:n.D.get("fieldColor").editor,process:s.hS,shouldApply:()=>!0,settings:{byValueSupport:!0,preferThresholdsMode:!0},category:ue},ot={id:"mappings",path:"mappings",name:"Value mappings",description:"Modify the display text based on input value",editor:n.D.get("mappings").editor,override:n.D.get("mappings").editor,process:s.xT,settings:{},defaultValue:[],shouldApply:et=>et.type!==a.PU.time,category:["Value mappings"],getItemsCount:et=>et?et.length:0},gt={id:"thresholds",path:"thresholds",name:"Thresholds",editor:n.D.get("thresholds").editor,override:n.D.get("thresholds").editor,process:s.N7,settings:{},defaultValue:{mode:r.O.Absolute,steps:[{value:-1/0,color:"green"},{value:80,color:"red"}]},shouldApply:()=>!0,category:["Thresholds"],getItemsCount:et=>et?et.steps.length:0},He={id:"filterable",path:"filterable",name:"Ad-hoc filterable",hideFromDefaults:!0,editor:n.D.get("boolean").editor,override:n.D.get("boolean").editor,process:s.FM,shouldApply:()=>!0,settings:{},category:ue};return[Pe,Fe,Be,Ne,he,me,tt,be,ze,nt,ot,gt,He]}},57602:(G,R,e)=>{"use strict";e.d(R,{G:()=>d});var t=e(74848),n=e(32196),s=e(52762),a=e(10434),r=e(96540),g=e(40845),i=e(24849),l=e(60188);const d=({value:o,onChange:m,item:u})=>{const p=(0,r.useRef)(null),{settings:f}=u,y=f?.min||0,x=f?.max||100,v=f?.step,P=f?.marks||{[y]:y,[x]:x},E=f?.included,D=f?.ariaLabelForHandle,C=75,b=!0,T=(0,g.$j)(),[S,O]=(0,r.useState)(o??y),[M,I]=(0,r.useState)(C);(0,r.useEffect)(()=>{o!=null&&o!==S&&O(o)},[o,S]),(0,r.useEffect)(()=>{const W=getComputedStyle(p.current),U=W.getPropertyValue("font-weight")||"normal",F=W.getPropertyValue("font-size")||"16px",V=W.getPropertyValue("font-family")||"Arial",w="0",z=4,N=8,H=Math.max((x+(v||0)).toString().length,(x-(v||0)).toString().length)+z,Q=w.repeat(H),X=c(Q,`${U} ${F} ${V}`);X&&I(X+N*2)},[x,v]);const L=(0,r.useCallback)(W=>{const U=typeof W=="number"?W:W[0];O(U),m&&m(U)},[O,m]),B=(0,r.useCallback)(W=>{let U=W;(Number.isNaN(U)||!U)&&(U=0),O(U),m&&m(U)},[m]),j=(0,i.$)(T,b,!!P),A=h(T,M),K=b?[]:[j.sliderInputVertical];return(0,t.jsxs)("div",{className:(0,n.cx)(j.container,j.slider),children:[(0,t.jsx)(s.Global,{styles:j.slider}),(0,t.jsxs)("div",{className:(0,n.cx)(j.sliderInput,...K),children:[(0,t.jsx)(a.A,{min:y,max:x,step:v,defaultValue:o,value:S,onChange:L,vertical:!b,reverse:!1,ariaLabelForHandle:D,marks:P,included:E}),(0,t.jsx)("span",{className:A.numberInputWrapper,ref:p,children:(0,t.jsx)(l.Q,{value:S,onChange:B,max:x,min:y,step:v})})]})]})};function c(o,m){const p=document.createElement("canvas").getContext("2d");return p?(p.font=m,p.measureText(o).width):null}const h=(o,m)=>({numberInputWrapper:(0,n.css)({marginLeft:o.spacing(3),maxHeight:"32px",maxWidth:m,minWidth:m,overflow:"visible",width:"100%"})})},29286:(G,R,e)=>{"use strict";e.d(R,{g:()=>r});var t=e(74848),n=e(96540),s=e(21744),a=e(10354);const r=({value:g,onChange:i,item:l,suffix:d})=>{const c=l.settings?.useTextarea?s.f:a.p,h=(0,n.useCallback)(o=>{let m=g??"";"key"in o?o.key==="Enter"&&!l.settings?.useTextarea&&(m=o.currentTarget.value.trim()):m=o.currentTarget.value.trim(),m!==g&&i(m===""?void 0:m)},[g,l.settings?.useTextarea,i]);return(0,t.jsx)(c,{placeholder:l.settings?.placeholder,defaultValue:g||"",rows:l.settings?.useTextarea&&l.settings.rows||5,onBlur:h,onKeyDown:h,suffix:d})}},21780:(G,R,e)=>{"use strict";e.d(R,{YW:()=>Z,YO:()=>ee});var t=e(74848),n=e(32196),s=e(96540),a=e(64388),r=e(32264),g=e(40845),i=e(76888),l=e(57571),d=e(27673),c=e(39419);const h=({isLoading:ae,children:k,className:se})=>{let te=se?(0,t.jsx)("div",{className:se,children:k}):k;return(0,t.jsx)(t.Fragment,{children:ae?(0,t.jsx)(c.A,{}):te})};var o=e(13773),m=e(17172),u=e(94753),p=e(29158),f=e(88575),y=e(10354);const x=({value:ae,onEdit:k})=>{const se=(0,g.of)(v),[te,ne]=(0,s.useState)(ae),[le,re]=(0,s.useState)(!1),[de,oe]=(0,s.useState)(!1),[J,ce]=(0,s.useState)();(0,s.useEffect)(()=>{ne(ae)},[ae]);const pe=(0,s.useCallback)(async xe=>{const fe=xe.currentTarget.value;if(!fe)ce("Please enter a title");else if(fe===ae)ce(void 0),re(!1);else{oe(!0);try{await k(fe),ce(void 0),re(!1)}catch(Ee){(0,m.NF)(Ee)?ce(Ee.data.message):Ee instanceof Error&&ce(Ee.message)}oe(!1)}},[k,ae]);return le?(0,t.jsx)("div",{className:se.inputContainer,children:(0,t.jsx)(f.D,{className:se.field,loading:de,invalid:!!J,error:J,children:(0,t.jsx)(y.p,{className:se.input,defaultValue:te,onKeyDown:xe=>{xe.key==="Enter"&&pe(xe)},autoFocus:!0,onBlur:pe,onChange:xe=>ne(xe.currentTarget.value),onFocus:()=>re(!0)})})}):(0,t.jsx)("div",{className:se.textContainer,children:(0,t.jsxs)("div",{className:se.textWrapper,children:[(0,t.jsx)(u.E,{element:"h1",truncate:!0,children:te}),(0,t.jsx)(p.K,{name:"pen",size:"lg",tooltip:"Edit title",onClick:()=>re(!0)})]})})};x.displayName="EditableTitle";const v=ae=>({textContainer:(0,n.css)({minWidth:0}),field:(0,n.css)({flex:1,left:`calc(-${ae.spacing(1)} - 1px)`,position:"relative",marginBottom:0}),input:(0,n.css)({input:{...ae.typography.h1}}),inputContainer:(0,n.css)({display:"flex",flex:1}),textWrapper:(0,n.css)({alignItems:"center",display:"flex",gap:ae.spacing(1)})});function P({navItem:ae,renderTitle:k,actions:se,info:te,subTitle:ne,onEditTitle:le}){const re=(0,g.of)(E),de=ne??ae.subTitle,oe=le?(0,t.jsx)(x,{value:ae.text,onEdit:le}):(0,t.jsxs)("div",{className:re.title,children:[ae.img&&(0,t.jsx)("img",{className:re.img,src:ae.img,alt:`logo for ${ae.text}`}),k?k(ae.text):(0,t.jsx)("h1",{children:ae.text})]});return(0,t.jsxs)("div",{className:re.pageHeader,children:[(0,t.jsxs)("div",{className:re.topRow,children:[(0,t.jsxs)("div",{className:re.titleInfoContainer,children:[oe,te&&(0,t.jsx)(o.Q,{info:te})]}),(0,t.jsx)("div",{className:re.actions,children:se})]}),de&&(0,t.jsx)("div",{className:re.subTitle,children:de})]})}const E=ae=>({topRow:(0,n.css)({alignItems:"flex-start",display:"flex",flexDirection:"row",flexWrap:"wrap",gap:ae.spacing(1,3)}),title:(0,n.css)({display:"flex",flexDirection:"row",maxWidth:"100%",flex:1,h1:{marginBottom:0}}),actions:(0,n.css)({display:"flex",flexDirection:"row",gap:ae.spacing(1)}),titleInfoContainer:(0,n.css)({display:"flex",label:"title-info-container",flex:1,flexWrap:"wrap",gap:ae.spacing(1,4),justifyContent:"space-between",maxWidth:"100%",minWidth:"200px"}),pageHeader:(0,n.css)({label:"page-header",display:"flex",flexDirection:"column",gap:ae.spacing(1),marginBottom:ae.spacing(2)}),subTitle:(0,n.css)({position:"relative",color:ae.colors.text.secondary}),img:(0,n.css)({width:"32px",height:"32px",marginRight:ae.spacing(2)})});var D=e(63021),C=e(8887),b=e(40675);function T({navItem:ae}){const k=(0,g.of)(S);return(0,t.jsx)("div",{className:k.tabsWrapper,children:(0,t.jsx)(D.U,{children:ae.children.map((se,te)=>{const ne=se.icon?(0,C.Uo)(se.icon):void 0;return!se.hideFromTabs&&(0,t.jsx)(b.o,{label:se.text,active:se.active,icon:ne,counter:se.tabCounter,href:se.url,suffix:se.tabSuffix,onChangeTab:se.onClick},`${se.url}-${te}`)})})})}const S=ae=>({tabsWrapper:(0,n.css)({paddingBottom:ae.spacing(3)})});var O=e(13390),M=e(23172),I=e(67061),L=e(32209);function B({children:ae}){const k=(0,M.k)(),{chrome:se}=(0,i.Il)(),te=se.useState(),ne=!te.chromeless&&te.megaMenuDocked&&te.megaMenuOpen,le=(0,g.of)(j,k??0,ne);return(0,t.jsx)("div",{"data-testid":O.X.NavToolbar.container,className:le.pageToolbar,children:(0,t.jsx)(I.B,{alignItems:"center",justifyContent:"flex-end",flex:1,wrap:"nowrap",minWidth:0,children:ae})})}const j=(ae,k,se)=>({pageToolbar:(0,n.css)({alignItems:"center",backgroundColor:ae.colors.background.primary,borderBottom:`1px solid ${ae.colors.border.weak}`,display:"flex",height:l.l,left:se?L.J:0,padding:ae.spacing(0,1,0,2),position:"fixed",top:k,right:0,zIndex:ae.zIndex.navbarFixed})});var A=e(25508),K=e(17422),W=e(99140),U=e(31678);function F(ae,k){if(k)return k;if(ae&&W.M_)return(0,U.useSelector)((0,A.Mz)(V,se=>(0,K.tc)(se,ae??"home")))}function V(ae){return ae.navIndex}var w=e(28215),z=e(19361),N=e(3984);function H(ae,k){const se=(0,U.useSelector)(te=>te.navIndex)?.[w.Id];(0,s.useEffect)(()=>{const te=(ae?.node!==ae?.main?ae?.node:ae?.main)??{text:"Grafana"},ne=(0,N.Z)(te,k,se).map(le=>le.text).reverse();ne[ne.length-1]=z.M.AppTitle,document.title=ne.join(" - ")},[se,ae,k])}const Q=(0,s.createContext)(void 0);function X(){const ae=(0,s.useContext)(Q);if(!ae)throw new Error("No PageContext found");return ae}function ee(ae){const{setToolbar:k}=X();(0,s.useEffect)(()=>(k(ae),()=>k(void 0)),[k,ae])}const Z=({navId:ae,navModel:k,pageNav:se,renderTitle:te,onEditTitle:ne,actions:le,subTitle:re,children:de,className:oe,toolbar:J,info:ce,layout:pe=a.k.Standard,onSetScrollRef:xe,...fe})=>{const Ee=r.$.featureToggles.singleTopNav,[Se,ye]=(0,s.useState)(J),Ve=(0,g.of)(q,!!(Ee&&Se)),Me=F(ae,k),{chrome:Ce}=(0,i.Il)();H(Me,se);const Ue=se??Me?.node;return(0,s.useLayoutEffect)(()=>{Me&&Ce.update({sectionNav:Me,pageNav:se,layout:pe})},[Me,se,Ce,pe]),(0,t.jsx)(Q.Provider,{value:{setToolbar:ye},children:(0,t.jsxs)("div",{className:(0,n.cx)(Ve.wrapper,oe),...fe,children:[Ee&&Se&&(0,t.jsx)(B,{children:Se}),pe===a.k.Standard&&(0,t.jsx)(d.A,{divId:"page-scrollbar",onSetScrollRef:xe,children:(0,t.jsxs)("div",{className:Ve.pageInner,children:[Ue&&(0,t.jsx)(P,{actions:le,onEditTitle:ne,navItem:Ue,renderTitle:te,info:ce,subTitle:re}),se&&se.children&&(0,t.jsx)(T,{navItem:se}),(0,t.jsx)("div",{className:Ve.pageContent,children:de})]})}),pe===a.k.Canvas&&(0,t.jsx)(d.A,{divId:"page-scrollbar",onSetScrollRef:xe,children:(0,t.jsx)("div",{className:Ve.canvasContent,children:de})}),pe===a.k.Custom&&de]})})};Z.Contents=h;const q=(ae,k)=>({wrapper:(0,n.css)({label:"page-wrapper",display:"flex",flex:"1 1 0",flexDirection:"column",marginTop:k?l.l:0,position:"relative"}),pageContent:(0,n.css)({label:"page-content",flexGrow:1}),primaryBg:(0,n.css)({background:ae.colors.background.primary}),pageInner:(0,n.css)({label:"page-inner",padding:ae.spacing(2),borderBottom:"none",background:ae.colors.background.primary,display:"flex",flexDirection:"column",flexGrow:1,margin:ae.spacing(0,0,0,0),[ae.breakpoints.up("md")]:{padding:ae.spacing(4)}}),canvasContent:(0,n.css)({label:"canvas-content",display:"flex",flexDirection:"column",padding:ae.spacing(2),flexBasis:"100%",flexGrow:1})})},13773:(G,R,e)=>{"use strict";e.d(R,{Q:()=>r});var t=e(74848),n=e(32196),s=e(96540),a=e(40845);function r({info:i}){const l=(0,a.of)(g);return(0,t.jsx)("div",{className:l.container,children:i.map((d,c)=>(0,t.jsxs)(s.Fragment,{children:[(0,t.jsxs)("div",{className:l.infoItem,children:[(0,t.jsx)("div",{className:l.label,children:d.label}),d.value]}),c+1<i.length&&(0,t.jsx)("div",{"data-testid":"page-info-separator",className:l.separator})]},c))})}const g=i=>({container:(0,n.css)({display:"flex",flexDirection:"row",gap:i.spacing(1.5),overflow:"auto"}),infoItem:(0,n.css)({...i.typography.bodySmall,display:"flex",flexDirection:"column",gap:i.spacing(.5)}),label:(0,n.css)({color:i.colors.text.secondary}),separator:(0,n.css)({borderLeft:`1px solid ${i.colors.border.weak}`})})},39419:(G,R,e)=>{"use strict";e.d(R,{A:()=>r});var t=e(74848),n=e(90613),s=e(39558);const r=({pageName:g=""})=>{const i=`Loading ${g}...`;return(0,t.jsx)(n.a,{display:"flex",alignItems:"center",direction:"column",justifyContent:"center",paddingTop:10,children:(0,t.jsx)(s._,{text:i})})}},7392:(G,R,e)=>{"use strict";e.d(R,{L:()=>i});var t=e(74848),n=e(32196),s=e(13544),a=e(40845),r=e(69529),g=e(72109);function i({entity:d="Page"}){const c=(0,a.of)(l);return(0,t.jsx)("div",{className:c.container,"data-testid":s.Tp.components.EntityNotFound.container,children:(0,t.jsxs)(r.p,{message:`${d} not found`,variant:"not-found",children:["We're looking but can't seem to find this ",d.toLowerCase(),". Try returning"," ",(0,t.jsx)(g.Y,{href:"/",children:"home"})," or seeking help on the"," ",(0,t.jsx)(g.Y,{href:"https://community.grafana.com",external:!0,children:"community site."})]})})}function l(d){return{container:(0,n.css)({padding:d.spacing(8,2,2,2)})}}},64915:(G,R,e)=>{"use strict";e.d(R,{H:()=>r});var t=e(74848),n=e(64388),s=e(21780),a=e(7392);function r(){return(0,t.jsx)(s.YW,{navId:"home",layout:n.k.Canvas,pageNav:{text:"Page not found"},children:(0,t.jsx)(a.L,{entity:"Page"})})}},68313:(G,R,e)=>{"use strict";e.d(R,{$:()=>c});var t=e(74848),n=e(32196),s=e(96540),a=e(32264),r=e(40845),g=e(55852),i=e(90182),l=e(14578),d=e(17706);const c=({onChange:o,maxMenuHeight:m,isWidget:u=!1})=>{const p=()=>a.$.featureToggles.vizAndWidgetSplit?u?(0,d.nr)():(0,d.if)():(0,d.A4)(),f=(0,s.useMemo)(p,[u]),y=(0,s.useMemo)(()=>f.map(C=>({label:C.name,imgUrl:C.info.logos.small,value:C})).sort((C,b)=>C.label?.localeCompare(b.label)),[f]),[x,v]=(0,s.useState)([]),P=(0,s.useCallback)(C=>{const b=C.filter(T=>T.value).map(T=>T.value);o(b),v(C)},[o]),E=(0,r.of)(h),D={defaultOptions:!0,getOptionLabel:C=>C.label,getOptionValue:C=>C.value,noOptionsMessage:"No Panel types found",placeholder:"Filter by type",maxMenuHeight:m,options:y,value:x,onChange:P};return(0,t.jsxs)("div",{className:E.container,children:[x.length>0&&(0,t.jsx)(g.$n,{size:"xs",icon:"trash-alt",fill:"text",className:E.clear,onClick:()=>P([]),"aria-label":"Clear types",children:"Clear types"}),(0,t.jsx)(i.KF,{...D,prefix:(0,t.jsx)(l.I,{name:"filter"}),"aria-label":"Panel Type filter"})]})};function h(o){return{container:(0,n.css)`
      label: container;
      position: relative;
      min-width: 180px;
      flex-grow: 1;
    `,clear:(0,n.css)`
      label: clear;
      font-size: ${o.spacing(1.5)};
      position: absolute;
      top: -${o.spacing(4.5)};
      right: 0;
    `}}},22214:(G,R,e)=>{"use strict";e.d(R,{j:()=>g});var t=e(74848),n=e(32196),s=e(96540),a=e(36663),r=e(40845);const g=s.memo(s.forwardRef(({className:d,children:c,markdown:h,styleOverrides:o,onRemove:m,...u},p)=>{const f=(0,r.of)(y=>l(y,o?.borderTop));return(0,t.jsxs)("div",{className:(0,n.cx)(f.wrapper,d),...u,ref:p,children:[h&&i(h),c]})}));function i(d){const c=(0,a.G)(d);return(0,t.jsx)("div",{className:"markdown-html",dangerouslySetInnerHTML:{__html:c}})}g.displayName="OperationRowHelp";const l=(d,c)=>{const h=d.shape.radius.default,o=d.colors.background.secondary;return{wrapper:(0,n.css)`
      padding: ${d.spacing(2)};
      border: 2px solid ${o};
      border-top: ${c?c+o:"none"};
      border-radius: 0 0 ${h} ${h};
      position: relative;
      top: -4px;
    `}}},10343:(G,R,e)=>{"use strict";e.d(R,{A:()=>l,q:()=>i});var t=e(74848),n=e(32196),s=e(13544),a=e(40845),r=e(29158);function g(c){const h=(0,a.of)(d);return(0,t.jsx)("div",{className:(0,n.cx)(h.icon,"active"in c&&c.active&&h.active),children:(0,t.jsx)(r.K,{name:c.icon,tooltip:c.title,className:h.icon,disabled:!!c.disabled,onClick:c.onClick,type:"button","data-testid":c.dataTestId??s.Tp.components.QueryEditorRow.actionButton(c.title),..."active"in c&&{"aria-pressed":c.active}})})}function i(c){return(0,t.jsx)(g,{...c})}const l=c=>(0,t.jsx)(g,{...c}),d=c=>({icon:(0,n.css)({display:"flex",position:"relative",color:c.colors.text.secondary}),active:(0,n.css)({"&:before":{display:"block",content:'" "',position:"absolute",left:-1,right:2,height:3,borderRadius:c.shape.radius.default,bottom:-8,backgroundImage:c.colors.gradients.brandHorizontal}})})},7788:(G,R,e)=>{"use strict";e.d(R,{u:()=>p});var t=e(74848),n=e(32196),s=e(91076),a=e(96540),r=e(22589),g=e(14110),i=e(40845),l=e(67892),d=e(29158),c=e(67061),h=e(14578),o=e(8484);const m=({actionsElement:y,disabled:x,draggable:v,collapsable:P=!0,dragHandleProps:E,headerElement:D,isContentVisible:C,onRowToggle:b,reportDragMousePosition:T,title:S,id:O,expanderMessages:M})=>{const I=(0,i.of)(u);let L=C?(0,o.t)("query-operation.header.collapse-row","Collapse query row"):(0,o.t)("query-operation.header.expand-row","Expand query row");M!==void 0&&C?L=M.close:M!==void 0&&(L=M?.open);const B=(0,o.t)("query-operation.header.drag-and-drop","Drag and drop to reorder");return(0,t.jsxs)("div",{className:I.header,children:[(0,t.jsxs)("div",{className:I.column,children:[P&&(0,t.jsx)(d.K,{name:C?"angle-down":"angle-right",tooltip:L,className:I.collapseIcon,onClick:b,"aria-expanded":C,"aria-controls":O}),S&&(0,t.jsx)("div",{className:I.titleWrapper,onClick:b,"aria-label":"Query operation row title",children:(0,t.jsx)("div",{className:(0,n.cx)(I.title,x&&I.disabled),children:S})}),D]}),(0,t.jsxs)(c.B,{gap:1,alignItems:"center",children:[y,v&&(0,t.jsx)("div",{onMouseMove:T,...E,children:(0,t.jsx)(h.I,{title:B,name:"draggabledots",size:"lg",className:I.dragIcon})})]})]})},u=y=>({header:(0,n.css)`
    label: Header;
    padding: ${y.spacing(.5,.5)};
    border-radius: ${y.shape.radius.default};
    background: ${y.colors.background.secondary};
    min-height: ${y.spacing(4)};
    display: grid;
    grid-template-columns: minmax(100px, max-content) min-content;
    align-items: center;
    justify-content: space-between;
    white-space: nowrap;

    &:focus {
      outline: none;
    }
  `,column:(0,n.css)`
    label: Column;
    display: flex;
    align-items: center;
    overflow: hidden;
  `,dragIcon:(0,n.css)`
    cursor: grab;
    color: ${y.colors.text.disabled};
    margin: ${y.spacing(0,.5)};
    &:hover {
      color: ${y.colors.text};
    }
  `,collapseIcon:(0,n.css)`
    margin-left: ${y.spacing(.5)};
    color: ${y.colors.text.disabled};
    }
  `,titleWrapper:(0,n.css)`
    display: flex;
    align-items: center;
    flex-grow: 1;
    cursor: pointer;
    overflow: hidden;
    margin-right: ${y.spacing(.5)};
  `,title:(0,n.css)`
    font-weight: ${y.typography.fontWeightBold};
    color: ${y.colors.text.link};
    margin-left: ${y.spacing(.5)};
    overflow: hidden;
    text-overflow: ellipsis;
  `,disabled:(0,n.css)`
    color: ${y.colors.text.disabled};
  `});m.displayName="QueryOperationRowHeader";function p({children:y,actions:x,title:v,headerElement:P,onClose:E,onOpen:D,isOpen:C,disabled:b,draggable:T,collapsable:S,index:O,id:M,expanderMessages:I}){const[L,B]=(0,a.useState)(C!==void 0?C:!0),j=(0,i.of)(f),A=(0,a.useCallback)(()=>{B(!L)},[L,B]);(0,a.useEffect)(()=>{typeof C=="boolean"&&B(C)},[C]);const K=(0,a.useCallback)(V=>{if(V.defaultPrevented){const w=V.currentTarget.getBoundingClientRect(),z=V.clientX-w.left,N=V.clientY-w.top;(0,g.rR)("query_row_reorder_drag_position",{x:z/w.width,y:N/w.height,width:w.width,height:w.height})}},[]);(0,r.A)(()=>{L?D&&D():E&&E()},[L]);const W={isOpen:L,onOpen:()=>{B(!0)},onClose:()=>{B(!1)}},U=x&&l.renderOrCallToRender(x,W),F=P&&l.renderOrCallToRender(P,W);return T?(0,t.jsx)(s.sx,{draggableId:M,index:O,children:V=>(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{ref:V.innerRef,className:j.wrapper,...V.draggableProps,children:[(0,t.jsx)("div",{children:(0,t.jsx)(m,{id:M,actionsElement:U,disabled:b,draggable:!0,collapsable:S,dragHandleProps:V.dragHandleProps,headerElement:F,isContentVisible:L,onRowToggle:A,reportDragMousePosition:K,title:v,expanderMessages:I})}),L&&(0,t.jsx)("div",{className:j.content,children:y})]})})}):(0,t.jsxs)("div",{className:j.wrapper,children:[(0,t.jsx)(m,{id:M,actionsElement:U,disabled:b,draggable:!1,collapsable:S,headerElement:F,isContentVisible:L,onRowToggle:A,reportDragMousePosition:K,title:v,expanderMessages:I}),L&&(0,t.jsx)("div",{className:j.content,children:y})]})}const f=y=>({wrapper:(0,n.css)`
      margin-bottom: ${y.spacing(2)};
    `,content:(0,n.css)`
      margin-top: ${y.spacing(.5)};
      margin-left: ${y.spacing(3)};
    `});p.displayName="QueryOperationRow"},47694:(G,R,e)=>{"use strict";e.d(R,{y:()=>c});var t=e(74848),n=e(8867),s=e(80997),a=e(62938);const r=2,g=5,i=u=>{const p=u.match(new RegExp('<style type="text/css">([\\s\\S]*?)<\\/style>'));return p?p[0]:null},l=u=>u.match(new RegExp(`<svg.*id\\s*=\\s*(['"])(.*?)\\1`))?.[r],d=u=>{let p=l(u);if(!p){p=`x${(0,a.A)()}`;const y=u.indexOf("<svg")+g;u=u.substring(0,y)+`id="${p}" `+u.substring(y)}let f=i(u);if(f){let y=f.replace(/(#(.*?))?\./g,`#${p} .`);u=u.replace(f,y)}return u},c=u=>{const{cleanStyle:p,...f}=u;return(0,t.jsx)(n.default,{...f,cacheRequests:!0,preProcessor:p?m:o})};let h=new Map;function o(u){let p=h.get(u);return p||(p=s.sQ.sanitizeSVGContent(u),h.set(u,p)),p}function m(u){let p=h.get(u);return p||(p=s.sQ.sanitizeSVGContent(u),p.indexOf('<style type="text/css">')>-1&&(p=d(p)),h.set(u,p)),p}},59429:(G,R,e)=>{"use strict";e.d(R,{b:()=>h});var t=e(74848),n=e(76459),s=e.n(n),a=e(96540),r=e(90182),g=e(27677),i=e(28676);const l=(o="Dashboards",m)=>`${o}/${m}`;async function d(o=""){return g.IB.search({type:"dash-db",query:o,limit:100}).then(m=>m.map(u=>({value:{uid:u.uid,title:u.title,folderTitle:u.folderTitle,folderUid:u.folderUid},label:l(u?.folderTitle,u.title)})))}const c=s()(d,250,{leading:!0}),h=({value:o,onChange:m,placeholder:u="Select dashboard",noOptionsMessage:p="No dashboards found",...f})=>{const[y,x]=(0,a.useState)();(0,a.useEffect)(()=>{!o||o===y?.value?.uid||(async()=>{const P=await(0,i.n)().getDashboardDTO(o);P.dashboard&&x({value:{uid:P.dashboard.uid,title:P.dashboard.title,folderTitle:P.meta.folderTitle,folderUid:P.meta.folderUid},label:l(P.meta?.folderTitle,P.dashboard.title)})})()},[o]);const v=(0,a.useCallback)(P=>{x(P),m?.(P?.value)},[m,x]);return(0,t.jsx)(r.DW,{loadOptions:c,onChange:v,placeholder:u,noOptionsMessage:p,value:y,defaultOptions:!0,...f})}},36607:(G,R,e)=>{"use strict";e.d(R,{d:()=>ne});var t=e(74848),n=e(96540),s=e(32264),a=e(32196),r=e(34743),g=e(83505),i=e(46885),l=e(76459),d=e.n(l),c=e(40845),h=e(10354),o=e(14578),m=e(42418),u=e(57514),p=e(8484),f=e(55314),y=e(65812),x=e(40957),v=e(31678),P=e(70255),E=e(91793),D=e(10022),C=e(29158),b=e(94753),T=e(18759),S=e(37690);const O=40,M="md",I=(re,de)=>`${re}-${de||"root"}`;function L({items:re,focusedItemIndex:de,foldersAreOpenable:oe,idPrefix:J,selectedFolder:ce,onFolderExpand:pe,onFolderSelect:xe,isItemLoaded:fe,requestLoadMore:Ee}){const Se=(0,n.useRef)(null),ye=(0,c.of)(A),Ve=(0,n.useMemo)(()=>({items:re,focusedItemIndex:de,foldersAreOpenable:oe,selectedFolder:ce,onFolderExpand:pe,onFolderSelect:xe,idPrefix:J}),[re,de,oe,ce,pe,xe,J]),Me=(0,n.useCallback)(Ue=>fe(Ue),[fe]),Ce=(0,n.useCallback)((Ue,Ae)=>{const{parentUID:we}=re[Ue];Ee(we)},[Ee,re]);return(0,t.jsx)("div",{className:ye.table,role:"tree",children:re.length>0?(0,t.jsx)(D.A,{ref:Se,itemCount:re.length,isItemLoaded:Me,loadMoreItems:Ce,children:({onItemsRendered:Ue,ref:Ae})=>(0,t.jsx)(E.Y1,{ref:Ae,height:O*Math.min(6.5,re.length),width:"100%",itemData:Ve,itemSize:O,itemCount:re.length,onItemsRendered:Ue,children:j})}):(0,t.jsx)("div",{className:ye.emptyMessage,children:(0,t.jsx)(p.x6,{i18nKey:"browse-dashboards.folder-picker.empty-message",children:"No folders found"})})})}const B=[100,200,130,160,150];function j({index:re,style:de,data:oe}){const{items:J,focusedItemIndex:ce,foldersAreOpenable:pe,selectedFolder:xe,onFolderExpand:fe,onFolderSelect:Ee,idPrefix:Se}=oe,{item:ye,isOpen:Ve,level:Me,parentUID:Ce}=J[re],Ue=(0,n.useRef)(null),Ae=(0,n.useId)(),we=(0,v.useSelector)(S.ku),We=(0,v.useSelector)(S.Am),_e=(ye.uid?We[ye.uid]:we)?.items??[];let at=[];ye.uid&&(at=(Ce?We[Ce]:we)?.items??[]);const ut=(0,c.of)(A),Tt=(0,n.useCallback)(ge=>{ge.preventDefault(),ge.stopPropagation(),ye.uid&&fe(ye.uid,!Ve)},[ye.uid,Ve,fe]),It=(0,n.useCallback)(()=>{ye.kind==="folder"&&Ee(ye)},[ye,Ee]);return ye.kind==="ui"&&ye.uiKind==="pagination-placeholder"?(0,t.jsxs)("span",{style:de,className:ut.row,children:[(0,t.jsx)(T.T,{level:Me,spacing:2}),(0,t.jsx)(P.A,{width:B[re%B.length]})]}):ye.kind!=="folder"?null:(0,t.jsx)("div",{ref:Ue,style:de,className:(0,a.cx)(ut.row,{[ut.rowFocused]:re===ce,[ut.rowSelected]:ye.uid===xe}),tabIndex:-1,onClick:It,"aria-expanded":Ve,"aria-selected":ye.uid===xe,"aria-labelledby":Ae,"aria-level":Me+1,role:"treeitem","aria-owns":_e.length>0?_e.map(ge=>I(Se,ge.uid)).join(" "):void 0,"aria-setsize":_e.length,"aria-posinset":at.findIndex(ge=>ge.uid===ye.uid)+1,id:I(Se,ye.uid),children:(0,t.jsxs)("div",{className:ut.rowBody,children:[(0,t.jsx)(T.T,{level:Me,spacing:2}),pe?(0,t.jsx)(C.K,{size:M,onMouseDown:Tt,tabIndex:-1,"aria-label":Ve?`Collapse folder ${ye.title}`:`Expand folder ${ye.title}`,name:Ve?"angle-down":"angle-right"}):(0,t.jsx)("span",{className:ut.folderButtonSpacer}),(0,t.jsx)("label",{className:ut.label,id:Ae,children:(0,t.jsx)(b.E,{truncate:!0,children:ye.title})})]})})}const A=re=>{const de=(0,a.css)({height:O,display:"flex",position:"relative",alignItems:"center",flexGrow:1,gap:re.spacing(.5),overflow:"hidden",padding:re.spacing(0,1)});return{table:(0,a.css)({background:re.components.input.background}),emptyMessage:(0,a.css)({padding:re.spacing(1),textAlign:"center",width:"100%"}),folderButtonSpacer:(0,a.css)({paddingLeft:re.spacing(.5)}),row:(0,a.css)({display:"flex",position:"relative",alignItems:"center",":not(:first-child)":{borderTop:`solid 1px ${re.colors.border.weak}`}}),rowFocused:(0,a.css)({backgroundColor:re.colors.background.secondary}),rowSelected:(0,a.css)({"&::before":{display:"block",content:'""',position:"absolute",left:0,bottom:0,top:0,width:4,borderRadius:re.shape.radius.default,backgroundImage:re.colors.gradients.brandVertical}}),rowBody:de,label:(0,a.css)({lineHeight:O+"px",flexGrow:1,minWidth:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap","&:hover":{textDecoration:"underline",cursor:"pointer"}})}};var K=e(16797);function W({handleClearSelection:re,isLoading:de,invalid:oe,label:J,...ce},pe){const xe=(0,c.$j)(),fe=F(xe,oe),Ee=Se=>{(Se.key==="Enter"||Se.key===" ")&&re?.(Se)};return(0,t.jsx)("div",{className:fe.wrapper,children:(0,t.jsxs)("div",{className:fe.inputWrapper,children:[J?(0,t.jsx)("div",{className:fe.prefix,children:(0,t.jsx)(o.I,{name:"folder"})}):void 0,(0,t.jsxs)("button",{type:"button",className:(0,a.cx)(fe.fakeInput,J?fe.hasPrefix:void 0),...ce,ref:pe,children:[de?(0,t.jsx)(P.A,{width:100}):J?(0,t.jsx)(b.E,{truncate:!0,children:J}):(0,t.jsx)(b.E,{truncate:!0,color:"secondary",children:(0,t.jsx)(p.x6,{i18nKey:"browse-dashboards.folder-picker.button-label",children:"Select folder"})}),!de&&re&&(0,t.jsx)(o.I,{role:"button",tabIndex:0,"aria-label":(0,p.t)("browse-dashboards.folder-picker.clear-selection","Clear selection"),className:fe.clearIcon,name:"times",onClick:re,onKeyDown:Ee})]}),(0,t.jsx)("div",{className:fe.suffix,children:(0,t.jsx)(o.I,{name:"angle-down"})})]})})}const U=(0,n.forwardRef)(W),F=(re,de=!1)=>{const oe=(0,h.n)({theme:re,invalid:de});return{wrapper:oe.wrapper,inputWrapper:oe.inputWrapper,prefix:(0,a.css)([oe.prefix,{pointerEvents:"none",color:re.colors.text.primary}]),suffix:(0,a.css)([oe.suffix,{pointerEvents:"none"}]),fakeInput:(0,a.css)([oe.input,{textAlign:"left",letterSpacing:"normal","&:focus":{outline:"unset",boxShadow:"unset"},"&:focus-visible":(0,a.css)`
          ${(0,K.focusCss)(re)}
        `,alignItems:"center",display:"flex",flexWrap:"nowrap",justifyContent:"space-between",paddingRight:28}]),hasPrefix:(0,a.css)({paddingLeft:28}),clearIcon:(0,a.css)({color:re.colors.text.secondary,cursor:"pointer","&:hover":{color:re.colors.text.primary},"&:focus:not(:focus-visible)":(0,K.getMouseFocusStyles)(re),"&:focus-visible":(0,K.getFocusStyles)(re)})}};var V=e(25508),w=e(92955),z=e(93519),N=e(64756);const H=(0,V.Mz)([re=>re,(re,de)=>de],(re,de)=>{const oe=new Set,J=[],ce={};let pe=!1;for(const xe of de){if(oe.has(xe.requestId))continue;const fe=f.cU.endpoints.listFolders.select({parentUid:xe.arg.parentUid,page:xe.arg.page,limit:xe.arg.limit,permission:xe.arg.permission})(re);fe.status==="pending"&&(pe=!0);const Ee=fe.originalArgs?.parentUid;Ee?(ce[Ee]||(ce[Ee]=[]),ce[Ee].push(fe)):J.push(fe)}return{isLoading:pe,rootPages:J,pagesByParent:ce}});function Q(re){const de=re.at(-1),oe=de?.originalArgs?.page;return de?.data?[de.data.length<de.originalArgs.limit,oe]:[!1,oe]}function X(re,de,oe){const J=(0,N.wA)(),ce=(0,n.useRef)([]),pe=(0,N.d4)(Ee=>H(Ee,ce.current)),xe=(0,n.useCallback)(Ee=>{const Se=Ee?pe.pagesByParent[Ee]:pe.rootPages,[ye,Ve]=Q(Se??[]);if(ye)return;const Me={parentUid:Ee,page:(Ve??0)+1,limit:w.md,permission:oe},Ce=J(f.cU.endpoints.listFolders.initiate(Me));ce.current=ce.current.concat([Ce])},[pe,J,oe]);return(0,n.useEffect)(()=>()=>{for(const Ee of ce.current)Ee.unsubscribe()},[]),{items:(0,n.useMemo)(()=>{if(!re)return[];function Ee(ye,Ve,Me){const Ce=Ve.flatMap(Ae=>(Ae.data??[]).flatMap(We=>{const _e=de[We.uid],at={isOpen:!!_e,level:Me,item:{kind:"folder",title:We.title,uid:We.uid}},ut=_e&&pe.pagesByParent[We.uid];if(ut){const Tt=Ee(We.uid,ut,Me+1);return[at,...Tt]}return at})),[Ue]=Q(Ve);return Ue||Ce.push(...(0,z.T)(w.md,ye,Me)),Ce}const Se=Ee(void 0,pe.rootPages,1);return Se.unshift(ee),Se},[pe,re,de]),isLoading:pe.isLoading,requestNextPage:xe}}const ee={isOpen:!0,level:0,item:{kind:"folder",title:"Dashboards",uid:""}};function Z({tree:re,handleCloseOverlay:de,handleFolderSelect:oe,handleFolderExpand:J,idPrefix:ce,search:pe,visible:xe}){const[fe,Ee]=(0,n.useState)(-1),Se=!!s.$.featureToggles.nestedFolders;(0,n.useEffect)(()=>{xe&&Ee(-1)},[xe]),(0,n.useEffect)(()=>{Ee(0)},[pe]),(0,n.useEffect)(()=>{document.getElementById(I(ce,re[fe]?.item.uid))?.scrollIntoView({block:"nearest",inline:"nearest"})},[fe,ce,re]);const ye=(0,n.useCallback)(Ve=>{const Me=Se&&!pe;switch(Ve.key){case"ArrowRight":case"ArrowLeft":Me&&(Ve.preventDefault(),J(re[fe].item.uid,Ve.key==="ArrowRight"));break;case"ArrowUp":fe>0&&(Ve.preventDefault(),Ee(fe-1));break;case"ArrowDown":fe<re.length-1&&(Ve.preventDefault(),Ee(fe+1));break;case"Enter":Ve.preventDefault();const Ce=re[fe].item;Ce.kind==="folder"&&oe(Ce);break;case"Tab":Ve.stopPropagation(),de();break;case"Escape":Ve.stopPropagation(),Ve.preventDefault(),de();break}},[fe,de,J,oe,Se,pe,re]);return{focusedItemIndex:fe,handleKeyDown:ye}}const q=d()(ae,300);async function ae(re,de){const oe=await(0,y.getGrafanaSearcher)().search({query:re,kind:["folder"],limit:100,permission:de}),J=oe.view.map(ce=>(0,x.hI)(ce,oe.view));return{...oe,items:J}}function k({value:re,invalid:de,showRootFolder:oe=!0,clearable:J=!1,excludeUIDs:ce,permission:pe=v.PermissionLevelString.Edit,onChange:xe}){const fe=(0,c.of)(se),Ee=(0,f.kH)(re||f.hT),Se=!!s.$.featureToggles.nestedFolders,[ye,Ve]=(0,n.useState)(""),[Me,Ce]=(0,n.useState)(null),[Ue,Ae]=(0,n.useState)(!1),[we,We]=(0,n.useState)(!1),[_e,at]=(0,n.useState)(!1),[ut,Tt]=(0,n.useState)({}),It=(0,n.useId)(),[ge]=(0,n.useState)(void 0),Ie=(0,n.useRef)(0),ue=!!(_e&&!(ye&&Me)),{items:me,isLoading:Pe,requestNextPage:Ne}=X(ue,ut,pe);(0,n.useEffect)(()=>{if(!ye){Ce(null);return}const Je=Date.now();Ae(!0),q(ye,pe).then(it=>{if(Je>Ie.current){const St=it.view.map(zt=>(0,x.hI)(zt,it.view));Ce({...it,items:St}),Ae(!1),Ie.current=Je}})},[ye,pe]);const Fe=[(0,r.UU)({crossAxis:!1,boundary:document.body})],{context:Be,refs:he,floatingStyles:be,elements:Ke}=(0,g.we)({open:_e,placement:"bottom",onOpenChange:Je=>{Je&&(Ve(""),We(!0)),at(Je)},middleware:Fe,whileElementsMounted:i.ll}),ze=(0,g.kp)(Be),nt=(0,g.s9)(Be),{getReferenceProps:tt,getFloatingProps:ot}=(0,g.bv)([nt,ze]),gt=(0,n.useCallback)(async(Je,it)=>{Tt(St=>({...St,[Je]:it})),it&&!ut[Je]&&Ne(Je)},[Ne,ut]),He=(0,n.useCallback)(Je=>{xe&&xe(Je.uid,Je.title),at(!1)},[xe]),et=(0,n.useCallback)(Je=>{Je.preventDefault(),Je.stopPropagation(),xe&&xe(void 0,void 0)},[xe]),rt=(0,n.useCallback)(()=>at(!1),[at]),ht=(0,n.useCallback)(Je=>{ye||Ne(Je)},[ye,Ne]),ft=(0,n.useMemo)(()=>{let Je=[];return ue?Je=me:Je=Me?.items.map(it=>({isOpen:!1,level:0,item:{kind:"folder",title:it.title,uid:it.uid}}))??[],(!oe||ce?.length)&&(Je=Je.filter(it=>!(!oe&&it===ee||ce?.includes(it.item.uid)))),Je},[me,ce,ue,Me?.items,oe]),De=(0,n.useCallback)(Je=>{const it=ft[Je];if(!it)return!1;const St=it.item;return!(St.kind==="ui"&&St.uiKind==="pagination-placeholder")},[ft]),Te=Pe||Ue,{focusedItemIndex:Oe,handleKeyDown:Ye}=Z({tree:ft,handleCloseOverlay:rt,handleFolderSelect:He,handleFolderExpand:gt,idPrefix:It,search:ye,visible:_e});let Ge=Ee.data?.title;return re===""&&(Ge="Dashboards"),_e?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.p,{ref:he.setReference,autoFocus:!0,prefix:Ge?(0,t.jsx)(o.I,{name:"folder"}):null,placeholder:Ge??(0,p.t)("browse-dashboards.folder-picker.search-placeholder","Search folders"),value:ye,invalid:de,className:fe.search,onChange:Je=>Ve(Je.currentTarget.value),"aria-autocomplete":"list","aria-expanded":!0,"aria-haspopup":!0,"aria-controls":It,"aria-owns":It,"aria-activedescendant":I(It,ft[Oe]?.item.uid),role:"combobox",suffix:(0,t.jsx)(o.I,{name:"search"}),...tt(),onKeyDown:Ye}),(0,t.jsx)("fieldset",{ref:he.setFloating,id:It,className:fe.tableWrapper,style:{...be,width:Ke.domReference?.clientWidth},...ot(),children:ge?(0,t.jsx)(m.F,{className:fe.error,severity:"warning",title:(0,p.t)("browse-dashboards.folder-picker.error-title","Error loading folders"),children:ge.message||ge.toString?.()||(0,p.t)("browse-dashboards.folder-picker.unknown-error","Unknown error")}):(0,t.jsxs)("div",{children:[Te&&(0,t.jsx)("div",{className:fe.loader,children:(0,t.jsx)(u.G,{width:600})}),(0,t.jsx)(L,{items:ft,selectedFolder:re,focusedItemIndex:Oe,onFolderExpand:gt,onFolderSelect:He,idPrefix:It,foldersAreOpenable:Se&&!(ye&&Me),isItemLoaded:De,requestLoadMore:ht})]})})]}):(0,t.jsx)(U,{label:Ge,handleClearSelection:J&&re!==void 0?et:void 0,invalid:de,isLoading:Ee.isLoading,autoFocus:we,ref:he.setReference,"aria-label":Ge?(0,p.t)("browse-dashboards.folder-picker.accessible-label","Select folder: {{ label }} currently selected",{label:Ge}):void 0,...tt()})}const se=re=>({button:(0,a.css)({maxWidth:"100%"}),error:(0,a.css)({marginBottom:0}),tableWrapper:(0,a.css)({boxShadow:re.shadows.z3,position:"relative",zIndex:re.zIndex.portal}),loader:(0,a.css)({position:"absolute",top:0,left:0,right:0,zIndex:re.zIndex.portal+1,overflow:"hidden"}),search:(0,a.css)({input:{cursor:"default"}})});var te=e(85242);function ne(re){const de=s.$.featureToggles.newFolderPicker||s.$.featureToggles.nestedFolders,{initialTitle:oe,dashboardId:J,enableCreateNew:ce,...pe}=re;return de?(0,t.jsx)(k,{...pe}):(0,t.jsx)(le,{...re})}function le({value:re,showRootFolder:de,onChange:oe,initialTitle:J,dashboardId:ce,enableCreateNew:pe,inputId:xe,skipInitialLoad:fe}){const Ee=(0,n.useCallback)(Se=>{oe&&oe(Se.uid,Se.title)},[oe]);return(0,t.jsx)(te.sR,{onChange:Ee,showRoot:de,initialFolderUid:re,initialTitle:J,inputId:xe,skipInitialLoad:fe,dashboardId:ce,enableCreateNew:pe})}},85242:(G,R,e)=>{"use strict";e.d(R,{sR:()=>P});var t=e(74848),n=e(32196),s=e(76459),a=e.n(s),r=e(96540),g=e(16817),i=e(26272),l=e(13544),d=e(14110),c=e(40845),h=e(10354),o=e(90182),m=e(28138),u=e(8484),p=e(16233),f=e(11230),y=e(31678);const x="+ Add new",v="-10";function P(b){const{dashboardId:T,allowEmpty:S,onChange:O,filter:M,enableCreateNew:I,inputId:L,onClear:B,enableReset:j,initialFolderUid:A,initialTitle:K="",permissionLevel:W=y.PermissionLevelString.Edit,rootName:U,showRoot:F=!0,skipInitialLoad:V,searchQueryType:w,customAdd:z,folderWarning:N,invalid:H}=b,Q=U??"Dashboards",[X,ee]=(0,r.useState)(null),[Z,q]=(0,r.useState)(!1),[ae,k]=(0,r.useState)(""),[se,te]=(0,r.useState)(X?.title??""),ne=(0,c.of)(C),le=typeof B=="function",re=(0,r.useCallback)(async Ve=>{const Me=await(0,f.c0)(Ve,W,w),Ue=E(Me,M);return(0,d.rR)("grafana_folder_picker_results_loaded",{results:Ue.length,searchTermLength:Ve.length,enableCreateNew:!!I}),(p.TP.hasPermission(y.AccessControlAction.DashboardsWrite)||p.TP.hasPermission(y.AccessControlAction.DashboardsCreate))&&Q?.toLowerCase().startsWith(Ve.toLowerCase())&&F&&Ue.unshift({label:Q,value:""}),j&&Ve===""&&K!==""&&!Ue.find(we=>we.label===K)&&Ue.unshift({label:K,value:A}),I&&z?[...Ue,{value:v,label:x,title:Ve}]:Ue},[j,A,K,W,Q,F,w,M,I,z]),de=(0,r.useMemo)(()=>a()(re,300,{leading:!0}),[re]),oe=async()=>{const Ve={label:K,value:void 0},Me={label:Q,value:""},Ce=await re("");let Ue=null;A!=null?Ue=Ce.find(Ae=>Ae.value===A)||null:j&&K?Ue=Ve:A&&(Ue=Ce.find(Ae=>Ae.id===A)||null),!Ue&&!S&&(p.TP.isEditor?Ue=Me:!!T?Ue=Ve:Ue=Ce.length>0?Ce[0]:Ve),!Z&&ee(Ue)};(0,r.useEffect)(()=>{X&&X.value!==A&&!Z&&X.value&&X.label&&O({uid:X.value,title:X.label})},[X,A]),(0,g.A)(async()=>{if(V){const Ve=await D({getFolder:f.Ql,folderUid:A,folderName:K});ee(Ve)}await oe()},[V,A,K]),(0,r.useEffect)(()=>{X&&X.id===v&&q(!0)},[X]);const J=(0,r.useCallback)((Ve,Me)=>{if(Ve?.value===v)ee({id:v,title:ae}),te(ae);else{if(Ve||(Ve={value:"",label:Q}),Me.action==="clear"&&B){B();return}ee(Ve),O({uid:Ve.value,title:Ve.label})}},[O,B,Q,ae]),ce=(0,r.useCallback)(async Ve=>{if(N?.warningCondition(Ve))return(0,d.rR)("grafana_folder_picker_folder_created",{status:"failed_condition"}),!1;const Me=await(0,f.vV)({title:Ve});let Ce={value:"",label:"Not created"};return Me.uid?((0,d.rR)("grafana_folder_picker_folder_created",{status:"success"}),m.A.emit(i.r1.alertSuccess,["Folder Created","OK"]),Ce={value:Me.uid,label:Me.title},ee(Me),J(Ce,{action:"create-option",option:Ce})):((0,d.rR)("grafana_folder_picker_folder_created",{status:"failed"}),m.A.emit(i.r1.alertError,["Folder could not be created"])),Ce},[N,J]),pe=(0,r.useCallback)(Ve=>{const Me=!!z?.disallowValues;if(Ve.key==="Enter"&&Me&&!z?.isAllowedValue(se)){Ve.preventDefault();return}switch(Ve.key){case"Enter":{ce(X?.title),q(!1);break}case"Escape":ee({value:"",label:Q}),q(!1)}},[z?.disallowValues,z?.isAllowedValue,se,ce,X?.title,Q]),xe=Ve=>{const Me=Ve.currentTarget.value;te(Me),ee({id:void 0,title:Me})},fe=()=>{ee({value:"",label:Q}),q(!1)},Ee=(Ve,{action:Me})=>{Me==="input-change"&&k(Ce=>Ve),Me==="menu-close"&&k(Ce=>Ve)},Se=()=>N?.warningCondition(se)?(0,t.jsx)(N.warningComponent,{}):null,ye=()=>N?.warningCondition(ae)?(0,t.jsx)(N.warningComponent,{}):null;return Z?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Se,{}),(0,t.jsx)("div",{className:ne.newFolder,children:"Press enter to create the new folder."}),(0,t.jsx)(h.p,{width:30,autoFocus:!0,value:se,onChange:xe,onKeyDown:pe,placeholder:"Press enter to confirm new folder.",onBlur:fe})]}):(0,t.jsxs)("div",{"data-testid":l.Tp.components.FolderPicker.containerV2,children:[(0,t.jsx)(ye,{}),(0,t.jsx)(o.gZ,{inputId:L,"data-testid":l.Tp.components.FolderPicker.input,loadingMessage:(0,u.t)("folder-picker.loading","Loading folders..."),defaultOptions:!0,defaultValue:X,inputValue:ae,onInputChange:Ee,value:X,allowCustomValue:I&&!z,loadOptions:de,onChange:J,onCreateOption:ce,invalid:H,isClearable:le})]})}function E(b,T){return(T?T(b):b).map(O=>({label:O.title,value:O.uid}))}async function D({folderName:b,folderUid:T,getFolder:S}){if(T==null)throw new Error("folderUid is not found.");return b?{label:b,value:T}:{label:(await S(T)).title,value:T}}const C=b=>({newFolder:(0,n.css)({color:b.colors.warning.main,fontSize:b.typography.bodySmall.fontSize,paddingBottom:b.spacing(1)})})},73725:(G,R,e)=>{"use strict";e.d(R,{r:()=>l});var t=e(74848),n=e(16817),s=e(90182),a=e(14578),r=e(53477),g=e(65812);const i=()=>(0,g.getGrafanaSearcher)().getSortOptions();function l({onChange:d,value:c,placeholder:h,filter:o,getSortOptions:m,isClearable:u}){const p=(0,n.A)(async()=>{const y=await(m??i)();return o?y.filter(x=>o.includes(x.value)):y},[m,o]);if(p.loading)return null;const f=!!(c?.includes("desc")||c?.startsWith("-"));return(0,t.jsx)(s.l6,{width:28,onChange:d,value:p.value?.find(y=>y.value===c)??null,options:p.value,"aria-label":"Sort",placeholder:h??`Sort (Default ${r.r4.label})`,prefix:(0,t.jsx)(a.I,{name:f?"sort-amount-down":"sort-amount-up"}),isClearable:u},c)}},98742:(G,R,e)=>{"use strict";e.d(R,{e:()=>i});var t=e(74848),n=e(2543),s=e.n(n),a=e(96540),r=e(17172),g=e(90182);class i extends a.Component{constructor(d){super(d),this.state={isLoading:!1},this.search=this.search.bind(this),this.debouncedSearch=(0,n.debounce)(this.search,300,{leading:!0,trailing:!0})}componentDidMount(){const{teamId:d}=this.props;d&&(0,r.AI)().get(`/api/teams/${d}`).then(c=>{this.setState({value:{value:c,label:c.name,imgUrl:c.avatarUrl}})})}search(d){return this.setState({isLoading:!0}),(0,n.isNil)(d)&&(d=""),(0,r.AI)().get(`/api/teams/search?perpage=100&page=1&query=${d}`).then(c=>{const h=c.teams.map(o=>({value:o,label:o.name,imgUrl:o.avatarUrl}));return this.setState({isLoading:!1}),h})}render(){const{onSelected:d,className:c}=this.props,{isLoading:h,value:o}=this.state;return(0,t.jsx)("div",{className:"user-picker","data-testid":"teamPicker",children:(0,t.jsx)(g.DW,{isLoading:h,defaultOptions:!0,loadOptions:this.debouncedSearch,value:o,onChange:d,className:c,placeholder:"Select a team",noOptionsMessage:"No teams found","aria-label":"Team picker"})})}}},46334:(G,R,e)=>{"use strict";e.d(R,{$:()=>i,E:()=>g});var t=e(74848),n=e(32196),s=e(69613),a=e(40845),r=e(14578);const g=({count:l,label:d,onClick:c,removeIcon:h})=>{const{color:o}=(0,s.MC)(d),m=(0,a.of)(i),u=l!==0&&(0,t.jsx)("span",{style:{marginLeft:"3px"},children:`(${l})`});return(0,t.jsxs)("span",{className:m.badge,style:{backgroundColor:o},children:[h&&(0,t.jsx)(r.I,{onClick:c,name:"times"}),d," ",u]})},i=l=>({badge:(0,n.css)({...l.typography.bodySmall,backgroundColor:l.v1.palette.gray1,borderRadius:l.shape.radius.default,color:l.v1.palette.white,display:"inline-block",height:"20px",lineHeight:"20px",padding:l.spacing(0,.75),verticalAlign:"baseline",whiteSpace:"nowrap","&:hover":{opacity:.85}})})},99818:(G,R,e)=>{"use strict";e.d(R,{$:()=>u});var t=e(74848),n=e(32196),s=e(96540),a=e(28581),r=e(54479),g=e(40845),i=e(90182),l=e(14578),d=e(8484),c=e(46334);const h=({data:f,className:y,label:x,isFocused:v,innerProps:P})=>{const E=(0,g.of)(o);return(0,t.jsx)("div",{className:(0,n.cx)(E.option,v&&E.optionFocused),"aria-label":"Tag option",...P,children:(0,t.jsx)("div",{className:(0,n.cx)(E.optionInner,y),children:typeof x=="string"?(0,t.jsx)(c.E,{label:x,removeIcon:!1,count:f.count??0}):x})})},o=f=>({option:(0,n.css)({padding:f.spacing(1),whiteSpace:"nowrap",cursor:"pointer",borderLeft:"2px solid transparent","&:hover":{background:f.colors.background.secondary}}),optionFocused:(0,n.css)({background:f.colors.background.secondary,borderStyle:"solid",borderTop:0,borderRight:0,borderBottom:0,borderLeftWidth:"2px"}),optionInner:(0,n.css)({position:"relative",textAlign:"left",width:"100%",display:"block",cursor:"pointer",padding:"2px 0"})}),m=(f,y)=>{const x=RegExp((0,r.jD)(y),"i");return!!(f.value&&x.test(f.value))},u=({allowCustomValue:f=!1,formatCreateLabel:y,hideValues:x,inputId:v,isClearable:P,onChange:E,placeholder:D,tagOptions:C,tags:b,width:T})=>{const S=(0,g.of)(p),O=b.map(N=>({value:N,label:N,count:0})),[M,I]=(0,s.useState)(O),[L,B]=(0,s.useState)(!1),[j,A]=(0,s.useState)(b),[K,W]=(0,s.useState)(O),U=(0,s.useMemo)(()=>b.join(),[b]),F=(0,s.useCallback)(async()=>(await C()).map(H=>b.includes(H.term)?{value:H.term,label:H.term,count:0}:{value:H.term,label:H.term,count:H.count}),[C,b]),V=(0,s.useCallback)(async()=>{B(!0);const N=await F();f&&K.forEach(H=>N.push(H)),I(N),B(!1)},[f,K,F]);(0,s.useEffect)(()=>{b.length>0&&M.length===0&&V()},[V,M.length,b.length]),(0,s.useEffect)(()=>{b!==j&&(A(b),V())},[V,j,b]);const w=N=>{N.forEach(H=>H.count=0),E((N||[]).map(H=>H.value)),f&&W(N.filter(H=>!b.includes(H)))},z={onFocus:V,isLoading:L,options:M,allowCreateWhileLoading:!0,allowCustomValue:f,formatCreateLabel:y,defaultOptions:!0,filterOption:m,getOptionLabel:N=>N.label,getOptionValue:N=>N.value,inputId:v,isMulti:!0,onChange:w,loadingMessage:(0,d.t)("tag-filter.loading","Loading..."),noOptionsMessage:(0,d.t)("tag-filter.no-tags","No tags found"),placeholder:D||(0,d.t)("tag-filter.placeholder","Filter by tag"),value:O,width:T,components:{Option:h,MultiValueLabel:()=>null,MultiValueRemove(N){const{data:H}=N;return(0,t.jsx)(a.c.MultiValueRemove,{...N,children:(0,t.jsx)(c.E,{label:H.label,removeIcon:!0,count:H.count},H.label)})},MultiValueContainer:x?()=>null:a.c.MultiValueContainer}};return(0,t.jsxs)("div",{className:S.tagFilter,children:[P&&b.length>0&&(0,t.jsx)("button",{className:S.clear,onClick:()=>w([]),children:"Clear tags"}),(0,t.jsx)(i.KF,{...z,prefix:(0,t.jsx)(l.I,{name:"tag-alt"}),"aria-label":"Tag filter"},U)]})};u.displayName="TagFilter";const p=f=>{const y=(0,c.$)(f);return{tagFilter:(0,n.css)({position:"relative",minWidth:"180px",flexGrow:1,[`.${y.badge}`]:{marginLeft:"6px",cursor:"pointer"}}),clear:(0,n.css)({background:"none",border:"none",textDecoration:"underline",fontSize:"12px",padding:"none",position:"absolute",top:"-17px",right:0,cursor:"pointer",color:f.colors.text.secondary,"&:hover":{color:f.colors.text.primary}})}}},25573:(G,R,e)=>{"use strict";e.d(R,{m:()=>o});var t=e(74848),n=e(2543),s=e.n(n),a=e(26272),r=e(65879),g=e(47232),i=e(15666),l=e(76412),d=e(28138),c=e(61680);const h="grafana.dashboard.timepicker.history",o=x=>(0,t.jsx)(c.b,{storageKey:h,defaultValue:[],children:(v,P)=>{const E=u(v),D=m(E);return(0,t.jsx)(i.$6,{...x,history:D,onChange:C=>{p(C,E,P),x.onChange(C)},onError:C=>d.A.emit(a.r1.alertError,[(0,l.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,l.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:C})])})}});function m(x){return x.map(v=>r.convertRawToRange(v,"utc",void 0,"YYYY-MM-DD HH:mm:ss"))}function u(x){return x.map(v=>{const P=typeof v.from=="string"?v.from:v.from.toISOString(),E=typeof v.to=="string"?v.to:v.to.toISOString();return{from:P,to:E}})}function p(x,v,P){if(!f(x))return;const E={from:typeof x.raw.from=="string"?x.raw.from:x.raw.from.toISOString(),to:typeof x.raw.to=="string"?x.raw.to:x.raw.to.toISOString()},D=y([E,...v]);P(D)}function f(x){return(0,g.Ar)(x.raw.from)||(0,g.Ar)(x.raw.to)}function y(x){return(0,n.uniqBy)(x,v=>v.from+v.to).slice(0,4)}},76323:(G,R,e)=>{"use strict";e.d(R,{J:()=>g});var t=e(74848),n=e(32196),s=e(96540),a=e(14110),r=e(40845);const g=({text:l="PRO",className:d,experimentId:c,eventVariant:h="",...o})=>{const m=(0,r.of)(i);return(0,s.useEffect)(()=>{c&&(0,a.Xp)(c,"test",h)},[c,h]),(0,t.jsx)("span",{className:(0,n.cx)(m.badge,d),...o,children:l})},i=l=>({badge:(0,n.css)`
      margin-left: ${l.spacing(1.25)};
      border-radius: ${l.shape.borderRadius(5)};
      background-color: ${l.colors.success.main};
      padding: ${l.spacing(.25,.75)};
      color: white; // use the same color for both themes
      font-weight: ${l.typography.fontWeightMedium};
      font-size: ${l.typography.pxToRem(10)};
    `})},77454:(G,R,e)=>{"use strict";e.d(R,{El:()=>c,Iz:()=>l,ep:()=>o});var t=e(74848),n=e(32196),s=e(96540),a=e(14110),r=e(40845),g=e(14578),i=e(55852);const l=({featureName:p,className:f,children:y,text:x,featureId:v,eventVariant:P="",size:E="md",...D})=>{const C=(0,r.of)(d,E);return(0,s.useEffect)(()=>{(0,a.Xp)(`feature-highlights-${v}`,"test",P)},[P,v]),(0,t.jsxs)("div",{className:(0,n.cx)(C.box,f),...D,children:[(0,t.jsx)(g.I,{name:"rocket",className:C.icon}),(0,t.jsxs)("div",{className:C.inner,children:[(0,t.jsxs)("p",{className:C.text,children:["You\u2019ve discovered a Pro feature! ",x||`Get the Grafana Pro plan to access ${p}.`]}),(0,t.jsx)(i.z9,{variant:"secondary",size:E,className:C.button,href:"https://grafana.com/profile/org/subscription",target:"__blank",rel:"noopener noreferrer",children:"Upgrade"})]})]})},d=(p,f)=>{const y=p.shape.borderRadius(2),x=f==="md"?"body":"bodySmall";return{box:(0,n.css)`
      display: flex;
      align-items: center;
      position: relative;
      border-radius: ${y};
      background: ${p.colors.success.transparent};
      padding: ${p.spacing(2)};
      color: ${p.colors.success.text};
      font-size: ${p.typography[x].fontSize};
      text-align: left;
      line-height: 16px;
      margin: ${p.spacing(0,"auto",3,"auto")};
      max-width: ${p.breakpoints.values.xxl}px;
      width: 100%;
    `,inner:(0,n.css)`
      display: flex;
      align-items: center;
      width: 100%;
      justify-content: space-between;
    `,text:(0,n.css)`
      margin: 0;
    `,button:(0,n.css)`
      background-color: ${p.colors.success.main};
      font-weight: ${p.typography.fontWeightLight};
      color: white;

      &:hover {
        background-color: ${p.colors.success.main};
      }

      &:focus-visible {
        box-shadow: none;
        color: ${p.colors.text.primary};
        outline: 2px solid ${p.colors.primary.main};
      }
    `,icon:(0,n.css)`
      margin: ${p.spacing(.5,1,.5,.5)};
    `}},c=({listItems:p,image:f,featureUrl:y,featureName:x,description:v,caption:P,action:E})=>{const D=(0,r.of)(h);return(0,t.jsxs)("div",{className:D.container,children:[(0,t.jsxs)("div",{className:D.content,children:[(0,t.jsxs)("h3",{className:D.title,children:["Get started with ",x]}),v&&(0,t.jsx)("h6",{className:D.description,children:v}),(0,t.jsx)("ul",{className:D.list,children:p.map((C,b)=>(0,t.jsxs)("li",{children:[(0,t.jsx)(g.I,{name:"check",size:"xl",className:D.icon})," ",C]},b))}),E?.link&&(0,t.jsx)(i.z9,{variant:"primary",href:E.link,children:E.text}),E?.onClick&&(0,t.jsx)(i.$n,{variant:"primary",onClick:E.onClick,children:E.text}),y&&(0,t.jsx)(i.z9,{fill:"text",href:y,className:D.link,target:"_blank",rel:"noreferrer noopener",children:"Learn more"})]}),(0,t.jsxs)("div",{className:D.media,children:[(0,t.jsx)("img",{src:u(f),alt:"Feature screenshot"}),P&&(0,t.jsx)("p",{className:D.caption,children:P})]})]})},h=p=>({container:(0,n.css)`
      display: flex;
      justify-content: space-between;
    `,content:(0,n.css)`
      width: 45%;
      margin-right: ${p.spacing(4)};
    `,media:(0,n.css)`
      width: 55%;

      img {
        width: 100%;
      }
    `,title:(0,n.css)`
      color: ${p.colors.text.maxContrast};
    `,description:(0,n.css)`
      color: ${p.colors.text.primary};
      font-weight: ${p.typography.fontWeightLight};
    `,list:(0,n.css)`
      list-style: none;
      margin: ${p.spacing(4,0,2,0)};

      li {
        display: flex;
        align-items: flex-start;
        color: ${p.colors.text.primary};
        padding: ${p.spacing(1,0)};
      }
    `,icon:(0,n.css)`
      color: ${p.colors.success.main};
      margin-right: ${p.spacing(1)};
    `,link:(0,n.css)`
      margin-left: ${p.spacing(2)};
    `,caption:(0,n.css)`
      font-weight: ${p.typography.fontWeightLight};
      margin: ${p.spacing(1,0,0)};
    `}),o=({featureName:p,description:f,featureUrl:y,image:x})=>{const v=(0,r.of)(m);return(0,t.jsxs)("div",{className:v.container,children:[(0,t.jsxs)("h3",{className:v.title,children:["Get started with ",p]}),f&&(0,t.jsx)("h6",{className:v.description,children:f}),(0,t.jsx)(i.z9,{fill:"text",href:y,target:"_blank",rel:"noreferrer noopener",children:"Learn more"}),(0,t.jsx)("div",{className:v.media,children:(0,t.jsx)("img",{src:u(x),alt:"Feature screenshot"})})]})},m=p=>({container:(0,n.css)`
      overflow: auto;
      height: 100%;
    `,title:(0,n.css)`
      color: ${p.colors.text.maxContrast};
    `,description:(0,n.css)`
      color: ${p.colors.text.primary};
      font-weight: ${p.typography.fontWeightLight};
    `,media:(0,n.css)`
      width: 100%;
      margin-top: ${p.spacing(2)};

      img {
        width: 100%;
      }
    `}),u=p=>p.startsWith("http")?p:"/public/img/enterprise/highlights/"+p},93522:(G,R,e)=>{"use strict";e.d(R,{N:()=>h});var t=e(74848),n=e(32196),s=e(96540),a=e(40845),r=e(37390),g=e(71259),i=e(94753),l=e(8484),d=e(63917);const c=p=>[{category:(0,l.t)("help-modal.shortcuts-category.global","Global"),shortcuts:[{keys:["g","h"],description:(0,l.t)("help-modal.shortcuts-description.go-to-home-dashboard","Go to Home Dashboard")},{keys:["g","d"],description:(0,l.t)("help-modal.shortcuts-description.go-to-dashboards","Go to Dashboards")},{keys:["g","e"],description:(0,l.t)("help-modal.shortcuts-description.go-to-explore","Go to Explore")},{keys:["g","p"],description:(0,l.t)("help-modal.shortcuts-description.go-to-profile","Go to Profile")},{keys:[`${p} + k`],description:(0,l.t)("help-modal.shortcuts-description.open-search","Open search")},{keys:["esc"],description:(0,l.t)("help-modal.shortcuts-description.exit-edit/setting-views","Exit edit/setting views")},{keys:["?"],description:(0,l.t)("help-modal.shortcuts-description.show-all-shortcuts","Show all keyboard shortcuts")},{keys:["c","t"],description:(0,l.t)("help-modal.shortcuts-description.change-theme","Change theme")}]},{category:(0,l.t)("help-modal.shortcuts-category.time-range","Time range"),shortcuts:[{keys:["t","z"],description:(0,l.t)("help-modal.shortcuts-description.zoom-out-time-range","Zoom out time range")},{keys:["t","\u2190"],description:(0,l.t)("help-modal.shortcuts-description.move-time-range-back","Move time range back")},{keys:["t","\u2192"],description:(0,l.t)("help-modal.shortcuts-description.move-time-range-forward","Move time range forward")},{keys:["t","a"],description:(0,l.t)("help-modal.shortcuts-description.make-time-range-permanent","Make time range absolute/permanent")},{keys:["t","c"],description:(0,l.t)("help-modal.shortcuts-description.copy-time-range","Copy time range")},{keys:["t","v"],description:(0,l.t)("help-modal.shortcuts-description.paste-time-range","Paste time range")}]},{category:(0,l.t)("help-modal.shortcuts-category.dashboard","Dashboard"),shortcuts:[{keys:[`${p} + s`],description:(0,l.t)("help-modal.shortcuts-description.save-dashboard","Save dashboard")},{keys:["d","r"],description:(0,l.t)("help-modal.shortcuts-description.refresh-all-panels","Refresh all panels")},{keys:["d","s"],description:(0,l.t)("help-modal.shortcuts-description.dashboard-settings","Dashboard settings")},{keys:["d","v"],description:(0,l.t)("help-modal.shortcuts-description.toggle-active-mode","Toggle in-active / view mode")},{keys:["d","k"],description:(0,l.t)("help-modal.shortcuts-description.toggle-kiosk","Toggle kiosk mode (hides top nav)")},{keys:["d","\u21E7 + e"],description:(0,l.t)("help-modal.shortcuts-description.expand-all-rows","Expand all rows")},{keys:["d","\u21E7 + c"],description:(0,l.t)("help-modal.shortcuts-description.collapse-all-rows","Collapse all rows")},{keys:["d","a"],description:(0,l.t)("help-modal.shortcuts-description.toggle-auto-fit","Toggle auto fit panels (experimental feature)")},{keys:[`${p} + o`],description:(0,l.t)("help-modal.shortcuts-description.toggle-graph-crosshair","Toggle shared graph crosshair")},{keys:["d","l"],description:(0,l.t)("help-modal.shortcuts-description.toggle-all-panel-legends","Toggle all panel legends")},{keys:["d","x"],description:(0,l.t)("help-modal.shortcuts-description.toggle-exemplars","Toggle exemplars in all panel")}]},{category:(0,l.t)("help-modal.shortcuts-category.focused-panel","Focused panel"),shortcuts:[{keys:["e"],description:(0,l.t)("help-modal.shortcuts-description.toggle-panel-edit","Toggle panel edit view")},{keys:["v"],description:(0,l.t)("help-modal.shortcuts-description.toggle-panel-fullscreen","Toggle panel fullscreen view")},{keys:["p","s"],description:(0,l.t)("help-modal.shortcuts-description.open-shared-modal","Open Panel Share Modal")},{keys:["p","d"],description:(0,l.t)("help-modal.shortcuts-description.duplicate-panel","Duplicate Panel")},{keys:["p","r"],description:(0,l.t)("help-modal.shortcuts-description.remove-panel","Remove Panel")},{keys:["p","l"],description:(0,l.t)("help-modal.shortcuts-description.toggle-panel-legend","Toggle panel legend")}]}],h=({onDismiss:p})=>{const f=(0,a.of)(u),y=(0,s.useMemo)(()=>(0,d.gn)(),[]),x=(0,s.useMemo)(()=>c(y),[y]);return(0,t.jsx)(r.a,{title:(0,l.t)("help-modal.title","Shortcuts"),isOpen:!0,onDismiss:p,onClickBackdrop:p,children:(0,t.jsx)(g.x,{columns:{xs:1,sm:2},gap:3,tabIndex:0,children:Object.values(x).map(({category:v,shortcuts:P})=>(0,t.jsx)("section",{children:(0,t.jsxs)("table",{className:f.table,children:[(0,t.jsx)("caption",{children:(0,t.jsx)(i.E,{element:"p",variant:"h5",children:v})}),(0,t.jsx)("thead",{className:"sr-only",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Keys"}),(0,t.jsx)("th",{children:"Description"})]})}),(0,t.jsx)("tbody",{children:P.map(({keys:E,description:D})=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:f.keys,children:E.map(C=>(0,t.jsx)(o,{children:C},C))}),(0,t.jsx)("td",{children:(0,t.jsx)(i.E,{variant:"bodySmall",element:"p",children:D})})]},E.join()))})]})},v))})})},o=({children:p})=>{const f=(0,a.of)(u),y=(0,s.useMemo)(()=>m(p),[p]),x=(0,t.jsx)("span",{dangerouslySetInnerHTML:{__html:y}});return(0,t.jsx)("kbd",{className:f.shortcutTableKey,children:(0,t.jsx)(i.E,{variant:"code",children:x})})};function m(p){let f,y;if(p.includes("ctrl"))f="ctrl",y="Control";else if(p.includes("esc"))f="esc",y="Escape";else return p;return p.replace(f,`<span class="sr-only">${y}</span><span aria-hidden="true" role="none">${f}</span>`)}function u(p){return{table:(0,n.css)({borderCollapse:"separate",borderSpacing:p.spacing(2),"& caption":{captionSide:"top"}}),keys:(0,n.css)({textAlign:"end",whiteSpace:"nowrap",minWidth:83}),shortcutTableKey:(0,n.css)({display:"inline-block",textAlign:"center",marginRight:p.spacing(.5),padding:"3px 5px",lineHeight:"10px",verticalAlign:"middle",border:`solid 1px ${p.colors.border.medium}`,borderRadius:p.shape.radius.default,color:p.colors.text.primary,backgroundColor:p.colors.background.secondary})}}},15054:(G,R,e)=>{"use strict";e.d(R,{FG:()=>o,HG:()=>r,IZ:()=>c,MM:()=>u,Pz:()=>a,bJ:()=>i,cV:()=>s,cx:()=>l,dU:()=>n,o9:()=>g,sD:()=>t,tH:()=>d,wV:()=>m});const t=30,n=8,s=24,a="v",r="h",g=4,i=250,l=t*3,d="panel-copy",c=2,h=23763571993,o=40,m="VisualizationSelectPane.ListMode",u="WidgetSelectPane.ListMode"},76888:(G,R,e)=>{"use strict";e.d(R,{Il:()=>r,YE:()=>a,k9:()=>l,ni:()=>g});var t=e(96540),n=e(39601),s=e(32264);const a=(0,t.createContext)(void 0);function r(){const d=(0,t.useContext)(a);if(!d)throw new Error("No GrafanaContext found");return d}function g(){const{chrome:d}=r();return(0,t.useCallback)((c,h)=>{const{pathname:o,search:m}=n.Ny.getLocation();d.setReturnToPrevious({title:c,href:h??o+m})},[d])}const i=40;function l(){const{chrome:d}=r(),{kioskMode:c,searchBarHidden:h,chromeless:o}=d.useState();return c||o?0:h||s.$.featureToggles.singleTopNav?i:i*2}},83733:(G,R,e)=>{"use strict";e.d(R,{f:()=>r,j:()=>a});var t=e(96540),n=e(24120),s=e(11848);const a=(0,t.createContext)(s.L);function r(){const g=(0,n.A)(s.L.activePluginId),i=(0,t.useContext)(a);if(!i)throw new Error("No SidecarContext found");return{activePluginId:g,openApp:l=>i.openApp(l),closeApp:l=>i.closeApp(l),isAppOpened:l=>i.isAppOpened(l)}}},3169:(G,R,e)=>{"use strict";e.d(R,{Cf:()=>o,_2:()=>m,gi:()=>c,q8:()=>h,tZ:()=>d});var t=e(96540),n=e(62938),s=e(94954),a=e(31678),r=e(82467);const g={title:"",text:"",severity:a.AppNotificationSeverity.Success,icon:"check"},i={title:"",text:"",severity:a.AppNotificationSeverity.Warning,icon:"exclamation-triangle"},l={title:"",text:"",severity:a.AppNotificationSeverity.Error,icon:"exclamation-triangle"},d=(u,p="",f)=>({...g,title:u,text:p,id:(0,n.A)(),timestamp:Date.now(),showing:!0}),c=(u,p="",f,y)=>({...l,text:(0,s.q)(p),title:u,id:(0,n.A)(),traceId:f,component:y,timestamp:Date.now(),showing:!0}),h=(u,p="",f)=>({...i,title:u,text:p,traceId:f,id:(0,n.A)(),timestamp:Date.now(),showing:!0}),o=(u,p="",f)=>({severity:a.AppNotificationSeverity.Info,icon:"info-circle",title:u,text:p,id:(0,n.A)(),timestamp:Date.now(),showing:!0});function m(){const u=(0,a.useDispatch)();return(0,t.useMemo)(()=>({success:(p,f="")=>{u((0,r.dx)(d(p,f)))},warning:(p,f="",y)=>{u((0,r.dx)(h(p,f,y)))},error:(p,f="",y)=>{u((0,r.dx)(c(p,f,y)))},info:(p,f="")=>{u((0,r.dx)(o(p,f)))}}),[u])}},39640:(G,R,e)=>{"use strict";e.d(R,{$H:()=>d,Ay:()=>c});var t=e(2543),n=e(33390),s=e(38877),a=e(19347);const r=v=>{const P=(0,a.l)().getInstanceSettings(v.datasourceName);return{id:v.ts.toString(),createdAt:v.ts,datasourceName:v.datasourceName,datasourceUid:P?.uid||"",starred:v.starred,comment:v.comment,queries:v.queries}},g=v=>{if(!(0,a.l)().getInstanceSettings({uid:v.datasourceUid}))throw new Error("Datasource not found.");return{ts:v.createdAt,datasourceName:v.datasourceName,starred:v.starred,comment:v.comment,queries:v.queries}};var i=e(75533);const l="grafana.explore.richHistory",d=1e4;class c{async getRichHistory(P){const E=u().map(r),D=P.starred?E.filter(T=>T.starred===!0):E,C=P.from&&P.to?[P.from,P.to]:void 0,b=(0,i.a_)(D,P.sortOrder,P.datasourceFilters,P.search,C);return{richHistory:b,total:b.length}}async addToRichHistory(P){const E=Date.now(),D={id:E.toString(),createdAt:E,...P},C=g(D),b=o(u()),T=C.queries.map(L=>(0,t.omit)(L,["key","refId"])),S=b.length>0&&b[0].queries.map(L=>(0,t.omit)(L,["key","refId"]));if((0,t.isEqual)(T,S)){const L=new Error("Entry already exists");throw L.name=s.m.DuplicatedEntry,L}const{queriesToKeep:O,limitExceeded:M}=m(b),I=[C,...O];try{n.A.setObject(l,I)}catch(L){if(L instanceof Error&&L.name==="QuotaExceededError")x(s.m.StorageFull,`Saving rich history failed: ${L.message}`);else throw L}return M?{warning:{type:s.C.LimitExceeded,message:`Query history reached the limit of ${d}. Old, not-starred items have been removed.`},richHistoryQuery:D}:{richHistoryQuery:D}}async deleteAll(){n.A.delete(l)}async deleteRichHistory(P){const E=parseInt(P,10),C=n.A.getObject(l,[]).filter(b=>b.ts!==E);n.A.setObject(l,C)}async updateStarred(P,E){return h(P,D=>D.starred=E)}async updateComment(P,E){return h(P,D=>D.comment=E)}async getSettings(){return{activeDatasourcesOnly:n.A.getObject(i.mE.activeDatasourcesOnly)??n.A.getObject(i.mE.legacyActiveDatasourceOnly,!1),retentionPeriod:n.A.getObject(i.mE.retentionPeriod,7),starredTabAsFirstTab:n.A.getBool(i.mE.starredTabAsFirstTab,!1),lastUsedDatasourceFilters:n.A.getObject(i.mE.datasourceFilters,[]).map(E=>E.value)}}async updateSettings(P){n.A.set(i.mE.activeDatasourcesOnly,P.activeDatasourcesOnly),n.A.set(i.mE.retentionPeriod,P.retentionPeriod),n.A.set(i.mE.starredTabAsFirstTab,P.starredTabAsFirstTab),n.A.setObject(i.mE.datasourceFilters,(P.lastUsedDatasourceFilters||[]).map(E=>({value:E})))}}function h(v,P){const E=parseInt(v,10),D=n.A.getObject(l,[]),C=(0,t.find)(D,{ts:E});if(!C)throw new Error("Rich history item not found.");return P(C),n.A.setObject(l,D),r(C)}function o(v){const P=n.A.getObject(i.mE.retentionPeriod,7),E=(0,i.wQ)(P,{isLastTs:!1});return v.filter(D=>D.ts>E||D.starred===!0)||[]}function m(v){let P=!1,E=v.length-1;for(;E>=0&&v.length>=d;)v[E].starred||(v.splice(E,1),P=!0),E--;return{queriesToKeep:v,limitExceeded:P}}function u(){const v=n.A.getObject(l,[]);return p(v)}function p(v){return v.map(E=>{const D=E.queries.map((C,b)=>f(E,C,b));return{...E,queries:D}})}function f(v,P,E){const D="ABCDEFGHIJKLMNOPQRSTUVXYZ";return typeof P=="object"?P:y(P)?JSON.parse(P):{expr:P,refId:D[E]}}function y(v){try{JSON.parse(v)}catch{return!1}return!0}function x(v,P){const E=new Error(P);throw E.name=v,E}},38877:(G,R,e)=>{"use strict";e.d(R,{C:()=>n,m:()=>t});var t=(s=>(s.StorageFull="StorageFull",s.DuplicatedEntry="DuplicatedEntry",s))(t||{}),n=(s=>(s.LimitExceeded="LimitExceeded",s))(n||{})},75533:(G,R,e)=>{"use strict";e.d(R,{a_:()=>r,mE:()=>h,wQ:()=>g});var t=e(2543),n=e.n(t),s=e(47232),a=e(91650);function r(o,m,u,p,f){const y=l(o,u),x=d(y,p),v=f?i(x,f):x;return c(v,m)}const g=(o,m)=>{let u=m.now;return u||(u=m.tz?(0,s.oZ)(m.tz):(0,s.KQ)()),u.add(-o,"d"),(m.isLastTs?u.endOf("d"):u.startOf("d")).valueOf()};function i(o,m){return o.filter(u=>u.createdAt>m[0]&&u.createdAt<m[1])}function l(o,m){return m.length>0?o.filter(u=>m.includes(u.datasourceName)):o}function d(o,m){return o.filter(u=>u.comment.includes(m)?!0:u.queries.filter(f=>Object.values((0,t.omit)(f,["datasource","key","refId","hide","queryType"])).some(y=>y?.toString().includes(m))).length>0)}const c=(o,m)=>{let u;return m===a.x.Ascending&&(u=(p,f)=>p.createdAt<f.createdAt?-1:p.createdAt>f.createdAt?1:0),m===a.x.Descending&&(u=(p,f)=>p.createdAt<f.createdAt?1:p.createdAt>f.createdAt?-1:0),m===a.x.DatasourceZA&&(u=(p,f)=>p.datasourceName<f.datasourceName?-1:p.datasourceName>f.datasourceName?1:0),m===a.x.DatasourceAZ&&(u=(p,f)=>p.datasourceName<f.datasourceName?1:p.datasourceName>f.datasourceName?-1:0),o.sort(u)},h={retentionPeriod:"grafana.explore.richHistory.retentionPeriod",starredTabAsFirstTab:"grafana.explore.richHistory.starredTabAsFirstTab",legacyActiveDatasourceOnly:"grafana.explore.richHistory.activeDatasourceOnly",activeDatasourcesOnly:"grafana.explore.richHistory.activeDatasourcesOnly",datasourceFilters:"grafana.explore.richHistory.datasourceFilters"}},11401:(G,R,e)=>{"use strict";e.d(R,{tU:()=>f,a:()=>p,gQ:()=>y});var t=e(32264),n=e(10096),s=e(91650),a=e(39640),r=e(75505),g=e(17172),i=e(19347),l=e(65615);const d=x=>{const v=(0,i.l)().getInstanceSettings({uid:x.datasourceUid});return{id:x.uid,createdAt:x.createdAt*1e3,datasourceName:v?.name||"",datasourceUid:x.datasourceUid,starred:x.starred,comment:x.comment,queries:x.queries}},c=x=>({uid:x.id,createdAt:Math.floor(x.createdAt/1e3),datasourceUid:x.datasourceUid,starred:x.starred,comment:x.comment,queries:x.queries});class h{constructor(){this.preferenceService=new l.W("user")}async addToRichHistory(v){const{result:P}=await(0,g.AI)().post("/api/query-history",{dataSourceUid:v.datasourceUid,queries:v.queries});return{richHistoryQuery:d(P)}}async deleteAll(){throw new Error("not supported")}async deleteRichHistory(v){(0,g.AI)().delete(`/api/query-history/${v}`)}async getRichHistory(v){const P=o(v);let E="query-history-get-all";v.starred&&(E="query-history-get-starred");const C=(await(0,r.s)((0,g.AI)().fetch({method:"GET",url:`/api/query-history?${P}`,requestId:E}))).data,b=(C.result.queryHistory||[]).map(d),T=C.result.totalCount||0;return{richHistory:b,total:T}}async getSettings(){return{activeDatasourcesOnly:!1,lastUsedDatasourceFilters:void 0,retentionPeriod:14,starredTabAsFirstTab:(await this.preferenceService.load()).queryHistory?.homeTab==="starred"}}async updateComment(v,P){const E=await(0,g.AI)().patch(`/api/query-history/${v}`,{comment:P});return d(E.result)}updateSettings(v){return this.preferenceService.patch({queryHistory:{homeTab:v.starredTabAsFirstTab?"starred":"query"}})}async updateStarred(v,P){let E;return P?E=await(0,g.AI)().post(`/api/query-history/star/${v}`):E=await(0,g.AI)().delete(`/api/query-history/star/${v}`),d(E.result)}}function o(x){let v=`${x.datasourceFilters.map(P=>{const E=(0,i.l)().getInstanceSettings(P).uid;return`datasourceUid=${encodeURIComponent(E)}`}).join("&")}`;return x.search&&(v=v+`&searchString=${x.search}`),x.sortOrder&&(v=v+`&sort=${x.sortOrder===s.x.Ascending?"time-asc":"time-desc"}`),x.starred||(v=v+`&to=${x.to}`,v=v+`&from=${x.from}`),v=v+"&limit=100",v=v+`&page=${x.page||1}`,x.starred&&(v=v+`&onlyStarred=${x.starred}`),v}const m=new a.Ay,u=new h,p=()=>t.$.queryHistoryEnabled?u:m,f=()=>m,y=()=>t.$.queryHistoryEnabled?{availableFilters:[s.x.Descending,s.x.Ascending],lastUsedDataSourcesAvailable:!1,clearHistory:!1,onlyActiveDataSource:!1,changeRetention:!1,queryHistoryAvailable:n.TP.isSignedIn}:{availableFilters:[s.x.Descending,s.x.Ascending,s.x.DatasourceAZ,s.x.DatasourceZA],lastUsedDataSourcesAvailable:!0,clearHistory:!0,onlyActiveDataSource:!0,changeRetention:!0,queryHistoryAvailable:!0}},16021:(G,R,e)=>{"use strict";e.d(R,{u:()=>n});var t=e(96540);function n(s,a){const[r,g]=(0,t.useState)();return(0,t.useEffect)(()=>{const i=s.subscribe(a,g);return()=>i.unsubscribe()},[s,a]),r}},60619:(G,R,e)=>{"use strict";e.d(R,{Y:()=>n});var t=e(96540);function n({breakpoint:s,onChange:a}){(0,t.useEffect)(()=>{const r=window.matchMedia(`(min-width: ${s}px)`),g=i=>a(i);return r.addEventListener("change",g),()=>r.removeEventListener("change",g)},[s,a])}},25249:(G,R,e)=>{"use strict";e.d(R,{C:()=>s});var t=e(31678),n=e(17422);const s=a=>{const r=(0,t.useSelector)(g=>g.navIndex);return(0,n.tc)(r,a)}},83277:(G,R,e)=>{"use strict";e.d(R,{s:()=>a});var t=e(96540),n=e(54148),s=e(39601);function a(){const{search:r}=(0,n.zy)(),g=(0,t.useMemo)(()=>(0,s.SE)(r||""),[r]),i=(0,t.useCallback)((l,d)=>s.Ny.partial(l,d),[]);return[g,i]}},74513:(G,R,e)=>{"use strict";e.d(R,{MB:()=>s,NY:()=>a,Nm:()=>c,Yj:()=>h,dK:()=>m,d_:()=>r,fY:()=>l,jQ:()=>i,rT:()=>g,rd:()=>o,wi:()=>d});var t=e(2543),n=e.n(t);const s="en-US",a="fr-FR",r="es-ES",g="de-DE",i="pt-BR",l="zh-Hans",d="pseudo-LOCALE",c=s,h=[{code:s,name:"English",loader:{grafana:()=>e.e(9521).then(e.t.bind(e,19521,19))}},{code:a,name:"Fran\xE7ais",loader:{grafana:()=>e.e(5648).then(e.t.bind(e,35648,19))}},{code:r,name:"Espa\xF1ol",loader:{grafana:()=>e.e(680).then(e.t.bind(e,70680,19))}},{code:g,name:"Deutsch",loader:{grafana:()=>e.e(3082).then(e.t.bind(e,23082,19))}},{code:l,name:"\u4E2D\u6587\uFF08\u7B80\u4F53\uFF09",loader:{grafana:()=>e.e(9538).then(e.t.bind(e,29538,19))}},{code:i,name:"Portugu\xEAs Brasileiro",loader:{grafana:()=>e.e(2288).then(e.t.bind(e,12288,19))}}];{const u=e(55905);if(u.keys().includes("app/extensions/locales/localeExtensions")){const{LOCALE_EXTENSIONS:p,ENTERPRISE_I18N_NAMESPACE:f}=u("app/extensions/locales/localeExtensions");for(const y of h){const x=p[y.code];x&&(y.loader[f]=x)}}}const o=h.map(u=>u.code),m=(0,t.uniq)(h.flatMap(u=>Object.keys(u.loader)))},8484:(G,R,e)=>{"use strict";e.d(R,{x6:()=>o,iL:()=>u,JL:()=>c,t:()=>m});var t=e(74848),n=e(72635),s=e(94997),a=e(32389),r=e(74513);const g=p=>p.split("-")[0].toLowerCase(),i={type:"backend",init(){},async read(p,f,y){let x=r.Yj.find(E=>E.code===p);if(x||(x=r.Yj.find(E=>g(E.code)===g(p))),!x)return y(new Error(`No message loader available for ${p}`),null);const v=x.loader[f];if(!v)return y(new Error(`No message loader available for ${p} with namespace ${f}`),null);const P=await v();y(null,P)}};let l,d;async function c(p){const f={partialBundledLanguages:!0,resources:{},returnEmptyString:!1,supportedLngs:r.rd,fallbackLng:r.Nm,ns:r.dK};if(d=n.default,p==="detect"){d=d.use(s.A);const x={order:["navigator"],caches:[]};f.detection=x}else f.lng=r.rd.includes(p)?p:void 0;return await d.use(i).use(a.r9).init(f),l=n.default.getFixedT(null,r.dK),{language:d.resolvedLanguage}}function h(p){const f=VALID_LANGUAGES.includes(p)?p:void 0;return i18n.changeLanguage(f)}const o=p=>(0,t.jsx)(a.x6,{shouldUnescape:!0,ns:r.dK,...p}),m=(p,f,y)=>(l||(console.warn("t() was called before i18n was initialized. This is probably caused by calling t() in the root module scope, instead of lazily on render"),l=n.default.t),l(p,f,y));function u(){return l?d||n.default:(console.warn("An attempt to internationalize was made before it was initialized. This was probably caused by calling a locale-aware function in the root module scope, instead of in render"),n.default)}},16001:(G,R,e)=>{"use strict";e.d(R,{$K:()=>p,Do:()=>c,XC:()=>o,XR:()=>h,dx:()=>d,fX:()=>v,g5:()=>u,oF:()=>m,qN:()=>x});var t=e(65307),n=e(25508),s=e(31678);const a=25,r="notifications",g=`${r}/lastRead`,i={byId:C(),lastRead:Number.parseInt(window.localStorage.getItem(g)??`${Date.now()}`,10)},l=(0,t.Z0)({name:"appNotifications",initialState:i,reducers:{notifyApp:(T,{payload:S})=>{Object.values(T.byId).some(O=>P(S,O)&&O.showing)||(T.byId[S.id]=S,b(T.byId))},hideAppNotification:(T,{payload:S})=>{S in T.byId&&(T.byId[S].showing=!1,b(T.byId))},clearNotification:(T,{payload:S})=>{delete T.byId[S],b(T.byId)},clearAllNotifications:T=>{T.byId={},b(T.byId)},readAllNotifications:(T,{payload:S})=>{T.lastRead=S}}}),{notifyApp:d,hideAppNotification:c,clearNotification:h,clearAllNotifications:o,readAllNotifications:m}=l.actions,u=l.reducer,p=T=>T.lastRead,f=T=>T.byId,y=(0,n.Mz)(f,T=>Object.values(T).sort((S,O)=>O.timestamp-S.timestamp)),x=(0,n.Mz)(y,T=>T.filter(E)),v=(0,n.Mz)(f,T=>Object.values(T).filter(S=>S.showing));function P(T,S){return T.icon===S.icon&&T.severity===S.severity&&T.text===S.text&&T.title===S.title}function E(T){return T.severity===s.AppNotificationSeverity.Warning||T.severity===s.AppNotificationSeverity.Error}function D(T){return typeof T=="object"&&T!==null&&"id"in T&&"icon"in T&&"title"in T&&"text"in T}function C(){const T=window.localStorage.getItem(r);if(!T)return{};const S=JSON.parse(T);return Object.values(S).every(O=>D(O))?S:{}}function b(T){const S=Object.values(T).filter(E).sort((O,M)=>M.timestamp-O.timestamp).slice(0,a).reduce((O,M)=>(O[M.id]={id:M.id,severity:M.severity,icon:M.icon,title:M.title,text:M.text,traceId:M.traceId,timestamp:M.timestamp,showing:!1},O),{});try{window.localStorage.setItem(r,JSON.stringify(S))}catch(O){console.error("Unable to persist notifications to local storage"),console.error(O)}}},91219:(G,R,e)=>{"use strict";e.d(R,{I_:()=>o,L1:()=>g,TU:()=>c,ci:()=>l,fc:()=>d,ve:()=>h});var t=e(65307),n=e(32264),s=e(36689);const a=n.$.bootData?.navTree??[];function r(m){return m.map(u=>{const p=u.children&&r(u.children);return{...u,children:p,text:(0,s.C)(u.id)??u.text,subTitle:(0,s.o)(u.id)??u.subTitle,emptyMessage:(0,s.C)(u.emptyMessageId)}})}const g="starred/",i=(0,t.Z0)({name:"navBarTree",initialState:()=>r(n.$.bootData?.navTree??[]),reducers:{setStarred:(m,u)=>{const p=m.find(P=>P.id==="starred"),{id:f,title:y,url:x,isStarred:v}=u.payload;if(p)if(v){p.children||(p.children=[]);const P={id:g+f,text:y,url:x};p.children.push(P),p.children.sort((E,D)=>E.text.localeCompare(D.text))}else{const P=p.children?.findIndex(E=>E.id===g+f)??-1;P>-1&&p?.children?.splice(P,1)}},setBookmark:(m,u)=>{if(!n.$.featureToggles.pinNavItems)return;const p=m.find(x=>x.id==="bookmarks"),{item:f,isSaved:y}=u.payload;if(p)if(y){p.children||=[];const x={...f,children:[],sortWeight:0,emptyMessageId:"",emptyMessage:"",parentItem:{id:p.id,text:p.text}};p.children.push(x)}else p.children=p.children?.filter(x=>x.url!==f.url)??[]},updateDashboardName:(m,u)=>{const{id:p,title:f,url:y}=u.payload,x=m.find(v=>v.id==="starred");if(x){const v=x.children?.find(P=>P.id===p);v&&(v.text=f,v.url=y,x.children?.sort((P,E)=>P.text.localeCompare(E.text)))}},removePluginFromNavTree:(m,u)=>{const p="plugin-page-"+u.payload.pluginID,f=m.findIndex(y=>y.id===p);f>-1&&m.splice(f,1)}}}),{setStarred:l,removePluginFromNavTree:d,updateDashboardName:c,setBookmark:h}=i.actions,o=i.reducer},28215:(G,R,e)=>{"use strict";e.d(R,{Id:()=>g,Im:()=>m,Vz:()=>h,YA:()=>o,_h:()=>p,s2:()=>i});var t=e(65307),n=e(2543),s=e.n(n),a=e(2913),r=e(36689);const g="home";function i(){const f={},y=(0,n.cloneDeep)(a.Ay.bootData.navTree),x=y.find(P=>P.id===g),v=y.filter(P=>P.id!==g);return x&&l(f,[x]),l(f,v,f[g]),f}function l(f,y,x){const v=[];for(const P of y){const E={...P,text:(0,r.C)(P.id)??P.text,subTitle:(0,r.o)(P.id)??P.subTitle,emptyMessage:(0,r.C)(P.emptyMessageId),parentItem:x};E.id&&(f[E.id]=E),E.children&&l(f,E.children,E),v.push(E)}x&&(x.children=v),f["not-found"]={...d("Page not found","404 Error").node},f.error={...d("Page error","An unexpected error").node}}function d(f,y){const x={text:f,subTitle:y,icon:"exclamation-triangle"};return{node:x,main:x}}const c={},h=(0,t.VP)("navIndex/updateNavIndex"),o=(0,t.VP)("navIndex/updateConfigurationSubtitle"),m=(0,t.VP)("navIndex/removeNavIndex"),u=(f,y)=>({...f,parentItem:{...f.parentItem,text:f.parentItem?.text??"",subTitle:y}}),p=(f=c,y)=>{if(h.match(y)){let v=function(D){if(D.children)for(const C of D.children)P[C.id]={...C,parentItem:D};D.parentItem&&v(D.parentItem)};var x=v;const P={},E=y.payload;return v(E),{...f,...P}}else if(o.match(y)){const v=`Organization: ${y.payload}`;return{...f,cfg:{...f.cfg,subTitle:v},datasources:u(f.datasources,v),correlations:u(f.correlations,v),users:u(f.users,v),teams:u(f.teams,v),plugins:u(f.plugins,v),"org-settings":u(f["org-settings"],v),apikeys:u(f.apikeys,v)}}else m.match(y)&&delete f[y.payload];return f}},17422:(G,R,e)=>{"use strict";e.d(R,{rH:()=>g,tc:()=>r});var t=e(41811),n=e(71101),s=e(28215);const a=()=>{const d={id:"not-found",text:"Page not found",icon:"exclamation-triangle",subTitle:"404 Error",url:"not-found"};return{node:d,main:d}},r=(0,t.A)((d,c,h,o=!1)=>{if(d[c]){const m=d[c],u=o?m:g(m),p=i(u,c);return{node:m,main:p}}return h||a()});function g(d){return d.id===n.Rj?d:d.parentItem&&d.parentItem.id!==s.Id?g(d.parentItem):d}function i(d,c){return d.id===c?{...d,active:!0}:d.children&&d.children.length>0?{...d,children:d.children.map(h=>i(h,c))}:d}const l=d=>`${d.main.text}${d.node.text?": "+d.node.text:""}`},65615:(G,R,e)=>{"use strict";e.d(R,{W:()=>n});var t=e(27677);class n{constructor(a){this.resourceUri=a}update(a){return t.IB.put(`/api/${this.resourceUri}/preferences`,a)}patch(a){return t.IB.patch(`/api/${this.resourceUri}/preferences`,a)}load(){return t.IB.get(`/api/${this.resourceUri}/preferences`)}}},11848:(G,R,e)=>{"use strict";e.d(R,{L:()=>r});var t=e(49426),n=e(32264),s=e(39601);class a{constructor(){this._activePluginId=new t.t(void 0)}assertFeatureEnabled(){return n.$.featureToggles.appSidecar?!0:(console.warn("The `appSidecar` feature toggle is not enabled, doing nothing."),!1)}get activePluginId(){return this._activePluginId.asObservable()}openApp(l){return this.assertFeatureEnabled()?this._activePluginId.next(l):!1}closeApp(l){if(!this.assertFeatureEnabled())return!1;if(this._activePluginId.getValue()===l)return this._activePluginId.next(void 0)}isAppOpened(l){return this.assertFeatureEnabled()?this._activePluginId.getValue()===l||g()===l:!1}}const r=new a;function g(){const{pathname:i}=s.Ny.getLocation();let l=i.match(/\/a\/([^/]+)/)?.[1];return!l&&i.match(/\/explore/)&&(l="explore"),!l&&i.match(/\/d\//)&&(l="dashboards"),l||"unknown"}},2619:(G,R,e)=>{"use strict";e.d(R,{Q:()=>a});var t=e(96540),n=e(13752),s=e(69731);class a{constructor(i){this._subject=new n.B,this._state=i}useState(){return r(this)}get state(){return this._state}setState(i){this._state={...this._state,...i},this._subject.next(this._state)}subscribeToState(i){return this._subject.subscribe(i)}}function r(g){const i=(0,s.C)();return(0,t.useEffect)(()=>{const l=g.subscribeToState({next:i});return()=>l.unsubscribe()},[g,i]),g.state}},27677:(G,R,e)=>{"use strict";e.d(R,{Mf:()=>Ve,IB:()=>Me,AI:()=>Ce});var t=e(56568),n=e(13752),s=e(75505),a=e(88483),r=e(64423),g=e(13288),i=e(65474),l=e(20039),d=e(81160),c=e(69862),h=e(59099),o=e(37748),m=e(66847),u=e(67791),p=e(16126),f=e(41560),y=e(69850),x=e(1005),v=e(62938),P=e(26272),E=e(40187),D=e(95344),C=e(32264),b=e(28138),T=e(2913),S=e(92315),O=e(67027),M=e(28676),I=e(74848),L=e(32196),B=e(40845),j=e(17464),A=e(37166),K=e(55852),W=e(88448);const U=Ue=>{const Ae=(0,B.of)(F),we=(0,B.$j)(),We=(0,W.o)(we),_e=!!Ue.maxConcurrentSessions,at=()=>{window.location.reload()};return(0,I.jsxs)(j.ZL,{children:[(0,I.jsx)("div",{className:We.modal,children:(0,I.jsxs)(A.w,{title:"You have been automatically signed out",severity:"warning",className:Ae.infobox,children:[(0,I.jsxs)("div",{className:Ae.text,children:[(0,I.jsxs)("p",{children:["Your session token was automatically revoked because you have reached",(0,I.jsx)("strong",{children:` the maximum number of ${_e?Ue.maxConcurrentSessions:""} concurrent sessions `}),"for your account."]}),(0,I.jsxs)("p",{children:[(0,I.jsx)("strong",{children:"To resume your session, sign in again."}),"Contact your administrator or visit the license page to review your quota if you are repeatedly signed out automatically."]})]}),(0,I.jsx)(K.$n,{size:"md",variant:"primary",onClick:at,children:"Sign in"})]})}),(0,I.jsx)("div",{className:(0,L.cx)(We.modalBackdrop,Ae.backdrop)})]})},F=Ue=>({infobox:(0,L.css)`
    margin-bottom: 0;
  `,text:(0,L.css)`
    margin: ${Ue.spacing(1,0,2)};
  `,backdrop:(0,L.css)`
    background-color: ${Ue.colors.background.canvas};
    opacity: 0.8;
  `});var V=e(28444),w=e(2543);const z=Ue=>{const Ae=Ue.method,we=k(Ue),We=se(we),_e=te(Ue,We),at=de(Ue);return{method:Ae,headers:we,body:_e,credentials:at}},N={canParse:()=>!0,parse:Ue=>(Ue.get("accept")||Ue.set("accept","application/json, text/plain, */*"),Ue)},H=Ue=>({canParse:Ae=>(Ae?.method?Ae?.method.toLowerCase():"")===Ue,parse:Ae=>(Ae.get("content-type")||Ae.set("content-type","application/json"),Ae)}),Q=H("post"),X=H("put"),ee=H("patch"),Z=[Q,X,ee,N],q=/[^\u0000-\u00ff]/g;function ae(Ue){return q.test(Ue)?encodeURI(Ue):Ue}const k=Ue=>{const Ae={};for(let[at,ut]of Object.entries(Ue.headers??{}))Ae[ae(at)]=ae(ut);const we=new Headers(Ae);return Z.filter(at=>at.canParse(Ue)).reduce((at,ut)=>ut.parse(at),we)},se=Ue=>{if(!Ue)return!1;const Ae=Ue.get("content-type");return!!(Ae&&(Ae.toLowerCase()==="application/json"||Ae.toLowerCase()==="application/merge-patch+json"))},te=(Ue,Ae)=>Ue&&(!Ue.data||typeof Ue.data=="string"||Ue.data instanceof Blob?Ue.data:Ae?JSON.stringify(Ue.data):new URLSearchParams(Ue.data));async function ne(Ue,Ae){if(Ae)switch(Ae){case"arraybuffer":return Ue.arrayBuffer();case"blob":return Ue.blob();case"json":return Ue.headers.get("Content-Length")==="0"?(console.warn(`${Ue.url} returned an invalid JSON`),{}):await Ue.json();case"text":return Ue.text()}const we=await Ue.text();try{return JSON.parse(we)}catch{}return we}function le(Ue){return Object.keys(Ue).map(Ae=>{const we=Ue[Ae];return Array.isArray(we)?we.map(We=>`${encodeURIComponent(Ae)}=${encodeURIComponent(We)}`).join("&"):`${encodeURIComponent(Ae)}=${encodeURIComponent(we)}`}).join("&")}const re=Ue=>{const Ae=(0,w.omitBy)(Ue.params,We=>We===void 0||We&&We.length===0),we=le(Ae);return Ue.params&&we.length?`${Ue.url}?${we}`:Ue.url},de=Ue=>Ue&&(Ue.credentials?Ue.credentials:Ue.withCredentials?((0,D.l)("BackendSrvRequest","withCredentials","credentials"),"include"):"same-origin");var oe=e(21969),J=(Ue=>(Ue[Ue.Pending=0]="Pending",Ue[Ue.InProgress=1]="InProgress",Ue[Ue.Done=2]="Done",Ue))(J||{});class ce{constructor(Ae=!1){this.state={},this.queue=new n.B,this.updates=new n.B,this.add=(we,We)=>this.queue.next({id:we,options:We,state:0}),this.setInProgress=we=>this.queue.next({id:we,state:1}),this.setDone=we=>this.queue.next({id:we,state:2}),this.getUpdates=()=>this.updates.asObservable(),this.getUpdate=we=>{const We=Object.keys(we).filter(at=>we[at].state===1).length;return{noOfPending:Object.keys(we).filter(at=>we[at].state===0).length,noOfInProgress:We,state:we}},this.publishUpdate=(we,We)=>{this.printState(we,We),this.updates.next(we)},this.printState=(we,We)=>{if(!We)return;const _e=Object.keys(we.state).reduce((at,ut)=>{const Tt={id:ut,state:we.state[ut].state};return at.push(Tt),at},[]);console.log("FetchQueue noOfStarted",we.noOfInProgress),console.log("FetchQueue noOfNotStarted",we.noOfPending),console.log("FetchQueue state",_e)},this.queue.subscribe(we=>{const{id:We,state:_e,options:at}=we;if(this.state[We]||(this.state[We]={state:0,options:{url:""}}),_e===2){delete this.state[We];const Tt=this.getUpdate(this.state);this.publishUpdate(Tt,Ae);return}this.state[We].state=_e,at&&(this.state[We].options=at);const ut=this.getUpdate(this.state);this.publishUpdate(ut,Ae)})}}var pe=e(95864);class xe{constructor(Ae,we,We){const _e=We?.http2Enabled?1e3:5;Ae.getUpdates().pipe((0,p.p)(({noOfPending:at})=>at>0),(0,pe.H)(({state:at,noOfInProgress:ut})=>{const Tt=Object.keys(at).filter(ue=>at[ue].state===J.Pending&&!(0,oe.dr)(at[ue].options.url)).reduce((ue,me)=>{const Pe={id:me,options:at[me].options};return ue.push(Pe),ue},[]),It=Object.keys(at).filter(ue=>at[ue].state===J.Pending&&(0,oe.dr)(at[ue].options.url)).reduce((ue,me)=>{const Pe={id:me,options:at[me].options};return ue.push(Pe),ue},[]),ge=Math.max(_e-ut-Tt.length,0),Ie=It.slice(0,ge);return Tt.concat(Ie)})).subscribe(({id:at,options:ut})=>{we.add(at,ut)})}}class fe{constructor(Ae,we){this.queue=new n.B,this.responses=new n.B,this.add=(We,_e)=>{this.queue.next({id:We,options:_e})},this.getResponses=We=>this.responses.asObservable().pipe((0,p.p)(_e=>_e.id===We)),this.queue.subscribe(We=>{const{id:_e,options:at}=We;Ae.setInProgress(_e),this.responses.next({id:_e,observable:we(at)})})}}var Ee=e(16233);const Se="cancel_all_requests_request_id",ye="grafana-trace-id";class Ve{constructor(Ae){this.inFlightRequests=new n.B,this.HTTP_REQUEST_CANCELED=-1,this.inspectorStream=new n.B,this._tokenRotationInProgress=null,this.deviceID=null,this.dependencies={fromFetch:l.$,appEvents:b.A,contextSrv:Ee.TP,logout:()=>{Ee.TP.setLoggedOut()}},Ae&&(this.dependencies={...this.dependencies,...Ae}),this.noBackendCache=!1,this.internalFetch=this.internalFetch.bind(this),this.fetchQueue=new ce,this.responseQueue=new fe(this.fetchQueue,this.internalFetch),this.initGrafanaDeviceID(),new xe(this.fetchQueue,this.responseQueue,(0,T.zj)())}async initGrafanaDeviceID(){try{const we=await(await t.Ay.load()).get();this.deviceID=we.visitorId}catch(Ae){console.error(Ae)}}async request(Ae){return await(0,s.s)(this.fetch(Ae).pipe((0,d.T)(we=>we.data)))}fetch(Ae){const we=(0,v.A)(),We=this.fetchQueue;return new a.c(_e=>{const at=new r.yU;return at.add(this.responseQueue.getResponses(we).subscribe(ut=>{at.add(ut.observable.subscribe(_e))})),this.fetchQueue.add(we,Ae),function(){We.setDone(we),at.unsubscribe()}})}internalFetch(Ae){Ae.requestId&&this.inFlightRequests.next(Ae.requestId),Ae=this.parseRequestOptions(Ae);const we=(0,O.r)();return we!==null&&we!==""&&C.$.jwtUrlLogin&&C.$.jwtHeaderName&&(Ae.headers=Ae.headers??{},Ae.headers[C.$.jwtHeaderName]=`${we}`),this.deviceID&&(Ae.headers=Ae.headers??{},Ae.headers["X-Grafana-Device-Id"]=`${this.deviceID}`),this.getFromFetchStream(Ae).pipe(this.handleStreamResponse(Ae),this.handleStreamError(Ae),this.handleStreamCancellation(Ae))}resolveCancelerIfExists(Ae){this.inFlightRequests.next(Ae)}cancelAllInFlightRequests(){this.inFlightRequests.next(Se)}async datasourceRequest(Ae){return(0,s.s)(this.fetch(Ae))}parseRequestOptions(Ae){const we=this.dependencies.contextSrv.user?.orgId;return Ae.retry=Ae.retry??0,(0,oe.Lr)(Ae.url)&&(we&&(Ae.headers=Ae.headers??{},Ae.headers["X-Grafana-Org-Id"]=we),Ae.url.startsWith("/")&&(Ae.url=Ae.url.substring(1)),Ae.headers?.Authorization&&(Ae.headers["X-DS-Authorization"]=Ae.headers.Authorization,delete Ae.headers.Authorization),this.noBackendCache&&(Ae.headers=Ae.headers??{},Ae.headers["X-Grafana-NoCache"]="true")),Ae.hideFromInspector===void 0&&(Ae.hideFromInspector=(0,oe.Lr)(Ae.url)&&!(0,oe.dr)(Ae.url)),Ae}getFromFetchStream(Ae){const we=re(Ae),We=z(Ae);return this.dependencies.fromFetch(we,We).pipe((0,c.Z)(async _e=>{const{status:at,statusText:ut,ok:Tt,headers:It,url:ge,type:Ie,redirected:ue}=_e,me=Ae.responseType??(se(It)?"json":void 0),Pe=await ne(_e,me);return{status:at,statusText:ut,ok:Tt,data:Pe,headers:It,url:ge,type:Ie,redirected:ue,config:Ae,traceId:_e.headers.get(ye)??void 0}}))}showApplicationErrorAlert(Ae){}showSuccessAlert(Ae){const{config:we}=Ae;if(we.showSuccessAlert===!1||we.showSuccessAlert===void 0&&(we.method==="GET"||(0,oe.dr)(we.url)||!(0,oe.Lr)(we.url)))return;const We=Ae.data;We?.message&&this.dependencies.appEvents.emit(P.r1.alertSuccess,[We.message])}showErrorAlert(Ae,we){if(Ae.showErrorAlert===!1||Ae.showErrorAlert===void 0&&((0,oe.dr)(Ae.url)||!(0,oe.Lr)(Ae.url)))return;let We="",_e=we.data.message;_e==="Unexpected error"&&we.message&&(_e=we.message),_e.length>80&&(We=_e,_e="Error"),we.status===422&&(We=we.data.message,_e="Validation failed"),this.dependencies.appEvents.emit(we.status<500?P.r1.alertWarning:P.r1.alertError,[_e,We,we.data.traceID])}processRequestError(Ae,we){return we.data=we.data??{message:"Unexpected error"},typeof we.data=="string"&&(we.data={message:we.data,error:we.statusText,response:we.data}),we.data&&!we.data.message&&typeof we.data.error=="string"&&(we.data.message=we.data.error),we.data.message&&setTimeout(()=>{we.isHandled||this.showErrorAlert(Ae,we)},50),this.inspectorStream.next({response:we,requestId:Ae.requestId}),we}handleStreamResponse(Ae){return we=>we.pipe((0,d.T)(We=>{if(!We.ok){const{status:_e,statusText:at,data:ut}=We;throw{status:_e,statusText:at,data:ut,config:Ae,traceId:We.headers.get(ye)??void 0}}return We}),(0,h.M)(We=>{this.showSuccessAlert(We),this.inspectorStream.next({response:We,requestId:Ae.requestId})}))}handleStreamError(Ae){const{isSignedIn:we}=this.dependencies.contextSrv.user;return We=>We.pipe((0,o.l)(_e=>_e.pipe((0,c.Z)((at,ut)=>{const Tt=ut===0&&Ae.retry===0;if(at.status===401&&(0,oe.Lr)(Ae.url)&&Tt&&we){if(at.data?.error?.id==="ERR_TOKEN_REVOKED")return this.dependencies.appEvents.publish(new V.S8({component:U,props:{maxConcurrentSessions:at.data?.error?.maxConcurrentSessions}})),this.dependencies.contextSrv.setRedirectToUrl(),(0,g.$)(()=>at);let It=this.loginPing();return(0,S.m)()&&(0,S.W)()*1e3<Date.now()&&(It=this.rotateToken()),(0,i.H)(It).pipe((0,m.W)(ge=>(ge.status===401&&this.dependencies.logout(),(0,g.$)(ge))))}return(0,g.$)(at)}))),(0,m.W)(_e=>(0,g.$)(()=>this.processRequestError(Ae,_e))))}handleStreamCancellation(Ae){return we=>we.pipe((0,u.Q)(this.inFlightRequests.pipe((0,p.p)(We=>{let _e=!1;return Ae&&Ae.requestId&&Ae.requestId===We&&(_e=!0),We===Se&&(_e=!0),_e}))),(0,f.v)(()=>({type:E.v2.Cancelled,cancelled:!0,data:null,status:this.HTTP_REQUEST_CANCELED,statusText:"Request was aborted",config:Ae})))}getInspectorStream(){return this.inspectorStream}async get(Ae,we,We,_e){return this.request({..._e,method:"GET",url:Ae,params:we,requestId:We})}async delete(Ae,we,We){return this.request({...We,method:"DELETE",url:Ae,data:we})}async post(Ae,we,We){return this.request({...We,method:"POST",url:Ae,data:we})}async patch(Ae,we,We){return this.request({...We,method:"PATCH",url:Ae,data:we})}async put(Ae,we,We){return this.request({...We,method:"PUT",url:Ae,data:we})}withNoBackendCache(Ae){return this.noBackendCache=!0,Ae().finally(()=>{this.noBackendCache=!1})}rotateToken(){return this._tokenRotationInProgress?this._tokenRotationInProgress:(this._tokenRotationInProgress=this.fetch({url:"/api/user/auth-tokens/rotate",method:"POST",retry:1}).pipe((0,y.j)(()=>{this._tokenRotationInProgress=null}),(0,x.u)()),this._tokenRotationInProgress)}loginPing(){return this.fetch({url:"/api/login/ping",method:"GET",retry:1})}search(Ae){return this.get("/api/search",Ae)}getDashboardByUid(Ae){return(0,D.l)("backend_srv","getDashboardByUid(uid)","getDashboardAPI().getDashboardDTO(uid)"),(0,M.n)().getDashboardDTO(Ae)}validateDashboard(Ae){return Promise.resolve({isValid:!1,message:"dashboard validation is not supported"})}getPublicDashboardByUid(Ae){return this.get(`/api/public/dashboards/${Ae}`)}getFolderByUid(Ae,we={}){const We=new URLSearchParams;return we.withAccessControl&&We.set("accesscontrol","true"),this.get(`/api/folders/${Ae}?${We.toString()}`,void 0,void 0,{showErrorAlert:!1})}}const Me=new Ve,Ce=()=>Me},42614:(G,R,e)=>{"use strict";e.d(R,{n:()=>n});var t=e(63415);const n=(a,r)=>{(0,t.x$)().addEvent({type:t.on.Performance,payload:{name:a,value:r}})},s=a=>faro?.api?.pushError(a)},62301:(G,R,e)=>{"use strict";e.d(R,{A:()=>l});var t=e(2543),n=e.n(t),s=e(17172),a=e(2913),r=e(33390);class g{constructor(){}addDashboardImpression(c){const h=this.impressionKey();let o=[];r.A.exists(h)&&(o=JSON.parse(r.A.get(h)),(0,t.isArray)(o)||(o=[])),o=o.filter(m=>c!==m),o.unshift(c),o.length>50&&o.pop(),r.A.set(h,JSON.stringify(o))}async convertToUIDs(){let c=this.getImpressions();const h=(0,t.filter)(c,m=>(0,t.isNumber)(m));if(!h.length)return;const o=await(0,s.AI)().get(`/api/dashboards/ids/${h.join(",")}`);r.A.set(this.impressionKey(),JSON.stringify([...(0,t.filter)(c,m=>(0,t.isString)(m)),...o]))}getImpressions(){const c=r.A.get(this.impressionKey())||"[]";return JSON.parse(c)}async getDashboardOpened(){try{await this.convertToUIDs()}catch{}return(0,t.filter)(this.getImpressions(),h=>(0,t.isString)(h))}impressionKey(){return"dashboard_impressions-"+a.Ay.bootData.user.orgId}}const l=new g},4898:(G,R,e)=>{"use strict";e.d(R,{R:()=>x});let t={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},n={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},s={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},a={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},r=null;for(let v=1;v<20;++v)t[111+v]="f"+v;for(let v=0;v<=9;++v)t[v+96]=v.toString();function g(v){if(v.type==="keypress"){let P=String.fromCharCode(v.which);return v.shiftKey||(P=P.toLowerCase()),P}return t[v.which]?t[v.which]:n[v.which]?n[v.which]:String.fromCharCode(v.which).toLowerCase()}function i(v,P){return v.sort().join(",")===P.sort().join(",")}function l(v){let P=[];return v.shiftKey&&P.push("shift"),v.altKey&&P.push("alt"),v.ctrlKey&&P.push("ctrl"),v.metaKey&&P.push("meta"),P}function d(v){if(v.preventDefault){v.preventDefault();return}v.returnValue=!1}function c(v){if(v.stopPropagation){v.stopPropagation();return}v.cancelBubble=!0}function h(v){return v==="shift"||v==="ctrl"||v==="alt"||v==="meta"}function o(){if(!r){r={};for(let v in t){const P=parseInt(v,10);P>95&&P<112||t.hasOwnProperty(v)&&(r[t[v]]=v)}}return r}function m(v,P,E){return E||(E=o()[v]?"keydown":"keypress"),E==="keypress"&&P.length&&(E="keydown"),E}function u(v){return v==="+"?["+"]:(v=v.replace(/\+{2}/g,"+plus"),v.split("+"))}function p(v,P){let E,D,C,b=[];for(E=u(v),C=0;C<E.length;++C)D=E[C],a[D]&&(D=a[D]),P&&P!=="keypress"&&s[D]&&(D=s[D],b.push("shift")),h(D)&&b.push(D);if(!D)throw new Error("Unable to get key");return P=m(D,b,P),{key:D,modifiers:b,action:P}}function f(v,P){return v===null||v===document?!1:v===P?!0:f(v.parentNode,P)}class y{constructor(P){this._callbacks={},this._directMap={},this._sequenceLevels={},this._resetTimer=void 0,this._ignoreNextKeyup=!1,this._ignoreNextKeypress=!1,this._nextExpectedAction=!1,this._globalCallbacks={},this._resetSequences=E=>{E=E||{};let D=!1,C;for(C in this._sequenceLevels){if(E[C]){D=!0;continue}this._sequenceLevels[C]=0}D||(this._nextExpectedAction=!1)},this._getMatches=(E,D,C,b,T,S)=>{let O,M,I=[],L=C.type;if(!this._callbacks[E])return[];for(L==="keyup"&&h(E)&&(D=[E]),O=0;O<this._callbacks[E].length;++O)if(M=this._callbacks[E][O],!(!b&&M.seq&&this._sequenceLevels[M.seq]!==M.level)&&L===M.action&&(L==="keypress"&&!C.metaKey&&!C.ctrlKey||i(D,M.modifiers))){let B=!b&&M.combo===T,j=b&&M.seq===b&&M.level===S;(B||j)&&this._callbacks[E].splice(O,1),I.push(M)}return I},this._fireCallback=(E,D,C,b)=>{const T=D.target||D.srcElement;T&&T instanceof HTMLElement&&this.stopCallback(D,T,C,b)||E(D,C)===!1&&(d(D),c(D))},this._handleKey=(E,D,C)=>{let b=this._getMatches(E,D,C),T,S={},O=0,M=!1;for(T=0;T<b.length;++T)b[T].seq&&(O=Math.max(O,b[T].level??0));for(T=0;T<b.length;++T){const L=b[T].seq;if(L){if(b[T].level!==O)continue;M=!0,S[L]=1,this._fireCallback(b[T].callback,C,b[T].combo,L);const B=L.lastIndexOf(E),j=L.slice(0,B);for(const[A,K]of Object.entries(this._sequenceLevels))K>0&&A.startsWith(j)&&(S[A]=1);continue}M||this._fireCallback(b[T].callback,C,b[T].combo)}for(const L of this._callbacks[E]??[])L.action===C.type&&L.seq&&L.level===0&&(S[L.seq]=1);let I=C.type==="keypress"&&this._ignoreNextKeypress;C.type===this._nextExpectedAction&&!h(E)&&!I&&this._resetSequences(S),this._ignoreNextKeypress=M&&C.type==="keydown"},this._handleKeyEvent=E=>{if(!(E instanceof KeyboardEvent))throw new Error("Didn't get a KeyboardEvent");const D=E;if(D.repeat)return;typeof D.which!="number"&&(D.which=D.keyCode);let C=g(D);if(C){if(D.type==="keyup"&&this._ignoreNextKeyup===C){this._ignoreNextKeyup=!1;return}this.handleKey(C,l(D),D)}},this._resetSequenceTimer=()=>{clearTimeout(this._resetTimer),this._resetTimer=setTimeout(this._resetSequences,1e3)},this._bindSequence=(E,D,C,b)=>{this._sequenceLevels[E]=0;const T=O=>()=>{this._nextExpectedAction=O,++this._sequenceLevels[E],this._resetSequenceTimer()},S=O=>{this._fireCallback(C,O,E),b!=="keyup"&&(this._ignoreNextKeyup=g(O)),this._resetSequenceTimer()};for(let O=0;O<D.length;++O){let I=O+1===D.length?S:T(b||p(D[O+1]).action);this._bindSingle(D[O],I,b,E,O)}},this._bindSingle=(E,D,C,b,T)=>{this._directMap[E+":"+C]=D,E=E.replace(/\s+/g," ");let S=E.split(" "),O;if(S.length>1){this._bindSequence(E,S,D,C);return}O=p(E,C),this._callbacks[O.key]=this._callbacks[O.key]||[];const M={type:O.action,metaKey:!1,ctrlKey:!1};this._getMatches(O.key,O.modifiers,M,b,E,T);const I={callback:D,modifiers:O.modifiers,action:O.action,seq:b,level:T,combo:E};this._callbacks[O.key][b?"unshift":"push"](I)},this._bindMultiple=(E,D,C)=>{for(let b=0;b<E.length;++b)this._bindSingle(E[b],D,C)},this.bind=(E,D,C)=>(E=E instanceof Array?E:[E],this._bindMultiple(E,D,C),self),this.unbind=(E,D)=>this.bind(E,function(){},D),this.bindGlobal=(E,D,C)=>{if(this.bind(E,D,C),E instanceof Array){for(let b=0;b<E.length;b++)this._globalCallbacks[E[b]]=!0;return}this._globalCallbacks[E]=!0},this.unbindGlobal=(E,D)=>{if(this.unbind(E,D),E instanceof Array){for(let C=0;C<E.length;C++)this._globalCallbacks[E[C]]=!1;return}this._globalCallbacks[E]=!1},this.trigger=(E,D)=>{let C=this;return C._directMap[E+":"+D]&&C._directMap[E+":"+D]({},E),C},this.reset=()=>(this._callbacks={},this._directMap={},this),this.stopCallback=(E,D,C,b)=>{if(this._globalCallbacks[C]||b&&this._globalCallbacks[b]||(" "+D.className+" ").indexOf(" mousetrap ")>-1||f(D,this.target))return!1;if("composedPath"in E&&typeof E.composedPath=="function"){let T=E.composedPath()[0];T!==E.target&&T instanceof HTMLElement&&(D=T)}return!!(D.tagName==="INPUT"||D.tagName==="SELECT"||D.tagName==="TEXTAREA"||"isContentEditable"in D&&D.isContentEditable)},this.handleKey=(...E)=>this._handleKey(...E),this.addKeycodes=E=>{for(let D in E)E.hasOwnProperty(D)&&(t[D]=E[D]);r=null},this.target=P,this.target.addEventListener("keypress",E=>{E instanceof KeyboardEvent&&this._handleKeyEvent(E)}),this.target.addEventListener("keydown",E=>{E instanceof KeyboardEvent&&this._handleKeyEvent(E)}),this.target.addEventListener("keyup",E=>{E instanceof KeyboardEvent&&this._handleKeyEvent(E)})}}const x=new y(document)},2769:(G,R,e)=>{"use strict";e.d(R,{K:()=>i,O:()=>l});var t=e(97594),n=e(3591),s=e(28138),a=e(2913),r=e(10096),g=e(65615);async function i(d,c){const h=a.$W.theme2,o=(0,t.g)(d);if(s.A.publish(new n.E8(o)),h.colors.mode!==o.colors.mode){const p=document.createElement("link");p.rel="stylesheet",p.href=a.$W.bootData.assets[o.colors.mode],p.onload=()=>{const f=document.getElementsByTagName("link");for(let y=0;y<f.length;y++){const x=f[y];x.href&&x.href.includes(`build/grafana.${h.colors.mode}`)&&x.remove()}},document.head.insertBefore(p,document.head.firstChild)}if(c||!r.TP.isSignedIn)return;const m=new g.W("user"),u=await m.load();await m.update({...u,theme:o.colors.mode})}async function l(d){const c=a.$W.theme2;i(c.isDark?"light":"dark",d)}},33390:(G,R,e)=>{"use strict";e.d(R,{A:()=>s});class t{get(r){return window.localStorage[r]}set(r,g){window.localStorage[r]=g}getBool(r,g){return g!==void 0&&!this.exists(r)?g:window.localStorage[r]==="true"}getObject(r,g){let i=g;if(this.exists(r)){const l=window.localStorage[r];try{i=JSON.parse(l)}catch(d){console.error(`Error parsing store object: ${r}. Returning default: ${g}. [${d}]`)}}return i}setObject(r,g){let i;try{i=JSON.stringify(g)}catch(l){throw new Error(`Could not stringify object: ${r}. [${l}]`)}try{this.set(r,i)}catch(l){const d=new Error(`Could not save item in localStorage: ${r}. [${l}]`);throw l instanceof Error&&(d.name=l.name),d}return!0}exists(r){return window.localStorage[r]!==void 0}delete(r){window.localStorage.removeItem(r)}}const s=new t},80714:(G,R,e)=>{"use strict";e.d(R,{F:()=>t});function t(n={}){return{...n,accesscontrol:!0}}},94041:(G,R,e)=>{"use strict";e.d(R,{b:()=>t});const t=(n,s,a)=>(n.splice(a,0,n.splice(s,1)[0]),n)},63917:(G,R,e)=>{"use strict";e.d(R,{gn:()=>s});function t(){const a=navigator.userAgent.indexOf("MSIE")>-1,r=navigator.userAgent.indexOf("Edge/")>-1||navigator.userAgent.indexOf("Edg/")>-1,g=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,i=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),l=/Edge\/([0-9.]+)/.exec(navigator.userAgent);return a&&parseFloat(/Trident\/([0-9.]+)/.exec(navigator.userAgent)[1])<=7||r&&(l&&parseFloat(l[1])<=16||parseFloat(/Edg\/([0-9.]+)/.exec(navigator.userAgent)[1])<=16)||g&&parseFloat(/Firefox\/([0-9.]+)/.exec(navigator.userAgent)[1])<=64?!1:!(i&&parseFloat(/Chrome\/([0-9.]+)/.exec(navigator.userAgent)[1])<=54)}function n(){return/(iPhone|iPad|Mac)/.test(navigator.platform)}function s(){return n()?"\u2318":"ctrl"}},34525:(G,R,e)=>{"use strict";e.d(R,{TS:()=>s});class t{_linkTo(i,l){l<=0&&i.inputEdges.push(this),l>=0&&i.outputEdges.push(this),i.edges.push(this)}link(i,l){if(!i)throw Error("inputNode is required");if(!l)throw Error("outputNode is required");return this.unlink(),this.inputNode=i,this.outputNode=l,this._linkTo(i,1),this._linkTo(l,-1),this}unlink(){let i;const l=this.inputNode,d=this.outputNode;l&&d&&(i=l.edges.indexOf(this),i>-1&&l.edges.splice(i,1),i=d.edges.indexOf(this),i>-1&&d.edges.splice(i,1),i=l.outputEdges.indexOf(this),i>-1&&l.outputEdges.splice(i,1),i=d.inputEdges.indexOf(this),i>-1&&d.inputEdges.splice(i,1))}}class n{constructor(i){this.name=i,this.edges=[],this.inputEdges=[],this.outputEdges=[]}getEdgeFrom(i){return i?typeof i=="object"?this.inputEdges.find(l=>l.inputNode?.name===i.name):this.inputEdges.find(l=>l.inputNode?.name===i):null}getEdgeTo(i){return i?typeof i=="object"?this.outputEdges.find(l=>l.outputNode?.name===i.name):this.outputEdges.find(l=>l.outputNode?.name===i):null}getOptimizedInputEdges(){const i=[];return this.inputEdges.forEach(l=>{l.inputNode?.inputEdges.map(c=>c.inputNode)?.forEach(c=>{const h=c?.getEdgeTo(this.name);h&&i.push(h)})}),this.inputEdges.filter(l=>i.indexOf(l)===-1)}}class s{constructor(){this.nodes={}}createNode(i){const l=new n(i);return this.nodes[i]=l,l}createNodes(i){const l=[];return i.forEach(d=>{l.push(this.createNode(d))}),l}link(i,l){let d=[],c=[];const h=[],o=[];i instanceof Array?d=i:d=[i],l instanceof Array?c=l:c=[l];for(let u=0;u<d.length;u++){const p=d[u];if(typeof p=="string"){const f=this.getNode(p);if(!f)throw Error(`cannot link input node named ${p} since it doesn't exist in graph`);h.push(f)}else h.push(p)}for(let u=0;u<c.length;u++){const p=c[u];if(typeof p=="string"){const f=this.getNode(p);if(!f)throw Error(`cannot link output node named ${p} since it doesn't exist in graph`);o.push(f)}else o.push(p)}const m=[];return h.forEach(u=>{o.forEach(p=>{if(this.willCreateCycle(u,p))throw Error(`cannot link ${u.name} to ${p.name} since it would create a cycle`);m.push(this.createEdge().link(u,p))})}),m}descendants(i){if(!i.length)return new Set;const l=new Set(r(i)?i.map(d=>this.nodes[d]).filter(d=>d!==void 0):i);return this.descendantsRecursive(l)}descendantsRecursive(i,l=new Set){for(const d of i){const c=new Set;for(const{inputNode:h}of d.inputEdges)h&&!l.has(h)&&(l.add(h),c.add(h));this.descendantsRecursive(c,l)}return l}willCreateCycle(i,l){if(i===l)return!0;const d=new Set,c=[l];for(;c.length;){const h=c.pop();if(h===i)return!0;d.add(h);for(const o of h.outputEdges){const m=o.outputNode;m&&!d.has(m)&&c.push(m)}}return!1}createEdge(){return new t}getNode(i){return this.nodes[i]}}const a=g=>{Object.keys(g.nodes).forEach(i=>{const l=g.nodes[i];let d=l.outputEdges.map(h=>h.outputNode?.name).join(", ");d||(d="<none>");let c=l.inputEdges.map(h=>h.inputNode?.name).join(", ");c||(c="<none>"),console.log(`${l.name}:
 - links to:   ${d}
 - links from: ${c}`)})};function r(g){return g.length>0&&typeof g[0]=="string"}},94954:(G,R,e)=>{"use strict";e.d(R,{q:()=>n});var t=e(17172);function n(s){if(typeof s=="string")return s;if(s){if(s instanceof Error)return s.message;if((0,t.NF)(s)){if(s.data&&s.data.message)return s.data.message;if(s.statusText)return s.statusText}}return JSON.stringify(s)}},87490:(G,R,e)=>{"use strict";e.d(R,{HQ:()=>v,Ll:()=>M,MA:()=>S,WP:()=>p,Xe:()=>D,_u:()=>U,bI:()=>b,dY:()=>A,di:()=>L,dr:()=>P,eF:()=>I,o$:()=>E,uE:()=>W,uJ:()=>V,uq:()=>C,w4:()=>T,zT:()=>j,zq:()=>K});var t=e(44329),n=e(62938),s=e(52622),a=e(76885),r=e(71733),g=e(41987),i=e(43127),l=e(77789),d=e(65879),c=e(19347),h=e(11134),o=e(33390),m=e(66718);const u={dedupStrategy:s.fY.none},p="0123456789abcdefghijklmnopqrstuvwxyz",f=(0,t.d_)(p,3),y="grafana.explore.datasource",x=w=>`${y}.${w}`,v=w=>o.A.getObject(x(w)),P=(w,z)=>o.A.setObject(x(w),z);function E(){for(;;){const w=f(3);if(!/^\d+$/.test(w))return w}}async function D(w){const{queries:z,dsRef:N,timeRange:H,scopedVars:Q,adhocFilters:X}=w,ee=(await Promise.allSettled(z.filter(q=>q.datasource?.uid!==m.Uj).map(async q=>{const ae=await(0,c.l)().get(q.datasource||N);return{...ae.interpolateVariablesInQueries?.([q],Q??{},X)[0]||q,...!ae.meta.mixed&&{datasource:ae.getRef()}}}))).filter(q=>q.status==="fulfilled").map(q=>q.value),Z=JSON.stringify({[E()]:{range:(0,a.sQ)(H.raw),queries:ee,datasource:N?.uid}});return r.I.assureBaseUrl(a.kM.renderUrl("/explore",{panes:Z,schemaVersion:1}))}function C(w){return`explore_${w}`}function b(w,z,N,H,Q,X,ee){const Z=Number.parseInt(w,36),{interval:q,intervalMs:ae}=F(H,N.minInterval,N.maxDataPoints),k={app:g.Jk.Explore,timezone:X||i.lE,startTime:Date.now(),interval:q,intervalMs:ae,panelId:Z,targets:z,range:H,requestId:C(w),rangeRaw:H.raw,scopedVars:{__interval:{text:q,value:q},__interval_ms:{text:ae,value:ae},...ee},maxDataPoints:N.maxDataPoints,liveStreaming:N.liveStreaming,skipQueryCache:!0};return{queries:z,request:k,scanning:Q,id:O(),done:!1}}const T=({key:w,...z})=>z,S=(w,z)=>{if(w==null)return"";try{return JSON.stringify(w,null,z)}catch(N){console.error(N)}return""};function O(w=0){return`Q-${(0,n.A)()}-${w}`}async function M(w,z=0,N){let H,Q,X;return N?Q=N:w.length>0&&w[w.length-1].datasource?Q=w[w.length-1].datasource:(H=await(0,c.l)().get(),X=H.getDefaultQuery?.(g.Jk.Explore),Q=H.getRef()),H||(H=await(0,c.l)().get(Q),X=H.getDefaultQuery?.(g.Jk.Explore)),{...X,refId:(0,l.M)(w),key:O(z),datasource:Q}}const I=(w,z,N=0)=>{const H=O(N),Q=w.refId||(0,l.M)(z);return{...w,refId:Q,key:H}};async function L(w,z){if(w&&typeof w=="object"&&w.length>0){const N=[];for(let H=0;H<w.length;H++){const Q=w[H],X=O(H);let ee=Q.refId;ee||(ee=(0,l.M)(N));let Z=!0;if(Q.datasource)try{await(0,c.l)().get(Q.datasource.uid)}catch{console.error("One of the queries has a datasource that is no longer available and was removed."),Z=!1}Z&&N.push({...Q,refId:ee,key:X})}return N}try{const N=z??(await(0,c.l)().get()).getRef();return[await M(w??[],void 0,N)]}catch{return[]}}const B=["refId","key","context","datasource"];function j(w){return w&&w.some(z=>Object.entries(z).filter(([H,Q])=>B.indexOf(H)===-1).filter(([H,Q])=>Q).length>0)}const A=w=>w.reduce((N,H,Q)=>{const X=H.datasource?.uid||H.key;return N.concat(`${X}-${Q}`)},[]),K=(w,z,N)=>d.convertRawToRange(z,w,N),W=w=>h.cC.isLive(w)?s.uH.Ascending:s.uH.Descending,U=w=>{w&&w.unsubscribe()};function F(w,z,N){return N?d.calculateInterval(w,N,z):{interval:"1s",intervalMs:1e3}}const V=w=>{if(navigator.clipboard&&window.isSecureContext)navigator.clipboard.writeText(w);else{const z=document.createElement("textarea");z.value=w,document.body.appendChild(z),z.select(),document.execCommand("copy"),document.body.removeChild(z)}}},78827:(G,R,e)=>{"use strict";e.r(R),e.d(R,{default:()=>t});function t(n,s){s=s||{};const a=s.delimiter||".";let r=s.maxDepth||3,g=1;const i={};function l(d,c){Object.entries(d).forEach(([h,o])=>{const m=s?.safe&&Array.isArray(o),p=Object.prototype.toString.call(o)==="[object Object]",f=c?c+a+h:h;if(s?.maxDepth||(r=g+1),!m&&p&&Object.keys(o).length&&g<r)return++g,l(o,f);i[f]=o})}return l(n,null),i}},68576:(G,R,e)=>{"use strict";e.d(R,{A:()=>i});var t=e(95344),n=e(54479),s=e(65879),a=e(83195);const g={valueFormats:{},intervalRegex:/(\d+(?:\.\d+)?)(ms|[Mwdhmsy])/,intervalsInSeconds:{y:31536e3,M:2592e3,w:604800,d:86400,h:3600,m:60,s:1,ms:.001},regexEscape:l=>((0,t.l)("kbn.ts","kbn.regexEscape()","escapeRegex from @grafana/data"),(0,n.$f)(l)),roundInterval:l=>((0,t.l)("kbn.ts","kbn.roundInterval()","@grafana/data"),s.roundInterval(l)),secondsToHms:l=>((0,t.l)("kbn.ts","kbn.secondsToHms()","@grafana/data"),s.secondsToHms(l)),secondsToHhmmss:l=>{const d=[],c=Math.floor(l/3600),h=Math.floor(l%3600/60),o=Math.floor(l%3600%60);return c>9?d.push(""+c):d.push("0"+c),h>9?d.push(""+h):d.push("0"+h),o>9?d.push(""+o):d.push("0"+o),d.join(":")},toPercent:(l,d)=>Math.floor(l/d*1e4)/100+"%",addSlashes:l=>l.replace(/[\'\"\\0]/g,"\\$&"),describeInterval:l=>((0,t.l)("kbn.ts","kbn.describeInterval()","@grafana/data"),s.describeInterval(l)),intervalToSeconds:l=>((0,t.l)("kbn.ts","rangeUtil.intervalToSeconds()","@grafana/data"),s.intervalToSeconds(l)),intervalToMs:l=>((0,t.l)("kbn.ts","rangeUtil.intervalToMs()","@grafana/data"),s.intervalToMs(l)),calculateInterval:(l,d,c)=>((0,t.l)("kbn.ts","kbn.calculateInterval()","@grafana/data"),s.calculateInterval(l,d,c)),queryColorDot:(l,d)=>'<div class="icon-circle" style="'+["display:inline-block","color:"+l,"font-size:"+d+"px"].join(";")+'"></div>',slugifyForUrl:l=>l.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-"),stringToJsRegex:l=>((0,t.l)("kbn.ts","kbn.stringToJsRegex()","@grafana/data"),(0,n.dO)(l)),toFixed:(l,d)=>{if(l===null)return"";const c=d?Math.pow(10,Math.max(0,d)):1,h=String(Math.round(l*c)/c);if(h.indexOf("e")!==-1||l===0)return h;if(d!=null){const o=h.indexOf("."),m=o===-1?0:h.length-o-1;if(m<d)return(m?h:h+".")+String(c).slice(1,d-m+1)}return h},toFixedScaled:(l,d,c,h,o)=>c===null?g.toFixed(l,d)+o:g.toFixed(l,c+h)+o,roundValue:(l,d)=>{if(l===null)return null;const c=Math.pow(10,d),h=(c*l).toFixed(d);return Math.round(parseFloat(h))/c},getUnitFormats:a.Ke};typeof Proxy<"u"?g.valueFormats=new Proxy(g.valueFormats,{get(l,d,c){if(typeof d!="string")throw{message:`Value format ${String(d)} is not a string`};const h=(0,a.j_)(d);return h?(o,m,u,p)=>(0,a.cN)(h(o,m,u,p?"utc":"browser")):Reflect.get(l,d,c)}}):g.valueFormats=(0,a.uH)();const i=g},78160:(G,R,e)=>{"use strict";e.d(R,{j:()=>n,z:()=>s});var t=e(42614);function n(a){if(!(!performance||!performance.mark))try{performance.mark(`${a}_started`)}catch(r){console.error(`[Metrics] Failed to startMeasure ${a}`,r)}}function s(a){if(!(!performance||!performance.mark))try{const r=`${a}_started`,g=`${a}_completed`,i=`${a}_measured`;performance.mark(g);const l=performance.measure(i,r,g);return(0,t.n)(`${a}_ms`,l.duration),performance.clearMarks(r),performance.clearMarks(g),performance.clearMeasures(i),l}catch(r){console.error(`[Metrics] Failed to stopMeasure ${a}`,r);return}}},36689:(G,R,e)=>{"use strict";e.d(R,{C:()=>s,o:()=>a});var t=e(32264),n=e(8484);function s(r){switch(r){case"home":return(0,n.t)("nav.home.title","Home");case"home-setup-guide":return(0,n.t)("nav.setup-guide.title","Setup guide");case"new":return(0,n.t)("nav.new.title","New");case"create":return(0,n.t)("nav.create.title","Create");case"create-dashboard":return(0,n.t)("nav.create-dashboard.title","Dashboard");case"folder":return(0,n.t)("nav.create-folder.title","Folder");case"import":return(0,n.t)("nav.create-import.title","Import dashboard");case"alert":return(0,n.t)("nav.create-alert.title","New alert rule");case"bookmarks":return(0,n.t)("nav.bookmarks.title","Bookmarks");case"bookmarks-empty":return(0,n.t)("nav.bookmarks-empty.title","Bookmark pages for them to appear here");case"starred":return(0,n.t)("nav.starred.title","Starred");case"starred-empty":return(0,n.t)("nav.starred-empty.title","Your starred dashboards will appear here");case"dashboards":return(0,n.t)("nav.dashboards.title","Dashboards");case"dashboards/browse":return(0,n.t)("nav.dashboards.title","Dashboards");case"dashboards/playlists":return(0,n.t)("nav.playlists.title","Playlists");case"dashboards/snapshots":return(0,n.t)("nav.snapshots.title","Snapshots");case"dashboards/library-panels":return(0,n.t)("nav.library-panels.title","Library panels");case"reports":return(0,n.t)("nav.reporting.title","Reporting");case"dashboards/public":return t.$.featureToggles.newDashboardSharingComponent?(0,n.t)("nav.shared-dashboard.title","Shared dashboards"):(0,n.t)("nav.public.title","Public dashboards");case"dashboards/recently-deleted":return(0,n.t)("nav.recently-deleted.title","Recently deleted");case"dashboards/new":return(0,n.t)("nav.new-dashboard.title","New dashboard");case"dashboards/folder/new":return(0,n.t)("nav.new-folder.title","New folder");case"dashboards/import":return(0,n.t)("nav.create-import.title","Import dashboard");case"scenes":return(0,n.t)("nav.scenes.title","Scenes");case"explore":return(0,n.t)("nav.explore.title","Explore");case"alerting":return(0,n.t)("nav.alerting.title","Alerting");case"plugin-page-grafana-oncall-app":return(0,n.t)("nav.oncall.title","OnCall");case"alerting-legacy":return(0,n.t)("nav.alerting-legacy.title","Alerting (legacy)");case"alerting-upgrade":return(0,n.t)("nav.alerting-upgrade.title","Alerting upgrade");case"alert-home":return(0,n.t)("nav.alerting-home.title","Home");case"alert-list":return(0,n.t)("nav.alerting-list.title","Alert rules");case"alert-list-legacy":return(0,n.t)("nav.alert-list-legacy.title","Alert rules");case"receivers":return(0,n.t)("nav.alerting-receivers.title","Contact points");case"am-routes":return(0,n.t)("nav.alerting-am-routes.title","Notification policies");case"channels":return(0,n.t)("nav.alerting-channels.title","Notification channels");case"silences":return(0,n.t)("nav.alerting-silences.title","Silences");case"groups":return(0,n.t)("nav.alerting-groups.title","Active notifications");case"alerting-admin":return(0,n.t)("nav.alerting-admin.title","Settings");case"cfg":return(0,n.t)("nav.config.title","Administration");case"cfg/general":return(0,n.t)("nav.config-general.title","General");case"cfg/plugins":return(0,n.t)("nav.config-plugins.title","Plugins and data");case"cfg/access":return(0,n.t)("nav.config-access.title","Users and access");case"datasources":return(0,n.t)("nav.datasources.title","Data sources");case"authentication":return(0,n.t)("nav.authentication.title","Authentication");case"licensing":return(0,n.t)("nav.statistics-and-licensing.title","Statistics and licensing");case"recordedQueries":return(0,n.t)("nav.recorded-queries.title","Recorded queries");case"correlations":return(0,n.t)("nav.correlations.title","Correlations");case"users":return(0,n.t)("nav.users.title","Users");case"teams":return(0,n.t)("nav.teams.title","Teams");case"plugins":return(0,n.t)("nav.plugins.title","Plugins");case"org-settings":return(0,n.t)("nav.org-settings.title","Default preferences");case"apikeys":return(0,n.t)("nav.api-keys.title","API keys");case"serviceaccounts":return(0,n.t)("nav.service-accounts.title","Service accounts");case"admin":return(0,n.t)("nav.admin.title","Server admin");case"support-bundles":return(0,n.t)("nav.support-bundles.title","Support bundles");case"global-users":return(0,n.t)("nav.global-users.title","Users");case"global-orgs":return(0,n.t)("nav.global-orgs.title","Organizations");case"server-settings":return(0,n.t)("nav.server-settings.title","Settings");case"storage":return(0,n.t)("nav.storage.title","Storage");case"migrate-to-cloud":return(0,n.t)("nav.migrate-to-cloud.title","Migrate to Grafana Cloud");case"upgrading":return(0,n.t)("nav.upgrading.title","Stats and license");case"monitoring":return(0,n.t)("nav.monitoring.title","Observability");case"infrastructure":return(0,n.t)("nav.infrastructure.title","Infrastructure");case"frontend":return(0,n.t)("nav.frontend.title","Frontend");case"apps":return(0,n.t)("nav.apps.title","More apps");case"alerts-and-incidents":return(0,n.t)("nav.alerts-and-incidents.title","Alerts & IRM");case"testing-and-synthetics":return(0,n.t)("nav.testing-and-synthetics.title","Testing & synthetics");case"plugin-page-grafana-incident-app":return(0,n.t)("nav.incidents.title","Incident");case"plugin-page-grafana-ml-app":return(0,n.t)("nav.machine-learning.title","Machine learning");case"plugin-page-grafana-slo-app":return(0,n.t)("nav.slo.title","SLO");case"plugin-page-k6-app":return(0,n.t)("nav.k6.title","Performance");case"monitoring":return(0,n.t)("nav.observability.title","Observability");case"plugin-page-grafana-k8s-app":return(0,n.t)("nav.kubernetes.title","Kubernetes");case"plugin-page-grafana-app-observability-app":return(0,n.t)("nav.application.title","Application");case"plugin-page-grafana-pyroscope-app":return(0,n.t)("nav.profiles.title","Profiles");case"plugin-page-grafana-kowalski-app":return(0,n.t)("nav.frontend-app.title","Frontend");case"plugin-page-grafana-synthetic-monitoring-app":return(0,n.t)("nav.synthetics.title","Synthetics");case"help":return(0,n.t)("nav.help.title","Help");case"profile/settings":return(0,n.t)("nav.profile/settings.title","Profile");case"profile/notifications":return(0,n.t)("nav.profile/notifications.title","Notification history");case"profile/password":return(0,n.t)("nav.profile/password.title","Change password");case"sign-out":return(0,n.t)("nav.sign-out.title","Sign out");case"search":return(0,n.t)("nav.search-dashboards.title","Search dashboards");case"connections":return(0,n.t)("nav.connections.title","Connections");case"connections-add-new-connection":return(0,n.t)("nav.add-new-connections.title","Add new connection");case"standalone-plugin-page-/connections/collector":return(0,n.t)("nav.collector.title","Collector");case"connections-datasources":return(0,n.t)("nav.data-sources.title","Data sources");case"standalone-plugin-page-/connections/infrastructure":return(0,n.t)("nav.integrations.title","Integrations");case"standalone-plugin-page-/connections/connect-data":return(0,n.t)("nav.connect-data.title","Connect data");case"standalone-plugin-page-/connections/private-data-source-connections":return(0,n.t)("nav.private-data-source-connections.title","Private data source connect");case"plugin-page-grafana-detect-app":return(0,n.t)("nav.detect.title","Detect");case"plugin-page-grafana-quaderno-app":return(0,n.t)("nav.grafana-quaderno.title","Grafana Quaderno");default:return}}function a(r){switch(r){case"dashboards":return(0,n.t)("nav.dashboards.subtitle","Create and manage dashboards to visualize your data");case"dashboards/browse":return(0,n.t)("nav.dashboards.subtitle","Create and manage dashboards to visualize your data");case"manage-folder":return(0,n.t)("nav.manage-folder.subtitle","Manage folder dashboards and permissions");case"dashboards/playlists":return(0,n.t)("nav.playlists.subtitle","Groups of dashboards that are displayed in a sequence");case"dashboards/snapshots":return(0,n.t)("nav.snapshots.subtitle","Interactive, publically available, point-in-time representations of dashboards and panels");case"dashboards/public":return t.$.featureToggles.newDashboardSharingComponent?(0,n.t)("nav.shared-dashboard.subtitle","Manage your organization's externally shared dashboards"):void 0;case"dashboards/library-panels":return(0,n.t)("nav.library-panels.subtitle","Reusable panels that can be added to multiple dashboards");case"dashboards/recently-deleted":return(0,n.t)("nav.recently-deleted.subtitle","Any items listed here for more than 30 days will be automatically deleted.");case"alerting":return(0,n.t)("nav.alerting.subtitle","Learn about problems in your systems moments after they occur");case"alerting-upgrade":return(0,n.t)("nav.alerting-upgrade.subtitle","Upgrade your existing legacy alerts and notification channels to the new Grafana Alerting");case"alerting-admin":return(0,n.t)("nav.alerting-admin.subtitle","Manage Alertmanager configurations");case"alert-list":return(0,n.t)("nav.alerting-list.subtitle","Rules that determine whether an alert will fire");case"receivers":return(0,n.t)("nav.alerting-receivers.subtitle","Choose how to notify your contact points when an alert instance fires");case"am-routes":return(0,n.t)("nav.alerting-am-routes.subtitle","Determine how alerts are routed to contact points");case"silences":return(0,n.t)("nav.alerting-silences.subtitle","Stop notifications from one or more alerting rules");case"groups":return(0,n.t)("nav.alerting-groups.subtitle","See grouped alerts with active notifications");case"datasources":return(0,n.t)("nav.datasources.subtitle","Add and configure data sources");case"correlations":return(0,n.t)("nav.correlations.subtitle","Add and configure correlations");case"users":return(0,n.t)("nav.users.subtitle","Invite and assign roles to users");case"teams":return(0,n.t)("nav.teams.subtitle","Groups of users that have common dashboard and permission needs");case"plugins":return(0,n.t)("nav.plugins.subtitle","Extend the Grafana experience with plugins");case"org-settings":return(0,n.t)("nav.org-settings.subtitle","Manage preferences across an organization");case"apikeys":return(0,n.t)("nav.api-keys.subtitle","Manage and create API keys that are used to interact with Grafana HTTP APIs");case"serviceaccounts":return(0,n.t)("nav.service-accounts.subtitle","Use service accounts to run automated workloads in Grafana");case"groupsync":return(0,n.t)("nav.groupsync.subtitle","Manage mappings of Identity Provider groups to Grafana Roles");case"global-users":return(0,n.t)("nav.global-users.subtitle","Manage users in Grafana");case"global-orgs":return(0,n.t)("nav.global-orgs.subtitle","Isolated instances of Grafana running on the same server");case"server-settings":return(0,n.t)("nav.server-settings.subtitle","View the settings defined in your Grafana config");case"storage":return(0,n.t)("nav.storage.subtitle","Manage file storage");case"migrate-to-cloud":return(0,n.t)("nav.migrate-to-cloud.subtitle","Copy configuration from your self-managed installation to a cloud stack");case"support-bundles":return(0,n.t)("nav.support-bundles.subtitle","Download support bundles");case"admin":return(0,n.t)("nav.admin.subtitle","Manage server-wide settings and access to resources such as organizations, users, and licenses");case"cfg/general":return(0,n.t)("nav.config-general.subtitle","Manage default preferences and settings across Grafana");case"cfg/plugins":return(0,n.t)("nav.config-plugins.subtitle","Install plugins and define the relationships between data");case"cfg/access":return(0,n.t)("nav.config-access.subtitle","Configure access for individual users, teams, and service accounts");case"apps":return(0,n.t)("nav.apps.subtitle","App plugins that extend the Grafana experience");case"monitoring":return(0,n.t)("nav.monitoring.subtitle","Out-of-the-box observability solutions");case"infrastructure":return(0,n.t)("nav.infrastructure.subtitle","Understand your infrastructure's health");case"frontend":return(0,n.t)("nav.frontend.subtitle","Gain real user monitoring insights");case"alerts-and-incidents":return(0,n.t)("nav.alerts-and-incidents.subtitle","Alerting and incident management apps");case"testing-and-synthetics":return(0,n.t)("nav.testing-and-synthetics.subtitle","Optimize performance with k6 and Synthetic Monitoring insights");case"connections-add-new-connection":return(0,n.t)("nav.connections.subtitle","Browse and create new connections");case"connections-datasources":return(0,n.t)("nav.data-sources.subtitle","View and manage your connected data source connections");case"connections-private-data-source-connections":return(0,n.t)("nav.private-data-source-connections.subtitle","Query data that lives within a secured network without opening the network to inbound traffic from Grafana Cloud. Learn more in our docs.");default:return}}},28874:(G,R,e)=>{"use strict";e.d(R,{v:()=>s});var t=e(2543),n=e.n(t);function s(a){return(0,t.isArray)(a)?a.map(s):(0,t.isPlainObject)(a)?Object.keys(a).sort().reduce((r,g)=>{const i=a[g];return i!=null&&(r[g]=s(i)),r},{}):a}},21969:(G,R,e)=>{"use strict";e.d(R,{Ih:()=>n,Lr:()=>r,U7:()=>s,dr:()=>a,fE:()=>g});var t=e(77789);function n(i){const l=["refId","hide","key","queryType","datasource"];for(const d in i)if(d!=="label"&&!l.includes(d))return!1;return!0}function s(i,l,d){const c={...l,refId:(0,t.M)(i),hide:!1};return!c.datasource&&d&&(c.datasource=d),[...i,c]}function a(i){return i.indexOf("api/datasources/proxy")!==-1||i.indexOf("api/ds/query")!==-1}function r(i){return!i.match(/^http/)}function g(i){return i||void 0}},81523:(G,R,e)=>{"use strict";e.d(R,{Ax:()=>M,DI:()=>f,Gx:()=>x,IA:()=>b,NC:()=>D,TR:()=>L,U3:()=>C,X1:()=>v,cX:()=>E,ev:()=>S,l0:()=>p,oU:()=>P,rs:()=>y,x8:()=>I,xB:()=>u.x});var t=e(2543),n=e.n(t),s=e(76885),a=e(72724),r=e(19347),g=e(82467),i=e(3169),l=e(8484),d=e(99140),c=e(38877),h=e(75533),o=e(11401),m=e(16233),u=e(91650);async function p(j){const{queries:A,localOverride:K,datasource:W,starred:U,comment:F,showNotif:V}=j,w=V?.quotaExceededError??!0,z=V?.limitExceededWarning??!0,N=V?.otherErrors??!0,H=A&&A.filter(Q=>B(Q));if(H.length>0){let Q=!1,X=!1,ee;try{ee=(await(K?(0,o.tU)():(0,o.a)()).addToRichHistory({datasourceUid:W.uid,datasourceName:W.name??"",queries:H,starred:U,comment:F??""})).warning}catch(Z){return Z instanceof Error&&(Z.name===c.m.StorageFull?(Q=!0,w&&(0,d.JD)((0,g.dx)((0,i.gi)(Z.message)))):N&&Z.name!==c.m.DuplicatedEntry&&(0,d.JD)((0,g.dx)((0,i.gi)((0,l.t)("explore.rich-history-utils-notification.update-failed","Rich History update failed"),Z.message)))),{richHistoryStorageFull:Q,limitExceeded:X}}return ee&&ee.type===c.C.LimitExceeded&&(X=!0,z&&(0,d.JD)((0,g.dx)((0,i.q8)(ee.message)))),{richHistoryStorageFull:Q,limitExceeded:X}}return{}}async function f(j){const A={...j,from:j.to===void 0?j.to:(0,h.wQ)(j.to,{isLastTs:!0,tz:m.TP.user?.timezone}),to:j.from===void 0?j.from:(0,h.wQ)(j.from,{isLastTs:!0,tz:m.TP.user?.timezone})};return await(0,o.a)().getRichHistory(A)}async function y(j){await(0,o.a)().updateSettings(j)}async function x(){return await(0,o.a)().getSettings()}async function v(){return(0,o.a)().deleteAll()}async function P(j,A){try{return await(0,o.a)().updateStarred(j,A)}catch(K){K instanceof Error&&(0,d.JD)((0,g.dx)((0,i.gi)((0,l.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),K.message)));return}}async function E(j,A){try{return await(0,o.a)().updateComment(j,A)}catch(K){K instanceof Error&&(0,d.JD)((0,g.dx)((0,i.gi)((0,l.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),K.message)));return}}async function D(j){try{return await(0,o.a)().deleteRichHistory(j),j}catch(A){A instanceof Error&&(0,d.JD)((0,g.dx)((0,i.gi)((0,l.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),A.message)));return}}const C=j=>{const A={range:{from:(0,l.t)("explore.rich-history-utils.default-from","now-1h"),to:(0,l.t)("explore.rich-history-utils.default-to","now")},datasource:j.datasourceName,queries:j.queries},K=(0,s.Pp)(A),W=/.*(?=\/explore)/.exec(`${window.location.href}`)[0];return s.kM.renderUrl(`${W}/explore`,{left:K})},b=j=>{let A;switch(j){case 0:A=(0,l.t)("explore.rich-history-utils.today","today");break;case 1:A=(0,l.t)("explore.rich-history-utils.yesterday","yesterday");break;case 7:A=(0,l.t)("explore.rich-history-utils.a-week-ago","a week ago");break;case 14:A=(0,l.t)("explore.rich-history-utils.two-weeks-ago","two weeks ago");break;default:A=(0,l.t)("explore.rich-history-utils.days-ago","{{num}} days ago",{num:`${j}`})}return A};function T(j){return(0,a.LE)(j,{format:"MMMM D"})}function S(j){const A=(0,t.omit)(j,["key","refId","datasource"]);return JSON.stringify(A)}function O(j,A){let K="";return A===u.x.DatasourceAZ||A===u.x.DatasourceZA?K=j.datasourceName:K=T(j.createdAt),K}function M(j,A){return A?.getQueryDisplayText?A.getQueryDisplayText(j):S(j)}function I(j,A){let K={};return j.forEach(W=>{let U=O(W,A);U in K?K[U]=[...K[U],W]:K[U]=[W]}),K}function L(){return(0,r.l)().getList({mixed:!0}).map(j=>({name:j.name,uid:j.uid}))}function B(j){const A=(0,t.omit)(j,["key","refId","datasource"]);return Object.keys(A).length>0}},91650:(G,R,e)=>{"use strict";e.d(R,{x:()=>t});var t=(n=>(n.Descending="Descending",n.Ascending="Ascending",n.DatasourceAZ="Datasource A-Z",n.DatasourceZA="Datasource Z-A",n))(t||{})},7030:(G,R,e)=>{"use strict";e.d(R,{$l:()=>x,Sp:()=>f,VN:()=>y,VP:()=>p,fn:()=>u});var t=e(41811),n=e(32264),s=e(17172),a=e(39601),r=e(84537),g=e(82467),i=e(3169),l=e(11982),d=e(99140),c=e(8484),h=e(87490);function o(){return`${window.location.protocol}//${window.location.host}${n.$.appSubUrl}`}function m(v){let P=v.replace(o(),"");return P.startsWith("/")?P.substring(1,P.length):P}const u=(0,t.A)(async function(v){try{return(await(0,s.AI)().post("/api/short-urls",{path:m(v)})).url}catch(P){console.error("Error when creating shortened link: ",P),(0,d.JD)((0,g.dx)((0,i.gi)("Error generating shortened link")))}}),p=async v=>{const P=await u(v);P?((0,h.uJ)(P),(0,d.JD)((0,g.dx)((0,i.tZ)("Shortened link copied to clipboard")))):(0,d.JD)((0,g.dx)((0,i.gi)("Error generating shortened link")))},f=async(v,P,E)=>{const D=y(v,P,E);if(P.useShortUrl)return await p(D);(0,h.uJ)(D),(0,d.JD)((0,g.dx)((0,i.tZ)((0,c.t)("link.share.copy-to-clipboard","Link copied to clipboard"))))},y=(v,P,E)=>{const D=a.Ny.getLocation(),C=r.jh.getTimeRange(E??v),b=x(P,C,E);return(0,l.uZ)({uid:v.state.uid,slug:v.state.meta.slug,currentQueryParams:D.search,updateQuery:b,absolute:!0})},x=(v,P,E)=>{const D={};return E&&(D.viewPanel=E.state.key),v.useAbsoluteTimeRange&&(D.from=P.state.value.from.toISOString(),D.to=P.state.value.to.toISOString()),v.theme!=="current"&&(D.theme=v.theme),D}},92247:(G,R,e)=>{"use strict";e.r(R),e.d(R,{getPrecision:()=>r,getScaledDecimals:()=>n,getStringPrecision:()=>g,grafanaTimeFormat:()=>s,logp:()=>a,tickStep:()=>t});function t(i,l,d){const c=Math.sqrt(50),h=Math.sqrt(10),o=Math.sqrt(2),m=Math.abs(l-i)/Math.max(0,d);let u=Math.pow(10,Math.floor(Math.log(m)/Math.LN10));const p=m/u;return p>=c?u*=10:p>=h?u*=5:p>=o&&(u*=2),l<i?-u:u}function n(i,l){return i-Math.floor(Math.log(l)/Math.LN10)}function s(i,l,d){if(l&&d&&i){const c=d-l,h=c/i/1e3,o=864e5,m=31536e6;return h<=45?"HH:mm:ss":h<=7200||c<=o?"HH:mm":h<=8e4?"MM/DD HH:mm":h<=2419200||c<=m?"MM/DD":"YYYY-MM"}return"HH:mm"}function a(i,l){return Math.log(i)/Math.log(l)}function r(i){const l=i.toString();return g(l)}function g(i){if(isNaN(i))return 0;const l=i.indexOf(".");return l===-1?0:i.length-l-1}},80582:(G,R,e)=>{"use strict";e.d(R,{Wb:()=>n,Zk:()=>s,zG:()=>a});var t=e(47232);const n=(r,g)=>{const i={from:(0,t.yT)(g.from),to:(0,t.yT)(g.to)},l=(i.to.valueOf()-i.from.valueOf())/2;let d,c;return r===-1?(d=i.to.valueOf()-l,c=i.from.valueOf()-l):r===1?(d=i.to.valueOf()+l,c=i.from.valueOf()+l,d>Date.now()&&i.to.valueOf()<Date.now()&&(d=Date.now(),c=i.from.valueOf())):(d=i.to.valueOf(),c=i.from.valueOf()),{from:c,to:d}},s=(r,g)=>{const i=r.to.valueOf()-r.from.valueOf(),l=r.to.valueOf()-i/2,d=i===0?3e4:i*g,c=l+d/2;return{from:l-d/2,to:c}};async function a(){const r=await navigator.clipboard.readText();let g;try{return g=JSON.parse(r),!g.from||!g.to?{range:r,isError:!0}:{range:g,isError:!1}}catch{return{range:r,isError:!0}}}},94515:(G,R,e)=>{"use strict";e.d(R,{iU:()=>n});var t=e(47232);function n(r,g){if(!(r.fromDayOfWeek||r.from)&&!(r.toDayOfWeek||r.to))return[];const i={...r};i.from&&!i.to&&(i.to=i.from),!i.from&&i.to&&(i.from=i.to);const l={from:s(i.from),to:s(i.to)};if(!i.fromDayOfWeek&&i.toDayOfWeek&&(i.fromDayOfWeek=i.toDayOfWeek),!i.toDayOfWeek&&i.fromDayOfWeek&&(i.toDayOfWeek=i.fromDayOfWeek),i.fromDayOfWeek&&(l.from.dayOfWeek=Number(i.fromDayOfWeek)),i.toDayOfWeek&&(l.to.dayOfWeek=Number(i.toDayOfWeek)),l.from.dayOfWeek&&l.from.h==null&&l.from.m==null&&(l.from.h=0,l.from.m=0,l.from.s=0),l.to.dayOfWeek&&l.to.h==null&&l.to.m==null&&(l.to.h=23,l.to.m=59,l.to.s=59),!l.from||!l.to)return[];l.from.h==null&&(l.from.h=0),l.to.h==null&&(l.to.h=23);const d=[],c=(0,t.KQ)(g.from).utc();for(c.set("hour",0),c.set("minute",0),c.set("second",0),c.set("millisecond",0),c.add(l.from.h,"hours"),c.add(l.from.m,"minutes"),c.add(l.from.s,"seconds");c.unix()<=g.to.unix();){for(;l.from.dayOfWeek&&l.from.dayOfWeek!==c.isoWeekday();)c.add(24,"hours");if(c.unix()>g.to.unix())break;const h=(0,t.KQ)(c).utc();if(h.hour)if(l.from.h<=l.to.h)h.add(l.to.h-l.from.h,"hours");else if(l.from.h>l.to.h)for(;h.hour()!==l.to.h;)h.add(1,"hours");else for(h.add(24-l.from.h,"hours");h.hour()!==l.to.h;)h.add(1,"hours");for(h.set("minute",l.to.m??0),h.set("second",l.to.s??0);l.to.dayOfWeek&&l.to.dayOfWeek!==h.isoWeekday();)h.add(24,"hours");c.unix()<g.from.unix()&&h.unix()<g.from.unix()||c.unix()>g.to.unix()&&h.unix()>g.to.unix()||d.push({from:c.valueOf(),to:h.valueOf()}),c.add(24,"hours")}return d}function s(r){const g={};if(!r?.length)return g;const i=r.split(":");return i?.length&&(g.h=Math.min(23,Math.max(0,Number(i[0]))),i.length>1&&(g.m=Math.min(60,Math.max(0,Number(i[1]))),i.length>2&&(g.s=Math.min(60,Math.max(0,Number(i[2])))))),g}function a(r){if(!r||r.h==null&&r.m==null&&r.s==null)return"";let g=String(r.h??0).padStart(2,"0")+":"+String(r.m??0).padStart(2,"0");return r.s!=null&&(g+=String(r.s??0).padStart(2,"0")),g}},67027:(G,R,e)=>{"use strict";e.d(R,{r:()=>n});let t="";const n=()=>{const a=new URLSearchParams(window.location.search).get("auth_token");return a!==null&&a!==""?(t=a,a):t}},93197:(G,R,e)=>{"use strict";e.d(R,{l:()=>g});var t=e(74848),n=e(32196),s=e(36663),a=e(40845),r=e(90613);function g({message:l,variant:d}){const c=(0,a.of)(i);return(0,t.jsx)(r.a,{display:"flex",backgroundColor:d,borderRadius:"default",paddingY:1,paddingX:2,alignItems:"stretch",children:(0,t.jsx)("div",{className:c.content,children:(0,t.jsx)("div",{dangerouslySetInnerHTML:{__html:(0,s.G)(l)}})})})}function i(l){return{content:(0,n.css)({p:{margin:0},a:{color:l.colors.text.link}})}}},24738:(G,R,e)=>{"use strict";e.d(R,{Aj:()=>u,KX:()=>c,FF:()=>d,BV:()=>m});var t=e(75816),n=e(75505),s=e(17172),a=e(32264);function r({baseURL:p}){async function f(y){try{const{data:x,...v}=await(0,n.s)((0,s.AI)().fetch({...y,url:p+y.url,showErrorAlert:y.showErrorAlert,data:y.body}));return{data:x,meta:v}}catch(x){return y.manageError?y.manageError(x):{error:x}}}return f}const g=(0,t.xP)({reducerPath:"announcementBannerGeneratedAPI",baseQuery:r({baseURL:`/apis/banners.grafana.app/v0alpha1/namespaces/${a.$.namespace}`}),tagTypes:["AnnouncementBannerList"],endpoints:()=>({})}),i="/announcement-banners",l=g.injectEndpoints({endpoints:p=>({listAnnouncementBanner:p.query({query:()=>({url:i}),providesTags:["AnnouncementBannerList"]}),createAnnouncementBanner:p.mutation({query:f=>({url:i,method:"POST",body:f}),invalidatesTags:["AnnouncementBannerList"]}),getAnnouncementBanner:p.query({query:f=>({url:`${i}/${f.name}`})}),deleteAnnouncementBanner:p.mutation({query:f=>({url:`${i}/${f.name}`,method:"DELETE"})}),updateAnnouncementBanner:p.mutation({query:f=>({url:`${i}/${f.name}`,method:"PATCH",headers:{"Content-Type":"application/merge-patch+json"},body:JSON.stringify(f.body)}),invalidatesTags:["AnnouncementBannerList"]})}),overrideExisting:!1}),{useListAnnouncementBannerQuery:d,useCreateAnnouncementBannerMutation:c,useGetAnnouncementBannerQuery:h,useDeleteAnnouncementBannerMutation:o,useUpdateAnnouncementBannerMutation:m}=l,u=l.enhanceEndpoints({})},5477:(G,R,e)=>{"use strict";e.d(R,{Q:()=>s,Y:()=>a});var t=e(96540),n=e(24738);function s(r){const[g,i]=(0,n.KX)(),[l,d]=(0,n.BV)();return[(0,t.useCallback)(h=>r?l({name:r,body:{metadata:{name:r},spec:h}}):g({metadata:{generateName:"banner"},spec:h}),[g,r,l]),r?d:i]}function a(){const r=(0,n.FF)();return[r.data?.items?.at(-1),r.isLoading]}},54587:(G,R,e)=>{"use strict";e.d(R,{C1:()=>n,EA:()=>s,Hp:()=>r,QH:()=>a});var t=e(32264);const n="/admin/authentication/saml",s=t.$.appUrl+"saml/metadata",a=t.$.appUrl+"saml/acs",r=t.$.appUrl+"saml/slo"},71315:(G,R,e)=>{"use strict";e.d(R,{$$:()=>h,Nh:()=>D,OG:()=>v,Pr:()=>g,SH:()=>C,XN:()=>m,ZC:()=>E,Zt:()=>u,cD:()=>c,eO:()=>d,jA:()=>i,mA:()=>f,tC:()=>P,w4:()=>o,wj:()=>x,y6:()=>T});var t=e(65307),n=e(13680);const s={assertionAttributeName:"displayName",assertionAttributeLogin:"mail",assertionAttributeEmail:"mail"},a={storedSamlSettings:{},samlSettings:{},samlStep:1,activeStep:n.SAMLStepKey.General,signRequests:!1,keyCertValueType:"base64",keyConfigured:!1,certConfigured:!1,metadataValueType:"url",configChanged:!1,showSavedBadge:!1,visitedSteps:[],isUpdated:!1,isLoading:!1,configFoundInIniFile:!1},r=(0,t.Z0)({name:"samlConfig",initialState:a,reducers:{settingsLoaded:(S,O)=>({...S,samlSettings:O.payload,configChanged:!1,isLoading:!1}),setStoredSAMLSettings:(S,O)=>({...S,storedSamlSettings:O.payload}),setConfigFoundInIniFile:(S,O)=>({...S,configFoundInIniFile:O.payload}),settingsUpdated:(S,O)=>({...S,samlSettings:O.payload,configChanged:!0}),settingsLoadingBegin:S=>({...S,isLoading:!0}),settingsLoadingEnd:S=>({...S,isLoading:!1}),samlStepChanged:(S,O)=>({...S,samlStep:O.payload}),setSignRequests:(S,O)=>({...S,signRequests:O.payload}),setKeyCertValueType:(S,O)=>({...S,keyCertValueType:O.payload}),setKeyConfigured:(S,O)=>({...S,keyConfigured:O.payload}),setCertConfigured:(S,O)=>({...S,certConfigured:O.payload}),setMetadataValueType:(S,O)=>({...S,metadataValueType:O.payload}),settingsChanged:(S,O)=>({...S,configChanged:O.payload}),setError:(S,O)=>({...S,error:O.payload}),resetError:S=>({...S,error:void 0}),setShowSavedBadge:(S,O)=>({...S,showSavedBadge:O.payload}),addVisitedStep:(S,O)=>({...S,visitedSteps:[...S.visitedSteps,...O.payload]}),clearSAMLState:S=>({...S,isUpdated:!1,visitedSteps:[]})}}),{settingsLoaded:g,settingsUpdated:i,samlStepChanged:l,setStoredSAMLSettings:d,setSignRequests:c,setKeyCertValueType:h,setKeyConfigured:o,setCertConfigured:m,setMetadataValueType:u,settingsChanged:p,setShowSavedBadge:f,setConfigFoundInIniFile:y,addVisitedStep:x,clearSAMLState:v,settingsLoadingBegin:P,settingsLoadingEnd:E,setError:D,resetError:C}=r.actions,T={samlConfig:r.reducer}},64920:(G,R,e)=>{"use strict";e.d(R,{Bw:()=>p,DC:()=>E,aG:()=>o,iZ:()=>x,rC:()=>d});var t=e(32264),n=e(17172),s=e(10096),a=e(60610),r=e(31678),g=e(71315),i=e(26224);const l=()=>t.$.featureToggles?.ssoSettingsApi&&t.$.featureToggles?.ssoSettingsSAML;async function d(){return l()?h():c()}async function c(){const O=(await(0,n.AI)().get("/api/admin/settings"))["auth.saml"]||{};return[(0,i.Af)(O),O]}async function h(){const S=await(0,n.AI)().get("/api/v1/sso-settings/saml"),O=S?S.settings:{},M=b(O);return[O,M]}function o(S,O){if(l()){const M=T(S);return u(M)}else return m(S,O)}function m(S,O){const M=(0,i.wD)(S);if(M.updates){const I=(0,i.Pd)(M.updates["auth.saml"],O);M.updates["auth.saml"]=I}return(0,a.DZ)(M)}function u(S){return async O=>{if(s.TP.hasPermission(r.AccessControlAction.SettingsWrite))try{return await(0,n.AI)().put("/api/v1/sso-settings/saml",{provider:"saml",settings:{...S}},{showErrorAlert:!1}),O((0,g.SH)()),!0}catch(M){if((0,n.NF)(M)){M.isHandled=!0;const I={message:M.data?.message,errors:M.data?.errors};return O((0,g.Nh)(I)),!1}}return!1}}function p(){return l()?f():y()}function f(){return async S=>{if(s.TP.hasPermission(r.AccessControlAction.SettingsWrite))try{return await(0,n.AI)().delete("/api/v1/sso-settings/saml",void 0,{showSuccessAlert:!1,showErrorAlert:!1}),S((0,g.SH)()),!0}catch(O){if((0,n.NF)(O)){O.isHandled=!0;const M={message:O.data?.message,errors:O.data?.errors};return S((0,g.Nh)(M)),!1}}return!1}}function y(){const S={removals:{"auth.saml":["enabled","name","single_logout","allow_sign_up","auto_login","certificate","certificate_path","private_key","private_key_path","signature_algorithm","idp_metadata","idp_metadata_path","idp_metadata_url","max_issue_delay","metadata_valid_duration","allow_idp_initiated","relay_state","assertion_attribute_name","assertion_attribute_login","assertion_attribute_email","assertion_attribute_groups","assertion_attribute_role","assertion_attribute_org","allowed_organizations","org_mapping","role_values_none","role_values_viewer","role_values_editor","role_values_admin","role_values_grafana_admin","name_id_format","skip_org_role_sync","client_id","client_secret","token_url","force_use_graph_api"]}};return(0,a.DZ)(S)}function x(S){return l()?v(S):P()}function v(S){return u({...S,enabled:!0})}function P(){const S={updates:{"auth.saml":{enabled:"true"}}};return(0,a.DZ)(S)}function E(S){return l()?D(S):C()}function D(S){return u({...S,enabled:!1})}function C(){const S={updates:{"auth.saml":{enabled:"false"}}};return(0,a.DZ)(S)}function b(S){return{enabled:S?.enabled?"true":"false",name:S?.name,allow_sign_up:S?.allowSignUp?"true":"false",auto_login:S?.autoLogin?"true":"false",single_logout:S?.singleLogout?"true":"false",allow_idp_initiated:S?.allowIdpInitiated?"true":"false",skip_org_role_sync:S?.skipOrgRoleSync?"true":"false",private_key:S?.privateKey,private_key_path:S?.privateKeyPath,certificate:S?.certificate,certificate_path:S?.certificatePath,signature_algorithm:S?.signatureAlgorithm,idp_metadata:S?.idpMetadata,idp_metadata_path:S?.idpMetadataPath,idp_metadata_url:S?.idpMetadataUrl,max_issue_delay:S?.maxIssueDelay,metadata_valid_duration:S?.metadataValidDuration,relay_state:S?.relayState,assertion_attribute_name:S?.assertionAttributeName,assertion_attribute_login:S?.assertionAttributeLogin,assertion_attribute_email:S?.assertionAttributeEmail,assertion_attribute_groups:S?.assertionAttributeGroups,assertion_attribute_role:S?.assertionAttributeRole,assertion_attribute_org:S?.assertionAttributeOrg,allowed_organizations:S?.allowedOrganizations,org_mapping:S?.orgMapping,role_values_none:S?.roleValuesNone,role_values_viewer:S?.roleValuesViewer,role_values_editor:S?.roleValuesEditor,role_values_admin:S?.roleValuesAdmin,role_values_grafana_admin:S?.roleValuesGrafanaAdmin,name_id_format:S?.nameIdFormat,client_id:S?.clientId,client_secret:S?.clientSecret,token_url:S?.tokenUrl,force_use_graph_api:S?.forceUseGraphApi?"true":"false"}}function T(S){return{enabled:S?.enabled,name:S?.name,allowSignUp:S?.allowSignUp,autoLogin:S?.autoLogin,singleLogout:S?.singleLogout,allowIdpInitiated:S?.allowIdpInitiated,skipOrgRoleSync:S?.skipOrgRoleSync,privateKey:S?.privateKey,privateKeyPath:S?.privateKeyPath,certificate:S?.certificate,certificatePath:S?.certificatePath,signatureAlgorithm:S?.signatureAlgorithm,idpMetadata:S?.idpMetadata,idpMetadataPath:S?.idpMetadataPath,idpMetadataUrl:S?.idpMetadataUrl,maxIssueDelay:S?.maxIssueDelay,metadataValidDuration:S?.metadataValidDuration,relayState:S?.relayState,assertionAttributeName:S?.assertionAttributeName,assertionAttributeLogin:S?.assertionAttributeLogin,assertionAttributeEmail:S?.assertionAttributeEmail,assertionAttributeGroups:S?.assertionAttributeGroups,assertionAttributeRole:S?.assertionAttributeRole,assertionAttributeOrg:S?.assertionAttributeOrg,allowedOrganizations:S?.allowedOrganizations,orgMapping:S?.orgMapping,roleValuesNone:S?.roleValuesNone,roleValuesViewer:S?.roleValuesViewer,roleValuesEditor:S?.roleValuesEditor,roleValuesAdmin:S?.roleValuesAdmin,roleValuesGrafanaAdmin:S?.roleValuesGrafanaAdmin,nameIdFormat:S?.nameIdFormat,clientId:S?.clientId,clientSecret:S?.clientSecret,tokenUrl:S?.tokenUrl,forceUseGraphApi:S?.forceUseGraphApi}}},26224:(G,R,e)=>{"use strict";e.d(R,{A8:()=>y,Af:()=>a,Do:()=>v,H:()=>x,Pd:()=>c,nj:()=>p,wD:()=>d});var t=e(2543),n=e.n(t),s=e(54587);function a(P){return{enabled:r(P.enabled),allowSignUp:r(P.allow_sign_up),autoLogin:r(P.auto_login),singleLogout:r(P.single_logout),allowIdpInitiated:r(P.allow_idp_initiated),skipOrgRoleSync:r(P.skip_org_role_sync),name:g(P.name),privateKey:g(P.private_key),privateKeyPath:g(P.private_key_path),certificate:g(P.certificate),certificatePath:g(P.certificate_path),signatureAlgorithm:g(P.signature_algorithm),idpMetadata:g(P.idp_metadata),idpMetadataPath:g(P.idp_metadata_path),idpMetadataUrl:g(P.idp_metadata_url),maxIssueDelay:g(P.max_issue_delay),metadataValidDuration:g(P.metadata_valid_duration),relayState:g(P.relay_state),assertionAttributeName:g(P.assertion_attribute_name),assertionAttributeLogin:g(P.assertion_attribute_login),assertionAttributeEmail:g(P.assertion_attribute_email),assertionAttributeGroups:g(P.assertion_attribute_groups),assertionAttributeRole:g(P.assertion_attribute_role),assertionAttributeOrg:g(P.assertion_attribute_org),allowedOrganizations:g(P.allowed_organizations),orgMapping:g(P.org_mapping),roleValuesNone:g(P.role_values_none),roleValuesViewer:g(P.role_values_viewer),roleValuesEditor:g(P.role_values_editor),roleValuesAdmin:g(P.role_values_admin),roleValuesGrafanaAdmin:g(P.role_values_grafana_admin),nameIdFormat:g(P.name_id_format),clientId:g(P.client_id),clientSecret:g(P.client_secret),tokenUrl:g(P.token_url),forceUseGraphApi:r(P.force_use_graph_api)}}function r(P){return P==="true"}function g(P){return P||""}function i(P){return P?"true":"false"}function l(P){return{enabled:i(P.enabled),allow_sign_up:i(P.allowSignUp),auto_login:i(P.autoLogin),single_logout:i(P.singleLogout),allow_idp_initiated:i(P.allowIdpInitiated),skip_org_role_sync:i(P.skipOrgRoleSync),name:g(P.name),private_key:g(P.privateKey),private_key_path:g(P.privateKeyPath),certificate:g(P.certificate),certificate_path:g(P.certificatePath),signature_algorithm:g(P.signatureAlgorithm),idp_metadata:g(P.idpMetadata),idp_metadata_path:g(P.idpMetadataPath),idp_metadata_url:g(P.idpMetadataUrl),max_issue_delay:g(P.maxIssueDelay),metadata_valid_duration:g(P.metadataValidDuration),relay_state:g(P.relayState),assertion_attribute_name:g(P.assertionAttributeName),assertion_attribute_login:g(P.assertionAttributeLogin),assertion_attribute_email:g(P.assertionAttributeEmail),assertion_attribute_groups:g(P.assertionAttributeGroups),assertion_attribute_role:g(P.assertionAttributeRole),assertion_attribute_org:g(P.assertionAttributeOrg),allowed_organizations:g(P.allowedOrganizations),org_mapping:g(P.orgMapping),role_values_none:g(P.roleValuesNone),role_values_viewer:g(P.roleValuesViewer),role_values_editor:g(P.roleValuesEditor),role_values_admin:g(P.roleValuesAdmin),role_values_grafana_admin:g(P.roleValuesGrafanaAdmin),name_id_format:g(P.nameIdFormat),client_id:g(P.clientId),client_secret:g(P.clientSecret),token_url:g(P.tokenUrl),force_use_graph_api:i(P.forceUseGraphApi)}}function d(P){const{keyCertValueType:E,metadataValueType:D,signRequests:C}=P,{certificate_path:b,private_key_path:T,certificate:S,private_key:O,idp_metadata_url:M,idp_metadata_path:I,idp_metadata:L,...B}=l(P),j={updates:{"auth.saml":B},removals:{"auth.saml":[]}};return E==="path"?(T&&!f(T)&&(j.updates["auth.saml"].private_key_path=T,j.updates["auth.saml"].private_key=""),b&&!f(b)&&(j.updates["auth.saml"].certificate_path=b,j.updates["auth.saml"].certificate="")):E==="base64"&&(O&&!f(O)&&(j.updates["auth.saml"].private_key=O,j.updates["auth.saml"].private_key_path=""),S&&!f(S)&&(j.updates["auth.saml"].certificate=S,j.updates["auth.saml"].certificate_path="")),C||(j.updates["auth.saml"].signature_algorithm=""),D==="url"?(j.updates["auth.saml"].idp_metadata_url=M,j.updates["auth.saml"].idp_metadata_path="",j.updates["auth.saml"].idp_metadata=""):D==="path"?(j.updates["auth.saml"].idp_metadata_path=I,j.updates["auth.saml"].idp_metadata_url="",j.updates["auth.saml"].idp_metadata=""):D==="base64"&&(j.updates["auth.saml"].idp_metadata=L,j.updates["auth.saml"].idp_metadata_url="",j.updates["auth.saml"].idp_metadata_path=""),j}function c(P,E){const D={};return Object.keys(P).forEach(C=>{P[C]!==E[C]&&(D[C]=P[C])}),D}function h(P){const E=P?.split(/[,\s]/),D=[];return E?.forEach(C=>{const b=C.split(":");if(b.length===3){const T=m(b[2]);T&&D.push({externalOrg:b[0],orgId:b[1],role:T})}}),D}function o(P){return P.map(D=>`${D.externalOrg}:${D.orgId}:${D.role}`).join(",")}function m(P){return P==="Admin"||P==="Editor"||P==="Viewer"?P:null}const u={enabled:"false",skip_org_role_sync:"false"};function p(P){return(0,t.isEqual)(P,u)}function f(P){return P?/^\*+$/.test(P):!1}function y(P,E,D){switch(P){case"privateKey":return E[P]===D.private_key&&!!D.private_key;case"privateKeyPath":return E[P]===D.private_key_path&&!!D.private_key_path;case"certificate":return E[P]===D.certificate&&!!D.certificate;case"certificatePath":return E[P]===D.certificate_path&&!!D.certificate_path;default:return!1}}function x(P){return P.idpMetadataPath?"path":P.idpMetadata?"base64":"url"}const v=P=>`${s.C1}/${P||""}`},69841:(G,R,e)=>{"use strict";e.d(R,{$b:()=>g,Q3:()=>n,W3:()=>i,gn:()=>l,lx:()=>a,wn:()=>r});var t=e(27677),n=(d=>(d.LoadDataSourceCache="LOAD_DATA_SOURCE_CACHE",d))(n||{});const s=d=>({type:"LOAD_DATA_SOURCE_CACHE",payload:d});function a(d){return async c=>{const h=await(0,t.AI)().post(`/api/datasources/${d}/cache/enable`,{});c(s(h))}}function r(d){return async c=>{const h=await(0,t.AI)().post(`/api/datasources/${d}/cache/disable`,{});c(s(h))}}function g(d,c){return async h=>{const o=await(0,t.AI)().post(`/api/datasources/${d}/cache`,c);h(s(o))}}function i(d){return async c=>{const h=await(0,t.AI)().get(`/api/datasources/${d}/cache`);c(s(h))}}function l(d){return async c=>{const h=await(0,t.AI)().post(`/api/datasources/${d}/cache/clean`,{});c(s(h))}}},34591:(G,R,e)=>{"use strict";e.r(R),e.d(R,{addExtensionReducers:()=>hs,init:()=>na});var t=e(96540),n=e(33378),s=e(32264),a=e(14110),r=e(10096),g=e(6320),i=e(72254),l=e(37171),d=e(2272),c=e(31678),h=e(75192),o=e(74848),m=e(90182),u=e(14578);const p="licensedRole",f=[{value:"server_admin",label:"Server admin"},{value:"admin_editor",label:"Admin/editor"},{value:"viewer",label:"Viewer"}],y=({filters:Bt,onChange:Wt,className:_t})=>(0,o.jsx)(m.KF,{value:Bt.find(sn=>sn.name===p)?.value,options:f,onChange:sn=>{Wt({name:p,value:sn})},prefix:(0,o.jsx)(u.I,{name:"filter"}),width:64,placeholder:"Filter by licensed role",menuShouldPortal:!0,className:_t}),x=()=>{(0,h.jT)(y)};var v=e(39601),P=e(85957);function E(Bt){return/(d-solo|dashboard-solo)/.test(Bt?.toLowerCase())}function D(Bt,Wt){return!!Wt.find(_t=>_t.id==="apps")?.children?.find(_t=>_t.id===`plugin-page-${Bt}`)?.children?.some(_t=>_t.url?.endsWith(`/a/${Bt}`))}var C=e(47232),b=e(93197),T=e(5477);function S(){const[Bt]=(0,T.Y)(),{message:Wt,variant:_t,enabled:sn,endTime:Cn,startTime:Fn,visibility:$n}=Bt?.spec||{message:"",variant:"info"},{isSignedIn:ts}=r.TP.user,Vn=(0,C.AN)().isBetween(Fn,Cn,void 0,"[]");return!sn||!Vn||!($n==="everyone"||$n==="authenticated"&&ts)?null:(0,o.jsx)(b.l,{message:Wt,variant:_t})}async function O(){r.TP.isSignedIn&&!E(v.Ny.getLocation().pathname)&&r.TP.user.authenticatedBy!=="render"&&(0,P.Pl)(S)}var M=e(24738),I=e(73399),L=e(26224),B=e(64920);function j(){const Bt={id:"saml",type:"SAML",protocol:"SAML 2.0",displayName:"SAML",configPath:"saml/general"};(0,I.registerAuthProvider)(Bt,A)}async function A(){if(r.TP.hasPermission(c.AccessControlAction.SettingsRead)){const[Bt,Wt]=await(0,B.rC)(),_t=(0,L.nj)(Wt),sn=Object.keys(Bt).length===0||Object.keys(Wt).length===0;return _t?{configured:!1,enabled:!1,hide:sn}:{configured:!0,enabled:!!Bt.enabled,name:Bt.name,hide:sn}}return{configured:!1,enabled:!1}}var K=e(71315),W=e(32196),U=e(40845),F=e(29158),V=e(76888),w=e(65463);class z extends w.x{static{this.type="page-banner-display"}}var N=(Bt=>(Bt[Bt.info=0]="info",Bt[Bt.warning=1]="warning",Bt[Bt.error=2]="error",Bt))(N||{});function H(){const[Bt,Wt]=(0,t.useState)(),_t=Q(Bt?.severity),sn=(0,U.of)(Vn=>X(Vn,_t)),{chrome:Cn}=(0,V.Il)(),Fn=Cn.useState();(0,t.useEffect)(function(){const Vn=r.lE.subscribe(z,Un=>{Fn.chromeless||Wt(Un.payload)});return function(){Vn.unsubscribe()}},[Fn.chromeless]);const $n=(0,t.useCallback)(()=>{Wt(void 0),Bt?.onClose&&Bt.onClose()},[Bt]);if(!Bt)return null;const ts=Bt.body;return(0,o.jsxs)("div",{className:sn.banner,children:[(0,o.jsx)("div",{className:sn.icon,children:(0,o.jsx)(u.I,{size:"xl",name:_t.icon})}),(0,o.jsx)("div",{className:sn.content,children:(0,o.jsx)(ts,{severity:Bt.severity??N.info})}),Bt?.onClose&&(0,o.jsx)("div",{className:sn.icon,children:(0,o.jsx)(F.K,{size:"xl",name:"times",onClick:$n,className:sn.close,"aria-label":"Close banner",tooltip:"Close"})})]})}function Q(Bt){const Wt=(0,U.$j)();return(0,t.useMemo)(()=>{switch(Bt){case N.error:return{icon:"exclamation-circle",background:Wt.colors.error.main,text:Wt.colors.error.contrastText};case N.warning:return{icon:"exclamation-triangle",background:Wt.colors.warning.main,text:Wt.colors.warning.contrastText};case N.info:default:return{icon:"info-circle",background:Wt.colors.info.main,text:Wt.colors.info.contrastText}}},[Wt,Bt])}function X(Bt,Wt){return{banner:(0,W.css)`
      flex-grow: 0;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      background-color: ${Wt.background};
      border-radius: 2px;
      height: 52px;
    `,icon:(0,W.css)`
      padding: ${Bt.spacing(0,2)};
      color: ${Wt.text};
      display: flex;
    `,content:(0,W.css)`
      flex-grow: 1;
      display: flex;
      align-items: center;
      color: ${Wt.text};
    `,close:(0,W.css)`
      color: ${Wt.text};
    `}}function ee(){(0,P.Pl)(H)}var Z=e(69841);const q={enabled:!1,dataSourceID:0,dataSourceUID:"",ttlQueriesMs:0,ttlResourcesMs:0,defaultTTLMs:0,useDefaultTTL:!0},k={dataSourceCache:(Bt=q,Wt)=>{switch(Wt.type){case Z.Q3.LoadDataSourceCache:return{...Wt.payload}}return Bt}};var se=e(56784),te=e(63415),ne=e(2913),le=e(16233),re=e(71468),de=e(27746),oe=e(87978),J=e(77454),ce=e(35538),pe=e(20120),xe=e(13680),fe=e(68539),Ee=e(65307);const Se={isDrawerOpen:!1,drawerTab:xe.AnalyticsTab.Stats},ye=(0,Ee.Z0)({name:"metaAnalytics",initialState:Se,reducers:{setDrawerOpen:(Bt,Wt)=>({...Bt,isDrawerOpen:Wt.payload}),setDrawerTab:(Bt,Wt)=>({...Bt,drawerTab:Wt.payload})}}),{setDrawerOpen:Ve,setDrawerTab:Me}=ye.actions,Ue={metaAnalytics:ye.reducer};var Ae=e(63021),we=e(40675),We=e(40980),_e=e(41067),at=e(10505),ut=e(70713),Tt=e(11261),It=e(24293),ge=e(39070),Ie=e(24308),ue=e(52622),me=e(91052);class Pe extends t.PureComponent{convertSummariesToDataFrame(Wt,_t){const sn=[],Cn=[];return _t.forEach(Fn=>{sn.push((0,C.KQ)(Fn.day,_e.QH).valueOf()),Cn.push(Fn[Wt.name])}),{fields:[{name:"Time",type:Tt.PU.time,config:{},values:sn},{name:Wt.name,type:Wt.type,config:{displayName:Wt.label??Wt.name,color:Wt.color?{mode:It.Y.Fixed,fixedColor:Wt.color}:void 0},values:Cn}],length:_t.length}}buildTimeRange(){const{dailySummaries:Wt}=this.props,_t=(0,C.KQ)(Wt[0].day),sn=(0,C.KQ)(Wt[Wt.length-1].day).add(12,"hours");return{from:_t,to:sn,raw:{from:_t,to:sn}}}renderChart(Wt){const{dailySummaries:_t,theme:sn}=this.props,{timeRange:Cn,showBars:Fn,title:$n,width:ts,fields:Vn,isStacked:Un=!1}=Wt,ys=(0,at.k)(sn),ws=Vn.map(va=>this.convertSummariesToDataFrame(va,_t)),As={series:ws,state:ge.Gu.Done,timeRange:Cn},$s={legend:{showLegend:ws.length>1,displayMode:ue.lm.List,placement:"bottom",calcs:[]},tooltip:{mode:ue.$N.Multi,sort:ue.xB.Descending}},Hs={defaults:{custom:{showPoints:ue.yL.Never,drawStyle:Fn?ue.GR.Bars:ue.GR.Line,stacking:Un?{mode:ue.gs.Normal}:void 0,fillOpacity:Fn?50:0}},overrides:[]};return(0,o.jsx)("div",{className:ys.graphContainer,children:(0,o.jsx)(me.NR,{title:$n,width:ts,height:220,displayMode:"transparent",loadingState:As.state,children:(va,Qs)=>(0,o.jsx)(Ie.m,{title:$n,width:va,height:Qs,pluginId:"timeseries",data:As,fieldConfig:Hs,options:$s})})})}}class Ne extends Pe{render(){const{dailySummaries:Wt,theme:_t}=this.props;if(Wt&&Wt.length>0){const sn=this.buildTimeRange();return(0,o.jsx)(ut.Ay,{disableHeight:!0,children:({width:Cn})=>Cn===0?null:(0,o.jsxs)("main",{style:{width:Cn},children:[this.renderChart({title:"Daily query count",fields:[{name:"queries",type:Tt.PU.number},{name:"cachedQueries",type:Tt.PU.number,label:"cached queries"}],width:Cn,timeRange:sn,showBars:!1,showLines:!0}),this.renderChart({title:"Views last 30 days",fields:[{name:"views",type:Tt.PU.number}],width:Cn,timeRange:sn,showBars:!0,showLines:!1}),this.renderChart({title:"Errors last 30 days",fields:[{name:"errors",type:Tt.PU.number,color:_t.colors.error.border}],width:Cn,timeRange:sn,showBars:!1,showLines:!0})]})})}return(0,o.jsx)("span",{children:"No data."})}}const Fe={setDrawerOpen:Ve},Be=(0,U.cV)((0,re.connect)(null,Fe)(Ne));class he extends Pe{render(){const{dailySummaries:Wt,theme:_t}=this.props;if(Wt&&Wt.length>0){const sn=this.buildTimeRange();return(0,o.jsx)(ut.Ay,{disableHeight:!0,children:({width:Cn})=>Cn===0?null:(0,o.jsxs)("main",{style:{width:Cn},children:[this.renderChart({title:"Daily query count",fields:[{name:"queries",type:Tt.PU.number},{name:"cachedQueries",type:Tt.PU.number,label:"cached queries"}],width:Cn,timeRange:sn,showBars:!1,showLines:!0}),this.renderChart({title:"Errors last 30 days",fields:[{name:"errors",type:Tt.PU.number,color:_t.colors.error.border}],width:Cn,timeRange:sn,showBars:!1,showLines:!0})]})})}return(0,o.jsx)("span",{children:"No data."})}}const be=(0,U.cV)(he);var Ke=e(90708),ze=e(99635),nt=e(55852),tt=e(77093);class ot extends Pe{constructor(Wt){super(Wt),this.onOpenVersionHistory=()=>{const{setDrawerOpen:_t}=this.props;_t(!1),v.Ny.partial({editview:"versions"})},this.state={dashboardUsersInfo:null}}async componentDidMount(){const{dashboard:Wt}=this.props;try{const _t=await(0,_e.db)(Wt.id);this.setState({dashboardUsersInfo:_t})}catch(_t){console.log("Error getting dashboard users info",_t)}}formatDate(Wt){const _t=Wt.diff((0,C.KQ)().startOf("day"),"days",!0);if(_t<-6)return Wt.format("YYYY-MM-DD");if(_t<-1)return Wt.locale("en").format("dddd");if(_t<0)return"Yesterday";{const sn=Wt.diff((0,C.KQ)(),"minutes",!0);return sn<-60?"Today":sn<-15?"Last hour":"Currently viewing"}}renderUserBox(Wt,_t,sn){return(0,o.jsxs)("div",{className:sn.userBox,"aria-label":"User information box",children:[(0,o.jsx)("h6",{"aria-label":"User box title",children:Wt}),(0,o.jsx)(ze.n,{userView:_t,showTooltip:!1}),(0,o.jsx)("div",{className:sn.userName,children:_t.user.name}),(0,o.jsx)("div",{children:(0,C.KQ)(_t.lastActiveAt).format("YYYY-MM-DD")})]})}renderViewsChart(){const Wt=this.buildTimeRange();return(0,o.jsx)(ut.Ay,{disableHeight:!0,children:({width:_t})=>_t===0?null:(0,o.jsx)("main",{style:{width:_t},children:this.renderChart({title:"Views last 30 days",fields:[{name:"views",type:Tt.PU.number}],width:_t,timeRange:Wt,showBars:!0,showLines:!1})})})}convertUserViewsToDataFrame(Wt,_t){const{userViews:sn}=this.props;if(sn&&sn.length>0){const Cn=[],Fn=[],$n=[];sn.forEach(ys=>{Cn.push(this.formatDate((0,C.KQ)(ys.lastActiveAt))),Fn.push(ys.user.name),$n.push((0,o.jsx)(ze.n,{className:Wt.userIcon,userView:ys,showTooltip:!1}))});const ts={displayName:" ",filterable:!1,custom:{width:50,align:"center",minWidth:50,cellOptions:{type:ue.ob.ColorText},inspect:!1}},Vn=[{fields:[{name:" ",type:Tt.PU.other,config:ts,values:$n},{name:"User",type:Tt.PU.string,config:{},values:Fn},{name:"When",type:Tt.PU.string,config:{},values:Cn}],length:sn.length}],Un=(0,Ke.we)({data:Vn,theme:_t,replaceVariables:ys=>ys,fieldConfig:{}});return Un.length>0?Un[0]:null}else return null}render(){const{dailySummaries:Wt,dashboard:_t,theme:sn,userViews:Cn}=this.props,{dashboardUsersInfo:Fn}=this.state,$n=(0,at.k)(sn),ts=this.convertUserViewsToDataFrame($n,sn);return(0,o.jsxs)("div",{children:[Wt&&Wt.length>0&&this.renderViewsChart(),(0,o.jsxs)("div",{className:$n.userBoxesContainer,children:[Fn?.creator&&this.renderUserBox("Created",Fn.creator,$n),Fn?.lastEditor&&this.renderUserBox("Last edited",Fn.lastEditor,$n),Cn?.length>0&&this.renderUserBox("Last viewed",Cn[0],$n)]}),Cn?.length>0&&(0,o.jsxs)("div",{className:$n.tableContainer,children:[(0,o.jsxs)("div",{className:$n.tableHeader,children:[(0,o.jsx)("h4",{children:"Last 30 dashboard viewers"}),_t.meta.showSettings&&(0,o.jsx)(nt.$n,{icon:"history",variant:"secondary",onClick:this.onOpenVersionHistory,"aria-label":"Version history button",children:"Dashboard version history"})]}),(0,o.jsx)(ut.Ay,{disableHeight:!0,children:({width:Vn})=>{if(Vn===0)return null;const Un=35*(ts.length+1);return(0,o.jsx)("main",{style:{width:Vn},children:(0,o.jsx)(tt.X,{data:ts,height:Un,width:Vn,"aria-label":"Recent users table"})})}})]})]})}}const gt={setDrawerOpen:Ve},He=(0,U.cV)((0,re.connect)(null,gt)(ot)),et=30;class rt extends t.PureComponent{constructor(Wt){super(Wt),this.onSelectTab=_t=>{this.props.setDrawerTab(_t.value||xe.AnalyticsTab.Stats)},this.state={dailySummaries:[],publicDailySummaries:[],userViews:[]}}async componentDidMount(){const{dashboard:Wt}=this.props,_t=[];for(let sn=0;sn<30;sn++)_t.push((0,C.KQ)(Date.now()).subtract(sn,"days").format(_e.QH));if(Wt?.id&&Wt.meta.url){const sn=await(0,_e.Au)(Wt.id,_t),Cn=await(0,_e._x)(Wt.id,et);let Fn=[];(0,i.iR)()&&(Fn=await(0,_e.XP)(Wt.id,_t)),this.setState({dailySummaries:sn,userViews:Cn,publicDailySummaries:Fn})}}renderHeader(Wt){const _t=[{label:"Stats",value:xe.AnalyticsTab.Stats},{label:"Users and activity",value:xe.AnalyticsTab.Users}];return(0,i.iR)()&&_t.push({label:s.$.featureToggles.newDashboardSharingComponent?"Shared dashboards":"Public dashboards",value:xe.AnalyticsTab.PublicDashboards}),(0,o.jsx)(Ae.U,{className:Wt.tabsBar,children:_t.map((sn,Cn)=>(0,o.jsx)(we.o,{label:sn.label,active:sn.value===this.props.drawerTab,onChangeTab:()=>this.onSelectTab(sn)},`${sn.value}-${Cn}`))})}render(){const{dailySummaries:Wt,publicDailySummaries:_t,userViews:sn}=this.state,{dashboard:Cn,drawerTab:Fn,setDrawerOpen:$n,theme:ts}=this.props,Vn=(0,at.k)(ts);return(0,o.jsx)(oe._,{scrollableContent:!0,title:`${Cn.title} - analytics`,size:"md",onClose:()=>$n(!1),subtitle:this.renderHeader(Vn),expandable:!0,children:(0,o.jsxs)(We.J,{className:Vn.tabContent,children:[(0,ce.z5)()&&(0,o.jsx)(J.Iz,{featureId:"dashboard-insights",eventVariant:"trial",featureName:"dashboard usage insights",text:"Get full access to usage insights for free during your trial of Grafana Pro."}),Fn===xe.AnalyticsTab.Stats&&(0,o.jsx)(be,{dashboard:Cn,dailySummaries:Wt}),Fn===xe.AnalyticsTab.Users&&(0,o.jsx)(He,{dashboard:Cn,dailySummaries:Wt,userViews:sn}),(0,i.iR)()&&Fn===xe.AnalyticsTab.PublicDashboards&&(0,o.jsx)(Be,{dashboard:Cn,dailySummaries:_t})]})})}}function ht(Bt){return{drawerTab:Bt.metaAnalytics.drawerTab}}const ft={setDrawerOpen:Ve,setDrawerTab:Me},De=(0,U.cV)((0,re.connect)(ht,ft)(rt)),Te=({onClick:Bt,isHighlighted:Wt})=>(0,o.jsx)(de.I,{icon:"info-circle",tooltip:"Dashboard insights",onClick:Bt,isHighlighted:Wt}),Oe=({dashboard:Bt,isDrawerOpen:Wt,setDrawerOpen:_t})=>{const sn=Bt?.id&&Bt.meta.url,Cn=(0,ce.z5)();return(0,t.useEffect)(()=>{sn&&Cn&&(0,a.Xp)((0,fe.L)("dashboard-insights-dot"),fe.X.Test,"trial")},[sn,Cn]),sn&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(Te,{onClick:()=>{_t(!0),(0,a.rR)("dashboards_toolbar_actions_clicked",{item:"insights"})},isHighlighted:Cn}),Wt&&(0,o.jsx)(De,{dashboard:Bt})]})};function Ye(Bt){return{isDrawerOpen:Bt.metaAnalytics.isDrawerOpen}}const Ge={setDrawerOpen:Ve},Je=({dashboard:Bt})=>{const Wt=Bt?.id&&Bt.meta.url,[_t,sn]=(0,t.useState)(!1);return(0,t.useEffect)(()=>{Wt&&(0,a.Xp)((0,fe.L)("dashboard-insights-dot"),fe.X.Test,"")},[Wt]),Wt&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(Te,{isHighlighted:!0,onClick:()=>{sn(!0)}}),_t&&(0,o.jsx)(St,{dashboard:Bt,onClose:()=>sn(!1)})]})},it=()=>{(0,n.a)("analytics")?r.TP.hasPermission(xe.AccessControlAction.DashboardsInsightsRead)&&(0,pe.fP)({show:()=>!0,component:(0,re.connect)(Ye,Ge)(Oe),index:-1}):s.$.featureToggles.featureHighlights&&(0,pe.fP)({show:()=>!0,component:Je,index:-1})},St=({onClose:Bt,dashboard:Wt})=>{const _t=(0,U.$j)();return(0,o.jsxs)(oe._,{onClose:Bt,title:`${Wt?.title} - analytics`,width:"50%",children:[(0,o.jsx)(J.Iz,{featureName:"dashboard usage insights",featureId:"dashboard-insights"}),(0,o.jsx)(J.ep,{featureName:"dashboard usage insights",image:`usage-insights-${_t.isLight?"light":"dark"}.png`,featureUrl:"https://grafana.com/docs/grafana/latest/enterprise/usage-insights/dashboard-datasource-insights",description:"Usage Insights provide detailed information about dashboard usage, like the number of views, queries, and errors users have experienced. You can use this to improve users\u2019 experience and troubleshoot issues."})]})};var zt=e(17172);class Kt{constructor(Wt){this.options=Wt,this.buffer=[],this.supportedEvents=[te.on.MetaAnalytics],this.addEvent=_t=>{this.buffer.push(_t)},this.flush=()=>{if(this.buffer.length===0)return;const _t=[];for(const sn of this.buffer)_t.push({type:sn.type,...sn.payload,meta:sn.meta});this.buffer=[],this.options.url&&(0,zt.AI)().fetch({method:"POST",url:this.options.url,showSuccessAlert:!1,showErrorAlert:!1,data:_t}).toPromise()}}}var Qt=e(2543);const an=({users:Bt,onClick:Wt,limit:_t=4})=>{const sn=(0,U.of)(Nn);if(!Bt.length)return null;_t=_t>0?_t:4;const Cn=Bt.length>_t,Fn=Bt.length-_t,$n=Fn>99;return(0,o.jsxs)("div",{className:sn.container,"aria-label":"Users indicator container",children:[Cn&&(0,o.jsx)(ze.n,{onClick:Wt,userView:{user:{name:"Extra users"},lastActiveAt:""},showTooltip:!1,children:$n?"...":`+${Fn}`}),Bt.slice(0,Cn?_t:_t+1).reverse().map(ts=>(0,o.jsx)(ze.n,{userView:ts},ts.user.name))]})},Nn=Bt=>({container:(0,W.css)({display:"flex",justifyContent:"center",flexDirection:"row-reverse",marginLeft:Bt.spacing(1),"& > button":{marginLeft:Bt.spacing(-1)}}),dots:(0,W.css)({marginBottom:"3px"})});function zn(Bt){return Wt=>{Wt(Ve(!0)),Wt(Me(Bt))}}const Yn={openDrawer:zn},ss=(0,re.connect)(null,Yn),ds=4,Ms=6e4;function Bs(Bt,Wt){const _t=le.TP.user;(0,_e.K4)(Bt,ds+10).then(sn=>{const Cn=sn.filter(Fn=>Fn.user.id!==_t.id);Wt(Fn=>(0,Qt.isEqual)(Cn,Fn)?Fn:Cn)})}const gs=({dashboard:Bt,openDrawer:Wt})=>{const _t=Bt?.id,[sn,Cn]=(0,t.useState)([]);return(0,t.useEffect)(()=>{if(!_t||!Bt?.meta.url)return;Bs(_t,Cn);const Fn=setInterval(()=>Bs(_t,Cn),Ms);return()=>{clearInterval(Fn)}},[_t,Bt]),(0,o.jsx)(an,{users:sn,limit:ds,onClick:()=>Wt(xe.AnalyticsTab.Users)})},Zn=()=>{le.TP.hasPermission(xe.AccessControlAction.DashboardsInsightsRead)&&(0,pe.UP)({show:()=>!0,component:ss(gs),index:"end"})},Ls=()=>{const Bt=(0,ne.zj)().analytics?.enabled,Wt=(0,n.a)("analytics");Wt&&(0,te.pl)(new Kt({url:Ln()})),Bt&&(Wt?le.TP.user.isSignedIn&&(Zn(),it()):s.$.featureToggles.featureHighlights&&it())},Ln=()=>{const Bt=(0,ne.zj)().publicDashboardAccessToken;return Bt!==""?`api/public/ma/events/${Bt}`:"api/ma/events"};var Hn=e(26657),Qn=e(64152),mt=e(99140),Yt=e(26272),on=e(19347),ln=e(37390),fn=e(42418),yn=e(10880),wn=e(28138),Xn=e(14678),xn=e(39268),Ut=e(38894),nn=e(14186),hn=e(51612);const dn=Bt=>{const{onChange:Wt,value:_t}=Bt,sn=(0,U.of)(Sn);return(0,o.jsxs)(xn.C,{className:sn.filter,children:[(0,o.jsx)(Ut.I,{width:"auto",children:"Filter by data source"}),(0,o.jsx)(nn.I,{children:(0,o.jsx)(hn.s,{width:30,placeholder:"Select a data source",onChange:Cn=>{Wt({name:Cn.name,id:Cn.id,uid:Cn.uid})},noDefault:!0,current:_t})}),(0,o.jsx)(nn.I,{children:(0,o.jsx)(nt.$n,{className:sn.button,icon:"trash-alt",variant:"secondary",onClick:()=>{Wt(void 0)}})})]})},Sn=Bt=>({filter:(0,W.css)`
      margin-bottom: ${s.$.theme.spacing.md};
    `,button:(0,W.css)`
      color: ${Bt.colors.text.secondary};
    `});var es=e(80500),Pt=e(82063),Ze=e(95114);const lt=Bt=>({expr:`${Bt.prom_name}{id="${Bt.id}", name="${Bt.name}"}`,legendFormat:"",interval:"",exemplar:!0,datasource:Bt.dest_data_source_uid});function yt(Bt){return{recordedQueries:(0,Ze.T)(Bt.recordedQueries)}}const Nt={getRecordedQueriesAsync:Pt.xY},wt=(0,re.connect)(yt,Nt),Zt=({onAddQuery:Bt,getRecordedQueriesAsync:Wt,recordedQueries:_t,onChangeDataSource:sn,filterValue:Cn})=>{const[Fn,$n]=(0,t.useState)(!1),[ts,Vn]=(0,t.useState)(Cn),[Un,ys]=(0,t.useState)([]),ws=(0,U.of)(An);(0,t.useEffect)(()=>{Wt()},[Fn,Wt]);const As=(Ps,Vs)=>{ys(Vs?Un.concat(Ps):Un.filter(Js=>!(0,Qt.isEqual)(Js,Ps)))},$s=()=>{(0,a.rR)("cloud_user_clicked_add_selected_recorded_queries",{recorded_queries_selected:Un.map(Vs=>Vs.name)});const Ps=(0,on.l)().getInstanceSettings(Xn.uv);sn?.(Ps),Un.map(lt).forEach(Vs=>{Bt?.(Vs)}),$n(!1),ys([]),wn.A.emit(Yt.r1.alertSuccess,["Selected recorded queries added to the editor. The data source has been changed to mixed."])},Hs=On(_t,ts).map(Ps=>(0,o.jsx)(pn,{onQueryToggle:As,recordedQuery:Ps},Ps.id)),va=()=>{$n(!1),ys([])},Qs=()=>{(0,a.rR)("cloud_user_clicked_add_recorded_query_button"),$n(!0)};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(nt.$n,{icon:"plus",onClick:Qs,variant:"secondary",className:ws.openButton,children:"Recorded query"}),(0,o.jsxs)(ln.a,{isOpen:Fn,title:"Add recorded query",onDismiss:va,className:ws.modal,children:[(0,o.jsx)(dn,{value:ts?.name,onChange:Vn}),(0,o.jsxs)(fn.F,{title:"",severity:"info",children:["To create a new Recorded Query, return to the query editor and use the "," ",(0,o.jsx)(u.I,{name:"record-audio"})," "," icon in the series bar."]}),Hs.length>0?Hs:ts&&(0,o.jsxs)("div",{className:ws.noQueries,children:["No recorded queries available for ",ts?.name]}),(0,o.jsxs)("div",{className:ws.modalButtons,children:[(0,o.jsx)(nt.$n,{variant:"secondary",className:ws.modalButton,onClick:va,children:"Cancel"}),(0,o.jsx)(nt.$n,{variant:"primary",className:ws.modalButton,onClick:$s,disabled:Un.length===0,children:"Add"})]})]})]})},pn=({onQueryToggle:Bt,recordedQuery:Wt})=>{const[_t,sn]=(0,t.useState)(!1);return(0,o.jsx)(es.z,{recordedQuery:Wt,buttons:[(0,o.jsx)(yn.S,{name:Wt.id,value:_t,onChange:()=>{Bt(Wt,!_t),sn(!_t)}},`${Wt.id}-checked`)]})},On=(Bt,Wt)=>{const _t=(0,on.l)();return Bt.filter(sn=>sn.active).filter(sn=>!Wt||sn.queries[0].datasource.uid===Wt.uid).sort((sn,Cn)=>{const Fn=_t?.getInstanceSettings(sn.queries[0]?.datasource),$n=_t?.getInstanceSettings(Cn.queries[0]?.datasource),ts=Fn?.meta.name.localeCompare($n?.meta.name??"");if(ts!==void 0&&ts!==0)return ts;const Vn=Fn?.name.localeCompare($n?.name??"");return Vn!==void 0&&Vn!==0?Vn:sn.name.localeCompare(Cn.name)})},An=Bt=>({modalButtons:(0,W.css)`
      display: flex;
      justify-content: end;
    `,openButton:(0,W.css)`
      margin-left: -8px;
    `,modalButton:(0,W.css)`
      margin-left: ${Bt.spacing(1)};
    `,modal:(0,W.css)`
      width: 750px;
    `,noQueries:(0,W.css)`
      margin-left: ${Bt.spacing(1)};
      margin-bottom: ${Bt.spacing(3)};
    `}),qn=wt(Zt);var cs=e(49785),Os=e(12470),xs=e(43127),zs=e(92041),Ks=e(51253),ma=e(88575),la=e(10354),Ua=e(60029),Ra=e(5308),Pa=e(15292),wa=e(88448),Ea=e(10343),Za=e(20601),Na=e(24240),gr=e(87421),cr=e(73803);const Ha=[{label:"30 seconds",value:30},{label:"1 minute",value:60},{label:"5 minutes",value:300},{label:"30 minutes",value:1800},{label:"1 hour",value:3600},{label:"12 hours",value:43200},{label:"24 hours",value:86400},{label:"1 week",value:604800},{label:"1 month",value:2592e3}],$a=({label:Bt,description:Wt,value:_t,onChange:sn})=>(0,o.jsx)("div",{children:(0,o.jsx)(ma.D,{label:Bt,description:Wt,required:!0,children:(0,o.jsx)(m.l6,{options:Ha,onChange:Cn=>{sn(Cn.value)},value:_t,"aria-label":`${Bt}-select`,menuShouldPortal:!0})})});function Xa(Bt){return{variables:(0,gr.UN)(Bt)}}const _a=(0,re.connect)(Xa),vt=({href:Bt,trackingSource:Wt})=>{const _t=(0,U.of)(vn);return(0,o.jsx)("a",{href:Bt,className:_t.docsLink,target:"_blank",rel:"noreferrer",onClick:()=>(0,a.rR)("cloud_user_clicked_create_recorded_query_modal_documentation_icon",{source:Wt}),children:(0,o.jsx)(u.I,{name:"info-circle"})})},kt=({query:Bt,queries:Wt,dataSource:_t,variables:sn})=>{const[Cn,Fn]=(0,t.useState)(!1),[$n,ts]=(0,t.useState)(),[Vn,Un]=(0,t.useState)("info"),[ys,ws]=(0,t.useState)(""),As=(0,U.of)(wa.o),$s=(0,U.of)(vn);(0,t.useEffect)(()=>{(async()=>{r.TP.hasPermission(xe.AccessControlAction.LicensingRead)&&ts(await(0,cr.Pe)().catch(()=>{}))})()},[]);const Hs=()=>{ws(""),Un("info"),Fn(!1)},va=async st=>{try{return await Vs(st,Js)}catch(bt){Un("error"),(0,zt.NF)(bt)&&ws(bt.data.message);return}},Qs=async st=>{const bt=await va(st);bt&&(0,Pt.u6)(bt).then(()=>{Un("success"),ws("Your new recorded query is recording successfully!"),(0,a.rR)("cloud_user_created_recorded_query")}).catch(Mt=>{Un("error"),ws(Mt.data.message)})},Ps=async st=>{const bt=await va(st);bt&&(0,Pt.Lc)(bt).then(Mt=>{Un("info"),ws(Mt.data.message)}).catch(Mt=>{Un("error"),ws(Mt.data.message)})},Vs=async(st,bt)=>{const Mt={target_ref_id:Bt?Bt.refId:"",name:st.name,description:st.description,interval:st.interval,range:st.range,count:st.isCount,active:!0},qt=Wt?.map(async rn=>{const tn=rn.datasource||_t?.name,Rn=await(0,on.l)().get(tn),Wn=Rn.interpolateVariablesInQueries?Rn.interpolateVariablesInQueries([rn],{...bt})[0]:rn;return Wn.datasourceId=Rn?Rn.id:-1,Wn.datasource===void 0&&(rn.datasource!==void 0&&rn.datasource!==null?Wn.datasource=rn.datasource:Rn&&(Wn.datasource={uid:Rn.uid,type:Rn.type})),Wn});return Mt.queries=qt?await Promise.all(qt):[],Mt},Js=sn?.filter(st=>st.hide!==Os.zL.hideVariable),Ca=(0,o.jsxs)("h2",{className:As.modalHeaderTitle,children:["Create recorded query",(0,o.jsx)(vt,{href:"https://grafana.com/docs/grafana/latest/enterprise/recorded-queries/#create-a-recorded-query",trackingSource:"modal-title"})]}),Fa=Vn!=="success"?(0,o.jsx)("div",{"aria-label":"Test the recorded query",children:(0,o.jsx)(u.I,{name:"sync"})}):void 0,nr=Vn==="success"?(0,o.jsx)(nt.$n,{type:"button",variant:"primary",onClick:Hs,"aria-label":"Close recording query button",children:"Close"}):(0,o.jsx)(nt.$n,{type:"button",variant:"secondary",onClick:Hs,fill:"outline","aria-label":"Cancel recording query button",children:"Cancel"}),ca=()=>{switch(Vn){case"info":return ys===""?(0,o.jsx)(o.Fragment,{}):(0,o.jsxs)(o.Fragment,{children:["Results:",(0,o.jsx)("pre",{children:ys})]});default:return(0,o.jsx)(o.Fragment,{children:ys})}};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(Ea.q,{title:"Create recorded query",icon:"record-audio",onClick:()=>{Fn(!0),(0,a.rR)("cloud_user_clicked_create_recorded_query_icon")}}),(0,o.jsx)(ln.a,{isOpen:Cn,title:Ca,onDismiss:Hs,className:$s.modal,children:(0,o.jsx)(Ks.l,{onSubmit:Qs,validateOn:"all",children:({register:st,errors:bt,control:Mt,getValues:qt})=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(ma.D,{label:"Name",description:"Give this query a name",invalid:!!bt.name,error:bt.name?.message,required:!0,children:(0,o.jsx)(la.p,{...st("name",{required:{value:!0,message:"Name is required"}}),id:"add-recorded-query-name",autoFocus:!0})}),(0,o.jsx)(ma.D,{label:"Description",description:"Provide a description for this query",children:(0,o.jsx)(la.p,{...st("description"),id:"add-recorded-query-desc"})}),(0,o.jsx)("div",{className:$s.timeSelect,children:(0,o.jsx)(cs.xI,{name:"interval",control:Mt,defaultValue:Ha[0].value,render:({field:{ref:rn,value:tn,onChange:Rn,...jn}})=>(0,o.jsx)($a,{label:"Interval",description:"Decide how often to record this query",value:tn,onChange:Rn})})}),(0,o.jsx)("div",{className:$s.timeSelect,children:(0,o.jsx)(cs.xI,{name:"range",control:Mt,defaultValue:(0,xs.Cn)().from,render:({field:{ref:rn,value:tn,onChange:Rn,...jn}})=>{const Wn=(0,o.jsxs)(o.Fragment,{children:["Select this query's relative time range",(0,o.jsx)(vt,{href:"https://grafana.com/docs/grafana/latest/dashboards/time-range-controls/#time-units-and-relative-ranges",trackingSource:"time-range"})]}),bs=(0,o.jsx)(Ua.J,{description:Wn,children:"Relative Time Range *"});return(0,o.jsx)(ma.D,{label:bs,invalid:!!bt.range,error:bt.name?.message,required:!0,children:(0,o.jsx)(Ra.N,{timeRange:{from:tn,to:0},onChange:as=>Rn(as.from)})})}})}),Js?.length>0?(0,o.jsx)(ma.D,{label:"Template variables",description:"Select a value for each template variable",children:(0,o.jsx)(o.Fragment,{children:Js.map(rn=>{const{picker:tn,setValue:Rn}=Za.B.get(rn.type);return(0,o.jsx)(nn.I,{label:rn.name,labelWidth:16,children:(0,o.jsx)(tn,{onVariableChange:jn=>{(0,Na.SP)(jn)&&!(0,zs.R)(jn.current)&&Rn(jn,jn.current)},variable:rn,readOnly:!1})},rn.name)})})}):null,(0,o.jsx)(ma.D,{label:"Count query results",description:(0,o.jsxs)(o.Fragment,{children:["Count the rows returned from this query",(0,o.jsx)(vt,{href:"https://grafana.com/docs/grafana/latest/enterprise/recorded-queries/#create-a-recorded-query",trackingSource:"count-field"})]}),children:(0,o.jsx)(Pa.d,{...st("isCount"),id:"add-recorded-query-count"})}),(0,o.jsxs)(fn.F,{className:$s.testQuery,severity:Vn,title:Vn==="success"?"Successful":"Test this recorded query",buttonContent:Fa,onRemove:Vn!=="success"?()=>Ps(qt()):void 0,children:[ca(),ys==="An unknown issue is preventing the system from processing your query."&&cn($n)]}),(0,o.jsxs)(ln.a.ButtonRow,{children:[nr,Vn!=="success"&&(0,o.jsx)(nt.$n,{type:"submit","aria-label":"Start recording query button",children:"Start recording query"})]})]})})})]})},cn=Bt=>{let Wt="https://grafana.com/contact";return Bt&&Bt.slug&&Bt.lid&&(Wt=`https://grafana.com/orgs/${Bt.slug}/tickets?support=licensing&licenseId=${Bt.lid}`),(0,o.jsxs)(o.Fragment,{children:["To submit a support ticket to Grafana Labs, complete the ",(0,o.jsx)("a",{href:Wt,children:"Contact Grafana Labs"})]})},vn=Bt=>({modal:(0,W.css)`
      width: 550px;
    `,testQuery:(0,W.css)`
      margin-top: ${Bt.spacing(3)};
    `,timeSelect:(0,W.css)`
      width: 50%;
    `,docsLink:(0,W.css)`
      margin-left: ${Bt.spacing(.5)};
    `}),Pn=_a(kt),Kn=()=>{const Wt=mt.M_.getState().recordedQueries.prometheusWriteTarget;return!!Wt?.data_source_uid&&!!Wt?.remote_write_path};function us(){(0,n.a)("recordedqueries")&&s.$?.recordedQueries?.enabled&&(r.TP.user.orgRole!==""&&(0,mt.JD)((0,Pt.Nd)()),Qn.d.addExtraRenderAction(Wt=>Kn()&&(Wt.dataSource?.meta.backend||(0,Hn.s9)(Wt.dataSource))?(0,o.jsx)(Pn,{...Wt}):null),Qn.m.addExtraRenderAction(Wt=>Kn()?(0,o.jsx)(qn,{...Wt}):null))}var Gn=e(59083),ps=e(72321),Dt=e(78011),un=e(4179),Bn=e(31749),Jn=e(16797),In=e(19361),ms=e(38645),Es=e(31771);function Cs(){const Bt=s.$.whitelabeling;if(Bt){if(In.M.LoginTitle="Welcome to Grafana Enterprise",Bt.links.length>0&&(0,ms.DH)(()=>Bt.links.map(Wt=>({...Wt,target:"_blank"}))),(0,Es.Q)(Bt.publicDashboard),Bt.appTitle&&(In.M.AppTitle=Bt.appTitle),Bt.loginLogo&&(In.M.LoginLogo=Wt=>(0,o.jsx)("img",{className:(0,W.cx)(Wt.className,(0,W.css)`
            max-width: 150px;
            max-height: 250px;
            width: auto;
            @media ${Jn.mediaUp(s.$.theme.breakpoints.sm)} {
              max-width: 250px;
            }
          `),src:Bt.loginLogo,alt:"Login logo"}),In.M.LoginLogo.displayName="BrandingLoginLogo",In.M.LoginTitle="",In.M.GetLoginSubTitle=()=>""),Bt.loginTitle&&(In.M.LoginTitle=Bt.loginTitle),Bt.hideEdition&&(In.M.HideEdition=Bt.hideEdition),Bt.loginSubtitle&&(In.M.GetLoginSubTitle=()=>Bt.loginSubtitle),Bt.menuLogo&&(In.M.MenuLogo=Wt=>(0,o.jsx)("img",{className:Wt.className,src:Bt.menuLogo,alt:"Menu logo"}),In.M.MenuLogo.displayName="BrandingMenuLogo"),Bt.loginBackground){const Wt=(0,W.css)`
      background: ${Bt.loginBackground};
      background-size: cover;
    `;In.M.LoginBackground=_t=>(0,o.jsx)("div",{className:(0,W.cx)(Wt,_t.className),children:_t.children}),In.M.LoginBackground.displayName="BrandingLoginBackground"}if(Bt.loginBoxBackground){const Wt=(0,W.css)`
      background: ${Bt.loginBoxBackground};
      background-size: cover;
    `;In.M.LoginBoxBackground=()=>Wt}}}function hs(){(0,n.a)("caching")&&(0,d.Co)(k),(0,n.a)("reports")&&(0,d.Co)(un.Ay),(0,n.a)("analytics")&&(0,d.Co)(Ue),(0,n.a)("recordedqueries")&&(0,d.Co)(Gn.Fu),(0,n.a)("saml")&&(0,d.Co)(K.y6),s.$.featureToggles.teamHttpHeaders&&(0,d.Co)(Bn.aV),s.$.featureToggles.notificationBanner&&(0,n.a)("announcementBanner")&&((0,d.Co)({[M.Aj.reducerPath]:M.Aj.reducer}),(0,d.C3)(M.Aj.middleware))}function fa(){const Bt=s.$.featureToggles.featureHighlights;(0,se.x9)(),(0,ps.B)(),Ls(),(0,n.a)("saml")&&j(),((0,n.a)("whitelabeling")||(0,n.a)("grafanacloud"))&&Cs(),(0,n.a)("recordedqueries")&&s.$.publicDashboardAccessToken===""&&us(),(0,n.a)("admin")&&x(),(0,n.a)("publicDashboardsEmailSharing")&&(l.jK.push({path:"/public-dashboards/:accessToken/request-access",component:(0,t.lazy)(()=>e.e(5318).then(e.bind(e,81054))),chromeless:!0},{path:"/public-dashboards/:accessToken/confirm-access",component:(0,t.lazy)(()=>e.e(1290).then(e.bind(e,49542))),chromeless:!0}),(0,i.AY)()&&e.e(800).then(e.bind(e,50800))),(0,n.a)("saml")&&l.jK.push({path:"/admin/authentication/saml/:step?",component:(0,t.lazy)(()=>Promise.all([e.e(7237),e.e(8224)]).then(e.bind(e,17237)))});const Wt="/datasources/edit/:uid/cache",_t=`${g.b.DataSourcesEdit}/cache`;(0,n.a)("caching")?(l.jK.push({path:Wt,component:(0,t.lazy)(()=>Promise.all([e.e(4258),e.e(6843)]).then(e.bind(e,1202)))}),l.jK.push({path:_t,component:(0,t.lazy)(()=>Promise.all([e.e(4258),e.e(5012)]).then(e.bind(e,8242)))})):Bt&&(l.jK.push({path:`${Wt}/upgrade`,component:(0,t.lazy)(()=>Promise.all([e.e(4258),e.e(8435)]).then(e.bind(e,51054)))}),l.jK.push({path:`${_t}/upgrade`,component:(0,t.lazy)(()=>Promise.all([e.e(4258),e.e(5346)]).then(e.bind(e,99726)))}));const sn="/datasources/edit/:uid/insights",Cn=`${g.b.DataSourcesEdit}/insights`;s.$.analytics?.enabled&&((0,n.a)("analytics")?(l.jK.push({path:sn,component:(0,t.lazy)(()=>Promise.all([e.e(4258),e.e(8890)]).then(e.bind(e,67707)))}),l.jK.push({path:Cn,component:(0,t.lazy)(()=>Promise.all([e.e(4258),e.e(847)]).then(e.bind(e,41603)))})):Bt&&(l.jK.push({path:`${sn}/upgrade`,component:(0,t.lazy)(()=>Promise.all([e.e(4258),e.e(876)]).then(e.bind(e,96969)))}),l.jK.push({path:`${Cn}/upgrade`,component:(0,t.lazy)(()=>Promise.all([e.e(4258),e.e(5967)]).then(e.bind(e,86337)))})));const Fn="/datasources/edit/:uid/permissions",$n=`${g.b.DataSourcesEdit}/permissions`;(0,n.a)("dspermissions.enforcement")?(l.jK.push({path:Fn,component:(0,t.lazy)(()=>Promise.all([e.e(4258),e.e(1217),e.e(5357)]).then(e.bind(e,77191)))}),l.jK.push({path:$n,component:(0,t.lazy)(()=>Promise.all([e.e(4258),e.e(1217),e.e(4738)]).then(e.bind(e,30436)))})):Bt&&(l.jK.push({path:Fn+"/upgrade",component:(0,t.lazy)(()=>Promise.all([e.e(4258),e.e(7785)]).then(e.bind(e,48326)))}),l.jK.push({path:`${$n}/upgrade`,component:(0,t.lazy)(()=>Promise.all([e.e(4258),e.e(4004)]).then(e.bind(e,42932)))})),s.$.reporting?.enabled&&((0,n.a)("reports")?(l.jK.push({path:Dt.C1,component:(0,t.lazy)(()=>e.e(3057).then(e.bind(e,59701)))},{path:`${Dt.C1}/settings`,component:(0,t.lazy)(()=>e.e(6962).then(e.bind(e,14490)))},{path:"/d-csv/:uid",pageClass:"dashboard-solo",routeName:c.DashboardRoutes.Normal,component:(0,t.lazy)(()=>Promise.all([e.e(9569),e.e(4650)]).then(e.bind(e,7882)))}),s.$.featureToggles.newPDFRendering&&l.jK.push({path:"/d-report/:uid/:slug?",component:(0,t.lazy)(()=>e.e(1538).then(e.bind(e,62050)))})):Bt&&l.jK.push({path:Dt.C1,component:(0,t.lazy)(()=>e.e(1517).then(e.bind(e,47610)))}),(0,n.a)("reports.creation")&&(l.jK.push({path:`${Dt.C1}/new`,component:(0,t.lazy)(()=>e.e(2560).then(e.bind(e,80304)))}),l.jK.push({path:`${Dt.C1}/:step?/:id?`,component:(0,t.lazy)(()=>e.e(2560).then(e.bind(e,80304)))})));const ts=(0,n.a)("recordedqueries")&&s.$?.recordedQueries?.enabled;r.TP.isEditor&&ts&&l.jK.push({path:"/recorded-queries",component:(0,t.lazy)(()=>e.e(5963).then(e.bind(e,26970)))},{path:"/recorded-queries/write-target",component:(0,t.lazy)(()=>e.e(1893).then(e.bind(e,77738)))}),s.$.featureToggles.notificationBanner&&(0,n.a)("announcementBanner")&&(l.jK.push({path:"/admin/banner-settings",component:(0,t.lazy)(()=>e.e(2715).then(e.bind(e,52770))),roles:()=>r.TP.evaluatePermission([xe.AccessControlAction.ActionBannersWrite])}),O()),s.$.featureToggles.groupAttributeSync&&(0,n.a)("groupsync")&&l.jK.push({path:"/admin/access/groupsync",roles:()=>r.TP.evaluatePermission([c.AccessControlAction.GroupSyncMappingsRead,c.AccessControlAction.GroupSyncMappingsWrite]),component:(0,t.lazy)(()=>Promise.all([e.e(1783),e.e(8573)]).then(e.bind(e,20996)))})}function oa(){ee(),l.jK.push({path:"/admin/licensing",roles:()=>r.TP.evaluatePermission([xe.AccessControlAction.LicensingRead,c.AccessControlAction.ActionServerStatsRead]),component:(0,t.lazy)(()=>e.e(6125).then(e.bind(e,96713)))}),r.TP.isSignedIn&&s.$.licenseInfo.stateInfo!=="Licensed"&&(0,a.Xp)((0,fe.L)(),s.$.featureToggles.featureHighlights?fe.X.Test:fe.X.Control,"")}function na(){oa(),fa()}},23428:(G,R,e)=>{"use strict";e.d(R,{BV:()=>o,Bb:()=>m,Qf:()=>n,WN:()=>u,_7:()=>t,dO:()=>a,eZ:()=>l,i$:()=>h,oe:()=>c});const t=80,n=100,s=0,a=1,r=2,g=3,i=4,l=5,d=6,c=5,h=3600,o="grafana.licence.warning.dismissUntil",m="users",u="AWS/Marketplace"},56784:(G,R,e)=>{"use strict";e.d(R,{x9:()=>D});var t=e(74848),n=e(96540),s=e(47232),a=e(32264),r=e(85957),g=e(16233),i=e(33390),l=e(13680),d=e(32196),c=e(40845),h=e(42418);const o=({title:W,subTitle:U,severity:F,onButtonClick:V,buttonText:w})=>{const z=(0,c.IS)(v);return(0,t.jsx)("div",{className:z.container,children:(0,t.jsx)("div",{className:"page-container",children:(0,t.jsx)(h.F,{title:W,severity:F,buttonContent:w,onRemove:V,children:U})})})},m=({isLicensingReader:W,children:U})=>W?(0,t.jsx)("a",{href:"/admin/licensing",children:U}):(0,t.jsx)("a",{href:"https://grafana.com/docs/grafana/latest/enterprise/license-expiration/",target:"_blank",rel:"noreferrer noopener",children:U}),u=({isLicensingReader:W})=>(0,t.jsx)(o,{title:"Your Grafana Enterprise license has expired",subTitle:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m,{isLicensingReader:W,children:"Some features"})," have been disabled."]}),severity:"error"}),p=({isLicensingReader:W})=>(0,t.jsx)(o,{title:"Your Grafana Enterprise license is invalid",subTitle:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m,{isLicensingReader:W,children:"Some features"})," have been disabled."]}),severity:"error"}),f=({days:W,onCloseWarning:U,isLicensingReader:F})=>(0,t.jsx)(o,{onButtonClick:U,title:"Your Grafana Enterprise license will expire soon",subTitle:(0,t.jsxs)(t.Fragment,{children:[W," days remaining, after which"," ",(0,t.jsx)(m,{isLicensingReader:F,children:"Enterprise features will be disabled."})]}),severity:"info",buttonText:"Dismiss"}),y=({days:W,onCloseWarning:U,isLicensingReader:F})=>(0,t.jsx)(o,{onButtonClick:U,title:"Your Grafana Enterprise token needs to be renewed",subTitle:(0,t.jsxs)(t.Fragment,{children:["Your license token has ",W," days remaining, after which"," ",(0,t.jsx)(m,{isLicensingReader:F,children:"Enterprise features will be disabled."})]}),severity:"info",buttonText:"Dismiss"}),x=({activeUsers:W,maxUsers:U,slug:F,onRefreshWarning:V})=>(0,t.jsx)(o,{onButtonClick:V,title:"You have exceeded the included number of active users",subTitle:(0,t.jsxs)(t.Fragment,{children:["Your Grafana Enterprise license includes ",U," active users; you currently have ",W," active users. Please"," ",F?(0,t.jsx)("a",{href:"https://grafana.com/orgs/"+F+"/licenses",target:"_blank",rel:"noreferrer noopener",children:"upgrade your license."}):"upgrade your license."]}),severity:"error",buttonText:"Refresh"}),v=W=>({container:(0,d.css)`
      position: absolute;
      bottom: 0;
      width: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      z-index: 3;
    `});var P=e(23428),E=e(73803);function D(){(0,r.J3)(C)}function C(){const[W,U]=(0,n.useState)(!1),[F,V]=(0,n.useState)(a.$.licensing),w=i.A.get(P.BV),z=w&&w>(0,s.KQ)().valueOf(),N=g.TP.hasPermission(l.AccessControlAction.LicensingRead),H=g.TP.hasPermission(l.AccessControlAction.LicensingRead),Q=N&&T()&&!z,X=N&&M()&&!z,ee=B();let Z=!1,q=0,ae=0;if(F.limitBy===P.Bb){const te=L(F.includedUsers,F.activeUsers);Z=ee&&te&&(N||H),q=F.activeUsers,ae=F.includedUsers}if(A()||K())return null;const k=()=>{const te=(0,s.KQ)().add(P.oe,"d").valueOf();i.A.set(P.BV,te),U(!0)},se=async()=>{const te=await(0,E.o0)().catch(ne=>null);if(te){const ne={...F,activeUsers:te.active_users};a.$.licensing=ne,V(ne)}};if(W)return null;if(b())return(0,t.jsx)(p,{isLicensingReader:H});if(O())return(0,t.jsx)(u,{isLicensingReader:H});if(Z)return(0,t.jsx)(x,{activeUsers:q,maxUsers:ae,slug:F.slug,onRefreshWarning:N?se:void 0});if(Q){const te=S();return setTimeout(k,1e3*P.i$),(0,t.jsx)(f,{days:te,onCloseWarning:k,isLicensingReader:H})}else if(X){const te=I();return setTimeout(k,1e3*P.i$),(0,t.jsx)(y,{days:te,onCloseWarning:k,isLicensingReader:H})}return null}function b(){const{expiry:W,hasLicense:U}=a.$.licenseInfo;return U&&!W}function T(){const{licenseExpiry:W,licenseExpiryWarnDays:U=30}=a.$.licensing;return W>0&&(0,s.KQ)(W*1e3)<(0,s.KQ)().add(U,"d")}function S(){const{licenseExpiry:W}=a.$.licensing;return Math.ceil((W-(0,s.KQ)().unix())/3600/24)}function O(){const{licenseExpiry:W}=a.$.licensing;return W>0&&(0,s.KQ)(W*1e3)<(0,s.KQ)()}function M(){const{tokenExpiry:W,tokenExpiryWarnDays:U=3}=a.$.licensing;return W>0&&(0,s.KQ)(W*1e3)<(0,s.KQ)().add(U,"d")}function I(){const{tokenExpiry:W}=a.$.licensing;return Math.ceil((W-(0,s.KQ)().unix())/3600/24)}function L(W,U){return W===void 0||U===void 0?!1:W!==-1&&U>W}function B(){return!a.$.licensing.usageBilling}function j(){const W=/\/d-solo\//,U=window.location.pathname;return W.test(U)}function A(){return j()}function K(){const W=/\/admin\/licensing$/,U=window.location.pathname;return W.test(U)}},73803:(G,R,e)=>{"use strict";e.d(R,{$6:()=>s,Pe:()=>n,Sj:()=>a,o0:()=>r});var t=e(27677);const n=async()=>(0,t.AI)().get("/api/licensing/token"),s=async g=>(0,t.AI)().post("/api/licensing/token",{token:g}),a=async()=>(0,t.AI)().post("/api/licensing/token/renew",{}),r=async()=>(0,t.AI)().get("/api/licensing/refresh-stats")},28036:(G,R,e)=>{"use strict";e.r(R),e.d(R,{ENTERPRISE_I18N_NAMESPACE:()=>n,LOCALE_EXTENSIONS:()=>s});var t=e(74513);const n="grafana-enterprise",s={[t.MB]:()=>e.e(9740).then(e.t.bind(e,29740,19)),[t.NY]:()=>e.e(7179).then(e.t.bind(e,87179,19)),[t.d_]:()=>e.e(6119).then(e.t.bind(e,16119,19)),[t.rT]:()=>e.e(3749).then(e.t.bind(e,23749,19)),[t.fY]:()=>e.e(8249).then(e.t.bind(e,18249,19)),[t.jQ]:()=>e.e(8591).then(e.t.bind(e,28591,19))}},41067:(G,R,e)=>{"use strict";e.d(R,{Au:()=>i,FW:()=>d,K4:()=>a,QH:()=>s,XP:()=>l,_x:()=>r,db:()=>c});var t=e(47232),n=e(17172);const s="YYYY-MM-DD",a=async(h,o)=>await(0,n.AI)().get(`/api/usage/dashboard/${h}/views/recent?limit=${o}`,{retry:0}),r=async(h,o)=>await(0,n.AI)().get(`/api/usage/dashboard/${h}/views?limit=${o}`),g=h=>{const o=[];for(let m in h)o.push(h[m]);return o.sort((m,u)=>(0,t.KQ)(m.day,s).valueOf()-(0,t.KQ)(u.day,s).valueOf()),o},i=async(h,o)=>{const m=await(0,n.AI)().get(`/api/usage/dashboard/${h}/daily`,{days:o});return g(m)},l=async(h,o)=>{const m=await(0,n.AI)().get(`/api/usage/dashboard/${h}/public/daily`,{days:o});return g(m)},d=async(h,o,m)=>{const u=await(0,n.AI)().get(`/api/usage/datasource/${h}/daily`,{from:o,to:m});return g(u)},c=async h=>await(0,n.AI)().get(`/api/usage/dashboard/${h}/info`)},10505:(G,R,e)=>{"use strict";e.d(R,{k:()=>s});var t=e(32196),n=e(3911);const s=(0,n.N)(a=>{const r=a.colors.background.secondary;return{tabContent:(0,t.css)`
      height: 100%;
    `,tabsBar:(0,t.css)`
      padding-left: ${a.spacing(2)};
      margin: ${a.spacing(3,-1,-3,-3)};
    `,graphContainer:(0,t.css)`
      margin-top: ${a.spacing(2)};
      background-color: ${r};
    `,panelContent:(0,t.css)`
      contain: none;
    `,userBoxesContainer:(0,t.css)`
      display: flex;
      margin-top: ${a.spacing(3)};

      > div + div {
        margin-left: ${a.spacing(2)};
      }
    `,userBox:(0,t.css)`
      padding: ${a.spacing(2)};
      flex: 1;
      text-align: center;
      background-color: ${r};
      border-radius: 3px;

      button,
      img {
        margin: ${a.spacing(0,0,1,0)};
      }
    `,userName:(0,t.css)`
      font-weight: ${a.typography.fontWeightBold};
    `,tableContainer:(0,t.css)`
      margin-top: ${a.spacing(3)};
      background-color: ${r};
      padding-bottom: ${a.spacing(1)};
      border-radius: 3px;

      [role='cell']:first-child > div {
        padding: 4px;
      }
      [role='columnheader']:first-child {
        height: 33px;
      }
      [role='row']:not(:only-child):nth-child(odd) {
        background-color: ${a.colors.background.primary};
      }
    `,tableHeader:(0,t.css)`
      padding: ${a.spacing(0,2,.5,2)};
      display: flex;
      justify-content: space-between;
      align-items: center;

      h4 {
        margin-bottom: 0px;
        padding: ${a.spacing(3,0)};
      }
    `,userIcon:(0,t.css)`
      margin: 0 0;
      width: 26px;
      height: 26px;
      line-height: 20px;

      & > * {
        width: 26px;
        height: 26px;
        line-height: 20px;
      }
    `}})},80500:(G,R,e)=>{"use strict";e.d(R,{z:()=>g});var t=e(74848),n=e(32196),s=e(65879),a=e(19347),r=e(40845);const g=({recordedQuery:d,buttons:c})=>{const h=(0,r.of)(l),o=(0,a.l)()?.getInstanceSettings(d.queries[0]?.datasource);return(0,t.jsxs)("div",{className:h.alert,children:[o?.meta&&(0,t.jsx)("img",{className:h.media,src:o.meta.info.logos.small,alt:"Query logo"}),(0,t.jsx)("div",{className:h.body,children:(0,t.jsxs)("div",{className:h.info,children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:h.heading,children:d.name}),(0,t.jsx)("p",{className:h.description,children:i(d)})]}),(0,t.jsx)("div",{className:h.buttonWrapper,children:c.map((m,u)=>(0,t.jsx)("div",{className:h.button,children:m},`button-${u}`))})]})})]})},i=d=>{const c=[`Interval: ${(0,s.secondsToHms)(d.interval)}`,`Range: Last ${(0,s.secondsToHms)(d.range)}`],h=(0,a.l)()?.getInstanceSettings(d.queries[0]?.datasource);return h!==void 0&&c.unshift(h.name),d.description!==""&&c.push(`${d.description}`),c.join(" | ")},l=d=>{const c=d.shape.borderRadius();return{info:(0,n.css)`
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: center;
      width: 100%;
    `,heading:(0,n.css)`
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      margin-bottom: 0;
      font-size: ${d.typography.size.md};
      letter-spacing: inherit;
      line-height: ${d.typography.body.lineHeight};
      color: ${d.colors.text.primary};
      font-weight: ${d.typography.fontWeightMedium};
    `,description:(0,n.css)`
      width: 100%;
      margin: ${d.spacing(1,0,0)};
      color: ${d.colors.text.secondary};
      line-height: ${d.typography.body.lineHeight};
    `,alert:(0,n.css)`
      flex-grow: 1;
      position: relative;
      border-radius: ${c};
      display: flex;
      flex-direction: row;
      align-items: center;
      background: ${d.colors.background.secondary};
      box-shadow: ${d.shadows.z1};
      margin-bottom: ${d.spacing(1)};

      &:before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        background: ${d.colors.background.primary};
        z-index: -1;
      }
    `,body:(0,n.css)`
      color: ${d.colors.text.secondary};
      padding: ${d.spacing(2)};
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      overflow-wrap: break-word;
      word-break: break-word;
    `,content:(0,n.css)`
      color: ${d.colors.text.secondary};
      padding-top: ${d.spacing(1)};
      margin-left: 26px;
    `,media:(0,n.css)`
      margin-left: ${d.spacing(2)};
      width: 40px;
    `,buttonWrapper:(0,n.css)`
      padding: ${d.spacing(1)};
      background: none;
      display: flex;
      align-items: center;
      margin-right: ${d.spacing()};
    `,button:(0,n.css)`
      margin-left: ${d.spacing()};
    `}}},82063:(G,R,e)=>{"use strict";e.d(R,{Lc:()=>d,Nd:()=>c,Of:()=>h,eB:()=>i,qE:()=>g,u6:()=>l,xY:()=>r});var t=e(75505),n=e(17172),s=e(59083);const a="api/recording-rules";function r(){return async o=>{o((0,s.lV)());try{const m=await(0,n.AI)().get(a);o((0,s._i)(m))}finally{o((0,s.aT)())}}}function g(o){return async m=>{await(0,n.AI)().put(a,o),m((0,s.cz)(o))}}function i(o){return async m=>{await(0,n.AI)().delete(`${a}/${o.id}`),m((0,s.YE)(o))}}function l(o){return(0,t.s)((0,n.AI)().fetch({method:"POST",url:a,data:o,showErrorAlert:!1}))}function d(o){return(0,t.s)((0,n.AI)().fetch({method:"POST",url:`${a}/test`,data:o,showSuccessAlert:!1,showErrorAlert:!1}))}function c(){return async o=>{try{const m=await(0,t.s)((0,n.AI)().fetch({method:"GET",url:`${a}/writer`,showSuccessAlert:!1,showErrorAlert:!1}));o((0,s.NX)(m.data))}catch(m){m.status!==404&&console.error(m)}}}function h(o){return(0,t.s)((0,n.AI)().fetch({method:"POST",url:`${a}/writer`,data:o,showSuccessAlert:!1,showErrorAlert:!1}))}},59083:(G,R,e)=>{"use strict";e.d(R,{Fu:()=>h,NX:()=>d,YE:()=>l,_i:()=>g,aT:()=>r,cz:()=>i,lV:()=>a});var t=e(65307);const n={recordedQueries:[],isLoading:!1,errorRecordedQueryTestResponse:""},s=(0,t.Z0)({name:"recorded-queries",initialState:n,reducers:{loadRecordedQueries:o=>({...o,isLoading:!0}),endLoadRecordedQueries:o=>({...o,isLoading:!1}),loadedRecordedQueries:(o,m)=>{const u=m.payload;return{...o,recordedQueries:u}},updateRecordedQueries:(o,m)=>{const u=m.payload,p=o.recordedQueries.map(f=>f.id===u.id?u:f);return{...o,recordedQueries:p}},deleteRecordedQueries:(o,m)=>{const u=m.payload,p=o.recordedQueries.filter(f=>f.id!==u.id);return{...o,recordedQueries:p}},setPrometheusWriteTarget:(o,m)=>{const u=m.payload;return{...o,prometheusWriteTarget:u}}}}),{loadRecordedQueries:a,endLoadRecordedQueries:r,loadedRecordedQueries:g,updateRecordedQueries:i,deleteRecordedQueries:l,setPrometheusWriteTarget:d}=s.actions,h={recordedQueries:s.reducer}},95114:(G,R,e)=>{"use strict";e.d(R,{S:()=>n,T:()=>t});const t=s=>s.recordedQueries,n=s=>s.prometheusWriteTarget},19065:(G,R,e)=>{"use strict";e.d(R,{E:()=>l,c:()=>g});var t=e(74848),n=e(42418),s=e(8484);const a=()=>(0,t.jsx)(s.x6,{i18nKey:"reporting.errors.action-message",children:"Please contact your Grafana administrator to install the plugin."}),r=()=>(0,t.jsxs)(s.x6,{i18nKey:"reporting.errors.no-renderer-description",children:["To generate PDF reports, you must install the"," ",(0,t.jsx)("a",{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",target:"_blank",rel:"noopener noreferrer",className:"external-link",children:"Grafana Image Renderer"})," ","plugin."]}),g=({variant:d="info"})=>(0,t.jsxs)(n.F,{title:(0,s.t)("reporting.errors.no-renderer-title","Image renderer plugin not installed"),severity:d,children:[(0,t.jsx)(r,{})," ",(0,t.jsx)("br",{}),(0,t.jsx)(a,{})]}),i=()=>(0,t.jsxs)(s.x6,{i18nKey:"reporting.errors.old-renderer-description",children:["To generate CSV files, you must update the"," ",(0,t.jsx)("a",{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",target:"_blank",rel:"noopener noreferrer",className:"external-link",children:"Grafana Image Renderer"})," ","plugin."]}),l=()=>(0,t.jsxs)(n.F,{title:(0,s.t)("reporting.errors.old-renderer-title","You are using an old version of the image renderer plugin"),severity:"warning",children:[(0,t.jsx)(i,{})," ",(0,t.jsx)("br",{}),(0,t.jsx)(a,{})]})},36149:(G,R,e)=>{"use strict";e.d(R,{o:()=>s});var t=e(74848),n=e(37166);const s=({message:a})=>(0,t.jsx)(n.w,{title:"Feature not available with an expired license",url:"https://grafana.com/docs/grafana/latest/enterprise/license-expiration/",urlTitle:"Read more on license expiration",children:(0,t.jsx)("span",{children:a})})},78011:(G,R,e)=>{"use strict";e.d(R,{C1:()=>a,D3:()=>s,In:()=>i,Sw:()=>r,Vb:()=>g,xJ:()=>n});var t=e(8484);const n="/public/img/grafana_icon.svg",s="https://grafana.com/static/assets/img/grafana_logo_lockup_ltbg.png",a="/reports",r="api/reports/images/",g=2,i=()=>({1:{label:(0,t.t)("export.pdf.zoom-in-label","Zoom in"),style:{transform:"translateX(-10%)"}},2:{label:(0,t.t)("export.pdf.zoom-standard-label","Standard")},3:{label:(0,t.t)("export.pdf.zoom-out-label","Zoom out"),style:{width:"100%",left:"91%"}}})},72321:(G,R,e)=>{"use strict";e.d(R,{B:()=>Gn,E:()=>ps});var t=e(71733),n=e(33378),s=e(14110),a=e(39601),r=e(76323),g=e(2913),i=e(8484),l=e(16233),d=e(35538),c=e(1702),h=e(22699),o=e(30040),m=e(66714),u=e(97246),p=e(11675),f=e(13680),y=e(68539),x=e(74848),v=e(32196),P=e(40845),E=e(55852),D=e(77454),C=e(40981);const b=({dashboard:Dt,onDismiss:un})=>{const Bn=(0,P.of)(T),Jn=!(0,n.a)("reports.creation");function In(){(0,s.rR)("dashboards_sharing_report_create_clicked"),un&&un()}return Jn?(0,x.jsxs)("div",{className:Bn.container,children:[(0,x.jsx)(D.Iz,{featureName:"reporting",featureId:"reporting-tab"}),(0,x.jsx)(D.ep,{image:"reporting-email.png",featureName:"reporting",featureUrl:"https://grafana.com/docs/grafana/latest/enterprise/reporting",description:"Reporting allows you to automatically generate PDFs from any of your dashboards and have Grafana email them to interested parties on a schedule."})]}):(0,x.jsxs)(x.Fragment,{children:[(0,d.z5)()&&(0,x.jsxs)("div",{className:Bn.highlight,children:[(0,x.jsx)(D.Iz,{featureId:"reporting-tab",eventVariant:"trial",featureName:"reporting",text:"Create unlimited reports during your trial of Grafana Pro."}),(0,x.jsx)("h3",{children:"Get started with reporting"}),(0,x.jsx)("h6",{children:"Reporting allows you to automatically generate PDFs from any of your dashboards and have Grafana email them to interested parties on a schedule."})]}),(0,x.jsx)(E.z9,{href:(0,C.A2)(Dt),onClick:In,className:Bn.button,children:"Create report using this dashboard"}),(0,d.z5)()&&(0,x.jsx)(E.z9,{fill:"text",href:"https://grafana.com/docs/grafana/latest/enterprise/reporting",children:"Learn more"})]})},T=Dt=>({container:(0,v.css)`
      display: flex;
      flex-direction: column;
      align-items: flex-start;
    `,button:(0,v.css)`
      margin-right: ${Dt.spacing(2)};
    `,highlight:(0,v.css)`
      margin-bottom: ${Dt.spacing(3)};

      h6 {
        font-weight: ${Dt.typography.fontWeightLight};
      }
    `});var S=e(2543),O=e(96540),M=e(49785),I=e(71468),L=e(54148),B=e(14578),j=e(84167),A=e(17624),K=e(78011),W=e(24631),U=e(4179),F=e(47071);const V=Dt=>(0,S.upperFirst)(Dt.map(un=>{switch(un){case f.ReportFormat.CSV:case f.ReportFormat.PDF:return un.toUpperCase();case f.ReportFormat.Image:return"embedded image";case f.ReportFormat.PDFTablesAppendix:return"PDF tables appendix";case f.ReportFormat.PDFTables:return"PDF tables"}}).join(", "));var w=e(78073),z=e(58949),N=e(32264);const H=({uid:Dt,name:un,className:Bn})=>{const Jn=(0,P.of)(Q);return Dt?(0,x.jsx)("a",{href:`${N.$.appUrl}d/${Dt}`,className:(0,v.cx)(Jn.link,Bn),target:"_blank",rel:"noreferrer",children:un||"View dashboard"}):null},Q=Dt=>({link:(0,v.css)`
      display: inline-block;
      color: ${Dt.colors.text.link};
      margin-top: ${Dt.spacing(1)};
      font-size: ${Dt.typography.bodySmall.fontSize};

      :hover {
        text-decoration: underline;
      }
    `});var X=e(35339),ee=e(1009);const Z=Dt=>{if(!Dt)return ps[0];const un=ps.findIndex(Bn=>Bn.id===Dt);return un===ps.length-1?ps[un]:ps[un+1]},q=Dt=>{if(!Dt||Dt===ps[0].id)return;const un=ps.findIndex(Bn=>Bn.id===Dt);return ps[un-1]},ae=(Dt,un)=>{const Bn=q(Dt);Bn&&Bn.id!==Dt&&a.Ny.push((0,C.Do)(Bn.id,un))};var k=e(13390);const se={reportForm:{nextStep:Dt=>`data-testid report form next ${Dt}`,previousStep:Dt=>`data-testid report form previous ${Dt}`,selectDashboard:Dt=>`data-testid report select dashboard ${Dt}`,formatCheckbox:Dt=>`data-testid report form checkbox format ${Dt}`,nameInput:"data-testid report name input",sendTestEmailButton:"data-testid report send test email button",useRecipientsCheckbox:"data-testid report send test email use recipients checkbox",sendTestEmailConfirmButton:"data-testid report send test email confirm button",submitButton:"data-testid report form submit button"},scheduleReport:{shareMenuItem:"data-testid new share button schedule report"},NewShareButton:{Menu:{scheduleReport:"data-testid new share button schedule report"}},NewExportButton:{Menu:{exportAsPdf:"data-testid new export button export as pdf"}},ExportAsPdf:{unavailableFeatureInfoBox:"data-testid unavailable feature info box",noRendererInfoBox:"data-testid no renderer info box",container:"data-testid export as pdf drawer container",orientationButton:"data-testid export as pdf orientation button",layoutButton:"data-testid export as pdf layout button",zoomSlider:"data-testid export as zoom slider",previewImage:"data-testid export as pdf preview image",generatePdfButton:"data-testid export as pdf generate pdf button",cancelButton:"data-testid export as pdf cancel button",modalCancelButton:"data-testid old modal cancel button",saveAsPdfButton:"data-testid save as pdf button"}},ne={pages:{Report:{url:"/reports",createButtonCTA:k.X.CallToActionCard.buttonV2("Create a new report")}},components:se},le=(0,O.forwardRef)(({activeStep:Dt,disabled:un,reportId:Bn},Jn)=>{const In=(0,P.of)(re),ms=(0,O.useRef)(null),Es=q(Dt),Cs=Z(Dt),hs=Cs.id===Dt;return(0,O.useImperativeHandle)(Jn,()=>({click:()=>{ms.current?.click()}})),(0,x.jsx)("div",{className:In.buttonRow,children:(0,x.jsx)("div",{className:In.buttonRowInner,children:(0,x.jsxs)("div",{children:[Es&&(0,x.jsxs)(E.$n,{variant:"secondary",onClick:()=>ae(Dt,Bn),"data-testid":ne.components.reportForm.previousStep(Es.name),children:["Previous: ",Es.name]}),!hs&&(0,x.jsx)(E.$n,{ref:ms,disabled:un,type:"submit","data-testid":ne.components.reportForm.nextStep(Cs.name),children:`Next: ${Cs.name}`})]})})})});le.displayName="ButtonRow";const re=Dt=>({buttonRow:(0,v.css)`
      display: flex;
      padding: ${Dt.spacing(2,0,.5,0)};
      border-top: 1px solid ${Dt.colors.border.weak};
      width: 100%;
      background-color: ${Dt.colors.background.primary};
      button {
        &:first-of-type {
          margin-right: ${Dt.spacing(2)};
        }
        &:last-of-type {
          margin-right: 0;
        }
      }
    `,buttonRowInner:(0,v.css)`
      display: flex;
      justify-content: space-between;
      width: 100%;
    `});var de=e(29158),oe=e(96374),J=e(15626),ce=e(65031);const pe=Dt=>{const{report:un}=Dt.reports;return{report:un}},xe={loadReport:W.N1,deleteReport:W.y8,updateReport:W.A0},fe=(0,I.connect)(pe,xe),Ee=({report:Dt,loadReport:un,deleteReport:Bn,updateReport:Jn,disabled:In})=>{const ms=(0,P.of)(Se),[Es,Cs]=(0,O.useState)(!1),hs=l.TP.hasPermission(f.AccessControlAction.ReportingDelete),fa=l.TP.hasPermission(f.AccessControlAction.ReportingWrite),{showPlay:oa,disableEdit:na,reportState:Bt}=(0,ce.m)(Dt),Wt=async()=>{const sn=(0,ce.U)(Bt);await Jn({...Dt,state:sn}),Dt.id&&un(Dt.id)},_t=()=>{Bn(Dt.id),Cs(!1),a.Ny.push(K.C1)};return(0,x.jsxs)("div",{className:ms.editActions,children:[(0,x.jsx)(E.z9,{href:(0,C.Do)(f.StepKey.SelectDashboard,Dt.id),type:"button",disabled:!fa,children:"Edit report"}),(0,x.jsx)(E.$n,{type:"button",variant:"secondary",disabled:na||!fa||In,onClick:Wt,children:oa?Bt===f.ReportState.Draft?(0,J.U)(Dt.schedule):"Resume":"Pause"}),(0,x.jsx)(de.K,{variant:"destructive","aria-label":"Delete report",tooltip:"Delete",name:"trash-alt",disabled:!hs,onClick:()=>Cs(!0)}),(0,x.jsx)(oe.u,{isOpen:Es,title:"Delete report",body:"Are you sure you want to delete this report?",confirmText:"Delete",onConfirm:_t,onDismiss:()=>Cs(!1)})]})},Se=Dt=>({editActions:(0,v.css)`
      display: flex;
      align-items: center;
      justify-content: flex-end;
      width: 100%;
      margin-bottom: ${Dt.spacing(3)};

      button,
      a {
        margin-left: ${Dt.spacing(2)};
      }
    `}),ye=fe(Ee),Ve=(0,O.forwardRef)(({saveDraft:Dt,children:un,existingReport:Bn,disabled:Jn,activeStep:In,onDiscard:ms,schedule:Es},Cs)=>{const hs=(0,P.of)(Me),fa=Z(In),oa=(0,O.useRef)(null),na=fa.id===In,Bt=Bn?"Update report":(0,J.U)(Es);return(0,O.useImperativeHandle)(Cs,()=>({click:()=>{oa.current?.click()}})),(0,x.jsxs)("div",{className:hs.container,children:[na&&(0,x.jsx)(E.$n,{ref:oa,disabled:Jn,type:"submit","data-testid":ne.components.reportForm.submitButton,children:Bt}),(0,x.jsx)(E.$n,{variant:"secondary",onClick:Dt,children:"Save as draft"}),un,(0,x.jsx)(E.$n,{variant:"destructive",fill:"outline",onClick:ms,children:"Discard"})]})});Ve.displayName="PageActions";const Me=Dt=>({container:(0,v.css)`
      display: flex;
      justify-content: flex-end;
      width: 100%;

      & > button,
      & > a {
        margin-right: ${Dt.spacing(3)};
      }
    `}),Ce=Dt=>{const{report:un,isUpdated:Bn,visitedSteps:Jn}=Dt.reports;return{existingReport:!!un.id,isUpdated:Bn,report:un,visitedSteps:Jn}},Ue={addVisitedStep:U.wj,clearReportState:U.$J,createReport:W.LU,updateReport:W.A0},Ae=(0,I.connect)(Ce,Ue),we=({activeStep:Dt,addVisitedStep:un,children:Bn,clearReportState:Jn,confirmRedirect:In,createReport:ms,disabled:Es,editMode:Cs,existingReport:hs,getFormData:fa,isUpdated:oa,onSubmit:na,report:Bt,reportId:Wt,updateReport:_t,visitedSteps:sn,pageActions:Cn})=>{const Fn=(0,P.of)(We),$n=Z(Dt),ts=(0,L.Zp)(),Vn=(0,L.zy)(),Un=(0,O.useRef)(null),[ys,ws]=(0,O.useState)(!1);(0,O.useEffect)(()=>{(Ca=>{Ca===ps[ps.length-1].id?un(ps.map(Fa=>Fa.id)):un([Ca])})(Dt)},[Dt,un]),(0,O.useEffect)(()=>{ys&&ts(K.C1)},[ys,ts]);const As=Js=>{Js.preventDefault();const Ca=(0,C.Do)($n.id,Wt);na(),ts(Ca)},$s=async()=>{if(fa){const Ca=fa();Bt={...Bt,...Ca}}ws(!0),await(Bt.id?_t:ms)({...Bt,state:f.ReportState.Draft}),(0,s.rR)("reports_draft_saved",{step:Dt,state:Bt.id?Bt.state:"new"}),Jn()},Hs=()=>{Jn(),(0,s.rR)("reports_report_abandoned",{namePopulated:!!Bt.name,recipientsPopulated:!!Bt.recipients,replyToPopulated:!!Bt.replyTo,numberOfDashboardsSelected:Bt.dashboards.length,scheduleCustomized:(0,w.XO)(Bt.schedule)})},va=Js=>!ps.map(Fa=>(0,C.Do)(Fa.id,Wt)).includes(Js.pathname),Qs=()=>{const Js=ps[ps.length-1].id;Dt!==Js&&Un.current?.click()},Ps=()=>{const Js=new URLSearchParams(Vn.search),Ca=Js.get("db-uid");Ca?(Js.delete("db-uid"),Js.delete("db-name"),ts(`/d/${Ca}?${Js}`)):ts(K.C1)},Vs=(0,O.useMemo)(()=>(0,z.m)(Bt),[Bt]);return(0,x.jsxs)("form",{onSubmit:As,className:Fn.container,children:[Cs?(0,x.jsx)(ye,{disabled:Es}):(0,x.jsx)(Ve,{saveDraft:$s,existingReport:hs,ref:Un,activeStep:Dt,disabled:Es,onDiscard:Ps,schedule:Bt.schedule,children:Cn}),(0,x.jsx)(X.F,{confirmRedirect:!ys&&!!(In||oa),onDiscard:Hs,onLocationChange:va}),(0,x.jsxs)("div",{className:Fn.inner,children:[!Cs&&(0,x.jsx)(ee.C,{activeStep:Dt,onStepChange:Qs,getNextUrl:(0,C.s0)(Wt),visitedSteps:sn,steps:ps,validationResults:Vs}),(0,x.jsxs)("div",{className:Fn.content,children:[Bn,!Cs&&(0,x.jsx)(le,{ref:Un,activeStep:Dt,disabled:Es,reportId:Wt})]})]})]})},We=Dt=>({container:(0,v.css)`
      display: flex;
      flex-direction: column;
      height: 100%;
      align-content: center;
    `,inner:(0,v.css)`
      display: flex;
      justify-content: flex-start;
      flex-direction: column;
      flex: 1 0 auto;
    `,content:(0,v.css)`
      padding-bottom: ${Dt.spacing(3)};
      width: min(70%, 800px);
    `}),_e=Ae(we),at=Dt=>{const{report:un,isUpdated:Bn}=Dt.reports;return{report:un,isUpdated:Bn}},ut={createReport:W.LU,updateReport:W.A0,clearReportState:U.$J},ge=(0,I.connect)(at,ut)(({report:Dt,createReport:un,updateReport:Bn,clearReportState:Jn,isUpdated:In,reportId:ms})=>{const{formats:Es,options:Cs,schedule:hs,dashboards:fa}=Dt,{handleSubmit:oa,formState:{isSubmitSuccessful:na}}=(0,M.mN)(),Bt=(0,L.Zp)(),Wt=(0,P.of)(Ie),_t=!!ms&&!In,sn=(0,z.a)(Dt),{time:Cn,date:Fn}=(0,F.Th)(hs.startDate,hs.timeZone),{time:$n,date:ts}=(0,F.Th)(hs.endDate,hs.timeZone);(0,O.useEffect)(()=>{na&&Bt(K.C1)},[na,Bt]);const Vn=async()=>{const As=Dt.id?Bn:un;if(Dt.state===f.ReportState.Draft){const $s=Dt.schedule.frequency===f.SchedulingFrequency.Never?f.ReportState.Never:f.ReportState.Scheduled;Dt={...Dt,state:$s}}await As(Dt),(0,s.rR)("reports_report_submitted",{replyToPopulated:!!Dt.replyTo,includesDashboardLink:Dt.enableDashboardUrl,numberOfDashboardsSelected:Dt.dashboards.length,templateVariablesSelected:Dt.dashboards.some($s=>!!$s.reportVariables),orientation:Dt.options.orientation,layout:Dt.options.layout,frequency:Dt.schedule.frequency,sendTime:Dt.schedule.startDate?"later":"now",endDate:!!Dt.schedule.endDate}),Jn()},{orientation:Un,layout:ys}=U.ue.report.options,ws=[{title:"Select dashboard",id:f.StepKey.SelectDashboard,items:(fa||[]).flatMap((As,$s,Hs)=>[{title:`Source dashboard${$s===0?"*":""}`,value:As.dashboard?.uid?(0,x.jsx)(H,{name:As.dashboard.name,uid:As.dashboard?.uid,className:Wt.dashboardLink}):"",id:"name",required:!0},{title:"Template variables",value:(0,x.jsx)(ue,{variables:As.reportVariables,className:Wt.title})},{title:"Time range",value:(0,F.J5)(As.timeRange)},...Hs.length>1&&$s!==Hs.length-1?[{title:"",value:""}]:[]])},{title:"Format report",id:f.StepKey.FormatReport,items:[{title:"Preferred format*",value:V(Es),id:"formats",required:!0},...Es.includes(f.ReportFormat.PDF)?[{title:"PDF orientation",value:(0,S.capitalize)(Cs.orientation||Un)},{title:"PDF layout",value:(0,S.capitalize)(Cs.layout||ys)},{title:"Scale factor",value:(0,K.In)()[Dt.scaleFactor||K.Vb].label},{title:"PDF show template variables",value:Cs.pdfShowTemplateVariables?"Yes":"No"}]:[]]},{title:"Schedule",id:f.StepKey.Schedule,items:[{title:"Recurrence",value:(0,S.capitalize)(hs.frequency)},...hs.frequency===f.SchedulingFrequency.Custom?[{title:"Repeat every",value:`${hs.intervalAmount} ${hs.intervalFrequency}`}]:[],...hs.frequency!==f.SchedulingFrequency.Never?[{title:"Start date",value:Fn||"Now"},{title:"Start time",value:Cn||"Now"},{title:"End date",value:ts},{title:"End time",value:$n},{title:"Time zone",value:hs.timeZone?(0,A.t)(Date.now(),hs.timeZone):""}]:[],...(0,w.mM)(hs.frequency,hs.intervalFrequency)?[{title:"Send Monday to Friday only",value:hs.workdaysOnly?(0,x.jsx)(B.I,{name:"check",size:"xl"}):(0,x.jsx)(B.I,{name:"minus",size:"xl"})}]:[],{value:(0,w.OG)(Dt.schedule),title:""}]},{title:"Share",id:f.StepKey.Share,items:[{title:"Report name*",value:Dt.name,id:"name",required:!0},{title:"Recipients*",value:Dt.recipients,id:"recipients",required:!0},{title:"Reply-to-email",value:Dt.replyTo||"none"},{title:"Message",value:Dt.message||"none"},{title:"Dashboard link",value:Dt.enableDashboardUrl?"Yes":"No"}]}];return(0,x.jsx)(_e,{activeStep:f.StepKey.Confirm,confirmRedirect:!na&&In,disabled:sn,editMode:_t,onSubmit:oa(Vn),reportId:ms,children:(0,x.jsx)(j.n,{label:_t?"":"5. Confirm",children:ws.map(As=>{const $s=(0,z.a)(Dt,As.id);return(0,x.jsxs)("div",{className:Wt.section,children:[(0,x.jsxs)("div",{className:Wt.sectionHeader,children:[(0,x.jsx)("h5",{className:Wt.sectionTitle,children:As.title}),(0,x.jsx)(E.z9,{variant:$s?"primary":"secondary",fill:"text",href:(0,C.Do)(As.id,ms),size:"sm",children:"Edit"})]}),As.items.filter(Hs=>Hs.value!==void 0).map((Hs,va)=>{const Qs=!!Hs.required&&(!Hs.value||Array.isArray(Hs.value)&&!Hs.value.length);return Hs.title?(0,x.jsxs)("div",{className:Wt.row,children:[(0,x.jsxs)("div",{className:(0,v.cx)(Wt.title,Qs&&Wt.warning),children:[Hs.title,":"]}),(0,x.jsx)("div",{className:(0,v.cx)(Wt.value,Hs.value==="none"&&!Qs?Wt.textMuted:""),children:Qs?(0,x.jsx)(B.I,{name:"exclamation-triangle",className:Wt.warning}):Hs.value})]},va):(0,x.jsx)("div",{className:(0,v.cx)(Wt.row,Wt.textMuted),children:Hs.value},va)})]},As.title)})})})}),Ie=Dt=>({section:(0,v.css)`
      width: 100%;
      padding: ${Dt.spacing(3,0)};
      margin-bottom: ${Dt.spacing(3)};
    `,sectionHeader:(0,v.css)`
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: ${Dt.spacing(1)};
      border: 1px solid ${Dt.colors.border.weak};
    `,sectionTitle:(0,v.css)`
      margin: 0;
    `,row:(0,v.css)`
      border: 1px solid ${Dt.colors.border.weak};
      border-top: none;
      display: flex;
      width: 100%;
      padding: ${Dt.spacing(1)};
    `,warning:(0,v.css)`
      color: ${Dt.colors.warning.text};
    `,title:(0,v.css)`
      width: 30%;
      color: ${Dt.colors.text.secondary};
    `,textMuted:(0,v.css)`
      color: ${Dt.colors.text.secondary};
    `,value:(0,v.css)`
      width: 70%;
      word-break: break-word;
    `,dashboardLink:(0,v.css)`
      color: ${Dt.colors.text.primary};
      font-size: ${Dt.typography.body.fontSize};
      margin-top: 0;
    `}),ue=({variables:Dt,className:un})=>{const Bn=(0,P.of)(Ie);return!Dt||!Object.keys(Dt).length?(0,x.jsx)("span",{className:Bn.textMuted,children:"none"}):(0,x.jsx)(x.Fragment,{children:Object.entries(Dt).map(([Jn,In])=>(0,x.jsxs)("span",{children:[(0,x.jsx)("span",{className:un,children:Jn}),": ",In.join(", "),";"," "]},Jn))})};var me=e(76885),Pe=e(26272),Ne=e(67061),Fe=e(10880),Be=e(88575),he=e(94354),be=e(77014),Ke=e(10096),ze=e(13344),nt=e(87421),tt=e(42418);const ot=()=>(0,x.jsx)(tt.F,{severity:"warning",title:"Not supported",children:"The value All in template variables used in repeating rows or panels is not supported in PDF"});var gt=e(28707);const He=Ke.TP.hasPermission(f.AccessControlAction.ReportingWrite)||Ke.TP.hasPermission(f.AccessControlAction.ReportingCreate);var et=e(19149),rt=e(16629);const ht=Dt=>{const{isDownloadingCSV:un,report:Bn}=Dt.reports;return{report:Bn,isDownloadingCSV:un}},ft={updateReportProp:U.n0,downloadCSV:W.Bf},De=(0,I.connect)(ht,ft),Te=new Map([["grid","Display the panels in their positions on the dashboard."],["simple","Display one panel per row."]]),Oe=new Map([[f.ReportFormat.PDF,{description:"Attach the report as a PDF"}],[f.ReportFormat.PDFTablesAppendix,{description:"Include table data as PDF appendix",dependsOn:f.ReportFormat.PDF,hide:!g.Ay.featureToggles.pdfTables}],[f.ReportFormat.Image,{description:"Embed a dashboard image in the email"}],[f.ReportFormat.CSV,{description:"Attach a CSV file of table panel data"}],[f.ReportFormat.PDFTables,{description:"Attach a separate PDF of table data",hide:!g.Ay.featureToggles.pdfTables}]]),Ye=({report:Dt,updateReportProp:un,reportId:Bn,downloadCSV:Jn,isDownloadingCSV:In})=>{const ms=(0,P.of)(Ge),{dashboards:Es,formats:Cs,options:hs,name:fa,scaleFactor:oa=K.Vb}=Dt||{},{handleSubmit:na,control:Bt,register:Wt,watch:_t,getValues:sn,formState:{isDirty:Cn}}=(0,M.mN)({defaultValues:{formats:Cs,scaleFactor:oa,options:{layout:hs.layout,orientation:hs.orientation,timeRange:hs.timeRange,pdfShowTemplateVariables:hs.pdfShowTemplateVariables}}}),Fn=_t("options.layout"),$n=_t("options.orientation"),ts=_t("options.pdfShowTemplateVariables"),Vn=_t("formats"),Un=_t("scaleFactor"),ys=(0,et.D)(),ws=!(0,gt.b)(Dt.dashboards),As=(0,n.a)("reports.pdf")&&ws,$s=(0,O.useMemo)(()=>{const Ps=Dt.dashboards.flatMap(Js=>Js.dashboard?.uid?(0,nt.SS)(Js.dashboard.uid):[]);return(0,rt.T6)(ze.To,"query",Ps)&&Vn.includes(f.ReportFormat.PDF)},[Dt.dashboards,Vn]),Hs=({formats:Ps,options:Vs,scaleFactor:Js})=>{Cn&&un({...Dt,options:{...Dt.options,...Vs},formats:Ps,scaleFactor:Js})},va=()=>{const{formats:Ps,options:Vs,scaleFactor:Js}=sn();return{options:{...Dt.options,...Vs},formats:Ps,scaleFactor:Js}},Qs=()=>{if((0,gt.b)(Es))return;const Ps={title:fa,scaleFactor:Un};return $n&&(Ps.orientation=$n),Fn&&(Ps.layout=Fn),ts&&(Ps.pdfShowTemplateVariables=(!!ts).toString()),Vn&&Vn.includes(f.ReportFormat.PDFTablesAppendix)&&(Ps.includeTables="true"),Ps.dashboards=(0,C.U)(Es),me.kM.appendQueryToUrl("api/reports/render/pdfs/",me.kM.toUrlParams(Ps))};return(0,x.jsx)(_e,{activeStep:f.StepKey.FormatReport,onSubmit:na(Hs),confirmRedirect:Cn,getFormData:va,reportId:Bn,pageActions:[(0,x.jsx)(E.z9,{onClick:()=>As&&(0,s.rR)("reports_preview_pdf"),icon:"external-link-alt",href:Qs(),size:"xs",target:"_blank",rel:"noreferrer noopener",variant:"secondary",disabled:!As,children:"Preview PDF"},"preview"),(0,x.jsx)(E.$n,{onClick:()=>Jn(Dt.name,Es),icon:In?"spinner":"download-alt",variant:"secondary",disabled:!ws||In,tooltip:"Download table panel data as CSVs in a ZIP file",children:In?"Downloading...":"Download CSV"},"downloadCSV")],children:(0,x.jsxs)(j.n,{label:"2. Format report",disabled:!He,children:[$s&&(0,x.jsx)(ot,{}),(0,x.jsx)(j.n,{children:(0,x.jsx)(Ne.B,{direction:"column",alignItems:"start",children:[...Oe].map(([Ps,Vs])=>{const{onChange:Js,...Ca}=Wt("formats");return!Vs.hide&&(!Vs.dependsOn||Vn.includes(Vs.dependsOn))&&(0,O.createElement)(Fe.S,{...Ca,hidden:Vs.hide||Vs.dependsOn&&Vn.includes(Vs.dependsOn),key:Ps,htmlValue:Ps,label:Vs.description,className:(0,v.cx)(Vs.dependsOn&&ms.subCheckbox),"data-testid":ne.components.reportForm.formatCheckbox(Ps),onChange:Fa=>{Ps==="csv"&&Fa.currentTarget.checked&&ys!==null&&ys<3&&Ke.lE.emit(Pe.r1.alertError,["To export CSV files, you must update the Grafana Image Renderer plugin."]),Js(Fa)}})})})}),(Vn.includes(f.ReportFormat.PDF)||Vn.includes(f.ReportFormat.PDFTables))&&(0,x.jsxs)(j.n,{label:"Style the PDF",children:[g.Ay.featureToggles.newPDFRendering&&(0,x.jsx)(Be.D,{label:"Configure report header",children:(0,x.jsx)(Fe.S,{...Wt("options.pdfShowTemplateVariables"),label:"Show template variables"})}),(0,x.jsx)(Be.D,{label:"Orientation",children:(0,x.jsx)(M.xI,{name:"options.orientation",control:Bt,render:({field:{ref:Ps,...Vs}})=>(0,x.jsx)(he.z,{...Vs,options:f.reportOrientations,size:"md"})})}),(0,x.jsx)(Be.D,{label:"Layout",description:Te.get(Fn),children:(0,x.jsx)(M.xI,{name:"options.layout",control:Bt,render:({field:{ref:Ps,...Vs}})=>(0,x.jsx)(he.z,{...Vs,options:f.reportLayouts,size:"md"})})}),(0,x.jsx)(Be.D,{label:"Zoom",description:"Zoom in to enlarge text, or zoom out to see more data (like table columns) per panel.",className:ms.sliderField,children:(0,x.jsx)(M.xI,{name:"scaleFactor",control:Bt,render:({field:{ref:Ps,value:Vs,...Js}})=>(0,x.jsx)(be.A,{...Js,value:Number(Vs),min:1,max:3,step:1,marks:(0,K.In)(),included:!1})})})]})]})})},Ge=Dt=>({sliderField:(0,v.css)`
      max-width: 350px;
      // Hide Slider input
      input {
        display: none;
      }
    `,subCheckbox:(0,v.css)`
      margin-left: ${Dt.spacing(2)};
    `}),Je=De(Ye);var it=e(68316),St=e(47232),zt=e(10354),Kt=e(90182),Qt=e(98239),an=e(66070),Nn=e(20333);const zn=Dt=>{const{report:un}=Dt.reports;return{report:un}},Yn={updateReportProp:U.n0},ss=(0,I.connect)(zn,Yn),ds=[{label:"Once",value:f.SchedulingFrequency.Once},{label:"Hourly",value:f.SchedulingFrequency.Hourly},{label:"Daily",value:f.SchedulingFrequency.Daily},{label:"Weekly",value:f.SchedulingFrequency.Weekly},{label:"Monthly",value:f.SchedulingFrequency.Monthly},{label:"Custom",value:f.SchedulingFrequency.Custom},{label:"Never",value:f.SchedulingFrequency.Never}],Ms=[{label:"hours",value:f.IntervalFrequency.Hours},{label:"days",value:f.IntervalFrequency.Days},{label:"weeks",value:f.IntervalFrequency.Weeks},{label:"months",value:f.IntervalFrequency.Months}],Bs=Dt=>Dt==="now"&&(0,F.lB)((0,St.KQ)().toDate().getDate()),Zn=ss(({report:Dt,updateReportProp:un,reportId:Bn})=>{const{handleSubmit:Jn,control:In,watch:ms,register:Es,setValue:Cs,getValues:hs,formState:{isDirty:fa}}=(0,M.mN)(),{frequency:oa,timeZone:na,startDate:Bt,endDate:Wt,dayOfMonth:_t,intervalAmount:sn,intervalFrequency:Cn}=Dt.schedule,Fn=oa===f.SchedulingFrequency.Never?"":Bt,$n=Fn?"later":"now",ts={startDate:Fn,sendTime:$n,intervalFrequency:f.IntervalFrequency.Hours,intervalAmount:"2",sendOnLastDayOfMonth:_t===f.LAST_DAY_OF_MONTH,...Dt.schedule},Vn=ms("schedule",ts)||{},{frequency:Un,startDate:ys,endDate:ws,intervalFrequency:As=f.IntervalFrequency.Hours,dayOfMonth:$s,sendOnLastDayOfMonth:Hs,sendTime:va=$n,workdaysOnly:Qs}=Vn,Ps=(0,P.of)(Ls),Vs=new Date(ys),Js=ca=>{if(fa){const st=(0,w.A0)(ca.schedule);un({...Dt,schedule:st})}},Ca=()=>({schedule:(0,w.A0)(hs().schedule)}),Fa=ca=>{const st=Hs&&(0,it.c)(ca);Cs("schedule.sendOnLastDayOfMonth",st),Cs("schedule.dayOfMonth",st?f.LAST_DAY_OF_MONTH:"")},nr=ca=>{const st=(0,St.KQ)(ys).endOf("month").toDate();Cs("schedule.startDate",st),Cs("schedule.dayOfMonth",ca?f.LAST_DAY_OF_MONTH:"")};return(0,x.jsx)(_e,{activeStep:f.StepKey.Schedule,onSubmit:Jn(Js),confirmRedirect:fa,getFormData:Ca,reportId:Bn,children:(0,x.jsxs)(j.n,{label:"3. Schedule",children:[(0,x.jsx)(Be.D,{label:"Frequency",children:(0,x.jsx)(M.xI,{defaultValue:oa,name:"schedule.frequency",render:({field:{ref:ca,onChange:st,...bt}})=>(0,x.jsx)(he.z,{...bt,fullWidth:!0,options:ds,disabled:!He,onChange:Mt=>{(0,w.mM)(Mt,As)||Cs("schedule.workdaysOnly",!1),st(Mt)}}),control:In})}),Un!==f.SchedulingFrequency.Never&&(0,x.jsx)(Be.D,{label:"Time",children:(0,x.jsx)(M.xI,{control:In,name:"schedule.sendTime",defaultValue:$n,render:({field:{ref:ca,onChange:st,...bt}})=>(0,x.jsx)(he.z,{...bt,onChange:Mt=>{Mt!=="now"&&!ys?Cs("schedule.startDate",(0,St.KQ)().toDate()):Mt==="now"&&Cs("schedule.startDate",""),st(Mt)},options:[{label:"Send now",value:"now"},{label:"Send later",value:"later"}]})})}),(0,x.jsxs)(x.Fragment,{children:[Un===f.SchedulingFrequency.Custom&&(0,x.jsxs)(Ne.B,{children:[(0,x.jsx)(Be.D,{label:"Repeat every",children:(0,x.jsx)(zt.p,{type:"number",min:"2",...Es("schedule.intervalAmount"),placeholder:"e.g. 2",defaultValue:sn||2,id:"repeat-frequency"})}),(0,x.jsx)(Be.D,{label:" ",children:(0,x.jsx)(M.xI,{control:In,defaultValue:Ms.find(ca=>ca.value===Cn)?.value||f.IntervalFrequency.Hours,render:({field:{ref:ca,onChange:st,...bt}})=>(0,x.jsx)(Kt.l6,{...bt,onChange:Mt=>st(Mt.value),options:Ms,width:16,placeholder:"hours","aria-label":"Custom frequency"}),name:"schedule.intervalFrequency"})})]}),Un===f.SchedulingFrequency.Monthly&&(Bs(va)||va==="later")&&(0,x.jsx)(Be.D,{children:(0,x.jsx)(M.xI,{control:In,defaultValue:$s===f.LAST_DAY_OF_MONTH,render:({field:{onChange:ca,...st}})=>(0,x.jsx)(Fe.S,{...st,label:"Send on the last day of month",onChange:bt=>{nr(bt.currentTarget.checked),ca(bt.currentTarget.checked)}}),name:"schedule.sendOnLastDayOfMonth"})})]}),(0,x.jsx)("div",{className:va!=="now"&&Un!==f.SchedulingFrequency.Never?"":Ps.hidden,children:(0,x.jsxs)(Ne.B,{children:[(0,x.jsx)(Be.D,{label:"Start date",children:(0,x.jsx)(M.xI,{name:"schedule.startDate",control:In,defaultValue:(0,F.pp)(Fn),render:({field:{ref:ca,onChange:st,...bt}})=>(0,x.jsx)(Qt.l,{...bt,width:16,placeholder:"Select date","aria-label":"Report schedule start date",closeOnSelect:!0,onChange:Mt=>{const qt=new Date(Mt);Fa(qt),st(qt)}})})}),(0,x.jsx)(Be.D,{label:"Start time",children:(0,x.jsx)(M.xI,{name:"schedule.time",render:({field:{onChange:ca,ref:st,value:bt,...Mt}})=>(0,x.jsx)(an.R,{...Mt,value:bt,minuteStep:10,disabled:!He,onChange:qt=>{qt.isValid()&&ca({hour:qt.hour?.(),minute:qt.minute?.()})}}),defaultValue:(0,F.WB)(Bt),control:In})}),(0,x.jsx)(x.Fragment,{children:(0,x.jsx)(Be.D,{label:"Time zone",children:(0,x.jsx)(M.xI,{name:"schedule.timeZone",render:({field:{ref:ca,...st}})=>(0,x.jsx)(Nn.U,{...st,width:30,disabled:!He}),defaultValue:na||(0,U.Md)(),control:In})})})]})}),Un===f.SchedulingFrequency.Monthly&&!Hs&&((0,F.lB)(Vs.getDate())||Bs(va))&&(0,x.jsxs)("small",{className:Ps.warningText,children:["Note: some months do not have a"," ",(0,w.En)(Bs(va)?(0,St.KQ)().toDate().getDate():Vs.getDate())," day and reports will not be sent on those months. Choose an earlier date or"," ",(0,x.jsx)("strong",{children:'"Send on the last day of month"'})," to send a report at the end of each month."]}),![f.SchedulingFrequency.Once,f.SchedulingFrequency.Never].includes(Un)&&(0,x.jsxs)(Ne.B,{children:[(0,x.jsx)(Be.D,{label:"End date",children:(0,x.jsx)(M.xI,{name:"schedule.endDate",control:In,defaultValue:(0,F.pp)(Wt),render:({field:{ref:ca,...st}})=>(0,x.jsx)(Qt.l,{...st,width:16,placeholder:"Does not end","aria-label":"Report schedule end date",minDate:new Date(ys),closeOnSelect:!0})})}),ws&&(Un===f.SchedulingFrequency.Hourly||(0,w.hv)(Un,As))&&(0,x.jsx)(Be.D,{label:"End time",children:(0,x.jsx)(M.xI,{name:"schedule.endTime",render:({field:{onChange:ca,ref:st,value:bt,...Mt}})=>(0,x.jsx)(an.R,{...Mt,value:bt,minuteStep:10,disabled:!He,onChange:qt=>{qt?.isValid()&&ca({hour:qt.hour?.(),minute:qt.minute?.()})}}),defaultValue:(0,F.WB)(Wt),control:In})})]}),(0,w.mM)(Un,As)&&(0,x.jsx)(Be.D,{children:(0,x.jsx)(Fe.S,{...Es("schedule.workdaysOnly"),label:"Send Monday to Friday only",defaultChecked:Qs})}),(0,x.jsxs)(Ne.B,{alignItems:"center",children:[(0,x.jsx)(B.I,{name:"calendar-alt"}),(0,w.OG)({...ts,...Vn})]})]})})}),Ls=Dt=>({warningText:(0,v.css)`
      color: ${Dt.colors.warning.main};
      display: block;
      margin: -${Dt.spacing(1)} 0 ${Dt.spacing(3)} 0;
    `,hidden:(0,v.css)`
      display: none;
    `});var Ln=e(12470),Hn=e(92041),Qn=e(14186),mt=e(54230),Yt=e(59429),on=e(20601),ln=e(24240),fn=e(72401),yn=e(51475);const wn=Dt=>{const{report:un}=Dt.reports;return{report:un,templating:Dt.templating.keys}},Xn={updateReportProp:U.n0,initVariables:W.U1,cleanUpVariables:fn._m},xn=(0,I.connect)(wn,Xn),Ut={dashboard:void 0,timeRange:{from:"",to:"",raw:{from:"",to:""}},reportVariables:{}},nn=({report:Dt,reportId:un,updateReportProp:Bn,initVariables:Jn,cleanUpVariables:In})=>{const{handleSubmit:ms,control:Es,formState:{isDirty:Cs},setValue:hs,getValues:fa,watch:oa}=(0,M.mN)({defaultValues:{dashboards:Dt.dashboards||[Ut]}}),{fields:na,append:Bt,remove:Wt}=(0,M.jz)({control:Es,name:"dashboards",keyName:"fieldId"}),_t=oa("dashboards"),sn=(0,P.of)(es);(0,O.useEffect)(()=>{const Vn=(0,C.y3)();if(Vn){const{dashboard:Un,variables:ys,timeRange:ws}=Vn;ys&&Un.uid&&Jn(Un.uid,ys,ws),Un.uid&&(hs("dashboards.0.dashboard",Un,{shouldDirty:!0}),ws&&hs("dashboards.0.timeRange",{...ws,raw:ws},{shouldDirty:!0}))}},[Jn,Dt,hs]);const Cn=Vn=>(Un,ys)=>{hs(`dashboards.${Vn}.timeRange`,{from:"",to:""});const ws=fa().dashboards?.map(({dashboard:$s})=>$s);if(!Un){if(!ys)return;ws.some(Hs=>Hs?.uid===ys)||In(ys);return}const As=ws.filter($s=>$s?.uid===Un.uid).length>1;if(Un.uid&&!As){const $s=Dt.dashboards?.[Vn],Hs=Un.uid===$s?.dashboard?.uid?$s?.reportVariables:void 0;Jn(Un.uid,Hs)}},Fn=Vn=>{const Un=$n(Vn.dashboards);Cs&&Bn({...Dt,dashboards:Un})},$n=Vn=>{const Un=Vn?.filter(({dashboard:ys})=>ys?.uid).map(({dashboard:ys,timeRange:ws})=>{const As=ys?.uid;return{dashboard:As?{uid:As,name:ys?.name}:void 0,timeRange:(0,yn.R)(ws?.raw),reportVariables:As?(0,rt.Z5)((0,nt.SS)(As).filter($s=>$s.hide!==Ln.zL.hideVariable)):void 0}});return Un?.length?Un:[Ut]},ts=()=>({dashboards:$n(fa().dashboards)});return(0,x.jsx)(_e,{activeStep:f.StepKey.SelectDashboard,onSubmit:ms(Fn),confirmRedirect:Cs,getFormData:ts,reportId:un,children:(0,x.jsx)(j.n,{label:"1. Select dashboard",children:(0,x.jsxs)(x.Fragment,{children:[na.map((Vn,Un)=>{const ys=_t[Un].dashboard?.uid||"",ws=_t[Un]?.reportVariables,As=ys?(0,nt.SS)(ys):[],$s=Hs=>{(0,rt.zp)(As)&&Jn(ys,ws,Hs)};return(0,x.jsxs)("div",{className:(0,v.cx)(sn.section,_t.length>1&&sn.sectionBorder),children:[(0,x.jsx)(hn,{field:Vn,dashboardUid:ys,onDashboardChange:Cn(Un),variables:As,control:Es,index:Un,setValue:hs,selectedDashboards:_t,onTimeRangeChange:$s,dataTestId:ne.components.reportForm.selectDashboard(Un.toString())}),na.length>1&&(0,x.jsx)(E.$n,{className:sn.removeBtn,variant:"secondary",fill:"outline",icon:"trash-alt",onClick:()=>Wt(Un),children:"Remove dashboard"})]},Vn.fieldId)}),(0,x.jsx)(E.$n,{type:"button",variant:"secondary",onClick:()=>Bt(Ut),children:"+ Add another dashboard"})]})})})},hn=({field:Dt,index:un,onDashboardChange:Bn,variables:Jn,control:In,dashboardUid:ms,setValue:Es,onTimeRangeChange:Cs,selectedDashboards:hs=[],dataTestId:fa})=>{const oa=(0,yn.e)(Dt.timeRange),na=Jn.filter(Cn=>Cn.hide!==Ln.zL.hideVariable),Bt=ms!==void 0&&!!na.length,Wt=hs.filter(({dashboard:Cn})=>Cn?.uid===ms).length>1,_t=hs.findIndex(({dashboard:Cn})=>Cn?.uid===ms),sn=Wt&&_t!==un;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(Be.D,{label:"Source dashboard",required:!0,children:(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(M.xI,{name:`dashboards.${un}.dashboard`,control:In,render:({field:{onChange:Cn,ref:Fn,value:$n,...ts}})=>(0,x.jsx)(Yt.b,{...ts,id:`dashboard-${un}`,"data-testid":fa,"aria-label":"Source dashboard",isClearable:!0,value:$n?.uid,disabled:!He,onChange:Vn=>{Cn({...Vn,name:Vn?.title}),Bn(Vn,ms)}})}),(0,x.jsx)(H,{uid:ms})]})}),Bt&&(0,x.jsx)(Be.D,{label:"Template variables",description:sn&&`When adding the same dashboard multiple times in one report, template variables that you selected first
are applied to all instances of that dashboard in the report.`,children:sn?(0,x.jsx)(x.Fragment,{}):(0,x.jsx)(x.Fragment,{children:na.map(Cn=>{const{picker:Fn,setValue:$n}=on.B.get(Cn.type);return(0,x.jsx)(Qn.I,{label:Cn.name,labelWidth:16,disabled:!He,children:(0,x.jsx)(Fn,{variable:Cn,readOnly:!1,onVariableChange:ts=>{(0,ln.SP)(ts)&&!(0,Hn.R)(ts.current)&&($n(ts,ts.current),Es(`dashboards.${un}.reportVariables`,(0,rt.Z5)([ts]),{shouldDirty:!0}))}})},Cn.name)})})}),(0,x.jsx)(Be.D,{label:"Time range",description:"Generate report with the data from specified time range. If custom time range is empty the time range from the report's dashboard is used.",disabled:!He,children:(0,x.jsx)(M.xI,{control:In,name:`dashboards.${un}.timeRange`,defaultValue:oa,render:({field:{ref:Cn,value:Fn,onChange:$n,...ts}})=>(0,x.jsx)(mt.b,{...ts,value:Sn(Fn,oa),onChange:Vn=>{$n(Vn),Cs(Vn.raw)},clearable:!0})})})]})},dn=xn(nn),Sn=(Dt,un)=>Dt?Dt.raw?Dt:{...Dt,raw:Dt}:un,es=Dt=>({removeBtn:(0,v.css)`
      margin-bottom: ${Dt.spacing(2)};
    `,section:(0,v.css)`
      padding-bottom: ${Dt.spacing(2)};
    `,sectionBorder:(0,v.css)`
      &:not(:last-of-type) {
        border-bottom: 1px solid ${Dt.colors.border.weak};
        margin-bottom: ${Dt.spacing(3)};
      }
    `,infoText:(0,v.css)`
      color: ${Dt.colors.text.secondary};
      font-size: ${Dt.typography.size.sm};
      font-weight: ${Dt.typography.fontWeightRegular};
    `});var Pt=e(71678),Ze=e(79924),lt=e(21744),yt=e(53885),Nt=e(37390),wt=e(3911);const Zt=({onDismiss:Dt,onSendTestEmail:un,emails:Bn})=>{const Jn=(0,P.DP)(),In=pn(Jn),[ms,Es]=(0,O.useState)(""),[Cs,hs]=(0,O.useState)(""),[fa,oa]=(0,O.useState)(!1),[na,Bt]=(0,O.useState)(!1),Wt=$n=>{const{checked:ts}=$n.target;Bt(ts),ts?(Es(Bn),sn(Bn)):(Cn(),Es(""))},_t=$n=>{Es($n.currentTarget.value),oa(!1)},sn=$n=>(0,yt.K7)($n)?(Cn(),!0):(oa(!0),hs("Invalid email"),!1),Cn=()=>{oa(!1),hs("")},Fn=()=>{sn(ms),sn(ms)&&(un(ms,na),Dt())};return(0,x.jsx)(Nt.a,{className:In.modal,isOpen:!0,title:"Send test email",icon:"share-alt",onDismiss:Dt,children:(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:In.content,children:[(0,x.jsx)(Be.D,{label:"Email",disabled:na,invalid:fa,error:Cs,children:(0,x.jsx)(zt.p,{disabled:na,name:"email",placeholder:"your.address@company.com",type:"email",value:ms,onChange:_t})}),(0,x.jsx)(Fe.S,{value:na,label:"Use emails from report",onChange:Wt,"data-testid":ne.components.reportForm.useRecipientsCheckbox})]}),(0,x.jsxs)(Nt.a.ButtonRow,{children:[(0,x.jsx)(E.$n,{variant:"secondary",onClick:Dt,fill:"outline",children:"Cancel"}),(0,x.jsx)(E.$n,{variant:"primary",onClick:Fn,"data-testid":ne.components.reportForm.sendTestEmailConfirmButton,children:"Send"})]})]})})},pn=(0,wt.N)(Dt=>({modal:(0,v.css)`
      width: 500px;
    `,content:(0,v.css)`
      margin-bottom: ${Dt.spacing.lg};
    `})),On=Dt=>{const{testEmailIsSending:un,report:Bn}=Dt.reports;return{report:Bn,testEmailIsSending:un}},An={updateReportProp:U.n0,sendTestEmail:W.FI},qn=(0,I.connect)(On,An),cs=({report:Dt,reportId:un,updateReportProp:Bn,sendTestEmail:Jn,testEmailIsSending:In})=>{const{message:ms,name:Es,recipients:Cs,replyTo:hs,enableDashboardUrl:fa,dashboards:oa}=Dt,{handleSubmit:na,control:Bt,register:Wt,setError:_t,clearErrors:sn,watch:Cn,getValues:Fn,formState:{errors:$n,isDirty:ts}}=(0,M.mN)({mode:"onBlur"}),Vn=(0,P.of)(Os),Un=Ke.TP.hasPermission(f.AccessControlAction.ReportingSend),ys=Cn("name",Es),ws=Cn("recipients",Cs),As=!Un||!(0,n.a)("reports.email")||!ys||!ws||(0,gt.b)(oa),$s=(Qs,Ps)=>{const Vs={...Dt,...Fn()},Js=Ps?Vs.recipients:Qs;return Jn({...Vs,recipients:Js})},Hs=Qs=>{if(ts){const{name:Ps}=Qs;Bn({...Dt,...Qs,name:Ps.trim()})}},va=()=>{const Qs=Fn(),{name:Ps}=Qs;return{...Qs,name:Ps.trim()}};return(0,x.jsxs)(_e,{activeStep:f.StepKey.Share,onSubmit:na(Hs),confirmRedirect:ts,getFormData:va,reportId:un,pageActions:[(0,x.jsx)(Pt.$s,{children:({showModal:Qs,hideModal:Ps})=>(0,x.jsx)(E.$n,{disabled:As,size:"xs",variant:"secondary","data-testid":ne.components.reportForm.sendTestEmailButton,onClick:Vs=>{Vs.preventDefault(),Qs(Zt,{onDismiss:Ps,onSendTestEmail:$s,emails:ws})},children:"Send test email"})},"send-test-email")],children:[In&&(0,x.jsx)("div",{className:"page-alert-list",children:(0,x.jsx)(tt.F,{title:"Sending test email...",severity:"info",elevated:!0})}),(0,x.jsxs)(j.n,{label:"4. Share",disabled:!He,children:[(0,x.jsx)(Be.D,{label:"Report name",required:!0,invalid:!!$n.name,error:"Name is required",children:(0,x.jsx)(zt.p,{...Wt("name"),type:"text",id:"name",defaultValue:Es,placeholder:"System status report","data-testid":ne.components.reportForm.nameInput})}),(0,x.jsx)(Be.D,{className:Vn.field,label:"Recipients",required:!0,invalid:!!$n.recipients,error:$n.recipients?.message,description:"Separate multiple emails with a comma or semicolon.",children:(0,x.jsx)(M.xI,{name:"recipients",control:Bt,defaultValue:Cs,render:({field:{ref:Qs,value:Ps,onChange:Vs,...Js}})=>(0,x.jsx)(Ze.u,{...Js,id:"recipients",disabled:!He,invalid:!!$n.recipients,onChange:Ca=>{const Fa=Ca.join(";").split(yt.mF).filter(Boolean).map(ca=>ca.trim()),nr=Fa.filter(ca=>!(0,yt.xf)(ca));nr.length?_t("recipients",{type:"manual",message:`Invalid email${nr.length>1?"s":""}: ${nr.join("; ")}`}):sn("recipients"),Vs(Fa.filter(ca=>(0,yt.xf)(ca)).join(";"))},placeholder:"Type in the recipients email addresses and press Enter",tags:Ps?Ps.split(yt.mF):[],className:Vn.tagsInput,addOnBlur:!0}),rules:{validate:Qs=>(0,yt.K7)(Qs)||"Invalid email"}})}),(0,x.jsx)(Be.D,{invalid:!!$n.replyTo,error:$n.replyTo?.message,className:Vn.field,label:"Reply-to email address",description:"The address that will appear in the Reply to field of the email",children:(0,x.jsx)(zt.p,{...Wt("replyTo",{validate:Qs=>(0,yt.K7)(Qs)||"Invalid email"}),id:"replyTo",placeholder:"your.address@company.com - optional",type:"email",defaultValue:hs})}),(0,x.jsx)(Be.D,{className:Vn.field,label:"Message",children:(0,x.jsx)(lt.f,{...Wt("message"),id:"message",placeholder:ms,rows:10,defaultValue:ms})}),(0,x.jsx)(Be.D,{className:Vn.field,children:(0,x.jsx)(Fe.S,{...Wt("enableDashboardUrl"),defaultChecked:fa,label:"Include a dashboard link"})})]})]})},Os=Dt=>({field:(0,v.css)`
      &:not(:last-of-type) {
        margin-bottom: ${Dt.spacing(3)};
      }
    `,tagsInput:(0,v.css)`
      li {
        margin-bottom: ${Dt.spacing(1)};
        background-color: ${Dt.colors.background.secondary} !important;
        border-color: ${Dt.components.input.borderColor} !important;
        color: ${Dt.colors.text.primary};
      }
    `}),xs=qn(cs);var zs=e(19065),Ks=e(36149),ma=e(48614),la=e(38496),Ua=e(43112),Ra=e(48542);const Pa=(Dt=window.location.origin)=>{let un=Dt+N.$.appSubUrl;return un.endsWith("/")&&un.slice(0,-1),un},wa=(Dt,un,Bn,Jn,In)=>{let ms=`${Pa()}/api/reports/render/pdfs`;const Es={orientation:Dt,layout:un,scaleFactor:Bn},Cs={dashboard:{uid:Jn}};Object.keys(In).length!==0&&(Cs.reportVariables=In);const hs=(0,C.KM)();return hs&&(Cs.timeRange=hs),Es.dashboards=JSON.stringify([Cs]),ms=me.kM.appendQueryToUrl(ms,me.kM.toUrlParams(Es)),ms},Ea=ne.components.ExportAsPdf,Za={landscapegrid:ma,landscapesimple:la,portraitgrid:Ua,portraitsimple:Ra},Na=({displayQueryVariablesAlert:Dt,onDismiss:un,variables:Bn,dashboardUid:Jn})=>{const[In,ms]=(0,O.useState)("landscape"),[Es,Cs]=(0,O.useState)("grid"),[hs,fa]=(0,O.useState)(K.Vb),oa=(0,P.of)(cr),na=Za[`${In}${Es}`],Bt=wa(In,Es,hs,Jn,Bn);function Wt(){(0,s.rR)("dashboards_sharing_pdf_save_clicked",{orientation:In,layout:Es,scaleFactor:hs})}return N.$.rendererAvailable?(0,n.a)("reports.pdf")?(0,x.jsxs)("div",{"data-testid":Ea.container,children:[Dt&&(0,x.jsx)(ot,{}),(0,x.jsx)("p",{className:"share-modal-info-text",children:(0,x.jsx)(i.x6,{i18nKey:"export.pdf.info-text",children:"Export the dashboard as a PDF document"})}),(0,x.jsx)(Be.D,{label:(0,i.t)("export.pdf.orientation-label","Orientation"),"data-testid":Ea.orientationButton,children:(0,x.jsx)(he.z,{options:f.reportOrientations,value:In,onChange:ms})}),(0,x.jsx)(Be.D,{label:(0,i.t)("export.pdf.layout-label","Layout"),"data-testid":Ea.layoutButton,children:(0,x.jsx)(he.z,{options:f.reportLayouts,value:Es,onChange:Cs})}),(0,x.jsx)(Be.D,{label:(0,i.t)("export.pdf.zoom-label","Zoom"),description:(0,i.t)("export.pdf.zoom-description","Zoom in to enlarge text, or zoom out to see more data (like table columns) per panel."),className:oa.zoomSlider,"data-testid":Ea.zoomSlider,children:(0,x.jsx)(be.A,{value:hs,min:1,max:3,step:1,marks:(0,K.In)(),onChange:fa,included:!1})}),N.$.featureToggles.newDashboardSharingComponent?(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:oa.imageContainer,children:(0,x.jsx)("img",{"data-testid":Ea.previewImage,src:na,alt:(0,i.t)("export.pdf.image-alt","PDF preview")})}),(0,x.jsx)("div",{className:oa.container,children:(0,x.jsxs)(Ne.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,x.jsx)(E.z9,{"data-testid":Ea.generatePdfButton,variant:"primary",href:Bt,target:"_blank",rel:"noreferrer noopener",icon:"external-link-alt",onClick:Wt,children:(0,x.jsx)(i.x6,{i18nKey:"export.pdf.download-button",children:"Generate PDF"})}),(0,x.jsx)(E.$n,{"data-testid":Ea.cancelButton,variant:"secondary",onClick:un,children:(0,x.jsx)(i.x6,{i18nKey:"export.pdf.cancel-button",children:"Cancel"})})]})})]}):(0,x.jsxs)(Nt.a.ButtonRow,{children:[(0,x.jsx)(E.$n,{"data-testid":Ea.modalCancelButton,variant:"secondary",onClick:un,children:"Cancel"}),(0,x.jsx)(E.z9,{"data-testid":Ea.saveAsPdfButton,variant:"primary",href:Bt,target:"_blank",rel:"noreferrer noopener",onClick:Wt,children:"Save as PDF"})]})]}):(0,x.jsx)(Ks.o,{message:`Rendering a dashboard as a PDF document is not available with your current license.
            To enable this feature, update your license.`}):(0,x.jsx)(zs.c,{"data-testid":Ea.noRendererInfoBox})},gr=({dashboard:Dt,onDismiss:un})=>{const Bn=(0,O.useMemo)(()=>{const In=(0,W.Yx)(Dt.panels),ms=(0,nt.SS)(Dt.uid),Es=(0,rt.IU)(ze.To,"query",ms);return Es&&In.has(Es.name)},[Dt]),Jn=(0,O.useMemo)(()=>{const In=(0,nt.SS)(Dt.uid);return(0,rt.Z5)(In)},[Dt.uid]);return(0,x.jsx)(Na,{displayQueryVariablesAlert:Bn,onDismiss:un,variables:Jn,dashboardUid:Dt.uid})};function cr(Dt){return{container:(0,v.css)({padding:`${Dt.spacing(2)} 0`}),imageContainer:(0,v.css)({display:"flex",height:320,maxWidth:"100%",padding:Dt.spacing(2),margin:"auto",justifyContent:"center"}),zoomSlider:(0,v.css)({maxWidth:350,input:{display:"none"}})}}var Ha=e(84537),$a=e(74730);class Xa extends Ha.Bs{constructor(){super(...arguments),this.tabId=h.wr.report}static{this.Component=_a}getTabLabel(){return N.$.featureToggles.newDashboardSharingComponent?(0,i.t)("share-dashboard.menu.schedule-report-title","Schedule report"):"Report"}}function _a({model:Dt}){const{modalRef:un}=Dt.useState(),Bn=(0,$a.YQ)(Dt);return(0,x.jsx)(b,{dashboard:Bn,onDismiss:()=>{un?.resolve()?.onDismiss()}})}var vt=e(76412);class kt extends Ha.Bs{constructor(){super(...arguments),this.tabId=h.wr.pdf}static{this.Component=cn}getTabLabel(){return N.$.featureToggles.newDashboardSharingComponent?(0,vt.t)("export.pdf.title","Export dashboard PDF"):"PDF"}}function cn({model:Dt}){const{modalRef:un,onDismiss:Bn}=Dt.useState(),Jn=(0,$a.YQ)(Dt),In=(0,O.useMemo)(()=>{const ms=Ha.jh.getVariables(Jn).state.variables;return(0,rt.$w)(ms)},[Jn]);return(0,x.jsx)(Na,{onDismiss:()=>{un?un.resolve().onDismiss():Bn?.()},displayQueryVariablesAlert:!1,variables:In,dashboardUid:Jn.state.uid})}const vn=g.$W.featureToggles.featureHighlights,Pn=ne.components.NewShareButton.Menu,Kn={label:"PDF",value:h.wr.pdf,component:gr},us={label:"Report",value:h.wr.report,tabSuffix:vn&&!(0,n.a)("reports.creation")||(0,d.z5)()?()=>(0,r.J)({experimentId:(0,y.L)("reporting-tab-badge")}):void 0,component:b};function Gn(){if(!g.$W.reporting?.enabled)return;const Dt=In=>{if((0,n.a)("reports.creation")&&!(0,d.z5)()){(0,s.rR)("dashboards_sharing_report_create_clicked");const Es=t.I.stripBaseFromUrl(`${g.$W.appUrl}${(0,C.A2)(In)}`);a.Ny.push(Es)}else a.Ny.partial({shareView:h.wr.report})},un=()=>{a.Ny.partial({shareView:h.wr.pdf})},Bn={shareId:h.wr.report,testId:Pn.scheduleReport,icon:"clock-nine",label:(0,i.t)("share-dashboard.menu.schedule-report-title","Schedule report"),renderCondition:!0,onClick:Dt},Jn={shareId:h.wr.pdf,testId:"data-testid new export button export as pdf",icon:"file-alt",label:(0,i.t)("share-dashboard.menu.export-pdf-title","Export as PDF"),renderCondition:!0,onClick:un};(0,n.a)("reports.creation")?((0,c.addDashboardShareTab)(Kn),(0,p.m)(kt),(0,o.i)(Jn),(0,u.K)({id:h.wr.pdf,shareOption:kt}),l.TP.hasPermission(f.AccessControlAction.ReportingCreate)&&((0,c.addDashboardShareTab)(us),(0,p.m)(Xa),(0,u.K)({id:h.wr.report,shareOption:Xa}),(0,m.Hl)(Bn))):vn&&((0,c.addDashboardShareTab)(us),(0,p.m)(Xa),(0,m.Hl)(Bn))}const ps=[{id:f.StepKey.SelectDashboard,name:"Select dashboard",component:dn},{id:f.StepKey.FormatReport,name:"Format report",component:Je},{id:f.StepKey.Schedule,name:"Schedule",component:Zn},{id:f.StepKey.Share,name:"Share",component:xs},{id:f.StepKey.Confirm,name:"Confirm",component:ge}]},24631:(G,R,e)=>{"use strict";e.d(R,{A0:()=>T,Bf:()=>S,FI:()=>D,LU:()=>b,N1:()=>E,Q4:()=>x,U1:()=>v,Yx:()=>P,y8:()=>C});var t=e(4213),n=e.n(t),s=e(75505),a=e(26272),r=e(76885),g=e(17172),i=e(3591),l=e(28676),d=e(74856),c=e(34214),h=e(72401),o=e(28707),m=e(47071),u=e(40981),p=e(16629),f=e(4179);const y="api/reports";function x(){return async O=>{const M=await(0,g.AI)().get(y);O((0,f.JQ)(M))}}function v(O,M,I){return async L=>{const B=await(0,l.n)().getDashboardDTO(O),j=new c.G(B.dashboard,B.meta),A=P(j.panels);if((0,p.zp)(j.templating.list)){const W=(0,m.Uz)(I)?j?.time:I;(0,d.jG)().setTime(W)}const K=(0,p.lo)(j.templating.list,M||(0,p.Z5)(j.templating.list),A);await L((0,h._q)(B.dashboard.uid,{...j,templating:{list:K}})),L((0,f.Lm)(O))}}function P(O,M=new Set){return O.forEach(I=>{I.repeat&&M.add(I.repeat),I.panels&&P(I.panels,M)}),M}function E(O){return async M=>{M((0,f.qJ)());try{const I=await(0,g.AI)().get(`${y}/${O}`);I.dashboards||(I.dashboards=[{dashboard:{uid:I.dashboardUid,id:I.dashboardId,name:I.dashboardName},reportVariables:I.templateVars,timeRange:I.options.timeRange}]);for(const L of I.dashboards)L.dashboard.uid&&await M(v(L.dashboard.uid,L.reportVariables,L.timeRange));M((0,f.Yk)(I))}catch{M((0,f.et)())}}}function D(O){return M=>(M((0,f.an)()),(0,g.AI)().post(`${y}/test-email/`,O).finally(()=>M((0,f.Zl)())))}function C(O){return async M=>{await(0,g.AI)().delete(`${y}/${O}`),M(x())}}function b(O){return async()=>{try{await(0,g.AI)().post(y,O)}catch(M){throw M}}}function T(O,M){return async I=>{const L=["hour","minute","day"];O={...O,schedule:Object.fromEntries(Object.entries(O.schedule).filter(([B,j])=>!L.includes(B)))},await(0,g.AI)().put(`${y}/${O.id}`,O),M&&I(x())}}function S(O,M){return async I=>{if((0,o.b)(M)){(0,i.J7)().publish({type:a.r1.alertError.name,payload:["Invalid dashboards"]});return}const L={title:O};L.dashboards=(0,u.U)(M);const B=r.kM.appendQueryToUrl(`${y}/render/csvs/`,r.kM.toUrlParams(L));try{I((0,f.Q7)());const j=await(0,s.s)((0,g.AI)().fetch({url:B,method:"GET",responseType:"blob"}));if(j.status===204){(0,i.J7)().publish({type:a.r1.alertWarning.name,payload:["The report does not contain any dashboard with a table panel"]});return}const A=new Blob([j.data],{type:"application/zip"});(0,t.saveAs)(A,`${O||"report-csv"}.zip`),(0,i.J7)().publish({type:a.r1.alertSuccess.name,payload:["CSV downloaded"]})}catch{(0,i.J7)().publish({type:a.r1.alertError.name,payload:["There was an error downloading the CSV"]})}finally{I((0,f.kH)())}}}},4179:(G,R,e)=>{"use strict";e.d(R,{$J:()=>c,Ay:()=>C,JQ:()=>o,Lm:()=>x,Md:()=>r,Q7:()=>P,Yk:()=>h,Zl:()=>y,an:()=>f,et:()=>p,kH:()=>E,n0:()=>m,qJ:()=>u,ue:()=>l,uq:()=>g,wj:()=>v});var t=e(65307),n=e(75096),s=e(13680),a=e(78011);const r=()=>{if(!window.Intl)return"";const b=window.Intl.DateTimeFormat();if(!b.resolvedOptions)return"";const T=b.resolvedOptions();return T.timeZone?T.timeZone:""},g={from:"",to:"",raw:{from:"",to:""}},i={id:0,name:"",recipients:"",replyTo:"",message:`Hi, 
Please find attached a PDF status report. If you have any questions, feel free to contact me!
Best,`,dashboardId:void 0,dashboardName:"",dashboards:[{dashboard:void 0,timeRange:g.raw}],schedule:{frequency:s.SchedulingFrequency.Weekly,timeZone:r()},formats:[s.ReportFormat.PDF],scaleFactor:a.Vb,options:{orientation:"landscape",layout:"grid",timeRange:g.raw,pdfShowTemplateVariables:!1},enableDashboardUrl:!0,state:s.ReportState.Scheduled},l={reports:[],report:i,hasFetchedList:!1,hasFetchedSingle:!1,searchQuery:"",reportCount:0,isLoading:!0,isUpdated:!1,visitedSteps:[],settings:{branding:{reportLogoUrl:"",emailLogoUrl:"",emailFooterMode:s.FooterMode.SentBy,emailFooterText:"",emailFooterLink:""}}},d=(0,t.Z0)({name:"reports",initialState:l,reducers:{reportsLoaded:(b,T)=>({...b,reports:T.payload,reportCount:T.payload.length,hasFetchedList:!0}),reportLoaded:(b,T)=>({...b,report:T.payload,hasFetchedSingle:!0,isLoading:!1}),updateReportProp:(b,T)=>({...b,isUpdated:!0,report:T.payload}),clearReportState:b=>({...b,isUpdated:!1,visitedSteps:[],report:i}),reportLoadingBegin:b=>({...b,isLoading:!0}),reportLoadingEnd:b=>({...b,isLoading:!1}),testEmailSendBegin:b=>({...b,testEmailIsSending:!0}),testEmailSendEnd:b=>({...b,testEmailIsSending:!1}),setLastUid:(b,T)=>({...b,lastUid:(0,n.q4)(T.payload)}),addVisitedStep:(b,T)=>({...b,visitedSteps:[...b.visitedSteps,...T.payload]}),downloadCSVBegin:b=>({...b,isDownloadingCSV:!0}),downloadCSVEnd:b=>({...b,isDownloadingCSV:!1})}}),{clearReportState:c,reportLoaded:h,reportsLoaded:o,updateReportProp:m,reportLoadingBegin:u,reportLoadingEnd:p,testEmailSendBegin:f,testEmailSendEnd:y,setLastUid:x,addVisitedStep:v,downloadCSVBegin:P,downloadCSVEnd:E}=d.actions,C={reports:d.reducer}},28707:(G,R,e)=>{"use strict";e.d(R,{b:()=>t});const t=n=>n?.length?!n.some(s=>!!s.dashboard?.uid):!0},47071:(G,R,e)=>{"use strict";e.d(R,{J5:()=>h,JO:()=>a,Th:()=>c,Uz:()=>o,WB:()=>l,Zf:()=>i,lB:()=>m,pp:()=>g});var t=e(47232),n=e(72724),s=e(65879);const a=(u,p={hour:0,minute:0},f)=>{const y=`${p.hour}:${p.minute}:00`,x=typeof u=="string"?g(u):u,v=new Date(`${(0,t.KQ)(x).format("YYYY/MM/DD")} ${y}`),P=(0,n.LE)(v.getTime(),{timeZone:f,format:"Z"});return r((0,t.KQ)(v).format())+P},r=u=>u.includes("Z")?u.replace("Z",""):u.slice(0,-6),g=u=>u?(0,t.KQ)(u.split("T")[0]).toDate():"",i=u=>String(u).length===1?`0${u}`:String(u),l=u=>{if(!u)return{hour:0,minute:0};const p=u.match(/T(\d+):(\d+)/);if(p){const[,f,y]=p;return{hour:parseInt(f,10),minute:parseInt(y,10)}}return{hour:0,minute:0}},d=u=>u?dateTime(u).isBefore(dateTime()):!1,c=(u,p)=>{if(!u)return{time:void 0,date:void 0};const{hour:f,minute:y}=l(u);return{date:(0,n.LE)(u,{format:"MMMM DD, YYYY",timeZone:p??""}),time:`${i(f)}:${i(y)}`}},h=u=>{if(!u.from||!u.to)return"Dashboard time range";const p=parseInt(u.from,10),f=parseInt(u.to,10);return!isNaN(p)&&!isNaN(f)?(0,s.describeTimeRange)({from:(0,t.KQ)(p),to:(0,t.KQ)(f)}):(0,s.describeTimeRange)(u)},o=u=>!u||!u.from||!u.to,m=u=>[29,30,31].includes(u)},15626:(G,R,e)=>{"use strict";e.d(R,{U:()=>n});var t=e(13680);const n=s=>s?s.frequency===t.SchedulingFrequency.Never?"Save and exit":s.startDate?"Schedule send":"Send now":"Save report"},19149:(G,R,e)=>{"use strict";e.d(R,{D:()=>n});var t=e(32264);const n=()=>{const s=t.$.rendererVersion;if(s==="")return null;const r=/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/.exec(s);let g="";if(r&&r.length>1&&(g=r[1]),g==="")return 1;let i=parseInt(g,10);return isNaN(i)&&(i=1),i}},65031:(G,R,e)=>{"use strict";e.d(R,{U:()=>s,m:()=>n});var t=e(13680);const n=a=>{const r=a.state,g=a.schedule.frequency===t.SchedulingFrequency.Never,i=g||[t.ReportState.Draft,t.ReportState.Expired,t.ReportState.Paused].includes(r),l=g||[t.ReportState.Expired].includes(r);return{isNever:g,showPlay:i,disableEdit:l,reportState:r}},s=a=>{let r=t.ReportState.Scheduled;return a===t.ReportState.Expired?r=a:a!==t.ReportState.Paused&&(r=t.ReportState.Paused),r}},78073:(G,R,e)=>{"use strict";e.d(R,{A0:()=>g,En:()=>i,I5:()=>c,OG:()=>o,XO:()=>m,hv:()=>l,mM:()=>d});var t=e(47232),n=e(17624),s=e(13680),a=e(4179),r=e(47071);const g=(u={})=>{const{time:p,startDate:f,endDate:y,endTime:x,timeZone:v,frequency:P,dayOfMonth:E,workdaysOnly:D,intervalFrequency:C,intervalAmount:b,sendTime:T}=u,S=!p&&f?(0,r.WB)(String(f)):p,O=f&&T!=="now"?(0,r.JO)(f,S,v):"",M=y&&![s.SchedulingFrequency.Once,s.SchedulingFrequency.Never].includes(P)?(0,r.JO)(y,x,v):"",I={frequency:P,timeZone:v,workdaysOnly:D,intervalFrequency:C,intervalAmount:b?parseInt(b,10):0,startDate:O,endDate:M,dayOfMonth:E===s.LAST_DAY_OF_MONTH?s.LAST_DAY_OF_MONTH:""};return Object.fromEntries(Object.entries(I).filter(([L,B])=>B))};function i(u){const p=["th","st","nd","rd"],f=u%100;return u+(p[(f-20)%10]||p[f]||p[0])}const l=(u,p=s.IntervalFrequency.Hours)=>u===s.SchedulingFrequency.Custom&&p===s.IntervalFrequency.Hours,d=(u,p=s.IntervalFrequency.Hours)=>[s.SchedulingFrequency.Hourly,s.SchedulingFrequency.Daily].includes(u)||l(u,p);function c({startDate:u,endDate:p,intervalFrequency:f=s.IntervalFrequency.Hours,intervalAmount:y=2,frequency:x,dayOfMonth:v,timeZone:P,workdaysOnly:E}){if(!u)return"";const D="en-US",{hour:C,minute:b}=(0,r.WB)(u),T=(0,r.Zf)(b),S=(0,r.Zf)(C),O=(0,t.KQ)((0,r.pp)(u)).locale(D).format("dddd"),M=v==="last"?"last":i((0,r.pp)(u).getDate());let I,L;const B=(0,n.t)(Date.now(),P),j=`at ${S}:${T}${B?` ${B}`:""}`,A=E&&d(x,f)?", Monday to Friday":"";if(p){const K=(0,t.KQ)((0,r.pp)(u)).locale(D).format("LL"),W=(0,t.KQ)((0,r.pp)(p)).locale(D).format("LL");W!==K?I=`${K} - ${W}`:I=K}switch(x){case s.SchedulingFrequency.Monthly:L=`Monthly on the ${M} day ${j}`;break;case s.SchedulingFrequency.Weekly:L=`Every ${O} ${j}`;break;case s.SchedulingFrequency.Daily:L=`Daily ${j}`;break;case s.SchedulingFrequency.Hourly:L=`Hourly at minute ${T}`;break;case s.SchedulingFrequency.Custom:L=`Every ${y} ${f}`;break;case s.SchedulingFrequency.Once:L=`Once on ${(0,t.KQ)((0,r.pp)(u)).locale(D).format("LL")}`;break;case s.SchedulingFrequency.Never:L="Never";break;default:L=""}return I&&L?`${L}, ${I}${A}`:(x===s.SchedulingFrequency.Custom&&(L+=`, ${f===s.IntervalFrequency.Hours?`from ${S}:${T}${B?` ${B}`:""}`:`from ${(0,t.KQ)((0,r.pp)(u)).locale(D).format("LL")}`}`),L+A)}const h=new Map([[s.SchedulingFrequency.Monthly,"month"],[s.SchedulingFrequency.Daily,"day"],[s.SchedulingFrequency.Weekly,"week"],[s.SchedulingFrequency.Hourly,"hour"]]),o=u=>{const{frequency:p,intervalFrequency:f=s.IntervalFrequency.Hours,intervalAmount:y="2"}=u;if(p===s.SchedulingFrequency.Never)return"The report will not be sent.";const x=u.workdaysOnly?", Monday to Friday.":".",v=[];if(!u.startDate){v.push("The report will be sent immediately after it is saved");const E=p===s.SchedulingFrequency.Custom?`${y} ${f}`:h.get(p);return E&&v.push(`and will be sent every ${E}`),v.join(" ")+x}const P=c(g(u));return P&&v.push(`The report will be sent: ${P}.`),v.join(" ")},m=u=>{const p=a.ue.report.schedule;return Object.keys(p).length!==Object.keys(u).length?!0:Object.entries(p).some(([f,y])=>y!==u[f])}},40981:(G,R,e)=>{"use strict";e.d(R,{A2:()=>u,Do:()=>o,KM:()=>h,U:()=>p,s0:()=>m,y3:()=>d});var t=e(76885),n=e(74856),s=e(55600),a=e(25304),r=e(51475),g=e(78011),i=e(4179),l=e(16629);const d=()=>{if(!window.location.search)return null;const f=new URLSearchParams(window.location.search);return{timeRange:{to:f.get("to")||"",from:f.get("from")||""},dashboard:{uid:f.get("db-uid")||"",name:f.get("db-name")||""},variables:(0,l.S9)()}},c=f=>{if(f.id)return f;const y=d();if(!y)return f;const{timeRange:x,dashboard:v,variables:P}=y;let E=[...initialState.report.dashboards];return x?.from&&x?.to&&(E[0]={...E[0],timeRange:{...x,raw:x}}),v.name&&v.uid&&(E[0]={...E[0],dashboard:{uid:v.uid,name:v.name}}),P&&Object.keys(P).length&&(E[0]={...E[0],reportVariables:P}),{...f,dashboards:E}},h=()=>{const f=new URLSearchParams(window.location.search),y=f.get("to"),x=f.get("from");return x&&y?{from:x,to:y}:null},o=(f,y)=>`${g.C1}/${f}${y?"/"+y:""}`,m=f=>y=>`${g.C1}/${y}${f?"/"+f:""}`,u=f=>{const y=t.kM.toUrlParams((0,a.z)()),x=t.kM.toUrlParams((0,n.jG)().timeRangeForUrl()),v=f instanceof s.H$?f?.state.uid:f?.uid,P=f instanceof s.H$?f?.state.title:f?.title;return`reports/new/?${y}&${x}&db-uid=${v}&db-name=${P}`},p=f=>JSON.stringify(f.map(y=>{const{from:x,to:v}=(0,r.e)(y.timeRange).raw||i.uq.raw;return{dashboard:{uid:y.dashboard?.uid},timeRange:{from:x.valueOf().toString(),to:v.valueOf().toString()},reportVariables:y.reportVariables}}))},58949:(G,R,e)=>{"use strict";e.d(R,{a:()=>r,m:()=>a});var t=e(13680),n=e(72321);const s=g=>Array.isArray(g)?g?.length:!0,a=g=>{const i=[{step:t.StepKey.SelectDashboard,fields:["dashboards"]},{step:t.StepKey.FormatReport,fields:["formats"]},{step:t.StepKey.Share,fields:["name","recipients"]}],l=!g.dashboards?.[0]?.dashboard?.uid;return n.E.reduce((d,c)=>{if(d[c.id]={valid:!0},c.id===t.StepKey.SelectDashboard)return d[t.StepKey.SelectDashboard].valid=!l,d;{const h=i.find(o=>o.step===c.id)?.fields;return h&&(d[c.id].valid=h.every(o=>g[o]&&s(g[o]))),d}},{})},r=(g,i)=>{const l=a(g);return i?!l[i].valid:Object.values(l).some(d=>!d.valid)}},16629:(G,R,e)=>{"use strict";e.d(R,{$w:()=>g,IU:()=>h,S9:()=>l,T6:()=>c,Z5:()=>r,lo:()=>i,zp:()=>d});var t=e(12470),n=e(20601),s=e(24240),a=e(75096);const r=o=>o?.length?Object.fromEntries(o.map(m=>{const{getValueForUrl:u}=n.B.get(m.type),p=u(m);return[m.name,Array.isArray(p)?p:[p]]})):{},g=o=>{if(!o?.length)return{};const m=(0,a.pY)();return Object.fromEntries(o.map(u=>{const{name:p}=u.state,f=m[p],y=(Array.isArray(f)?f:[f]).map(x=>x?.toString()??"");return[p,y]}))},i=(o,m,u)=>!m||!Object.keys(m).length?o.map(p=>({...p,usedInRepeat:u?.has(p.name)})):o.map(p=>{const f=m[p.name];if(!f||!(0,s.SP)(p))return p;const y=f.map(v=>p.options.find(P=>P.value===v)||{text:v,value:v}).filter(Boolean),x="multi"in p&&p.multi;return{...p,usedInRepeat:u?.has(p.name),current:{...p.current,text:x?y.map(v=>v?.text):y[0].text,value:x?y.map(v=>v?.value):y[0].value},options:p.options.map(v=>({...v,selected:typeof v.value=="string"&&f.includes(v.value)}))}}),l=()=>{const o="var-",m=new URLSearchParams(window.location.search),u={};for(const[p,f]of m.entries())if(p.startsWith(o)){const y=p.replace(o,"");u[y]=[...u[y]||[],f]}return u},d=o=>o.some(m=>(0,s.P4)(m)&&m.refresh===t.CO.onTimeRangeChanged),c=(o,m,u)=>{const p=h(o,m,u);return p&&p.usedInRepeat},h=(o,m,u)=>u.find(p=>"current"in p&&p.current.value?p.current.value.length===1&&p.current.value[0]===o&&p.type===m:!1)},1009:(G,R,e)=>{"use strict";e.d(R,{C:()=>g});var t=e(74848),n=e(32196),s=e(40845),a=e(14578),r=e(50720);function g({validationResults:l,onStepChange:d,visitedSteps:c=[],getNextUrl:h,steps:o,activeStep:m=o[0].id}){const u=(0,s.of)(i),p=o[o.length-1];return(0,t.jsx)("ol",{className:u.container,children:o.map(f=>{const y=f.id===p.id,x=f.id===m,v=c.includes(f.id)||m===p.id,P=!y&&!l[f.id].valid,E=!x&&!y&&v,D=E&&!P,C=E&&P,b=(0,n.cx)(u.item,{[u.active]:x,[u.successItem]:D,[u.warnItem]:C});return(0,t.jsxs)("li",{className:b,children:[D&&(0,t.jsx)(a.I,{name:"check",size:"xl",className:u.successItem}),C&&(0,t.jsx)(a.I,{name:"exclamation-triangle",className:u.warnItem}),(0,t.jsx)(r.N,{onClick:x?void 0:()=>d(f.id),href:h(f.id),className:u.link,children:f.name}),!y&&(0,t.jsx)("div",{className:u.divider,children:"\u2014"})]},f.id)})})}const i=l=>({container:(0,n.css)`
      counter-reset: item;
      list-style-type: none;
      width: 100%;
      position: relative;
      display: flex;
      justify-content: center;
      border: 1px solid ${l.colors.border.weak};
      margin: ${l.spacing(4,0)};
    `,item:(0,n.css)`
      color: ${l.colors.text.secondary};
      display: flex;
      align-items: center;
    `,successItem:(0,n.css)`
      a {
        &::before {
          content: '';
        }
      }

      svg {
        color: ${l.colors.success.text};
        margin: ${l.spacing(0,.5,0,-1)};
      }
    `,warnItem:(0,n.css)`
      a::before {
        content: '';
      }
      svg {
        color: ${l.colors.warning.text};
        margin: ${l.spacing(0,1,.5,-.5)};
      }
    `,link:(0,n.css)`
      color: inherit;
      &:hover {
        color: ${l.colors.text.link};
      }

      &::before {
        content: counter(item) '  ';
        counter-increment: item;
      }
    `,active:(0,n.css)`
      font-weight: 500;
      color: ${l.colors.text.maxContrast};

      &::before {
        font-weight: 500;
      }
    `,divider:(0,n.css)`
      padding: ${l.spacing(2)};
    `})},31749:(G,R,e)=>{"use strict";e.d(R,{Tg:()=>a,aV:()=>g});var t=e(65307);const n={teamLBACConfig:{rules:[]}},s=(0,t.Z0)({name:"teamLBAC",initialState:n,reducers:{teamLBACLoaded:(i,l)=>({...i,teamLBACConfig:l.payload})}}),{teamLBACLoaded:a}=s.actions,g={teamLBAC:s.reducer}},82421:()=>{"use strict"},13680:(G,R,e)=>{"use strict";e.d(R,{AccessControlAction:()=>u,AnalyticsTab:()=>o,FooterMode:()=>r,IntervalFrequency:()=>a,LAST_DAY_OF_MONTH:()=>h,ReportFormat:()=>i,ReportState:()=>g,SAMLStepKey:()=>f,SchedulingFrequency:()=>s,StepKey:()=>c,reportLayouts:()=>d,reportOrientations:()=>l});var t=e(13280),n=e(95273),s=(y=>(y.Monthly="monthly",y.Weekly="weekly",y.Daily="daily",y.Hourly="hourly",y.Never="never",y.Custom="custom",y.Once="once",y))(s||{}),a=(y=>(y.Hours="hours",y.Days="days",y.Weeks="weeks",y.Months="months",y))(a||{}),r=(y=>(y.Default="",y.SentBy="sent-by",y.None="none",y))(r||{}),g=(y=>(y.Paused="paused",y.Scheduled="scheduled",y.Expired="expired",y.Draft="draft",y.Never="not scheduled",y))(g||{}),i=(y=>(y.PDF="pdf",y.CSV="csv",y.Image="image",y.PDFTables="pdf-tables",y.PDFTablesAppendix="pdf-tables-appendix",y))(i||{});const l=[{value:"landscape",label:"Landscape",icon:"gf-landscape"},{value:"portrait",label:"Portrait",icon:"gf-portrait"}],d=[{value:"grid",label:"Grid",icon:"table"},{value:"simple",label:"Simple",icon:"gf-layout-simple"}];var c=(y=>(y.SelectDashboard="select-dashboard",y.FormatReport="format-report",y.Schedule="schedule",y.Share="share",y.Confirm="confirm",y))(c||{});const h="last";var o=(y=>(y.Stats="stats",y.Users="users",y.PublicDashboards="public-dashboards",y))(o||{}),m=e(82421),u=(y=>(y.ReportingCreate="reports:create",y.ReportingWrite="reports:write",y.ReportingDelete="reports:delete",y.ReportingRead="reports:read",y.ReportingSend="reports:send",y.ReportingSettingsWrite="reports.settings:write",y.ReportingSettingsRead="reports.settings:read",y.DataSourcesPermissionsRead="datasources.permissions:read",y.DataSourcesPermissionsWrite="datasources.permissions:write",y.DataSourcesCachingWrite="datasources.caching:write",y.LicensingRead="licensing:read",y.LicensingWrite="licensing:write",y.LicensingReportsRead="licensing.reports:read",y.DashboardsInsightsRead="dashboards.insights:read",y.ActionBannersWrite="banners:write",y))(u||{}),p=e(40964),f=(y=>(y.General="general",y.KeyCert="key-cert",y.ConnectToIdP="connect-to-idp",y.AssertionMapping="assertion-mapping",y.SaveAndTest="save-and-test",y))(f||{})},13280:()=>{"use strict"},40964:()=>{"use strict"},95273:()=>{"use strict"},68539:(G,R,e)=>{"use strict";e.d(R,{L:()=>n,X:()=>t});var t=(s=>(s.Test="test",s.Control="control",s))(t||{});const n=s=>"feature-highlights"+(s?`-${s}`:"")},51475:(G,R,e)=>{"use strict";e.d(R,{R:()=>r,e:()=>g});var t=e(85858),n=e(47232),s=e(4179);const a=l=>t.isValid(l.from)&&t.isValid(l.to),r=l=>!l||!a(l)?{from:"",to:""}:{to:l.to.valueOf().toString(),from:l.from.valueOf().toString()},g=l=>{const d=i(l.from),c=i(l.to);return a({from:d,to:c})?{from:d,to:c,raw:{from:d,to:c}}:s.uq},i=l=>{const d=parseInt(l,10);return isNaN(d)?l:(0,n.yT)(d)}},53885:(G,R,e)=>{"use strict";e.d(R,{K7:()=>s,mF:()=>n,nB:()=>a,xf:()=>t});const t=r=>r?/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(r):!1,n=/[,;\n]/,s=(r,g=n)=>r?r.split(g).filter(Boolean).every(i=>t(i)):!0,a=(r="",g=["png","jpg","gif"])=>{if(!r)return!0;const i=r.split(".");return g.includes(i[i.length-1])}},13762:(G,R,e)=>{"use strict";e.d(R,{G:()=>I});var t=e(74848),n=e(32196),s=e(91076),a=e(2543),r=e(96540),g=e(83580),i=e(55852),l=e(37390),d=e(40845),c=e(88575),h=e(14186),o=e(39268),m=e(94354),u=e(24022),p=e(88841),f=e(29158),y=e(10354),x=e(67061),v=e(90182);const P=({value:B,onChange:j,suggestions:A,contentTypeHeader:K=!1})=>{const W=(0,d.of)(E),U=B.find(([te,ne])=>te==="Content-Type"),[F,V]=(0,r.useState)(""),[w,z]=(0,r.useState)(""),[N,H]=(0,r.useState)("");(0,r.useEffect)(()=>{N!==""?H(N):U&&H(U[1])},[N,U]);const[Q,X]=(0,r.useState)(Math.random().toString()),ee=te=>{z(te)},Z=te=>{V(te)},q=te=>()=>{const ne=B.filter(le=>le[0]!==te);j(ne)},ae=te=>{let ne;B?ne=B.filter(le=>le[0]!==(te?te[0]:F)):ne=[],ne.push(te??[F,w]),ne.sort((le,re)=>le[0].localeCompare(re[0])),j(ne),V(""),z(""),X(Math.random().toString())},k=te=>{H(te),ae(["Content-Type",te])},se=F===""||w==="";return(0,t.jsxs)("div",{children:[(0,t.jsxs)(x.B,{direction:"row",children:[(0,t.jsx)(p.y,{value:F,onChange:Z,suggestions:A,placeholder:"Key",style:{width:332}}),(0,t.jsx)(p.y,{value:w,onChange:ee,suggestions:A,placeholder:"Value",style:{width:332}}),(0,t.jsx)(f.K,{"aria-label":"add",name:"plus-circle",onClick:()=>ae(),disabled:se})]},Q),(0,t.jsx)(x.B,{direction:"column",children:Array.from(B.filter(te=>te[0]!=="Content-Type")||[]).map(te=>(0,t.jsxs)(x.B,{direction:"row",children:[(0,t.jsx)(y.p,{disabled:!0,value:te[0]}),(0,t.jsx)(y.p,{disabled:!0,value:te[1]}),(0,t.jsx)(f.K,{"aria-label":"delete",onClick:q(te[0]),name:"trash-alt"})]},te[0]))}),K&&(0,t.jsx)("div",{className:W.extraHeader,children:(0,t.jsxs)(x.B,{direction:"row",children:[(0,t.jsx)(y.p,{value:"Content-Type",disabled:!0}),(0,t.jsx)(v.l6,{onChange:te=>k(te.value),options:g.Ur,value:N})]})})]})},E=B=>({extraHeader:(0,n.css)({marginTop:B.spacing(1),marginBottom:B.spacing(1),maxWidth:673})}),D=13,C=(0,r.memo)(({index:B,value:j,onChange:A,suggestions:K})=>{const W=(0,d.of)(b),U=X=>{A(B,{...j,title:X})},F=X=>{A(B,{...j,fetch:{...j.fetch,url:X}})},V=X=>{A(B,{...j,fetch:{...j.fetch,body:X}})},w=X=>{A(B,{...j,fetch:{...j.fetch,method:X}})},z=X=>{A(B,{...j,fetch:{...j.fetch,queryParams:X}})},N=X=>{A(B,{...j,fetch:{...j.fetch,headers:X}})},H=(X="{}")=>{try{const ee=JSON.parse(X);return(0,t.jsx)(u.B,{json:ee})}catch(ee){return ee instanceof Error?`Invalid JSON provided: ${ee.message}`:"Invalid JSON provided"}},Q=j.fetch.method!==g.DO.GET&&j.fetch.headers?.some(([X,ee])=>X==="Content-Type"&&ee==="application/json");return(0,t.jsxs)("div",{className:W.listItem,children:[(0,t.jsx)(c.D,{label:"Title",children:(0,t.jsx)(p.y,{value:j.title,onChange:U,suggestions:K,autoFocus:j.title==="",placeholder:"Action title"})}),(0,t.jsx)(o.C,{children:(0,t.jsx)(h.I,{label:"Method",labelWidth:D,grow:!0,children:(0,t.jsx)(m.z,{value:j?.fetch.method,options:g.ki,onChange:w,fullWidth:!0})})}),(0,t.jsx)(o.C,{children:(0,t.jsx)(h.I,{label:"URL",labelWidth:D,grow:!0,children:(0,t.jsx)(p.y,{value:j.fetch.url,onChange:F,suggestions:K,placeholder:"URL"})})}),(0,t.jsx)(c.D,{label:"Query parameters",className:W.fieldGap,children:(0,t.jsx)(P,{value:j?.fetch.queryParams??[],onChange:z,suggestions:K})}),(0,t.jsx)(c.D,{label:"Headers",children:(0,t.jsx)(P,{value:j?.fetch.headers??[],onChange:N,suggestions:K,contentTypeHeader:!0})}),j?.fetch.method!==g.DO.GET&&(0,t.jsx)(c.D,{label:"Body",children:(0,t.jsx)(p.y,{value:j.fetch.body,onChange:V,suggestions:K,type:p.c.TextAreaElement})}),Q&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("br",{}),H(j?.fetch.body)]})]})}),b=B=>({listItem:(0,n.css)({marginBottom:B.spacing()}),infoText:(0,n.css)({paddingBottom:B.spacing(2),marginLeft:"66px",color:B.colors.text.secondary}),fieldGap:(0,n.css)({marginTop:B.spacing(2)})});C.displayName="ActionEditor";const T=({action:B,index:j,onSave:A,onCancel:K,getSuggestions:W})=>{const[U,F]=(0,r.useState)(B);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(C,{value:U,index:j,onChange:(V,w)=>{F(w)},suggestions:W()}),(0,t.jsxs)(l.a.ButtonRow,{children:[(0,t.jsx)(i.$n,{variant:"secondary",onClick:()=>K(j),fill:"outline",children:"Cancel"}),(0,t.jsx)(i.$n,{onClick:()=>{A(j,U)},disabled:U.title.trim()===""||U.fetch.url.trim()==="",children:"Save"})]})]})};var S=e(14578);const O=({action:B,onEdit:j,onRemove:A,index:K,itemKey:W})=>{const U=(0,d.of)(M),{title:F=""}=B,V=F.trim()!=="";return(0,t.jsx)(s.sx,{draggableId:W,index:K,children:w=>(0,t.jsx)(t.Fragment,{children:(0,r.createElement)("div",{className:(0,n.cx)(U.wrapper,U.dragRow),ref:w.innerRef,...w.draggableProps,key:K},(0,t.jsx)("div",{className:U.linkDetails,children:(0,t.jsx)("div",{className:(0,n.cx)(U.url,!V&&U.notConfigured),children:V?F:"Action title not provided"})}),(0,t.jsxs)("div",{className:U.icons,children:[(0,t.jsx)(f.K,{name:"pen",onClick:j,className:U.icon,tooltip:"Edit action title"}),(0,t.jsx)(f.K,{name:"times",onClick:A,className:U.icon,tooltip:"Remove action title"}),(0,t.jsx)("div",{className:U.dragIcon,...w.dragHandleProps,children:(0,t.jsx)(S.I,{name:"draggabledots",size:"lg"})})]}))})},W)},M=B=>({wrapper:(0,n.css)({display:"flex",flexGrow:1,alignItems:"center",justifyContent:"space-between",width:"100%",padding:"5px 0 5px 10px",borderRadius:B.shape.radius.default,background:B.colors.background.secondary,gap:8}),linkDetails:(0,n.css)({display:"flex",flexDirection:"column",flexGrow:1}),errored:(0,n.css)({color:B.colors.error.text,fontStyle:"italic"}),notConfigured:(0,n.css)({fontStyle:"italic"}),title:(0,n.css)({color:B.colors.text.primary,fontSize:B.typography.size.sm,fontWeight:B.typography.fontWeightMedium}),url:(0,n.css)({color:B.colors.text.secondary,fontSize:B.typography.size.sm,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"calc(100% - 100px)"}),dragIcon:(0,n.css)({cursor:"grab",color:B.colors.text.secondary,margin:B.spacing(0,.5)}),icon:(0,n.css)({color:B.colors.text.secondary}),dragRow:(0,n.css)({position:"relative"}),icons:(0,n.css)({display:"flex",padding:6,alignItems:"center",gap:8})}),I=({actions:B,onChange:j,data:A,getSuggestions:K,showOneClick:W=!1})=>{const[U,F]=(0,r.useState)(null),[V,w]=(0,r.useState)(!1),[z,N]=(0,r.useState)([]);(0,r.useEffect)(()=>{N(B??[])},[B]);const H=(0,d.of)(L),Q=U!==null,X=(se,te)=>{if(V)if(te.title.trim()===""){w(!1),F(null);return}else F(null),w(!1);const ne=(0,a.cloneDeep)(z);ne[se]=te,j(ne),F(null)},ee=()=>{let se=(0,a.cloneDeep)(z);F(se.length),w(!0)},Z=se=>{V&&w(!1),F(null)},q=se=>{const te=(0,a.cloneDeep)(z);te.splice(se,1),j(te)},ae=se=>{if(!B||!se.destination)return;const te=(0,a.cloneDeep)(z),ne=te[se.source.index];te.splice(se.source.index,1),te.splice(se.destination.index,0,ne),N(te),j(te)},k=(se,te)=>W?(0,t.jsxs)("div",{className:H.oneClickOverlay,children:[(0,t.jsx)("span",{className:H.oneClickSpan,children:"One-click action"})," ",se]},te):se;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.JY,{onDragEnd:ae,children:(0,t.jsx)(s.gL,{droppableId:"sortable-actions",direction:"vertical",children:se=>(0,t.jsxs)("div",{className:H.wrapper,ref:se.innerRef,...se.droppableProps,children:[z.map((te,ne)=>{const le=`${te.title}/${ne}`,re=(0,t.jsx)("div",{className:H.itemWrapper,children:(0,t.jsx)(O,{index:ne,action:te,onChange:X,onEdit:()=>F(ne),onRemove:()=>q(ne),data:A,itemKey:le},le)},le);return ne===0?k(re,le):re}),se.placeholder]})})}),Q&&U!==null&&(0,t.jsx)(l.a,{title:"Edit action",isOpen:!0,closeOnBackdropClick:!1,onDismiss:()=>{Z(U)},children:(0,t.jsx)(T,{index:U,action:V?g.mx:z[U],data:A,onSave:X,onCancel:Z,getSuggestions:K})}),(0,t.jsx)(i.$n,{size:"sm",icon:"plus",onClick:ee,variant:"secondary",className:H.button,children:"Add action"})]})},L=B=>({wrapper:(0,n.css)({marginBottom:B.spacing(2),display:"flex",flexDirection:"column"}),oneClickOverlay:(0,n.css)({height:"auto",border:`2px dashed ${B.colors.text.link}`,fontSize:10,color:B.colors.text.primary,marginBottom:B.spacing(1)}),oneClickSpan:(0,n.css)({padding:10,marginBottom:-10,display:"inline-block"}),itemWrapper:(0,n.css)({padding:"4px 8px 8px 8px"}),button:(0,n.css)({marginLeft:B.spacing(1)})})},75192:(G,R,e)=>{"use strict";e.d(R,{PU:()=>F,jT:()=>B});var t=e(74848),n=e(32196),s=e(96540),a=e(71468),r=e(13544),g=e(40845),i=e(67647),l=e(94354),d=e(55852),c=e(69529),h=e(21780),o=e(10096),m=e(8484),u=e(31678),p=e(12942),f=e(72109),y=e(67061),x=e(56034),v=e(14578),P=e(94753),E=e(78369),D=e(48840),C=e(19384),b=e(46334),T=e(90613);const S=({units:N,icon:H})=>N?.length?N.length>1?(0,t.jsx)(x.m,{placement:"top",content:(0,t.jsx)(y.B,{direction:"column",children:N?.map(Q=>(0,t.jsx)("span",{children:Q.name},Q.name))}),children:(0,t.jsx)(O,{icon:H,children:N.length})}):(0,t.jsx)(O,{icon:H,children:N[0].name}):null,O=(0,s.forwardRef)(({children:N,icon:H},Q)=>(0,t.jsxs)(T.a,{ref:Q,display:"flex",alignItems:"center",marginRight:1,children:[(0,t.jsx)(v.I,{name:H})," ",(0,t.jsx)(T.a,{marginLeft:1,children:N})]}));O.displayName="TooltipContent";const M=({users:N,showPaging:H,totalPages:Q,onChangePage:X,currentPage:ee,fetchData:Z})=>{const q=(0,s.useMemo)(()=>N.some(se=>se.licensedRole),[N]),ae=(0,s.useMemo)(()=>N.some(se=>se.orgs),[N]),k=(0,s.useMemo)(()=>[{id:"avatarUrl",header:"",cell:({cell:{value:se}})=>se&&(0,t.jsx)(p.e,{src:se,alt:"User avatar"})},{id:"login",header:"Login",cell:({row:{original:se}})=>(0,t.jsx)(f.Y,{color:"primary",inline:!1,href:`/admin/users/edit/${se.id}`,title:"Edit user",children:se.login}),sortType:"string"},{id:"email",header:"Email",cell:({cell:{value:se}})=>se,sortType:"string"},{id:"name",header:"Name",cell:({cell:{value:se}})=>se,sortType:"string"},...ae?[{id:"orgs",header:"Belongs to",cell:({cell:{value:se,row:te}})=>(0,t.jsxs)(y.B,{alignItems:"center",children:[(0,t.jsx)(S,{units:se,icon:"building"}),te.original.isAdmin&&(0,t.jsx)(x.m,{placement:"top",content:"Grafana Admin",children:(0,t.jsx)(v.I,{name:"shield"})})]})}]:[],...q?[{id:"licensedRole",header:"Licensed role",cell:({cell:{value:se}})=>se==="None"?(0,t.jsxs)(P.E,{color:"disabled",children:["Not assigned"," ",(0,t.jsx)(x.m,{placement:"top",content:"A licensed role will be assigned when this user signs in",children:(0,t.jsx)(v.I,{name:"question-circle"})})]}):se}]:[],{id:"lastSeenAtAge",header:"Last active",headerTooltip:{content:"Time since user was seen using Grafana",iconName:"question-circle"},cell:({cell:{value:se}})=>(0,t.jsx)(t.Fragment,{children:se&&(0,t.jsx)(t.Fragment,{children:se==="10 years"?(0,t.jsx)(P.E,{color:"disabled",children:"Never"}):se})}),sortType:(se,te)=>new Date(se.original.lastSeenAt).getTime()-new Date(te.original.lastSeenAt).getTime()},{id:"authLabels",header:"Origin",cell:({cell:{value:se}})=>(0,t.jsx)(t.Fragment,{children:Array.isArray(se)&&se.length>0&&(0,t.jsx)(b.E,{label:se[0],removeIcon:!1,count:0})})},{id:"isDisabled",header:"",cell:({cell:{value:se}})=>(0,t.jsx)(t.Fragment,{children:se&&(0,t.jsx)(E.v,{colorIndex:9,name:"Disabled"})})},{id:"edit",header:"",cell:({row:{original:se}})=>(0,t.jsx)(d.z9,{variant:"secondary",size:"sm",icon:"pen",href:`admin/users/edit/${se.id}`,"aria-label":`Edit user ${se.name}`,tooltip:"Edit user"})}],[q,ae]);return(0,t.jsxs)(y.B,{direction:"column",gap:2,children:[(0,t.jsx)(D.j,{columns:k,data:N,getRowId:se=>String(se.id),fetchData:Z}),H&&(0,t.jsx)(y.B,{justifyContent:"flex-end",children:(0,t.jsx)(C.d,{numberOfPages:Q,currentPage:ee,onNavigate:X})})]})};var I=e(57334);const L=[],B=N=>{L.push(N)},j=r.Tp.pages.UserListPage.UserListAdminPage,A={fetchUsers:I.hU,changeQuery:I.nM,changePage:I.yd,changeFilter:I.$u,changeSort:I.Vk},K=N=>({users:N.userListAdmin.users,query:N.userListAdmin.query,showPaging:N.userListAdmin.showPaging,totalPages:N.userListAdmin.totalPages,page:N.userListAdmin.page,filters:N.userListAdmin.filters,isLoading:N.userListAdmin.isLoading}),F=(0,a.connect)(K,A)(({fetchUsers:N,query:H,changeQuery:Q,users:X,showPaging:ee,changeFilter:Z,filters:q,totalPages:ae,page:k,changePage:se,changeSort:te,isLoading:ne})=>{const le=(0,g.of)(w);return(0,s.useEffect)(()=>{N()},[N]),(0,t.jsxs)(h.YW.Contents,{children:[(0,t.jsx)("div",{className:le.actionBar,"data-testid":j.container,children:(0,t.jsxs)("div",{className:le.row,children:[(0,t.jsx)(i.Z,{placeholder:"Search user by login, email, or name.",autoFocus:!0,value:H,onChange:Q}),(0,t.jsx)(l.z,{options:[{label:"All users",value:!1},{label:"Active last 30 days",value:!0}],onChange:re=>Z({name:"activeLast30Days",value:re}),value:q.find(re=>re.name==="activeLast30Days")?.value,className:le.filter}),L.map((re,de)=>(0,t.jsx)(re,{filters:q,onChange:Z,className:le.filter},de)),o.TP.hasPermission(u.AccessControlAction.UsersCreate)&&(0,t.jsx)(d.z9,{href:"admin/users/create",variant:"primary",children:"New user"})]})}),!ne&&X.length===0?(0,t.jsx)(c.p,{message:(0,m.t)("users.empty-state.message","No users found"),variant:"not-found"}):(0,t.jsx)(M,{users:X,showPaging:ee,totalPages:ae,onChangePage:se,currentPage:k,fetchData:te})]})});function V(){return jsx(Page,{navId:"global-users",children:jsx(F,{})})}const w=N=>({filter:(0,n.css)({margin:N.spacing(0,1),[N.breakpoints.down("sm")]:{margin:0}}),actionBar:(0,n.css)({marginBottom:N.spacing(2),display:"flex",alignItems:"flex-start",gap:N.spacing(2),[N.breakpoints.down("sm")]:{flexWrap:"wrap"}}),row:(0,n.css)({display:"flex",alignItems:"flex-start",textAlign:"left",marginBottom:N.spacing(.5),flexGrow:1,[N.breakpoints.down("sm")]:{flexWrap:"wrap",gap:N.spacing(2),width:"100%"}})}),z=null},57334:(G,R,e)=>{"use strict";e.d(R,{$u:()=>F,A5:()=>Q,Bc:()=>X,DX:()=>B,JI:()=>I,Jc:()=>j,Kg:()=>L,MV:()=>f,N6:()=>v,P3:()=>D,Pi:()=>C,T$:()=>T,TK:()=>u,VR:()=>S,Vk:()=>w,hG:()=>x,hU:()=>K,is:()=>ee,kz:()=>o,ly:()=>p,mI:()=>M,nM:()=>U,nh:()=>E,nr:()=>y,pm:()=>O,xq:()=>N,yd:()=>V});var t=e(2543),n=e.n(t),s=e(72724),a=e(33378),r=e(17172),g=e(39601),i=e(2913),l=e(10096),d=e(80714),c=e(31678),h=e(44672);function o(Z){return async q=>{try{q((0,h.D1)(!1)),await q(m(Z)),await q(P(Z)),await q(b(Z)),i.Ay.ldapEnabled&&(0,a.a)("ldapsync")&&await q(O()),q((0,h.D1)(!0))}catch(ae){if(console.error(ae),(0,r.NF)(ae)){const k={title:ae.data.message,body:ae.data.error};q((0,h.PV)(k))}}}}function m(Z){return async q=>{const ae=await(0,r.AI)().get(`/api/users/${Z}`,(0,d.F)());q((0,h.G_)(ae))}}function u(Z){return async q=>{await(0,r.AI)().put(`/api/users/${Z.id}`,Z),q(o(Z.id))}}function p(Z,q){return async ae=>{const k={password:q};await(0,r.AI)().put(`/api/admin/users/${Z}/password`,k),ae(o(Z))}}function f(Z){return async q=>{await(0,r.AI)().post(`/api/admin/users/${Z}/disable`),g.Ny.push("/admin/users")}}function y(Z){return async q=>{await(0,r.AI)().post(`/api/admin/users/${Z}/enable`),q(o(Z))}}function x(Z){return async q=>{await(0,r.AI)().delete(`/api/admin/users/${Z}`),g.Ny.push("/admin/users")}}function v(Z,q){return async ae=>{const k={isGrafanaAdmin:q};await(0,r.AI)().put(`/api/admin/users/${Z}/permissions`,k),ae(o(Z))}}function P(Z){return async q=>{const ae=await(0,r.AI)().get(`/api/users/${Z}/orgs`);q((0,h.OF)(ae))}}function E(Z,q,ae){return async k=>{const se={loginOrEmail:Z.login,role:ae};await(0,r.AI)().post(`/api/orgs/${q}/users/`,se),k(o(Z.id))}}function D(Z,q,ae){return async k=>{const se={role:ae};await(0,r.AI)().patch(`/api/orgs/${q}/users/${Z}`,se),k(o(Z))}}function C(Z,q){return async ae=>{await(0,r.AI)().delete(`/api/orgs/${q}/users/${Z}`),ae(o(Z))}}function b(Z){return async q=>{if(!l.TP.hasPermission(c.AccessControlAction.UsersAuthTokenList))return;const ae=await(0,r.AI)().get(`/api/admin/users/${Z}/auth-tokens`);ae.reverse();const k=ae.map(se=>({id:se.id,isActive:se.isActive,seenAt:(0,s.fq)(se.seenAt),createdAt:se.createdAt,clientIp:se.clientIp,browser:se.browser,browserVersion:se.browserVersion,os:se.os,osVersion:se.osVersion,device:se.device}));q((0,h.ag)(k))}}function T(Z,q){return async ae=>{const k={authTokenId:Z};await(0,r.AI)().post(`/api/admin/users/${q}/revoke-auth-token`,k),ae(b(q))}}function S(Z){return async q=>{await(0,r.AI)().post(`/api/admin/users/${Z}/logout`),q(b(Z))}}function O(){return async Z=>{const q=l.TP.hasPermission(c.AccessControlAction.LDAPStatusRead);if((0,a.a)("ldapsync")&&q){const ae=await(0,r.AI)().get("/api/admin/ldap-sync-status");Z((0,h.OR)(ae))}}}function M(Z){return async q=>{await(0,r.AI)().post(`/api/admin/ldap/sync/${Z}`),q(o(Z))}}function I(){return async Z=>{if(l.TP.hasPermission(c.AccessControlAction.LDAPStatusRead))try{const q=await(0,r.AI)().get("/api/admin/ldap/status");Z((0,h.pH)(q))}catch(q){if((0,r.NF)(q)){q.isHandled=!0;const ae={title:q.data.message,body:q.data.error};Z((0,h.V$)(ae))}}}}function L(Z){return async q=>{try{const ae=await(0,r.AI)().get(`/api/admin/ldap/${encodeURIComponent(Z)}`),{name:k,surname:se,email:te,login:ne,isGrafanaAdmin:le,isDisabled:re,roles:de,teams:oe}=ae,J={info:{name:k,surname:se,email:te,login:ne},permissions:{isGrafanaAdmin:le,isDisabled:re},roles:de,teams:oe};q((0,h.TW)(J))}catch(ae){if((0,r.NF)(ae)){ae.isHandled=!0;const k={title:ae.data.message,body:ae.data.error};q((0,h.Vv)()),q((0,h.Nf)(k))}}}}function B(){return Z=>{Z((0,h.zi)())}}function j(){return Z=>{Z((0,h.zi)()),Z((0,h.Vv)())}}const A=Z=>Z.map(q=>Array.isArray(q.value)?q.value.map(ae=>`${q.name}=${ae.value}`).join("&"):`${q.name}=${q.value}`).join("&");function K(){return async(Z,q)=>{try{const{perPage:ae,page:k,query:se,filters:te,sort:ne}=q().userListAdmin;let le=`/api/users/search?perpage=${ae}&page=${k}&query=${se}&${A(te)}`;ne&&(le+=`&sort=${ne}`);const re=await(0,r.AI)().get(le);Z((0,h.Mb)(re))}catch(ae){(0,h.g4)(),console.error(ae)}}}const W=(0,t.debounce)(Z=>Z(K()),500);function U(Z){return async q=>{q((0,h.Cj)()),q((0,h.L5)(Z)),W(q)}}function F(Z){return async q=>{q((0,h.Cj)()),q((0,h.jX)(Z)),W(q)}}function V(Z){return async q=>{q((0,h.Cj)()),q((0,h.EC)(Z)),q(K())}}function w({sortBy:Z}){const q=Z.length?`${Z[0].id}-${Z[0].desc?"desc":"asc"}`:void 0;return async(ae,k)=>{k().userListAdmin.sort!==q&&(ae((0,h.Cj)()),ae((0,h.$u)(q)),ae(K()))}}const z=Z=>Z.map(q=>Array.isArray(q.value)?q.value.map(ae=>`${q.name}=${ae.value}`).join("&"):`${q.name}=${q.value}`).join("&");function N(){return async(Z,q)=>{try{const{perPage:ae,page:k,query:se,filters:te,sort:ne}=q().userListAnonymousDevices;let le=`/api/anonymous/search?perpage=${ae}&page=${k}&query=${se}&${z(te)}`;ne&&(le+=`&sort=${ne}`);const re=await(0,r.AI)().get(le);Z((0,h.o3)(re))}catch(ae){console.error(ae)}}}const H=(0,t.debounce)(Z=>Z(N()),500);function Q({sortBy:Z}){const q=Z.length?`${Z[0].id}-${Z[0].desc?"desc":"asc"}`:void 0;return async(ae,k)=>{k().userListAnonymousDevices.sort!==q&&(ae((0,h.kh)(q)),ae(N()))}}function X(Z){return async q=>{q((0,h.xx)(Z)),H(q)}}function ee(Z){return async q=>{q((0,h.iK)(Z)),q(N())}}},44672:(G,R,e)=>{"use strict";e.d(R,{$u:()=>M,Ay:()=>F,Cj:()=>C,D1:()=>y,EC:()=>S,G_:()=>u,L5:()=>T,Mb:()=>D,Nf:()=>d,OF:()=>p,OR:()=>l,PV:()=>x,TW:()=>c,V$:()=>i,Vv:()=>r,ag:()=>f,g4:()=>b,iK:()=>K,jX:()=>O,kh:()=>A,o3:()=>j,pH:()=>g,xx:()=>W,zi:()=>a});var t=e(65307);const n={connectionInfo:[],syncInfo:void 0,user:void 0,connectionError:void 0,userError:void 0},s=(0,t.Z0)({name:"ldap",initialState:n,reducers:{ldapConnectionInfoLoadedAction:(V,w)=>({...V,ldapError:void 0,connectionInfo:w.payload}),ldapFailedAction:(V,w)=>({...V,ldapError:w.payload}),ldapSyncStatusLoadedAction:(V,w)=>({...V,syncInfo:w.payload}),userMappingInfoLoadedAction:(V,w)=>({...V,user:w.payload,userError:void 0}),userMappingInfoFailedAction:(V,w)=>({...V,user:void 0,userError:w.payload}),clearUserMappingInfoAction:(V,w)=>({...V,user:void 0}),clearUserErrorAction:(V,w)=>({...V,userError:void 0})}}),{clearUserErrorAction:a,clearUserMappingInfoAction:r,ldapConnectionInfoLoadedAction:g,ldapFailedAction:i,ldapSyncStatusLoadedAction:l,userMappingInfoFailedAction:d,userMappingInfoLoadedAction:c}=s.actions,h=s.reducer,o={user:void 0,sessions:[],orgs:[],isLoading:!0,error:void 0},m=(0,t.Z0)({name:"userAdmin",initialState:o,reducers:{userProfileLoadedAction:(V,w)=>({...V,user:w.payload}),userOrgsLoadedAction:(V,w)=>({...V,orgs:w.payload}),userSessionsLoadedAction:(V,w)=>({...V,sessions:w.payload}),userAdminPageLoadedAction:(V,w)=>({...V,isLoading:!w.payload}),userAdminPageFailedAction:(V,w)=>({...V,error:w.payload,isLoading:!1})}}),{userProfileLoadedAction:u,userOrgsLoadedAction:p,userSessionsLoadedAction:f,userAdminPageLoadedAction:y,userAdminPageFailedAction:x}=m.actions,v=m.reducer,P={users:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,filters:[{name:"activeLast30Days",value:!1}],isLoading:!0},E=(0,t.Z0)({name:"userListAdmin",initialState:P,reducers:{usersFetched:(V,w)=>{const{totalCount:z,perPage:N,...H}=w.payload,Q=Math.ceil(z/N);return{...V,...H,totalPages:Q,perPage:N,showPaging:Q>1,isLoading:!1}},usersFetchBegin:V=>({...V,isLoading:!0}),usersFetchEnd:V=>({...V,isLoading:!1}),queryChanged:(V,w)=>({...V,query:w.payload,page:0}),pageChanged:(V,w)=>({...V,page:w.payload}),sortChanged:(V,w)=>({...V,page:0,sort:w.payload}),filterChanged:(V,w)=>{const{name:z,value:N}=w.payload;return V.filters.some(H=>H.name===z)?{...V,page:0,filters:V.filters.map(H=>H.name===z?{...H,value:N}:H)}:{...V,page:0,filters:[...V.filters,w.payload]}}}}),{usersFetched:D,usersFetchBegin:C,usersFetchEnd:b,queryChanged:T,pageChanged:S,filterChanged:O,sortChanged:M}=E.actions,I=E.reducer,L={devices:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,filters:[{name:"activeLast30Days",value:!0}]},B=(0,t.Z0)({name:"userListAnonymousDevices",initialState:L,reducers:{usersAnonymousDevicesFetched:(V,w)=>{const{totalCount:z,perPage:N,...H}=w.payload,Q=Math.ceil(z/N);return{...V,...H,totalPages:Q,perPage:N,showPaging:Q>1}},anonQueryChanged:(V,w)=>({...V,query:w.payload,page:0}),anonPageChanged:(V,w)=>({...V,page:w.payload}),anonUserSortChanged:(V,w)=>({...V,page:0,sort:w.payload}),filterChanged:(V,w)=>{const{name:z,value:N}=w.payload;return V.filters.some(H=>H.name===z)?{...V,page:0,filters:V.filters.map(H=>H.name===z?{...H,value:N}:H)}:{...V,page:0,filters:[...V.filters,w.payload]}}}}),{usersAnonymousDevicesFetched:j,anonUserSortChanged:A,anonPageChanged:K,anonQueryChanged:W}=B.actions,U=B.reducer,F={ldap:h,userAdmin:v,userListAdmin:I,userListAnonymousDevices:U}},35538:(G,R,e)=>{"use strict";e.d(R,{pL:()=>n,z5:()=>a});var t=e(32264);const n=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;function s(){const r=t.$.licenseInfo?.trialExpiry;return!!(r&&r>0)}const a=()=>s()&&t.$.featureToggles.featureHighlights},55907:(G,R,e)=>{"use strict";e.d(R,{A:()=>v,p:()=>i});var t=e(2543),n=e.n(t),s=e(1062);const a=new s.tI({type:"query",params:[{name:"queryRefId",type:"string",dynamicLookup:!0},{name:"from",type:"string",options:["10s","1m","5m","10m","15m","1h","2h","6h","12h","24h","48h"]},{name:"to",type:"string",options:["now","now-1m","now-5m","now-10m","now-1h"]}],defaultParams:["#A","15m","now","avg"]}),r=[{text:"Query",value:"query"}],g={alerting:1,firing:1,no_data:2,pending:3,ok:4,paused:5,inactive:5};var i=(P=>(P.IsAbove="gt",P.IsBelow="lt",P.IsOutsideRange="outside_range",P.IsWithinRange="within_range",P.HasNoValue="no_value",P))(i||{});const l=[{value:"gt",text:"IS ABOVE"},{value:"lt",text:"IS BELOW"},{value:"outside_range",text:"IS OUTSIDE RANGE"},{value:"within_range",text:"IS WITHIN RANGE"},{value:"no_value",text:"HAS NO VALUE"}],d=[{text:"OR",value:"or"},{text:"AND",value:"and"},{text:"LOGIC OR",value:"logic-or"}],c=[{text:"avg()",value:"avg"},{text:"min()",value:"min"},{text:"max()",value:"max"},{text:"sum()",value:"sum"},{text:"count()",value:"count"},{text:"last()",value:"last"},{text:"median()",value:"median"},{text:"diff()",value:"diff"},{text:"diff_abs()",value:"diff_abs"},{text:"percent_diff()",value:"percent_diff"},{text:"percent_diff_abs()",value:"percent_diff_abs"},{text:"count_non_null()",value:"count_non_null"}],h=[{text:"Alerting",value:"alerting"},{text:"No Data",value:"no_data"},{text:"Keep Last State",value:"keep_state"},{text:"Ok",value:"ok"}],o=[{text:"Alerting",value:"alerting"},{text:"Keep Last State",value:"keep_state"}];function m(P){const E=new s.tI({type:P.type,defaultParams:[]});return new s.kW(P,E)}function u(P){return P.toLowerCase().replace(/_/g,"").split(" ")[0]}function p(P){switch(u(P)){case"normal":case"ok":return{text:"OK",iconClass:"heart",stateClass:"alert-state-ok"};case"alerting":return{text:"ALERTING",iconClass:"heart-break",stateClass:"alert-state-critical"};case"nodata":return{text:"NO DATA",iconClass:"question-circle",stateClass:"alert-state-warning"};case"paused":return{text:"PAUSED",iconClass:"pause",stateClass:"alert-state-paused"};case"pending":return{text:"PENDING",iconClass:"hourglass",stateClass:"alert-state-warning"};case"firing":return{text:"FIRING",iconClass:"fire",stateClass:""};case"inactive":return{text:"INACTIVE",iconClass:"check",stateClass:""};case"error":return{text:"ERROR",iconClass:"heart-break",stateClass:"alert-state-critical"};case"unknown":default:return{text:"UNKNOWN",iconClass:"question-circle",stateClass:".alert-state-paused"}}}function f(P,E){return(0,t.reduce)(P,(D,C)=>(C.metric!==void 0&&C.value!==void 0&&D.push(C.metric+"="+C.value),C.Metric!==void 0&&C.Value!==void 0&&D.push(C.Metric+"="+C.Value),D),[]).join(E)}function y(P){return(0,t.isArray)(P.data)?f(P.data,", "):(0,t.isArray)(P.data.evalMatches)?f(P.data.evalMatches,", "):P.data.error?"Error: "+P.data.error:""}function x(P){return(0,t.isArray)(P)?f(P,", "):(0,t.isArray)(P.evalMatches)?f(P.evalMatches,", "):P.error?"Error: "+P.error:""}const v={alertQueryDef:a,getStateDisplayModel:p,conditionTypes:r,evalFunctions:l,evalOperators:d,noDataModes:h,executionErrorModes:o,reducerTypes:c,createReducerPart:m,getAlertAnnotationInfo:y,getAlertAnnotationText:x,alertStateSortScore:g}},1062:(G,R,e)=>{"use strict";e.d(R,{Dw:()=>g,Wn:()=>r,kW:()=>a,tI:()=>s});var t=e(2543),n=e.n(t);class s{constructor(c){this.type=c.type,this.params=c.params,this.defaultParams=c.defaultParams,this.renderer=c.renderer,this.category=c.category,this.addStrategy=c.addStrategy}}class a{constructor(c,h){if(this.part=c,this.def=h,!this.def)throw{message:"Could not find query part "+c.type};c.params=c.params||(0,t.clone)(this.def.defaultParams),this.params=c.params,this.text="",this.updateText()}render(c){return this.def.renderer(this,c)}hasMultipleParamsInString(c,h){return c.indexOf(",")===-1?!1:this.def.params[h+1]&&this.def.params[h+1].optional}updateParam(c,h){if(this.hasMultipleParamsInString(c,h)){(0,t.each)(c.split(","),(o,m)=>{this.updateParam(o.trim(),m)});return}c===""&&this.def.params[h].optional?this.params.splice(h,1):this.params[h]=c,this.part.params=this.params,this.updateText()}updateText(){if(this.params.length===0){this.text=this.def.type+"()";return}let c=this.def.type+"(";c+=this.params.join(", "),c+=")",this.text=c}}function r(d,c){const h=d.def.type+"(",o=(0,t.map)(d.params,(m,u)=>{const p=d.def.params[u];return p.type==="time"&&m==="auto"&&(m="$__interval"),p.quote==="single"?"'"+m+"'":p.quote==="double"?'"'+m+'"':m});return c&&o.unshift(c),h+o.join(", ")+")"}function g(d,c){return c+" "+d.params[0]}function i(d,c){return d.params[0]}function l(d,c){return'"'+d.params[0]+'"'}},25027:(G,R,e)=>{"use strict";e.d(R,{AK:()=>S,Cl:()=>K,Hs:()=>F,IR:()=>T,KF:()=>y,Ke:()=>v,P6:()=>W,QA:()=>p,Rk:()=>b,Sn:()=>L,Sq:()=>D,U6:()=>j,U7:()=>f,aL:()=>B,fH:()=>o,iW:()=>U,l$:()=>u,le:()=>h,nf:()=>C,t6:()=>A,vV:()=>m,zs:()=>M});var t=e(2543),n=e.n(t),s=e(47232),a=e(34867),r=e(17172),g=e(32264),i=e(14110),l=e(10096),d=e(28475);const c=7,h={filterByLabel:"filtering alert instances by label",loadedList:"loaded Alert Rules list",leavingRuleGroupEdit:"leaving rule group edit without saving",alertRuleFromPanel:"creating alert rule from panel",alertRuleFromScratch:"creating alert rule from scratch",recordingRuleFromScratch:"creating recording rule from scratch",clickingAlertStateFilters:"clicking alert state filters",cancelSavingAlertRule:"user canceled alert rule creation",successSavingAlertRule:"alert rule saved successfully",unknownMessageFromError:"unknown messageFromError",grafanaRecording:"creating Grafana recording rule from scratch",loadedCentralAlertStateHistory:"loaded central alert state history"},{logInfo:o,logError:m,logMeasurement:u}=(0,a.DW)("features.alerting",{module:"Alerting"});function p(V,w,z){return async function(...N){const H=performance.now(),Q=await w(...N),X=performance.now()-H;return u(V,{loadTimesMs:X},z),Q}}function f(V,w,z){return async(...N)=>{const H=performance.now(),Q=await w(...N),{namespacesCount:X,groupsCount:ee,rulesCount:Z}=x(Q);return u(V,{loadTimeMs:performance.now()-H,namespacesCount:X,groupsCount:ee,rulesCount:Z},z),Q}}function y(V){Object.entries(V).forEach(([w,z])=>{const N=z.message??"unknown error",H=String(z.type)??"unknown",Q=new Error(N);m(Q,{field:w,type:H})})}function x(V){const w=V.length,z=V.flatMap(Q=>Q.groups).length,N=V.flatMap(Q=>Q.groups).flatMap(Q=>Q.rules).length;return{namespacesCount:w,groupsCount:z,rulesCount:N}}function v(V,w,z){return async(...N)=>{const H=performance.now(),Q=await w(...N),{namespacesCount:X,groupsCount:ee,rulesCount:Z}=P(Q);return u(V,{namespacesCount:X,groupsCount:ee,rulesCount:Z,loadTimeMs:performance.now()-H},z),Q}}function P(V){const w=Object.keys(V),z=Object.values(V).flatMap(H=>H),N=z.flatMap(H=>H.rules);return{namespacesCount:w.length,groupsCount:z.length,rulesCount:N.length}}async function E(){try{const{createdAt:V}=await(0,r.AI)().get("/api/user"),w=(0,s.KQ)().subtract(c,"days"),z=(0,s.KQ)(V);return w.isBefore(z)}catch{return!0}}const D=async(V={grafana_version:g.$.buildInfo.version,org_id:l.TP.user.orgId,user_id:l.TP.user.id})=>{await E()||(0,i.rR)("grafana_alerting_navigation",V)},C=V=>{(0,i.rR)("grafana_alerting_rule_creation",V)},b=V=>{(0,i.rR)("grafana_alerting_rule_aborted",V)},T=V=>{(0,i.rR)("grafana_alerting_rule_form_error",V)},S=async V=>{const w={grafana_version:g.$.buildInfo.version,org_id:l.TP.user.orgId,user_id:l.TP.user.id};(0,i.rR)("grafana_alerting_insights",{...w,...V})};function O(V){(0,i.rR)("grafana_alerting_rules_search",{...V})}function M({oldQuery:V,newQuery:w}){try{const z=(0,d.XY)(V),N=(0,d.XY)(w),H=I(z);I(N).filter(ee=>!H.includes(ee)).forEach(ee=>{O({filter:ee,triggeredBy:"typing"})})}catch(z){z instanceof Error&&m(z)}}function I(V){return Object.entries(V).filter(([w,z])=>!(0,t.isEmpty)(z)).map(([w])=>w)}function L(V){O({filter:V,triggeredBy:"component"})}function B(V){(0,i.rR)("grafana_alerting_rules_list_mode",{...V})}function j(){(0,i.rR)("grafana_alerting_contact_point_form_edit_input_with_template")}function A(){(0,i.rR)("grafana_alerting_contact_point_form_use_custom_input_in_template")}function K(){(0,i.rR)("grafana_alerting_contact_point_form_use_single_template_in_input")}function W(V){(0,i.rR)("grafana_alerting_central_alert_state_history_filter_by_clicking",V)}function U(){(0,i.rR)("grafana_alerting_central_alert_state_history_expand_row")}function F(V){(0,i.rR)("grafana_alerting_central_alert_state_history_max_events_reached",V)}},79741:(G,R,e)=>{"use strict";e.r(R),e.d(R,{default:()=>y,defaultPageNav:()=>p});var t=e(74848),n=e(96540),s=e(54148),a=e(17172),r=e(42418),g=e(66602),i=e(7392),l=e(37959),d=e(5179),c=e(39890),h=e(730),o=e(78742),m=e(18461);const u=()=>{const x=(0,s.g)(),v=(0,m.uE)(x),[P]=(0,c.P5)(),D=P===c.gQ.Instances?void 0:0,C=(0,n.useMemo)(()=>{if(!v)throw new Error("Rule ID is required");return(0,m.qg)(v,!0)},[v]),{loading:b,error:T,result:S}=(0,h.ZU)({ruleIdentifier:C,limitAlerts:D});return T?(0,t.jsx)(l.d,{pageNav:p,navId:"alert-list",children:(0,t.jsx)(f,{error:T})}):b?(0,t.jsx)(l.d,{pageNav:p,navId:"alert-list",isLoading:!0,children:(0,t.jsx)(t.Fragment,{})}):S?(0,t.jsx)(d.K,{identifier:C,rule:S,children:(0,t.jsx)(c.Ay,{})}):(0,t.jsx)(l.d,{pageNav:p,navId:"alert-list",children:(0,t.jsx)(i.L,{entity:"Rule"})})},p={id:"alert-rule-view",text:""};function f({error:x}){return(0,a.NF)(x)&&x.status===404?(0,t.jsx)(i.L,{entity:"Rule"}):(0,t.jsx)(r.F,{title:"Something went wrong loading the rule",children:(0,o.JZ)(x)})}const y=(0,g.Xc)(u,{style:"page"})},79938:(G,R,e)=>{"use strict";e.d(R,{hK:()=>m});var t=e(2543),n=e.n(t),s=e(8484),a=e(57220),r=e(75214),g=e(23662),i=e(49962),l=e(49498),d=e(28220);const c="/api/v1/rule/test/grafana",h="api/prometheus/grafana/api/v1/rules";var o=(u=>(u.RuleGroup="rule_group",u.Namespace="file",u.FolderUID="folder_uid",u.LimitAlerts="limit_alerts",u))(o||{});const m=i.H.injectEndpoints({endpoints:u=>({preview:u.mutation({query:({alertQueries:p,condition:f,customLabels:y,folder:x,alertName:v,alertUid:P})=>({url:c,data:{rule:{grafana_alert:{data:p,condition:f,no_data_state:"Alerting",title:v,uid:P??"N/A"},for:"0s",labels:(0,r.x4)(y),annotations:{}},folderUid:x.uid,folderTitle:x.title},method:"POST"})}),prometheusRulesByNamespace:u.query({query:({limitAlerts:p,identifier:f,filter:y,state:x,matcher:v})=>{const P=new URLSearchParams;p&&P.set("limit_alerts",String(p)),f&&((0,g.Mj)(f)||(0,g.X4)(f))&&(P.set("file",f.namespace),P.set("rule_group",f.groupName));const D={...(0,l.ou)(y),...Object.fromEntries(P)};return{url:h,params:(0,l.Dj)(D,x,v)}},transformResponse:p=>(0,l.lH)(p.data.groups,a.hY)}),prometheusRuleNamespaces:u.query({query:({ruleSourceName:p,namespace:f,groupName:y,ruleName:x,dashboardUid:v,panelId:P,limitAlerts:E})=>{const D={rule_group:y,rule_name:x,dashboard_uid:v,panel_id:P?.toString()};return f&&((0,a.z2)(p)?(0,t.set)(D,"folder_uid",f):(0,t.set)(D,"file",f)),E!==void 0&&(0,t.set)(D,"limit_alerts",String(E)),{url:`api/prometheus/${(0,a.w5)(p)}/api/v1/rules`,params:D}},transformResponse:(p,f,y)=>(0,l.lH)(p.data.groups,y.ruleSourceName),providesTags:["CombinedAlertRule"]}),rulerRules:u.query({query:({rulerConfig:p,filter:f})=>{const{path:y,params:x}=(0,d.$o)(p).rules(f);return{url:y,params:x}},providesTags:["CombinedAlertRule"]}),rulerNamespace:u.query({query:({rulerConfig:p,namespace:f})=>{const{path:y,params:x}=(0,d.$o)(p).namespace(f);return{url:y,params:x}}}),getRuleGroupForNamespace:u.query({query:({rulerConfig:p,namespace:f,group:y,notificationOptions:x})=>{const{path:v,params:P}=(0,d.$o)(p).namespaceGroup(f,y);return{url:v,params:P,notificationOptions:x}},providesTags:(p,f,{namespace:y,group:x})=>[{type:"RuleGroup",id:`${y}/${x}`},{type:"RuleNamespace",id:y}]}),deleteRuleGroupFromNamespace:u.mutation({query:({rulerConfig:p,namespace:f,group:y,notificationOptions:x})=>{const v=(0,s.t)("alerting.rule-groups.delete.success","Successfully deleted rule group"),{path:P,params:E}=(0,d.$o)(p).namespaceGroup(f,y);return{url:P,params:E,method:"DELETE",notificationOptions:{successMessage:v,...x}}},invalidatesTags:(p,f,{namespace:y,group:x})=>[{type:"RuleGroup",id:`${y}/${x}`},{type:"RuleNamespace",id:y}]}),upsertRuleGroupForNamespace:u.mutation({query:({payload:p,namespace:f,rulerConfig:y,notificationOptions:x})=>{const{path:v,params:P}=(0,d.$o)(y).namespace(f),E=(0,s.t)("alerting.rule-groups.update.success","Successfully updated rule group");return{url:v,params:P,data:p,method:"POST",notificationOptions:{successMessage:E,...x}}},invalidatesTags:(p,f,{namespace:y,payload:x})=>[{type:"RuleNamespace",id:y},{type:"RuleGroup",id:`${y}/${x.name}`}]}),getAlertRule:u.query({query:({uid:p})=>({url:`/api/ruler/${a.hY}/api/v1/rule/${p}`}),providesTags:(p,f,{uid:y})=>[{type:"GrafanaRulerRule",id:y}]}),exportRules:u.query({query:({format:p,folderUid:f,group:y,ruleUid:x})=>({url:"/api/ruler/grafana/api/v1/export/rules",params:{format:p,folderUid:f,group:y,ruleUid:x},responseType:"text"}),keepUnusedDataFor:0}),exportReceiver:u.query({query:({receiverName:p,decrypt:f,format:y})=>({url:"/api/v1/provisioning/contact-points/export/",params:{format:y,decrypt:f,name:p},responseType:"text"}),keepUnusedDataFor:0}),exportReceivers:u.query({query:({decrypt:p,format:f})=>({url:"/api/v1/provisioning/contact-points/export/",params:{format:f,decrypt:p},responseType:"text"}),keepUnusedDataFor:0}),exportPolicies:u.query({query:({format:p})=>({url:"/api/v1/provisioning/policies/export/",params:{format:p},responseType:"text"}),keepUnusedDataFor:0}),exportModifiedRuleGroup:u.mutation({query:({payload:p,format:f,nameSpaceUID:y})=>({url:`/api/ruler/grafana/api/v1/rules/${y}/export/`,params:{format:f},responseType:"text",data:p,method:"POST"})}),exportMuteTimings:u.query({query:({format:p})=>({url:"/api/v1/provisioning/mute-timings/export/",params:{format:p},responseType:"text"}),keepUnusedDataFor:0}),exportMuteTiming:u.query({query:({format:p,muteTiming:f})=>({url:`/api/v1/provisioning/mute-timings/${f}/export/`,params:{format:p},responseType:"text"}),keepUnusedDataFor:0})})})},91540:(G,R,e)=>{"use strict";e.d(R,{F:()=>a});var t=e(26272),n=e(28138),s=e(49962);const a=s.H.injectEndpoints({endpoints:r=>({getSilences:r.query({query:({datasourceUid:g,ruleMetadata:i,accessControl:l})=>({url:`/api/alertmanager/${g}/api/v2/silences`,params:{ruleMetadata:i,accesscontrol:l}}),providesTags:g=>g?[...g.map(({id:i})=>({type:"AlertmanagerSilences",id:i})),{type:"AlertmanagerSilences"}]:[{type:"AlertmanagerSilences"}]}),getSilence:r.query({query:({datasourceUid:g,id:i,ruleMetadata:l,accessControl:d})=>({url:`/api/alertmanager/${g}/api/v2/silence/${i}`,showErrorAlert:!1,params:{ruleMetadata:l,accesscontrol:d}}),providesTags:(g,i,{id:l})=>g?[{type:"AlertmanagerSilences",id:l}]:["AlertmanagerSilences"]}),createSilence:r.mutation({query:({datasourceUid:g,payload:i})=>({url:`/api/alertmanager/${g}/api/v2/silences`,method:"POST",data:i}),invalidatesTags:["AlertmanagerSilences","AlertmanagerAlerts"],onQueryStarted:async(g,{queryFulfilled:i})=>{try{await i,n.A.emit(t.r1.alertSuccess,["Silence created"])}catch{n.A.emit(t.r1.alertError,["Could not create silence"])}}}),expireSilence:r.mutation({query:({datasourceUid:g,silenceId:i})=>({url:`/api/alertmanager/${g}/api/v2/silence/${i}`,method:"DELETE"}),invalidatesTags:["AlertmanagerSilences"]})})})},49962:(G,R,e)=>{"use strict";e.d(R,{H:()=>h});var t=e(75816),n=e(10378),s=e(2543),a=e.n(s),r=e(75505),g=e(26272),i=e(17172),l=e(28138),d=e(25027);const c=()=>async({body:o,notificationOptions:m={},...u},p,f)=>{const{errorMessage:y,showErrorAlert:x,successMessage:v,showSuccessAlert:P}=m,{hideErrorMessage:E}=f||{};try{const D={...u,...o&&{data:o},...v&&{showSuccessAlert:!1},...(y||E)&&{showErrorAlert:!1}},C=performance.now(),{data:b,...T}=await(0,r.s)((0,i.AI)().fetch(D));return(0,d.l$)("backendSrvBaseQuery",{loadTimeMs:performance.now()-C},{url:u.url,method:u.method??"GET",responseStatus:T.statusText}),v&&P!==!1&&l.A.emit(g.r1.alertSuccess,[v]),{data:b,meta:T}}catch(D){return y&&x!==!1&&l.A.emit(g.r1.alertError,[y]),{error:D}}},h=(0,t.xP)({reducerPath:"alertingApi",baseQuery:c(),serializeQueryArgs:o=>(0,n.lE)((0,s.omit)(o,"queryArgs.notificationOptions")),tagTypes:["AlertingConfiguration","AlertmanagerConfiguration","AlertmanagerConnectionStatus","AlertmanagerAlerts","AlertmanagerSilences","OnCallIntegrations","DataSourceSettings","GrafanaLabels","CombinedAlertRule","GrafanaRulerRule","GrafanaSlo","RuleGroup","RuleNamespace","ContactPoint","ContactPointsStatus","Receiver"],endpoints:()=>({})})},32415:(G,R,e)=>{"use strict";e.d(R,{By:()=>c,VO:()=>d,WS:()=>r,f4:()=>l,nd:()=>i,vk:()=>g});var t=e(75505),n=e(39070),s=e(17172),a=e(57220);async function r(p){try{const f=await(0,t.s)((0,s.AI)().fetch({url:`/api/alertmanager/${(0,a.w5)(p)}/config/api/v1/alerts`,showErrorAlert:!1,showSuccessAlert:!1}));return{template_files:f.data.template_files??{},template_file_provenances:f.data.template_file_provenances??{},alertmanager_config:f.data.alertmanager_config??{},last_applied:f.data.last_applied,id:f.data.id}}catch(f){if(p===a.hY&&(0,s.NF)(f)&&f.data?.message?.includes("could not find an Alertmanager configuration"))return{template_files:{},alertmanager_config:{}};throw f}}async function g(p,f){await(0,t.s)((0,s.AI)().fetch({method:"POST",url:`/api/alertmanager/${(0,a.w5)(p)}/config/api/v1/alerts`,data:f,showErrorAlert:!1,showSuccessAlert:!1}))}async function i(p){await(0,t.s)((0,s.AI)().fetch({method:"DELETE",url:`/api/alertmanager/${(0,a.w5)(p)}/config/api/v1/alerts`,showErrorAlert:!1,showSuccessAlert:!1}))}async function l(p){return(await(0,t.s)((0,s.AI)().fetch({url:`/api/alertmanager/${(0,a.w5)(p)}/api/v2/alerts/groups`,showErrorAlert:!1,showSuccessAlert:!1}))).data}async function d(p){return(await(0,t.s)((0,s.AI)().fetch({url:`/api/alertmanager/${(0,a.w5)(p)}/api/v2/status`,showErrorAlert:!1,showSuccessAlert:!1}))).data}async function c(p,f,y){const x={receivers:f,alert:y};try{const v=await(0,t.s)((0,s.AI)().fetch({method:"POST",data:x,url:`/api/alertmanager/${(0,a.w5)(p)}/config/api/v1/receivers/test`,showErrorAlert:!1,showSuccessAlert:!1}));if(h(v.data))throw new Error(u(v.data))}catch(v){throw(0,s.NF)(v)&&o(v.data)&&h(v.data)?new Error(u(v.data)):v}}function h(p){return p.receivers.some(f=>f.grafana_managed_receiver_configs.some(y=>y.status==="failed"))}function o(p){return(0,n.Gv)(p)&&"receivers"in p&&Array.isArray(p.receivers)?p.receivers.every(m):!1}function m(p){return(0,n.Gv)(p)&&"name"in p&&typeof p.name=="string"&&"grafana_managed_receiver_configs"in p&&Array.isArray(p.grafana_managed_receiver_configs)}function u(p){return p.receivers.flatMap(f=>f.grafana_managed_receiver_configs.filter(y=>y.status==="failed").map(y=>y.error??"Unknown error.")).join("; ")}},82843:(G,R,e)=>{"use strict";e.d(R,{m:()=>p});var t=e(2543),n=e.n(t),s=e(99140),a=e(25027),r=e(98164),g=e(57220),i=e(78742),l=e(88467),d=e(49962),c=e(32415),h=e(77583);const o=30,m=30*1e3,u=["AlertingConfiguration","AlertmanagerConfiguration","AlertmanagerConnectionStatus","ContactPoint","ContactPointsStatus","Receiver"],p=d.H.injectEndpoints({endpoints:f=>({getAlertmanagerAlerts:f.query({query:({amSourceName:y,filter:x,showErrorAlert:v=!0})=>{const P=x?.matchers?.filter(O=>O.name&&O.value).map(O=>`${(0,i.Y9)(O.name)}${(0,r.MN)(O)}${(0,i.Y9)(O.value)}`),{silenced:E,inhibited:D,unprocessed:C,active:b}=x||{},T=Object.fromEntries(Object.entries({silenced:E,active:b,inhibited:D,unprocessed:C}).filter(([O,M])=>M!==void 0)),S={filter:P};return T&&Object.keys(T).forEach(O=>{S[O]=T[O]}),{url:`/api/alertmanager/${(0,g.w5)(y)}/api/v2/alerts`,params:S,showErrorAlert:v}},providesTags:["AlertmanagerAlerts"]}),getAlertmanagerAlertGroups:f.query({query:({amSourceName:y})=>({url:`/api/alertmanager/${(0,g.w5)(y)}/api/v2/alerts/groups`})}),grafanaNotifiers:f.query({query:()=>({url:"/api/alert-notifiers"})}),getGrafanaAlertingConfiguration:f.query({query:()=>({url:"/api/v1/ngalert/admin_config",showErrorAlert:!1}),providesTags:["AlertingConfiguration"]}),getGrafanaAlertingConfigurationStatus:f.query({query:()=>({url:"/api/v1/ngalert"}),providesTags:["AlertingConfiguration"]}),getExternalAlertmanagers:f.query({query:()=>({url:"/api/v1/ngalert/alertmanagers"}),transformResponse:y=>y.data,providesTags:["AlertmanagerConnectionStatus"]}),updateGrafanaAlertingConfiguration:f.mutation({query:y=>({url:"/api/v1/ngalert/admin_config",method:"POST",data:y,showSuccessAlert:!1}),invalidatesTags:[...u]}),getAlertmanagerConfigurationHistory:f.query({query:()=>({url:`/api/alertmanager/${(0,g.w5)(g.hY)}/config/history`,params:{limit:o}}),providesTags:["AlertmanagerConfiguration"]}),resetAlertmanagerConfigurationToOldVersion:f.mutation({query:y=>({url:`/api/alertmanager/${(0,g.w5)(g.hY)}/config/history/${y.id}/_activate`,method:"POST"}),invalidatesTags:["AlertmanagerConfiguration"]}),getAlertmanagerConfiguration:f.query({queryFn:async y=>{const x=y===g.hY;if((0,g.AL)(y))return(0,l.$I)((0,c.VO)(y).then(T=>({data:{alertmanager_config:T.config,template_files:{}}})));const{data:P}=await(0,s.JD)(h.L.endpoints.discoverAmFeatures.initiate({amSourceName:y})),E={alertmanager_config:{},template_files:{},template_file_provenances:{}},D=P?.lazyConfigInit??!1,C=(0,a.QA)("unifiedalerting/fetchAmConfig",c.WS,{dataSourceName:y,thunk:"unifiedalerting/fetchAmConfig"}),b=(0,i.i9)(()=>C(y),T=>!!(0,l.CZ)(T)?.includes("alertmanager storage object not found")&&!D,m).then(T=>x?T:(0,t.isEmpty)(T.alertmanager_config)&&(0,t.isEmpty)(T.template_files)?(0,c.VO)(y).then(O=>({alertmanager_config:O.config,template_files:{},template_file_provenances:T.template_file_provenances,last_applied:T.last_applied,id:T.id})):T).then(T=>T??E).then(T=>({data:T})).catch(T=>{if(D&&(0,l.CZ)(T)?.includes("alertmanager storage object not found"))return{data:E};throw T});return(0,l.$I)(b).catch(T=>({error:T,data:void 0}))},providesTags:["AlertmanagerConfiguration"]}),updateAlertmanagerConfiguration:f.mutation({query:({selectedAlertmanager:y,config:x})=>({url:`/api/alertmanager/${(0,g.w5)(y)}/config/api/v1/alerts`,method:"POST",data:x,showSuccessAlert:!1}),invalidatesTags:["AlertmanagerConfiguration","ContactPoint","ContactPointsStatus","Receiver"]}),getContactPointsStatus:f.query({query:()=>({url:`/api/alertmanager/${(0,g.w5)(g.hY)}/config/api/v1/receivers`}),transformResponse:y=>{const x=v=>v.startsWith("0001-01-01");return y.map(v=>({...v,integrations:v.integrations.map(P=>{const E=x(P.lastNotifyAttempt);return{...P,lastNotifyAttempt:E?"":P.lastNotifyAttempt,lastNotifyAttemptDuration:E?"":P.lastNotifyAttemptDuration}})}))},providesTags:["ContactPointsStatus"]}),getContactPointsList:f.query({query:()=>({url:"/api/v1/notifications/receivers"}),providesTags:["ContactPoint"]}),getMuteTimingList:f.query({query:()=>({url:"/api/v1/notifications/time-intervals"}),providesTags:["AlertmanagerConfiguration"]})})})},92240:(G,R,e)=>{"use strict";e.d(R,{O5:()=>h,_y:()=>c,nD:()=>l});var t=e(75505),n=e(17172),s=e(94822),a=e(55740),r=e(57220),g=e(49498),i=e(28220);async function l(y){if(y===r.hY)return{features:{rulerApiEnabled:!0}};const x=(0,r.oh)(y);if(!x)throw new Error(`Cannot find data source configuration for ${y}`);const{url:v,name:P,type:E}=x;if(!v)throw new Error("The data source url cannot be empty.");if(E!=="prometheus"&&E!=="loki")throw new Error(`The build info request is not available for ${E}. Only 'prometheus' and 'loki' are supported`);return d({name:P,url:v,type:E})}async function d(y){const{url:x,name:v,type:P}=y,E=P==="loki"?void 0:await m(x);if(!(E!==void 0)){if(!await u(v))throw new Error(`Unable to fetch alert rules. Is the ${v} data source properly configured?`);const T=await p(v);return{application:s.N1.Cortex,features:{rulerApiEnabled:T}}}const{features:C}=E.data;return C?{application:s.N1.Mimir,features:{rulerApiEnabled:C?.ruler_config_api==="true"}}:{application:s.N1.Prometheus,features:{rulerApiEnabled:!1}}}async function c(y){if(y===r.hY)return{lazyConfigInit:!1};const x=o(y),{url:v,type:P}=x;if(!v)throw new Error("The data source url cannot be empty.");if(P!=="alertmanager")throw new Error(`Alertmanager feature discovery is not available for ${P}. Only 'alertmanager' type is supported`);return await h(v)}async function h(y){try{return{lazyConfigInit:(await m(y))?.data?.application==="Grafana Mimir"}}catch{return{lazyConfigInit:!1}}}function o(y){const x=(0,r.oh)(y);if(!x)throw new Error(`Cannot find data source configuration for ${y}`);return x}async function m(y){return(await(0,t.s)((0,n.AI)().fetch({url:`${y}/api/v1/status/buildinfo`,showErrorAlert:!1,showSuccessAlert:!1})).catch(v=>{if(!("status"in v&&v.status===404))throw v}))?.data}async function u(y){try{return await(0,g.sA)(y),!0}catch{return!1}}async function p(y){try{return await(0,i.Zp)(y),!0}catch(x){if(f(x))return!1;throw x}}function f(y){return(0,n.NF)(y)?y.data.message?.includes("GetRuleGroup unsupported in rule local store")||y.data.message?.includes("page not found")||y.data.message?.includes(a.UU):y instanceof Error&&y.message?.includes("404 from rules config endpoint")}},77583:(G,R,e)=>{"use strict";e.d(R,{L:()=>i,b:()=>g});var t=e(94822),n=e(25027),s=e(57220),a=e(49962),r=e(92240);const g={dataSourceName:"grafana",apiVersion:"legacy"},i=a.H.injectEndpoints({endpoints:l=>({discoverAmFeatures:l.query({queryFn:async({amSourceName:d})=>{try{return{data:await(0,r._y)(d)}}catch(c){return{error:c}}}}),discoverDsFeatures:l.query({queryFn:async({rulesSourceName:d})=>{if((0,s.z2)(d))return{data:{rulerConfig:g}};const c=(0,s.Jz)(d);if(!c)return{error:new Error(`Missing data source configuration for ${d}`)};const o=await(0,n.QA)("unifiedalerting/featureDiscoveryApi/discoverDsFeatures",r.nD,{dataSourceName:d,endpoint:"unifiedalerting/featureDiscoveryApi/discoverDsFeatures"})(c.name);return{data:{rulerConfig:o.features.rulerApiEnabled?{dataSourceName:c.name,apiVersion:o.application===t.N1.Cortex?"legacy":"config"}:void 0}}}})})})},26423:(G,R,e)=>{"use strict";e.d(R,{Pc:()=>r,WG:()=>i,uz:()=>c});var t=e(17172),n=e(37534),s=e(99494),a=e(49962);const r="grafana_alerting_v2",g=h=>`/api/plugins/${s.W.OnCall}/resources${h}`,i=a.H.injectEndpoints({endpoints:h=>({grafanaOnCallIntegrations:h.query({query:()=>({url:g("/alert_receive_channels/"),params:{filters:!0,integration:[n.FI,"legacy_grafana_alerting"],skip_pagination:!0},showErrorAlert:!1}),transformResponse:o=>l(o)?o.results:o,providesTags:["OnCallIntegrations"]}),validateIntegrationName:h.query({query:o=>({url:g("/alert_receive_channels/validate_name/"),params:{verbal_name:o},showErrorAlert:!1})}),createIntegration:h.mutation({query:o=>({url:g("/alert_receive_channels/"),data:o,method:"POST",showErrorAlert:!0}),invalidatesTags:["OnCallIntegrations"]}),features:h.query({query:()=>({url:g("/features/"),showErrorAlert:!1})}),onCallConfigChecks:h.query({query:()=>({url:g("/organization/config-checks/"),showErrorAlert:!1})})})});function l(h){return"results"in h&&Array.isArray(h.results)}const{useGrafanaOnCallIntegrationsQuery:d}=i;function c(h){return(0,t.NF)(h)&&"detail"in h.data}},49498:(G,R,e)=>{"use strict";e.d(R,{Dj:()=>d,Kw:()=>h,lH:()=>c,ou:()=>l,sA:()=>m});var t=e(75505),n=e(17172),s=e(25027),a=e(94822),r=e(57220),g=e(23662);function i(u){const{dataSourceName:p,limitAlerts:f,identifier:y}=u;return{rules:(x,v,P)=>{const E=new URLSearchParams;p===r.hY&&f&&E.set("limit_alerts",String(f)),y&&((0,g.Mj)(y)||(0,g.X4)(y))&&(E.set("file",y.namespace),E.set("rule_group",y.groupName));const C={...l(x),...Object.fromEntries(E)};return{url:`/api/prometheus/${(0,r.w5)(p)}/api/v1/rules`,params:d(C,v,P)}}}}function l(u){const p={};return u?.dashboardUID&&(p.dashboard_uid=u.dashboardUID,u?.panelId&&(p.panel_id=String(u.panelId))),p}function d(u,p,f){let y={...u};if(p?.length&&(y={...y,state:p}),f?.length){const x=f.map(v=>JSON.stringify(v));y={...y,matcher:x}}return y}const c=(u,p)=>{const f={};return u.forEach(y=>{y.rules.forEach(x=>{x.query=x.query||"",x.type===a.JS.Alerting&&(x.state||((0,s.fH)("prom rule with type=alerting is missing a state",{dataSourceName:p,ruleName:x.name}),x.state=a.cF.Inactive))}),f[y.file]?f[y.file].groups.push(y):f[y.file]={dataSourceName:p,name:y.file,groups:[y]}}),Object.values(f)},h=(u=[])=>u?.flatMap(p=>p.groups.flatMap(f=>o(f,p.name)));function o(u,p){return{name:u.name,file:p,rules:u.rules,interval:u.interval}}async function m(u,p,f,y,x,v){if(p?.dashboardUID&&u!==r.hY)throw new Error("Filtering by dashboard UID is only supported for Grafana Managed rules.");const{url:P,params:E}=i({dataSourceName:u,limitAlerts:f,identifier:v}).rules(p,x,y),D=await(0,t.s)((0,n.AI)().fetch({url:P,params:E,showErrorAlert:!1,showSuccessAlert:!1})).catch(C=>{throw"status"in C&&C.status===404?new Error("404 from rule state endpoint. Perhaps ruler API is not enabled?"):C});return c(D.data.data.groups,u)}},28220:(G,R,e)=>{"use strict";e.d(R,{$o:()=>c,HO:()=>f,Zp:()=>p,iy:()=>m});var t=e(75505),n=e(39070),s=e(17172),a=e(52487),r=e(55740),g=e(57220),i=e(49498);const l="QUERY_NAMESPACE",d="QUERY_GROUP";function c(E){const D=o(E),C=h(E),b=E.apiVersion==="legacy"?"cortex":"mimir";return{rules:T=>({path:D,params:{subtype:b,...(0,i.ou)(T)}}),namespace:T=>{const{namespace:S,searchParams:O}=C.namespace(T);return{path:`${D}/${encodeURIComponent(S)}`,params:{subtype:b,...O}}},namespaceGroup:(T,S)=>{const{namespace:O,searchParams:M}=C.namespace(T),{group:I,searchParams:L}=C.group(S);return{path:`${D}/${encodeURIComponent(O)}/${encodeURIComponent(I)}`,params:{subtype:b,...M,...L}}}}}function h(E){const D=E.dataSourceName===g.hY,C=b=>(0,a.Cl)(b)===!0?{group:d,searchParams:{group:b}}:{group:b,searchParams:{}};return D?{namespace:b=>({namespace:b,searchParams:{}}),group:C}:{namespace:b=>(0,a.Cl)(b)===!0?{namespace:l,searchParams:{namespace:b}}:{namespace:b,searchParams:{}},group:C}}function o(E){return`${`/api/ruler/${(0,g.w5)(E.dataSourceName)}`}/api/v1/rules`}async function m(E,D){if(D?.dashboardUID&&E.dataSourceName!==g.hY)throw new Error("Filtering by dashboard UID is only supported by Grafana.");const{path:C,params:b}=c(E).rules(D);return y(C,{},b)}async function u(E,D){const{path:C,params:b}=c(E).namespace(D);return(await y(C,{},b))[D]||[]}async function p(E){return y(`/api/ruler/${(0,g.w5)(E)}/api/v1/rules/test/test`,null)}async function f(E,D,C){const{path:b,params:T}=c(E).namespaceGroup(D,C);return y(b,null,T)}async function y(E,D,C){try{return(await(0,t.s)((0,s.AI)().fetch({url:E,showErrorAlert:!1,showSuccessAlert:!1,params:C}))).data}catch(b){if(!x(b))throw b;if(P(b))return D;throw v(b)?{...b,data:{...b.data,message:r.UU}}:b}}function x(E){if(!(0,n.Gv)(E))return!1;const D="data"in E&&E.data!==null&&E.data!==void 0;return"status"in E&&Number.isFinite(E.status)&&D}function v(E){return E.status===404||E.status===500&&E.data.message?.includes("unexpected content type from upstream. expected YAML, got text/html")}function P(E){return E.status===404&&(E.data.message?.includes("group does not exist")||E.data.message?.includes("no rule groups found"))}},53270:(G,R,e)=>{"use strict";e.d(R,{E:()=>s,R:()=>n});var t=e(17172);function n(a){if(s(a))return null;throw a}function s(a){return(0,t.NF)(a)&&a.status===404}},69087:(G,R,e)=>{"use strict";e.d(R,{m:()=>u});var t=e(74848),n=e(32196),s=e(2543),a=e.n(s),r=e(55127),g=e.n(r),i=e(96540),l=e(40845),d=e(55852),c=e(69613),h=e(8484),o=e(75214),m=e(8406);const u=({labels:y,commonLabels:x={},size:v,onClick:P})=>{const E=(0,l.of)(f,v),[D,C]=(0,i.useState)(!1),b=(0,s.chain)(y).toPairs().reject(o.w0).reject(([M])=>D?!1:M in x).value(),T=Object.keys(x).length,S=T>0,O=(0,h.t)("alert-labels.button.show.tooltip","Show common labels");return(0,t.jsxs)("div",{className:E.wrapper,role:"list","aria-label":"Labels",children:[b.map(([M,I])=>(0,t.jsx)(m.J,{size:v,label:M,value:I,color:p(M),onClick:P},M+I)),!D&&S&&(0,t.jsxs)(d.$n,{variant:"secondary",fill:"text",onClick:()=>C(!0),tooltip:O,tooltipPlacement:"top",size:"sm",children:["+",T," common ",g()("label",T)]}),D&&S&&(0,t.jsx)(d.$n,{variant:"secondary",fill:"text",onClick:()=>C(!1),tooltipPlacement:"top",size:"sm",children:(0,t.jsx)(h.x6,{i18nKey:"alert-labels.button.hide",children:"Hide common labels"})})]})};function p(y){return(0,c.MC)(y).color}const f=(y,x)=>({wrapper:(0,n.css)({display:"flex",flexWrap:"wrap",alignItems:"center",gap:x==="md"?y.spacing():y.spacing(.5)})})},37959:(G,R,e)=>{"use strict";e.d(R,{d:()=>P,y:()=>E});var t=e(74848),n=e(87586),s=e(21780),a=e(70383),r=e(32196),g=e(96540),i=e(40845),l=e(14186),d=e(90182),c=e(12681),h=e(57220);function o(b){return b.name===h.hY?"Grafana":b.name}const m=({disabled:b=!1})=>{const T=(0,i.of)(u),{selectedAlertmanager:S,availableAlertManagers:O,setSelectedAlertmanager:M}=(0,a.VI)(),I=(0,g.useMemo)(()=>O.map(j=>({label:o(j),value:j.name,imgUrl:j.imgUrl,meta:j.meta})),[O]),L=b||I.length===1,B=L?"Alertmanager":"Choose Alertmanager";return(0,t.jsx)(l.I,{className:T.field,label:B,disabled:L,"data-testid":"alertmanager-picker",children:(0,t.jsx)(d.l6,{"aria-label":B,width:29,className:"ds-picker select-container",backspaceRemovesValue:!1,onChange:j=>{j?.value&&M(j.value)},options:I,noOptionsMessage:"No datasources found",value:S,getOptionLabel:j=>j.label,components:{Option:p}})})},u=b=>({field:(0,r.css)({margin:0})}),p=b=>(0,t.jsx)(c.o5,{...b,renderOptionLabel:({label:T})=>(0,t.jsx)("div",{style:{whiteSpace:"pre-line"},children:T})});var f=e(42418);const y=()=>(0,t.jsx)(f.F,{title:"No Alertmanager found",severity:"warning",children:"We could not find any external Alertmanagers and you may not have access to the built-in Grafana Alertmanager."}),x=()=>(0,t.jsx)(f.F,{title:"Selected Alertmanager not found.",severity:"warning",children:"The selected Alertmanager no longer exists or you may not have permission to access it. You can select a different Alertmanager from the dropdown."}),v=({availableAlertManagers:b})=>{const T=b.length>0;return(0,t.jsx)("div",{children:T?(0,t.jsx)(x,{}):(0,t.jsx)(y,{})})},P=({children:b,isLoading:T,...S})=>(0,t.jsx)(s.YW,{...S,children:(0,t.jsx)(s.YW.Contents,{isLoading:T,children:b})}),E=({children:b,accessType:T,...S})=>{const O=D();return(0,t.jsx)(a.b9,{accessType:T,children:(0,t.jsx)(P,{...S,actions:(0,t.jsx)(m,{disabled:O}),children:(0,t.jsx)(C,{children:b})})})};function D(){const b=(0,n.A)();return["/edit","/new"].some(S=>b?.pathname?.includes(S))}const C=({children:b})=>{const{availableAlertManagers:T,selectedAlertmanager:S}=(0,a.VI)();return S?(0,t.jsx)(t.Fragment,{children:b}):(0,t.jsx)(v,{availableAlertManagers:T})}},71223:(G,R,e)=>{"use strict";e.d(R,{s:()=>h});var t=e(74848),n=e(32196),s=e(56034),a=e(40845),r=e(72109),g=e(55740),i=e(84396),l=e(16577),d=e(73750);const c=["message","description"],h=({annotationKey:u,value:p,valueLink:f})=>{const y=u,x=g.J3[y]?(0,t.jsx)(s.m,{content:u,placement:"top",theme:"info",children:(0,t.jsx)("span",{children:g.J3[y]})}):u;return(0,t.jsx)(i.X,{label:x,horizontal:!0,children:(0,t.jsx)(o,{annotationKey:u,value:p,valueLink:f})})},o=({annotationKey:u,value:p,valueLink:f})=>{const y=(0,a.of)(m),x=c.includes(u),v=p&&p.startsWith("http"),P=(0,t.jsx)(l.Y,{input:p,delimiter:["{{","}}"]});return f?(0,t.jsx)(r.Y,{href:f,external:!0,children:p}):x?(0,t.jsx)(d.L,{className:y.well,children:P}):v?(0,t.jsx)(r.Y,{href:p,external:!0,children:p}):(0,t.jsx)(t.Fragment,{children:P})},m=u=>({well:(0,n.css)({wordBreak:"break-word"})})},84396:(G,R,e)=>{"use strict";e.d(R,{X:()=>a});var t=e(74848),n=e(32196),s=e(40845);const a=({className:g,label:i,horizontal:l,children:d,childrenWrapperClassName:c})=>{const h=(0,s.of)(r);return(0,t.jsxs)("div",{className:(0,n.cx)(h.field,l?h.fieldHorizontal:h.fieldVertical,g),children:[(0,t.jsx)("div",{children:i}),(0,t.jsx)("div",{className:c,children:d})]})},r=g=>({fieldHorizontal:(0,n.css)({flexDirection:"row",[g.breakpoints.down("md")]:{flexDirection:"column"}}),fieldVertical:(0,n.css)({flexDirection:"column"}),field:(0,n.css)({display:"flex",margin:`${g.spacing(2)} 0`,"& > div:first-child":{width:"110px",paddingRight:g.spacing(1),fontSize:g.typography.size.sm,fontWeight:g.typography.fontWeightBold,lineHeight:1.8},"& > div:nth-child(2)":{flex:1,color:g.colors.text.secondary}})})},75591:(G,R,e)=>{"use strict";e.d(R,{E:()=>c});var t=e(74848),n=e(32196),s=e(96540),a=e(13544),r=e(40845),g=e(29158),i=e(19384),l=e(98439),d=e(22620);const c=({cols:o,items:m,isExpandable:u=!1,onCollapse:p,onExpand:f,isExpanded:y,renderExpandedContent:x,testIdGenerator:v,pagination:P,paginationStyles:E,renderPrefixCell:D,renderPrefixHeader:C,footerRow:b,dataTestId:T})=>{const S=(0,r.of)(d.H);if((p||f||y)&&!(p&&f&&y))throw new Error("either all of onCollapse, onExpand, isExpanded must be provided, or none");if((u||x)&&!(u&&x))throw new Error("either both isExpanded and renderExpandedContent must be provided, or neither");const O=(0,r.of)(h(o,u,!!C)),[M,I]=(0,s.useState)([]),L=U=>{y&&p&&f?y(U)?p(U):f(U):I(M.includes(U.id)?M.filter(F=>F!==U.id):[...M,U.id])},B=P?.itemsPerPage??m.length,{page:j,numberOfPages:A,onPageChange:K,pageItems:W}=(0,l.W)(m,1,B);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:O.container,"data-testid":T??"dynamic-table",children:[(0,t.jsxs)("div",{className:O.row,"data-testid":"header",children:[C&&C(),u&&(0,t.jsx)("div",{className:O.cell()}),o.map(U=>(0,t.jsx)("div",{className:O.cell(U.alignColumn),children:U.label},U.id))]}),W.map((U,F)=>{const V=y?y(U):M.includes(U.id);return(0,t.jsxs)("div",{className:O.row,"data-testid":v?.(U,F)??"row",children:[D&&D(U,F,m),u&&(0,t.jsx)("div",{className:(0,n.cx)(O.cell(),O.expandCell),children:(0,t.jsx)(g.K,{tooltip:`${V?"Collapse":"Expand"} row`,"data-testid":a.Tp.components.AlertRules.toggle,name:V?"angle-down":"angle-right",onClick:()=>L(U)})}),o.map(w=>(0,t.jsx)("div",{className:(0,n.cx)(O.cell(w.alignColumn),O.bodyCell,w.className),"data-column":w.label,children:w.renderCell(U,F)},`${U.id}-${w.id}`)),V&&x&&(0,t.jsx)("div",{className:O.expandedContentRow,"data-testid":a.Tp.components.AlertRules.expandedContent,children:x(U,F,m)})]},`${U.id}-${F}`)}),b&&(0,t.jsx)("div",{className:(0,n.cx)(O.row,O.footerRow),children:b})]}),P&&(0,t.jsx)(i.d,{className:(0,n.cx)(S,E),currentPage:j,numberOfPages:A,onNavigate:K,hideWhenSinglePage:!0})]})},h=(o,m,u)=>{const p=o.map(f=>f.size?typeof f.size=="number"?`${f.size}fr`:f.size:"auto");return m&&p.unshift("calc(1em + 16px)"),u&&p.unshift("0"),f=>({container:(0,n.css)({border:`1px solid ${f.colors.border.weak}`,borderRadius:f.shape.radius.default,color:f.colors.text.secondary}),row:(0,n.css)({display:"grid",gridTemplateColumns:p.join(" "),gridTemplateRows:"1fr auto","&:nth-child(2n + 1)":{backgroundColor:f.colors.background.secondary},"&:nth-child(2n)":{backgroundColor:f.colors.background.primary},[f.breakpoints.down("sm")]:{gridTemplateColumns:"auto 1fr",gridTemplateAreas:"left right",padding:`0 ${f.spacing(.5)}`,"&:first-child":{display:"none"},"& > *:first-child":{display:u?"none":void 0}}}),footerRow:(0,n.css)({display:"flex",padding:f.spacing(1)}),cell:y=>(0,n.css)({display:"flex",alignItems:"center",padding:f.spacing(1),justifyContent:y||"initial",[f.breakpoints.down("sm")]:{padding:`${f.spacing(1)} 0`,gridTemplateColumns:"1fr"}}),bodyCell:(0,n.css)({overflow:"hidden",[f.breakpoints.down("sm")]:{gridColumnEnd:"right",gridColumnStart:"right","&::before":{content:"attr(data-column)",display:"block",color:f.colors.text.primary}}}),expandCell:(0,n.css)({justifyContent:"center",[f.breakpoints.down("sm")]:{alignItems:"start",gridArea:"left"}}),expandedContentRow:(0,n.css)({gridColumnEnd:p.length+1,gridColumnStart:u?3:2,gridRow:2,padding:`0 ${f.spacing(3)} 0 ${f.spacing(1)}`,position:"relative",[f.breakpoints.down("sm")]:{gridColumnStart:2,borderTop:`1px solid ${f.colors.border.strong}`,gridRow:"auto",padding:`${f.spacing(1)} 0 0 0`}})})}},10562:(G,R,e)=>{"use strict";e.d(R,{B:()=>r});var t=e(74848),n=e(32196),s=e(40845),a=e(75591);const r=({renderExpandedContent:i,...l})=>{const d=(0,s.of)(g);return(0,t.jsx)(a.E,{renderExpandedContent:i?(c,h,o)=>(0,t.jsxs)(t.Fragment,{children:[h!==o.length-1&&(0,t.jsx)("div",{className:(0,n.cx)(d.contentGuideline,d.guideline)}),i(c,h,o)]}):void 0,renderPrefixHeader:()=>(0,t.jsx)("div",{className:d.relative,children:(0,t.jsx)("div",{className:(0,n.cx)(d.headerGuideline,d.guideline)})}),renderPrefixCell:(c,h,o)=>(0,t.jsxs)("div",{className:d.relative,children:[(0,t.jsx)("div",{className:(0,n.cx)(d.topGuideline,d.guideline)}),h!==o.length-1&&(0,t.jsx)("div",{className:(0,n.cx)(d.bottomGuideline,d.guideline)})]}),...l})},g=i=>({relative:(0,n.css)({position:"relative",height:"100%"}),guideline:(0,n.css)({left:"-19px",borderLeft:`1px solid ${i.colors.border.weak}`,position:"absolute",[i.breakpoints.down("md")]:{display:"none"}}),topGuideline:(0,n.css)({width:"18px",borderBottom:`1px solid ${i.colors.border.medium}`,top:0,bottom:"50%"}),bottomGuideline:(0,n.css)({top:"50%",bottom:0}),contentGuideline:(0,n.css)({top:0,bottom:0,left:"-49px !important"}),headerGuideline:(0,n.css)({top:"-17px",bottom:0})})},35108:(G,R,e)=>{"use strict";e.d(R,{B:()=>c});var t=e(74848),n=e(32196),s=e(46942),a=e.n(s),r=e(96540),g=e(40845),i=e(67061),l=e(95868),d=e(13840);const c=({children:o,header:m,content:u,footer:p,arrow:f,showAfter:y=300,wrapperClassName:x,disabled:v=!1,showOn:P="hover",...E})=>{const D=(0,r.useRef)(null),C=(0,g.of)(h);if(v)return o;const b=P==="hover",T=P==="click",S=(0,t.jsxs)(i.B,{direction:"column",gap:0,role:"tooltip",children:[m&&(0,t.jsx)("div",{className:C.card.header,children:m}),(0,t.jsx)("div",{className:C.card.body,children:u}),p&&(0,t.jsx)("div",{className:C.card.footer,children:p})]});return(0,t.jsx)(l.I,{content:S,hideAfter:100,children:(O,M,I)=>{const L={onClick:O},B={onMouseLeave:M,onMouseEnter:O},j={onBlur:M,onFocus:O};return(0,t.jsxs)(t.Fragment,{children:[D.current&&(0,t.jsx)(d.A,{...I,...E,wrapperClassName:a()(C.popover,x),referenceElement:D.current,renderArrow:f,...j,...b?B:{}}),(0,r.cloneElement)(o,{ref:D,onFocus:O,onBlur:M,tabIndex:0,...b?B:{},...T?L:{}})]})}})},h=o=>({popover:(0,n.css)({borderRadius:o.shape.radius.default,boxShadow:o.shadows.z3,background:o.colors.background.primary,border:`1px solid ${o.colors.border.weak}`}),card:{body:(0,n.css)({padding:o.spacing(1)}),header:(0,n.css)({padding:o.spacing(1),background:o.colors.background.secondary,borderBottom:`solid 1px ${o.colors.border.medium}`}),footer:(0,n.css)({padding:o.spacing(.5,1),background:o.colors.background.secondary,borderTop:`solid 1px ${o.colors.border.medium}`})}})},93810:(G,R,e)=>{"use strict";e.d(R,{A:()=>a});var t=e(74848),n=e(42418);const a=()=>(0,t.jsx)(n.F,{severity:"info",title:"Alert evaluation currently paused",children:"Notifications for this rule will not fire and no alert instances will be created until the rule is un-paused."})},8406:(G,R,e)=>{"use strict";e.d(R,{J:()=>l});var t=e(74848),n=e(32196),s=e(96540),a=e(84140),r=e(40845),g=e(67061),i=e(14578);const l=({label:c,value:h,icon:o,color:m,size:u="md",onClick:p})=>{const f=(0,r.of)(d,m,u),y=`${c}: ${h}`,x=c?.toString()??"",v=h?.toString()??"",P=(0,s.useMemo)(()=>(0,t.jsxs)(g.B,{direction:"row",gap:0,alignItems:"stretch",children:[(0,t.jsx)("div",{className:f.label,children:(0,t.jsxs)(g.B,{direction:"row",gap:.5,alignItems:"center",children:[o&&(0,t.jsx)(i.I,{name:o}),c&&(0,t.jsx)("span",{className:f.labelText,title:c.toString(),children:c??""})]})}),(0,t.jsx)("div",{className:f.value,title:h?.toString(),children:h??"-"})]}),[o,c,h,f]);return(0,t.jsx)("div",{className:f.wrapper,role:"listitem","aria-label":y,"data-testid":"label-value",children:p?(0,t.jsx)("div",{className:f.clickable,role:"button",tabIndex:0,onClick:()=>p(x,v),onKeyDown:E=>{E.key==="Enter"&&(p(x,v),E.preventDefault())},children:P},x+v):P})},d=(c,h,o)=>{const m=h??c.colors.secondary.main,u=c.isDark?(0,a.A)(m).lighten(5).toString():(0,a.A)(m).darken(5).toString(),p=c.isDark?(0,a.A)(m).darken(5).toString():(0,a.A)(m).lighten(5).toString(),f=h?a.A.mostReadable(m,["#000","#fff"]).toString():c.colors.text.primary;let y=c.spacing(.33,1);switch(o){case"sm":y=c.spacing(.2,.6);break;case"xs":y=c.spacing(0,.5);break;default:break}return{wrapper:(0,n.css)({color:f,fontSize:c.typography.bodySmall.fontSize,borderRadius:c.shape.borderRadius(2)}),labelText:(0,n.css)({whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"300px"}),label:(0,n.css)({display:"flex",alignItems:"center",color:"inherit",padding:y,background:m,border:`solid 1px ${u}`,borderTopLeftRadius:c.shape.borderRadius(2),borderBottomLeftRadius:c.shape.borderRadius(2)}),clickable:(0,n.css)({"&:hover":{opacity:.8,cursor:"pointer"}}),value:(0,n.css)({color:"inherit",padding:y,background:p,border:`solid 1px ${u}`,borderLeft:"none",borderTopRightRadius:c.shape.borderRadius(2),borderBottomRightRadius:c.shape.borderRadius(2),whiteSpace:"pre",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"300px"})}}},55196:(G,R,e)=>{"use strict";e.d(R,{P:()=>i});var t=e(74848),n=e(32196),s=e(40845),a=e(94753),r=e(67061),g=e(14578);const i=({children:d,icon:c,color:h="secondary",direction:o="row",...m})=>{const u=(0,s.of)(l),p=typeof m.onClick=="function",f=o==="row",y=f?"center":"flex-start",x=f?.5:0;return(0,t.jsx)("div",{className:(0,n.cx)({[u.interactive]:p}),...m,children:(0,t.jsx)(a.E,{variant:"bodySmall",color:h,children:(0,t.jsxs)(r.B,{direction:o,alignItems:y,gap:x,wrap:"wrap",children:[c&&(0,t.jsx)(g.I,{size:"xs",name:c}),d]})})})},l=()=>({interactive:(0,n.css)({cursor:"pointer"})})},90141:(G,R,e)=>{"use strict";e.d(R,{A:()=>i});var t=e(74848),n=e(96540),s=e(55852),a=e(67061),r=e(14578);const i=(0,n.forwardRef)(function(d,c){return(0,t.jsx)(s.$n,{variant:"secondary",size:"sm",type:"button","aria-label":"More",ref:c,...d,children:(0,t.jsxs)(a.B,{direction:"row",alignItems:"center",gap:0,children:["More ",(0,t.jsx)(r.I,{name:"angle-down"})]})})})},76156:(G,R,e)=>{"use strict";e.d(R,{h:()=>a});var t=e(74848),n=e(12210);const s=({children:r,plugin:g,loadingComponent:i,notInstalledFallback:l})=>{const{loading:d,installed:c}=usePluginBridge(g);return d?i??null:c?jsx(Fragment,{children:r}):l??null};function a(r,g,i){const l=new URLSearchParams(i).toString();return`/a/${r}${g}`+(l?"?"+l:"")}},48205:(G,R,e)=>{"use strict";e.d(R,{Yi:()=>i,hk:()=>g,rS:()=>l});var t=e(74848),n=e(42418),s=e(39938),a=e(56034),r=e(8484),g=(d=>(d.ContactPoint="contact point",d.Template="template",d.MuteTiming="mute timing",d.AlertRule="alert rule",d.RootNotificationPolicy="root notification policy",d))(g||{});const i=({resource:d,...c})=>(0,t.jsxs)(n.F,{title:`This ${d} cannot be edited through the UI`,severity:"info",...c,children:["This ",d," has been provisioned, that means it was created by config. Please contact your server admin to update this ",d,"."]}),l=({tooltip:d,provenance:c})=>{const h=(0,t.jsx)(s.E,{text:"Provisioned",color:"purple"});if(d){const o=(0,t.jsxs)(r.x6,{i18nKey:"alerting.provisioning.badge-tooltip-provenance",values:{provenance:c},children:["This resource has been provisioned via ",{provenance:c}," and cannot be edited through the UI"]}),m=(0,t.jsx)(r.x6,{i18nKey:"alerting.provisioning.badge-tooltip-standard",children:"This resource has been provisioned and cannot be edited through the UI"}),u=c?o:m;return(0,t.jsx)(a.m,{content:u,children:(0,t.jsx)("span",{children:h})})}return h}},82437:(G,R,e)=>{"use strict";e.d(R,{c:()=>a});var t=e(74848),n=e(94753),s=e(14578);const a=({namespace:r,group:g})=>g?(0,t.jsxs)(n.E,{element:"h3",variant:"body",children:[r," ",(0,t.jsx)(s.I,{name:"angle-right","aria-label":">"})," ",g]}):(0,t.jsx)(n.E,{element:"h3",variant:"body",children:r})},26058:(G,R,e)=>{"use strict";e.d(R,{h:()=>s});var t=e(74848),n=e(32196);const s=()=>(0,t.jsx)("span",{className:(0,n.css)({flex:1})})},65415:(G,R,e)=>{"use strict";e.d(R,{O:()=>r});var t=e(74848),n=e(32196),s=e(96540),a=e(40845);const r=(0,s.forwardRef)(({children:i,state:l,size:d="md",muted:c=!1},h)=>{const o=(0,a.of)(g);return(0,t.jsx)("span",{className:(0,n.cx)(o.common,o[l],o[d],{[o.muted]:c}),ref:h,children:i||l})});r.displayName="StateTag";const g=i=>({common:(0,n.css)({display:"inline-block",color:"white",borderRadius:i.shape.radius.default,fontSize:i.typography.size.sm,textTransform:"capitalize",lineHeight:"1.2",textAlign:"center",fontWeight:i.typography.fontWeightBold}),good:(0,n.css)({backgroundColor:i.colors.success.main,border:`solid 1px ${i.colors.success.main}`,color:i.colors.success.contrastText}),warning:(0,n.css)({backgroundColor:i.colors.warning.main,border:`solid 1px ${i.colors.warning.main}`,color:i.colors.warning.contrastText}),bad:(0,n.css)({backgroundColor:i.colors.error.main,border:`solid 1px ${i.colors.error.main}`,color:i.colors.error.contrastText}),neutral:(0,n.css)({backgroundColor:i.colors.secondary.main,border:`solid 1px ${i.colors.secondary.main}`,color:i.colors.secondary.contrastText}),info:(0,n.css)({backgroundColor:i.colors.primary.main,border:`solid 1px ${i.colors.primary.main}`,color:i.colors.primary.contrastText}),md:(0,n.css)({padding:i.spacing(.5,1),minWidth:i.spacing(8)}),sm:(0,n.css)({padding:i.spacing(.3,.5),minWidth:"52px"}),muted:(0,n.css)({opacity:"0.5"})})},16577:(G,R,e)=>{"use strict";e.d(R,{Y:()=>l});var t=e(74848),n=e(32196),s=e(40845),a=e(39938),r=e(35108),g=e(83225);const i=["$",".",'"'];function l({input:f,delimiter:y=["{{","}}"]}){const x=(0,s.of)(p),[v,P]=y,E=new RegExp(`(?<before>.*?)(${v}(?<token>.*?)${P}|$)`,"gm"),D=f.split(`
`),C=[];return D.forEach((b,T)=>{Array.from(b.matchAll(E)).forEach((O,M)=>{const I=O.groups?.before,L=O.groups?.token?.trim();if(I&&C.push((0,t.jsx)("span",{children:I},`${T}-${M}-before`)),L){const B=u(L),j=B==="variable"?L:"",A=`${v} ${L} ${P}`;C.push((0,t.jsx)(c,{content:A,type:B,description:j},`${T}-${M}-token`))}}),C.push((0,t.jsx)("br",{},`${T}-newline`))}),(0,t.jsx)("span",{className:x.wrapper,children:C})}var d=(f=>(f.Variable="variable",f.Function="function",f.Keyword="keyword",f.Unknown="unknown",f))(d||{});function c({content:f,description:y,type:x}){const v=(0,s.of)(p),P=!x;return(0,t.jsx)(r.B,{placement:"top-start",disabled:P,content:(0,t.jsxs)("div",{className:v.hoverTokenItem,children:[(0,t.jsx)(a.E,{tabIndex:0,text:(0,t.jsx)(t.Fragment,{children:x}),color:"blue"})," ",y&&(0,t.jsx)("code",{children:y})]}),children:(0,t.jsx)("span",{children:(0,t.jsx)(a.E,{tabIndex:0,className:v.token,text:f,color:"blue"})})})}function h(f){return i.some(y=>f.startsWith(y))}function o(f){return g.keywords.some(y=>f.startsWith(y))}function m(f){return g.builtinFunctions.some(y=>f.startsWith(y))}function u(f){let y;return h(f)?y="variable":o(f)?y="keyword":m(f)?y="function":y="unknown",y}const p=f=>({wrapper:(0,n.css)({whiteSpace:"pre-wrap"}),token:(0,n.css)({cursor:"default",fontFamily:f.typography.fontFamilyMonospace}),popover:(0,n.css)({borderRadius:f.shape.radius.default,boxShadow:f.shadows.z3,background:f.colors.background.primary,border:`1px solid ${f.colors.border.medium}`,padding:f.spacing(1)}),hoverTokenItem:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center",gap:f.spacing(1)})})},73750:(G,R,e)=>{"use strict";e.d(R,{L:()=>a});var t=e(74848),n=e(32196),s=e(40845);const a=({children:g,className:i})=>{const l=(0,s.of)(r);return(0,t.jsx)("div",{className:(0,n.cx)(l.wrapper,i),children:g})},r=g=>({wrapper:(0,n.css)({backgroundColor:g.components.panel.background,border:`solid 1px ${g.components.input.borderColor}`,borderRadius:g.shape.radius.default,padding:g.spacing(.5,1),fontFamily:g.typography.fontFamilyMonospace})})},96636:(G,R,e)=>{"use strict";e.d(R,{d:()=>s});var t=e(96540),n=e(14778);const s=({component:a,title:r="previous page"})=>{const g=(0,n.i)(),i=(0,t.useCallback)(()=>{g(r)},[g,r]);return(0,t.cloneElement)(a,{onClick:i})}},53876:(G,R,e)=>{"use strict";e.d(R,{X:()=>u});var t=e(74848),n=e(32196),s=e(96540),a=e(40996),r=e(40845),g=e(14578),i=e(88575),l=e(60029),d=e(67061),c=e(56034),h=e(10354),o=e(25027),m=e(32642);const u=({onFilterChange:f,defaultQueryString:y})=>{const x=(0,r.of)(p),[v,P]=(0,s.useState)(y??"");(0,a.A)(()=>{(0,o.fH)(o.le.filterByLabel),f(v)},600,[v]);const E=(0,t.jsx)(g.I,{name:"search"});let D=!!(y&&y.length>=3);try{y?(0,m.S6)(y):D=!0}catch{D=!1}return(0,t.jsx)(i.D,{className:x.fixMargin,invalid:!D,error:D?null:"Query must use valid matcher syntax. See the examples in the help tooltip.",label:(0,t.jsx)(l.J,{children:(0,t.jsxs)(d.B,{gap:.5,alignItems:"center",children:[(0,t.jsx)("span",{children:"Search by label"}),(0,t.jsx)(c.m,{content:(0,t.jsxs)("div",{children:["Filter alerts using label querying without spaces, ex:",(0,t.jsx)("pre",{children:'{severity="critical", instance=~"cluster-us-.+"}'}),"Invalid use of spaces:",(0,t.jsx)("pre",{children:'{severity= "critical"}'}),(0,t.jsx)("pre",{children:'{severity ="critical"}'}),"Valid use of spaces:",(0,t.jsx)("pre",{children:'{severity=" critical"}'}),"Filter alerts using label querying without braces, ex:",(0,t.jsx)("pre",{children:'severity="critical", instance=~"cluster-us-.+"'})]}),children:(0,t.jsx)(g.I,{name:"info-circle",size:"sm"})})]})}),children:(0,t.jsx)(h.p,{placeholder:"Search",value:v,onChange:C=>P(C.currentTarget.value),"data-testid":"search-query-input",prefix:E,className:x.inputWidth})})},p=f=>({fixMargin:(0,n.css)({marginBottom:0}),inputWidth:(0,n.css)({width:340,flexGrow:0})})},99085:(G,R,e)=>{"use strict";e.d(R,{t:()=>s,w:()=>a});var t=e(31678);const n=[t.AccessControlAction.AlertingReceiversRead],s=[t.AccessControlAction.AlertingReceiversCreate,t.AccessControlAction.AlertingReceiversWrite],a=[...n,...s]},56528:(G,R,e)=>{"use strict";e.d(R,{GX:()=>j,r4:()=>L});var t=e(74848),n=e(32196),s=e(2543),a=e.n(s),r=e(96540),g=e(49785),i=e(39070),l=e(19845),d=e(72724),c=e(40845),h=e(42418),o=e(67061),m=e(55852),u=e(51440),p=e(29158),f=e(98808),y=e(71680),x=e(1712),v=e(34263),P=e(18225),E=e(76658),D=e(66718),C=e(94822),b=e(98439),T=e(35108),S=e(26058),O=e(30423),M=e(81875),I=e(99106);const L=({queries:w=[],query:z,data:N,error:H,warning:Q,isAlertCondition:X,onSetCondition:ee,onUpdateRefId:Z,onRemoveExpression:q,onUpdateExpressionType:ae,onChangeQuery:k})=>{const se=(0,c.of)(V),te=z?.type,{setError:ne,clearErrors:le}=(0,g.xW)(),re=(0,r.useCallback)(ye=>{ye?ne("queries",{type:"custom",message:ye}):le("queries")},[ne,le]),de=N&&Object.values(N).some(ye=>!!ye&&ye.state===i.Gu.Loading),oe=Array.isArray(N?.series)&&!de,J=N?.series??[],ce=X??!1,{seriesCount:pe,groupedByState:xe}=K(J),fe=(0,r.useCallback)(ye=>{const Ve=w.filter(Me=>ye.refId!==Me.refId).map(Me=>({value:Me.refId,label:Me.refId}));switch(ye.type){case D.Tz.math:return(0,t.jsx)(y.z,{onChange:k,query:ye,labelWidth:"auto",onRunQuery:()=>{}});case D.Tz.reduce:return(0,t.jsx)(x.Z,{onChange:k,refIds:Ve,labelWidth:"auto",query:ye});case D.Tz.resample:return(0,t.jsx)(v.C,{onChange:k,query:ye,labelWidth:"auto",refIds:Ve});case D.Tz.classic:return(0,t.jsx)(f.z,{onChange:k,query:ye,refIds:Ve});case D.Tz.threshold:return(0,t.jsx)(E.O,{onChange:k,query:ye,labelWidth:"auto",refIds:Ve,onError:re,useHysteresis:!0});case D.Tz.sql:return(0,t.jsx)(P.k,{onChange:k,query:ye,refIds:Ve});default:return(0,t.jsxs)(t.Fragment,{children:["Expression not supported: ",ye.type]})}},[k,w,re]),Se=D.uQ.find(ye=>ye.value===te)?.description??"";return(0,t.jsx)("div",{className:(0,n.cx)(se.expression.wrapper,ce&&se.expression.alertCondition,te===D.Tz.classic&&se.expression.classic,te!==D.Tz.classic&&se.expression.nonClassic),children:(0,t.jsxs)("div",{className:se.expression.stack,children:[(0,t.jsx)(W,{refId:z.refId,queryType:te,onRemoveExpression:()=>q(z.refId),onUpdateRefId:ye=>Z(z.refId,ye),onSetCondition:ee,query:z,alertCondition:ce}),(0,t.jsxs)("div",{className:se.expression.body,children:[H&&(0,t.jsx)(h.F,{title:"Expression failed",severity:"error",children:H.message}),Q&&(0,t.jsx)(h.F,{title:"Expression warning",severity:"warning",children:Q.message}),(0,t.jsx)("div",{className:se.expression.description,children:Se}),fe(z)]}),oe&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(j,{series:J,isAlertCondition:X}),(0,t.jsx)("div",{className:se.footer,children:(0,t.jsxs)(o.B,{direction:"row",alignItems:"center",children:[(0,t.jsx)(S.h,{}),(0,t.jsx)(A,{isCondition:!!X,firing:xe[C.cF.Firing].length,normal:xe[C.cF.Inactive].length,seriesCount:pe})]})})]})]})})},B=20,j=({series:w,isAlertCondition:z})=>{const{pageItems:N,previousPage:H,nextPage:Q,numberOfPages:X,pageStart:ee,pageEnd:Z}=(0,b.W)(w,1,B),q=(0,c.of)(V),ae=(0,I.PI)(w),k=!ae&&(0,l.jq)(w),se=X>1;return(0,t.jsxs)("div",{className:q.expression.results,children:[!ae&&k&&(0,t.jsx)("div",{children:N.map((te,ne)=>(0,t.jsx)(F,{frame:te,index:ee+ne,isAlertCondition:z},(0,s.uniqueId)()))}),!ae&&!k&&N.map((te,ne)=>(0,t.jsx)(U,{frame:te,index:ee+ne,isAlertCondition:z},(0,s.uniqueId)())),ae&&(0,t.jsx)("div",{className:(0,n.cx)(q.expression.noData,q.mutedText),children:"No data"}),se&&(0,t.jsx)("div",{className:q.pagination.wrapper,"data-testid":"paginate-expression",children:(0,t.jsxs)(o.B,{children:[(0,t.jsx)(m.$n,{variant:"secondary",fill:"outline",onClick:H,icon:"angle-left",size:"sm","aria-label":"previous-page"}),(0,t.jsx)(S.h,{}),(0,t.jsxs)("span",{className:q.mutedText,children:[ee," - ",Z," of ",w.length]}),(0,t.jsx)(S.h,{}),(0,t.jsx)(m.$n,{variant:"secondary",fill:"outline",onClick:Q,icon:"angle-right",size:"sm","aria-label":"next-page"})]})})]})},A=({firing:w,normal:z,isCondition:N,seriesCount:H})=>{const{mutedText:Q}=(0,c.of)(V);return H===0?(0,t.jsx)("span",{className:Q,children:"No series"}):N?(0,t.jsx)("span",{className:Q,children:`${H} series: ${w} firing, ${z} normal`}):(0,t.jsx)("span",{className:Q,children:`${H} series`})};function K(w){const z=w.filter(Q=>(0,I.Lm)(Q)===void 0).length,N={[C.cF.Firing]:w.filter(Q=>(0,I.Lm)(Q)!==void 0&&(0,I.Lm)(Q)!==0),[C.cF.Inactive]:w.filter(Q=>(0,I.Lm)(Q)===0)},H=w.length-z;return{groupedByState:N,seriesCount:H}}const W=({refId:w,queryType:z,onUpdateRefId:N,onRemoveExpression:H,onSetCondition:Q,alertCondition:X,query:ee})=>{const Z=(0,c.of)(V),q=(0,c.of)(m.my),[ae,k]=(0,r.useState)(!1),te=ae!==!1&&ae==="refId";return(0,t.jsx)("header",{className:Z.header.wrapper,children:(0,t.jsxs)(o.B,{direction:"row",gap:.5,alignItems:"center",children:[(0,t.jsxs)(o.B,{direction:"row",gap:1,alignItems:"center",children:[!te&&(0,t.jsx)("button",{type:"button",className:(0,n.cx)(q,Z.editable),onClick:()=>k("refId"),children:(0,t.jsx)("div",{className:Z.expression.refId,children:w})}),te&&(0,t.jsx)(u.D,{autoFocus:!0,defaultValue:w,minWidth:5,onChange:ne=>{N(ne.currentTarget.value),k(!1)},onFocus:ne=>ne.target.select(),onBlur:ne=>{N(ne.currentTarget.value),k(!1)}}),(0,t.jsx)("div",{children:(0,D.NI)(z)})]}),(0,t.jsx)(S.h,{}),(0,t.jsx)(M.a,{onSetCondition:()=>Q(ee.refId),isCondition:X}),(0,t.jsx)(p.K,{name:"trash-alt",variant:"secondary",className:Z.mutedIcon,onClick:H,tooltip:"Remove expression"})]})})},U=({frame:w,index:z,isAlertCondition:N})=>{const H=(0,c.of)(V),Q=(0,I.Jw)(w)||"Series "+z,X=(0,I.Lm)(w),ee=(0,I.JQ)(w),Z=Object.entries(ee),q=Z.length>0,ae=N&&X!==0,k=N&&X===0,se=`${q?"":Q}${q?`{${(0,I.h6)(ee)}}`:""}`;return(0,t.jsx)("div",{className:H.expression.resultsRow,children:(0,t.jsxs)(o.B,{direction:"row",gap:1,alignItems:"center",children:[(0,t.jsxs)("div",{className:H.expression.resultLabel,title:se,children:[(0,t.jsx)("span",{children:q?"":Q}),q&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{children:"{"}),Z.map(([te,ne],le)=>(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{className:H.expression.labelKey,children:te}),(0,t.jsx)("span",{children:"="}),(0,t.jsx)("span",{children:'"'}),(0,t.jsx)("span",{className:H.expression.labelValue,children:ne}),(0,t.jsx)("span",{children:'"'}),le<Z.length-1&&(0,t.jsx)("span",{children:", "})]},(0,s.uniqueId)())),(0,t.jsx)("span",{children:"}"})]})]}),(0,t.jsx)("div",{className:H.expression.resultValue,children:X}),ae&&(0,t.jsx)(O.C,{state:C.cF.Firing,size:"sm"}),k&&(0,t.jsx)(O.C,{state:C.cF.Inactive,size:"sm"})]})})},F=({frame:w,index:z})=>{const N=(0,c.of)(V),H=w.fields[1],Q=H.labels,ee=H.config?.displayNameFromDS??(Q?(0,I.h6)(H.labels??{}):"Series "+z),Z=w.fields[0].values,q=k=>w.fields[0].values[k],ae=k=>w.fields[1].values[k];return(0,t.jsx)("div",{className:N.expression.resultsRow,children:(0,t.jsxs)(o.B,{direction:"row",alignItems:"center",children:[(0,t.jsx)("span",{className:(0,n.cx)(N.mutedText,N.expression.resultLabel),title:ee,children:ee}),(0,t.jsx)("div",{className:N.expression.resultValue,children:(0,t.jsx)(T.B,{placement:"right",wrapperClassName:N.timeseriesTableWrapper,content:(0,t.jsxs)("table",{className:N.timeseriesTable,children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Timestamp"}),(0,t.jsx)("th",{children:"Value"})]})}),(0,t.jsx)("tbody",{children:Z.map((k,se)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:N.mutedText,children:(0,d.LE)(q(se))}),(0,t.jsx)("td",{className:N.expression.resultValue,children:ae(se)})]},se))})]}),children:(0,t.jsx)("span",{children:"Time series data"})})})]})})},V=w=>({expression:{wrapper:(0,n.css)({display:"flex",border:`solid 1px ${w.colors.border.medium}`,flex:1,flexBasis:"400px",borderRadius:w.shape.radius.default}),stack:(0,n.css)({display:"flex",flexDirection:"column",flexWrap:"nowrap",gap:0,width:"100%",minWidth:"0"}),classic:(0,n.css)({maxWidth:"100%"}),nonClassic:(0,n.css)({maxWidth:"640px"}),alertCondition:(0,n.css)({}),body:(0,n.css)({padding:w.spacing(1),flex:1}),description:(0,n.css)({marginBottom:w.spacing(1),fontSize:w.typography.size.xs,color:w.colors.text.secondary}),refId:(0,n.css)({fontWeight:w.typography.fontWeightBold,color:w.colors.primary.text}),results:(0,n.css)({display:"flex",flexDirection:"column",flexWrap:"nowrap",borderTop:`solid 1px ${w.colors.border.medium}`}),noResults:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"center"}),resultsRow:(0,n.css)({padding:`${w.spacing(.75)} ${w.spacing(1)}`,"&:nth-child(odd)":{backgroundColor:w.colors.background.secondary},"&:hover":{backgroundColor:w.colors.background.canvas}}),labelKey:(0,n.css)({color:w.isDark?"#73bf69":"#56a64b"}),labelValue:(0,n.css)({color:w.isDark?"#ce9178":"#a31515"}),resultValue:(0,n.css)({textAlign:"right"}),resultLabel:(0,n.css)({flex:1,overflowX:"auto",display:"inline-block",whiteSpace:"nowrap"}),noData:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:w.spacing()})},mutedText:(0,n.css)({color:w.colors.text.secondary,fontSize:"0.9em",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}),header:{wrapper:(0,n.css)({background:w.colors.background.secondary,padding:`${w.spacing(.5)} ${w.spacing(1)}`,borderBottom:`solid 1px ${w.colors.border.weak}`})},footer:(0,n.css)({background:w.colors.background.secondary,padding:w.spacing(1),borderTop:`solid 1px ${w.colors.border.weak}`}),draggableIcon:(0,n.css)({cursor:"grab"}),mutedIcon:(0,n.css)({color:w.colors.text.secondary}),editable:(0,n.css)({padding:`${w.spacing(.5)} ${w.spacing(1)}`,border:`solid 1px ${w.colors.border.weak}`,borderRadius:w.shape.radius.default,display:"flex",flexDirection:"row",alignItems:"center",gap:w.spacing(1),cursor:"pointer"}),timeseriesTableWrapper:(0,n.css)({maxHeight:"500px",overflowY:"scroll"}),timeseriesTable:(0,n.css)({tableLayout:"auto",width:"100%",height:"100%","td, th":{padding:w.spacing(1)},td:{background:w.colors.background.primary},th:{background:w.colors.background.secondary},tr:{borderBottom:`1px solid ${w.colors.border.medium}`,"&:last-of-type":{borderBottom:"none"}}}),pagination:{wrapper:(0,n.css)({borderTop:`1px solid ${w.colors.border.medium}`,padding:w.spacing()})}})},81875:(G,R,e)=>{"use strict";e.d(R,{a:()=>g});var t=e(74848),n=e(32196),s=e(40845),a=e(39938),r=e(55852);const g=({isCondition:l,onSetCondition:d})=>{const c=(0,s.of)(i);return l?(0,t.jsx)(a.E,{color:"green",icon:"check",text:"Alert condition"},"condition"):(0,t.jsx)("button",{type:"button",className:c.actionLink,onClick:()=>d&&d(),children:"Set as alert condition"},"make-condition")},i=l=>{const d=(0,r.my)(l);return{actionLink:(0,n.css)(d,{color:l.colors.text.link,cursor:"pointer","&:hover":{textDecoration:"underline"}})}}},99106:(G,R,e)=>{"use strict";e.d(R,{EL:()=>d,JQ:()=>i,Jw:()=>r,Lm:()=>g,PI:()=>h,h6:()=>l,wf:()=>c});var t=e(2543),n=e.n(t),s=e(97706),a=e(57220);const r=o=>{const m=o.fields[0];return m?.config?.displayNameFromDS??o.name??m?.labels?.__name__},g=o=>{const m=o.fields[0]?.values[0];return Number.isFinite(m)?(0,s.h)(m,5):m},i=o=>o.fields[0]?.labels??{},l=o=>Object.entries(o).map(([m,u])=>m+"="+u).join(", "),d=o=>{const m=o.name;if((0,a.Eb)(o.rulesSource))return{name:m,parents:[]};try{const u=JSON.parse(m);if(!Array.isArray(u))throw new Error("not a nested Grafana folder");const p=(0,t.last)(u)??m,f=(0,t.dropRight)(u,1);return{name:p,parents:f}}catch{return{name:o.name,parents:[]}}},c=(o,m=[])=>JSON.stringify(m.concat(o)),h=o=>o.every(u=>u.fields.every(p=>p.values.every(f=>f==null)))},83225:(G,R,e)=>{"use strict";e.r(R),e.d(R,{AlertmanagerTemplateFunction:()=>n,availableAlertManagerFunctions:()=>s,builtinFunctions:()=>r,conf:()=>l,keywords:()=>g,language:()=>i});var t=(d=>(d.Delimiter="delimiter",d.Keyword="keyword",d.Function="type.identifier",d.String="string",d.Variable="variable.name",d.Number="number",d.Comment="comment",d.Operator="operator",d.Identifier="idenfifier",d))(t||{}),n=(d=>(d.toUpper="toUpper",d.toLower="toLower",d.title="title",d.join="join",d.match="match",d.safeHtml="safeHtml",d.reReplaceAll="reReplaceAll",d.stringSlice="stringSlice",d))(n||{});const s=Object.values(n),r=["and","call","html","index","slice","js","len","not","or","print","printf","println","urlquery",...["eq","ne","lt","le","gt","ge"]],g=["define","if","else","end","range","break","continue","template","block","with"],i={defaultToken:"",keywords:g,functions:[...r,...s],operators:["|"],tokenizer:{root:[[/"/,"string","@string"],[/`/,"string","@rawstring"],[/\d*\d+[eE]([\-+]?\d+)?/,"number.float"],[/\d*\.\d+([eE][\-+]?\d+)?/,"number.float"],[/0[xX][0-9a-fA-F']*[0-9a-fA-F]/,"number.hex"],[/0[0-7']*[0-7]/,"number.octal"],[/0[bB][0-1']*[0-1]/,"number.binary"],[/\d[\d']*/,"number"],[/\d/,"number"],[/[;,.]/,"delimiter"],[/{{-?/,"delimiter"],[/-?}}/,"delimiter"],[/\.([A-Za-z]+)?/,"variable.name"],[/[a-zA-Z_]\w*/,{cases:{"@keywords":{token:"keyword"},"@functions":{token:"type.identifier"},"@default":"idenfifier"}}],[/\/\*.*\*\//,"comment"]],string:[[/[^\\"]+/,"string"],[/\\./,"string.escape.invalid"],[/"/,"string","@pop"]],rawstring:[[/[^\`]/,"string"],[/`/,"string","@pop"]]}},l={comments:{blockComment:["/*","*/"]},brackets:[["{{","}}"],["(",")"]],autoClosingPairs:[{open:"{{",close:"}}"},{open:"(",close:")"},{open:"`",close:"`"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{{",close:"}}"},{open:"(",close:")"},{open:"`",close:"`"},{open:'"',close:'"'},{open:"'",close:"'"}]}},37534:(G,R,e)=>{"use strict";e.d(R,{FI:()=>t,J4:()=>n});const t="grafana_alerting";var n=(r=>(r.OnCall="oncall",r))(n||{});const s=(r,g)=>g.includes(r),a=(r,g)=>{if(!r.grafana_managed_receiver_configs)return!1;const i=r.grafana_managed_receiver_configs.length===1,l=s(r.grafana_managed_receiver_configs[0]?.settings?.url??"",g.map(d=>d.integration_url));return i&&l}},74685:(G,R,e)=>{"use strict";e.d(R,{j:()=>c});var t=e(74848),n=e(32196),s=e(70713),a=e(19845),r=e(40845),g=e(28138),i=e(72519),l=e(56528),d=e(52487);const c=({data:o,thresholds:m,thresholdsType:u})=>{const p=(0,r.of)(h),f=(0,a.jq)(o.series),y=(0,d.yW)(o),x=u?{mode:u}:void 0;return(0,t.jsx)("div",{className:p.wrapper,children:(0,t.jsx)(s.Ay,{disableHeight:!0,children:({width:v})=>(0,t.jsx)("div",{style:{width:v},children:f?(0,t.jsx)(i.y,{statusMessage:y,data:o.series,eventBus:g.A,height:300,width:v,timeRange:o.timeRange,timeZone:"browser",onChangeTime:()=>{},splitOpenFn:()=>{},loadingState:o.state,thresholdsConfig:m,thresholdsStyle:x}):(0,t.jsxs)("div",{className:p.instantVectorResultWrapper,children:[(0,t.jsx)("header",{className:p.title,children:"Table"}),(0,t.jsx)(l.GX,{series:o.series})]})})})})},h=o=>({wrapper:(0,n.css)({width:"100%",position:"relative"}),instantVectorResultWrapper:(0,n.css)({border:`solid 1px ${o.colors.border.medium}`,borderRadius:o.shape.radius.default,padding:0,display:"flex",flexDirection:"column",flexWrap:"nowrap"}),title:(0,n.css)({label:"panel-title",padding:o.spacing(),textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontSize:o.typography.h6.fontSize,fontWeight:o.typography.h6.fontWeight})})},36795:(G,R,e)=>{"use strict";e.d(R,{qQ:()=>d,vL:()=>g});var t=e(2543),n=e.n(t),s=e(41811),a=e(34525),r=e(69437);const g=(0,s.A)(i,(m,u)=>o(m[0])===o(u[0]));function i(m){const u=new a.TS,p=m.map(f=>f.refId);return u.createNodes(p),m.forEach(f=>{const y=f.refId;((0,r.f)(f.model)&&f.model.type==="math"?l(f.model.expression??""):[f.model.expression]).forEach(P=>{y&&P&&!(y===P)&&u.link(P,y)})}),u}function l(m){const u=new RegExp(/\$\{(?<var>[a-zA-Z0-9_ ]+?)\}/gm),p=new RegExp(/\$(?<var>[a-zA-Z0-9_]+)/gm),f=Array.from(m.matchAll(u)).map(x=>x.groups?.var),y=Array.from(m.matchAll(p)).map(x=>x.groups?.var);return(0,t.compact)((0,t.uniq)([...f,...y]))}const d=(0,t.memoize)(c,(m,u)=>m+h(u));function c(m,u){const p=u.getNode(m),f=[];function y(x){const v=x.inputEdges;v.length>0?v.forEach(P=>{P.inputNode&&y(P.inputNode)}):f?.push(x)}return y(p),f.map(x=>x.name)}function h(m){return Object.keys(m.nodes).map(u=>{const p=m.nodes[u],f=p.outputEdges.map(x=>x.outputNode?.name).join(", "),y=p.inputEdges.map(x=>x.inputNode?.name).join(", ");return`${p.name}:${f}:${y}`}).join(" ")}function o(m){return m.map(u=>{const p=(0,r.f)(u.model)?u.model.type:u.queryType;return u.refId+(u.model.expression??"")+p}).join()}},52487:(G,R,e)=>{"use strict";e.d(R,{Cl:()=>f,I3:()=>m,YG:()=>b,_u:()=>C,an:()=>P,lb:()=>x,xb:()=>p,yW:()=>D,yr:()=>v,zy:()=>y});var t=e(2543),n=e.n(t),s=e(19845),a=e(50082),r=e(39070),g=e(52622),i=e(2913),l=e(55907),d=e(69437),c=e(66718),h=e(86590),o=e(36795);function m(T,S,O){return T.map(M=>{if(S===O||!(0,d.f)(M.model))return M;const I=M.model.type==="math",L=M.model.type==="reduce",B=M.model.type==="resample",j=M.model.type==="classic_conditions",A=M.model.type==="threshold";if(I)return{...M,model:{...M.model,expression:u(M.model.expression??"",S,O)}};if(B||L||A){const K=M.model.expression===S;return{...M,model:{...M.model,expression:K?O:M.model.expression}}}if(j){const K=M.model.conditions?.map(W=>({...W,query:{...W.query,params:W.query.params.map(U=>U===S?O:U)}}));return{...M,model:{...M.model,conditions:K}}}return M})}function u(T,S,O){const M=new RegExp("(\\$"+S+"\\b)|(\\${"+S+"})","gm"),I="${"+O+"}";return T.replace(M,I)}function p(T,S){return T.find(O=>O.refId===S)!==void 0}function f(T){return T.includes("/")||T.includes("\\")}function y(T){if(T.series.length===0)return;const S=(0,s.jq)(T.series);let O;return S&&(O=new Error("You cannot use time series data as an alert condition, consider adding a reduce expression.")),O}function x(T){if(T.errors?.length)return new Error(T.errors[0].message)}function v(T){const O=(T[0]?.meta?.notices??[]).find(M=>M.severity==="warning")?.text;return O?new Error(O):void 0}function P(T,S){const O={},M=[c.Tz.threshold,c.Tz.classic];if(!S)return O;for(const B of T){if(!(0,d.f)(B.model)||!M.includes(B.model.type)||!Array.isArray(B.model.conditions)||B.model.refId!==S)continue;const j=B.model.conditions.some(E);B.model.conditions.forEach(A=>{const K=A.evaluator.params,W=A.query?.params[0]??B.model.expression;if(!W)return;const U=E(A);try{const F=(0,o.vL)(T),V=(0,o.qQ)(W,F);T.filter(z=>V.includes(z.refId)).forEach(z=>{const N=z.refId,Q=!!(!(0,d.f)(z?.model)&&N);N&&!O[N]&&(O[N]={config:{mode:a.O.Absolute,steps:[]},mode:g.Ly.Line}),N&&Q&&!U&&!j?I(N,K[0]):N&&Q&&U&&(L(N,K,A.evaluator.type),O[N].mode=g.Ly.LineAndArea)})}catch(F){console.error("Failed to parse thresholds",F);return}})}function I(B,j){O[B].config.steps.push({value:-1/0,color:"transparent"},{value:j,color:i.$W.theme2.colors.error.main})}function L(B,j,A){A===l.p.IsWithinRange&&O[B].config.steps.push({value:-1/0,color:"transparent"},{value:j[0],color:i.$W.theme2.colors.error.main},{value:j[1],color:i.$W.theme2.colors.error.main},{value:j[1],color:"transparent"}),A===l.p.IsOutsideRange&&O[B].config.steps.push({value:-1/0,color:i.$W.theme2.colors.error.main},{value:j[0],color:i.$W.theme2.colors.error.main},{value:j[0],color:"transparent"},{value:j[1],color:i.$W.theme2.colors.error.main}),O[B].config.steps.sort((K,W)=>K.value-W.value),O[B].config.steps=O[B].config.steps.filter(K=>K.value!==void 0)}return O}function E(T){return T.evaluator.type===l.p.IsWithinRange||T.evaluator.type===l.p.IsOutsideRange}function D(T){const S="Failed to fetch data";if(T.state!==r.Gu.Error)return;const O=T.errors;return O?.length?O.map(M=>M.message??S).join(", "):T.error?.message??S}function C(T=""){return T==="recording"?h.Z.cloudRecording:T==="grafana-recording"?h.Z.grafanaRecording:h.Z.grafana}function b(T,S){const O=S.filter(B=>!(0,d.f)(B.model)).map(B=>B.refId),M=T.filter(B=>!(0,d.f)(B.model)).map(B=>B.refId),[I,L]=(0,t.xor)(M,O);return[I,L]}},13064:(G,R,e)=>{"use strict";e.d(R,{C:()=>i});var t=e(87836),n=e(72880),s=e(70416),a=e(47232),r=e(72724),g=e(25968);function i(d,c){if(!d||!c||!(0,s.vd)(d))return;let h;try{h=(0,g.M9)(c)}catch{return}if((0,g.mo)(d))return;const o=Date.parse(d||""),m=(0,t.A)(o,h);return(0,n.Y)(m,new Date)?{humanized:`within ${c}`,fullDate:`within ${c}`}:{humanized:`in ${(0,a.KQ)(m).locale("en").fromNow(!0)}`,fullDate:(0,r.LE)(m,{format:"YYYY-MM-DD HH:mm:ss"})}}function l(d){if(!d)return null;if(!isNullDate(d))return formatDistanceToNowStrict(new Date(d))}},5179:(G,R,e)=>{"use strict";e.d(R,{K:()=>a,k:()=>r});var t=e(74848),n=e(96540);const s=n.createContext(void 0),a=({children:g,rule:i,identifier:l})=>{const d={rule:i,identifier:l};return(0,t.jsx)(s.Provider,{value:d,children:g})},r=()=>{const g=n.useContext(s);if(g===void 0)throw new Error("useAlertRule must be used within a AlertRuleContext");return g}},39890:(G,R,e)=>{"use strict";e.d(R,{gQ:()=>Qt,Ay:()=>Qn,lf:()=>Ms,P5:()=>Bs});var t=e(74848),n=e(32196),s=e(2543),a=e(96540),r=e(49185),g=e(67061),i=e(42418),l=e(40980),d=e(72109),c=e(94753),h=e(40845),o=e(55852),m=e(57514),u=e(76412),p=e(83277),f=e(93810),y=e(35896),x=e(21460),v=e(94822),P=e(79741),E=e(24608),D=e(99935),C=e(85244),b=e(55740),T=e(78742),S=e(23662),O=e(3704),M=e(69087),I=e(37959),L=e(48205),B=e(96636),j=e(99106),A=e(51921);function K(){return(0,t.jsx)(i.F,{severity:"info",title:"This rule is part of a federated rule group.",bottomSpacing:0,topSpacing:2,children:(0,t.jsxs)(g.B,{direction:"column",children:["Federated rule groups are currently an experimental feature.",(0,t.jsx)(o.$n,{fill:"text",icon:"book",children:(0,t.jsx)("a",{href:"https://grafana.com/docs/metrics-enterprise/latest/tenant-management/tenant-federation/#cross-tenant-alerting-and-recording-rule-federation",children:"Read documentation"})})]})})}var W=e(14578);function U(){return(0,t.jsx)(c.E,{variant:"bodySmall",color:"warning",children:(0,t.jsxs)(g.B,{direction:"row",alignItems:"center",gap:.25,wrap:"nowrap",flex:"0 0 auto",children:[(0,t.jsx)(W.I,{name:"pause",size:"xs"})," Paused"]})})}var F=e(5179);const V=({color:mt,includeState:Yt})=>{const on=(0,h.of)(w,{color:mt,includeState:Yt});return(0,t.jsx)(g.B,{direction:"row",gap:.5,children:(0,t.jsx)("div",{className:on.dot})})},w=(mt,Yt)=>{const on=mt.spacing(1.25),ln=`calc(${on} / 2.5)`,fn=Yt.color==="error",yn=Yt.color==="success",wn=Yt.color==="warning";return{dot:(0,n.css)({width:on,height:on,borderRadius:"100%",backgroundColor:mt.colors.secondary.main,outline:`solid ${ln} ${mt.colors.secondary.transparent}`,margin:ln},yn&&(0,n.css)({backgroundColor:mt.colors.success.main,outlineColor:mt.colors.success.transparent}),wn&&(0,n.css)({backgroundColor:mt.colors.warning.main,outlineColor:mt.colors.warning.transparent}),fn&&(0,n.css)({backgroundColor:mt.colors.error.main,outlineColor:mt.colors.error.transparent}))}},z=({health:mt})=>{const Yt=Ms(mt),on=Yt?"error":"success",ln=Yt?"Recording error":"Recording";return(0,t.jsx)(H,{color:on,text:ln})},N=({state:mt,health:Yt})=>{let on,ln;switch(mt){case v.cF.Inactive:ln="success",on="Normal";break;case v.cF.Firing:ln="error",on="Firing";break;case v.cF.Pending:ln="warning",on="Pending";break}return Ms(Yt)&&(ln="error",on="Error"),Yt==="nodata"&&(ln="warning",on="No data"),(0,t.jsx)(H,{color:ln,text:on})};function H({color:mt,text:Yt}){return(0,t.jsxs)(g.B,{direction:"row",gap:.5,wrap:"nowrap",flex:"0 0 auto",children:[(0,t.jsx)(V,{color:mt}),(0,t.jsx)(c.E,{variant:"bodySmall",color:mt,children:Yt})]})}var Q=e(50509),X=e(32264),ee=e(46013);const Z=(0,a.lazy)(()=>e.e(7409).then(e.bind(e,9790))),q=(0,a.lazy)(()=>Promise.all([e.e(8895),e.e(285)]).then(e.bind(e,285))),ae=({rule:mt})=>{const Yt=X.$.unifiedAlerting.alertStateHistoryBackend,on=X.$.unifiedAlerting.alertStateHistoryPrimary,fn=[Yt,on].some(Xn=>Xn===ee.Q.Loki)?ee.Q.Loki:ee.Q.Annotations,yn=mt.grafana_alert.id??"",wn=mt.grafana_alert.uid;return(0,t.jsxs)(a.Suspense,{fallback:"Loading...",children:[fn===ee.Q.Loki&&(0,t.jsx)(q,{ruleUID:wn}),fn===ee.Q.Annotations&&(0,t.jsx)(Z,{alertId:yn})]})};var k=e(15054),se=e(99938);const te=({rule:mt})=>(0,t.jsx)(se.s,{rule:mt,pagination:{itemsPerPage:k.FG},enableFiltering:!0});var ne=e(24120),le=e(39070),re=e(76885),de=e(65879),oe=e(11807),J=e(66602),ce=e(39938),pe=e(69437),xe=e(66718),fe=e(55907),Ee=e(26058),Se=e(56528),ye=e(52487),Ve=e(74685);function Me({data:mt,thresholds:Yt}){return mt?(0,t.jsx)(Ve.j,{data:mt,thresholds:Yt?.config,thresholdsType:Yt?.mode}):null}var Ce=e(20382),Ue=e(57220),Ae=e(63066),we=e(85828);const We=({expression:mt})=>(0,t.jsx)(we.m,{options:{readOnly:!0,minimap:{enabled:!1},scrollBeyondLastColumn:0,scrollBeyondLastLine:!1,lineNumbers:"off",cursorWidth:0,overviewRulerLanes:0},defaultLanguage:"sql",height:80,defaultValue:mt,width:"100%"});function _e(mt){return"rawSql"in mt}const at=null,ut=a.lazy(()=>e.e(8468).then(e.bind(e,58468))),Tt=a.lazy(()=>e.e(7011).then(e.bind(e,67011)));function It({model:mt,dataSource:Yt}){return Yt.type===Ue.ol.Prometheus&&(0,Ae.Bu)(mt)?(0,t.jsx)(ut,{query:mt.expr}):Yt.type===Ue.ol.Loki&&(0,Ae.Bu)(mt)?(0,t.jsx)(Tt,{query:mt.expr??""}):_e(mt)?(0,t.jsx)(We,{expression:mt.rawSql}):(0,t.jsx)("pre",{children:(0,t.jsx)("code",{children:(0,Ce.Bh)(mt)})})}var ge=e(19073);function Ie({rule:mt,queries:Yt,condition:on,evalDataByQuery:ln={}}){const fn=(0,s.keyBy)(Object.values(X.$.datasources),Ut=>Ut.uid),yn=Yt.filter(Ut=>!(0,pe.f)(Ut.model)),wn=Yt.filter(Ut=>(0,pe.f)(Ut.model)),Xn=(0,h.of)(He),xn=(0,ye.an)(Yt,on);return(0,t.jsxs)(g.B,{gap:1,direction:"column",flex:"1 1 320px",children:[(0,t.jsx)("div",{className:Xn.maxWidthContainer,children:(0,t.jsx)(g.B,{gap:1,wrap:"wrap","data-testid":"queries-container",children:yn.map(({model:Ut,relativeTimeRange:nn,refId:hn,datasourceUid:dn},Sn)=>{const es=fn[dn];return(0,t.jsx)(ue,{rule:mt,refId:hn,model:Ut,relativeTimeRange:nn,dataSource:es,thresholds:xn[hn],queryData:ln[hn]},Sn)})})}),(0,t.jsx)("div",{className:Xn.maxWidthContainer,children:(0,t.jsx)(g.B,{gap:1,wrap:"wrap","data-testid":"expressions-container",children:wn.map(({model:Ut,refId:nn,datasourceUid:hn},dn)=>(0,pe.f)(Ut)&&(0,t.jsx)(Fe,{refId:nn,isAlertCondition:on===nn,model:Ut,evalData:ln[nn]},dn))})})]})}function ue({refId:mt,rule:Yt,thresholds:on,model:ln,dataSource:fn,queryData:yn,relativeTimeRange:wn}){const Xn=(0,h.of)(Ne),xn=(0,pe.f)(ln),[Ut,nn]=(0,ge.mh)(Yt,ge.j5.Explore),hn=Ut&&nn,dn=[];if(fn){const es=fn.name??"[[Data source not found]]",Pt=fn.meta.info.logos.small;dn.push((0,t.jsx)(Pe,{name:es,imgUrl:Pt},"datasource"))}wn&&dn.push((0,t.jsxs)(c.E,{color:"secondary",children:[(0,de.secondsToHms)(wn.from)," to now"]},"timerange"));let Sn;return!xn&&hn&&(Sn=fn&&me(fn,ln)),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Be,{refId:mt,headerItems:dn,exploreLink:Sn,children:(0,t.jsx)("div",{className:Xn.queryPreviewWrapper,children:(0,t.jsx)(J.Xw,{children:ln&&fn&&(0,t.jsx)(It,{model:ln,dataSource:fn})})})}),fn&&(0,t.jsx)(Me,{data:yn,thresholds:on})]})}function me(mt,Yt){const{uid:on,type:ln}=mt,{refId:fn,...yn}=Yt;return re.kM.renderUrl(`${X.$.appSubUrl}/explore`,{left:JSON.stringify({datasource:mt.uid,queries:[{refId:"A",...yn,datasource:{type:ln,uid:on}}],range:{from:"now-1h",to:"now"}})})}function Pe({name:mt,imgUrl:Yt}){const on=(0,h.of)(Ne);return(0,t.jsxs)("div",{className:on.dataSource,children:[(0,t.jsx)("img",{src:Yt,width:16,alt:mt}),mt]},"datasource")}const Ne=mt=>({queryPreviewWrapper:(0,n.css)({margin:mt.spacing(1)}),contentBox:(0,n.css)({flex:"1 0 100%"}),visualization:(0,n.css)({padding:mt.spacing(1)}),dataSource:(0,n.css)({border:`1px solid ${mt.colors.border.weak}`,borderRadius:mt.shape.radius.default,padding:mt.spacing(.5,1),display:"flex",alignItems:"center",gap:mt.spacing(1)})});function Fe({refId:mt,model:Yt,evalData:on,isAlertCondition:ln}){function fn(){switch(Yt.type){case xe.Tz.math:return(0,t.jsx)(et,{model:Yt});case xe.Tz.reduce:return(0,t.jsx)(ze,{model:Yt});case xe.Tz.resample:return(0,t.jsx)(tt,{model:Yt});case xe.Tz.classic:return(0,t.jsx)(be,{model:Yt});case xe.Tz.threshold:return(0,t.jsx)(gt,{model:Yt});case xe.Tz.sql:return(0,t.jsx)(oe.l,{rawSql:Yt.expression||"",datasourceType:Yt.datasource?.type});default:return(0,t.jsxs)(t.Fragment,{children:["Expression not supported: ",Yt.type]})}}return(0,t.jsxs)(Be,{refId:mt,headerItems:[(0,t.jsx)(c.E,{color:"secondary",children:(0,s.startCase)(Yt.type)},"expression-type")],isAlertCondition:ln,children:[fn(),(0,t.jsx)(Ee.h,{}),on&&(0,t.jsx)(Se.GX,{series:on.series,isAlertCondition:ln})]})}function Be({refId:mt,headerItems:Yt=[],children:on,isAlertCondition:ln,exploreLink:fn}){const yn=(0,h.of)(he);return(0,t.jsxs)("div",{className:(0,n.cx)(yn.container),children:[(0,t.jsxs)("header",{className:yn.header,children:[(0,t.jsx)("span",{className:yn.refId,children:mt}),Yt,(0,t.jsx)(Ee.h,{}),ln&&(0,t.jsx)(ce.E,{color:"green",icon:"check",text:"Alert condition"}),fn&&(0,t.jsx)(B.d,{component:(0,t.jsx)(o.z9,{size:"md",variant:"secondary",icon:"compass",href:fn,children:"View in Explore"})})]}),on]})}const he=mt=>({container:(0,n.css)({flex:"1 0 25%",border:`1px solid ${mt.colors.border.weak}`,maxWidth:"100%",borderRadius:mt.shape.radius.default,display:"flex",flexDirection:"column"}),header:(0,n.css)({display:"flex",alignItems:"center",gap:mt.spacing(1),padding:mt.spacing(1),backgroundColor:mt.colors.background.secondary}),textBlock:(0,n.css)({border:`1px solid ${mt.colors.border.weak}`,padding:mt.spacing(.5,1),backgroundColor:mt.colors.background.primary,borderRadius:mt.shape.radius.default}),refId:(0,n.css)({color:mt.colors.text.link,padding:mt.spacing(.5,1),border:`1px solid ${mt.colors.border.weak}`,borderRadius:mt.shape.radius.default})});function be({model:mt}){const Yt=(0,h.of)(Ke),on=(0,s.keyBy)(fe.A.reducerTypes,yn=>yn.value),ln=(0,s.keyBy)(fe.A.evalOperators,yn=>yn.value),fn=(0,s.keyBy)(fe.A.evalFunctions,yn=>yn.value);return(0,t.jsx)("div",{className:Yt.container,children:mt.conditions?.map(({query:yn,operator:wn,reducer:Xn,evaluator:xn},Ut)=>{const nn=ht(xn);return(0,t.jsxs)(a.Fragment,{children:[(0,t.jsx)("div",{className:Yt.blue,children:Ut===0?"WHEN":!!wn?.type&&ln[wn?.type]?.text}),(0,t.jsx)("div",{className:Yt.bold,children:Xn?.type&&on[Xn.type]?.text}),(0,t.jsx)("div",{className:Yt.blue,children:"OF"}),(0,t.jsx)("div",{className:Yt.bold,children:yn.params[0]}),(0,t.jsx)("div",{className:Yt.blue,children:fn[xn.type].text}),(0,t.jsx)("div",{className:Yt.bold,children:nn?`(${xn.params[0]}; ${xn.params[1]})`:xn.params[0]})]},Ut)})})}const Ke=mt=>({container:(0,n.css)({padding:mt.spacing(1),display:"grid",gridTemplateColumns:"repeat(6, max-content)",gap:mt.spacing(0,1)}),...rt(mt)});function ze({model:mt}){const Yt=(0,h.of)(nt),{reducer:on,expression:ln,settings:fn}=mt,yn=xe.Cu.find(xn=>xn.value===on),wn=fn?.mode??xe.Mt.Strict,Xn=xe.HZ.find(xn=>xn.value===wn);return(0,t.jsxs)("div",{className:Yt.container,children:[(0,t.jsx)("div",{className:Yt.label,children:"Function"}),(0,t.jsx)("div",{className:Yt.value,children:yn?.label}),(0,t.jsx)("div",{className:Yt.label,children:"Input"}),(0,t.jsx)("div",{className:Yt.value,children:ln}),(0,t.jsx)("div",{className:Yt.label,children:"Mode"}),(0,t.jsx)("div",{className:Yt.value,children:Xn?.label})]})}const nt=mt=>({container:(0,n.css)({padding:mt.spacing(1),display:"grid",gap:mt.spacing(.5),gridTemplateRows:"1fr 1fr",gridTemplateColumns:"repeat(4, 1fr)","> :nth-child(6)":{gridColumn:"span 3"}}),...rt(mt)});function tt({model:mt}){const Yt=(0,h.of)(ot),{expression:on,window:ln,downsampler:fn,upsampler:yn}=mt,wn=xe.PN.find(xn=>xn.value===fn),Xn=xe.iX.find(xn=>xn.value===yn);return(0,t.jsxs)("div",{className:Yt.container,children:[(0,t.jsx)("div",{className:Yt.label,children:"Input"}),(0,t.jsx)("div",{className:Yt.value,children:on}),(0,t.jsx)("div",{className:Yt.label,children:"Resample to"}),(0,t.jsx)("div",{className:Yt.value,children:ln}),(0,t.jsx)("div",{className:Yt.label,children:"Downsample"}),(0,t.jsx)("div",{className:Yt.value,children:wn?.label}),(0,t.jsx)("div",{className:Yt.label,children:"Upsample"}),(0,t.jsx)("div",{className:Yt.value,children:Xn?.label})]})}const ot=mt=>({container:(0,n.css)({padding:mt.spacing(1),display:"grid",gap:mt.spacing(.5),gridTemplateColumns:"repeat(4, 1fr)",gridTemplateRows:"1fr 1fr"}),...rt(mt)});function gt({model:mt}){const Yt=(0,h.of)(He),{expression:on,conditions:ln}=mt,fn=ln&&ln[0]?.evaluator,yn=xe.zd.find(nn=>nn.value===fn?.type),wn=fn?ht(fn):!1,Xn=ln&&ln[0]?.unloadEvaluator,xn=xe.zd.find(nn=>nn.value===Xn?.type),Ut=Xn?ht(Xn):!1;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:Yt.container,children:[(0,t.jsx)("div",{className:Yt.label,children:"Input"}),(0,t.jsx)("div",{className:Yt.value,children:on}),fn&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:Yt.blue,children:yn?.label}),(0,t.jsx)("div",{className:Yt.bold,children:wn?`(${fn.params[0]}; ${fn.params[1]})`:fn.params[0]})]})]}),(0,t.jsx)("div",{className:Yt.container,children:Xn&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:Yt.label,children:"Stop alerting when "}),(0,t.jsx)("div",{className:Yt.value,children:on}),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:Yt.blue,children:xn?.label}),(0,t.jsx)("div",{className:Yt.bold,children:Ut?`(${Xn.params[0]}; ${Xn.params[1]})`:Xn.params[0]})]})]})})]})}const He=mt=>{const{blue:Yt,bold:on,...ln}=rt(mt);return{...ln,maxWidthContainer:(0,n.css)({maxWidth:"100%"}),container:(0,n.css)({padding:mt.spacing(1),display:"flex",gap:mt.spacing(.5)}),blue:(0,n.css)(Yt,{margin:"auto 0"}),bold:(0,n.css)(on,{margin:"auto 0"})}};function et({model:mt}){const Yt=(0,h.of)(He),{expression:on}=mt;return(0,t.jsxs)("div",{className:Yt.container,children:[(0,t.jsx)("div",{className:Yt.label,children:"Input"}),(0,t.jsx)("div",{className:Yt.value,children:on})]})}const rt=mt=>({blue:(0,n.css)({color:mt.colors.text.link}),bold:(0,n.css)({fontWeight:mt.typography.fontWeightBold}),label:(0,n.css)({display:"flex",alignItems:"center",padding:mt.spacing(.5,1),backgroundColor:mt.colors.background.secondary,fontSize:mt.typography.bodySmall.fontSize,lineHeight:mt.typography.bodySmall.lineHeight,fontWeight:mt.typography.fontWeightBold,borderRadius:mt.shape.radius.default}),value:(0,n.css)({padding:mt.spacing(.5,1),border:`1px solid ${mt.colors.border.weak}`,borderRadius:mt.shape.radius.default})});function ht(mt){return mt.type===fe.p.IsWithinRange||mt.type===fe.p.IsOutsideRange}var ft=e(36135),De=e(28318),Te=e(1932),Oe=e(25968);function Ye(mt){if(!mt)return[];const{namespace:Yt,rulerRule:on}=mt,{rulesSource:ln}=Yt;if((0,S.lT)(on)){const fn=on.grafana_alert.data;return Ge(fn,on.for??"",mt.group.interval)}if((0,Ue.Eb)(ln)){const fn=it(ln,mt);return[Je(fn,ln.uid)]}return[]}function Ge(mt,Yt,on){const ln=(0,Oe.P8)(Yt)??(0,Oe.P8)(on??"1m"),fn=Math.floor(ln/1e3);return mt.map(yn=>(0,Te.jM)(yn,wn=>{const Xn=wn.relativeTimeRange?.from??0,xn=Math.max(fn*3,Xn+fn*2);wn.relativeTimeRange={from:xn,to:0}}))}function Je(mt,Yt){return{refId:mt.refId,datasourceUid:Yt,queryType:"",model:mt,relativeTimeRange:{from:360,to:0}}}function it(mt,Yt){const on="A";switch(mt.type){case"prometheus":return{refId:on,expr:Yt.query};case"loki":return{refId:on,expr:Yt.query};default:throw new Error(`Query for datasource type ${mt.type} is currently not supported by cloud alert rules.`)}}const St=({rule:mt})=>{const Yt=(0,a.useMemo)(()=>new De.t,[]),on=(0,ne.A)(Yt.get()),ln=zt(on),fn=(0,a.useMemo)(()=>Ye(mt),[mt]),{allDataSourcesAvailable:yn}=(0,ft.g)(fn),wn=(0,a.useCallback)(()=>{if(fn.length>0&&yn){let xn;mt&&(0,S.lT)(mt.rulerRule)&&(xn=mt.rulerRule.grafana_alert.condition),Yt.run(fn,xn??"A")}},[fn,yn,mt,Yt]);(0,a.useEffect)(()=>{yn&&wn()},[yn,wn]),(0,a.useEffect)(()=>()=>Yt.destroy(),[Yt]);const Xn=(0,S.YN)(mt.group);return(0,t.jsx)(t.Fragment,{children:ln?"Loading...":(0,t.jsxs)(t.Fragment,{children:[(0,S.lT)(mt.rulerRule)&&!Xn&&(0,t.jsx)(Ie,{rule:mt,condition:mt.rulerRule.grafana_alert.condition,queries:fn,evalDataByQuery:on}),!(0,S.lT)(mt.rulerRule)&&!Xn&&on&&Object.keys(on).length>0&&(0,t.jsx)(g.B,{direction:"column",gap:1,children:fn.map(xn=>(0,t.jsx)(ue,{rule:mt,refId:xn.refId,model:xn.model,dataSource:Object.values(X.$.datasources).find(Ut=>Ut.uid===xn.datasourceUid),queryData:on[xn.refId],relativeTimeRange:xn.relativeTimeRange},xn.refId))}),!Xn&&!yn&&(0,t.jsx)(i.F,{title:"Query not available",severity:"warning",children:"Cannot display the query preview. Some of the data sources used in the queries are not available."})]})})};function zt(mt){return mt?!!Object.values(mt).find(Yt=>Yt.state===le.Gu.Loading):!0}const Kt=()=>(0,t.jsx)(t.Fragment,{children:"Routing"});var Qt=(mt=>(mt.Query="query",mt.Instances="instances",mt.History="history",mt.Routing="routing",mt.Details="details",mt))(Qt||{});const an=(0,E.w)(),Nn=()=>{const{rule:mt,identifier:Yt}=(0,F.k)(),{pageNav:on,activeTab:ln}=Zn(mt),[fn,yn]=(0,a.useState)(),{annotations:wn,promRule:Xn}=mt,xn=Ms(mt.promRule?.health),Ut=(0,S.Z8)(Xn),nn=(0,S.YN)(mt.group),hn=(0,S.lT)(mt.rulerRule)&&!!mt.rulerRule.grafana_alert.provenance,dn=(0,S.lT)(mt.rulerRule)&&(0,S.HH)(mt.rulerRule),Sn=xn&&!dn,es=(0,S.uo)(mt),Pt=wn[b.YH.summary];return(0,t.jsxs)(I.d,{pageNav:on,navId:"alert-list",isLoading:!1,renderTitle:Ze=>(0,t.jsx)(ss,{name:Ze,paused:dn,state:Ut?Xn.state:void 0,health:mt.promRule?.health,ruleType:mt.promRule?.type,ruleOrigin:es}),actions:(0,t.jsx)(y.l,{rule:mt,showCopyLinkButton:!0,rulesSource:mt.namespace.rulesSource}),info:zn(mt),subTitle:(0,t.jsxs)(g.B,{direction:"column",children:[dn&&(0,t.jsx)(f.A,{}),Pt,nn&&(0,t.jsx)(K,{}),hn&&(0,t.jsx)(L.Yi,{resource:L.hk.AlertRule,bottomSpacing:0,topSpacing:2}),Sn&&(0,t.jsx)(i.F,{title:"Something went wrong when evaluating this alert rule",bottomSpacing:0,topSpacing:2,children:(0,t.jsx)("pre",{style:{marginBottom:0},children:(0,t.jsx)("code",{children:mt.promRule?.lastError??"No error message"})})})]}),children:[an&&(0,t.jsx)(ds,{ruleIdentifier:Yt}),(0,t.jsx)(g.B,{direction:"column",gap:2,children:(0,t.jsxs)(l.J,{children:[ln==="query"&&(0,t.jsx)(St,{rule:mt}),ln==="instances"&&(0,t.jsx)(te,{rule:mt}),ln==="history"&&(0,S.lT)(mt.rulerRule)&&(0,t.jsx)(ae,{rule:mt.rulerRule}),ln==="routing"&&(0,t.jsx)(Kt,{}),ln==="details"&&(0,t.jsx)(Q.B,{rule:mt})]})}),fn&&(0,t.jsx)(A.Z,{redirectTo:!0,identifier:fn,isProvisioned:hn,onDismiss:()=>yn(void 0)})]})},zn=mt=>{const{labels:Yt,annotations:on,group:ln}=mt,fn=[],yn=on[b.YH.runbookURL],wn=on[b.YH.dashboardUID],Xn=on[b.YH.panelID],xn=wn&&Xn,Ut=wn,nn=!(0,s.isEmpty)(Yt),hn=ln.interval;if(yn){const dn=(0,s.truncate)(yn,{length:42}),Sn=Hn(yn)?(0,t.jsx)(d.Y,{variant:"bodySmall",href:yn,external:!0,children:dn}):(0,t.jsx)(c.E,{variant:"bodySmall",children:dn});fn.push({label:"Runbook URL",value:Sn})}if(xn?fn.push({label:"Dashboard and panel",value:(0,t.jsx)(B.d,{title:mt.name,component:(0,t.jsx)(d.Y,{variant:"bodySmall",href:(0,T.D2)(wn,Xn),children:"View panel"})})}):Ut&&fn.push({label:"Dashboard",value:(0,t.jsx)(B.d,{title:mt.name,component:(0,t.jsx)(d.Y,{title:mt.name,variant:"bodySmall",href:(0,T.JM)(wn),children:"View dashboard"})})}),(0,S.Gy)(mt.rulerRule)){const dn=mt.rulerRule?.grafana_alert.record?.metric??"";fn.push({label:"Metric name",value:(0,t.jsx)(c.E,{color:"primary",children:dn})})}return hn&&fn.push({label:"Evaluation interval",value:(0,t.jsxs)(c.E,{color:"primary",children:["Every ",hn]})}),nn&&fn.push({label:"Labels",value:(0,t.jsx)(M.m,{labels:Yt,size:"sm"})}),fn},Yn=mt=>{const Yt=new URLSearchParams([["search",mt.map(([on,ln])=>`${on}:"${ln}"`).join(" ")]]);return(0,O.G)("/alerting/list",Yt)},ss=({name:mt,paused:Yt=!1,state:on,health:ln,ruleType:fn,ruleOrigin:yn})=>{const wn=(0,h.of)(Ln),[Xn]=(0,p.s)(),xn=fn===v.JS.Recording,Ut=Xn.returnTo?String(Xn.returnTo):"/alerting/list";return(0,t.jsxs)("div",{className:wn.title,children:[(0,t.jsx)(o.z9,{variant:"secondary",icon:"angle-left",href:Ut}),yn&&(0,t.jsx)(C.T,{pluginId:yn.pluginId}),(0,t.jsx)(c.E,{variant:"h1",truncate:!0,children:mt}),Yt?(0,t.jsx)(U,{}):(0,t.jsxs)(t.Fragment,{children:[on&&(0,t.jsx)(N,{state:on,health:ln}),xn&&(0,t.jsx)(z,{health:ln})]})]})};function ds({ruleIdentifier:mt}){const[Yt,{width:on}]=(0,r.A)(),{isConsistent:ln,error:fn}=(0,D.f)(mt);return ln?null:fn?(0,t.jsx)(i.F,{title:"Unable to check the rule status",bottomSpacing:0,topSpacing:2,children:(0,T.JZ)(fn)}):(0,t.jsxs)(g.B,{direction:"column",gap:0,ref:Yt,children:[(0,t.jsx)(m.G,{width:on}),(0,t.jsx)(i.F,{title:(0,u.t)("alerting.rule-viewer.prometheus-consistency-check.alert-title","Update in progress"),severity:"info",children:(0,t.jsx)(u.x,{i18nKey:"alerting.rule-viewer.prometheus-consistency-check.alert-message",children:"Alert rule has been updated. Changes may take up to a minute to appear on the Alert rules list view."})})]})}const Ms=mt=>mt==="error"||mt==="err";function Bs(){const[mt,Yt]=(0,p.s)(),on=mt.tab;return[gs(on)?on:"query",yn=>{Yt({tab:yn})}]}function gs(mt){return typeof mt=="string"&&Object.values(Qt).includes(mt)}function Zn(mt){const[Yt,on]=Bs(),{annotations:ln,promRule:fn}=mt,yn=ln[b.YH.summary],wn=(0,S.Z8)(fn),Xn=wn?Ls(mt.instanceTotals):void 0,xn=(0,j.EL)(mt.namespace).name,Ut=mt.group.name,nn=(0,S.lT)(mt.rulerRule)&&wn,hn=(0,S.KB)(mt.promRule);return{pageNav:{...P.defaultPageNav,text:mt.name,subTitle:yn,children:[{text:"Query and conditions",active:Yt==="query",onClick:()=>{on("query")}},{text:"Instances",active:Yt==="instances",onClick:()=>{on("instances")},tabCounter:Xn,hideFromTabs:hn},{text:"History",active:Yt==="history",onClick:()=>{on("history")},hideFromTabs:!nn},{text:"Details",active:Yt==="details",onClick:()=>{on("details")}}],parentItem:{text:Ut,url:Yn([["namespace",xn],["group",Ut]]),parentItem:{text:xn,url:Yn([["namespace",xn]])}}},activeTab:Yt}}const Ls=mt=>(0,s.chain)(mt).pick([x.$.Alerting,x.$.Pending,x.$.Normal]).values().sum().value(),Ln=()=>({title:(0,n.css)({display:"flex",alignItems:"center",gap:8,minWidth:0})});function Hn(mt){const Yt=mt.startsWith("/");let on=!1;try{new URL(mt),on=!0}catch{return!1}return Yt||on}const Qn=Nn},50509:(G,R,e)=>{"use strict";e.d(R,{$:()=>f,B:()=>p});var t=e(74848),n=e(32196),s=e(72095),a=e(96540),r=e(40845),g=e(67061),i=e(94753),l=e(10534),d=e(72109),c=e(86783),h=e(23662),o=e(55196),m=e(16577),u=(x=>(x.GrafanaManagedAlertRule="Grafana-managed alert rule",x.GrafanaManagedRecordingRule="Grafana-managed recording rule",x.CloudAlertRule="Cloud alert rule",x.CloudRecordingRule="Cloud recording rule",x))(u||{});const p=({rule:x})=>{const v=(0,r.of)(y);let P;const E=(0,c.G)(x);(0,h.lT)(x.rulerRule)?P=(0,h.Gy)(x.rulerRule)?"Grafana-managed recording rule":"Grafana-managed alert rule":(0,h.i7)(x.rulerRule)?P="Cloud recording rule":P="Cloud alert rule";const D=x.promRule?.evaluationTime,C=x.promRule?.lastEvaluation,b=(0,a.useCallback)(()=>(0,h.lT)(x.rulerRule)?x.rulerRule.grafana_alert.uid:"",[x.rulerRule]),T=(0,h.Rh)(x),S=Number.isFinite(D);return(0,t.jsxs)(g.B,{direction:"column",gap:3,children:[(0,t.jsxs)("div",{className:v.metadataWrapper,children:[(0,t.jsxs)(o.P,{direction:"column",children:["Rule type",(0,t.jsx)(i.E,{color:"primary",children:P})]}),(0,t.jsx)(o.P,{direction:"column",children:(0,h.lT)(x.rulerRule)&&(0,t.jsxs)(t.Fragment,{children:["Rule Identifier",(0,t.jsx)(g.B,{direction:"row",alignItems:"center",gap:.5,children:(0,t.jsxs)(i.E,{color:"primary",children:[x.rulerRule.grafana_alert.uid,(0,t.jsx)(l.b,{fill:"text",variant:"secondary",icon:"copy",size:"sm",getText:b})]})})]})}),(0,t.jsx)(o.P,{direction:"column",children:S&&(0,t.jsxs)(t.Fragment,{children:["Last evaluation",C&&D?(0,t.jsxs)("span",{children:[(0,t.jsxs)(i.E,{color:"primary",children:[(0,s.B)(new Date(C))," ago"]}),", took"," ",(0,t.jsxs)(i.E,{color:"primary",children:[D,"ms"]})]}):null]})}),(0,t.jsx)(o.P,{direction:"column",children:E&&(0,t.jsxs)(t.Fragment,{children:["Pending period",(0,t.jsx)(i.E,{color:"primary",children:E})]})}),(0,h.lT)(x.rulerRule)&&x.rulerRule.grafana_alert.no_data_state&&x.rulerRule.grafana_alert.exec_err_state&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(o.P,{direction:"column",children:["Alert state if no data or all values are null",(0,t.jsx)(i.E,{color:"primary",children:x.rulerRule.grafana_alert.no_data_state})]}),(0,t.jsxs)(o.P,{direction:"column",children:["Alert state if execution error or timeout",(0,t.jsx)(i.E,{color:"primary",children:x.rulerRule.grafana_alert.exec_err_state})]})]})]}),T&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.E,{variant:"h4",children:"Annotations"}),Object.keys(T).length===0?(0,t.jsx)(i.E,{variant:"bodySmall",color:"secondary",italic:!0,children:"No annotations"}):(0,t.jsx)("div",{className:v.metadataWrapper,children:Object.entries(T).map(([O,M])=>(0,t.jsxs)(o.P,{direction:"column",children:[O,(0,t.jsx)(f,{value:M})]},O))})]})]})};function f({value:x}){const v=x&&x.startsWith("http"),P=(0,t.jsx)(m.Y,{input:x,delimiter:["{{","}}"]});return v?(0,t.jsx)(d.Y,{variant:"bodySmall",href:x,external:!0,children:x}):(0,t.jsx)(i.E,{color:"primary",children:P})}const y=x=>({metadataWrapper:(0,n.css)({display:"grid",gridTemplateColumns:"auto auto",rowGap:x.spacing(3),columnGap:x.spacing(12)})})},2426:(G,R,e)=>{"use strict";e.d(R,{D:()=>P});var t=e(74848),n=e(96540),s=e(8249),a=e(47232),r=e(74135),g=e(23662),i=e(69087),l=e(75591),d=e(71798),c=e(83122),h=e(29158),o=e(24401),m=e(30973);const u=({rule:D,instance:C,extensionPointId:b})=>{const[T,S]=(0,n.useState)(),O=(0,n.useMemo)(()=>({instance:C,rule:D}),[C,D]),{links:M}=(0,d.U)({context:O,extensionPointId:b,limitPerPlugin:3});if(M.length===0)return null;const I=(0,t.jsx)(m.w,{extensions:M,onSelect:S});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.m,{placement:"bottom-start",overlay:I,children:(0,t.jsx)(h.K,{name:"ellipsis-v","aria-label":"Actions",variant:"secondary"})}),!!T&&!!T.path&&(0,t.jsx)(o.s,{path:T.path,title:T.title,onDismiss:()=>S(void 0)})]})};var p=e(33225),f=e(71223),y=e(84396);const x=({instance:D})=>{const C=(0,p.Hx)(D.annotations),b=(0,p.gO)(C);return(0,t.jsxs)("div",{children:[D.value&&(0,t.jsx)(y.X,{label:"Value",horizontal:!0,children:D.value}),C.map(([T,S])=>(0,t.jsx)(f.s,{annotationKey:T,value:S,valueLink:b.get(T)},T))]})};var v=e(30423);const P=({rule:D,instances:C,pagination:b,footerRow:T})=>{const S=(0,n.useMemo)(()=>C.length>1?(0,s.yO)(C.map(M=>M.labels)):{},[C]),O=(0,n.useMemo)(()=>C.map(M=>({data:{rule:D,alert:{...M,commonLabels:S}},id:(0,g.RI)(M)})),[S,C,D]);return(0,t.jsx)(l.E,{cols:E,isExpandable:!0,items:O,renderExpandedContent:({data:M})=>(0,t.jsx)(x,{instance:M.alert}),pagination:b,footerRow:T})},E=[{id:"state",label:"State",renderCell:({data:{alert:{state:D}}})=>(0,t.jsx)(v.C,{state:D}),size:"80px"},{id:"labels",label:"Labels",renderCell:({data:{alert:{labels:D,commonLabels:C}}})=>(0,t.jsx)(i.m,{labels:D,commonLabels:C,size:"sm"})},{id:"created",label:"Created",renderCell:({data:{alert:{activeAt:D}}})=>(0,t.jsx)(t.Fragment,{children:D.startsWith("0001")?"-":(0,a.KQ)(D).format("YYYY-MM-DD HH:mm:ss")}),size:"150px"},{id:"actions",label:"",renderCell:({data:{alert:D,rule:C}})=>(0,t.jsx)(u,{rule:C,instance:D,extensionPointId:r.S.AlertInstanceAction},"alert-instance-extension-point"),size:"40px"}]},30423:(G,R,e)=>{"use strict";e.d(R,{C:()=>i});var t=e(74848),n=e(96540),s=e(56034),a=e(14578),r=e(23662),g=e(65415);const i=(0,n.memo)(({state:l,isPaused:d=!1,size:c="md",muted:h=!1})=>d?(0,t.jsx)(s.m,{content:"Alert evaluation is currently paused",placement:"top",children:(0,t.jsxs)(g.O,{state:"warning",size:c,muted:h,children:[(0,t.jsx)(a.I,{name:"pause",size:"xs"})," Paused"]})}):(0,t.jsx)(g.O,{state:(0,r.Wy)(l),size:c,muted:h,children:(0,r.XI)(l)}));i.displayName="AlertStateTag"},51921:(G,R,e)=>{"use strict";e.d(R,{Z:()=>l});var t=e(74848),n=e(96540),s=e(24180),a=e(54148),r=e(96374),g=e(55852),i=e(18461);function l({identifier:c,isProvisioned:h,redirectTo:o=!1,onDismiss:m}){const u=(0,s.zy)(),[p,f]=(0,n.useState)(h?"confirm":"redirect");if(p==="redirect"){const y=i.$9(c),x=u.pathname+u.search,v=new URLSearchParams({copyFrom:y,returnTo:o?x:""});return(0,t.jsx)(a.C5,{to:"/alerting/new?"+v.toString(),replace:!1})}return(0,t.jsx)(r.u,{isOpen:p==="confirm",title:"Copy provisioned alert rule",body:(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{children:["The new rule will ",(0,t.jsx)("strong",{children:"not"})," be marked as a provisioned rule."]}),(0,t.jsx)("p",{children:"You will need to set a new evaluation group for the copied rule because the original one has been provisioned and cannot be used for rules created in the UI."})]}),confirmText:"Copy",onConfirm:()=>f("redirect"),onDismiss:m})}const d=(0,n.forwardRef)(({text:c,ruleIdentifier:h,isProvisioned:o,className:m},u)=>{const[p,f]=(0,n.useState)(!1);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.$n,{title:"Copy",className:m,size:"sm",variant:"secondary",icon:"copy",onClick:()=>f(!0),ref:u,children:c},"clone"),p&&(0,t.jsx)(l,{identifier:h,isProvisioned:o,onDismiss:()=>f(!1)})]})});d.displayName="CloneRuleButton"},35896:(G,R,e)=>{"use strict";e.d(R,{l:()=>Ee});var t=e(74848),n=e(32196),s=e(96540),a=e(40845),r=e(55852),g=e(67061),i=e(26272),l=e(38138),d=e(83122),c=e(28138),h=e(3169),o=e(23662),m=e(8484),u=e(79938),p=e(48070),f=e(6833),y=e(43482);function x(){const[ye]=(0,y.D)(),[Ve]=u.hK.endpoints.upsertRuleGroupForNamespace.useMutation(),Me=(0,m.t)("alerting.rules.pause-rule.success","Rule evaluation paused"),Ce=(0,m.t)("alerting.rules.resume-rule.success","Rule evaluation resumed");return(0,f.Yb)(async(Ue,Ae,we)=>{const{namespaceName:We}=Ue,_e=(0,p.LH)({uid:Ae,pause:we}),{newRuleGroupDefinition:at,rulerConfig:ut}=await ye(Ue,_e);return Ve({rulerConfig:ut,namespace:We,payload:at,notificationOptions:{successMessage:we?Me:Ce}}).unwrap()})}var v=e(78742);const E=({rule:ye,onPauseChange:Ve})=>{const Me=(0,h._2)(),[Ce,Ue]=x(),Ae=(0,o.lT)(ye.rulerRule)&&(0,o.HH)(ye.rulerRule),we=Ae?"play":"pause",We=Ae?"Resume evaluation":"Pause evaluation",_e=async at=>{if((0,o.lT)(ye.rulerRule)){try{const ut=(0,o.Uw)(ye),Tt=ye.rulerRule.grafana_alert.uid;await Ce.execute(ut,Tt,at)}catch(ut){Me.error(`Failed to ${at?"pause":"resume"} the rule: ${(0,v.JZ)(ut)}`);return}Ve?.()}};return(0,t.jsx)(l.W.Item,{label:We,icon:we,disabled:(0,f.VP)(Ue),onClick:()=>{_e(!Ae)}})};var D=e(90141),C=e(74135),b=e(71798),T=e(94822);function S(ye){const Ve=O(ye),{links:Me}=(0,b.U)(Ve),Ce=(0,o.uo)(ye),Ue=ye.promRule?.type;if(!Ce||!Ue)return[];const{pluginId:Ae}=Ce;return Me.filter(we=>we.pluginId===Ae)}function O(ye){return(0,s.useMemo)(()=>{switch(ye.promRule?.type){case T.JS.Alerting:return{extensionPointId:C.S.AlertingAlertingRuleAction,context:{name:ye.name,namespace:ye.namespace.name,group:ye.group.name,expression:ye.query,labels:ye.labels,annotations:ye.annotations}};case T.JS.Recording:return{extensionPointId:C.S.AlertingRecordingRuleAction,context:{name:ye.name,namespace:ye.namespace.name,group:ye.group.name,expression:ye.query,labels:ye.labels}};default:return{extensionPointId:""}}},[ye])}var M=e(19073),I=e(18461),L=e(3704),B=e(56034),j=e(12210),A=e(99494),K=e(76156);const W=({title:ye="",severity:Ve="",url:Me=""})=>{const Ce=createBridgeURL(SupportedPlugin.Incident,"/incidents/declare",{title:ye,severity:Ve,url:Me}),{loading:Ue,installed:Ae,settings:we}=usePluginBridge(SupportedPlugin.Incident);return jsxs(Fragment,{children:[Ue===!0&&jsx(Button,{icon:"fire",size:"sm",type:"button",disabled:!0,children:"Declare Incident"}),Ae===!1&&jsx(Tooltip,{content:"Grafana Incident is not installed or is not configured correctly",children:jsx(Button,{icon:"fire",size:"sm",type:"button",disabled:!0,children:"Declare Incident"})}),we&&jsx(LinkButton,{icon:"fire",size:"sm",type:"button",href:Ce,children:"Declare Incident"})]})},U=({title:ye="",severity:Ve="",url:Me=""})=>{const Ce=(0,K.h)(A.W.Incident,"/incidents/declare",{title:ye,severity:Ve,url:Me}),{loading:Ue,installed:Ae,settings:we}=(0,j._)(A.W.Incident);return(0,t.jsxs)(t.Fragment,{children:[Ue===!0&&(0,t.jsx)(l.W.Item,{label:"Declare incident",icon:"fire",disabled:!0}),Ae===!1&&(0,t.jsx)(B.m,{content:"Grafana Incident is not installed or is not configured correctly",children:(0,t.jsx)(l.W.Item,{label:"Declare incident",icon:"fire",disabled:!0})}),we&&(0,t.jsx)(l.W.Item,{label:"Declare incident",url:Ce,icon:"fire"})]})},F=({rule:ye,identifier:Ve,showCopyLinkButton:Me,handleSilence:Ce,handleDelete:Ue,handleDuplicateRule:Ae,onPauseChange:we,buttonSize:We})=>{const[_e,at]=(0,M.mh)(ye,M.j5.Pause),ut=_e&&at,[Tt,It]=(0,M.mh)(ye,M.j5.Delete),ge=Tt&&It,[Ie,ue]=(0,M.mh)(ye,M.j5.Duplicate),me=Ie&&ue,[Pe,Ne]=(0,M.mh)(ye,M.j5.Silence),Fe=Pe&&Ne,[Be,he]=(0,M.mh)(ye,M.j5.ModifyExport),be=Be&&he,Ke=S(ye),ze=Ke.length>0,nt=(!(0,v.y$)()||(0,v.ES)())&&(0,o.Z8)(ye.promRule)&&ye.promRule.state===T.cF.Firing,tt=(0,v.S2)(ye.namespace.rulesSource,ye),ot=[ut,Fe,nt,me].some(Boolean)&&[Me,be].some(Boolean),gt=(0,t.jsxs)(t.Fragment,{children:[ut&&(0,t.jsx)(E,{rule:ye,onPauseChange:we}),Fe&&(0,t.jsx)(l.W.Item,{label:"Silence notifications",icon:"bell-slash",onClick:Ce}),nt&&(0,t.jsx)(U,{title:ye.name,url:""}),me&&(0,t.jsx)(l.W.Item,{label:"Duplicate",icon:"copy",onClick:()=>Ae(Ve)}),ot&&(0,t.jsx)(l.W.Divider,{}),tt&&(0,t.jsx)(l.W.Item,{label:"Copy link",icon:"share-alt",onClick:()=>V(tt)}),be&&(0,t.jsx)(l.W.Item,{label:"Export",icon:"download-alt",childItems:[(0,t.jsx)(w,{identifier:Ve},"export-with-modifications")]}),ze&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.W.Divider,{}),Ke.map(He=>(0,t.jsx)(l.W.Item,{label:He.title,icon:He.icon,onClick:He.onClick},He.id))]}),ge&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.W.Divider,{}),(0,t.jsx)(l.W.Item,{label:"Delete",icon:"trash-alt",destructive:!0,onClick:()=>Ue(ye)})]})]});return(0,t.jsx)(d.m,{overlay:(0,t.jsx)(l.W,{children:gt}),children:(0,t.jsx)(D.A,{size:We})})};function V(ye){navigator.clipboard?.writeText(ye).then(()=>{c.A.emit(i.r1.alertSuccess,["URL copied to clipboard"])})}const w=({identifier:ye})=>{const Ve=location.pathname+location.search,Me=(0,L.G)(`/alerting/${encodeURIComponent(I.$9(ye))}/modify-export`,{returnTo:Ve});return(0,t.jsx)(l.W.Item,{label:"With modifications",icon:"file-edit-alt",url:Me},"with-modifications")},z=F;var N=e(39601),H=e(96374),Q=e(99140),X=e(24608),ee=e(96065),Z=e(99935),q=e(26627);const ae=(0,X.w)(),k=(ye=!1)=>{const[Ve,Me]=(0,s.useState)(),[Ce]=(0,ee.Y)(),{waitForRemoval:Ue}=(0,Z.I)(),Ae=(0,s.useCallback)(()=>{Me(void 0)},[]),we=(0,s.useCallback)(at=>{Me(at)},[]),We=(0,s.useCallback)(async at=>{if(!at?.rulerRule)return;const ut=(0,o.Uw)(at),Tt=(0,I.mw)(ut,at.rulerRule);await Ce.execute(ut,Tt),(0,Q.JD)((0,q.Lc)({rulesSourceName:ut.dataSourceName})),ae&&(0,o.X4)(Tt)?await Ue(Tt):await(0,Q.JD)((0,q.eB)({rulesSourceName:ut.dataSourceName})),Ae(),ye&&N.Ny.replace("/alerting/list")},[Ce,Ae,ye,Ue]);return[(0,s.useMemo)(()=>(0,t.jsx)(H.u,{isOpen:!!Ve,title:"Delete rule",body:"Deleting this rule will permanently remove it from your alert rule list. Are you sure you want to delete this rule?",confirmText:"Yes, delete",icon:"exclamation-triangle",onConfirm:()=>We(Ve),onDismiss:Ae}),[We,Ae,Ve]),we,Ae]};var se=e(75648),te=e(87978),ne=e(98569),le=e(17272),re=e(57220);const oe=({rulerRule:ye,onClose:Ve})=>{const{uid:Me}=ye.grafana_alert,Ce=(0,le.Di)();return(0,t.jsx)(te._,{title:"Silence alert rule",subtitle:"Configure silences to stop notifications from a particular alert rule.",onClose:Ve,size:"md",children:(0,t.jsx)(g.B,{direction:"column",children:(0,t.jsx)(ne.G,{ruleUid:Me,formValues:Ce,alertManagerSourceName:re.hY,onSilenceCreated:Ve,onCancel:Ve})})})};var J=e(14285),ce=e(70383),pe=e(31678),xe=e(51921);const fe=ye=>window.matchMedia(`(max-width: ${ye}px)`).matches,Ee=({compact:ye,showViewButton:Ve,showCopyLinkButton:Me,rule:Ce,rulesSource:Ue})=>{const Ae=(0,pe.useDispatch)(),we=(0,a.of)(Se),We=!ye,[_e,at]=k(We),[ut,Tt]=(0,s.useState)(!1),[It,ge]=(0,s.useState)(void 0),{namespace:Ie,group:ue,rulerRule:me}=Ce,{hasActiveFilters:Pe}=(0,J.dI)(),Ne=(0,o.lT)(Ce.rulerRule)&&!!Ce.rulerRule.grafana_alert.provenance,[Fe,Be]=(0,M.mh)(Ce,M.j5.Update),he=Fe&&Be,be=[],Ke=(0,n.cx)({[we.compactButton]:ye}),ze=ye?"sm":"md",nt=(0,re.EV)(Ue),tt=I.UP(nt,Ce);if(Ve&&be.push((0,t.jsx)(r.z9,{tooltip:ye?"View":void 0,tooltipPlacement:"top",className:Ke,title:"View",size:ze,variant:"secondary",icon:"eye",href:(0,v.w$)(Ue,Ce),children:!ye&&"View"},"view")),me&&he){const ot=I.P1(nt,Ie.name,ue.name,me),gt=(0,L.G)(`/alerting/${encodeURIComponent(I.$9(ot))}/edit`);be.push((0,t.jsx)(r.z9,{tooltip:ye?"Edit":void 0,tooltipPlacement:"top",title:"Edit",className:Ke,size:ze,variant:"secondary",icon:"pen",href:gt,children:!ye&&"Edit"},"edit"))}return(0,t.jsxs)(g.B,{gap:1,children:[be,(0,t.jsx)(z,{buttonSize:ze,rule:Ce,identifier:tt,showCopyLinkButton:Me,handleDelete:()=>at(Ce),handleSilence:()=>Tt(!0),handleDuplicateRule:()=>ge({identifier:tt,isProvisioned:Ne}),onPauseChange:()=>{const ot=Pe?void 0:se.Ys+1;Ae((0,q.Lc)({rulesSourceName:re.hY,limitAlerts:ot}))}}),_e,(0,o.pv)(Ce.rulerRule)&&ut&&(0,t.jsx)(ce.b9,{accessType:"instance",children:(0,t.jsx)(oe,{rulerRule:Ce.rulerRule,onClose:()=>Tt(!1)})}),It?.identifier&&(0,t.jsx)(xe.Z,{identifier:It.identifier,isProvisioned:It.isProvisioned,onDismiss:()=>ge(void 0)})]})},Se=ye=>({compactButton:(0,n.css)({padding:`0 ${ye.spacing(2)}`})})},75648:(G,R,e)=>{"use strict";e.d(R,{Ys:()=>Z,DI:()=>q});var t=e(74848),n=e(32196),s=e(72724),a=e(47232),r=e(40845),g=e(56034),i=e(97814),l=e(86783),d=e(33225),c=e(23662),h=e(25968),o=e(69087),m=e(84396),u=e(71223);function p(se){const te=(0,r.of)(f),{annotations:ne}=se,le=(0,d.gO)(ne);return ne.length===0?null:(0,t.jsx)("div",{className:te.annotations,children:ne.map(([re,de])=>(0,t.jsx)(u.s,{annotationKey:re,value:de,valueLink:le.get(re)},re))})}const f=()=>({annotations:(0,n.css)({marginTop:"46px"})});var y=e(96540),x=e(80997),v=e(14778),P=e(55852),E=e(67061),D=e(19073),C=e(46013),b=e(55740),T=e(57220),S=e(78742);const M=({rule:se,rulesSource:te})=>{const{group:ne}=se,{StateHistoryModal:le,showStateHistoryModal:re}=(0,C.G)(),de=(0,v.i)(),[oe,J]=(0,D.mh)(se,D.j5.Explore),ce=[],pe=(0,c.YN)(ne);if((0,T.Eb)(te)&&oe&&J&&!pe&&ce.push((0,t.jsx)(P.z9,{size:"sm",variant:"primary",icon:"chart-line",target:"_blank",href:(0,S.Yp)(te,se.query),children:"See graph"},"explore")),se.annotations[b.YH.runbookURL]&&ce.push((0,t.jsx)(P.z9,{size:"sm",variant:"primary",icon:"book",target:"_blank",href:x.sQ.sanitizeUrl(se.annotations[b.YH.runbookURL]),children:"View runbook"},"runbook")),se.annotations[b.YH.dashboardUID]){const xe=se.annotations[b.YH.dashboardUID];if(xe){ce.push((0,t.jsx)(P.z9,{size:"sm",variant:"primary",icon:"apps",href:`d/${encodeURIComponent(xe)}`,onClick:()=>{de(se.name)},children:"Go to dashboard"},"dashboard"));const fe=se.annotations[b.YH.panelID];fe&&ce.push((0,t.jsx)(P.z9,{size:"sm",variant:"primary",icon:"apps",href:`d/${encodeURIComponent(xe)}?viewPanel=${encodeURIComponent(fe)}`,onClick:()=>{de(se.name)},children:"Go to panel"},"panel"))}}return(0,c.pv)(se.rulerRule)&&ce.push((0,t.jsxs)(y.Fragment,{children:[(0,t.jsx)(P.$n,{size:"sm",icon:"history",onClick:()=>(0,c.lT)(se.rulerRule)&&re(se.rulerRule),children:"Show state history"}),le]},"history")),ce.length?(0,t.jsx)(E.B,{children:ce}):null};var I=e(19347),L=e(66718);function B(se){const{rulesSource:te,rule:ne}=se,le=(0,r.of)(j),re=(0,y.useMemo)(()=>{if((0,T.Eb)(te))return[{name:te.name,icon:te.meta.info.logos.small}];if((0,c.lT)(ne.rulerRule)){const{data:de}=ne.rulerRule.grafana_alert,oe=de.reduce((J,ce)=>{const pe=(0,I.l)().getInstanceSettings(ce.datasourceUid);return!pe||pe.uid===L.Uj||(J[pe.name]={name:pe.name,icon:pe.meta.info.logos.small}),J},{});return Object.values(oe)}return[]},[ne,te]);return re.length===0?null:(0,t.jsx)(m.X,{label:"Data source",children:re.map(({name:de,icon:oe},J)=>(0,t.jsxs)("div",{children:[oe&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("img",{alt:`${de} datasource logo`,className:le.dataSourceIcon,src:oe})," "]}),de]},de))})}function j(se){const te=se.spacing(2);return{dataSourceIcon:(0,n.css)({width:te,height:te})}}var A=e(28848),K=e(29317),W=e(20719),U=e(41781),F=e(72307),V=e(71713),w=e(73750);const z=({language:se,expr:te})=>{const ne=(0,y.useMemo)(()=>[(0,U.D)({onlyIn:re=>"type"in re&&re.type==="code_block",getSyntax:()=>se},{...A.languages,[se]:se==="logql"?V.Ay:W.n6})],[se]),le=(0,y.useMemo)(()=>(0,F.mO)(te),[te]);return(0,t.jsx)(K.Editor,{"data-testid":"expression-editor",plugins:ne,value:le})},N=({expression:se,rulesSource:te})=>{const ne=(0,r.of)(H);return(0,t.jsx)(w.L,{className:(0,n.cx)(ne.well,"slate-query-field"),children:(0,T.Eb)(te)?(0,t.jsx)(z,{expr:se,language:te.type===T.ol.Loki?"logql":"promql"}):se})},H=se=>({well:(0,n.css)({fontFamily:se.typography.fontFamilyMonospace})});function Q(se){const{annotations:te,rulesSource:ne,rule:le}=se,re=X();return(0,T.Eb)(ne)?(0,t.jsx)(m.X,{label:"Expression",horizontal:!0,className:(0,n.cx)({[re.exprRow]:!!te.length}),children:(0,t.jsx)(N,{expression:le.query,rulesSource:ne})}):null}const X=()=>({exprRow:(0,n.css)({marginBottom:"46px"})});var ee=e(99938);const Z=15,q=({rule:se})=>{const te=(0,r.of)(k),{namespace:{rulesSource:ne}}=se,le=(0,d.Hx)(se.annotations);return(0,t.jsxs)("div",{children:[(0,t.jsx)(M,{rule:se,rulesSource:ne}),(0,t.jsxs)("div",{className:te.wrapper,children:[(0,t.jsxs)("div",{className:te.leftSide,children:[(0,t.jsx)(ae,{rule:se}),!!se.labels&&!!Object.keys(se.labels).length&&(0,t.jsx)(m.X,{label:"Labels",horizontal:!0,children:(0,t.jsx)(o.m,{labels:se.labels})}),(0,t.jsx)(Q,{rulesSource:ne,rule:se,annotations:le}),(0,t.jsx)(p,{annotations:le})]}),(0,t.jsx)("div",{className:te.rightSide,children:(0,t.jsx)(B,{rulesSource:ne,rule:se})})]}),(0,t.jsx)(m.X,{label:"Instances",horizontal:!0,children:(0,t.jsx)(ee.s,{rule:se,itemsDisplayLimit:Z})})]})},ae=({rule:se})=>{const te=se.group.interval,ne=se.promRule?.lastEvaluation,le=se.promRule?.evaluationTime,re=(0,c.Gy)(se.rulerRule)?se.rulerRule?.grafana_alert.record?.metric:void 0,de=(0,l.G)(se);return(0,t.jsxs)(t.Fragment,{children:[re&&(0,t.jsx)(m.X,{label:"Metric",horizontal:!0,children:re}),te&&(0,t.jsxs)(m.X,{label:"Evaluate",horizontal:!0,children:["Every ",te]}),de&&(0,t.jsx)(m.X,{label:"Pending period",horizontal:!0,children:de}),ne&&!(0,h.mo)(ne)&&(0,t.jsx)(m.X,{label:"Last evaluation",horizontal:!0,children:(0,t.jsx)(g.m,{placement:"top",content:`${(0,s.LE)(ne,{format:"YYYY-MM-DD HH:mm:ss"})}`,theme:"info",children:(0,t.jsx)("span",{children:`${(0,a.KQ)(ne).locale("en").fromNow(!0)} ago`})})}),ne&&!(0,h.mo)(ne)&&le!==void 0&&(0,t.jsx)(m.X,{label:"Evaluation time",horizontal:!0,children:(0,t.jsx)(g.m,{placement:"top",content:`${le}s`,theme:"info",children:(0,t.jsx)("span",{children:(0,i.g)({timeInMs:le*1e3,humanize:!0})})})})]})},k=se=>({wrapper:(0,n.css)({display:"flex",flexDirection:"row",[se.breakpoints.down("md")]:{flexDirection:"column"}}),leftSide:(0,n.css)({flex:1}),rightSide:(0,n.css)({[se.breakpoints.up("md")]:{paddingLeft:"90px",width:"300px"}})})},99938:(G,R,e)=>{"use strict";e.d(R,{s:()=>C});var t=e(74848),n=e(32196),s=e(2543),a=e(96540),r=e(40845),g=e(55852),i=e(53876),l=e(78369),d=e(60029),c=e(94354),h=e(94822);const o=({className:S,onStateFilterChange:O,stateFilter:M,filterType:I,itemPerStateStats:L})=>{const B=(0,r.of)(m),j=F=>function(){return L&&L[F]?(0,t.jsx)(l.v,{name:L[F].toFixed(0),colorIndex:9,className:B.tag}):null},A=Object.values(h.Gi).map(F=>({label:F,value:F,component:j(F)})),W=[h.cF.Firing,h.cF.Pending].map(F=>({label:(0,s.capitalize)(F),value:F,component:j(F)})),U=I==="grafana"?A:W;return(0,t.jsxs)("div",{className:S,"data-testid":"alert-instance-state-filter",children:[(0,t.jsx)(d.J,{children:"State"}),(0,t.jsx)(c.z,{options:U,value:M,onChange:O,onClick:F=>{F===M&&O(void 0)}})]})};function m(S){return{tag:(0,n.css)({fontSize:"11px",fontWeight:"normal",padding:S.spacing(.25,.5),verticalAlign:"middle",marginLeft:S.spacing(.5)})}}var u=e(98164),p=e(78742),f=e(64861),y=e(57220),x=e(32642),v=e(23662),P=e(2426),E=e(92467);function D({stats:S,onClick:O,href:M}){const I=(0,r.of)(T);return(0,t.jsxs)("div",{className:I.footerRow,children:[(0,t.jsxs)("div",{children:["Showing ",S.visibleItemsCount," out of ",S.totalItemsCount," instances"]}),(0,t.jsxs)(g.z9,{size:"sm",variant:"secondary","data-testid":"show-all",onClick:O,href:M,children:["Show all ",S.totalItemsCount," alert instances"]})]})}function C(S){const{rule:O,itemsDisplayLimit:M=Number.POSITIVE_INFINITY,pagination:I,enableFiltering:L=!1}=S,{promRule:B,namespace:j,instanceTotals:A}=O,[K,W]=(0,a.useState)(),[U,F]=(0,a.useState)(),[V]=(0,a.useState)(Math.floor(Math.random()*100)),w=`queryString-${V}`,z=(0,r.of)(T),N=(0,y.z2)(j.rulesSource)?y.hY:"prometheus",H=(0,a.useMemo)(()=>(0,v.Z8)(B)&&B.alerts?.length?b(K,U,(0,p.Cp)(f.xB.Importance,B.alerts)):[],[B,U,K]);if(!(0,v.Z8)(B))return null;const Q=H.slice(0,M),X=(0,s.countBy)(B.alerts,ne=>(0,h.lh)(ne.state)),ee=(0,s.sum)([A.alerting,A.inactive,A.pending,A.nodata]),Z=ee-Q.length,q={totalItemsCount:ee,visibleItemsCount:Q.length},ae=(0,p.w$)(j.rulesSource,S.rule,location.pathname+location.search),k=(0,E.kc)(A),se=()=>F(void 0),te=Z?(0,t.jsx)(D,{stats:q,onClick:L?se:void 0,href:L?void 0:ae}):void 0;return(0,t.jsxs)(t.Fragment,{children:[L&&(0,t.jsx)("div",{className:(0,n.cx)(z.flexRow,z.spaceBetween),children:(0,t.jsxs)("div",{className:z.flexRow,children:[(0,t.jsx)(i.X,{defaultQueryString:K,onFilterChange:ne=>W(ne)},w),(0,t.jsx)(o,{filterType:N,stateFilter:U,onStateFilterChange:F,itemPerStateStats:X})]})}),!L&&(0,t.jsx)("div",{className:z.stats,children:k}),(0,t.jsx)(P.D,{rule:O,instances:Q,pagination:I,footerRow:te})]})}function b(S,O,M){let I=[...M];if(S){const L=S?(0,x.Zc)(S):[];I=I.filter(({labels:B})=>(0,u.Av)(B,L))}return O&&(I=I.filter(L=>(0,h.lh)(L.state)===O)),I}const T=S=>({flexRow:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"flex-end",width:"100%",flexWrap:"wrap",marginBottom:S.spacing(1),gap:S.spacing(1)}),spaceBetween:(0,n.css)({justifyContent:"space-between"}),footerRow:(0,n.css)({display:"flex",flexDirection:"column",gap:S.spacing(1),justifyContent:"space-between",alignItems:"center",width:"100%"}),instancesContainer:(0,n.css)({marginBottom:S.spacing(2)}),stats:(0,n.css)({display:"flex",gap:S.spacing(1),padding:S.spacing(1,0)})})},92467:(G,R,e)=>{"use strict";e.d(R,{M_:()=>o,j7:()=>p,kc:()=>f});var t=e(74848),n=e(2543),s=e.n(n),a=e(55127),r=e.n(a),g=e(96540),i=e(67061),l=e(39938),d=e(21460),c=e(94822);const h={recording:0,alerting:0,[c.cF.Pending]:0,[c.cF.Inactive]:0,paused:0,error:0,nodata:0},o=g.memo(({namespaces:y})=>{const x=(0,g.useDeferredValue)(y),v=(0,g.useMemo)(()=>m(x),[x]),P=u(v),E=f(v),D=!!E.length;return E.unshift((0,t.jsxs)(g.Fragment,{children:[P," ",r()("rule",P)]},"total")),(0,t.jsx)(i.B,{direction:"row",children:D&&(0,t.jsx)("div",{children:(0,t.jsx)(i.B,{gap:.5,children:E})})})});o.displayName="RuleStats";function m(y){const x={...h};return y.forEach(({groups:v})=>{v.forEach(P=>{const E=(0,n.omitBy)(P.totals,n.isUndefined);for(const D in E)x[D]+=E[D]})}),x}function u(y){const x=(0,n.pick)(y,["alerting","pending","inactive","recording"]);return(0,n.sum)(Object.values(x))}const p=({group:y})=>{const x=y.totals,v=y?.interval,P=f(x),E=!!P.length;return(0,t.jsxs)(i.B,{direction:"row",children:[E&&(0,t.jsx)("div",{children:(0,t.jsx)(i.B,{gap:.5,children:P})}),v&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{children:"|"}),(0,t.jsx)(l.E,{text:v,icon:"clock-nine",color:"blue"})]})]})};function f(y){const x=[];return y[d.$.Alerting]&&x.push((0,t.jsx)(l.E,{color:"red",text:`${y[d.$.Alerting]} firing`},"firing")),y.error&&x.push((0,t.jsx)(l.E,{color:"red",text:`${y.error} ${r()("error",y.error)}`},"errors")),y.nodata&&x.push((0,t.jsx)(l.E,{color:"blue",text:`${y.nodata} no data`},"nodata")),y[d.$.Pending]&&x.push((0,t.jsx)(l.E,{color:"orange",text:`${y[d.$.Pending]} pending`},"pending")),y[d.$.Normal]&&y.paused&&x.push((0,t.jsx)(l.E,{color:"green",text:`${y[d.$.Normal]} normal (${y.paused} paused)`},"paused")),y[d.$.Normal]&&!y.paused&&x.push((0,t.jsx)(l.E,{color:"green",text:`${y[d.$.Normal]} normal`},"inactive")),y.recording&&x.push((0,t.jsx)(l.E,{color:"purple",text:`${y.recording} recording`},"recording")),x}},80215:(G,R,e)=>{"use strict";e.d(R,{s:()=>ae});var t=e(74848),n=e(32196),s=e(96540),a=e(70255),r=e(40845),g=e(19384),i=e(56034),l=e(15054),d=e(79938),c=e(77583),h=e(24608),o=e(6833),m=e(9518),u=e(83903),p=e(98439),f=e(85244),y=e(55740),x=e(57220),v=e(23662),P=e(75591),E=e(10562),D=e(48205),C=e(82437),b=e(16577),T=e(13064),S=e(35896),O=e(32264),M=e(14578),I=e(82775);function L({rule:de}){const oe=(0,r.of)(B),J=(0,v.lT)(de.rulerRule);return(0,s.useMemo)(()=>J?(0,I.q)(de.group.interval).exceedsLimit:!1,[de.group.interval,J])?(0,t.jsx)(i.m,{theme:"error",content:(0,t.jsxs)("div",{children:["A minimum evaluation interval of"," ",(0,t.jsx)("span",{className:oe.globalLimitValue,children:O.$.unifiedAlerting.minInterval})," has been configured in Grafana and will be used instead of the ",de.group.interval," interval configured for the Rule Group."]}),children:(0,t.jsx)(M.I,{name:"stopwatch-slash",className:oe.icon})}):null}function B(de){return{globalLimitValue:(0,n.css)({fontWeight:de.typography.fontWeightBold}),icon:(0,n.css)({fill:de.colors.warning.text})}}var j=e(75648),A=e(39890);const K=({rule:de})=>{const oe=(0,r.of)(W);return(0,A.lf)(de.health)?(0,t.jsx)(i.m,{theme:"error",content:de.lastError||"No error message provided.",children:(0,t.jsxs)("div",{className:oe.warn,children:[(0,t.jsx)(M.I,{name:"exclamation-triangle"}),(0,t.jsx)("span",{children:"error"})]})}):(0,t.jsx)(t.Fragment,{children:de.health})},W=de=>({warn:(0,n.css)({display:"inline-flex",flexDirection:"row",alignItems:"center",gap:de.spacing(1),color:de.colors.warning.text})});var U=e(70416),F=e(67061),V=e(62930),w=e(8484),z=e(94822),N=e(65415),H=e(30423);const Q=({rule:de,isDeleting:oe,isCreating:J,isPaused:ce})=>{const pe=(0,r.of)(X),{promRule:xe,rulerRule:fe}=de,Ee=()=>ce&&(0,v.Gy)(fe)?(0,t.jsx)(i.m,{content:"Recording rule evaluation is currently paused",placement:"top",children:(0,t.jsxs)(N.O,{state:"warning",children:[(0,t.jsx)(M.I,{name:"pause",size:"xs"}),(0,t.jsx)(w.x6,{i18nKey:"alerting.rule-state.paused",children:"Paused"})]})}):(0,t.jsx)(w.x6,{i18nKey:"alerting.rule-state.recording-rule",children:"Recording rule"}),Se=(0,s.useMemo)(()=>{if(xe&&(0,v.Z8)(xe)&&xe.alerts?.length&&xe.state!==z.cF.Inactive){const ye=xe.activeAt?new Date(xe.activeAt):(0,v.Om)(xe);if(ye)return(0,t.jsxs)("span",{title:String(ye),className:pe.for,children:["for"," ",(0,U.dU)({start:ye,end:new Date},!1)]})}return null},[xe,pe]);return oe?(0,t.jsxs)(F.B,{gap:1,children:[(0,t.jsx)(V.y,{}),(0,t.jsx)(w.x6,{i18nKey:"alerting.rule-state.deleting",children:"Deleting"})]}):J?(0,t.jsxs)(F.B,{gap:1,children:[(0,t.jsx)(V.y,{}),(0,t.jsx)(w.x6,{i18nKey:"alerting.rule-state.creating",children:"Creating"})]}):xe&&(0,v.Z8)(xe)?(0,t.jsxs)(F.B,{gap:1,children:[(0,t.jsx)(H.C,{state:xe.state,isPaused:ce}),!ce&&Se]}):xe&&(0,v.KB)(xe)?(0,t.jsx)(Ee,{}):(0,t.jsx)(t.Fragment,{children:"n/a"})},X=de=>({for:(0,n.css)({fontSize:de.typography.bodySmall.fontSize,color:de.colors.text.secondary,whiteSpace:"nowrap",paddingTop:"2px"})}),ee=(0,h.w)(),{useLazyGetRuleGroupForNamespaceQuery:Z}=d.hK,{useLazyDiscoverDsFeaturesQuery:q}=c.L,ae=({rules:de,className:oe,showGuidelines:J=!1,emptyMessage:ce="No rules found.",showGroupColumn:pe=!1,showSummaryColumn:xe=!1,showNextEvaluationColumn:fe=!1})=>{const Ee=(0,r.of)(se),Se=(0,n.cx)(Ee.wrapper,oe,{[Ee.wrapperMargin]:J}),{pageItems:ye,page:Ve,numberOfPages:Me,onPageChange:Ce}=(0,p.W)(de,1,l.FG),{result:Ue,status:Ae}=k(ye),we=Ae==="loading",We=(0,s.useMemo)(()=>Ue.map((ut,Tt)=>({id:`${ut.namespace.name}-${ut.group.name}-${ut.name}-${Tt}`,data:ut})),[Ue]),_e=te(xe,pe,fe,we);if(!ye.length)return(0,t.jsx)("div",{className:(0,n.cx)(Se,Ee.emptyMessage),children:ce});const at=J?E.B:P.E;return(0,t.jsxs)("div",{className:Se,"data-testid":"rules-table",children:[(0,t.jsx)(at,{cols:_e,isExpandable:!0,items:We,renderExpandedContent:({data:ut})=>(0,t.jsx)(j.DI,{rule:ut})}),(0,t.jsx)(g.d,{currentPage:Ve,numberOfPages:Me,onNavigate:Ce,hideWhenSinglePage:!0,className:Ee.pagination})]})};function k(de){const[oe]=Z(),[J]=q(),[ce,pe]=(0,o.Yb)(async()=>Promise.all(de.map(async fe=>{const Ee=await J({rulesSourceName:(0,x.EV)(fe.namespace.rulesSource)},!0).unwrap();if(Ee.rulerConfig&&fe.namespace.rulesSource!==x.hY){const Se=await oe({namespace:fe.namespace.name,group:fe.group.name,rulerConfig:Ee.rulerConfig},!0).unwrap();(0,m.yh)(fe,Se)}return fe})),de);return(0,s.useEffect)(()=>{ee?ce.execute():ce.reset()},[de,ce]),pe}const se=de=>({wrapperMargin:(0,n.css)({[de.breakpoints.up("md")]:{marginLeft:"36px"}}),emptyMessage:(0,n.css)({padding:de.spacing(1)}),wrapper:(0,n.css)({width:"auto",borderRadius:de.shape.radius.default}),skeletonWrapper:(0,n.css)({flex:1}),pagination:(0,n.css)({display:"flex",margin:0,paddingTop:de.spacing(1),paddingBottom:de.spacing(.25),justifyContent:"center",borderLeft:`1px solid ${de.colors.border.medium}`,borderRight:`1px solid ${de.colors.border.medium}`,borderBottom:`1px solid ${de.colors.border.medium}`,float:"none"})});function te(de,oe,J,ce){return(0,s.useMemo)(()=>{const pe=[{id:"state",label:"State",renderCell:({data:xe})=>(0,t.jsx)(ne,{rule:xe}),size:"165px"},{id:"name",label:"Name",renderCell:({data:xe})=>xe.name,size:J?4:5},{id:"metadata",label:"",renderCell:({data:xe})=>{const fe=xe.rulerRule,Ee=(0,v.uo)(xe);return Ee?(0,t.jsx)(f.T,{pluginId:Ee.pluginId}):(0,v.lT)(fe)&&fe.grafana_alert.provenance?(0,t.jsx)(D.rS,{}):null},size:"100px"},{id:"warnings",label:"",renderCell:({data:xe})=>(0,t.jsx)(L,{rule:xe}),size:"45px"},{id:"health",label:"Health",renderCell:({data:{promRule:xe,group:fe}})=>xe?(0,t.jsx)(K,{rule:xe}):null,size:"75px"}];return de&&pe.push({id:"summary",label:"Summary",renderCell:({data:xe})=>(0,t.jsx)(b.Y,{input:xe.annotations[y.YH.summary]??""}),size:J?4:5}),J&&pe.push({id:"nextEvaluation",label:"Next evaluation",renderCell:({data:xe})=>{const fe=(0,T.C)(xe.promRule?.lastEvaluation,xe.group.interval);return fe&&(0,t.jsx)(i.m,{placement:"top",content:`${fe?.fullDate}`,theme:"info",children:(0,t.jsx)("span",{children:fe?.humanized})})},size:2}),oe&&pe.push({id:"group",label:"Group",renderCell:({data:xe})=>{const{namespace:fe,group:Ee}=xe;return Ee.name==="default"?(0,t.jsx)(C.c,{namespace:fe.name}):(0,t.jsx)(C.c,{namespace:fe.name,group:Ee.name})},size:5}),pe.push({id:"actions",label:"Actions",renderCell:({data:xe})=>(0,t.jsx)(le,{rule:xe,isLoadingRuler:ce}),size:"200px"}),pe},[de,oe,J,ce])}function ne({rule:de}){const{isDeleting:oe,isCreating:J,isPaused:ce}=re(de);return(0,t.jsx)(Q,{rule:de,isDeleting:oe,isCreating:J,isPaused:ce})}function le({rule:de,isLoadingRuler:oe}){const J=(0,r.of)(se),{isDeleting:ce,isCreating:pe}=re(de);return oe?(0,t.jsx)(a.A,{containerClassName:J.skeletonWrapper}):(0,t.jsx)(S.l,{compact:!0,showViewButton:!ce&&!pe,rule:de,rulesSource:de.namespace.rulesSource})}function re(de){const{hasRuler:oe,rulerRulesLoaded:J}=(0,u.y)(de.namespace.rulesSource),{promRule:ce,rulerRule:pe}=de;if(ee&&!(0,v.lT)(pe))return{isDeleting:!1,isCreating:!1,isPaused:!1};const xe=!!(oe&&J&&ce&&!pe),fe=!!(oe&&J&&pe&&!ce),Ee=(0,v.lT)(pe)&&(0,v.HH)(pe);return{isDeleting:xe,isCreating:fe,isPaused:Ee}}},97754:(G,R,e)=>{"use strict";e.d(R,{y:()=>r});var t=e(74848),n=e(60021),s=e(65415);const a={[n.Or.Active]:"bad",[n.Or.Unprocessed]:"neutral",[n.Or.Suppressed]:"info"},r=({state:g})=>(0,t.jsx)(s.O,{state:a[g],children:g})},98569:(G,R,e)=>{"use strict";e.d(R,{G:()=>ne,A:()=>re});var t=e(74848),n=e(32196),s=e(2543),a=e(96540),r=e(49785),g=e(54148),i=e(40996),l=e(70416),d=e(47232),c=e(17172),h=e(39601),o=e(32264),m=e(39558),u=e(42418),p=e(40845),f=e(84167),y=e(88575),x=e(10354),v=e(21744),P=e(67061),E=e(55852),D=e(91540),C=e(55740),b=e(57220),T=e(60021),S=e(19073),O=e(98164),M=e(78742),I=e(25994),L=e(90182),B=e(29158),j=e(79938);const A=({className:de,required:oe,ruleUid:J})=>{const ce=(0,p.of)(K),pe=(0,r.xW)(),{control:xe,register:fe,formState:{errors:Ee}}=pe,{fields:Se=[],append:ye,remove:Ve}=(0,r.jz)({name:"matchers"}),[Me,{data:Ce}]=j.hK.endpoints.getAlertRule.useLazyQuery();return(0,a.useEffect)(()=>{J&&Me({uid:J})},[Me,J]),(0,t.jsx)("div",{className:de,children:(0,t.jsx)(y.D,{label:"Refine affected alerts",required:oe,children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:(0,n.cx)(ce.matchers,ce.indent),children:[Ce&&(0,t.jsxs)("div",{children:[(0,t.jsx)(y.D,{label:"Alert rule",disabled:!0,children:(0,t.jsx)(x.p,{id:"alert-rule-name",defaultValue:Ce.grafana_alert.title,disabled:!0})}),(0,t.jsx)(I.c,{})]}),Se.map((Ue,Ae)=>(0,t.jsxs)("div",{className:ce.row,"data-testid":"matcher",children:[(0,t.jsx)(y.D,{label:"Label",invalid:!!Ee?.matchers?.[Ae]?.name,error:Ee?.matchers?.[Ae]?.name?.message,children:(0,t.jsx)(x.p,{...fe(`matchers.${Ae}.name`,{required:{value:oe,message:"Required."}}),defaultValue:Ue.name,placeholder:"label",id:`matcher-${Ae}-label`})}),(0,t.jsx)(y.D,{label:"Operator",children:(0,t.jsx)(r.xI,{control:xe,render:({field:{onChange:we,ref:We,..._e}})=>(0,t.jsx)(L.l6,{..._e,onChange:at=>we(at.value),className:ce.matcherOptions,options:O.xH,"aria-label":"operator",id:`matcher-${Ae}-operator`}),defaultValue:Ue.operator||O.xH[0].value,name:`matchers.${Ae}.operator`,rules:{required:{value:oe,message:"Required."}}})}),(0,t.jsx)(y.D,{label:"Value",invalid:!!Ee?.matchers?.[Ae]?.value,error:Ee?.matchers?.[Ae]?.value?.message,children:(0,t.jsx)(x.p,{...fe(`matchers.${Ae}.value`,{required:{value:oe,message:"Required."}}),defaultValue:Ue.value,placeholder:"value",id:`matcher-${Ae}-value`})}),(Se.length>1||!oe)&&(0,t.jsx)(B.K,{"aria-label":"Remove matcher",className:ce.removeButton,name:"trash-alt",onClick:()=>Ve(Ae),children:"Remove"})]},`${Ue.id}`))]}),(0,t.jsx)(E.$n,{className:ce.indent,tooltip:"Refine which alert instances are silenced by selecting label matchers",type:"button",icon:"plus",variant:"secondary",onClick:()=>{const Ue={name:"",value:"",operator:T.ho.equal};ye(Ue)},children:"Add matcher"})]})})})},K=de=>({wrapper:(0,n.css)({marginTop:de.spacing(2)}),row:(0,n.css)({marginTop:de.spacing(1),display:"flex",alignItems:"flex-start",flexDirection:"row",backgroundColor:de.colors.background.secondary,padding:`${de.spacing(1)} ${de.spacing(1)} 0 ${de.spacing(1)}`,"& > * + *":{marginLeft:de.spacing(2)}}),removeButton:(0,n.css)({marginLeft:de.spacing(1),marginTop:de.spacing(2.5)}),matcherOptions:(0,n.css)({minWidth:"140px"}),matchers:(0,n.css)({maxWidth:`${de.breakpoints.values.sm}px`,margin:`${de.spacing(1)} 0`,paddingTop:de.spacing(.5)}),indent:(0,n.css)({marginLeft:de.spacing(2)})}),W=A;var U=e(54230);const F=()=>{const{control:de,getValues:oe}=(0,r.xW)(),{field:{onChange:J,value:ce},fieldState:{invalid:pe}}=(0,r.as)({name:"startsAt",control:de,rules:{validate:Ue=>oe().endsAt>Ue}}),{field:{onChange:xe,value:fe},fieldState:{invalid:Ee}}=(0,r.as)({name:"endsAt",control:de,rules:{validate:Ue=>oe().startsAt<Ue}}),{field:{onChange:Se,value:ye}}=(0,r.as)({name:"timeZone",control:de}),Ve=pe||Ee,Me=(0,d.KQ)(ce),Ce=(0,d.KQ)(fe);return(0,t.jsx)(y.D,{className:V.timeRange,label:"Silence start and end",error:Ve?"To is before or the same as from":"",invalid:Ve,children:(0,t.jsx)(U.b,{value:{from:Me,to:Ce,raw:{from:Me,to:Ce}},timeZone:ye,onChange:Ue=>{J((0,d.KQ)(Ue.from)),xe((0,d.KQ)(Ue.to))},onChangeTimeZone:Ue=>Se(Ue),hideTimeZone:!1,hideQuickRanges:!0,placeholder:"Select time range"})})},V={timeRange:(0,n.css)({width:"400px"})};var w=e(45214),z=e(39938),N=e(82843),H=e(25968),Q=e(69087),X=e(75591),ee=e(97754);const Z=(de,oe,J)=>{const[ce,pe]=(0,a.useState)();(0,i.A)(de,oe,[ce]),(0,w.A)(()=>{pe(J)},[J])},q=({amSourceName:de,matchers:oe,ruleUid:J})=>{const ce=[...J?[{name:C.kW,value:J,operator:T.ho.equal}]:[],...oe].map(O.Wc),pe=N.m.endpoints.getAlertmanagerAlerts.useLazyQuery,xe=(0,p.of)(k),fe=ae(),Ee=J||oe.some(Ue=>Ue.value&&Ue.name),[Se,{currentData:ye=[],isFetching:Ve,isError:Me}]=pe();if(Z(()=>{Ee&&Se({amSourceName:de,filter:{matchers:ce}})},500,[de,ce]),Me)return(0,t.jsx)(u.F,{title:"Preview not available",severity:"error",children:"Error occurred when generating preview of affected alerts. Are your matchers valid?"});const Ce=ye.map(Ue=>({id:Ue.fingerprint,data:Ue}));return(0,t.jsxs)("div",{children:[(0,t.jsxs)("h4",{className:xe.title,children:["Affected alert rule instances",Ce.length>0?(0,t.jsx)(z.E,{className:xe.badge,color:"blue",text:Ce.length}):null]}),!Ee&&(0,t.jsx)("span",{children:"Add a valid matcher to see affected alerts"}),Ve&&(0,t.jsx)(m._,{text:"Loading affected alert rule instances..."}),!Ve&&!Me&&Ee&&(0,t.jsx)("div",{className:xe.table,children:Ce.length>0?(0,t.jsx)(X.E,{items:Ce,isExpandable:!1,cols:fe,pagination:{itemsPerPage:10}}):(0,t.jsx)("span",{children:"No firing alert instances found"})})]})};function ae(){const de=(0,p.of)(k);return[{id:"state",label:"State",renderCell:function({data:J}){return(0,t.jsx)(ee.y,{state:J.status.state})},size:"120px",className:de.stateColumn},{id:"labels",label:"Labels",renderCell:function({data:J}){return(0,t.jsx)(Q.m,{labels:J.labels,size:"sm"})},size:"auto"},{id:"created",label:"Created",renderCell:function({data:J}){return(0,t.jsx)(t.Fragment,{children:(0,H.mo)(J.startsAt)?"-":(0,d.KQ)(J.startsAt).format("YYYY-MM-DD HH:mm:ss")})},size:"180px"}]}const k=de=>({table:(0,n.css)({maxWidth:`${de.breakpoints.values.lg}px`}),moreMatches:(0,n.css)({marginTop:de.spacing(1)}),title:(0,n.css)({display:"flex",alignItems:"center"}),badge:(0,n.css)({marginLeft:de.spacing(1)}),stateColumn:(0,n.css)({display:"flex",alignItems:"center"})});var se=e(17272);const te=({alertManagerSourceName:de})=>{const{id:oe=""}=(0,g.g)(),{data:J,isLoading:ce,error:pe}=D.F.endpoints.getSilence.useQuery({id:oe,datasourceUid:(0,b.w5)(de),ruleMetadata:!0,accessControl:!0}),xe=J?.matchers?.find(Ve=>Ve.name===C.kW)?.value,fe=de===b.hY,Ee=(0,a.useMemo)(()=>{if(!J)return;const Ve=J.matchers?.filter(Me=>Me.name!==C.kW);return(0,se.Ee)({...J,matchers:Ve})},[J]);return oe&&ce?(0,t.jsx)(m._,{text:"Loading existing silence information..."}):(0,c.NF)(pe)&&pe.status===404?(0,t.jsx)(u.F,{title:`Existing silence "${oe}" not found`,severity:"warning"}):(fe?J?.accessControl?.write:!0)?(0,t.jsx)(ne,{ruleUid:xe,formValues:Ee,alertManagerSourceName:de}):(0,t.jsx)(u.F,{title:"You do not have permission to edit/recreate this silence",severity:"error"})},ne=({formValues:de=(0,se.Di)(),alertManagerSourceName:oe,onSilenceCreated:J,onCancel:ce,ruleUid:pe})=>{const[xe,fe]=(0,S.L7)(S.QI.PreviewSilencedInstances),Ee=xe&&fe,[Se,{isLoading:ye}]=D.F.endpoints.createSilence.useMutation(),Ve=(0,r.mN)({defaultValues:de}),Me=(0,p.of)(le),{register:Ce,handleSubmit:Ue,formState:Ae,watch:we,setValue:We,clearErrors:_e}=Ve,[at,ut,Tt,It]=we(["duration","startsAt","endsAt","matchers"]),ge=()=>{h.Ny.push((0,M.nL)("/alerting/silences",oe))},Ie=J||ge,ue=ce||ge,me=async Be=>{const{id:he,startsAt:be,endsAt:Ke,comment:ze,createdBy:nt,matchers:tt}=Be;pe&&tt.push({name:C.kW,value:pe,operator:T.ho.equal});const ot=tt.map(O.Wc).filter(He=>He.name&&He.value),gt=(0,s.pickBy)({id:he,startsAt:be,endsAt:Ke,comment:ze,createdBy:nt,matchers:ot},He=>!!He);await Se({datasourceUid:(0,b.w5)(oe),payload:gt}).unwrap().then(He=>{Ie?.(He)})},[Pe,Ne]=(0,a.useState)(at);(0,i.A)(()=>{if((0,l.vd)(ut)&&(0,l.vd)(Tt))if(at!==Pe)We("endsAt",(0,d.KQ)((0,l.Ri)(new Date(ut),(0,l.E9)(at))).toISOString()),Ne(at);else{const Be=new Date(ut).valueOf();if(new Date(Tt).valueOf()>Be){const be=(0,l.dU)({start:new Date(ut),end:new Date(Tt)});We("duration",be),Ne(be)}}},700,[_e,at,Tt,Pe,We,ut]);const Fe=!!(o.$.bootData.user.isSignedIn&&o.$.bootData.user.name);return(0,t.jsx)(r.Op,{...Ve,children:(0,t.jsxs)("form",{onSubmit:Ue(me),children:[(0,t.jsxs)(f.n,{className:Me.formContainer,children:[(0,t.jsxs)("div",{className:Me.silencePeriod,children:[(0,t.jsx)(F,{}),(0,t.jsx)(y.D,{label:"Duration",invalid:!!Ae.errors.duration,error:Ae.errors.duration&&(Ae.errors.duration.type==="required"?"Required field":Ae.errors.duration.message),children:(0,t.jsx)(x.p,{...Ce("duration",{validate:Be=>Object.keys((0,l.E9)(Be)).length===0?"Invalid duration. Valid example: 1d 4h (Available units: y, M, w, d, h, m, s)":void 0}),id:"duration"})})]}),(0,t.jsx)(W,{required:!pe,ruleUid:pe}),(0,t.jsx)(y.D,{label:"Comment",required:!0,error:Ae.errors.comment?.message,invalid:!!Ae.errors.comment,children:(0,t.jsx)(v.f,{...Ce("comment",{required:{value:!0,message:"Required."}}),rows:5,placeholder:"Details about the silence",id:"comment"})}),!Fe&&(0,t.jsx)(y.D,{label:"Created By",required:!0,error:Ae.errors.createdBy?.message,invalid:!!Ae.errors.createdBy,children:(0,t.jsx)(x.p,{...Ce("createdBy",{required:{value:!0,message:"Required."}}),placeholder:"Who's creating the silence"})}),Ee&&(0,t.jsx)(q,{amSourceName:oe,matchers:It,ruleUid:pe})]}),(0,t.jsxs)(P.B,{gap:1,children:[ye&&(0,t.jsx)(E.$n,{disabled:!0,icon:"spinner",variant:"primary",children:"Saving..."}),!ye&&(0,t.jsx)(E.$n,{type:"submit",children:"Save silence"}),(0,t.jsx)(E.z9,{onClick:ue,variant:"secondary",children:"Cancel"})]})]})})},le=de=>({formContainer:(0,n.css)({maxWidth:de.breakpoints.values.md}),alertRule:(0,n.css)({paddingBottom:de.spacing(2)}),silencePeriod:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"flex-start",gap:de.spacing(1),maxWidth:de.breakpoints.values.sm,paddingTop:de.spacing(2)})}),re=te},17272:(G,R,e)=>{"use strict";e.d(R,{Di:()=>h,Ee:()=>c,LP:()=>d});var t=e(70416),n=e(43127),s=e(47232),a=e(32264),r=e(98164),g=e(55740),i=e(32642),l=e(60021);const d=o=>{const m={},u=o.get("comment"),f=o.getAll("matcher").filter(x=>!x.startsWith(g.kW)),y=(0,i.ou)(f);return y.length&&(m.matchers=y.map(r.MU)),u&&(m.comment=u),m},c=o=>{const m=new Date,p=Date.parse(o.endsAt)<Date.now()?{start:m,end:(0,t.Ri)(m,{hours:2})}:{start:new Date(o.startsAt),end:new Date(o.endsAt)};return{id:o.id,startsAt:p.start.toISOString(),endsAt:p.end.toISOString(),comment:o.comment,createdBy:o.createdBy,duration:(0,t.dU)(p),isRegex:!1,matchers:o.matchers?.map(r.MU)||[],matcherName:"",matcherValue:"",timeZone:n.lE}},h=o=>{const m=new Date,u=(0,t.Ri)(m,{hours:2});return{id:"",startsAt:m.toISOString(),endsAt:u.toISOString(),comment:`created ${(0,s.KQ)().format("YYYY-MM-DD HH:mm")}`,createdBy:a.$.bootData.user.name,duration:"2h",isRegex:!1,matcherName:"",matcherValue:"",timeZone:n.lE,matchers:[{name:"",value:"",operator:l.ho.equal}],...o}}},24608:(G,R,e)=>{"use strict";e.d(R,{w:()=>n});var t=e(32264);const n=()=>t.$.featureToggles.alertingPrometheusRulesPrimary??!1},96065:(G,R,e)=>{"use strict";e.d(R,{Y:()=>g});var t=e(8484),n=e(79938),s=e(48070),a=e(6833),r=e(43482);function g(){const[i]=(0,r.D)(),[l]=n.hK.endpoints.upsertRuleGroupForNamespace.useMutation(),[d]=n.hK.endpoints.deleteRuleGroupFromNamespace.useMutation();return(0,a.Yb)(async(c,h)=>{const{groupName:o,namespaceName:m}=c,u=(0,s.KH)({identifier:h}),{newRuleGroupDefinition:p,rulerConfig:f}=await i(c,u),y=(0,t.t)("alerting.rules.delete-rule.success","Rule successfully deleted");return p.rules.length===0?d({rulerConfig:f,namespace:m,group:o,notificationOptions:{successMessage:y}}).unwrap():l({rulerConfig:f,namespace:m,payload:p,notificationOptions:{successMessage:y}}).unwrap()})}},43482:(G,R,e)=>{"use strict";e.d(R,{D:()=>d,_:()=>l});var t=e(79938),n=e(77583),s=e(53270),a=e(48070),r=e(63066);const{useLazyGetRuleGroupForNamespaceQuery:g}=t.hK,{useLazyDiscoverDsFeaturesQuery:i}=n.L,l=h=>new Error(`DataSource ${h} does not support ruler API or does not have the ruler API enabled.`);function d(){const[h,o]=g(),[m]=i();return[async(p,f)=>{const{dataSourceName:y,groupName:x,namespaceName:v}=p,{rulerConfig:P}=await m({rulesSourceName:y}).unwrap();if(!P)throw l(y);const E=await h({rulerConfig:P,namespace:v,group:x,notificationOptions:{showErrorAlert:!1}}).unwrap().catch(s.R);return{newRuleGroupDefinition:(0,a.i3)(E??c(p.groupName),f),rulerConfig:P}},o]}const c=h=>({name:h,interval:r.T6,rules:[]})},86783:(G,R,e)=>{"use strict";e.d(R,{G:()=>s});var t=e(96540),n=e(23662);function s(a){return(0,t.useMemo)(()=>(0,n.fC)(a),[a])}},19073:(G,R,e)=>{"use strict";e.d(R,{Ej:()=>v,Hl:()=>T,L7:()=>b,QI:()=>m,RY:()=>p,e2:()=>x,iI:()=>C,j5:()=>u,mh:()=>P});var t=e(96540),n=e(16233),s=e(11167),a=e(60021),r=e(31678),g=e(82843),i=e(70383),l=e(75471),d=e(57220),c=e(78742),h=e(23662),o=e(97009),m=(M=>(M.ViewExternalConfiguration="view-external-configuration",M.UpdateExternalConfiguration="update-external-configuration",M.CreateContactPoint="create-contact-point",M.ViewContactPoint="view-contact-point",M.UpdateContactPoint="edit-contact-points",M.DeleteContactPoint="delete-contact-point",M.ExportContactPoint="export-contact-point",M.CreateNotificationTemplate="create-notification-template",M.ViewNotificationTemplate="view-notification-template",M.UpdateNotificationTemplate="edit-notification-template",M.DeleteNotificationTemplate="delete-notification-template",M.DecryptSecrets="decrypt-secrets",M.CreateNotificationPolicy="create-notification-policy",M.ViewNotificationPolicyTree="view-notification-policy-tree",M.UpdateNotificationPolicyTree="update-notification-policy-tree",M.DeleteNotificationPolicy="delete-notification-policy",M.ExportNotificationPolicies="export-notification-policies",M.ViewAutogeneratedPolicyTree="view-autogenerated-policy-tree",M.CreateSilence="create-silence",M.ViewSilence="view-silence",M.UpdateSilence="update-silence",M.PreviewSilencedInstances="preview-silenced-alerts",M.ViewMuteTiming="view-mute-timing",M.CreateMuteTiming="create-mute-timing",M.UpdateMuteTiming="update-mute-timing",M.DeleteMuteTiming="delete-mute-timing",M.ExportMuteTimings="export-mute-timings",M))(m||{}),u=(M=>(M.Duplicate="duplicate-alert-rule",M.View="view-alert-rule",M.Update="update-alert-rule",M.Delete="delete-alert-rule",M.Explore="explore-alert-rule",M.Silence="silence-alert-rule",M.ModifyExport="modify-export-rule",M.Pause="pause-alert-rule",M))(u||{}),p=(M=>(M.CreateAlertRule="create-alert-rule",M.ViewAlertRule="view-alert-rule",M.UpdateAlertRule="update-alert-rule",M.DeleteAlertRule="delete-alert-rule",M.ExportGrafanaManagedRules="export-grafana-managed-rules",M.ReadConfigurationStatus="read-configuration-status",M.CreateExternalAlertRule="create-external-alert-rule",M.ViewExternalAlertRule="view-external-alert-rule",M.UpdateExternalAlertRule="update-external-alert-rule",M.DeleteExternalAlertRule="delete-external-alert-rule",M))(p||{});const f=!0,y=!1,x=()=>({"create-alert-rule":O(f,r.AccessControlAction.AlertingRuleCreate),"view-alert-rule":O(f,r.AccessControlAction.AlertingRuleRead),"update-alert-rule":O(f,r.AccessControlAction.AlertingRuleUpdate),"delete-alert-rule":O(f,r.AccessControlAction.AlertingRuleDelete),"export-grafana-managed-rules":O(f,r.AccessControlAction.AlertingRuleRead),"read-configuration-status":[f,n.TP.hasPermission(r.AccessControlAction.AlertingInstanceRead)||n.TP.hasPermission(r.AccessControlAction.AlertingNotificationsRead)],"create-external-alert-rule":O(f,r.AccessControlAction.AlertingRuleExternalWrite),"view-external-alert-rule":O(f,r.AccessControlAction.AlertingRuleExternalRead),"update-external-alert-rule":O(f,r.AccessControlAction.AlertingRuleExternalWrite),"delete-external-alert-rule":O(f,r.AccessControlAction.AlertingRuleExternalWrite)}),v=M=>x()[M];function P(M,I){const L=D(M);return(0,t.useMemo)(()=>L[I],[L,I])}function E(M,I){const L=D(M);return useMemo(()=>I.map(B=>L[B]),[L,I])}function D(M){const I=(0,d.EV)(M.namespace.rulesSource),{isEditable:L,isRemovable:B,isRulerAvailable:j=!1,loading:A}=(0,o.g)(I,M.rulerRule),[K,W]=v("export-grafana-managed-rules"),U=S(M);return(0,t.useMemo)(()=>{const V=(0,h.lT)(M.rulerRule)&&!!M.rulerRule.grafana_alert.provenance,w=(0,h.YN)(M.group),z=(0,h.lT)(M.rulerRule),N=(0,h.Tm)(M),H=V||w||N,Q=A?y:j,X=H?y:Q,ee=N?y:Q,Z=(0,l.Wd)(I);return{"duplicate-alert-rule":O(ee,Z.create),"view-alert-rule":O(f,Z.read),"update-alert-rule":[X,L??!1],"delete-alert-rule":[X,B??!1],"explore-alert-rule":O(f,r.AccessControlAction.DataSourcesExplore),"silence-alert-rule":U,"modify-export-rule":[z,W],"pause-alert-rule":[X&&z,L??!1]}},[M,A,j,L,B,I,W,U])}function C(){const{selectedAlertmanager:M,hasConfigurationAPI:I,isGrafanaAlertmanager:L}=(0,i.VI)(),B=(0,l.lV)(M),j=(0,l.jy)(M);return{"view-external-configuration":O(f,r.AccessControlAction.AlertingNotificationsExternalRead),"update-external-configuration":O(I,r.AccessControlAction.AlertingNotificationsExternalWrite),"create-contact-point":O(I,B.create,L?r.AccessControlAction.AlertingReceiversCreate:null),"view-contact-point":O(f,B.read),"edit-contact-points":O(I,B.update),"delete-contact-point":O(I,B.delete),"export-contact-point":[L,L],"create-notification-template":O(I,B.create),"view-notification-template":O(f,B.read),"edit-notification-template":O(I,B.update),"delete-notification-template":O(I,B.delete),"create-notification-policy":O(I,B.create),"view-notification-policy-tree":O(f,B.read),"update-notification-policy-tree":O(I,B.update),"delete-notification-policy":O(I,B.delete),"export-notification-policies":O(L,B.read),"decrypt-secrets":O(L,B.provisioning.readSecrets),"view-autogenerated-policy-tree":[L,(0,c.qc)()],"create-silence":O(f,j.create),"view-silence":O(f,j.read),"update-silence":O(f,j.update),"preview-silenced-alerts":O(f,j.read),"create-mute-timing":O(I,B.create),"view-mute-timing":O(f,B.read),"update-mute-timing":O(I,B.update),"delete-mute-timing":O(I,B.delete),"export-mute-timings":O(L,B.read)}}function b(M){const I=C();return(0,t.useMemo)(()=>I[M],[I,M])}function T(M){const I=C();return(0,t.useMemo)(()=>M.map(L=>I[L]),[I,M])}function S(M){const L=M.namespace.rulesSource===d.hY,B=(0,h.Gy)(M.rulerRule),{currentData:j,isLoading:A}=g.m.endpoints.getGrafanaAlertingConfigurationStatus.useQuery(void 0,{skip:!L}),K=(0,h.lT)(M.rulerRule)?M.rulerRule.grafana_alert.namespace_uid:void 0,{loading:W,folder:U}=(0,s.a)(K);if(!L||B||A||W||!U)return[!1,!1];const F=j?.alertmanagersChoice===a.nA.External,V=j?.alertmanagersChoice===a.nA.All,w=!F||V,{accessControl:z={}}=U,N=!!(n.TP.hasPermission(r.AccessControlAction.AlertingInstanceCreate)||z[r.AccessControlAction.AlertingSilenceCreate]);return[w,N]}const O=(M,...I)=>[M,I.some(L=>L&&n.TP.hasPermission(L))]},62190:(G,R,e)=>{"use strict";e.d(R,{W:()=>s});var t=e(96540),n=e(57220);function s(a){return(0,t.useMemo)(()=>(0,n.sq)(a),[a])}},36135:(G,R,e)=>{"use strict";e.d(R,{g:()=>a});var t=e(96540),n=e(19347),s=e(26657);function a(r){return{allDataSourcesAvailable:(0,t.useMemo)(()=>r.filter(i=>!(0,s.s9)(i.datasourceUid)).every(i=>!!(0,n.l)().getInstanceSettings(i.datasourceUid)),[r])}}},6833:(G,R,e)=>{"use strict";e.d(R,{Gz:()=>c,VP:()=>d,Yb:()=>a});var t=e(74848),n=e(96540),s=e(78742);function a(o,m){const[u,p]=(0,n.useState)({status:"not-executed",error:void 0,result:m}),f=(0,n.useRef)(),y=(0,n.useRef)(),x=r({execute(...v){y.current=v;const P=o(...v);return f.current=P,p(E=>({...E,status:"loading"})),P.then(E=>{P===f.current&&p(D=>({...D,status:"success",error:void 0,result:E}))},E=>{P===f.current&&p(D=>({...D,status:"error",error:E}))}),P},reset(){p({status:"not-executed",error:void 0,result:m}),f.current=void 0,y.current=void 0}});return[(0,n.useMemo)(()=>({reset(){x.current.reset()},execute:(...v)=>x.current.execute(...v)}),[]),u,{promise:f.current,lastArgs:y.current}]}function r(o){const m=(0,n.useRef)(o);return m.current=o,(0,n.useMemo)(()=>Object.freeze({get current(){return m.current}}),[])}function g(o){return o.status==="error"}function i(o){return o.status==="success"}function l(o){return o.status==="not-executed"}function d(o){return o.status==="loading"}function c(...o){return{uninitialized:o.every(l),loading:o.some(d),error:o.find(g)?.error,success:o.some(i)}}function h({state:o}){return jsxs(Fragment,{children:[l(o)&&"uninitialized",d(o)&&"loading",i(o)&&"success",i(o)&&`result: ${JSON.stringify(o.result,null,2)}`,g(o)&&`error: ${stringifyErrorLike(o.error)}`]})}},730:(G,R,e)=>{"use strict";e.d(R,{Ll:()=>m,O3:()=>u,ZU:()=>c,we:()=>d});var t=e(96540),n=e(16817),s=e(79938),a=e(77583),r=e(57220),g=e(18461),i=e(23662),l=e(9518);function d(p,f,y){const x=(0,r.oh)(f),{dsFeatures:v,isLoadingDsFeatures:P}=u(f),{currentData:E,isLoading:D,error:C}=s.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:f,ruleName:p,namespace:y?.namespace,groupName:y?.groupName}),[b]=s.hK.endpoints.getRuleGroupForNamespace.useLazyQuery(),{loading:T,error:S,value:O}=(0,n.A)(async()=>{if(!x)throw new Error("Unable to obtain data source settings");if(C)throw new Error("Unable to obtain Prometheus rules");const M=E||[],I=[];if(v?.rulerConfig){const j=v.rulerConfig,A=M.map(K=>K.groups.map(W=>({namespace:K,group:W}))).flat();await Promise.allSettled(A.map(async K=>{const W=await b({rulerConfig:j,namespace:K.namespace.name,group:K.group.name}).unwrap();I.push(W)}))}return M.map(j=>(0,l.O6)(x,j,I)).flatMap(j=>j.groups.flatMap(A=>A.rules))},[x,v,D,C,E,b]);return{loading:P||T,error:S,rules:O}}function c({ruleIdentifier:p,limitAlerts:f}){const{ruleSourceName:y}=p,x=o(p),{dsFeatures:v,isLoadingDsFeatures:P}=u(y),{loading:E,error:D,result:C}=h(p),{currentData:b=[],isLoading:T,error:S}=s.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:p.ruleSourceName,namespace:C?.namespace,groupName:C?.group,ruleName:C?.ruleName,limitAlerts:f},{skip:!C||E,refetchOnMountOrArgChange:!0}),[O,{currentData:M,isLoading:I,error:L}]=s.hK.endpoints.getRuleGroupForNamespace.useLazyQuery();(0,t.useEffect)(()=>{!v?.rulerConfig||!C||O({rulerConfig:v.rulerConfig,namespace:C.namespace,group:C.group})},[v,O,C]);const B=(0,t.useMemo)(()=>{if(!x||!C)return;const j=M?{[C.namespace]:[M]}:{};return(0,l.Ph)(x,b,j).flatMap(U=>U.groups).flatMap(U=>U.rules).find(U=>g.LC(g.UP(y,U),p))},[p,y,b,M,x,C]);return{loading:P||T||I,error:D??S??L,result:B}}function h(p){const{isLoading:f,currentData:y,error:x,isUninitialized:v}=s.hK.endpoints.getAlertRule.useQuery({uid:(0,i.A4)(p)?p.uid:""},{skip:!(0,i.A4)(p),refetchOnMountOrArgChange:!0});return(0,t.useMemo)(()=>(0,i.Mj)(p)||(0,i.X4)(p)?{result:{datasource:p.ruleSourceName,namespace:p.namespace,group:p.groupName,ruleName:p.ruleName},loading:!1}:(0,i.A4)(p)?f||v?{loading:!0}:x?{loading:!1,error:x}:y?{result:{datasource:p.ruleSourceName,namespace:y.grafana_alert.namespace_uid,group:y.grafana_alert.rule_group,ruleName:y.grafana_alert.title},loading:!1}:{loading:!1,error:new Error(`Unable to obtain rule location for rule ${p.uid}`)}:{loading:!1,error:new Error("Unsupported rule identifier")},[p,f,v,x,y])}function o(p){return(0,i.A4)(p)?"grafana":(0,r.oh)(p.ruleSourceName)}function m({ruleIdentifier:p}){const f=o(p),{dsFeatures:y,isLoadingDsFeatures:x}=u(p.ruleSourceName),{loading:v,error:P,result:E}=h(p),[D,{currentData:C,isLoading:b,isUninitialized:T,error:S}]=s.hK.endpoints.getRuleGroupForNamespace.useLazyQuery();(0,t.useEffect)(()=>{!y?.rulerConfig||!E||D({rulerConfig:y.rulerConfig,namespace:E.namespace,group:E.group})},[y,D,E]);const O=(0,t.useMemo)(()=>{const{ruleSourceName:M}=p;if(!C||!f||!E)return;const I=C.rules.find(L=>{const B=g.P1(M,E.namespace,E.group,L);return g.LC(B,p)});if(I)return{ruleSourceName:M,group:C,namespace:E.namespace,rule:I}},[p,C,f,E]);return{loading:v||x||b||T,error:P??S,result:O}}function u(p){const{currentData:f,isLoading:y}=a.L.endpoints.discoverDsFeatures.useQuery({rulesSourceName:p});return{isLoadingDsFeatures:y,dsFeatures:f}}},9518:(G,R,e)=>{"use strict";e.d(R,{Jr:()=>x,NW:()=>C,O6:()=>p,Ph:()=>u,Tj:()=>b,Ug:()=>D,dy:()=>m,kU:()=>L,yh:()=>f});var t=e(2543),n=e.n(t),s=e(96540),a=e(21460),r=e(94822),g=e(79938),i=e(77583),l=e(55740),d=e(57220),c=e(18461),h=e(23662),o=e(61410);function m(B,j){const A=(0,o.$)(F=>F.promRules),K=(0,o.$)(F=>F.rulerRules),W=(0,s.useRef)({}),U=(0,s.useMemo)(()=>{if(B){const F=(0,d.Zw)(B);if(!F)throw new Error(`Unknown rules source: ${B}`);return[F]}return(0,d.lS)()},[B]);return(0,s.useMemo)(()=>U.map(F=>{const V=(0,d.Eb)(F)?F.name:F,w=K[V]?.result;let z=A[V]?.result;V===d.hY&&j&&(z=j);const N=W.current[V];if(N&&N.promRules===z&&N.rulerRules===w)return N.result;const H={};Object.entries(w||{}).forEach(([X,ee])=>{const Z={rulesSource:F,name:X,groups:[]};(0,h.lT)(ee[0].rules[0])&&(Z.uid=ee[0].rules[0].grafana_alert.namespace_uid),H[X]=Z,P(Z,ee)}),z?.forEach(({name:X,groups:ee})=>{const Z=H[X]=H[X]||{rulesSource:F,name:X,groups:[]};E(Z,ee)});const Q=Object.values(H);return W.current[V]={promRules:z,rulerRules:w,result:Q},Q}).flat(),[A,K,U,j])}function u(B,j,A){const K={};return Object.entries(A||{}).forEach(([W,U])=>{const F={rulesSource:B,name:W,groups:[]};K[W]=F,P(F,U)}),j?.forEach(({name:W,groups:U})=>{const F=K[W]=K[W]||{rulesSource:B,name:W,groups:[]};E(F,U)}),Object.values(K)}function p(B,j,A){const K={rulesSource:B,name:j.name,groups:[]};return P(K,A),E(K,j.groups),K.groups.forEach(W=>{W.rules=W.rules.filter(U=>U.promRule)}),K}function f(B,j){if(!B.promRule)return;const K=j.rules.map(U=>O(U,B.namespace,B.group)).reduce((U,F)=>{const V=U.get(F.name);return V?V.push(F):U.set(F.name,[F]),U},new Map),W=M(B.promRule,K,B.namespace.rulesSource);W&&(B.rulerRule=W.rulerRule,B.query=W.query,B.labels=W.labels,B.annotations=W.annotations)}function y(B,j,A){return P(B,A),E(B,j),B}function x(B){return B.map(j=>{const A={...j,groups:[]};return A.groups.push({name:"default",rules:v(j.groups.flatMap(K=>K.rules)),totals:T(j.groups)}),A})}function v(B){return B.sort((j,A)=>j.name.localeCompare(A.name))}function P(B,j=[]){B.groups=j.map(A=>{const K=A.rules.filter(F=>(0,h.i7)(F)).length,W=A.rules.filter(F=>(0,h.lT)(F)&&F.grafana_alert.is_paused).length,U={name:A.name,interval:A.interval,source_tenants:A.source_tenants,rules:[],totals:{paused:W,recording:K}};return U.rules=A.rules.map(F=>O(F,B,U)),U})}function E(B,j){const A=new Map;B.groups.forEach(K=>A.set(K.name,K)),j.forEach(K=>{let W=A.get(K.name);W||(W={name:K.name,rules:[],totals:b(K)},B.groups.push(W),A.set(K.name,W)),W.totals={...W.totals,...b(K)};const U=new Map;W.rules.forEach(F=>{const V=U.get(F.name);V?V.push(F):U.set(F.name,[F])}),(K.rules??[]).forEach(F=>{const V=M(F,U,B.rulesSource);V?(V.promRule=F,V.instanceTotals=(0,h.Z8)(F)?D(F):{},V.filteredInstanceTotals=(0,h.Z8)(F)?C(F):{}):W.rules.push(S(F,B,W))})})}function D(B){const j=(0,t.countBy)(B.alerts,"state");if(B.totals){const{normal:A,...K}=B.totals;return{...K,inactive:A}}return{alerting:j[a.$.Alerting]||j.firing,pending:j[a.$.Pending],inactive:j[a.$.Normal],nodata:j[a.$.NoData],error:j[a.$.Error]||j.err||void 0}}function C(B){if(B.totalsFiltered){const{normal:j,...A}=B.totalsFiltered;return{...A,inactive:j}}return{}}function b(B){if(B.totals){const{firing:W,...U}=B.totals;return{...U,alerting:W}}const j=(0,t.countBy)(B.rules,W=>(0,h.Z8)(W)&&W.state),A=(0,t.countBy)(B.rules,W=>W.health),K=B.rules.filter(W=>(0,h.KB)(W)).length;return{alerting:j[r.cF.Firing],error:A.error,nodata:A.nodata,inactive:j[r.cF.Inactive],pending:j[r.cF.Pending],recording:K}}function T(B){const j={};return B.forEach(A=>{const K=A.totals;Object.entries(K).forEach(([W,U])=>{j[W]||(j[W]=0),j[W]+=U})}),j}function S(B,j,A){return{name:B.name,query:B.query,labels:B.labels||{},annotations:(0,h.Z8)(B)?B.annotations||{}:{},promRule:B,namespace:j,group:A,instanceTotals:(0,h.Z8)(B)?D(B):{},filteredInstanceTotals:(0,h.Z8)(B)?C(B):{}}}function O(B,j,A){return(0,h.$y)(B)?{name:B.alert,query:B.expr,labels:B.labels||{},annotations:B.annotations||{},rulerRule:B,namespace:j,group:A,instanceTotals:{},filteredInstanceTotals:{}}:(0,h.i7)(B)?{name:B.record,query:B.expr,labels:B.labels||{},annotations:{},rulerRule:B,namespace:j,group:A,instanceTotals:{},filteredInstanceTotals:{}}:{name:B.grafana_alert.title,query:"",labels:B.labels||{},annotations:B.annotations||{},rulerRule:B,namespace:j,group:A,instanceTotals:{},filteredInstanceTotals:{}}}function M(B,j,A){const K=j.get(B.name);if(!K)return;if((0,d.z2)(A))return K[0];const W=K.find(F=>!F.promRule&&I(F,B,!0));if(W)return W;const U=K.find(F=>!F.promRule&&I(F,B,!1));if(U)return U}function I(B,j,A=!0){return B.name===j.name?(0,t.isEqual)([A?(0,c.h1)(B.query):"",B.labels,B.annotations],[A?(0,c.h1)(j.query):"",j.labels||{},(0,h.Z8)(j)?j.annotations||{}:{}]):!1}function L(B,j,A){const{currentData:K,isLoading:W,error:U}=g.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:d.hY,dashboardUid:B??void 0,panelId:j},{skip:B===null,pollingInterval:A?l.HH:void 0}),{currentData:F,isLoading:V,error:w}=g.hK.endpoints.rulerRules.useQuery({rulerConfig:i.b,filter:{dashboardUID:B??void 0,panelId:j}},{pollingInterval:A?l.HH:void 0,skip:B===null}),z=(0,s.useRef)({}),N=(0,d.Zw)(d.hY),H=(0,s.useMemo)(()=>{if(!N)return[];const Q=z.current[d.hY];if(Q&&Q.promRules===K&&Q.rulerRules===F)return Q.result;const X={};Object.entries(F||{}).forEach(([Z,q])=>{const ae={rulesSource:N,name:Z,groups:[]};(0,h.lT)(q[0].rules[0])&&(ae.uid=q[0].rules[0].grafana_alert.namespace_uid),X[Z]=ae,P(ae,q)}),K?.forEach(({name:Z,groups:q})=>{const ae=X[Z]=X[Z]||{rulesSource:N,name:Z,groups:[]};E(ae,q)});const ee=Object.values(X);return z.current[d.hY]={promRules:K,rulerRules:F,result:ee},ee},[K,F,N]);return{loading:W||V,error:U??w,result:H}}},14285:(G,R,e)=>{"use strict";e.d(R,{dI:()=>E,i7:()=>D});var t=e(53076),n=e(1932),s=e(2543),a=e.n(s),r=e(96540),g=e(19347),i=e(94822),l=e(25027),d=e(28475),c=e(98164),h=e(55740),o=e(57220),m=e(32642),u=e(23662),p=e(9518),f=e(39964);const y=25,x=1/0,v=new Error("Failed to search rules"),P=L=>L.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");function E(){const[L,B]=(0,f.l)(),j=L.get("search")??"",A=(0,r.useMemo)(()=>(0,d.XY)(j),[j]),K=(0,r.useMemo)(()=>Object.values(A).some(F=>!(0,s.isEmpty)(F)),[A]),W=(0,r.useCallback)(F=>{const V=(0,d.kL)(j,F);B({search:V})},[j,B]),U=(0,r.useCallback)(F=>{B({search:F})},[B]);return(0,r.useEffect)(()=>{const F={dataSource:L.get("dataSource")??void 0,alertState:L.get("alertState")??void 0,ruleType:L.get("ruleType")??void 0,labels:(0,m.S6)(L.get("queryString")??"").map(c.MU)};Object.values(F).some(w=>!(0,s.isEmpty)(w))&&(B({dataSource:void 0,alertState:void 0,ruleType:void 0,queryString:void 0}),W((0,n.jM)(A,w=>{if(w.dataSourceNames??=F.dataSource?[F.dataSource]:[],F.alertState&&(0,i.Si)(F.alertState)&&(w.ruleState??=F.alertState),F.ruleType&&(0,u.nf)(F.ruleType)&&(w.ruleType??=F.ruleType),w.labels.length===0&&F.labels.length>0){const z=F.labels.map(({name:N,operator:H,value:Q})=>`${N}${H}${Q}`);w.labels.push(...z)}})))},[L,W,A,B]),{filterState:A,hasActiveFilters:K,searchQuery:j,setSearchQuery:U,updateFilters:W}}const D=(L,B)=>{const j=(0,r.useDeferredValue)(L),A=(0,r.useDeferredValue)(B);return(0,r.useMemo)(()=>{const K=C(j,A);return K.forEach(W=>{W.groups.forEach(U=>{U.rules.forEach(F=>{(0,u.Z8)(F.promRule)&&(F.instanceTotals=(0,p.Ug)(F.promRule),F.filteredInstanceTotals=(0,p.NW)(F.promRule))}),U.totals=(0,p.Tj)({rules:U.rules.map(F=>F.promRule).filter(F=>!!F)})})}),K},[j,A])},C=(L,B={dataSourceNames:[],labels:[],freeFormWords:[]})=>{let j=L;const A=B.dataSourceNames;A.length&&(j=j.filter(({rulesSource:U})=>(0,o.Eb)(U)?A.includes(U.name):!0));const K=B.namespace;if(K){const U=j.map(H=>H.name),F=P(K),V=M(K),[w,z,N]=V.search(U,F,S(K),x);z&&N?j=N.map(H=>j[z.idx[H]]):w&&(j=w.map(H=>j[H]))}const W=[];try{j.reduce(b(B),[]).forEach(F=>{W.push(F)})}catch{(0,l.vV)(v,{search:JSON.stringify(B)})}return W},b=L=>(B,j)=>{const A=L.groupName;let K=j.groups;if(A){const W=K.map(N=>N.name),U=M(A),F=P(A),[V,w,z]=U.search(W,F,S(A),x);w&&z?K=z.map(N=>K[w.idx[N]]):V&&(K=V.map(N=>K[N]))}return K=K.reduce(T(L),[]),K.length&&B.push({...j,groups:K}),B},T=L=>{const B=L.ruleName??L.freeFormWords.join(" ");return(j,A)=>{let K=A.rules;if(B){const W=K.map(N=>N.name),U=M(B),F=P(B),[V,w,z]=U.search(W,F,S(B),x);w&&z?K=z.map(N=>K[w.idx[N]]):V&&(K=V.map(N=>K[N]))}return K=K.filter(W=>{const U=W.promRule,F=(0,s.chain)(L).pick(["ruleType","dataSourceNames","ruleHealth","labels","ruleState","dashboardUid","plugins","contactPoint"]).omitBy(s.isEmpty).mapValues(()=>!1).value();if("ruleType"in F&&L.ruleType===U?.type&&(F.ruleType=!0),"plugins"in F&&L.plugins==="hide"&&(F.plugins=!(0,u.Tm)(W)),"contactPoint"in F){const V=L.contactPoint;(0,u.lT)(W.rulerRule)&&W.rulerRule.grafana_alert.notification_settings?.receiver===V&&(F.contactPoint=!0)}if("dataSourceNames"in F&&((0,u.lT)(W.rulerRule)?I(W.rulerRule,L)&&(F.dataSourceNames=!0):F.dataSourceNames=!0),"ruleHealth"in L&&U){const V=(0,u.f6)(U.health);L.ruleHealth===V&&(F.ruleHealth=!0)}if("labels"in F){const V=(0,s.compact)(L.labels.map(O)),w=V.length>0&&(0,c.Av)(W.labels,V),z=V.length>0&&U&&U.type===i.JS.Alerting&&U.alerts&&U.alerts.some(N=>(0,c.Av)(N.labels,V));(w||z)&&(F.labels=!0)}if("ruleState"in F){const V=W.promRule;V&&(0,u.Z8)(V)&&V.state===L.ruleState&&(F.ruleState=!0)}return"dashboardUid"in F&&W.annotations[h.YH.dashboardUID]===L.dashboardUid&&(F.dashboardUid=!0),Object.values(F).every(V=>V===!0)}),K.length&&j.push({...A,rules:K}),j}};function S(L){return M(L).split(L).length<5?4:0}function O(L){try{return(0,m.qR)(L)}catch{return{name:L,value:"",isRegex:!0,isEqual:!0}}}function M(L){const B=L.length>y;return new t.A({intraMode:B?0:1,interSplit:"\\s+"})}const I=(L,B)=>B.dataSourceNames?.length?!!L.grafana_alert.data.find(j=>{if(!j.datasourceUid)return!1;const A=(0,g.l)().getInstanceSettings(j.datasourceUid);return A?.name&&B?.dataSourceNames?.includes(A.name)}):!0},11167:(G,R,e)=>{"use strict";e.d(R,{a:()=>g});var t=e(96540),n=e(31678),s=e(26627),a=e(88467),r=e(61410);function g(i){const l=(0,n.useDispatch)(),d=(0,r.$)(c=>c.folders);if((0,t.useEffect)(()=>{i&&l((0,s.Om)(i))},[l,i]),i){const c=d[i]||a.jA;return{folder:c.result,loading:c.loading}}return{loading:!1}}},83903:(G,R,e)=>{"use strict";e.d(R,{y:()=>r});var t=e(77583),n=e(57220),s=e(61410);const{useDiscoverDsFeaturesQuery:a}=t.L;function r(g){const i=(0,s.$)(o=>o.rulerRules),l=(0,n.EV)(g),{currentData:d}=a({rulesSourceName:l}),c=!!d?.rulerConfig,h=!!i[l]?.result;return{hasRuler:c,rulerRulesLoaded:h}}},97009:(G,R,e)=>{"use strict";e.d(R,{g:()=>i});var t=e(16233),n=e(77583),s=e(75471),a=e(23662),r=e(11167),g=e(61410);function i(l,d){const c=(0,g.$)(P=>P.dataSources),{currentData:h,isLoading:o}=n.L.endpoints.discoverDsFeatures.useQuery({rulesSourceName:l}),m=d&&(0,a.lT)(d)?d.grafana_alert.namespace_uid:void 0,u=(0,s.Wd)(l),{folder:p,loading:f}=(0,r.a)(m);if(!d)return{isEditable:!1,isRemovable:!1,loading:!1};if((0,a.lT)(d)){if(!m)throw new Error(`Rule ${d.grafana_alert.title} does not have a folder uid, cannot determine if it is editable.`);if(!p)return{isRulerAvailable:!0,isEditable:!1,isRemovable:!1,loading:f};const P=t.TP.hasPermissionInMetadata(u.update,p),E=t.TP.hasPermissionInMetadata(u.delete,p);return{isRulerAvailable:!0,isEditable:P,isRemovable:E,loading:f||o}}const y=!!c[l]?.result?.rulerConfig||!!h?.rulerConfig,x=t.TP.hasPermission(u.update),v=t.TP.hasPermission(u.delete);return{isRulerAvailable:y,isEditable:x&&y,isRemovable:v&&y,loading:o||c[l]?.loading}}},98439:(G,R,e)=>{"use strict";e.d(R,{W:()=>a});var t=e(2543),n=e.n(t),s=e(96540);function a(r,g=1,i){const[l,d]=(0,s.useState)(g),c=(0,s.useMemo)(()=>(0,t.chunk)(r,i),[r,i]),h=c.length,o=c[l-1]??[],m=(l-1)*i+1,u=(0,t.clamp)(l*i,r.length),p=(0,s.useCallback)(x=>{d((0,t.clamp)(x,1,c.length))},[d,c]),f=(0,s.useCallback)(()=>p(l+1),[l,p]),y=(0,s.useCallback)(()=>p(l-1),[l,p]);return(0,s.useEffect)(()=>d(1),[h]),{page:l,onPageChange:p,numberOfPages:h,pageItems:o,pageStart:m,pageEnd:u,nextPage:f,previousPage:y}}},27747:(G,R,e)=>{"use strict";e.d(R,{S:()=>n});var t=e(9518);function n({dashboardUID:s,panelId:a,poll:r=!1}){const{result:g,loading:i,error:l}=(0,t.kU)(s,a,r);return{rules:g?g.flatMap(c=>c.groups).flatMap(c=>c.rules):[],errors:l?[l]:[],loading:i}}},12210:(G,R,e)=>{"use strict";e.d(R,{_:()=>s});var t=e(16817),n=e(27716);function s(a){const{loading:r,error:g,value:i}=(0,t.A)(()=>(0,n.x)(a,{showErrorAlert:!1})),l=i&&!g&&!r,d=i?.enabled;return r&&!i?{loading:!0}:!l||!d?{loading:!1,installed:!1}:{loading:r,installed:!0,settings:i}}},99935:(G,R,e)=>{"use strict";e.d(R,{I:()=>o,f:()=>m});var t=e(96540),n=e(79938),s=e(18461),a=e(23662),r=e(6833);const{useLazyPrometheusRuleNamespacesQuery:g}=n.hK,i=3*1e3,l=90*1e3,{setInterval:d,clearInterval:c}=window;function h(){const[u]=g();return{matchingPromRuleExists:(0,t.useCallback)(async f=>{const{ruleSourceName:y,namespace:x,groupName:v,ruleName:P}=f;return(await u({ruleSourceName:y,namespace:x,groupName:v,ruleName:P}).unwrap()).find(b=>b.name===x)?.groups.find(b=>b.name===v)?.rules.some(b=>{const T=s.Lg(y,x,v,b);return s.LC(T,f)})??!1},[u])}}function o(){const{matchingPromRuleExists:u}=h(),p=(0,t.useRef)(),f=(0,t.useRef)();(0,t.useEffect)(()=>()=>{y(),x()},[]);const y=()=>{p.current&&(c(p.current),p.current=void 0)},x=()=>{f.current&&(c(f.current),f.current=void 0)};async function v(E){y();const D=new Promise((b,T)=>{setTimeout(()=>{y(),T(new Error("Timeout while waiting for rule removal"))},l)}),C=new Promise((b,T)=>{p.current=d(()=>{u(E).then(S=>{S===!1&&(y(),b())}).catch(S=>{y(),T(S)})},i)});return Promise.race([D,C])}async function P(E){x();const D=new Promise((b,T)=>{setTimeout(()=>{x(),T(new Error("Timeout while waiting for rule creation"))},l)}),C=new Promise((b,T)=>{f.current=d(()=>{u(E).then(S=>{S===!0&&(x(),b())}).catch(S=>{x(),T(S)})},i)});return Promise.race([D,C])}return{waitForRemoval:v,waitForCreation:P}}function m(u){const{matchingPromRuleExists:p}=h(),{waitForCreation:f}=o(),[y,x]=(0,r.Yb)(async v=>(0,a.X4)(v)?f(v):Promise.resolve());return(0,t.useEffect)(()=>{(0,a.X4)(u)&&p(u).then(v=>{v||y.execute(u)})},[y,u,p]),{isConsistent:x.status==="success"||x.status==="not-executed",error:x.error}}},46013:(G,R,e)=>{"use strict";e.d(R,{G:()=>c,Q:()=>d});var t=e(74848),n=e(32196),s=e(96540),a=e(32264),r=e(40845),g=e(37390);const i=(0,s.lazy)(()=>e.e(7409).then(e.bind(e,9790))),l=(0,s.lazy)(()=>Promise.all([e.e(8895),e.e(285)]).then(e.bind(e,285)));var d=(o=>(o.Loki="loki",o.Annotations="annotations",o))(d||{});function c(){const[o,m]=(0,s.useState)(!1),[u,p]=(0,s.useState)(),f=(0,r.of)(h),y=a.$.unifiedAlerting.alertStateHistoryBackend,x=a.$.unifiedAlerting.alertStateHistoryPrimary,P=[y,x].some(b=>b==="loki")?"loki":"annotations",E=(0,s.useCallback)(()=>{p(void 0),m(!1)},[]),D=(0,s.useCallback)(b=>{p(b),m(!0)},[]);return{StateHistoryModal:(0,s.useMemo)(()=>u?(0,t.jsx)(g.a,{isOpen:o,onDismiss:E,closeOnBackdropClick:!0,closeOnEscape:!0,title:"State history",className:f.modal,contentClassName:f.modalContent,children:(0,t.jsxs)(s.Suspense,{fallback:"Loading...",children:[P==="loki"&&(0,t.jsx)(l,{ruleUID:u.grafana_alert.uid}),P==="annotations"&&(0,t.jsx)(i,{alertId:u.grafana_alert.id??""})]})}):null,[u,o,E,P,f]),showStateHistoryModal:D,hideStateHistoryModal:E}}const h=o=>({modal:(0,n.css)({width:"80%",height:"80%",minWidth:"800px"}),modalContent:(0,n.css)({height:"100%",width:"100%",padding:o.spacing(2)})})},39964:(G,R,e)=>{"use strict";e.d(R,{l:()=>a});var t=e(96540),n=e(54148),s=e(39601);function a(){const{search:r}=(0,n.zy)(),g=(0,t.useMemo)(()=>new URLSearchParams(r),[r]),i=(0,t.useCallback)((l,d)=>{s.Ny.partial(l,d)},[]);return[g,i]}},61410:(G,R,e)=>{"use strict";e.d(R,{$:()=>s});var t=e(25508),n=e(31678);function s(a,r){return(0,n.useSelector)((0,t.Mz)(g=>g.unifiedAlerting,g=>a(g)),r)}},85244:(G,R,e)=>{"use strict";e.d(R,{T:()=>g});var t=e(74848),n=e(16817),s=e(39938),a=e(56034),r=e(27716);function g({pluginId:i}){const{value:l}=(0,n.A)(()=>(0,r.x)(i)),d=l?.info.logos?.small,c=d?(0,t.jsx)("img",{src:d,alt:l?.name,style:{width:"20px",height:"20px"}}):(0,t.jsx)(s.E,{text:i,color:"orange"}),h=l?`This rule is managed by the ${l?.name} plugin`:"This rule is managed by a plugin";return(0,t.jsx)(a.m,{content:h,children:(0,t.jsx)("div",{children:c})})}},48070:(G,R,e)=>{"use strict";e.d(R,{Ct:()=>v,KH:()=>c,KL:()=>m,LH:()=>d,Qn:()=>i,Wu:()=>l,bw:()=>u,fO:()=>o,i3:()=>f,lF:()=>h});var t=e(65307),n=e(2543),s=e.n(n),a=e(57220),r=e(18461),g=e(23662);const i=(0,t.VP)("ruleGroup/rules/add"),l=(0,t.VP)("ruleGroup/rules/update"),d=(0,t.VP)("ruleGroup/rules/pause"),c=(0,t.VP)("ruleGroup/rules/delete"),h=(0,t.VP)("ruleGroup/update"),o=(0,t.VP)("ruleGroup/move"),m=(0,t.VP)("ruleGroup/rename"),u=(0,t.VP)("ruleGroup/rules/reorder"),p={name:"initial",rules:[]},f=(0,t.vy)(p,E=>{E.addCase(i,(D,{payload:C})=>{const{rule:b}=C;D.rules.push(b)}).addCase(l,(D,{payload:C})=>{const{identifier:b,rule:T}=C,S=P(D.rules,b);D.rules[S]=T}).addCase(c,(D,{payload:C})=>{const{identifier:b}=C,T=P(D.rules,b);D.rules.splice(T,1)}).addCase(d,(D,{payload:C})=>{const{uid:b,pause:T}=C,S={ruleSourceName:a.hY,uid:b},O=P(D.rules,S),M=D.rules[O];if((0,g.lT)(M))M.grafana_alert.is_paused=T;else throw new Error("Matching rule is not a Grafana-managed rule")}).addCase(u,(D,{payload:C})=>{const{swaps:b}=C;x(D.rules,b)}).addMatcher((0,t.i0)(m,o,i),(D,{payload:C})=>{const{groupName:b}=C;D.name=b??D.name}).addMatcher((0,t.i0)(h,m,o,i),(D,{payload:C})=>{const{interval:b}=C;D.interval=b??D.interval}).addDefaultCase((D,C)=>{throw new Error(`Unknown action for rule group reducer: ${C.type}`)})}),y=E=>{const D=(0,g.A4)(E),C=(0,g.X4)(E);return b=>{const T=(0,g.lT)(b),S=(0,g.Mt)(b);if(D&&T)return b.grafana_alert.uid===E.uid;if(S&&C)return(0,r.Ns)(b)===E.rulerRuleHash}};function x(E,D){for(const C of D)v(E,C);return E}function v(E,[D,C]){if(!((0,n.inRange)(D,E.length)&&(0,n.inRange)(C,E.length)))throw new Error("Invalid operation: index out of bounds");const[T]=E.splice(D,1);E.splice(C,0,T)}function P(E,D){const C=E.findIndex(y(D));if(C===-1)throw new Error("no rule matching identifier found");return C}},28475:(G,R,e)=>{"use strict";e.d(R,{Jc:()=>N,kL:()=>Q,XY:()=>H});var t=e(94822),n=e(23662);const s=1,a=2,r=3,g=4,i=5,l=6,d=7,c=8,h=9,o=10,m=11,u=12,p=13,f=14,y=15,x=0,v=1,P=2,E=3,D=4,C=5,b=6,T=7,S=8,O=9,M=10;var I=e(2543),L=e(48820);const B=L.U1.deserialize({version:14,states:"!vOQOPOOO{OPO'#CkOOOO'#Ck'#CkOQOPO'#CoOOOO'#Cl'#ClQQOPOOO!yOQO'#C^O#OOPO'#CmO#TOPO,59VOOOO,59Z,59ZOOOO-E6j-E6jOOOO,58x,58xOOOO,59X,59XOOOO-E6k-E6k",stateData:"$t~ORUOTUOUUOVUOWUOXUOYUOZUO[UO]UO^UOdPOfQO~OeVOR_XT_XU_XV_XW_XX_XY_XZ_X[_X]_X^_Xd_Xf_X~OSZO~Od[O~OeVOR_aT_aU_aV_aW_aX_aY_aZ_a[_a]_a^_ad_af_a~OR~T~U~V~W~Y~Z~[~]~^~R^][ZYXWVUTd~",goto:"}dPPePPPPPPPPPPPPejpPvVRORTQTORYTQWPR]WSSOTRXR",nodeNames:"\u26A0 AlertRuleSearch FilterExpression DataSourceToken FilterValue NameSpaceToken LabelToken GroupToken RuleToken StateToken TypeToken HealthToken DashboardToken PluginsToken ContactPointToken FreeFormExpression",maxTerm:22,skippedNodes:[0],repeatNodeCount:2,tokenData:"$ nRRtqr#crs&ost#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]+q!]#V#c#V#W-T#W#X@m#X#Z#c#Z#[!/S#[#]!7|#]#`#c#`#a!B`#a#b#c#b#c!KY#c#d#c#d#e#,W#e#f#c#f#g#8S#g#h#?d#h#i#H^#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#jcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cQ$zcSQqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uQ&YP;=`<%l$uQ&`P;=`;NQ$uR&fP;=`<%l#cR&lP;=`;NQ#cR&rrX^(|pq(|qr(|st(|tu(|uv(|vw(|wx(|xy(|yz(|z{(|{|(||!P(|!P!Q(|!Q![(|![!](|!]#y(|#y#z(|#z$f(|$f$g(|$g#BY(|#BY#BZ(|#BZ$Ch(|$IS$I_(|$I|$JO(|$JT$JU(|$JU$KV(|$KV$KW(|$KW&FU(|&FU&FV(|&FV;'S(|;'S;(d+e;(d;(e+k<%lO(|R)PsX^(|pq(|qr(|rs+^st(|tu(|uv(|vw(|wx(|xy(|yz(|z{(|{|(||!P(|!P!Q(|!Q![(|![!](|!]#y(|#y#z(|#z$f(|$f$g(|$g#BY(|#BY#BZ(|#BZ$Ch(|$IS$I_(|$I|$JO(|$JT$JU(|$JU$KV(|$KV$KW(|$KW&FU(|&FU&FV(|&FV;'S(|;'S;(d+e;(d;(e+k<%lO(|R+eOSQfPR+hP;=`<%l(|R+nP;=`;NQ(|R+xcSQePqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR-[eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#c#c#c#d.m#d$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR.teSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#b#c#b#c0V#c$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR0^eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i1o#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR1veSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U3X#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR3`eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#V#c#V#W4q#W$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR4xeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i6Z#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR6beSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]!r#c!r!s7s!s$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR7zeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#c#c#c#d9]#d$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR9deSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#]#c#]#^:u#^$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR:|eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#b#c#b#c<_#c$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR<feSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i=w#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR>OcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]?Z!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR?bcSQ^Pqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR@teSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#UBV#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRB^fSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#g#c#g#hCr#h#i! n#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRCyeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#[#c#[#]E[#]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cREceSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#U#c#U#VFt#V$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRF{eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#c#c#c#dH^#d$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRHeeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#UIv#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRI}eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#f#c#f#gK`#g$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRKgeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#W#c#W#XLx#X$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRMPcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]N[!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRNccSQ[Pqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR! ueSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U!#W#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!#_eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#g#c#g#h!$p#h$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!$weSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#c#c#c#d!&Y#d$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!&aeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#i#c#i#j!'r#j$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!'yeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#f#c#f#g!)[#g$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!)ceSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#V#c#V#W!*t#W$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!*{eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y!,^#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!,ecSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]!-p!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!-wcSQRPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR!/ZeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#f#c#f#g!0l#g$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!0seSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#c#c#c#d!2U#d$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!2]eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#i#c#i#j!3n#j$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!3ueSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#d#c#d#e!5W#e$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!5_cSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]!6j!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!6qcSQVPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR!8TeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y!9f#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!9meSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U!;O#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!;VeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#`#c#`#a!<h#a$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!<oeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i!>Q#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!>XeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#[#c#[#]!?j#]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!?qcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]!@|!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!ATcSQZPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR!BgeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U!Cx#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!DPeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#U#c#U#V!Eb#V$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!EieSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y!Fz#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!GReSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#`#c#`#a!Hd#a$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!HkcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]!Iv!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!I}cSQUPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR!KaeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U!Lr#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!LyeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#a#c#a#b!N[#b$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!NceSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y# t#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR# {eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#g#c#g#h##^#h$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR##eeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#d#c#d#e#$v#e$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#$}eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U#&`#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#&geSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#V#c#V#W#'x#W$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#(PeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y#)b#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#)icSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]#*t!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#*{cSQTPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR#,_eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#`#c#`#a#-p#a$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#-weSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#i#c#i#j#/Y#j$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#/aeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#Z#c#Z#[#0r#[$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#0yeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#]#c#]#^#2[#^$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#2ceSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#b#c#b#c#3t#c$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#3{eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#g#c#g#h#5^#h$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#5ecSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]#6p!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#6wcSQ]Pqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR#8ZeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#i#c#i#j#9l#j$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#9seSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#`#c#`#a#;U#a$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#;]eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y#<n#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#<ucSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]#>Q!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#>XcSQWPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR#?keSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i#@|#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#ATeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U#Bf#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#BmeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i#DO#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#DVeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y#Eh#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#EocSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]#Fz!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#GRcSQXPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR#HeeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#m#c#m#n#Iv#n$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#I}eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#d#c#d#e#K`#e$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#KgeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y#Lx#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#MPcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]#N[!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#NccSQYPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$u",tokenizers:[0,1],topRules:{AlertRuleSearch:[0,1]},dialects:{dataSourceFilter:141,nameSpaceFilter:143,labelFilter:145,groupFilter:147,ruleFilter:149,stateFilter:84,typeFilter:151,healthFilter:153,dashboardFilter:155,pluginsFilter:157,contactPointFilter:159},tokenPrec:161}),j={[r]:"datasource",[i]:"namespace",[l]:"label",[c]:"rule",[d]:"group",[h]:"state",[o]:"type",[m]:"health",[u]:"dashboard",[p]:"plugins",[f]:"contactPoint"};var A=(ee=>(ee.dataSource="dataSourceFilter",ee.nameSpace="nameSpaceFilter",ee.label="labelFilter",ee.group="groupFilter",ee.rule="ruleFilter",ee.state="stateFilter",ee.type="typeFilter",ee.health="healthFilter",ee.dashboard="dashboardFilter",ee.plugins="pluginsFilter",ee.contactPoint="contactPointFilter",ee))(A||{});function K(ee,Z,q){V(ee,Z,ae=>{if(ae.type.id===a){const k=W(ee,ae);if(k.type&&k.value){const se=q[k.type];se&&se(k.value)}}else if(ae.type.id===y){const k=q[y];k&&k(U(ee,ae))}})}function W(ee,Z){if(Z.type.id!==a)throw new Error("Invalid node provided. Only FilterExpression nodes are supported");const q=Z.firstChild;if(!q)return{type:void 0,value:void 0};const ae=Z.getChild(g),k=ae?(0,I.trim)(U(ee,ae),'"'):void 0;return{type:q.type.id,value:k}}function U(ee,Z){return ee.slice(Z.from,Z.to).trim().replace(/\"/g,"")}function F(ee,Z,q){const ae=[];V(ee,Z,se=>{se.type.id===a&&se.firstChild&&ae.push(se.firstChild),se.type.id===y&&ae.push(se)});const k=[];return ae.forEach(se=>{const te=q.findIndex(ne=>ne.type===se.type.id);if(te!==-1){if(se.parent?.type.is(a)){const ne=j[se.type.id],le=q.splice(te,1)[0];k.push(`${ne}:${w(le.value)}`)}if(se.type.is(y)){const ne=q.splice(te,1)[0];k.push(ne.value)}}}),q.forEach(se=>{se.type===y?k.push(se.value):k.push(`${j[se.type]}:${w(se.value)}`)}),k.join(" ")}function V(ee,Z,q){const ae=Z.join(" "),se=B.configure({dialect:ae}).parse(ee).cursor();do q(se.node);while(se.next())}function w(ee){return/\s/.test(ee)?`"${ee}"`:ee}const z=[A.dataSource,A.nameSpace,A.label,A.group,A.rule,A.state,A.type,A.health,A.dashboard,A.plugins,A.contactPoint];var N=(ee=>(ee.Ok="ok",ee.Error="error",ee.NoData="nodata",ee.Unknown="unknown",ee))(N||{});function H(ee){const Z={labels:[],freeFormWords:[],dataSourceNames:[]},q={[r]:ae=>Z.dataSourceNames.push(ae),[i]:ae=>Z.namespace=ae,[d]:ae=>Z.groupName=ae,[c]:ae=>Z.ruleName=ae,[l]:ae=>Z.labels.push(ae),[h]:ae=>Z.ruleState=X(ae),[o]:ae=>(0,n.nf)(ae)?Z.ruleType=ae:void 0,[m]:ae=>Z.ruleHealth=(0,n.f6)(ae),[u]:ae=>Z.dashboardUid=ae,[p]:ae=>Z.plugins=ae==="hide"?ae:void 0,[f]:ae=>Z.contactPoint=ae,[y]:ae=>Z.freeFormWords.push(ae)};return K(ee,z,q),Z}function Q(ee,Z){const q=[];return Z.dataSourceNames&&q.push(...Z.dataSourceNames.map(ae=>({type:r,value:ae}))),Z.namespace&&q.push({type:i,value:Z.namespace}),Z.groupName&&q.push({type:d,value:Z.groupName}),Z.ruleName&&q.push({type:c,value:Z.ruleName}),Z.ruleState&&q.push({type:h,value:Z.ruleState}),Z.ruleType&&q.push({type:o,value:Z.ruleType}),Z.ruleHealth&&q.push({type:m,value:Z.ruleHealth}),Z.labels&&q.push(...Z.labels.map(ae=>({type:l,value:ae}))),Z.dashboardUid&&q.push({type:u,value:Z.dashboardUid}),Z.plugins&&q.push({type:p,value:Z.plugins}),Z.freeFormWords&&q.push(...Z.freeFormWords.map(ae=>({type:y,value:ae}))),Z.contactPoint&&q.push({type:f,value:Z.contactPoint}),F(ee,z,q)}function X(ee){if(ee==="normal")return t.cF.Inactive;if((0,t.Si)(ee))return ee}},28318:(G,R,e)=>{"use strict";e.d(R,{t:()=>I});var t=e(2543),n=e(39741),s=e(62467),a=e(66847),r=e(1005),g=e(81160),i=e(62938),l=e(39070),d=e(14236),c=e(72495),h=e(65879),o=e(43127),m=e(89667),u=e(19347),p=e(26657),f=e(12091),y=e(27677),x=e(69437),v=e(81583),P=e(72955),E=e(66718);const D={from:21600,to:0},C=(U,F)=>{const V=b(U,F);if(!V)return D;const{from:w,to:z}=S(V,F);return!w.length&&!z.length?D:{from:Math.max(...w),to:Math.min(...z)}},b=(U,F)=>{switch(U.type){case E.Tz.classic:return T(U);case E.Tz.math:case E.Tz.sql:return O(U,F);case E.Tz.resample:case E.Tz.reduce:case E.Tz.threshold:return M(U)}},T=U=>U.conditions?.map(F=>F.query.params[0]),S=(U,F)=>{const V=[],w=[D.to];for(const z of U){const N=F.find(H=>H.refId===z);!N||!N.relativeTimeRange||(V.push(N.relativeTimeRange.from),w.push(N.relativeTimeRange.to))}return{from:V,to:w}},O=(U,F)=>F.filter(V=>V.queryType==="query"&&U.expression?.includes(V.refId)).map(V=>V.refId),M=U=>U.expression?[U.expression]:void 0;class I{constructor(F=(0,y.AI)(),V=(0,u.l)()){this.backendSrv=F,this.dataSourceSrv=V,this.subject=new n.m(1),this.lastResult={}}get(){return this.subject.asObservable()}async run(F,V){const w=B(F,l.Gu.Done),z=[];for(const H of F){const Q=H.model.refId;if((0,x.f)(H.model))continue;const X=await this.dataSourceSrv.get(H.datasourceUid);X instanceof p.iy&&X.filterQuery&&!X.filterQuery(H.model)&&z.push(Q)}const N=(0,t.reject)(F,H=>z.includes(H.model.refId));if(N.length===0)return this.subject.next(w);this.subscription=L(this.backendSrv,N,V).subscribe({next:H=>{const Q=W(H,(X,ee)=>{const Z=this.lastResult[X],q=(0,d.N$)(ee,Z);return(0,P.B)(q,Z)});this.lastResult=Q,this.subject.next(this.lastResult)},error:H=>{this.lastResult=K(this.lastResult,H),this.subject.next(this.lastResult)}})}cancel(){if(!this.subscription)return;this.subscription.unsubscribe();let F=!1;const V=W(this.lastResult,(w,z)=>(z.state===l.Gu.Loading&&(F=!0),{...z,state:l.Gu.Done}));F&&this.subject.next(V)}destroy(){this.subject&&this.subject.complete(),this.cancel()}}const L=(U,F,V)=>{const w=B(F,l.Gu.Loading),z={data:{data:F,condition:V},url:"/api/v1/eval",method:"POST",requestId:(0,i.A)()};return(0,c.k)({whileLoading:w,source:U.fetch(z).pipe(A(w),(0,a.W)(N=>(0,s.of)(K(w,N))),(0,v.N)(U,z.requestId),(0,r.u)())})},B=(U,F)=>U.reduce((V,w)=>(V[w.refId]={state:F,series:[],timeRange:j(w,U)},V),{}),j=(U,F)=>{if((0,x.f)(U.model)){const V=C(U.model,F);return h.relativeToTimeRange(V)}return U.relativeTimeRange?h.relativeToTimeRange(U.relativeTimeRange):(console.warn(`Query with refId: ${U.refId} did not have any relative time range, using default.`),(0,o.E2)())},A=U=>(0,g.T)(F=>{const{data:V}=F,w={};for(const[z,N]of Object.entries(V.results)){const{error:H,status:Q,frames:X=[]}=N,ee=H?[{message:H,refId:z,status:Q}]:[];w[z]={errors:ee,timeRange:U[z].timeRange,state:l.Gu.Done,series:X.map(m.or)}}return w}),K=(U,F)=>{const V=(0,f.u)(F);return W(U,(w,z)=>({...z,state:l.Gu.Error,error:V}))},W=(U,F)=>{const V={};for(const[w,z]of Object.entries(U))V[w]=F(w,z);return V}},70383:(G,R,e)=>{"use strict";e.d(R,{Kh:()=>u,VI:()=>h,b9:()=>c});var t=e(74848),n=e(96540),s=e(33390),a=e(60021),r=e(62190),g=e(39964),i=e(55740),l=e(57220);const d=n.createContext(void 0),c=({children:p,accessType:f,alertmanagerSourceName:y})=>{const[x,v]=(0,g.l)(),P=(0,r.W)(f),E=P.availableInternalDataSources.concat(P.availableExternalDataSources),D=n.useCallback(A=>{o(E,A)&&(A===l.hY?(s.A.delete(i.Oq),v({[i.DD]:void 0})):(s.A.set(i.Oq,A),v({[i.DD]:A})))},[E,v]),C=x.get(i.DD),b=s.A.get(i.Oq),T=l.hY;n.useEffect(()=>{C&&C!==b&&s.A.set(i.Oq,C)},[C,b]);const S=y??C??b??T,O=o(E,S)?S:void 0,M=(0,l.r3)(O)?.jsonData,I=O===l.hY,L=M?u(M):!1,j={selectedAlertmanager:O,hasConfigurationAPI:I||L,isGrafanaAlertmanager:I,selectedAlertmanagerConfig:M,availableAlertManagers:E,setSelectedAlertmanager:D};return(0,t.jsx)(d.Provider,{value:j,children:p})};function h(){const p=n.useContext(d);if(p===void 0)throw new Error("useAlertmanager must be used within a AlertmanagerContext");return p}function o(p,f){return p.map(x=>x.name).includes(f)}const m=[a.Oz.mimir,a.Oz.cortex,void 0];function u(p){return m.includes(p.implementation)}},26627:(G,R,e)=>{"use strict";e.d(R,{nO:()=>U,D3:()=>W,yo:()=>I,wE:()=>O,nV:()=>L,Tp:()=>A,Om:()=>K,JH:()=>B,Lc:()=>S,mB:()=>b,eB:()=>T,DC:()=>M,Qt:()=>C,uQ:()=>V,bO:()=>F,RW:()=>j});var t=e(65307),n=e(2543),s=e(39601),a=e(34867),r=e(94822),g=e(27677),i=e(25027),l=e(32415),d=e(82843),c=e(17172);function h(w){return(0,c.AI)().get("/api/annotations",{alertId:w}).then(z=>z?.sort(o))}function o(w,z){const N=(X,ee)=>X>ee?-1:ee>X?1:0,H=N(w.timeEnd,z.timeEnd);if(H)return H;const Q=N(w.time,z.time);return Q||N(w.id,z.id)}var m=e(92240),u=e(49498),p=e(28220),f=e(98164),y=e(57220),x=e(78742),v=e(88467),P=e(23662),E=e(25968);function D(w,z){const N=w().unifiedAlerting.dataSources,H=N[z]?.result,Q=N[z]?.error;if(!H){const X=new Error(`Data source configuration is not available for "${z}" data source`);throw Q&&(X.cause=Q),X}return H}function C(w,z){const N=D(w,z);if(!N.rulerConfig)throw new Error(`Ruler API is not available for ${z}`);return N.rulerConfig}const b=(0,t.zD)("unifiedalerting/fetchPromRules",async({rulesSourceName:w,filter:z,limitAlerts:N,matcher:H,state:Q,identifier:X},ee)=>{await ee.dispatch(M({rulesSourceName:w}));const Z=(0,i.U7)("unifiedalerting/fetchPromRules",u.sA,{dataSourceName:w,thunk:"unifiedalerting/fetchPromRules"});return await(0,v.$I)(Z(w,z,N,H,Q,X))}),T=(0,t.zD)("unifiedalerting/fetchRulerRules",async({rulesSourceName:w,filter:z},{dispatch:N,getState:H})=>{await N(M({rulesSourceName:w}));const Q=C(H,w),X=(0,i.Ke)("unifiedalerting/fetchRulerRules",p.iy,{dataSourceName:w,thunk:"unifiedalerting/fetchRulerRules"});return await(0,v.$I)(X(Q,z))});function S({rulesSourceName:w,identifier:z,filter:N,limitAlerts:H,matcher:Q,state:X}){return async(ee,Z)=>{await ee(M({rulesSourceName:w}));const q=D(Z,w);await ee(b({rulesSourceName:w,identifier:z,filter:N,limitAlerts:H,matcher:Q,state:X})),q.rulerConfig&&await ee(T({rulesSourceName:w}))}}function O(){return async w=>{const z=(0,y.gR)().map(N=>w(M({rulesSourceName:N})));await Promise.allSettled(z)}}const M=(0,t.zD)("unifiedalerting/fetchPromBuildinfo",async({rulesSourceName:w})=>(0,v.$I)((async()=>{if(w===y.hY)return{name:y.hY,id:y.hY,rulerConfig:{dataSourceName:y.hY,apiVersion:"legacy"}};const z=(0,y.Jz)(w);if(!z)throw new Error(`Missing data source configuration for ${w}`);const{id:N,name:H}=z,X=await(0,i.QA)("unifiedalerting/fetchPromBuildinfo",m.nD,{dataSourceName:w,thunk:"unifiedalerting/fetchPromBuildinfo"})(H),ee=X.features.rulerApiEnabled?{dataSourceName:H,apiVersion:X.application===r.N1.Cortex?"legacy":"config"}:void 0;return{name:H,id:N,rulerConfig:ee}})()),{condition:({rulesSourceName:w},{getState:z})=>{const N=z().unifiedAlerting.dataSources,H=!!N[w]?.result,Q=!!N[w]?.error;return!(H||Q)}});function I(w=!1,z={}){return async(N,H)=>{const Q=performance.now();await Promise.allSettled((0,y.gR)().map(async X=>{await N(M({rulesSourceName:X}));const{promRules:ee,rulerRules:Z,dataSources:q}=H().unifiedAlerting,ae=q[X].result;if(!ae)return;const k=w||!ee[X]?.loading,se=(w||!Z[X]?.loading)&&!!ae.rulerConfig;await Promise.allSettled([k&&N(b({rulesSourceName:X,...z})),se&&N(T({rulesSourceName:X}))])})),(0,a.l$)("unifiedalerting/fetchAllPromAndRulerRulesAction",{loadTimeMs:performance.now()-Q})}}function L(w=!1,z={}){return async(N,H)=>{const{promRules:Q}=H().unifiedAlerting;(0,y.gR)().map(X=>{(w||!Q[X]?.loading)&&N(b({rulesSourceName:X,...z}))})}}const B=(0,t.zD)("unifiedalerting/fetchGrafanaAnnotations",w=>(0,v.$I)(h(w))),j=(0,t.zD)("unifiedalerting/updateAMConfig",({alertManagerSourceName:w,oldConfig:z,newConfig:N,successMessage:H,redirectPath:Q,redirectSearch:X},ee)=>(0,v.v5)((0,v.$I)((async()=>{const Z=await ee.dispatch(d.m.endpoints.getAlertmanagerConfiguration.initiate(w,{forceRefetch:!0})).unwrap(),q=(0,n.isEmpty)(Z.alertmanager_config)&&(0,n.isEmpty)(Z.template_files),ae=JSON.stringify(Z)!==JSON.stringify(z);if(!q&&ae)throw new Error("A newer Alertmanager configuration is available. Please reload the page and try again to not overwrite recent changes.");if(await(0,l.vk)(w,(0,f.MZ)(N)),ee.dispatch(d.m.util.invalidateTags(["AlertmanagerConfiguration","ContactPoint","ContactPointsStatus","Receiver"])),Q){const k=new URLSearchParams(X??"");s.Ny.push((0,x.nL)(Q,w,k))}})()),{successMessage:H})),A=(0,t.zD)("unifiedalerting/fetchFolder",w=>(0,v.$I)(g.IB.getFolderByUid(w,{withAccessControl:!0}))),K=w=>(z,N)=>{N().unifiedAlerting.folders[w]?.dispatched||z(A(w))},W=(0,t.zD)("unifiedalerting/fetchAlertGroups",w=>(0,v.$I)((0,l.f4)(w))),U=(0,t.zD)("unifiedalerting/deleteAlertManagerConfig",async(w,z)=>(0,v.v5)((0,v.$I)((async()=>{await(0,l.nd)(w),await z.dispatch(d.m.util.invalidateTags(["AlertmanagerConfiguration"]))})()),{errorMessage:"Failed to reset Alertmanager configuration",successMessage:"Alertmanager configuration reset."})),F=(0,t.zD)("unifiedalerting/testReceivers",({alertManagerSourceName:w,receivers:z,alert:N})=>(0,v.v5)((0,v.$I)((0,l.By)(w,z,N)),{errorMessage:"Failed to send test alert.",successMessage:"Test alert sent."})),V=(w,z)=>w.filter(N=>{const{forDuration:H}=(0,P.jg)(N,z),Q=H?(0,E.P8)(H):null,X=(0,E.P8)(z);return Q?Q!==0&&Q<X:!1})},22620:(G,R,e)=>{"use strict";e.d(R,{H:()=>n});var t=e(32196);const n=s=>(0,t.css)({float:"none",display:"flex",justifyContent:"flex-start",margin:s.spacing(2,0)})},99494:(G,R,e)=>{"use strict";e.d(R,{W:()=>t});var t=(n=>(n.Incident="grafana-incident-app",n.OnCall="grafana-oncall-app",n.MachineLearning="grafana-ml-app",n.Labels="grafana-labels-app",n.Slo="grafana-slo-app",n))(t||{})},86590:(G,R,e)=>{"use strict";e.d(R,{Z:()=>t});var t=(n=>(n.grafana="grafana-alerting",n.grafanaRecording="grafana-recording",n.cloudAlerting="cloud-alerting",n.cloudRecording="cloud-recording",n))(t||{})},41068:(G,R,e)=>{"use strict";e.d(R,{y:()=>t});var t=(n=>(n.seconds="s",n.minutes="m",n.hours="h",n.days="d",n.weeks="w",n))(t||{})},75471:(G,R,e)=>{"use strict";e.d(R,{C0:()=>u,HL:()=>g,Q9:()=>p,VQ:()=>i,Wd:()=>m,jy:()=>h,lV:()=>o,nU:()=>l,q0:()=>f});var t=e(2913),n=e(16233),s=e(31678),a=e(57220);function r(y){return(0,a.z2)(y)?"grafana":"external"}const g={read:{grafana:s.AccessControlAction.AlertingInstanceRead,external:s.AccessControlAction.AlertingInstancesExternalRead},create:{grafana:s.AccessControlAction.AlertingInstanceCreate,external:s.AccessControlAction.AlertingInstancesExternalWrite},update:{grafana:s.AccessControlAction.AlertingInstanceUpdate,external:s.AccessControlAction.AlertingInstancesExternalWrite},delete:{grafana:s.AccessControlAction.AlertingInstanceUpdate,external:s.AccessControlAction.AlertingInstancesExternalWrite}},i={read:{grafana:s.AccessControlAction.AlertingNotificationsRead,external:s.AccessControlAction.AlertingNotificationsExternalRead},create:{grafana:s.AccessControlAction.AlertingNotificationsWrite,external:s.AccessControlAction.AlertingNotificationsExternalWrite},update:{grafana:s.AccessControlAction.AlertingNotificationsWrite,external:s.AccessControlAction.AlertingNotificationsExternalWrite},delete:{grafana:s.AccessControlAction.AlertingNotificationsWrite,external:s.AccessControlAction.AlertingNotificationsExternalWrite}},l={read:{grafana:s.AccessControlAction.AlertingSilenceRead,external:s.AccessControlAction.AlertingInstanceRead},create:{grafana:s.AccessControlAction.AlertingSilenceCreate,external:s.AccessControlAction.AlertingInstancesExternalWrite},update:{grafana:s.AccessControlAction.AlertingSilenceUpdate,external:s.AccessControlAction.AlertingInstancesExternalWrite}},d={read:s.AccessControlAction.AlertingProvisioningRead,readSecrets:s.AccessControlAction.AlertingProvisioningReadSecrets,write:s.AccessControlAction.AlertingProvisioningWrite},c={read:{grafana:s.AccessControlAction.AlertingRuleRead,external:s.AccessControlAction.AlertingRuleExternalRead},create:{grafana:s.AccessControlAction.AlertingRuleCreate,external:s.AccessControlAction.AlertingRuleExternalWrite},update:{grafana:s.AccessControlAction.AlertingRuleUpdate,external:s.AccessControlAction.AlertingRuleExternalWrite},delete:{grafana:s.AccessControlAction.AlertingRuleDelete,external:s.AccessControlAction.AlertingRuleExternalWrite}};function h(y){const x=r(y);return{read:g.read[x],create:g.create[x],update:g.update[x],delete:g.delete[x]}}function o(y){const x=r(y);return{read:i.read[x],create:i.create[x],update:i.update[x],delete:i.delete[x],provisioning:d}}function m(y){const x=r(y);return{read:c.read[x],create:c.create[x],update:c.update[x],delete:c.delete[x]}}function u(y){return()=>n.TP.evaluatePermission(y)}function p(){return{canCreateGrafanaRules:n.TP.hasPermission(s.AccessControlAction.FoldersRead)&&n.TP.hasPermission(c.create.grafana),canCreateCloudRules:n.TP.hasPermission(s.AccessControlAction.DataSourcesRead)&&n.TP.hasPermission(c.create.external),canEditRules:y=>n.TP.hasPermission(m(y).update)}}function f(){const{unifiedAlertingEnabled:y}=(0,t.zj)(),x=n.TP.hasPermission(m(a.hY).read),v=n.TP.hasPermission(m(a.hY).update);return y&&x&&v}},98164:(G,R,e)=>{"use strict";e.d(R,{$P:()=>O,$m:()=>d,Av:()=>x,Dm:()=>b,EU:()=>v,LF:()=>C,MN:()=>h,MU:()=>m,MZ:()=>i,NL:()=>y,UL:()=>S,VE:()=>P,Wc:()=>u,_n:()=>l,mP:()=>M,uH:()=>T,xH:()=>f});var t=e(2543),n=e.n(t),s=e(60021),a=e(82775),r=e(57220),g=e(32642);function i(I){return I.alertmanager_config.receivers||(I.alertmanager_config.receivers=[{name:"default "}]),I.alertmanager_config.route||(I.alertmanager_config.route={receiver:I.alertmanager_config.receivers[0].name}),I.template_files||(I.template_files={}),I}function l(I,L){return{...L,mute_time_intervals:L.mute_time_intervals?.filter(j=>j!==I)??[],active_time_intervals:L.active_time_intervals?.filter(j=>j!==I)??[],routes:L.routes?.map(j=>l(I,j))}}function d(I,L,B){return{...B,mute_time_intervals:B.mute_time_intervals?.map(j=>j===L?I:j),active_time_intervals:B.active_time_intervals?.map(j=>j===L?I:j),routes:B.routes?.map(j=>d(I,L,j))}}function c(I){return I.map(([L,B,j])=>[L,B,unquoteWithUnescape(j)])}function h(I){return I.isEqual?I.isRegex?s.ho.regex:s.ho.equal:I.isRegex?s.ho.notRegex:s.ho.notEqual}function o(I){switch(I){case s.ho.equal:return{isEqual:!0,isRegex:!1};case s.ho.notEqual:return{isEqual:!1,isRegex:!1};case s.ho.regex:return{isEqual:!0,isRegex:!0};case s.ho.notRegex:return{isEqual:!1,isRegex:!0}}}function m(I){return{name:I.name,value:I.value,operator:h(I)}}function u(I){return{name:I.name,value:I.value,...o(I.operator)}}function p(I){return`{ ${I.map(m).reduce((j,A)=>{const K=`${A.name}${A.operator}"${A.value}"`;return j?`${j}, ${K}`:K},"")} }`}const f=[{label:s.ho.equal,description:"Equals",value:s.ho.equal},{label:s.ho.notEqual,description:"Does not equal",value:s.ho.notEqual},{label:s.ho.regex,description:"Matches regex",value:s.ho.regex},{label:s.ho.notRegex,description:"Does not match regex",value:s.ho.notRegex}];function y(I){const L=h(I);return[I.name,L,I.value]}function x(I,L){return L.every(({name:B,value:j,isRegex:A,isEqual:K})=>Object.entries(I).some(([W,U])=>{const F=B===W;let V;return K&&!A&&(V=j===U),!K&&!A&&(V=j!==U),K&&A&&(V=new RegExp(j).test(U)),!K&&A&&(V=!new RegExp(j).test(U)),F&&V}))}function v(...I){const L=I.map(g.Zc).flat(),B=(0,t.uniqWith)(L,t.isEqual);return p(B)}function P(I){return I===r.hY?"default":"unquote"}function E(){return getAllDataSources().filter(I=>I.type===DataSourceType.Alertmanager)}function D(I){return E().find(L=>I===L.uid)}function C(I){const{times:L,weekdays:B,days_of_month:j,months:A,years:K,location:W}=I,U=b(L,W),F=T(B),V=S(j),w=O(A),z=M(K);return[U,F,V,w,z].join(", ")}function b(I,L){return"Times: "+(I?I?.map(({start_time:B,end_time:j})=>`${B} - ${j} [${L??"UTC"}]`).join(" and "):"All")}function T(I){return"Weekdays: "+(I?.map(L=>{if(L.includes(":"))return L.split(":").map(B=>{const j=B.slice(0,3);return j[0].toLocaleUpperCase()+j.slice(1)}).join("-");{const B=L.slice(0,3);return B[0].toLocaleUpperCase()+B.slice(1)}}).join(", ")??"All")}function S(I){return"Days of the month: "+(I?.join(", ")??"All")}function O(I){return"Months: "+(I?.join(", ")??"All")}function M(I){return"Years: "+(I?.join(", ")??"All")}},33225:(G,R,e)=>{"use strict";e.d(R,{Hx:()=>r,gO:()=>g});var t=e(96540),n=e(55740),s=e(78742);function a(i){return{dashboardUID:i.find(([l])=>l===n.YH.dashboardUID)?.[1],panelId:i.find(([l])=>l===n.YH.panelID)?.[1]}}function r(i){return(0,t.useMemo)(()=>Object.entries(i||{}).filter(([l,d])=>!!d.trim()),[i])}function g(i){const l=new Map,{panelId:d,dashboardUID:c}=a(i);return c&&l.set(n.YH.dashboardUID,(0,s.JM)(c)),c&&d&&l.set(n.YH.panelID,(0,s.D2)(c,d)),l}},82775:(G,R,e)=>{"use strict";e.d(R,{k:()=>s,q:()=>a});var t=e(32264),n=e(25968);function s(){return Object.values(t.$.datasources)}function a(r){if(!(0,n.TN)(t.$.unifiedAlerting.minInterval))return{globalLimit:0,exceedsLimit:!1};const g=(0,n.P8)(t.$.unifiedAlerting.minInterval);if(!r||!(0,n.TN)(r))return{globalLimit:g,exceedsLimit:!1};const i=(0,n.P8)(r),l=g>i&&i>0;return{globalLimit:g,exceedsLimit:l}}},55740:(G,R,e)=>{"use strict";e.d(R,{DD:()=>s,H8:()=>m,HH:()=>n,J3:()=>o,Oq:()=>a,U3:()=>g,UU:()=>t,YH:()=>h,cB:()=>i,kW:()=>p,kl:()=>u,wG:()=>r});const t="ruler not supported",n=3e4,s="alertmanager",a="alerting-alertmanager",r=2e4,g=2e4,i=2e4,l="timeseries",d="table",c="stat";var h=(f=>(f.description="description",f.summary="summary",f.runbookURL="runbook_url",f.alertId="__alertId__",f.dashboardUID="__dashboardUid__",f.panelID="__panelId__",f))(h||{});const o={description:"Description",summary:"Summary",runbook_url:"Runbook URL",__dashboardUid__:"Dashboard UID",__panelId__:"Panel ID",__alertId__:"Alert ID"},m={description:"Description of what the alert rule does.",summary:"Short summary of what happened and why.",runbook_url:"Webpage where you keep your runbook for the alert.",__dashboardUid__:"",__panelId__:"",__alertId__:""},u=[{key:"summary",value:""},{key:"description",value:""},{key:"runbook_url",value:""}],p="__alert_rule_uid__"},57220:(G,R,e)=>{"use strict";e.d(R,{AL:()=>K,EV:()=>B,Eb:()=>A,Jz:()=>x,Vr:()=>ee,Zw:()=>w,bD:()=>E,cy:()=>S,gR:()=>I,hP:()=>X,hY:()=>o,iV:()=>C,k5:()=>H,lS:()=>L,oh:()=>F,ol:()=>u,qi:()=>f,r3:()=>V,sq:()=>O,v0:()=>j,v8:()=>y,vv:()=>m,w5:()=>N,y9:()=>Q,yc:()=>W,z2:()=>U});var t=e(19347),n=e(16233),s=e(60021),a=e(31678),r=e(94822),g=e(82843),i=e(99085),l=e(62190),d=e(70383),c=e(75471),h=e(82775);const o="grafana",m="-- Grafana --";var u=(Z=>(Z.Alertmanager="alertmanager",Z.Loki="loki",Z.Prometheus="prometheus",Z))(u||{});const p=["loki","prometheus"];function f(){return n.TP.hasPermission(a.AccessControlAction.AlertingRuleExternalRead)?(0,h.k)().filter(Z=>p.includes(Z.type)&&Z.jsonData.manageAlerts!==!1).sort((Z,q)=>Z.name.localeCompare(q.name)):[]}function y(Z){return U(Z)?"grafana":Z.uid??Z.id}function x(Z){return f().find(q=>q.name===Z)}function v(){return(0,h.k)().filter(P).sort((Z,q)=>Z.name.localeCompare(q.name))}function P(Z){return Z.type==="alertmanager"}function E(Z){return Z.type==="alertmanager"}function D(){return v().filter(Z=>Z.jsonData.handleGrafanaManagedAlerts)}function C(Z){return Z.jsonData.handleGrafanaManagedAlerts===!0}const b={name:o,imgUrl:"public/img/grafana_icon.svg",hasConfigurationAPI:!0};function T(){return[b,...v().map(Z=>({name:Z.name,displayName:Z.name,imgUrl:Z.meta.info.logos.small,meta:Z.meta}))]}function S(Z){const q=(0,l.W)(Z),ae=q.availableExternalDataSources.filter(ne=>ne.handleGrafanaManagedAlerts),k=q.availableInternalDataSources,{currentData:se}=g.m.endpoints.getGrafanaAlertingConfigurationStatus.useQuery();switch(se?.alertmanagersChoice){case s.nA.Internal:return k;case s.nA.External:return ae;default:return[...k,...ae]}}function O(Z){const q=[],ae=[],k={instance:c.HL.read,notification:c.VQ.read,silence:c.nU.read};if([...Object.values(k).flatMap(ne=>ne.grafana),...i.w].some(ne=>n.TP.hasPermission(ne))&&q.push(b),n.TP.hasPermission(k[Z].external)){const ne=v().map(le=>({name:le.name,displayName:le.name,imgUrl:le.meta.info.logos.small,meta:le.meta,hasConfigurationAPI:(0,d.Kh)(le.jsonData),handleGrafanaManagedAlerts:le.jsonData.handleGrafanaManagedAlerts}));ae.push(...ne)}return{availableInternalDataSources:q,availableExternalDataSources:ae}}function M(Z){const q=F(Z);if(!q)throw new Error(`Data source ${Z} not found`);if(q.type!=="loki"&&q.type!=="prometheus")throw new Error(`Unexpected data source type ${q.type}`);return q}function I(){const Z=f().map(q=>q.name);return n.TP.hasPermission(a.AccessControlAction.AlertingRuleRead)&&Z.push(o),Z}function L(){const Z=f();return n.TP.hasPermission(a.AccessControlAction.AlertingRuleRead)&&Z.push(o),Z}function B(Z){return A(Z)?Z.name:Z}function j(Z){return A(Z)?Z.uid:o}function A(Z){return Z!==o}function K(Z){return Z!==o&&V(Z)?.jsonData?.implementation===s.Oz.prometheus}function W(Z){return Z.readOnly===!0}function U(Z){return Z===o}function F(Z){return(0,h.k)().find(q=>q.name===Z)}function V(Z){return(0,h.k)().filter(P).find(q=>q.name===Z)}function w(Z){return Z===o?o:F(Z)}function z(Z){if(Z===o)return o;const q=F(Z);if(!q)throw new Error(`Datasource "${Z}" not found`);return String(q.id)}function N(Z){if(Z===o)return o;const q=F(Z);if(!q)throw new Error(`Datasource "${Z}" not found`);return q.uid}function H(){return(0,t.l)().getList({alerting:!0})[0]}function Q(){const Z=(0,t.l)().getInstanceSettings("default");return Z?.meta.alerting??!1?Z:H()}function X(Z){return Z.jsonData.manageAlerts!==!1}function ee(Z){return U(Z)?"grafana":"prometheusType"in Z.jsonData?Z.jsonData?.prometheusType??r.N1.Prometheus:Z.type==="loki"?"loki":r.N1.Prometheus}},75214:(G,R,e)=>{"use strict";e.d(R,{Dd:()=>n,F2:()=>i,M4:()=>t,lL:()=>r,rm:()=>g,w0:()=>l,x4:()=>a,zm:()=>s});function t(d){return Object.entries(d).map(([c,h])=>`${c}=${h}`).sort()}function n(d){return Object.entries(d).map(([c,h])=>[c,h])}function s(d){const c={};return d.forEach(h=>{c[h[0]]=h[1]}),c}function a(d){const c={};return d.forEach(h=>{h.key&&(c[h.key]=h.value)}),c}const r="__grafana_origin";function g(d){return Object.keys(d).filter(c=>!i(c)).length}function i(d){return d.startsWith("__")&&d.endsWith("__")||d===r}const l=([d,c])=>i(d)},32642:(G,R,e)=>{"use strict";e.d(R,{Ig:()=>x,J$:()=>m,J9:()=>o,S6:()=>d,So:()=>i,Zc:()=>c,b2:()=>y,ou:()=>h,qR:()=>g,t8:()=>v});var t=e(2543),n=e.n(t),s=e(60021),a=e(75214);const r=[s.ho.regex,s.ho.notRegex,s.ho.notEqual,s.ho.equal];function g(C){if(C.startsWith("{")&&C.endsWith("}"))throw new Error("this function does not support PromQL-style matcher syntax, call parsePromQLStyleMatcher() instead");const b=r.map(I=>[I,C.indexOf(I)]).filter(([I,L])=>L>-1).sort((I,L)=>I[1]-L[1]);if(!b.length)throw new Error(`Invalid matcher: ${C}`);const[T,S]=b[0],O=C.slice(0,S).trim(),M=C.slice(S+T.length);if(!O)throw new Error(`Invalid matcher: ${C}`);return{name:O,value:M,isRegex:T===s.ho.regex||T===s.ho.notRegex,isEqual:T===s.ho.equal||T===s.ho.regex}}function i(C){return P(C)?l(C):[g(C)]}function l(C){if(!P(C))throw new Error("not a PromQL style matcher");return d(C)}function d(C){const b=/,(?=(?:[^"]*"[^"]*")*[^"]*$)/,T=C.replace(/^\{/,"").replace(/\}$/,"").trim().split(b);return(0,t.compact)(T).flatMap(g).map(S=>({...S,name:x(S.name),value:x(S.value)}))}function c(C){try{return d(C)}catch{return[]}}function h(C){const b=C.filter(T=>!!T.trim()).map(T=>g(T));return(0,t.uniqBy)(b,T=>T.name)}const o=C=>{const b=Object.entries(C).filter(([S])=>!(0,a.F2)(S)),T=new URLSearchParams;return b.forEach(([S,O])=>T.append("matcher",`${S}=${O}`)),T},m=C=>{let b=[];return C.matchers&&C.matchers.forEach(T=>{const S=i(T).map(E);b=b.concat(S)}),C.object_matchers&&b.push(...C.object_matchers),C.match_re&&Object.entries(C.match_re).forEach(([T,S])=>{b.push([T,s.ho.regex,S])}),C.match&&Object.entries(C.match).forEach(([T,S])=>{b.push([T,s.ho.equal,S])}),b};function u(C){return`"${C.replace(/[\\"]/g,T=>`\\${T}`)}"`}const p=/[\{\}\!\=\~\,\\\"\'\`\s]+/;function f(C){return p.test(C)?u(C):C}const y=({name:C,operator:b,value:T})=>{const S=f(C),O=u(T);return`${S}${b}${O}`};function x(C){return/^"(.*)"$/.test(C)?C.replace(/^"(.*)"$/,"$1").replace(/\\"/g,'"').replace(/\\\\/g,"\\"):C}const v={default:([C,b,T])=>`${C} ${b} ${T||""}`,unquote:([C,b,T])=>{const S=x(C),O=x(T)||'""';return`${S} ${b} ${O}`}};function P(C){return C.startsWith("{")&&C.endsWith("}")}function E(C){const b=D(C);return[C.name,b,C.value]}function D(C){return C.isEqual?C.isRegex?s.ho.regex:s.ho.equal:C.isRegex?s.ho.notRegex:s.ho.notEqual}},78742:(G,R,e)=>{"use strict";e.d(R,{BK:()=>M,Cp:()=>F,D2:()=>K,ES:()=>z,GD:()=>I,Ht:()=>E,JM:()=>A,JZ:()=>H,KT:()=>b,NH:()=>L,S2:()=>v,Sl:()=>P,Y9:()=>O,Yp:()=>f,bg:()=>y,c$:()=>B,i7:()=>x,i9:()=>W,nL:()=>T,qN:()=>j,qc:()=>w,qy:()=>C,u7:()=>N,w$:()=>p,y$:()=>V});var t=e(2543),n=e.n(t),s=e(61268),a=e(32264),r=e(17172),g=e(16233),i=e(18461),l=e(23662),d=e(64861),c=e(94822),h=e(55740),o=e(57220),m=e(32642),u=e(3704);function p(Q,X,ee){const Z=(0,o.EV)(Q),q=i.UP(Z,X),ae=encodeURIComponent(i.$9(q)),k=encodeURIComponent(Z);return(0,u.G)(`/alerting/${k}/${ae}/view`,ee?{returnTo:ee}:{})}function f(Q,X){const{uid:ee,type:Z}=Q;return(0,u.G)("/explore",{left:JSON.stringify({datasource:Q.uid,queries:[{refId:"A",datasource:{uid:ee,type:Z},expr:X}],range:{from:"now-1h",to:"now"}})})}function y(Q,X=""){return(0,u.G)(`/alerting/notifications/receivers/${encodeURIComponent(Q)}/edit`,{alertmanager:X})}function x(Q,X=""){return(0,u.G)("/alerting/routes/mute-timing/edit",{muteName:Q,alertmanager:X})}function v(Q,X){if((0,o.Eb)(Q))return(0,u.z)(`/alerting/${encodeURIComponent(Q.name)}/${encodeURIComponent((0,i.PH)(X.name))}/find`);if((0,l.lT)(X.rulerRule))return(0,u.z)(`/alerting/grafana/${X.rulerRule.grafana_alert.uid}/view`)}function P(Q){return Q.reduce((X,{key:ee,value:Z})=>(X[ee]=Z,X),{})}const E=Q=>{const X=Q.queryString===void 0?void 0:String(Q.queryString),ee=Q.alertState===void 0?void 0:String(Q.alertState),Z=Q.dataSource===void 0?void 0:String(Q.dataSource),q=Q.ruleType===void 0?void 0:String(Q.ruleType),ae=Q.groupBy===void 0?void 0:String(Q.groupBy).split(",");return{queryString:X,alertState:ee,dataSource:Z,groupBy:ae,ruleType:q}},D=Q=>({queryString:Q.get("queryString")??void 0,contactPoint:Q.get("contactPoint")??void 0}),C=Q=>{const X=Q.queryString===void 0?void 0:String(Q.queryString),ee=Q.silenceState===void 0?void 0:String(Q.silenceState);return{queryString:X,silenceState:ee}};function b(Q){return Object.entries(Q).map(([X,ee])=>({key:X,value:ee}))}function T(Q,X,ee){const Z=new URLSearchParams(ee);return X&&Z.set(h.DD,X),`${Q}?${Z.toString()}`}const S=Q=>Q.replace(/\"/g,'\\"');function O(Q){return Q.startsWith('"')&&Q.endsWith('"')?S(Q):`"${S(Q)}"`}function M(Q,X){const ee=new URLSearchParams;return ee.append("alertmanager",Q),(0,m.J9)(X).forEach((q,ae)=>ee.append(ae,q)),(0,u.G)("/alerting/silence/new",ee)}function I(Q){return(0,u.G)(`/datasources/edit/${Q}`)}function L(Q){return(0,u.G)(`/dashboards/f/${Q}`)}function B(Q,X){return(0,u.G)(`/dashboards/f/${Q}/${X}/alerting`)}function j(Q){return(0,u.G)(`/dashboards/f/${Q}/settings`)}function A(Q){return(0,u.G)(`/d/${encodeURIComponent(Q)}`)}function K(Q,X){const ee=new URLSearchParams({viewPanel:X});return(0,u.G)(`/d/${encodeURIComponent(Q)}`,ee)}function W(Q,X,ee,Z=1e3){const q=new Date().getTime(),ae=()=>Q().catch(k=>{if(X(k)&&new Date().getTime()-q<ee)return new Promise(se=>setTimeout(se,Z)).then(ae);throw k});return ae()}const U={[c.Gi.Alerting]:1,[c.cF.Firing]:1,[c.Gi.Error]:1,[c.Gi.Pending]:2,[c.cF.Pending]:2,[c.cF.Inactive]:2,[c.Gi.NoData]:3,[c.Gi.Normal]:4};function F(Q,X){if(Q===d.xB.Importance)return(0,t.sortBy)(X,Z=>[U[(0,c.lh)(Z.state)],(0,l.RI)(Z).toLocaleLowerCase()]);if(Q===d.xB.TimeAsc)return(0,t.sortBy)(X,Z=>[new Date(Z.activeAt)||new Date,(0,l.RI)(Z).toLocaleLowerCase()]);if(Q===d.xB.TimeDesc)return(0,t.sortBy)(X,Z=>[new Date(Z.activeAt)||new Date,(0,l.RI)(Z).toLocaleLowerCase()]).reverse();const ee=(0,t.sortBy)(X,Z=>(0,l.RI)(Z).toLocaleLowerCase());return Q===d.xB.AlphaDesc&&ee.reverse(),ee}function V(){return a.$.buildInfo.edition===s.r.OpenSource}function w(){return g.TP.hasRole("Admin")||g.TP.isGrafanaAdmin}function z(){return a.$.buildInfo.env==="development"}function N(Q){return!!(Q&&typeof Q=="object"&&"message"in Q)}function H(Q){return(0,r.NF)(Q)?Q.message?Q.message:"message"in Q.data&&typeof Q.data.message=="string"?Q.data.message:Q.statusText?Q.statusText:String(Q.status)||"Unknown error":N(Q)?Q.cause?`${Q.message}, cause: ${H(Q.cause)}`:Q.message:String(Q)}},88467:(G,R,e)=>{"use strict";e.d(R,{$I:()=>h,BU:()=>E,CZ:()=>u,J7:()=>d,ML:()=>D,Vf:()=>v,Xw:()=>c,jA:()=>i,p0:()=>p,t4:()=>P,v5:()=>o});var t=e(65307),n=e(26272),s=e(17172),a=e(10096),r=e(25027),g=e(78742);const i=Object.freeze({loading:!1,result:void 0,error:void 0,dispatched:!1});function l(C,b=i,T){if(C.pending.match(T))return{result:b.result,loading:!0,error:b.error,dispatched:!0,requestId:T.meta.requestId};if(C.fulfilled.match(T)){if(b.requestId===void 0||b.requestId===T.meta.requestId)return{...b,result:T.payload,loading:!1,error:void 0}}else if(C.rejected.match(T)&&b.requestId===T.meta.requestId)return{...b,loading:!1,error:T.error};return b}function d(C,b){return(0,t.Z0)({name:C,initialState:i,reducers:{},extraReducers:T=>T.addDefaultCase((S,O)=>l(b,S,O))})}function c(C,b,T){return(0,t.Z0)({name:C,initialState:{},reducers:{},extraReducers:S=>S.addDefaultCase((O,M)=>{if((0,t.$S)(b)(M)){const I=M,L=T(I.meta.arg);return{...O,[L]:l(b,O[L],I)}}return O})})}function h(C){return C.catch(b=>{throw{message:u(b),code:b.statusCode}})}function o(C,b){return C.then(T=>(b.successMessage&&a.lE.emit(n.r1.alertSuccess,[b.successMessage]),T)).catch(T=>{const S=u(T);throw a.lE.emit(n.r1.alertError,[`${b.errorMessage??"Error"}: ${S}`]),T})}const m="Unknown Error";function u(C){if((0,s.NF)(C))if(C.data?.message){let b=C.data?.message;return typeof C.data?.error=="string"&&(b+=`; ${C.data.error}`),b}else{if(Array.isArray(C.data)&&C.data.length&&C.data[0]?.message)return C.data.map(b=>b?.message).filter(b=>!!b).join(" ");if(C.statusText)return C.statusText}return(0,g.u7)(C)?C.message:((0,r.fH)(r.le.unknownMessageFromError,{error:JSON.stringify(C)}),m)}function p(C){return Object.values(C).every(f)}function f(C){return C.dispatched&&!C.loading}function y(C){return Object.values(C).every(x)}function x(C){return C.dispatched&&!C.loading&&!C.error}function v(C){return Object.values(C).some(D)}function P(C){return Object.values(C).some(b=>b.dispatched)}function E(C){return Object.values(C).some(x)}function D(C){return C?C.dispatched&&C.loading:!1}},63066:(G,R,e)=>{"use strict";e.d(R,{Bu:()=>le,IJ:()=>O,J6:()=>k,JE:()=>j,Os:()=>D,Q8:()=>E,QX:()=>N,Qk:()=>H,Rk:()=>re,T6:()=>S,XI:()=>Q,Z9:()=>W,ir:()=>de,l1:()=>L,mp:()=>ae,qO:()=>X});var t=e(2543),n=e.n(t),s=e(43127),a=e(65879),r=e(77789),g=e(32264),i=e(19347),l=e(26657),d=e(84537),c=e(74730),h=e(66718),o=e(94822),m=e(55907),u=e(86590),p=e(75471),f=e(55740),y=e(57220),x=e(78742),v=e(23662),P=e(25968);const E="grafana.alerting.manualRouting",D="grafana.alerting.simplifiedQueryEditor",C=(0,P.P8)(g.$.unifiedAlerting?.minInterval??"10s"),b=(0,P.P8)("1m"),S=(0,P.an)((0,t.clamp)(C,b,1/0)),O=()=>{const{canCreateGrafanaRules:oe,canCreateCloudRules:J}=(0,p.Q9)();return Object.freeze({name:"",uid:"",labels:[{key:"",value:""}],annotations:f.kl,dataSourceName:y.hY,type:oe?u.Z.grafana:J?u.Z.cloudAlerting:void 0,group:"",folder:null,queries:[],recordingRulesQueries:[],condition:"",noDataState:o.Q8.NoData,execErrState:o.Q8.Error,evaluateFor:S,evaluateEvery:S,manualRouting:M(),contactPoints:{},overrideGrouping:!1,overrideTimings:!1,muteTimeIntervals:[],editorSettings:I(),namespace:"",expression:"",forTime:1,forTimeUnit:"m"})},M=()=>g.$.featureToggles.alertingSimplifiedRouting??!1?localStorage.getItem(E)!=="false":!1;function I(){return g.$.featureToggles.alertingQueryAndExpressionsStepMode??!1?{simplifiedQueryEditor:localStorage.getItem(D)!=="false"}:void 0}function L(oe){const{name:J,expression:ce,forTime:pe,forTimeUnit:xe,keepFiringForTime:fe,keepFiringForTimeUnit:Ee,type:Se}=oe,ye=(0,x.Sl)(U(oe.annotations)),Ve=(0,x.Sl)(F(oe.labels));if(Se===u.Z.cloudAlerting){let Me;return fe&&Ee&&(Me=`${fe}${Ee}`),{alert:J,for:`${pe}${xe}`,keep_firing_for:Me,annotations:ye,labels:Ve,expr:ce}}else if(Se===u.Z.cloudRecording)return{record:J,labels:Ve,expr:ce};throw new Error(`unexpected rule type: ${Se}`)}function B(oe,J){const ce=[...(0,x.KT)(oe||{})];return J&&ce.push({key:"",value:""}),ce}function j(oe){const J=[...oe];return f.kl.map(pe=>pe.key).forEach((pe,xe)=>{const fe=J.findIndex(Ee=>Ee.key===pe);if(fe===-1){const Ee={key:pe,value:""};J.splice(xe,0,Ee)}else fe!==xe&&J.splice(xe,0,J.splice(fe,1)[0])}),J}function A(oe,J){if(J?.grafana?.selectedContactPoint&&oe)return{receiver:J?.grafana?.selectedContactPoint,mute_time_intervals:J?.grafana?.muteTimeIntervals,group_by:J?.grafana?.overrideGrouping?J?.grafana?.groupBy:void 0,group_wait:J?.grafana?.overrideTimings&&J?.grafana?.groupWaitValue?J?.grafana?.groupWaitValue:void 0,group_interval:J?.grafana?.overrideTimings&&J?.grafana?.groupIntervalValue?J?.grafana?.groupIntervalValue:void 0,repeat_interval:J?.grafana?.overrideTimings&&J?.grafana?.repeatIntervalValue?J?.grafana?.repeatIntervalValue:void 0}}function K(oe){return{simplified_query_and_expressions_section:oe.simplifiedQueryEditor}}function W(oe){const{name:J,condition:ce,noDataState:pe,execErrState:xe,evaluateFor:fe,queries:Ee,isPaused:Se,contactPoints:ye,manualRouting:Ve,type:Me,metric:Ce}=oe;if(!ce)throw new Error("You cannot create an alert rule without specifying the alert condition");const Ue=A(Ve,ye),Ae=oe.editorSettings?{editor_settings:K(oe.editorSettings)}:void 0,we=(0,x.Sl)(U(oe.annotations)),We=(0,x.Sl)(F(oe.labels)),_e=(0,v.Mu)(Me),at=(0,v.pq)(Me);if(_e)return{grafana_alert:{title:J,condition:ce,data:Ee.map(te),is_paused:!!Se,no_data_state:pe,exec_err_state:xe,notification_settings:Ue,metadata:Ae},annotations:we,labels:We,for:fe};if(at)return{grafana_alert:{title:J,condition:ce,data:Ee.map(te),is_paused:!!Se,record:{metric:Ce??J,from:ce}},annotations:we,labels:We};throw new Error(`Failed to convert form values to Grafana rule: unknown type ${Me}`)}const U=oe=>oe.map(V).filter(({key:J,value:ce})=>!!J&&!!ce),F=oe=>oe.map(V).filter(({key:J})=>!!J),V=({key:oe,value:J})=>({key:oe.trim(),value:J.trim()});function w(oe){const J=oe.notification_settings?{selectedContactPoint:oe.notification_settings.receiver,muteTimeIntervals:oe.notification_settings.mute_time_intervals??[],overrideGrouping:Array.isArray(oe.notification_settings.group_by)&&oe.notification_settings.group_by.length>0,overrideTimings:[oe.notification_settings.group_wait,oe.notification_settings.group_interval,oe.notification_settings.repeat_interval].some(Boolean),groupBy:oe.notification_settings.group_by||[],groupWaitValue:oe.notification_settings.group_wait||"",groupIntervalValue:oe.notification_settings.group_interval||"",repeatIntervalValue:oe.notification_settings.repeat_interval||""}:void 0;return J?{[y.hY]:J}:void 0}function z(oe){if(g.$.featureToggles.alertingQueryAndExpressionsStepMode)return oe.metadata?.editor_settings?{simplifiedQueryEditor:oe.metadata.editor_settings.simplified_query_and_expressions_section}:{simplifiedQueryEditor:!1}}function N(oe){const{ruleSourceName:J,namespace:ce,group:pe,rule:xe}=oe,fe=O();if((0,y.z2)(J))if((0,v.Gy)(xe)){const Ee=xe.grafana_alert;return{...fe,name:Ee.title,type:u.Z.grafanaRecording,group:pe.name,evaluateEvery:pe.interval||fe.evaluateEvery,queries:Ee.data,condition:Ee.condition,annotations:j(B(xe.annotations,!1)),labels:B(xe.labels,!0),folder:{title:ce,uid:Ee.namespace_uid},isPaused:Ee.is_paused,metric:Ee.record?.metric}}else if((0,v.lT)(xe)){const Ee=xe.grafana_alert,Se=w(Ee);if(Ee.no_data_state!==void 0&&Ee.exec_err_state!==void 0)return{...fe,name:Ee.title,type:u.Z.grafana,group:pe.name,evaluateEvery:pe.interval||fe.evaluateEvery,evaluateFor:xe.for||"0",noDataState:Ee.no_data_state,execErrState:Ee.exec_err_state,queries:Ee.data,condition:Ee.condition,annotations:j(B(xe.annotations,!1)),labels:B(xe.labels,!0),folder:{title:ce,uid:Ee.namespace_uid},isPaused:Ee.is_paused,contactPoints:Se,manualRouting:!!Se,editorSettings:z(Ee)};throw new Error("Unexpected type of rule for grafana rules source")}else throw new Error("Unexpected type of rule for grafana rules source");else if((0,v.$y)(xe)){const Se={refId:"A",datasourceUid:(0,i.l)().getInstanceSettings(J)?.uid??"",queryType:"",relativeTimeRange:(0,s.Cn)(),expr:xe.expr,model:{refId:"A",hide:!1,expr:xe.expr}},ye=H(xe);return{...fe,...ye,queries:[Se],annotations:j(B(xe.annotations,!1)),type:u.Z.cloudAlerting,dataSourceName:J,namespace:ce,group:pe.name}}else if((0,v.i7)(xe)){const Ee=Q(xe);return{...fe,...Ee,type:u.Z.cloudRecording,dataSourceName:J,namespace:ce,group:pe.name}}else throw new Error("Unexpected type of rule for cloud rules source")}function H(oe){const J=O(),[ce,pe]=oe.for?(0,P.P1)(oe.for):[0,"s"],[xe,fe]=oe.keep_firing_for?(0,P.P1)(oe.keep_firing_for):[J.keepFiringForTime,J.keepFiringForTimeUnit];return{name:oe.alert,expression:oe.expr,forTime:ce,forTimeUnit:pe,keepFiringForTime:xe,keepFiringForTimeUnit:fe,annotations:B(oe.annotations,!1),labels:B(oe.labels,!0)}}function Q(oe){return{name:oe.record,expression:oe.expr,labels:B(oe.labels,!0)}}const X=()=>{const oe=(0,y.y9)();if(!oe)return[...Z("A","B")];const J=(0,s.Cn)();return[{refId:"A",datasourceUid:oe.uid,queryType:"",relativeTimeRange:J,model:{refId:"A"}},...Z("B","C")]},ee=oe=>{const J=getDefaultRelativeTimeRange();return[{refId:"A",datasourceUid:oe[0]?.uid||"",queryType:"",relativeTimeRange:J,model:{refId:"A"}}]},Z=(...oe)=>{const J=oe[0],ce=oe[1],pe={refId:oe[0],type:h.Tz.reduce,datasource:{uid:h.Uj,type:l.dR.type},conditions:[{type:"query",evaluator:{params:[],type:m.p.IsAbove},operator:{type:"and"},query:{params:[J]},reducer:{params:[],type:"last"}}],reducer:"last",expression:"A"},xe={refId:ce,type:h.Tz.threshold,datasource:{uid:h.Uj,type:l.dR.type},conditions:[{type:"query",evaluator:{params:[0],type:m.p.IsAbove},operator:{type:"and"},query:{params:[ce]},reducer:{params:[],type:"last"}}],expression:J};return[{refId:J,datasourceUid:h.Uj,queryType:"",model:pe},{refId:ce,datasourceUid:h.Uj,queryType:"",model:xe}]},q=async(oe,J,ce,pe,xe,fe)=>{const Ee=[];for(const Se of oe){const ye=await(0,i.l)().get(Se.datasource?.uid?Se.datasource:pe),Ve={uid:ye.uid,type:ye.type},Me=a.relativeToTimeRange(J),{interval:Ce,intervalMs:Ue}=se(Me,fe??ye.interval,xe),Ae={__interval:{text:Ce,value:Ce},__interval_ms:{text:Ue,value:Ue},...ce},we=ye.interpolateVariablesInQueries?ye.interpolateVariablesInQueries([Se],Ae)[0]:Se;if(Ve.uid===h.Uj){const We={refId:we.refId,queryType:"",relativeTimeRange:J,datasourceUid:h.Uj,model:we};Ee.push(We)}else{const We=(0,i.l)().getInstanceSettings(Ve);if(We&&We.meta.alerting){const _e={refId:we.refId,queryType:we.queryType??"",relativeTimeRange:J,datasourceUid:We.uid,model:{...we,maxDataPoints:xe,intervalMs:Ue}};Ee.push(_e)}}}return Ee},ae=async(oe,J)=>{const{targets:ce}=oe;if(!oe.id||!J.uid)return;const pe=a.timeRangeToRelative(a.convertRawToRange(J.time)),xe=await q(ce,pe,oe.scopedVars||{},oe.datasource??void 0,oe.maxDataPoints??void 0,oe.interval??void 0);if(!xe.length||!xe.find(ye=>ye.datasourceUid!==h.Uj))return;if(!xe.find(ye=>ye.datasourceUid===h.Uj)){const[ye,Ve]=Z((0,r.M)(xe),"-");xe.push(ye);const[Me,Ce]=Z(ye.refId,(0,r.M)(xe));xe.push(Ce)}const{folderTitle:fe,folderUid:Ee}=J.meta;return{type:u.Z.grafana,folder:Ee&&fe?{uid:Ee,title:fe}:void 0,queries:xe,name:oe.title,condition:xe[xe.length-1].refId,annotations:[{key:f.YH.dashboardUID,value:J.uid},{key:f.YH.panelID,value:String(oe.id)}]}},k=async oe=>{if(!oe.state.key)return;const J=d.jh.getTimeRange(oe),ce=(0,c.un)(oe);if(!ce)return;const{queries:pe,datasource:xe,maxDataPoints:fe,minInterval:Ee}=ce.state,Se=(0,c.YQ)(oe);if(!Se||!Se.state.uid)return;const ye=await q(pe,a.timeRangeToRelative(a.convertRawToRange(J.state.value.raw)),{__sceneObject:{value:oe}},xe,fe,Ee);if(!ye.length||!ye.find(Ue=>Ue.datasourceUid!==h.Uj))return;if(!ye.find(Ue=>Ue.datasourceUid===h.Uj)){const[Ue,Ae]=Z((0,r.M)(ye),"-");ye.push(Ue);const[we,We]=Z(Ue.refId,(0,r.M)(ye));ye.push(We)}const{folderTitle:Ve,folderUid:Me}=Se.state.meta;return{type:u.Z.grafana,folder:Me&&Ve?{uid:Me,title:Ve}:void 0,queries:ye,name:oe.state.title,condition:ye[ye.length-1].refId,annotations:[{key:f.YH.dashboardUID,value:Se.state.uid},{key:f.YH.panelID,value:String((0,c.Cs)(oe))}]}};function se(oe,J,ce){return ce?a.calculateInterval(oe,ce,J):J&&a.intervalToMs(J)>1e3?{interval:J,intervalMs:a.intervalToMs(J)}:{interval:"1s",intervalMs:1e3}}function te(oe){const J=oe.model;return ne(J)&&J.instant&&J.range?{...oe,model:{...J,range:!0,instant:!1}}:oe}function ne(oe){return"expr"in oe&&"instant"in oe&&"range"in oe}function le(oe){return"expr"in oe}const re=oe=>({...oe,queries:oe.queries?.map(J=>(0,t.omit)(J,"model.hide"))});function de(oe){return re(N(oe))}},18461:(G,R,e)=>{"use strict";e.d(R,{$9:()=>D,LC:()=>m,Lg:()=>c,Ns:()=>b,P1:()=>l,PH:()=>x,UP:()=>h,VY:()=>L,c:()=>v,h1:()=>M,mw:()=>d,qg:()=>P,uE:()=>B,x6:()=>E});var t=e(2543),n=e.n(t),s=e(39601),a=e(94822),r=e(24608),g=e(57220),i=e(23662);function l(j,A,K,W){return(0,i.lT)(W)?{uid:W.grafana_alert.uid,ruleSourceName:"grafana"}:{ruleSourceName:j,namespace:A,groupName:K,ruleName:(0,i.$y)(W)?W.alert:W.record,rulerRuleHash:b(W)}}function d(j,A){const{dataSourceName:K,namespaceName:W,groupName:U}=j;return l(K,W,U,A)}function c(j,A,K,W){return{ruleSourceName:j,namespace:A,groupName:K,ruleName:W.name,ruleHash:S(W)}}function h(j,A){const K=A.namespace.name,W=A.group.name;if(A.rulerRule)return l(j,K,W,A.rulerRule);if(A.promRule)return c(j,K,W,A.promRule);throw new Error("Could not create an id for a rule that is missing both `rulerRule` and `promRule`.")}function o(j){return l(j.ruleSourceName,j.namespace,j.group.name,j.rule)}function m(j,A){return(0,i.A4)(j)&&(0,i.A4)(A)?j.uid===A.uid:(0,i.X4)(j)&&(0,i.X4)(A)?j.groupName===A.groupName&&j.namespace===A.namespace&&j.ruleName===A.ruleName&&j.rulerRuleHash===A.rulerRuleHash&&j.ruleSourceName===A.ruleSourceName:(0,i.Mj)(j)&&(0,i.Mj)(A)?j.groupName===A.groupName&&j.namespace===A.namespace&&j.ruleName===A.ruleName&&j.ruleHash===A.ruleHash&&j.ruleSourceName===A.ruleSourceName:(0,i.X4)(j)&&(0,i.Mj)(A)?j.groupName===A.groupName&&j.namespace===A.namespace&&j.ruleName===A.ruleName&&j.rulerRuleHash===A.ruleHash&&j.ruleSourceName===A.ruleSourceName:(0,i.Mj)(j)&&(0,i.X4)(A)?j.groupName===A.groupName&&j.namespace===A.namespace&&j.ruleName===A.ruleName&&j.ruleHash===A.rulerRuleHash&&j.ruleSourceName===A.ruleSourceName:!1}const u="cri",p="pri";function f(j){return j.replace(/\$/g,"_DOLLAR_")}function y(j){return j.replace(/\_DOLLAR\_/g,"$")}function x(j){return j.replace(/\//g,"").replace(/\\/g,"")}function v(j){return j.replace(/\x1f/g,"/").replace(/\x1e/g,"\\")}function P(j,A=!1){const W=(A?decodeURIComponent(j):j).split("$");if(W.length===1)return{uid:j,ruleSourceName:"grafana"};if(W.length===6){const[U,F,V,w,z,N]=W.map(y).map(v);if(U===u)return{ruleSourceName:F,namespace:V,groupName:w,ruleName:z,rulerRuleHash:N};if(U===p)return{ruleSourceName:F,namespace:V,groupName:w,ruleName:z,ruleHash:N}}throw new Error(`Failed to parse rule location: ${j}`)}function E(j,A=!1){if(j)try{return P(j,A)}catch{return}}function D(j){return(0,i.A4)(j)?j.uid:(0,i.X4)(j)?[u,j.ruleSourceName,j.namespace,j.groupName,j.ruleName,j.rulerRuleHash].map(String).map(f).map(x).join("$"):[p,j.ruleSourceName,j.namespace,j.groupName,j.ruleName,j.ruleHash].map(String).map(f).map(x).join("$")}function C(j){let A=0;if(j.length===0)return A;for(let K=0;K<j.length;K++){const W=j.charCodeAt(K);A=(A<<5)-A+W,A=A&A}return A}function b(j){if((0,i.lT)(j))return j.grafana_alert.uid;const A=T(j);return C(JSON.stringify(A)).toString()}function T(j){const K=(0,r.w)()?"":M(j.expr),W=I(j.labels);if((0,i.i7)(j))return[j.record,a.JS.Recording,K,W];if((0,i.$y)(j))return[j.alert,a.JS.Alerting,K,I(j.annotations),W];throw new Error("Only recording and alerting ruler rules can be hashed")}function S(j){const A=O(j);return C(JSON.stringify(A)).toString()}function O(j){const K=(0,r.w)()?"":M(j.query),W=I(j.labels);if((0,i.KB)(j))return[j.name,a.JS.Recording,K,W];if((0,i.Z8)(j))return[j.name,a.JS.Alerting,K,I(j.annotations),W];throw new Error("Only recording and alerting rules can be hashed")}function M(j){return j.length>1&&j[0]==="("&&j[j.length-1]===")"&&(j=j.slice(1,-1)),j=j.replace(/\s|\n/g,""),j.split("").sort().join("")}function I(j){return JSON.stringify(Object.entries(j||{}).sort((A,K)=>A[0].localeCompare(K[0])))}function L(j){return(0,i.A4)(j)?g.hY:j.ruleSourceName}function B(j){const{pathname:A=""}=s.Ny.getLocation(),{id:K}=j;return K?(0,t.nth)(A.split("/"),-2):void 0}},23662:(G,R,e)=>{"use strict";e.d(R,{$7:()=>C,$y:()=>u,A4:()=>b,BL:()=>ne,Gy:()=>y,H2:()=>re,HH:()=>E,I2:()=>q,KB:()=>m,Mj:()=>O,Mt:()=>P,Mu:()=>se,OF:()=>le,Om:()=>N,RI:()=>D,Rh:()=>B,TU:()=>F,Tm:()=>K,UL:()=>f,Uw:()=>Z,Wy:()=>w,X4:()=>T,XI:()=>W,YN:()=>H,Z8:()=>o,dS:()=>V,f6:()=>I,fC:()=>L,i7:()=>p,j_:()=>ae,jg:()=>X,lT:()=>v,nf:()=>S,pq:()=>te,pv:()=>x,qz:()=>Q,s_:()=>oe,uo:()=>j,vE:()=>de,y1:()=>k});var t=e(2543),n=e.n(t),s=e(43585),a=e(32264),r=e(94822),g=e(28475),i=e(86590),l=e(55740),d=e(57220),c=e(75214),h=e(25968);function o(J){return typeof J=="object"&&J.type===r.JS.Alerting}function m(J){return typeof J=="object"&&J.type===r.JS.Recording}function u(J){return typeof J=="object"&&"alert"in J}function p(J){return typeof J=="object"&&"record"in J}function f(J){return typeof J=="object"&&p(J)||v(J)&&"record"in J.grafana_alert}function y(J){return typeof J=="object"&&f(J)&&v(J)}function x(J){return typeof J=="object"&&v(J)&&!f(J)}function v(J){return typeof J=="object"&&"grafana_alert"in J}function P(J){return typeof J=="object"&&!v(J)}function E(J){return J&&v(J)&&!!J.grafana_alert.is_paused}function D(J){return JSON.stringify(J.labels)}function C(J){return J.error&&J.error?.message?.includes(l.UU)}function b(J){return"uid"in J}function T(J){return"rulerRuleHash"in J}function S(J){return Object.values(r.JS).includes(J)}function O(J){return"ruleHash"in J}function M(J){return b(J)||T(J)}function I(J){switch(J){case"ok":return g.Jc.Ok;case"nodata":return g.Jc.NoData;case"error":case"err":return g.Jc.Error;case"unknown":return g.Jc.Unknown;default:return}}function L(J){if(!(p(J.rulerRule)||m(J.promRule)||y(J.rulerRule))){if(u(J.rulerRule))return J.rulerRule.for;if(o(J.promRule)){const ce=(J.promRule.duration??0)*1e3;return(0,h.an)(ce)}}}function B(J){if(!(p(J.rulerRule)||m(J.promRule)||y(J.rulerRule)))return J.annotations??[]}function j(J){const ce=J.labels[c.lL];if(!ce)return;const pe=ce.match(/^plugin\/(?<pluginId>.+)$/);if(!pe?.groups)return;const xe=pe.groups.pluginId;if(A(xe))return{pluginId:xe}}function A(J){return!!a.$.apps[J]}function K(J){return!!j(J)}function W(J){return J===r.cF.Inactive?"Normal":(0,t.capitalize)(J)}const U=J=>J.reduce((ce,{dataSourceName:pe,name:xe,groups:fe})=>(fe.forEach(({name:Ee,rules:Se})=>{Se.forEach(ye=>{o(ye)&&ce.push({dataSourceName:pe,namespaceName:xe,groupName:Ee,rule:ye})})}),ce),[]),F=J=>o(J.promRule)?J.promRule:null,V=J=>J.reduce((ce,{rulesSource:pe,name:xe,groups:fe})=>(fe.forEach(({name:Ee,rules:Se})=>{Se.forEach(ye=>{ye.promRule&&o(ye.promRule)&&ce.push({dataSourceName:(0,d.EV)(pe),namespaceName:xe,groupName:Ee,...ye})})}),ce),[]);function w(J){let ce;return Object.values(s.O).includes(J)?ce=J:ce=(0,r.lh)(J),z[ce]}const z={[r.cF.Inactive]:"good",[r.cF.Firing]:"bad",[r.cF.Pending]:"warning",[r.Gi.Alerting]:"bad",[r.Gi.Error]:"bad",[r.Gi.NoData]:"info",[r.Gi.Normal]:"good",[r.Gi.Pending]:"warning",[s.O.NoData]:"info",[s.O.Paused]:"warning",[s.O.Alerting]:"bad",[s.O.OK]:"good",[s.O.Unknown]:"info"};function N(J){return J?.alerts?J.alerts.reduce((ce,pe)=>{const xe=(0,r.lh)(pe.state)!==r.Gi.Normal;if(pe.activeAt&&xe){const fe=new Date(pe.activeAt);if(ce===null||ce.getTime()>fe.getTime())return fe}return ce},null):null}function H(J){return Array.isArray(J.source_tenants)}function Q(J){return v(J)?J.grafana_alert.title:u(J)?J.alert:p(J)?J.record:""}const X=(J,ce)=>{const pe={alertName:"",forDuration:"0s",evaluationsToFire:0};return v(J)?{alertName:J.grafana_alert.title,forDuration:J.for,evaluationsToFire:J.for?ee(J.for,ce):null}:u(J)?{alertName:J.alert,forDuration:J.for??"0s",evaluationsToFire:ee(J.for??"0s",ce)}:pe},ee=(J,ce)=>{const pe=(0,h.P8)(ce),xe=(0,h.P8)(J);return xe===0&&pe!==0?1:pe===0||xe/pe<1?0:Math.ceil(xe/pe)+1};function Z(J){const ce=(0,d.z2)(J.namespace.rulesSource)?J.namespace.rulesSource:J.namespace.rulesSource.name,pe=v(J.rulerRule)?J.rulerRule.grafana_alert.namespace_uid:J.namespace.name;return{dataSourceName:ce,namespaceName:pe,groupName:J.group.name}}function q(J){const ce=J.ruleSourceName,pe=v(J.rule)?J.rule.grafana_alert.namespace_uid:J.namespace,xe=J.group.name;return{dataSourceName:ce,namespaceName:pe,groupName:xe}}function ae(J){const ce=J.dataSourceName,pe=J.folder?.uid??J.namespace,xe=J.group;if(!ce)throw new Error("no datasource name in form values");return{dataSourceName:ce,namespaceName:pe,groupName:xe}}function k(J){return(0,d.z2)(J)?J:J.name}function se(J){return J===i.Z.grafana}function te(J){return J===i.Z.grafanaRecording}function ne(J){return J===i.Z.cloudAlerting}function le(J){return J===i.Z.cloudRecording}function re(J){return se(J)||te(J)}function de(J){return te(J)||le(J)}function oe(J){return ne(J)||le(J)}},25968:(G,R,e)=>{"use strict";e.d(R,{M9:()=>d,P1:()=>n,P8:()=>h,TN:()=>r,an:()=>c,mo:()=>o,sc:()=>a,yl:()=>m});var t=e(41068);function n(u){const p=u.match(/(\d+)(\w+)/);if(p)return[Number(p[1]),p[2]];throw new Error(`Invalid interval description: ${u}`)}function s(u){const{sec:p,count:f}=describeInterval(u);return p*f}const a=Object.entries(t.y).map(([u,p])=>({label:u[0].toUpperCase()+u.slice(1),value:p}));function r(u){try{return d(u),!0}catch{return!1}}const g={ms:1,s:1e3,m:60*1e3,h:60*60*1e3,d:24*60*60*1e3,w:7*24*60*60*1e3,y:365*24*60*60*1e3},i=new RegExp(/^(?:(?<value>\d+)(?<type>ms|s|m|h|d|w|y))|0$/),l=new Error(`Must be of format "(number)(unit)", for example "1m", or just "0". Available units: ${Object.values(t.y).join(", ")}`);function d(u){let p=u;const f=[];function y(v){const P=i.exec(v),E=P?.groups?.value&&P?.groups?.type;if(!P||!E)throw l;P&&P.groups?.value&&P.groups?.type&&(p=p.replace(P[0],""),f.push([Number(P.groups.value),P.groups.type])),p&&y(p)}if(y(u),!f.length)throw l;return f.reduce((v,[P,E])=>{const D=P*g[E];return v+D},0)}function c(u){const p=Math.floor(u/1e3),f=Math.floor(p/60),y=Math.floor(f/60),x=Math.floor(y/24),v=Math.floor(x/7),P=Math.floor(x/365);return u===0?"0s":[[P,"y"],[v%52,"w"],[x%365-7*(v%52),"d"],[y%24,"h"],[f%60,"m"],[p%60,"s"],[u%1e3,"ms"]].filter(([D])=>D>0).map(([D,C])=>D+C).join("")}const h=u=>{try{return d(u)}catch{return 0}},o=u=>u.includes("0001-01-01T00");function m(u){return u%(1e3*60*60)===0?u/(1e3*60*60)+"h":u%(1e3*60)===0?u/(1e3*60)+"m":u%1e3===0?u/1e3+"s":u.toFixed()+"ms"}},3704:(G,R,e)=>{"use strict";e.d(R,{G:()=>n,z:()=>s});var t=e(32264);function n(a,r){const i=new URLSearchParams(r).toString();return`${t.$.appSubUrl}${a}${i?`?${i}`:""}`}function s(a,r){const i=new URLSearchParams(r).toString();try{return`${new URL(t.$.appSubUrl+a,t.$.appUrl).href}${i?`?${i}`:""}`}catch{return n(a,r)}}},10154:(G,R,e)=>{"use strict";e.d(R,{Xm:()=>a,rJ:()=>s,vJ:()=>n,vy:()=>r});var t=e(17172);function n(g){return(0,t.AI)().post("/api/annotations",g)}function s(g){return(0,t.AI)().put(`/api/annotations/${g.id}`,g)}function a(g){return(0,t.AI)().delete(`/api/annotations/${g.id}`)}async function r(){return(await(0,t.AI)().get("/api/annotations/tags")).result.tags.map(({tag:i,count:l})=>({term:i,count:l}))}},82241:(G,R,e)=>{"use strict";e.d(R,{A:()=>C});var t=e(74848),n=e(96540),s=e(75505),a=e(39070),r=e(76287),g=e(13544),i=e(68402),l=e(62930),d=e(55852),c=e(42418),h=e(14792),o=e(74856),m=e(34214),u=e(27302),p=e(42493),f=e(28240),y=e(8790),x=e(83195),v=e(56034),P=e(14578),E=e(90182);class D extends n.PureComponent{constructor(T){super(T),this.updateFields=()=>{const S=this.props.response?.panelData,O=S?.series?.[0]??S?.annotations?.[0];if(O&&O.fields){const M=O.fields.map(I=>{const L=(0,f.Ct)(I,O);let B="";for(let j=0;j<O.length;j++){if(j>0&&(B+=", "),j>2){B+="...";break}B+=I.values[j]}return B.length>50&&(B=B.substring(0,50)+"..."),{label:`${L} (${I.type})`,value:L,description:B}});this.setState({fieldNames:M})}},this.onFieldSourceChange=(S,O)=>{const M=this.props.mappings||{},I=M[S]||{};this.props.change({...M,[S]:{...I,source:O.value||y.V.Field}})},this.onFieldNameChange=(S,O)=>{const M=this.props.mappings||{};if(!O){const L={...this.props.mappings};delete L[S],this.props.change(L);return}const I=M[S]||{};this.props.change({...M,[S]:{...I,value:O.value,source:y.V.Field}})},this.state={fieldNames:[]}}componentDidMount(){this.updateFields()}componentDidUpdate(T){T.response!==this.props.response&&this.updateFields()}renderRow(T,S,O){const{fieldNames:M}=this.state;let I=[...M];const L=S.value;let B=M.find(A=>L===A.value);L&&!B&&I.push({label:L,value:L});let j=O?O[T.key]:"";if(j&&T.key.startsWith("time")){const A=(0,x.j_)("dateTimeAsIso");j=(0,x.cN)(A(j))}return j==null&&(j=""),(0,t.jsxs)("tr",{children:[(0,t.jsxs)("td",{children:[T.label||T.key," ",T.help&&(0,t.jsx)(v.m,{content:T.help,children:(0,t.jsx)(P.I,{name:"info-circle"})})]}),(0,t.jsx)("td",{children:(0,t.jsx)(E.l6,{value:B,options:I,placeholder:T.placeholder||T.key,onChange:A=>{this.onFieldNameChange(T.key,A)},noOptionsMessage:"Unknown field names",allowCustomValue:!0,isClearable:!0})}),(0,t.jsx)("td",{children:`${j}`})]},T.key)}render(){const T=this.props.response?.events?.[0],S=this.props.mappings||{};return(0,t.jsxs)("table",{className:"filter-table",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Annotation"}),(0,t.jsx)("th",{children:"From"}),(0,t.jsx)("th",{children:"First Value"})]})}),(0,t.jsx)("tbody",{children:p.kj.map(O=>this.renderRow(O,S[O.key]||{},T))})]})}}class C extends n.PureComponent{constructor(){super(...arguments),this.state={},this.onRunQuery=async()=>{const{datasource:T,annotation:S}=this.props;if((0,p.E7)(T))return;const O=(0,h.UA)().getCurrent();if(!O)return;this.setState({running:!0});const M=await(0,s.s)((0,u.b)({range:(0,o.jG)().timeRange(),panel:new m.a({}),dashboard:O},T,S));this.setState({running:!1,response:M})},this.onQueryChange=T=>{this.props.onChange({...this.props.annotation,target:T})},this.onMappingChange=T=>{this.props.onChange({...this.props.annotation,mappings:T})},this.onAnnotationChange=T=>{this.props.onChange(T)}}componentDidMount(){this.verifyDataSource()}componentDidUpdate(T){this.props.annotation!==T.annotation&&!(0,p.E7)(this.props.datasource)&&this.verifyDataSource()}verifyDataSource(){const{datasource:T,annotation:S}=this.props,M={...p.CU,...T.annotations}.prepareAnnotation(S);M!==S?this.props.onChange(M):this.onRunQuery()}getStatusSeverity(T){const{events:S,panelData:O}=T;return O?.errors||O?.error?"error":S?.length?"success":"warning"}renderStatusText(T,S){const{events:O,panelData:M}=T;if(S||T?.panelData?.state===a.Gu.Loading||!T)return(0,t.jsx)("p",{children:"loading..."});if(M?.errors)return(0,t.jsx)(t.Fragment,{children:M.errors.map((L,B)=>(0,t.jsx)("p",{children:L.message},B))});if(M?.error)return(0,t.jsx)("p",{children:M.error.message??"There was an error fetching data"});if(!O?.length)return(0,t.jsx)("p",{children:"No events found"});const I=M?.series?.[0]??M?.annotations?.[0];return(0,t.jsxs)("p",{children:[O.length," events (from ",I?.fields.length," fields)"]})}renderStatus(){const{response:T,running:S}=this.state;return T?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.$,{v:2}),(0,t.jsx)("div",{children:S?(0,t.jsx)(l.y,{}):(0,t.jsx)(d.$n,{"data-testid":g.Tp.components.Annotations.editor.testButton,variant:"secondary",size:"xs",onClick:this.onRunQuery,children:"Test annotation query"})}),(0,t.jsx)(i.$,{v:2,layout:"block"}),(0,t.jsx)(c.F,{"data-testid":g.Tp.components.Annotations.editor.resultContainer,severity:this.getStatusSeverity(T),title:"Query result",children:this.renderStatusText(T,S)})]}):null}render(){const{datasource:T,annotation:S,datasourceInstanceSettings:O}=this.props,{response:M}=this.state;let I=T.annotations?.QueryEditor||T.components?.QueryEditor;if(!I)return(0,t.jsx)("div",{children:"Annotations are not supported. This datasource needs to export a QueryEditor"});const L={...T.annotations?.getDefaultQuery?.(),...S.target??{refId:"Anno"}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.p,{instanceSettings:O,children:(0,t.jsx)(I,{query:L,datasource:T,onChange:this.onQueryChange,onRunQuery:this.onRunQuery,data:M?.panelData,range:(0,o.jG)().timeRange(),annotation:S,onAnnotationChange:this.onAnnotationChange},T?.name)}),(0,p.JX)(T)&&(0,t.jsxs)(t.Fragment,{children:[this.renderStatus(),(0,t.jsx)(D,{response:M,mappings:S.mappings,change:this.onMappingChange})]})]})}}},27302:(G,R,e)=>{"use strict";e.d(R,{b:()=>c});var t=e(62467),n=e(69862),s=e(81160),a=e(65879),r=e(41987),g=e(39374),i=e(42493);let l=100;function d(){return"AQ"+l++}function c(h,o,m){const u={...i.CU,...o.annotations},p={...u.getDefaultQuery?.(),...m},f=u.prepareAnnotation(p);if(!f)return(0,t.of)({});const y=u.prepareQuery(f);if(!y)return(0,t.of)({});const x=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,v=a.calculateInterval(h.range,x,o.interval),P={__interval:{text:v.interval,value:v.interval},__interval_ms:{text:v.intervalMs.toString(),value:v.intervalMs},__annotation:{text:f.name,value:f}},E={startTime:Date.now(),requestId:d(),range:h.range,maxDataPoints:x,scopedVars:P,...v,app:r.Jk.Dashboard,timezone:h.dashboard.timezone,targets:[{...y,refId:"Anno"}]};return(0,g.BN)(o,E).pipe((0,n.Z)(D=>{const C=D?.series.length?D.series:D.annotations;return C?.length?u.processEvents(f,C).pipe((0,s.T)(b=>({panelData:D,events:b}))):(0,t.of)({panelData:D,events:[]})}))}},42493:(G,R,e)=>{"use strict";e.d(R,{CU:()=>h,E7:()=>v,JX:()=>x,kj:()=>m});var t=e(2543),n=e.n(t),s=e(62467),a=e(69862),r=e(81160),g=e(97522),i=e(11261),l=e(28240),d=e(8790),c=e(2913);const h={prepareAnnotation:P=>{if((0,t.isString)(P?.query)){const{query:E,...D}=P;return{...D,target:{refId:"annotation_query",query:E},mappings:{}}}return P},prepareQuery:P=>P.target,processEvents:(P,E)=>f(E,P.mappings)};function o(){return P=>P.pipe((0,a.Z)(E=>{if(!E?.length)return(0,s.of)(void 0);if(E.length===1)return(0,s.of)(E[0]);const D={interpolate:C=>C};return(0,s.of)(E).pipe(g.c.mergeTransformer.operator({},D),(0,r.T)(C=>C[0]))}))}const m=[{key:"time",field:P=>P.fields.find(E=>E.type===i.PU.time),placeholder:"time, or the first time field"},{key:"timeEnd",label:"end time",help:"When this field is defined, the annotation will be treated as a range"},{key:"title"},{key:"text",field:P=>P.fields.find(E=>E.type===i.PU.string),placeholder:"text, or the first text field"},{key:"tags",split:",",help:"The results will be split on comma (,)"},{key:"id"}],u=[{key:"color"},{key:"isRegion"},{key:"source"}],p=[...c.$W.publicDashboardAccessToken?u:[],...m,{key:"userId"},{key:"login"},{key:"email"},{key:"prevState"},{key:"newState"},{key:"data"},{key:"panelId"},{key:"alertId"},{key:"dashboardId"},{key:"dashboardUID"}];function f(P,E){return(0,s.of)(P).pipe(o(),(0,r.T)(D=>{if(!D?.length)return[];let C=!1,b=!1;const T={};for(const M of D.fields){const I=(0,l.Ct)(M,D);T[I.toLowerCase()]=M}E||(E={});const S=[];for(const M of p){const I=E[M.key]||{};if(I.source===d.V.Skip)continue;const L={key:M.key,split:M.split};if(I.source===d.V.Text)L.text=I.value;else{const B=(I.value||M.key).toLowerCase();L.field=T[B],!L.field&&M.field&&(L.field=M.field(D))}(L.field||L.text)&&(S.push(L),L.key==="time"?C=!0:L.key==="text"&&(b=!0))}if(!C||!b)return console.error("Cannot process annotation fields. No time or text present."),[];const O=[];for(let M=0;M<D.length;M++){const I={type:"default",color:"red"};for(const L of S){let B;if(L.text)B=L.text;else if(L.field&&(B=L.field.values[M],B!==void 0&&L.regex)){const j=L.regex.exec(B);j&&(B=j[1]?j[1]:j[0])}B!=null&&(L.split&&typeof B=="string"&&(B=B.split(",")),I[L.key]=B)}O.push(I)}return O}))}const y=["prometheus","loki","elasticsearch","grafana-opensearch-datasource"];function x(P){const{type:E}=P;return!(E==="datasource"||y.includes(E))}function v(P){const{type:E}=P;return y.includes(E)}},93584:(G,R,e)=>{"use strict";e.d(R,{Ay:()=>c,QB:()=>l,Ri:()=>i,Sf:()=>a,cV:()=>r,h8:()=>g});var t=e(65307);const n={hasFetched:!1,includeExpired:!1,keys:[],keysIncludingExpired:[],searchQuery:"",migrationResult:{total:0,migrated:0,failed:0,failedApikeyIDs:[0],failedDetails:[]}},s=(0,t.Z0)({name:"apiKeys",initialState:n,reducers:{apiKeysLoaded:(h,o)=>{const{keys:m,keysIncludingExpired:u}=o.payload,p=o.payload.keys.length===0&&o.payload.keysIncludingExpired.length>0?!0:h.includeExpired;return{...h,hasFetched:!0,keys:m,keysIncludingExpired:u,includeExpired:p}},setSearchQuery:(h,o)=>({...h,searchQuery:o.payload}),includeExpiredToggled:h=>({...h,includeExpired:!h.includeExpired}),isFetching:h=>({...h,hasFetched:!1}),setMigrationResult:(h,o)=>({...h,migrationResult:o.payload})}}),{apiKeysLoaded:a,includeExpiredToggled:r,isFetching:g,setSearchQuery:i,setMigrationResult:l}=s.actions,c={apiKeys:s.reducer}},2468:(G,R,e)=>{"use strict";e.d(R,{H:()=>i,w:()=>r});var t=e(32264),n=e(17172),s=e(10096),a=e(48814);class r{constructor(d,c=!0){const h=c?`namespaces/${t.$.namespace}/`:"";this.url=`/apis/${d.group}/${d.version}/${h}${d.resource}`}async get(d){return(0,n.AI)().get(`${this.url}/${d}`)}async subresource(d,c){return(0,n.AI)().get(`${this.url}/${d}/${c}`)}async list(d){const c=d||{};return c.labelSelector=this.parseListOptionsSelector(c?.labelSelector),c.fieldSelector=this.parseListOptionsSelector(c?.fieldSelector),(0,n.AI)().get(this.url,d)}async create(d){if(!d.metadata.name&&!d.metadata.generateName){const c=s.TP.user.login;d.metadata.generateName=c?c.slice(0,2):"g"}return g(d.metadata),(0,n.AI)().post(this.url,d)}async update(d){return g(d.metadata),(0,n.AI)().put(`${this.url}/${d.metadata.name}`,d)}async delete(d){return(0,n.AI)().delete(`${this.url}/${d}`)}parseListOptionsSelector(d){return Array.isArray(d)?d.map(c=>{const h=String(c.key),o=c.operator;switch(o){case"=":case"!=":return`${h}${o}${c.value}`;case"in":case"notin":return`${h} ${o} (${c.value.join(",")})`;case"":case"!":return`${o}${h}`;default:return null}}).filter(Boolean).join(","):d}}function g(l){l.annotations||(l.annotations={}),l.annotations[a.dc]="UI",l.annotations[a.zv]=window.location.pathname,l.annotations[a.M8]=t.$.buildInfo.versionString}class i{async get(d){if(this.apiVersions)return this.apiVersions[d];const c=await(0,n.AI)().get("/apis"),h={};return c.groups.forEach(o=>{if(o.name.includes("datasource.grafana.app")){const m=o.name.split(".")[0];h[m]=o.preferredVersion.version,m.endsWith("-datasource")||(m.includes("-")?h[`${m}-datasource`]=o.preferredVersion.version:h[`grafana-${m}-datasource`]=o.preferredVersion.version)}}),this.apiVersions=h,h[d]}}},48814:(G,R,e)=>{"use strict";e.d(R,{M8:()=>d,dc:()=>i,ew:()=>a,fY:()=>r,zv:()=>l});const t="grafana.app/createdBy",n="grafana.app/updatedTimestamp",s="grafana.app/updatedBy",a="grafana.app/folder",r="grafana.app/message",g="grafana.app/slug",i="grafana.app/originName",l="grafana.app/originPath",d="grafana.app/originHash",c="grafana.app/originTimestamp"},73399:(G,R,e)=>{"use strict";e.d(R,{getAuthProviderStatus:()=>h,getRegisteredAuthProviders:()=>l,initAuthConfig:()=>o,registerAuthProvider:()=>i});var t=e(2913),n=e(10096),s=e(27677),a=e(31678);const r=[],g={};function i(u,p){r.find(f=>f.id===u.id)||(r.push(u),p&&(g[u.id]=p))}function l(){return r}function d(u){return r.find(p=>p.id===u)}function c(u){const p=[];for(const[f,y]of Object.entries(u)){const x=r.find(v=>`auth.${v.id}`===f);if(x){const v={...y,providerId:x.id,displayName:y.name||x.displayName};p.push(v)}}return p}async function h(u){if(g[u]){const p=g[u];return p()}return{configured:!1,enabled:!1}}function o(){if(t.Ay.featureToggles.ssoSettingsApi&&t.Ay.featureToggles.ssoSettingsLDAP)return;i({id:"ldap",type:"LDAP",protocol:"LDAP",displayName:"LDAP",configPath:"ldap"},m)}async function m(){if(n.TP.hasPermission(a.AccessControlAction.SettingsRead)){const p=(await(0,s.AI)().get("/api/admin/settings"))["auth.ldap"]||{};return{configured:p.enabled==="true",enabled:p.enabled==="true",hide:p.enabled!=="true"}}return{configured:!1,enabled:!1}}},60610:(G,R,e)=>{"use strict";e.d(R,{DZ:()=>h,M5:()=>l,TD:()=>d});var t=e(75505),n=e(17172),s=e(32264),a=e(10096),r=e(31678),g=e(73399),i=e(20604);function l(o=!0){return async m=>{if(a.TP.hasPermission(r.AccessControlAction.SettingsRead)){o&&m((0,i.sr)()),m(d());const u=await(0,n.AI)().get("/api/admin/settings");return m((0,i.jA)(u)),await m(c()),o&&m((0,i.MH)()),u}}}function d(o=""){return async m=>{if(!s.$.featureToggles.ssoSettingsApi)return[];const u=await(0,n.AI)().get(`/api/v1/sso-settings${o?`/${o}`:""}`);return m((0,i.Oy)(o?[u]:u)),u}}function c(){return async o=>{const m=(0,g.getRegisteredAuthProviders)(),u={},p=[];for(const y of m)p.push((0,g.getAuthProviderStatus)(y.id));const f=await Promise.all(p);for(let y=0;y<m.length;y++){const x=m[y];u[x.id]=f[y]}o((0,i.TO)(u))}}function h(o){return async m=>{if(a.TP.hasPermission(r.AccessControlAction.SettingsWrite))try{return await(0,t.s)((0,n.AI)().fetch({url:"/api/admin/settings",method:"PUT",data:o,showSuccessAlert:!1,showErrorAlert:!1})),m((0,i.SH)()),!0}catch(u){if(console.log(u),(0,n.NF)(u)){u.isHandled=!0;const p={message:u.data?.message,errors:u.data?.errors};return m((0,i.Nh)(p)),!1}}return!1}}},20604:(G,R,e)=>{"use strict";e.d(R,{Ay:()=>u,MH:()=>i,Nh:()=>l,Oy:()=>o,SH:()=>d,TO:()=>r,jA:()=>a,sr:()=>g,yk:()=>h});var t=e(65307);const n={settings:{},providerStatuses:{},isLoading:!1,providers:[]},s=(0,t.Z0)({name:"authConfig",initialState:n,reducers:{settingsUpdated:(p,f)=>({...p,settings:f.payload}),providerStatusesLoaded:(p,f)=>({...p,providerStatuses:f.payload}),loadingBegin:p=>({...p,isLoading:!0}),loadingEnd:p=>({...p,isLoading:!1}),setError:(p,f)=>({...p,updateError:f.payload}),resetError:p=>({...p,updateError:void 0}),setWarning:(p,f)=>({...p,warning:f.payload}),resetWarning:p=>({...p,warning:void 0}),providersLoaded:(p,f)=>({...p,providers:f.payload})}}),{settingsUpdated:a,providerStatusesLoaded:r,loadingBegin:g,loadingEnd:i,setError:l,resetError:d,setWarning:c,resetWarning:h,providersLoaded:o}=s.actions,u={authConfig:s.reducer}},55314:(G,R,e)=>{"use strict";e.d(R,{D$:()=>B,G2:()=>C,Ko:()=>E,Vc:()=>O,aF:()=>T,cU:()=>v,e8:()=>M,hT:()=>y.hT,iB:()=>I,kH:()=>b,uz:()=>D,vR:()=>L,vZ:()=>P,wt:()=>S});var t=e(75816),n=e(75505),s=e(71733),a=e(39070),r=e(26272),g=e(17172),i=e(39601),l=e(82467),d=e(28138),c=e(3169),h=e(10096),o=e(28676),m=e(6473),u=e(8484),p=e(37690),f=e(92955),y=e(10378);function x({baseURL:j}){async function A(K){try{const{data:W,...U}=await(0,n.s)((0,g.AI)().fetch({...K,url:j+K.url,showErrorAlert:K.showErrorAlert}));return{data:W,meta:U}}catch(W){return K.manageError?K.manageError(W):{error:W}}}return A}const v=(0,t.xP)({tagTypes:["getFolder"],reducerPath:"browseDashboardsAPI",baseQuery:x({baseURL:"/api"}),endpoints:j=>({listFolders:j.query({providesTags:A=>A?.map(K=>({type:"getFolder",id:K.uid}))??[],query:({parentUid:A,limit:K,page:W,permission:U})=>({url:"/folders",params:{parentUid:A,limit:K,page:W,permission:U}})}),getFolder:j.query({providesTags:(A,K,W)=>[{type:"getFolder",id:W}],query:A=>({url:`/folders/${A}`,params:{accesscontrol:!0}})}),newFolder:j.mutation({query:({title:A,parentUid:K})=>({method:"POST",url:"/folders",data:{title:A,parentUid:K}}),onQueryStarted:({parentUid:A},{queryFulfilled:K,dispatch:W})=>{K.then(async({data:U})=>{await h.TP.fetchUserPermissions(),W((0,l.dx)((0,c.tZ)("Folder created"))),W((0,p.bw)({parentUID:A,pageSize:f.md})),i.Ny.push(s.I.stripBaseFromUrl(U.url))})}}),saveFolder:j.mutation({invalidatesTags:["getFolder"],query:({uid:A,title:K,version:W})=>({method:"PUT",url:`/folders/${A}`,data:{title:K,version:W}}),onQueryStarted:({parentUid:A},{queryFulfilled:K,dispatch:W})=>{K.then(()=>{W((0,p.bw)({parentUID:A,pageSize:f.md}))})}}),moveFolder:j.mutation({invalidatesTags:["getFolder"],query:({folder:A,destinationUID:K})=>({url:`/folders/${A.uid}/move`,method:"POST",data:{parentUID:K}}),onQueryStarted:({folder:A,destinationUID:K},{queryFulfilled:W,dispatch:U})=>{const{parentUid:F}=A;W.then(()=>{U((0,p.bw)({parentUID:F,pageSize:f.md})),U((0,p.bw)({parentUID:K,pageSize:f.md}))})}}),deleteFolder:j.mutation({query:({uid:A})=>({url:`/folders/${A}`,method:"DELETE",params:{forceDeleteRules:!1}}),onQueryStarted:({parentUid:A},{queryFulfilled:K,dispatch:W})=>{K.then(()=>{W((0,p.bw)({parentUID:A,pageSize:f.md}))})}}),getAffectedItems:j.query({keepUnusedDataFor:0,queryFn:async A=>{const W=Object.keys(A.folder).filter(V=>A.folder[V]).map(V=>(0,g.AI)().get(`/api/folders/${V}/counts`)),U=await Promise.all(W),F={folder:Object.values(A.folder).filter(a.zz).length,dashboard:Object.values(A.dashboard).filter(a.zz).length,libraryPanel:0,alertRule:0};for(const V of U)F.folder+=V.folder??0,F.dashboard+=V.dashboard,F.alertRule+=V.alertrule,F.libraryPanel+=V.librarypanel;return{data:F}}}),moveItems:j.mutation({invalidatesTags:["getFolder"],queryFn:async({selectedItems:A,destinationUID:K},W,U,F)=>{const V=Object.keys(A.dashboard).filter(z=>A.dashboard[z]),w=Object.keys(A.folder).filter(z=>A.folder[z]);for(const z of w)await F({url:`/folders/${z}/move`,method:"POST",data:{parentUID:K}});for(const z of V){const H={dashboard:(await(0,o.n)().getDashboardDTO(z)).dashboard,folderUid:K,overwrite:!1,message:""};await F({url:"/dashboards/db",method:"POST",data:H})}return{data:void 0}},onQueryStarted:({destinationUID:A,selectedItems:K},{queryFulfilled:W,dispatch:U})=>{const F=Object.keys(K.dashboard).filter(w=>K.dashboard[w]),V=Object.keys(K.folder).filter(w=>K.folder[w]);W.then(()=>{U((0,p.bw)({parentUID:A,pageSize:f.md})),U((0,p.Zw)([...V,...F]))})}}),deleteItems:j.mutation({queryFn:async({selectedItems:A},K,W,U)=>{const F=Object.keys(A.dashboard).filter(w=>A.dashboard[w]),V=Object.keys(A.folder).filter(w=>A.folder[w]);for(const w of V)await U({url:`/folders/${w}`,method:"DELETE",params:{forceDeleteRules:!1}});for(const w of F){const N=(await U({url:`/dashboards/uid/${w}`,method:"DELETE",showSuccessAlert:!1}))?.data?.title;N&&d.A.publish({type:r.r1.alertSuccess.name,payload:[(0,u.t)("browse-dashboards.soft-delete.success","Dashboard {{name}} moved to Recently deleted",{name:N})]})}return{data:void 0}},onQueryStarted:({selectedItems:A},{queryFulfilled:K,dispatch:W})=>{const U=Object.keys(A.dashboard).filter(V=>A.dashboard[V]),F=Object.keys(A.folder).filter(V=>A.folder[V]);K.then(()=>{W((0,p.Zw)([...F,...U]))})}}),saveDashboard:j.mutation({queryFn:async A=>{try{return{data:await(0,o.n)().saveDashboard(A)}}catch(K){return{error:K}}},onQueryStarted:({folderUid:A},{queryFulfilled:K,dispatch:W})=>{m.t.ignoreNextSave(),K.then(async()=>{await h.TP.fetchUserPermissions(),W((0,p.bw)({parentUID:A,pageSize:f.md}))})}}),importDashboard:j.mutation({query:({dashboard:A,overwrite:K,inputs:W,folderUid:U})=>({method:"POST",url:"/dashboards/import",data:{dashboard:A,overwrite:K,inputs:W,folderUid:U}}),onQueryStarted:({folderUid:A},{queryFulfilled:K,dispatch:W})=>{K.then(async U=>{W((0,p.bw)({parentUID:A,pageSize:f.md}));const F=s.I.stripBaseFromUrl(U.data.importedUrl);i.Ny.push(F)})}}),restoreDashboard:j.mutation({query:({dashboardUID:A,targetFolderUID:K})=>({url:`/dashboards/uid/${A}/trash`,data:{folderUid:K},method:"PATCH"})}),hardDeleteDashboard:j.mutation({queryFn:async({dashboardUID:A},K,W,U)=>{const V=(await U({url:`/dashboards/uid/${A}/trash`,method:"DELETE",showSuccessAlert:!1}))?.data?.title;return V&&d.A.publish({type:r.r1.alertSuccess.name,payload:[(0,u.t)("browse-dashboards.hard-delete.success","Dashboard {{name}} deleted",{name:V})]}),{data:void 0}},onQueryStarted:({dashboardUID:A},{queryFulfilled:K,dispatch:W})=>{K.then(()=>{W((0,p.Zw)([A]))})}})})}),{endpoints:P,useDeleteFolderMutation:E,useDeleteItemsMutation:D,useGetAffectedItemsQuery:C,useGetFolderQuery:b,useMoveFolderMutation:T,useMoveItemsMutation:S,useNewFolderMutation:O,useSaveDashboardMutation:M,useSaveFolderMutation:I,useRestoreDashboardMutation:L,useHardDeleteDashboardMutation:B}=v},92955:(G,R,e)=>{"use strict";e.d(R,{aw:()=>h,md:()=>d,uT:()=>c});var t=e(32264),n=e(17172),s=e(53477),a=e(65812),r=e(40957),g=e(10096),i=e(31678),l=e(49952);const d=50;async function c(o,m,u=1,p=d){if(o&&!t.$.featureToggles.nestedFolders)return[];const f=(0,n.AI)();let y=[];g.TP.hasPermission(i.AccessControlAction.FoldersRead)&&(y=await f.get("/api/folders",{parentUid:o,page:u,limit:p}));const x=t.$.appSubUrl??"";return y.map(v=>({kind:"folder",uid:v.uid,title:v.title,parentTitle:m,parentUID:o,url:(0,l.I)(v.uid)?void 0:`${x}/dashboards/f/${v.uid}/`}))}async function h(o,m=1,u=d){const f=await(0,a.getGrafanaSearcher)().search({kind:["dashboard"],query:"*",location:o||"general",from:(m-1)*u,limit:u});return f.view.map(y=>{const x=(0,r.hI)(y,f.view);return x.parentUID===s.TF&&(x.parentUID=void 0),x})}},43907:(G,R,e)=>{"use strict";e.d(R,{x:()=>l});var t=e(74848),n=e(70255),s=e(94753),a=e(42418),r=e(55314),g=e(8484);function i(d,c,h,o){const m=d+c+h+o,u=[];d&&u.push((0,g.t)("browse-dashboards.counts.folder","{{count}} folder",{count:d})),c&&u.push((0,g.t)("browse-dashboards.counts.dashboard","{{count}} dashboard",{count:c})),h&&u.push((0,g.t)("browse-dashboards.counts.libraryPanel","{{count}} library panel",{count:h})),o&&u.push((0,g.t)("browse-dashboards.counts.alertRule","{{count}} alert rule",{count:o}));let p=(0,g.t)("browse-dashboards.counts.total","{{count}} item",{count:m});return u.length>0&&(p+=`: ${u.join(", ")}`),p}const l=({selectedItems:d})=>{const{data:c,isFetching:h,isLoading:o,error:m}=(0,r.G2)(d);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(s.E,{element:"p",color:"secondary",children:[c&&i(c.folder,c.dashboard,c.libraryPanel,c.alertRule),(h||o)&&(0,t.jsx)(n.A,{width:200})]}),m&&(0,t.jsx)(a.F,{severity:"error",title:"Unable to retrieve descendant information"})]})}},49952:(G,R,e)=>{"use strict";e.d(R,{I:()=>s,e:()=>n});var t=e(32264);function n(a,r){return a+r.uid}function s(a){return a===t.$.sharedWithMeFolderUID}},36141:(G,R,e)=>{"use strict";e.d(R,{Ii:()=>i,Zw:()=>r,bw:()=>g});var t=e(53477),n=e(31678),s=e(92955),a=e(93519);const r=(0,n.createAsyncThunk)("browseDashboards/refreshParents",async(l,{getState:d,dispatch:c})=>{const{browseDashboards:h}=d(),{rootItems:o,childrenByParentUID:m}=h,u=new Set;for(const p of l){const f=(0,a.R)(o?.items??[],m,p);u.add(f?.parentUID)}for(const p of u)c(g({parentUID:p,pageSize:s.md}))}),g=(0,n.createAsyncThunk)("browseDashboards/refetchChildren",async({parentUID:l,pageSize:d})=>{const c=l===t.TF?void 0:l;let h=1,o="folder",m=await(0,s.uT)(c,void 0,h,d),u=m.length<d;if(o==="folder"&&u){o="dashboard",h=1;const p=await(0,s.aw)(c,h,d);u=p.length<d,m=m.concat(p)}return{children:m,lastPageOfKind:u,page:h,kind:o}}),i=(0,n.createAsyncThunk)("browseDashboards/fetchNextChildrenPage",async({parentUID:l,excludeKinds:d=[],pageSize:c},h)=>{const o=!d.includes("dashboard"),m=l===t.TF?void 0:l,u=h.getState().browseDashboards,p=m?u.childrenByParentUID[m]:u.rootItems;let f=1,y;if(p?p.lastFetchedKind==="dashboard"&&!p.lastKindHasMoreItems?console.warn(`fetchNextChildrenPage called for ${m} but that collection is fully loaded`):p.lastFetchedKind==="folder"&&p.lastKindHasMoreItems?(f=p.lastFetchedPage+1,y="folder"):o&&(f=p.lastFetchedKind==="folder"?1:p.lastFetchedPage+1,y="dashboard"):(f=1,y="folder"),!y)return;let x=y==="folder"?await(0,s.uT)(m,void 0,f,c):await(0,s.aw)(m,f,c),v=x.length<c;if(y==="folder"&&v&&o){y="dashboard",f=1;const P=await(0,s.aw)(m,f,c);v=P.length<c,x=x.concat(P)}return{children:x,lastPageOfKind:v,page:f,kind:y}})},37690:(G,R,e)=>{"use strict";e.d(R,{Am:()=>c,xN:()=>t.xN,Ii:()=>n.Ii,bw:()=>n.bw,Zw:()=>n.Zw,ku:()=>d,cT:()=>t.cT,wn:()=>t.wn,t$:()=>t.t$,xK:()=>E,eC:()=>f,Ms:()=>v,V6:()=>P,q0:()=>y,QE:()=>x,Zg:()=>D});var t=e(79763),n=e(36141),s=e(96540),a=e(25508),r=e(31678),g=e(92955),i=e(49952),l=e(93519);const d=b=>b.browseDashboards.rootItems,c=b=>b.browseDashboards.childrenByParentUID,h=b=>b.browseDashboards.openFolders,o=b=>b.browseDashboards.selectedItems,m=(0,a.Mz)(d,c,h,(b,T)=>T,(b,T,S,O)=>C(O,b,T,S)),u=(0,a.Mz)(o,b=>Object.values(b).some(T=>Object.values(T).some(S=>S))),p=(0,a.Mz)(o,c,(b,T)=>{const S={dashboard:{...b.dashboard},folder:{...b.folder}};for(const O of Object.keys(b.folder))if(b.folder[O]){const I=T[O];if(I)for(const L of I.items)L.kind==="dashboard"&&(S.dashboard[L.uid]=!1),L.kind==="folder"&&(S.folder[L.uid]=!1)}return S});function f(b){return(0,r.useSelector)(T=>(b?T.browseDashboards.childrenByParentUID[b]:T.browseDashboards.rootItems)?"fulfilled":"pending")}function y(b){return(0,r.useSelector)(T=>m(T,b))}function x(){return(0,r.useSelector)(b=>u(b))}function v(){return(0,r.useSelector)(o)}function P(){return(0,r.useSelector)(b=>b.browseDashboards.childrenByParentUID)}function E(){return(0,r.useSelector)(b=>p(b))}function D(b=[]){const T=(0,r.useDispatch)(),S=(0,s.useRef)(!1);return(0,s.useCallback)(M=>{if(S.current)return Promise.resolve();S.current=!0;const I=T((0,n.Ii)({parentUID:M,excludeKinds:b,pageSize:g.md}));return I.finally(()=>S.current=!1),I},[T,b])}function C(b,T,S,O,M=0,I=[],L=[]){function B(V,w,z){if(I.includes(V.kind)||L.includes(V.uid))return[];const N=C(V.uid,T,S,O,z+1,I,L),H=!!O[V.uid],Q=S[V.uid]?.items.length===0;H&&Q&&!I.includes("empty-folder")&&N.push({isOpen:!1,level:z+1,item:{kind:"ui",uiKind:"empty-folder",uid:V.uid+"empty-folder"},parentUID:w});const X={item:V,parentUID:w,level:z,isOpen:H},ee=[X,...N];return(0,i.I)(X.item.uid)&&ee.push({item:{kind:"ui",uiKind:"divider",uid:"shared-with-me-divider"},parentUID:w,level:z+1,isOpen:!1}),ee}const j=b&&O[b]||M===0,A=b?S[b]:T;let W=((b?j&&A?.items:A?.items)||[]).flatMap(V=>B(V,b,M));const U=I.includes("dashboard")&&A?.lastFetchedKind==="dashboard";return(M===0&&!A||j&&A&&!(A.isFullyLoaded||U))&&(W=W.concat((0,l.T)(g.md,b,M))),W}},79763:(G,R,e)=>{"use strict";e.d(R,{xN:()=>E,Ay:()=>D,cT:()=>P,wn:()=>x,t$:()=>v});var t={};e.r(t),e.d(t,{clearFolders:()=>h,fetchNextChildrenPageFulfilled:()=>i,refetchChildrenFulfilled:()=>g,setAllSelection:()=>c,setFolderOpenState:()=>l,setItemSelectionState:()=>d});var n=e(65307),s=e(36141),a=e(49952),r=e(93519);function g(C,b){const{children:T,page:S,kind:O,lastPageOfKind:M}=b.payload,{parentUID:I}=b.meta.arg,L={items:T,lastFetchedKind:O,lastFetchedPage:S,lastKindHasMoreItems:!M,isFullyLoaded:O==="dashboard"&&M};I?C.childrenByParentUID[I]=L:C.rootItems=L}function i(C,b){const T=b.payload;if(!T)return;const{children:S,page:O,kind:M,lastPageOfKind:I}=T,{parentUID:L,excludeKinds:B=[]}=b.meta.arg,K={items:((L?C.childrenByParentUID[L]:C.rootItems)?.items??[]).concat(S),lastFetchedKind:M,lastFetchedPage:O,lastKindHasMoreItems:!I,isFullyLoaded:(B.includes("dashboard")||M==="dashboard")&&I};if(!L){C.rootItems=K;return}if(C.childrenByParentUID[L]=K,C.selectedItems.folder[L])for(const U of S)C.selectedItems[U.kind][U.uid]=!0}function l(C,b){const{folderUID:T,isOpen:S}=b.payload;C.openFolders[T]=S}function d(C,b){const{item:T,isSelected:S}=b.payload;if((0,a.I)(T.uid))return;function O(M,I){if(C.selectedItems[M][I]=S,M!=="folder")return;let L=C.childrenByParentUID[I];for(const B of L?.items??[])O(B.kind,B.uid)}if(O(T.kind,T.uid),!S){let M=T.parentUID;for(;M;){const I=(0,r.R)(C.rootItems?.items??[],C.childrenByParentUID,M);if(!I)break;C.selectedItems[I.kind][I.uid]=!1,M=I.parentUID}}C.selectedItems.$all=C.rootItems?.items?.every(M=>C.selectedItems[M.kind][M.uid])??!1}function c(C,b){const{isSelected:T,folderUID:S}=b.payload;if(!(S&&(0,a.I)(S)))if(C.selectedItems.$all=T,T){let M=function(I){if(I&&(0,a.I)(I))return;const L=I?C.childrenByParentUID[I]:C.rootItems;if(L)for(const B of L.items)(0,a.I)(B.uid)||(C.selectedItems[B.kind][B.uid]=T,B.kind==="folder"&&M(B.uid))};var O=M;M(S)}else for(const M in C.selectedItems){if(!(M==="dashboard"||M==="panel"||M==="folder"))continue;const I=C.selectedItems[M];for(const L in I)I[L]=T}}function h(C,b){const T=Array.isArray(b.payload)?b.payload:[b.payload];for(const S of T)S?(C.childrenByParentUID[S]=void 0,C.openFolders[S]=!1):C.rootItems=void 0}const{fetchNextChildrenPageFulfilled:o,refetchChildrenFulfilled:m,...u}=t,p={rootItems:void 0,childrenByParentUID:{},openFolders:{},selectedItems:{dashboard:{},folder:{},panel:{},$all:!1}},f=(0,n.Z0)({name:"browseDashboards",initialState:p,reducers:u,extraReducers:C=>{C.addCase(s.Ii.fulfilled,o),C.addCase(s.bw.fulfilled,m)}}),y=f.reducer,{setFolderOpenState:x,setItemSelectionState:v,setAllSelection:P,clearFolders:E}=f.actions,D={browseDashboards:y}},93519:(G,R,e)=>{"use strict";e.d(R,{R:()=>t,T:()=>n});function t(s,a,r){for(const g of s)if(g.uid===r)return g;for(const g in a){const i=a[g];if(i){for(const l of i.items)if(l.uid===r)return l}}}function n(s,a,r){return new Array(s).fill(null).map((g,i)=>({parentUID:a,level:r,isOpen:!1,item:{kind:"ui",uiKind:"pagination-placeholder",uid:`${a}-pagination-${i}`}}))}},6320:(G,R,e)=>{"use strict";e.d(R,{b:()=>n,q:()=>t});const t="connections",n={Base:`/${t}`,DataSources:`/${t}/datasources`,DataSourcesNew:`/${t}/datasources/new`,DataSourcesEdit:`/${t}/datasources/edit/:uid`,DataSourcesDashboards:`/${t}/datasources/edit/:uid/dashboards`,AddNewConnection:`/${t}/add-new-connection`,DataSourcesDetails:`/${t}/datasources/:id`,ConnectDataOutdated:`/${t}/connect-data`,YourConnectionsOutdated:`/${t}/your-connections`}},67023:(G,R,e)=>{"use strict";e.d(R,{k:()=>r});var t=e(60455),n=e.n(t),s=e(91890),a=e(87490);const r=(g,i,l)=>{let d={},c={};if(g.type===s.CC.Regex&&g.expression){const h=new RegExp(g.expression,"gi"),m=(typeof i=="string"?i:(0,a.MA)(i)).matchAll(h);for(const u of m)u.groups?c=u.groups:c[g.mapValue||l]=u[1]||u[0]}else g.type===s.CC.Logfmt&&(c=n().parse(i));return Object.keys(c).forEach(h=>{const o=typeof c[h]=="string"?c[h]:(0,a.MA)(c[h]);d[h]={value:o}}),d}},40511:(G,R,e)=>{"use strict";e.d(R,{F0:()=>l,bQ:()=>d,lW:()=>c});var t=e(41053),n=e(75505),s=e(19347),a=e(76888),r=e(18380);const g=({sourceUID:h,...o})=>{const m=(0,s.l)().getInstanceSettings(h),u=o.type==="query"?(0,s.l)().getInstanceSettings(o.targetUID):void 0;if((o?.orgId===void 0||o?.orgId===null||o?.orgId===0)&&r.kb.logWarning("Invalid correlation config: Missing org id."),m&&m?.uid!==void 0&&u?.uid!==void 0&&o.type==="query")return{...o,source:m,target:u};if(m&&m?.uid!==void 0&&u?.uid===void 0&&o.type==="external")return{...o,source:m};r.kb.logWarning("Invalid correlation config: Missing source or target.",{source:JSON.stringify(m),target:JSON.stringify(u)})},i=h=>!!h,l=h=>({...h,correlations:h.correlations.map(g).filter(i)});function d(h){return h.data}const c=()=>{const{backend:h}=(0,a.Il)(),[o,m]=(0,t.A)(P=>(0,n.s)(h.fetch({url:"/api/datasources/correlations",params:{page:P.page},method:"GET",showErrorAlert:!1})).then(d).then(l),[h]),[u,p]=(0,t.A)(({sourceUID:P,...E})=>h.post(`/api/datasources/uid/${P}/correlations`,E).then(D=>{const C=g(D.result);if(C!==void 0)return C;throw new Error("invalid sourceUID")}),[h]),[f,y]=(0,t.A)(({sourceUID:P,uid:E})=>h.delete(`/api/datasources/uid/${P}/correlations/${E}`),[h]),[x,v]=(0,t.A)(({sourceUID:P,uid:E,...D})=>h.patch(`/api/datasources/uid/${P}/correlations/${E}`,D).then(C=>{const b=g(C.result);if(b!==void 0)return b;throw new Error("invalid sourceUID")}),[h]);return{create:{execute:p,...u},update:{execute:v,...x},get:{execute:m,...o},remove:{execute:y,...f}}}},18380:(G,R,e)=>{"use strict";e.d(R,{$q:()=>h,J6:()=>c,cA:()=>l,kb:()=>u,tZ:()=>m});var t=e(75505),n=e(91890),s=e(17172),a=e(19347),r=e(34867),g=e(9651),i=e(40511);const l=(p,f,y)=>(p.forEach(x=>{const v=x.refId;if(!v)return;let P=y[v];if(P===void 0&&x.meta?.preferredVisualisationType==="rawPrometheus"){const D=(0,g.a)(v);P=y[D]}const E=f.filter(D=>D.source.uid===P);d(x,E)}),p),d=(p,f)=>{p.fields.forEach(y=>{y.config.links=y.config.links?.filter(x=>x.origin!==n.x0.Correlations)||[],f.map(x=>{if(x.config.field===y.name){if(x.type==="query"){const v=x.config.target||{};y.config.links.push({internal:{query:{...v,datasource:{uid:x.target.uid}},datasourceUid:x.target.uid,datasourceName:x.target.name},url:"",title:x.label||x.target.name,origin:n.x0.Correlations,meta:{transformations:x.config.transformations}})}else if(x.type==="external"){const v=x.config.target;y.config.links.push({url:v.url,title:x.label||"External URL",origin:n.x0.Correlations,meta:{transformations:x.config?.transformations}})}}})})},c=async p=>(0,t.s)((0,s.AI)().fetch({url:"/api/datasources/correlations",method:"GET",showErrorAlert:!1,params:{sourceUID:p}})).then(i.bQ).then(i.F0),h=async(p,f)=>(0,s.AI)().post(`/api/datasources/uid/${p}/correlations`,f),o=async p=>p.datasourceInstance?.meta.mixed?await(0,a.l)().get(p.queries[0].datasource):p.datasourceInstance,m=async(p,f)=>Promise.all([o(p),o(f)]).then(y=>y[0]?.name!==void 0&&y[1]?.name!==void 0?`${y[0]?.name} to ${y[1]?.name}`:""),u=(0,r.DW)("features.correlations")},41524:(G,R,e)=>{"use strict";e.d(R,{W:()=>s});var t=e(11261);function n(){const a="ABCDEFGHIJKLMNOPQRSTUVWXYZ",r="abcdefghijklmnopqrstuvwxyz",g=a.length,i=new Map;return l=>{const d=i.get(l);if(d!=null)return d;const c=[...l].map(h=>h.toLowerCase()&&h!==h.toUpperCase()?r.charAt(Math.floor(Math.random()*g)):h.toUpperCase()&&h!==h.toUpperCase()?a.charAt(Math.floor(Math.random()*g)):h).join("");return i.set(l,c),c}}function s(a,r){if(!(r.labels||r.names||r.values))return a;const g=new Set(["time","value","exemplar","traceid","id","uid","uuid","__name__","le","name"]),i=n();return a.map(l=>{let{schema:d,data:c}=l;if(d&&c){if(r.labels){for(const h of d.fields)if(h.labels){const o={};for(const[m,u]of Object.entries(h.labels))o[m]=i(u);h.labels=o}}if(r.names)for(const h of d.fields)h.name?.length&&!g.has(h.name.toLowerCase())&&(h.name=i(h.name));r.values&&d.fields.forEach((h,o)=>{if(h.type===t.PU.string&&c){const m=c.values[o].map(u=>i(String(u)));c.values[o]=m}})}return{schema:d,data:c}})}},72255:(G,R,e)=>{"use strict";e.d(R,{m6:()=>D,sP:()=>T});var t=e(71733),n=e(17172),s=e(39601),a=e(32264),r=e(2619),g=e(33390),i=e(94954),l=e(78160),d=e(17493),c=e(14792),h=e(41176),o=e(20470),m=e(16833),u=e(53001),p=e(31678),f=e(71176),y=e(19997),x=e(27734),v=e(77431);const P=500,E="loadDashboardScene",D="__grafana_home_uid__";class C extends r.Q{constructor(){super(...arguments),this.cache={}}async fetchDashboard({uid:O,route:M,urlFolderUid:I,keepDashboardFromExploreInLocalStorage:L}){const B=g.A.getObject(o.us);if(B)return L||(0,o.yZ)(),B;const j=M===p.DashboardRoutes.Home?D:O,A=this.getDashboardFromCache(j);if(A)return A;let K;try{switch(M){case p.DashboardRoutes.New:K=await(0,f.X)(I);break;case p.DashboardRoutes.Home:if(K=await(0,n.AI)().get("/api/dashboards/home"),K.redirectUri)return K;K?.meta&&(K.meta.canSave=!1,K.meta.canShare=!1,K.meta.canStar=!1);break;case p.DashboardRoutes.Public:return await d.np.loadDashboard("public","",O);default:K=await d.np.loadDashboard("db","",O),M===p.DashboardRoutes.Embedded&&(K.meta.isEmbedded=!0)}if(K.meta.url&&M===p.DashboardRoutes.Normal){const W=t.I.stripBaseFromUrl(K.meta.url),U=s.Ny.getLocation().pathname;W!==U&&(s.Ny.replace({...s.Ny.getLocation(),pathname:W}),console.log("not correct url correcting",W,U))}K.meta.folderUid&&await(0,v.Q)(K.meta.folderUid),this.setDashboardCache(j,K)}catch(W){if((0,n.NF)(W)&&W.cancelled)return null;throw W}return K}async loadSnapshot(O){try{const M=await this.loadSnapshotScene(O);this.setState({dashboard:M,isLoading:!1})}catch(M){this.setState({isLoading:!1,loadError:String(M)})}}async loadSnapshotScene(O){const M=await d.np.loadDashboard("snapshot",O,"");if(M?.dashboard)return(0,y.wM)(M);throw new Error("Snapshot not found")}async loadDashboard(O){try{(0,l.j)(E);const M=await this.loadScene(O);if(!M)return;a.$.featureToggles.preserveDashboardStateWhenNavigating&&O.uid&&(0,x.Gq)(M),this.setState({dashboard:M,isLoading:!1});const I=(0,l.z)(E);(0,m.D)(M,I?.duration),O.route!==p.DashboardRoutes.New&&(0,h.B)({meta:M.state.meta,uid:M.state.uid,title:M.state.title,id:M.state.id})}catch(M){const I=(0,i.q)(M);this.setState({isLoading:!1,loadError:I})}}async loadScene(O){const M=!!(g.A.getObject(o.us)&&O.keepDashboardFromExploreInLocalStorage===!1);this.setState({dashboard:void 0,isLoading:!0});const I=await this.fetchDashboard(O),L=this.getSceneFromCache(O.uid);if(!M&&L&&L.state.version===I?.dashboard.version)return L;if(I?.dashboard){const B=(0,y.wM)(I);return O.uid&&!M&&this.setSceneCache(O.uid,B),B}if(I?.redirectUri){const B=t.I.stripBaseFromUrl(I.redirectUri);return s.Ny.replace(B),null}throw new Error("Dashboard not found")}getDashboardFromCache(O){const M=this.dashboardCache;return O=this.getCacheKey(O),M&&M.cacheKey===O&&Date.now()-M?.ts<P?M.dashboard:null}clearState(){(0,c.UA)().setCurrent(void 0),this.setState({dashboard:void 0,loadError:void 0,isLoading:!1,panelEditor:void 0})}setDashboardCache(O,M){O=this.getCacheKey(O),this.dashboardCache={dashboard:M,ts:Date.now(),cacheKey:O}}clearDashboardCache(){this.dashboardCache=void 0}getSceneFromCache(O){return O=this.getCacheKey(O),this.cache[O]}setSceneCache(O,M){O=this.getCacheKey(O),this.cache[O]=M}getCacheKey(O){const M=(0,u.F_)().sort().join("__scp__");return M?`${O}__scp__${M}`:O}}let b=null;function T(){return b||(b=new C({})),b}},77431:(G,R,e)=>{"use strict";e.d(R,{Q:()=>r});var t=e(82467),n=e(27677),s=e(71101),a=e(99140);async function r(g){try{const i=await n.IB.getFolderByUid(g);a.M_.dispatch((0,t.Vz)((0,s.R4)(i)))}catch(i){console.warn("Error fetching parent folder",g,"for dashboard",i)}}},79280:(G,R,e)=>{"use strict";e.d(R,{p:()=>l});var t=e(74848),n=e(13544),s=e(90613),a=e(67061),r=e(94753),g=e(55852),i=e(8484);function l(d){return(0,t.jsx)(s.a,{alignItems:"center",padding:4,children:(0,t.jsxs)(a.B,{direction:"column",alignItems:"center",gap:2,children:[(0,t.jsx)(r.E,{element:"h3",textAlignment:"center",children:(0,t.jsx)(i.x6,{i18nKey:"transformations.empty.add-transformation-header",children:"Start transforming data"})}),(0,t.jsx)(r.E,{element:"p",textAlignment:"center","data-testid":n.Tp.components.Transforms.noTransformationsMessage,children:(0,t.jsxs)(i.x6,{i18nKey:"transformations.empty.add-transformation-body",children:["Transformations allow data to be changed in various ways before your visualization is shown.",(0,t.jsx)("br",{}),"This includes joining data together, renaming fields, making calculations, formatting data for display, and more."]})}),(0,t.jsx)(g.$n,{icon:"plus",variant:"primary",size:"md",onClick:d.onShowPicker,"data-testid":n.Tp.components.Transforms.addTransformationButton,children:"Add transformation"})]})})}},34865:(G,R,e)=>{"use strict";e.d(R,{L:()=>es});var t=e(2543),n=e(39601),s=e(32264),a=e(84537),r=e(26443),g=e(36974),i=e(57767),l=e(13530),d=e(45429),c=e(41507),h=e(20455),o=e(74730);class m extends a.Bs{constructor(Ze){super({source:Ze.source,data:Ze.source.resolve().state.data}),this.addActivationHandler(()=>{this._subs.add(this.state.source.resolve().subscribeToState((lt,yt)=>{lt.data!==yt.data&&this.setState({data:lt.data})}))})}setContainerWidth(Ze){this.state.source.resolve().setContainerWidth?.(Ze)}isDataReadyToDisplay(){return this.state.source.resolve().isDataReadyToDisplay?.()??!0}cancelQuery(){this.state.source.resolve().cancelQuery?.()}getResultsStream(){return this.state.source.resolve().getResultsStream()}}var u=e(74848),p=e(32196),f=e(13544),y=e(40845),x=e(63021),v=e(40276),P=e(40980),E=e(66864),D=e(2913),C=e(10096),b=e(75471),T=e(57220),S=e(42418),O=e(39558),M=e(40675),I=e(80215),L=e(27747),B=e(78742),j=e(54148),A=e(16817),K=e(76885),W=e(34867),U=e(55852),F=e(25027),V=e(63066);const w=({panel:Pt,className:Ze})=>{const lt=(0,j.zy)(),{loading:yt,value:Nt}=(0,A.A)(()=>(0,V.J6)(Pt),[Pt]);if(yt)return(0,u.jsx)(U.$n,{disabled:!0,children:"New alert rule"});if(!Nt)return(0,u.jsx)(S.F,{severity:"info",title:"No alerting capable query found",children:"Cannot create alerts from this panel because no query to an alerting capable datasource is found."});const wt=async()=>{(0,W.fH)(F.le.alertRuleFromPanel);const Zt=await(0,V.J6)(Pt),pn=K.kM.renderUrl("/alerting/new",{defaults:JSON.stringify(Zt),returnTo:lt.pathname+lt.search});n.Ny.push(pn)};return(0,u.jsx)(U.$n,{icon:"bell",onClick:wt,className:Ze,"data-testid":"create-alert-rule-button",children:"New alert rule"})};var z=(Pt=>(Pt.Queries="queries",Pt.Transformations="transformations",Pt.Alert="alert",Pt))(z||{});class N extends a.Bs{constructor(){super(...arguments),this.tabId=z.Alert}static{this.Component=H}renderTab(Ze){return(0,u.jsx)(X,{model:this,...Ze},this.getTabLabel())}getTabLabel(){return"Alert"}getDashboardUID(){return this.getDashboard().state.uid}getDashboard(){return(0,o.YQ)(this)}getLegacyPanelId(){return(0,o.Cs)(this.state.panelRef.resolve())}getCanCreateRules(){const Ze=(0,b.Wd)("grafana");return this.getDashboard().state.meta.canSave&&C.TP.hasPermission(Ze.create)}}function H({model:Pt}){const Ze=(0,y.of)(Q),{errors:lt,loading:yt,rules:Nt}=(0,L.S)({dashboardUID:Pt.getDashboardUID(),panelId:Pt.getLegacyPanelId()}),wt=lt.length?(0,u.jsx)(S.F,{title:"Errors loading rules",severity:"error",children:lt.map((On,An)=>(0,u.jsxs)("div",{children:["Failed to load Grafana rules state: ",(0,B.JZ)(On)]},An))}):null;if(yt&&!Nt.length)return(0,u.jsxs)(u.Fragment,{children:[wt,(0,u.jsx)(O._,{text:"Loading rules..."})]});const Zt=Pt.state.panelRef.resolve(),pn=Pt.getCanCreateRules();return Nt.length?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(I.s,{rules:Nt}),pn&&(0,u.jsx)(w,{className:Ze.newButton,panel:Zt})]}):(0,u.jsxs)("div",{className:Ze.noRulesWrapper,children:[(0,u.jsx)("p",{children:"There are no alert rules linked to this panel."}),pn&&(0,u.jsx)(w,{panel:Zt})]})}const Q=Pt=>({newButton:(0,p.css)({marginTop:Pt.spacing(3)}),noRulesWrapper:(0,p.css)({margin:Pt.spacing(2),backgroundColor:Pt.colors.background.secondary,padding:Pt.spacing(3)})});function X(Pt){const{model:Ze}=Pt,{rules:lt}=(0,L.S)({dashboardUID:Ze.getDashboardUID(),panelId:Ze.getLegacyPanelId(),poll:!1});return(0,u.jsx)(M.o,{label:Ze.getTabLabel(),icon:"bell",counter:lt.length,active:Pt.active,onChangeTab:Pt.onChangeTab})}var ee=e(22391),Z=e(41987),q=e(19347),ae=e(67061),k=e(21969),se=e(47311),te=e(53478),ne=e(64152),le=e(44932),re=e(37464),de=e(93117),oe=e(14348),J=e(7928);class ce extends a.Bs{constructor(Ze){super(Ze),this.tabId=z.Queries,this.onOpenInspector=()=>{const lt=this.state.panelRef.resolve(),yt=(0,o.Cs)(lt);n.Ny.partial({inspect:yt,inspectTab:"query"})},this.onChangeDataSource=async(lt,yt)=>{const{dsSettings:Nt}=this.state,wt=this.queryRunner,Zt=Nt?await(0,q.l)().get({uid:Nt.uid}):void 0,pn=await(0,q.l)().get({uid:lt.uid}),On=wt.state.queries,An=yt||await(0,de.y)(pn,lt.uid,On,Zt);wt.setState({datasource:(0,ee.p$)(lt),queries:An}),yt&&wt.runQueries(),this.loadDataSource()},this.onQueryOptionsChange=lt=>{const yt=this.state.panelRef.resolve(),Nt=this.queryRunner,wt=yt.state.$timeRange,Zt={},pn={};lt.maxDataPoints!==Nt.state.maxDataPoints&&(Zt.maxDataPoints=lt.maxDataPoints??void 0),lt.minInterval!==Nt.state.minInterval&&lt.minInterval!==null&&(Zt.minInterval=lt.minInterval),lt.timeRange&&(pn.timeFrom=lt.timeRange.from??void 0,pn.timeShift=lt.timeRange.shift??void 0,pn.hideTimeOverride=lt.timeRange.hide),wt instanceof J.v?pn.timeFrom!==void 0||pn.timeShift!==void 0?wt.setState(pn):yt.setState({$timeRange:void 0}):yt.setState({$timeRange:new J.v(pn)}),lt.cacheTimeout!==Nt?.state.cacheTimeout&&(Zt.cacheTimeout=lt.cacheTimeout),lt.queryCachingTTL!==Nt?.state.queryCachingTTL&&(Zt.queryCachingTTL=lt.queryCachingTTL),Nt.setState(Zt),Nt.runQueries()},this.onQueriesChange=lt=>{this.queryRunner.setState({queries:lt})},this.onRunQueries=()=>{this.queryRunner.runQueries()},this.addQueryClick=()=>{const lt=this.getQueries();this.onQueriesChange((0,k.U7)(lt,this.newQuery()))},this.onAddQuery=lt=>{const yt=this.getQueries(),Nt=this.state.dsSettings;this.onQueriesChange((0,k.U7)(yt,lt,Nt?(0,ee.p$)(Nt):{type:void 0,uid:void 0}))},this.onAddExpressionClick=()=>{const lt=this.getQueries();this.onQueriesChange((0,k.U7)(lt,te.Ex.newQuery()))},this.addActivationHandler(()=>this.onActivate())}static{this.Component=pe}getTabLabel(){return"Queries"}getItemsCount(){return this.getQueries().length}renderTab(Ze){return(0,u.jsx)(xe,{model:this,...Ze},this.getTabLabel())}onActivate(){this.loadDataSource()}async loadDataSource(){if(!this.state.panelRef.resolve().state.$data)return;let yt=this.queryRunner.state.datasource;try{let Nt,wt;if(yt)Nt=await(0,q.l)().get(yt),wt=(0,q.l)().getInstanceSettings(yt);else{const pn=(0,o.YQ)(this).state.uid??"",On=(0,g.CW)(pn);On?.datasourceUid!==null&&(wt=(0,q.l)().getInstanceSettings({uid:On?.datasourceUid}),wt&&(Nt=await(0,q.l)().get({uid:On?.datasourceUid,type:wt.type}),this.queryRunner.setState({datasource:{...(0,ee.p$)(wt),uid:On?.datasourceUid}})))}Nt&&wt&&(this.setState({datasource:Nt,dsSettings:wt}),(0,se.tw)((0,ee.p$)(wt)||{default:!0}))}catch(Nt){const wt=await(0,q.l)().get(s.$.defaultDatasource),Zt=(0,q.l)().getInstanceSettings(s.$.defaultDatasource);wt&&Zt&&(this.setState({datasource:wt,dsSettings:Zt}),this.queryRunner.setState({datasource:(0,ee.p$)(Zt)})),console.error(Nt)}}buildQueryOptions(){const Ze=this.state.panelRef.resolve(),lt=(0,o.un)(Ze),yt=a.jh.getTimeRange(Ze);let Nt={from:void 0,shift:void 0,hide:void 0};yt instanceof J.v&&(Nt={from:yt.state.timeFrom,shift:yt.state.timeShift,hide:yt.state.hideTimeOverride});let wt=lt.state.queries;const Zt=this.state.dsSettings;return{cacheTimeout:Zt?.meta.queryOptions?.cacheTimeout?lt.state.cacheTimeout:void 0,queryCachingTTL:Zt?.cachingConfig?.enabled?lt.state.queryCachingTTL:void 0,dataSource:{default:Zt?.isDefault,...Zt?(0,ee.p$)(Zt):{type:void 0,uid:void 0}},queries:wt,maxDataPoints:lt.state.maxDataPoints,minInterval:lt.state.minInterval,timeRange:Nt}}getQueries(){return this.queryRunner.state.queries}newQuery(){const{dsSettings:Ze,datasource:lt}=this.state;let yt;return Ze?.meta.mixed?lt?.meta.mixed?yt=(0,q.l)().getInstanceSettings(s.$.defaultDatasource):yt=lt:yt=Ze,{...lt?.getDefaultQuery?.(Z.Jk.PanelEditor),datasource:{uid:yt?.uid,type:yt?.type}}}isExpressionsSupported(Ze){return(Ze.meta.alerting||Ze.meta.mixed)===!0}renderExtraActions(){return ne.m.getAllExtraRenderAction().map((Ze,lt)=>Ze({onAddQuery:this.onAddQuery,onChangeDataSource:this.onChangeDataSource,key:lt})).filter(Boolean)}get queryRunner(){return(0,o.un)(this.state.panelRef.resolve())}}function pe({model:Pt}){const{datasource:Ze,dsSettings:lt}=Pt.useState(),{data:yt,queries:Nt}=Pt.queryRunner.useState();if(!Ze||!lt||!yt)return null;const wt=!(0,oe.kN)(lt.name);return(0,u.jsxs)("div",{"data-testid":f.Tp.components.QueryTab.content,children:[(0,u.jsx)(re.K,{data:yt,dsSettings:lt,dataSource:Ze,options:Pt.buildQueryOptions(),onDataSourceChange:Pt.onChangeDataSource,onOptionsChange:Pt.onQueryOptionsChange,onOpenQueryInspector:Pt.onOpenInspector}),(0,u.jsx)(le.L,{data:yt,queries:Nt,dsSettings:lt,onAddQuery:Pt.onAddQuery,onQueriesChange:Pt.onQueriesChange,onRunQueries:Pt.onRunQueries}),(0,u.jsxs)(ae.B,{gap:2,children:[wt&&(0,u.jsx)(U.$n,{icon:"plus",onClick:Pt.addQueryClick,variant:"secondary","data-testid":f.Tp.components.QueryTab.addQuery,children:"Add query"}),s.$.expressionsEnabled&&Pt.isExpressionsSupported(lt)&&(0,u.jsx)(U.$n,{icon:"plus",onClick:Pt.onAddExpressionClick,variant:"secondary","data-testid":f.Tp.components.QueryTab.addExpression,children:(0,u.jsx)("span",{children:"Expression\xA0"})}),Pt.renderExtraActions()]})]})}function xe(Pt){const{model:Ze}=Pt,lt=Ze.queryRunner.useState();return(0,u.jsx)(M.o,{label:Ze.getTabLabel(),icon:"database",counter:lt.queries.length,active:Pt.active,onChangeTab:Pt.onChangeTab})}var fe=e(91076),Ee=e(96540),Se=e(19727),ye=e(96374),Ve=e(57650),Me=e(79280),Ce=e(97497),Ue=e(29158),Ae=e(21427),we=e(66879);function We(Pt){const{isOpen:Ze,series:lt,onClose:yt,onTransformationAdd:Nt}=Pt,[wt,Zt]=(0,Ee.useState)({search:"",showIllustrations:!0}),pn=xs=>Zt({...wt,search:xs.currentTarget.value}),On=xs=>Zt({...wt,showIllustrations:xs}),An=xs=>Zt({...wt,selectedFilter:xs}),qn=(0,Ee.useMemo)(()=>Ce.h.list().sort((xs,zs)=>xs.name>zs.name?1:zs.name>xs.name?-1:0),[]),cs=qn.filter(xs=>wt.selectedFilter&&wt.selectedFilter!==we.e&&!xs.categories?.has(wt.selectedFilter)?!1:xs.name.toLocaleLowerCase().includes(wt.search.toLocaleLowerCase())),Os=(0,u.jsxs)(u.Fragment,{children:[cs.length," / ",qn.length," \xA0\xA0",(0,u.jsx)(Ue.K,{name:"times",onClick:()=>{Zt({...wt,search:""})},tooltip:"Clear search"})]});if(Ze)return(0,u.jsx)(Ae.R,{data:lt,onTransformationAdd:Nt,xforms:cs,search:wt.search,noTransforms:!1,suffix:wt.search!==""?Os:(0,u.jsx)(u.Fragment,{}),selectedFilter:wt.selectedFilter,onSearchChange:pn,onSearchKeyDown:()=>{},showIllustrations:wt.showIllustrations,onShowIllustrationsChange:On,onSelectedFilterChange:An,onClose:yt})}class _e extends a.Bs{constructor(){super(...arguments),this.tabId=z.Transformations}static{this.Component=at}getTabLabel(){return"Transformations"}renderTab(Ze){return(0,u.jsx)(It,{model:this,...Ze},this.getTabLabel())}getQueryRunner(){return(0,o.un)(this.state.panelRef.resolve())}getDataTransformer(){const Ze=this.state.panelRef.resolve().state.$data;if(!Ze||!(Ze instanceof a.Es))throw new Error("Could not find SceneDataTransformer for panel");return Ze}onChangeTransformations(Ze){const lt=this.getDataTransformer();lt.setState({transformations:Ze}),lt.reprocessTransformations()}}function at({model:Pt}){const Ze=(0,y.of)(Tt),lt=Pt.getQueryRunner().useState(),{data:yt,transformations:Nt}=Pt.getDataTransformer().useState(),wt=Nt,[Zt,pn]=(0,Ee.useState)(!1),[On,An]=(0,Ee.useState)(!1),qn=()=>pn(!0),cs=()=>pn(!1);if(!yt||!lt.data)return;const Os=(0,u.jsx)(We,{onClose:cs,onTransformationAdd:xs=>{xs.value!==void 0&&(Pt.onChangeTransformations([...wt,{id:xs.value,options:{}}]),cs())},isOpen:Zt,series:yt.series});return wt.length<1?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(Me.p,{onShowPicker:qn}),Os]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(ut,{data:lt.data,transformations:wt,model:Pt}),(0,u.jsxs)(Se.e,{children:[(0,u.jsx)(U.$n,{icon:"plus",variant:"secondary",onClick:qn,"data-testid":f.Tp.components.Transforms.addTransformationButton,children:"Add another transformation"}),(0,u.jsx)(U.$n,{"data-testid":f.Tp.components.Transforms.removeAllTransformationsButton,className:Ze.removeAll,icon:"times",variant:"secondary",onClick:()=>An(!0),children:"Delete all transformations"})]}),(0,u.jsx)(ye.u,{isOpen:On,title:"Delete all transformations?",body:"By deleting all transformations, you will go back to the main selection screen.",confirmText:"Delete all",onConfirm:()=>{Pt.onChangeTransformations([]),An(!1)},onDismiss:()=>An(!1)}),Os]})}function ut({transformations:Pt,model:Ze,data:lt}){const yt=Pt.map((wt,Zt)=>({id:`${Zt} - ${wt.id}`,transformation:wt})),Nt=wt=>{if(!wt||!wt.destination)return;const Zt=wt.source.index,pn=wt.destination.index;if(Zt===pn)return;const On=Array.from(yt),[An]=On.splice(Zt,1);On.splice(pn,0,An),Ze.onChangeTransformations(On.map(qn=>qn.transformation))};return(0,u.jsx)(fe.JY,{onDragEnd:Nt,children:(0,u.jsx)(fe.gL,{droppableId:"transformations-list",direction:"vertical",children:wt=>(0,u.jsxs)("div",{ref:wt.innerRef,...wt.droppableProps,children:[(0,u.jsx)(Ve.A,{onChange:(Zt,pn)=>{const On=Pt.slice();On[Zt]=pn,Ze.onChangeTransformations(On)},onRemove:Zt=>{const pn=Pt.slice();pn.splice(Zt,1),Ze.onChangeTransformations(pn)},configs:yt,data:lt}),wt.placeholder]})})})}const Tt=Pt=>({removeAll:(0,p.css)({marginLeft:Pt.spacing(2)})});function It(Pt){const{model:Ze}=Pt,lt=Ze.getDataTransformer().useState();return(0,u.jsx)(M.o,{label:Ze.getTabLabel(),icon:"process",counter:lt.transformations.length,active:Pt.active,onChangeTab:Pt.onChangeTab})}class ge extends a.Bs{constructor(){super(...arguments),this._urlSync=new a.So(this,{keys:["tab"]}),this.onChangeTab=Ze=>{this.setState({tab:Ze.tabId})}}static{this.Component=Ie}static createFor(Ze){const lt=Ze.getRef(),yt=[new ce({panelRef:lt}),new _e({panelRef:lt})];return ue(Ze.state.pluginId)&&yt.push(new N({panelRef:lt})),new ge({panelRef:lt,tabs:yt,tab:z.Queries})}getUrlState(){return{tab:this.state.tab}}updateFromUrl(Ze){Ze.tab&&typeof Ze.tab=="string"&&this.setState({tab:Ze.tab})}}function Ie({model:Pt}){const{tab:Ze,tabs:lt}=Pt.useState(),yt=(0,y.of)(me);if(!lt||!lt.length)return;const Nt=lt.find(wt=>wt.tabId===Ze);return(0,u.jsxs)("div",{className:yt.dataPane,"data-testid":f.Tp.components.PanelEditor.DataPane.content,children:[(0,u.jsx)(x.U,{hideBorder:!0,className:yt.tabsBar,children:lt.map(wt=>wt.renderTab({active:wt.tabId===Ze,onChangeTab:()=>Pt.onChangeTab(wt)}))}),(0,u.jsx)(v.E,{className:yt.scroll,children:(0,u.jsx)(P.J,{className:yt.tabContent,children:(0,u.jsx)(E.mc,{children:Nt&&(0,u.jsx)(Nt.Component,{model:Nt})})})})]})}function ue(Pt){const{unifiedAlertingEnabled:Ze=!1}=(0,D.zj)(),lt=C.TP.hasPermission((0,b.Wd)(T.hY).read);return Ze&&lt?Pt==="graph"||Pt==="timeseries":!1}function me(Pt){return{dataPane:(0,p.css)({display:"flex",flexDirection:"column",flexGrow:1,minHeight:0,height:"100%",width:"100%"}),tabContent:(0,p.css)({padding:Pt.spacing(2),border:`1px solid ${Pt.colors.border.weak}`,borderLeft:"none",borderBottom:"none",borderTopRightRadius:Pt.shape.radius.default,flexGrow:1}),tabsBar:(0,p.css)({flexShrink:0,paddingLeft:Pt.spacing(2)}),scroll:(0,p.css)({background:Pt.colors.background.primary})}}var Pe=e(27746),Ne=e(62930),Fe=e(70453),Be=e(54174),he=e(1951),be=e(21633);function Ke(Pt){const{paneOptions:Ze}=Pt,[lt,yt]=(0,Ee.useState)({collapsed:!1}),Nt=(0,Ee.useCallback)((cs,Os)=>{if(cs<=0&&Os<=0)return;const xs=Os/cs*(1-cs);lt.collapsed&&xs>Ze.collapseBelowPixels&&yt({collapsed:!1}),!lt.collapsed&&xs<Ze.collapseBelowPixels&&yt({collapsed:!0})},[lt,Ze.collapseBelowPixels]),wt=(0,Ee.useCallback)((cs,Os)=>{if(cs<=0&&Os<=0)return;const xs=1-cs,zs=lt.snapSize===0,Ks=Os/cs,la=(Ze.snapOpenToPixels??Ks/2)/Ks;lt.collapsed?yt(zs?{snapSize:Math.max(xs,la),collapsed:!1}:{snapSize:0,collapsed:!0}):zs&&yt({snapSize:xs,collapsed:!1})},[lt,Ze.snapOpenToPixels]),Zt=(0,Ee.useCallback)(()=>{yt({collapsed:!lt.collapsed})},[lt.collapsed]),{containerProps:pn,primaryProps:On,secondaryProps:An,splitterProps:qn}=(0,be.h)({...Pt,onResizing:Nt,onSizeChanged:wt});return An.style.overflow="hidden",An.style.minWidth="unset",An.style.minHeight="unset",lt.snapSize?(On.style={...On.style,flexGrow:1-lt.snapSize},An.style.flexGrow=lt.snapSize):lt.snapSize===0&&(On.style.flexGrow=1,An.style.flexGrow=0,An.style.minWidth="unset",An.style.minHeight="unset",An.style.overflow="unset"),{containerProps:pn,primaryProps:On,secondaryProps:An,splitterProps:qn,splitterState:lt,onToggleCollapse:Zt}}function ze({model:Pt}){const Ze=(0,o.YQ)(Pt),{optionsPane:lt}=Pt.useState(),yt=(0,y.of)(ot),{containerProps:Nt,primaryProps:wt,secondaryProps:Zt,splitterProps:pn,splitterState:On,onToggleCollapse:An}=Ke({direction:"row",dragPosition:"end",initialSize:.75,paneOptions:{collapseBelowPixels:250,snapOpenToPixels:400}});return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(Fe.c,{dashboard:Ze}),(0,u.jsxs)("div",{...Nt,className:(0,p.cx)(Nt.className,yt.content),"data-testid":f.Tp.components.PanelEditor.General.content,children:[(0,u.jsx)("div",{...wt,className:(0,p.cx)(wt.className,yt.body),children:(0,u.jsx)(nt,{model:Pt})}),(0,u.jsx)("div",{...pn}),(0,u.jsxs)("div",{...Zt,className:(0,p.cx)(Zt.className,yt.optionsPane),children:[On.collapsed&&(0,u.jsx)("div",{className:yt.expandOptionsWrapper,children:(0,u.jsx)(Pe.I,{tooltip:"Open options pane",icon:"arrow-to-right",onClick:An,variant:"canvas",className:yt.rotate180,"aria-label":"Open options pane"})}),!On.collapsed&&lt&&(0,u.jsx)(lt.Component,{model:lt}),!On.collapsed&&!lt&&(0,u.jsx)(Ne.y,{})]})]})]})}function nt({model:Pt}){const Ze=(0,o.YQ)(Pt),{dataPane:lt,showLibraryPanelSaveModal:yt,showLibraryPanelUnlinkModal:Nt,tableView:wt}=Pt.useState(),Zt=Pt.getPanel(),pn=(0,o.iL)(Zt),{controls:On}=Ze.useState(),An=(0,y.of)(ot),{containerProps:qn,primaryProps:cs,secondaryProps:Os,splitterProps:xs,splitterState:zs,onToggleCollapse:Ks}=Ke({direction:"column",dragPosition:"start",initialSize:.5,paneOptions:{collapseBelowPixels:150}});return qn.className=(0,p.cx)(qn.className,An.container),lt||(cs.style.flexGrow=1),(0,u.jsxs)("div",{className:(0,p.cx)(An.pageContainer,On&&An.pageContainerWithControls),children:[On&&(0,u.jsx)("div",{className:An.controlsWrapper,children:(0,u.jsx)(On.Component,{model:On})}),(0,u.jsxs)("div",{...qn,children:[(0,u.jsx)("div",{...cs,children:(0,u.jsx)(tt,{panel:Zt,tableView:wt})}),yt&&pn&&(0,u.jsx)(he.Z,{libraryPanel:pn,onDismiss:Pt.onDismissLibraryPanelSaveModal,onConfirm:Pt.onConfirmSaveLibraryPanel,onDiscard:Pt.onDiscard}),Nt&&pn&&(0,u.jsx)(Be.l,{onDismiss:Pt.onDismissUnlinkLibraryPanelModal,onConfirm:Pt.onConfirmUnlinkLibraryPanel,isOpen:!0}),lt&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{...xs}),(0,u.jsxs)("div",{...Os,children:[zs.collapsed&&(0,u.jsx)("div",{className:An.expandDataPane,children:(0,u.jsx)(U.$n,{tooltip:"Open query pane",icon:"arrow-to-right",onClick:Ks,variant:"secondary",size:"sm",className:An.openDataPaneButton,"aria-label":"Open query pane"})}),!zs.collapsed&&(0,u.jsx)(lt.Component,{model:lt})]})]})]})]})}function tt({panel:Pt,tableView:Ze}){const lt=(0,y.of)(ot),yt=Ze??Pt;return(0,u.jsx)("div",{className:lt.vizWrapper,children:(0,u.jsx)(yt.Component,{model:yt})})}function ot(Pt){return{pageContainer:(0,p.css)({display:"grid",gridTemplateAreas:`
        "panels"`,gridTemplateColumns:"1fr",gridTemplateRows:"1fr",height:"100%"}),pageContainerWithControls:(0,p.css)({gridTemplateAreas:`
        "controls"
        "panels"`,gridTemplateRows:"auto 1fr"}),container:(0,p.css)({gridArea:"panels",height:"100%"}),canvasContent:(0,p.css)({label:"canvas-content",display:"flex",flexDirection:"column",flexBasis:"100%",flexGrow:1,minHeight:0,width:"100%"}),content:(0,p.css)({position:"absolute",width:"100%",height:"100%"}),body:(0,p.css)({label:"body",flexGrow:1,display:"flex",flexDirection:"column",minHeight:0}),optionsPane:(0,p.css)({flexDirection:"column",borderLeft:`1px solid ${Pt.colors.border.weak}`,background:Pt.colors.background.primary}),expandOptionsWrapper:(0,p.css)({display:"flex",flexDirection:"column",padding:Pt.spacing(2,1)}),expandDataPane:(0,p.css)({display:"flex",flexDirection:"row",padding:Pt.spacing(1),borderTop:`1px solid ${Pt.colors.border.weak}`,borderRight:`1px solid ${Pt.colors.border.weak}`,background:Pt.colors.background.primary,flexGrow:1,justifyContent:"space-around"}),rotate180:(0,p.css)({rotate:"180deg"}),controlsWrapper:(0,p.css)({display:"flex",flexDirection:"column",flexGrow:0,gridArea:"controls",padding:Pt.spacing(2,0,2,2)}),openDataPaneButton:(0,p.css)({width:Pt.spacing(8),justifyContent:"center",svg:{rotate:"-90deg"}}),vizWrapper:(0,p.css)({height:"100%",width:"100%",paddingLeft:Pt.spacing(2)})}}var gt=e(581),He=e(43429),et=e(67647),rt=e(10860),ht=e(8484),ft=e(41394),De=e(17706),Te=e(74106),Oe=e(20485),Ye=e(22290),Ge=e(66211),Je=e(68435),it=e(15292),St=e(94354),zt=e(90182),Kt=e(64919),Qt=e(10354),an=e(21744),Nn=e(20214),zn=e(74410),Yn=e(48192),ss=e(74097),ds=e(92378),Ms=e(29304),Bs=e(32023);function gs(Pt,Ze){const lt=new Yn.C({title:"Panel options",id:"Panel options",isOpenDefault:!0}),yt=Bs.b4.getPanelLinks(Pt),Nt=yt?.state.rawLinks??[],wt=(0,o.YQ)(Pt),Zt=Pt.parent;if(lt.addItem(new ss.v({title:"Title",value:Pt.state.title,popularRank:1,render:function(){return(0,u.jsx)(Ls,{panel:Pt})},addon:s.$.featureToggles.dashgpt&&(0,u.jsx)(zn.h,{onGenerate:pn=>Hn(Pt,pn),panel:(0,h.Z6)(Pt),dashboard:(0,h.Uy)(wt)})})).addItem(new ss.v({title:"Description",value:Pt.state.description,render:function(){return(0,u.jsx)(Ln,{panel:Pt})},addon:s.$.featureToggles.dashgpt&&(0,u.jsx)(Nn.t,{onGenerate:pn=>Pt.setState({description:pn}),panel:(0,h.Z6)(Pt)})})).addItem(new ss.v({title:"Transparent background",render:function(){return(0,u.jsx)(it.d,{value:Pt.state.displayMode==="transparent",id:"transparent-background",onChange:()=>{Pt.setState({displayMode:Pt.state.displayMode==="transparent"?"default":"transparent"})}})}})).addCategory(new Yn.C({title:"Panel links",id:"Panel links",isOpenDefault:!1,itemsCount:Nt?.length}).addItem(new ss.v({title:"Panel links",render:()=>(0,u.jsx)(Zn,{panelLinks:yt??void 0})}))),Zt instanceof c.U){const pn=Zt,On=new Yn.C({title:"Repeat options",id:"Repeat options",isOpenDefault:!1});On.addItem(new ss.v({title:"Repeat by variable",description:"Repeat this panel for each value in the selected variable. This is not visible while in edit mode. You need to go back to dashboard and then update the variable or reload the dashboard.",render:function(){return(0,u.jsx)(ds.U,{id:"repeat-by-variable-select",sceneContext:Pt,repeat:pn.state.variableName,onChange:qn=>pn.setRepeatByVariable(qn)})}})),On.addItem(new ss.v({title:"Repeat direction",showIf:()=>!!pn.state.variableName,render:function(){const qn=[{label:"Horizontal",value:"h"},{label:"Vertical",value:"v"}];return(0,u.jsx)(St.z,{options:qn,value:pn.state.repeatDirection??"h",onChange:cs=>pn.setState({repeatDirection:cs})})}})),On.addItem(new ss.v({title:"Max per row",showIf:()=>!!(pn.state.variableName&&pn.state.repeatDirection==="h"),render:function(){const qn=[2,3,4,6,8,12].map(cs=>({label:cs.toString(),value:cs}));return(0,u.jsx)(zt.l6,{options:qn,value:pn.state.maxPerRow??4,onChange:cs=>pn.setState({maxPerRow:cs.value})})}})),lt.addCategory(On)}return lt}function Zn({panelLinks:Pt}){const{rawLinks:Ze}=Pt?Pt.useState():{rawLinks:[]};return(0,u.jsx)(Kt.e,{links:Ze,onChange:lt=>Pt?.setState({rawLinks:lt}),getSuggestions:Ms.Fq,data:[]})}function Ls({panel:Pt}){const{title:Ze}=Pt.useState();return(0,u.jsx)(Qt.p,{"data-testid":f.Tp.components.PanelEditor.OptionsPane.fieldInput("Title"),value:Ze,onChange:lt=>Hn(Pt,lt.currentTarget.value)})}function Ln({panel:Pt}){const{description:Ze}=Pt.useState();return(0,u.jsx)(an.f,{id:"description-text-area",value:Ze,onChange:lt=>Pt.setState({description:lt.currentTarget.value})})}function Hn(Pt,Ze){Pt.setState({title:Ze,hoverHeader:Ze===""})}const Qn=Ee.memo(({panel:Pt,searchQuery:Ze,listMode:lt,data:yt})=>{const{options:Nt,fieldConfig:wt,_pluginInstanceState:Zt}=Pt.useState(),On=Pt.parent.useState(),An=(0,Ee.useMemo)(()=>gs(Pt,On),[Pt,On]),qn=(0,Ee.useMemo)(()=>{const Ks=Pt.getPlugin();if(Ks)return(0,Ge.Z4)({panel:Pt,data:yt,plugin:Ks,eventBus:Pt.getPanelContext().eventBus,instanceState:Zt})},[yt,Pt,Nt,wt,Zt]),cs=(0,Ee.useMemo)(()=>{if(Pt instanceof a.Eb&&(0,o.ME)(Pt)){const Ks=(0,o.iL)(Pt);return Ks instanceof Je.u?(0,Ge.tN)(Ks):void 0}},[Pt]),Os=(0,Ee.useMemo)(()=>(0,Ye.v)(wt,Pt.getPlugin()?.fieldConfigRegistry,yt?.series??[],Ze,Ks=>{Pt.onFieldConfigChange(Ks,!0)}),[yt,Ze,Pt,wt]),xs=Ze.length>0,zs=[];if(xs)zs.push((0,r.Po)([An,...cs?[cs]:[],...qn??[]],Os,Ze));else switch(lt){case r.gs.All:cs&&zs.push(cs.render()),zs.push(An.render());for(const Ks of qn??[])zs.push(Ks.render());for(const Ks of Os)zs.push(Ks.render());break;case r.gs.Overrides:for(const Ks of Os)zs.push(Ks.render());default:break}return zs});Qn.displayName="PanelOptions";var mt=e(78685),Yt=e(88575),on=e(15054),ln=e(32696),fn=e(56707),yn=e(86292),wn=e(53543);function Xn({panel:Pt,data:Ze,onChange:lt,onClose:yt}){const Nt=(0,y.of)(xn),[wt,Zt]=(0,Ee.useState)(""),pn=!1,On=pn?on.MM:on.wV,An=pn?ln.__.Widgets:ln.__.Visualizations,qn=(0,Ee.useMemo)(()=>new wn.R(Pt),[Pt]),cs=(0,Ee.useMemo)(()=>new Set([ln.__.Widgets,ln.__.Visualizations,ln.__.Suggestions]),[]),[Os,xs]=(0,mt.A)(On,An);(0,Ee.useEffect)(()=>{Os&&!cs.has(Os)&&xs(An)},[An,Os,xs,cs]);const zs=[{label:"Visualizations",value:ln.__.Visualizations},{label:"Suggestions",value:ln.__.Suggestions}];return(0,u.jsxs)("div",{className:Nt.wrapper,children:[(0,u.jsxs)("div",{className:Nt.searchRow,children:[(0,u.jsx)(et.Z,{className:Nt.filter,value:wt,onChange:Zt,autoFocus:!0,placeholder:"Search for..."}),(0,u.jsx)(U.$n,{title:"Close",variant:"secondary",icon:"angle-up",className:Nt.closeButton,"data-testid":f.Tp.components.PanelEditor.toggleVizPicker,onClick:yt})]}),(0,u.jsx)(Yt.D,{className:Nt.customFieldMargin,children:(0,u.jsx)(St.z,{options:zs,value:Os,onChange:xs,fullWidth:!0})}),(0,u.jsxs)(v.E,{children:[Os===ln.__.Visualizations&&(0,u.jsx)(yn.G,{pluginId:Pt.state.pluginId,searchQuery:wt,onChange:lt}),Os===ln.__.Suggestions&&(0,u.jsx)(fn.a,{onChange:lt,searchQuery:wt,panel:qn,data:Ze})]})]})}const xn=Pt=>({wrapper:(0,p.css)({display:"flex",flexDirection:"column",flexGrow:1,padding:Pt.spacing(2,1),height:"100%",gap:Pt.spacing(2),border:`1px solid ${Pt.colors.border.weak}`,borderRight:"none",borderBottom:"none",borderTopLeftRadius:Pt.shape.radius.default}),searchRow:(0,p.css)({display:"flex",marginBottom:Pt.spacing(1)}),closeButton:(0,p.css)({marginLeft:Pt.spacing(1)}),customFieldMargin:(0,p.css)({marginBottom:Pt.spacing(1)}),filter:(0,p.css)({minHeight:Pt.spacing(4)})});class Ut extends a.Bs{constructor(){super(...arguments),this._cachedPluginOptions={},this.onToggleVizPicker=()=>{this.setState({isVizPickerOpen:!this.state.isVizPickerOpen})},this.onChangePanelPlugin=Ze=>{const lt=this.state.panelRef.resolve(),{options:yt,fieldConfig:Nt,pluginId:wt}=lt.state,Zt=Ze.pluginId;let pn={defaults:{...Nt.defaults,custom:{}},overrides:(0,gt.aW)(Nt.overrides,gt.nx)};this._cachedPluginOptions[wt]={options:yt,fieldConfig:Nt};const On=this._cachedPluginOptions[Zt]?.options,An=this._cachedPluginOptions[Zt]?.fieldConfig;An&&(pn=(0,gt.H9)(pn,An)),lt.changePluginType(Zt,On,pn),this.onToggleVizPicker()},this.onSetSearchQuery=Ze=>{this.setState({searchQuery:Ze})},this.onSetListMode=Ze=>{this.setState({listMode:Ze})},this.onOpenPanelJSON=Ze=>{n.Ny.partial({inspect:Ze.state.key,inspectTab:"json"})}}static{this.Component=({model:Ze})=>{const{isVizPickerOpen:lt,searchQuery:yt,listMode:Nt,panelRef:wt}=Ze.useState(),Zt=wt.resolve(),{pluginId:pn}=Zt.useState(),{data:On}=a.jh.getData(Zt).useState(),An=(0,y.of)(nn),qn=(0,Oe.Wu)(Zt);return(0,u.jsxs)(u.Fragment,{children:[!lt&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{className:An.top,children:[(0,u.jsx)(hn,{pluginId:pn,onOpen:Ze.onToggleVizPicker}),(0,u.jsx)(et.Z,{className:An.searchOptions,value:yt,placeholder:"Search options",onChange:Ze.onSetSearchQuery})]}),qn&&(0,u.jsx)("div",{className:An.angularDeprecationContainer,children:(0,u.jsxs)(Te.c,{showPluginDetailsLink:!0,pluginId:pn,pluginType:He.QE.panel,angularSupportEnabled:s.$?.angularSupportEnabled,interactionElementId:"panel-options",children:[(0,u.jsx)(rt.Z.Heading,{children:(0,u.jsx)(ht.x6,{i18nKey:"dashboards.panel-edit.angular-deprecation-heading",children:"Panel options"})}),(0,u.jsx)(rt.Z.Description,{children:(0,u.jsx)(ht.x6,{i18nKey:"dashboards.panel-edit.angular-deprecation-description",children:"Angular panels options can only be edited using the JSON editor."})}),(0,u.jsx)(rt.Z.Actions,{children:(0,u.jsx)(U.$n,{variant:"secondary",fullWidth:!1,onClick:()=>{Ze.onOpenPanelJSON(Zt)},children:(0,u.jsx)(ht.x6,{i18nKey:"dashboards.panel-edit.angular-deprecation-button-open-panel-json",children:"Open JSON editor"})})})]})}),(0,u.jsx)("div",{className:An.listOfOptions,children:(0,u.jsx)(Qn,{panel:Zt,searchQuery:yt,listMode:Nt,data:On})})]}),lt&&(0,u.jsx)(Xn,{panel:Zt,onChange:Ze.onChangePanelPlugin,onClose:Ze.onToggleVizPicker,data:On})]})}}}function nn(Pt){return{top:(0,p.css)({display:"flex",flexDirection:"column",padding:Pt.spacing(2,1),gap:Pt.spacing(2)}),listOfOptions:(0,p.css)({display:"flex",flexDirection:"column",flexGrow:"1",overflow:"auto"}),searchOptions:(0,p.css)({minHeight:Pt.spacing(4)}),searchWrapper:(0,p.css)({padding:Pt.spacing(2,2,2,0)}),vizField:(0,p.css)({marginBottom:Pt.spacing(1)}),rotateIcon:(0,p.css)({rotate:"180deg"}),angularDeprecationContainer:(0,p.css)({label:"angular-deprecation-container",padding:Pt.spacing(1),display:"flex",flexDirection:"column",alignItems:"flex-end"})}}function hn({pluginId:Pt,onOpen:Ze}){const lt=(0,y.of)(dn);let yt=(0,Ee.useMemo)(()=>(0,De.A4)().filter(Nt=>Nt.id===Pt)[0],[Pt]);return yt||(yt=(0,ft.$)(`Panel plugin not found (${Pt})`,!0).meta),(0,u.jsx)(ae.B,{gap:1,children:(0,u.jsx)(Pe.I,{className:lt.vizButton,tooltip:"Click to change visualization",imgSrc:yt.info.logos.small,onClick:Ze,"data-testid":f.Tp.components.PanelEditor.toggleVizPicker,"aria-label":"Change Visualization",variant:"canvas",isOpen:!1,fullWidth:!0,children:yt.name})})}function dn(Pt){return{vizButton:(0,p.css)({textAlign:"left"})}}class Sn extends a.Bs{constructor(Ze){super(Ze),this._changesHaveBeenMade=!1,this.debounceSaveModelDiff=!0,this.onDiscard=()=>{this.setState({isDirty:!1});const lt=this.state.panelRef.resolve();this.state.isNewPanel?(0,o.YQ)(this).removePanel(lt):this._layoutElement.setState(this._originalLayoutElementState),n.Ny.partial({editPanel:null})},this.onSaveLibraryPanel=()=>{this.setState({showLibraryPanelSaveModal:!0})},this.onConfirmSaveLibraryPanel=()=>{(0,i.DW)(this.state.panelRef.resolve()),this.setState({isDirty:!1}),n.Ny.partial({editPanel:null})},this.onDismissLibraryPanelSaveModal=()=>{this.setState({showLibraryPanelSaveModal:!1})},this.onUnlinkLibraryPanel=()=>{this.setState({showLibraryPanelUnlinkModal:!0})},this.onDismissUnlinkLibraryPanelModal=()=>{this.setState({showLibraryPanelUnlinkModal:!1})},this.onConfirmUnlinkLibraryPanel=()=>{const lt=(0,o.iL)(this.getPanel());lt&&(lt.unlink(),this.setState({showLibraryPanelUnlinkModal:!1}))},this.onToggleTableView=()=>{if(this.state.tableView){this.setState({tableView:void 0});return}const yt=this.state.panelRef.resolve().state.$data;yt&&this.setState({tableView:a.d0.table().setTitle("").setOption("showTypeIcons",!0).setOption("showHeader",!0).setData(new m({source:yt.getRef()})).build()})},this.setOriginalState(this.state.panelRef),this.addActivationHandler(this._activationHandler.bind(this))}static{this.Component=ze}_activationHandler(){const Ze=this.state.panelRef.resolve(),lt=(0,o.M6)(Ze),yt=Ze.parent;return this.waitForPlugin(),()=>{yt instanceof c.U&&yt.editingCompleted(this.state.isDirty||this._changesHaveBeenMade),lt&&lt()}}waitForPlugin(Ze=0){const lt=this.getPanel(),yt=lt.getPlugin();if(!yt||yt.meta.id!==lt.state.pluginId){Ze<100?setTimeout(()=>this.waitForPlugin(Ze+1),Ze*10):this.setState({pluginLoadErrror:"Failed to load panel plugin"});return}this.gotPanelPlugin(yt)}setOriginalState(Ze){const lt=Ze.resolve();this._originalSaveModel=(0,h.Z6)(lt),lt.parent instanceof c.U&&(this._originalLayoutElementState=a.Go.cloneSceneObjectState(lt.parent.state),this._layoutElement=lt.parent)}_setupChangeDetection(){const Ze=this.state.panelRef.resolve(),lt=()=>{const{hasChanges:wt}=(0,d.yO)(this._originalSaveModel,(0,h.Z6)(Ze));this.setState({isDirty:wt})},yt=this.debounceSaveModelDiff?(0,t.debounce)(lt,250):lt,Nt=wt=>{l.l.isUpdatingPersistedState(wt)&&yt()};this._subs.add(Ze.subscribeToEvent(a.bZ,Nt)),this._subs.add(this._layoutElement.subscribeToEvent(a.bZ,Nt))}getPanel(){return this.state.panelRef?.resolve()}gotPanelPlugin(Ze){const lt=this.getPanel(),yt=lt.parent;this.state.isInitializing?(this.setOriginalState(this.state.panelRef),yt instanceof c.U&&yt.editingStarted(),this._setupChangeDetection(),this._updateDataPane(Ze),this._subs.add(lt.subscribeToState((Nt,wt)=>{Nt.pluginId!==wt.pluginId&&this.waitForPlugin()})),this.setState({optionsPane:new Ut({panelRef:this.state.panelRef,searchQuery:"",listMode:r.gs.All}),isInitializing:!1})):this._updateDataPane(Ze)}_updateDataPane(Ze){const lt=Ze.meta.skipDataQuery,yt=this.state.panelRef.resolve();if(lt&&(this.state.dataPane&&(n.Ny.partial({tab:null},!0),this.setState({dataPane:void 0})),yt.state.$data&&yt.setState({$data:void 0})),!lt&&(this.state.dataPane||this.setState({dataPane:ge.createFor(this.getPanel())}),!yt.state.$data)){let Nt=(0,g.CW)((0,o.YQ)(this).state.uid)?.datasourceUid;Nt||(Nt=s.$.defaultDatasource),yt.setState({$data:new a.Es({$data:new a.dt({datasource:{uid:Nt},queries:[{refId:"A"}]}),transformations:[]})})}}getUrlKey(){return this.getPanelId().toString()}getPanelId(){return(0,o.Cs)(this.state.panelRef.resolve())}getPageNav(Ze,lt){return{text:"Edit panel",parentItem:(0,o.YQ)(this).getPageNav(Ze,lt)}}dashboardSaved(){this.setOriginalState(this.state.panelRef),this.setState({isDirty:!1}),this._changesHaveBeenMade=!1}}function es(Pt,Ze=!1){return new Sn({isInitializing:!0,panelRef:Pt.getRef(),isNewPanel:Ze})}},1951:(G,R,e)=>{"use strict";e.d(R,{Z:()=>o});var t=e(74848),n=e(96540),s=e(16817),a=e(40996),r=e(40845),g=e(37390),i=e(10354),l=e(14578),d=e(55852),c=e(57767),h=e(43535);const o=({libraryPanel:m,isUnsavedPrompt:u,onDismiss:p,onConfirm:f,onDiscard:y})=>{const[x,v]=(0,n.useState)(""),P=(0,s.A)(async()=>{const S=await(0,c.xV)(m.state.uid);return S.length>0?S.map(O=>O.title):[]},[m.state.uid]),[E,D]=(0,n.useState)([]);(0,a.A)(()=>P.value?D(P.value.filter(S=>S.toLowerCase().includes(x.toLowerCase()))):D([]),300,[P.value,x]);const C=(0,r.of)(h.o),b=(0,n.useCallback)(()=>{y()},[y]),T=u?"Unsaved library panel changes":"Save library panel";return(0,t.jsx)(g.a,{title:T,icon:"save",onDismiss:p,isOpen:!0,children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:C.textInfo,children:["This update will affect ",(0,t.jsxs)("strong",{children:[m.state._loadedPanel?.meta?.connectedDashboards," ",m.state._loadedPanel?.meta?.connectedDashboards===1?"dashboard":"dashboards","."]}),"The following dashboards using the panel will be affected:"]}),(0,t.jsx)(i.p,{className:C.dashboardSearch,prefix:(0,t.jsx)(l.I,{name:"search"}),placeholder:"Search affected dashboards",value:x,onChange:S=>v(S.currentTarget.value)}),P.loading?(0,t.jsx)("p",{children:"Loading connected dashboards..."}):(0,t.jsxs)("table",{className:C.myTable,children:[(0,t.jsx)("thead",{children:(0,t.jsx)("tr",{children:(0,t.jsx)("th",{children:"Dashboard name"})})}),(0,t.jsx)("tbody",{children:E.map((S,O)=>(0,t.jsx)("tr",{children:(0,t.jsx)("td",{children:S})},`dashrow-${O}`))})]}),(0,t.jsxs)(g.a.ButtonRow,{children:[(0,t.jsx)(d.$n,{variant:"secondary",onClick:p,fill:"outline",children:"Cancel"}),u&&(0,t.jsx)(d.$n,{variant:"destructive",onClick:b,children:"Discard"}),(0,t.jsx)(d.$n,{onClick:()=>{f()},children:"Update all"})]})]})})}},13530:(G,R,e)=>{"use strict";e.d(R,{l:()=>m});var t=e(84537),n=e(67278);const s=()=>new n.c(new URL(e.p+e.u(9666),e.b));var a=e(38477),r=e(33278),g=e(41507),i=e(55600),l=e(68435),d=e(42397),c=e(7928),h=e(20455),o=e(17663);class m{constructor(p){this._dashboard=p}static isUpdatingPersistedState({payload:p}){return Object.keys(p.partialUpdate).length===0?!1:!!(p.changedObject instanceof t.Eb||p.changedObject instanceof g.U||p.changedObject instanceof c.v||p.changedObject instanceof t.dt&&!Object.prototype.hasOwnProperty.call(p.partialUpdate,"data")||p.changedObject instanceof t.Es&&!Object.prototype.hasOwnProperty.call(p.partialUpdate,"data")||p.changedObject instanceof d.$||p.changedObject instanceof t.WM&&(Object.prototype.hasOwnProperty.call(p.partialUpdate,"intervals")||Object.prototype.hasOwnProperty.call(p.partialUpdate,"refresh"))||p.changedObject instanceof l.u&&Object.prototype.hasOwnProperty.call(p.partialUpdate,"name")||p.changedObject instanceof t.Gg.K2||p.changedObject instanceof t.kh||p.changedObject instanceof g.U||p.changedObject instanceof t.hy||p.changedObject instanceof i.H$&&Object.keys(p.partialUpdate).some(f=>i.vk.includes(f))||p.changedObject instanceof t.JZ||p.changedObject instanceof r.x&&Object.prototype.hasOwnProperty.call(p.partialUpdate,"hideTimeControls")||p.changedObject instanceof t.Pj||p.changedObject instanceof a.g&&!Object.prototype.hasOwnProperty.call(p.partialUpdate,"data")||p.changedObject instanceof t.Gg.en||(0,o.c7)(p.changedObject))}onStateChanged(p){m.isUpdatingPersistedState(p)&&this.detectSaveModelChanges()}detectSaveModelChanges(){const p=(0,h.Uy)(this._dashboard),f=this._dashboard.getInitialSaveModel(),y=typeof p=="object"?JSON.parse(JSON.stringify(p)):p,x=typeof f=="object"?JSON.parse(JSON.stringify(f)):f;this._changesWorker?.postMessage({initial:x,changed:y})}hasMetadataChanges(){return this._dashboard.state.meta.folderUid!==this._dashboard.getInitialState()?.meta.folderUid}updateIsDirty(p){const{hasChanges:f}=p;f||this.hasMetadataChanges()?this._dashboard.state.isDirty||this._dashboard.setState({isDirty:!0}):this._dashboard.state.isDirty&&this._dashboard.setState({isDirty:!1})}init(){this._changesWorker=s()}startTrackingChanges(){this._changesWorker||this.init(),this._changesWorker.onmessage=p=>{this.updateIsDirty(p.data)},this._changeTrackerSub=this._dashboard.subscribeToEvent(t.bZ,this.onStateChanged.bind(this))}stopTrackingChanges(){this._changeTrackerSub?.unsubscribe()}terminate(){this.stopTrackingChanges(),this._changesWorker?.terminate(),this._changesWorker=void 0}}},45429:(G,R,e)=>{"use strict";e.d(R,{Yy:()=>r,yO:()=>d});var t=e(56596);function n(c,h){try{let o=c;for(const m of h)o=o[m];return o}catch{return}}function s(c,h){return typeof c==typeof h&&(typeof c=="string"&&c===h||Array.isArray(c)&&c.length===h.length&&c.every((o,m)=>o===h[m]))}function a(c,h){return c===h||c&&h&&c.selected===h.selected&&s(c.text,h.text)&&s(c.value,h.value)}function r(c,h,o,m,u){const p=c,f=h,y=g(f,p),x=l(f,p,m),v=f.refresh!==p.refresh;o||(f.time=p.time),u||(f.refresh=p.refresh);const P=(0,t.G4)(p,f),E=Object.values(P).reduce((D,C)=>D+C.length,0);return{changedSaveModel:f,initialSaveModel:p,diffs:P,diffCount:E,hasChanges:E>0,hasTimeChanges:y,isNew:f.version===0,hasVariableValueChanges:x,hasRefreshChange:v}}function g(c,h){return c.time?.from!==h.time?.from||c.time?.to!==h.time?.to}function i(c,h){if(c.filters===void 0&&h.filters===void 0)return console.warn("Adhoc variable filter property is undefined"),!0;if(c.filters===void 0&&h.filters!==void 0||h.filters===void 0&&c.filters!==void 0)return console.warn("Adhoc variable filter property is undefined"),!1;if(c.filters.length!==h.filters.length)return!1;for(let o=0;o<c.filters.length;o++){const m=c.filters[o],u=h.filters[o];if(m.key!==u.key||m.operator!==u.operator||m.value!==u.value)return!1}return!0}function l(c,h,o){const m=h.templating?.list??[],u=c.templating?.list??[];let p=!1;for(const f of u){const y=m.find(({name:x,type:v})=>x===f.name&&v===f.type);if(y&&(y.current&&delete y.current.selected,a(f.current,y.current)?f.type==="adhoc"&&!i(f,y)&&(p=!0):p=!0,!o)){const x=f;x.type==="adhoc"?x.filters=y.filters:(f.current=y.current,f.options=y.options)}}return p}function d(c,h){const o=(0,t.G4)(h,c),m=Object.values(o).reduce((u,p)=>u+p.length,0);return{changedSaveModel:c,initialSaveModel:h,diffs:o,diffCount:m,hasChanges:m>0}}},91309:(G,R,e)=>{"use strict";e.d(R,{C:()=>D,S:()=>C});var t=e(65474),n=e(81160),s=e(52622),a=e(43585),r=e(14236),g=e(39070),i=e(32264),l=e(84537),d=e(82467),c=e(3169),h=e(10096),o=e(94954),m=e(79938),u=e(49498),p=e(55740),f=e(57220),y=e(23662),x=e(99140),v=e(31678),P=e(94822),E=e(74730);class D extends l.VE{constructor(T){super({isEnabled:!0,...T,isHidden:!0}),this.hasAlertRules=!0,this.topic=s.QR.AlertStates,this.handleError=S=>{const O=(0,c.gi)("AlertStatesDataLayer",(0,o.q)(S));(0,x.JD)((0,d.dx)(O))}}onEnable(){const T=l.jh.getTimeRange(this);this._timeRangeSub=T.subscribeToState(()=>{this.runWithTimeRange(T)})}onDisable(){this._timeRangeSub?.unsubscribe()}runLayer(){const T=l.jh.getTimeRange(this);this.runWithTimeRange(T)}async runWithTimeRange(T){const S=(0,E.YQ)(this),{uid:O,id:M}=S.state;if(this.querySub&&this.querySub.unsubscribe(),!this.canWork(T))return;const I=async()=>{const j=await(0,x.JD)(m.hK.endpoints.prometheusRuleNamespaces.initiate({ruleSourceName:f.hY,dashboardUid:O}));if(j.error)throw new Error("Unexpected alert rules response.");return j.data},B=(0,t.H)(I()).pipe((0,n.T)(j=>(0,u.Kw)(j))).pipe((0,n.T)(j=>{this.hasAlertRules=!1;const A={};return j.forEach(K=>K.rules.forEach(W=>{if((0,y.Z8)(W)&&W.annotations&&W.annotations[p.YH.panelID]){this.hasAlertRules=!0;const U=Number(W.annotations[p.YH.panelID]),F=C(W.state);A[U]?F===a.O.Alerting&&A[U].state!==a.O.Alerting?A[U].state=a.O.Alerting:F===a.O.Pending&&A[U].state!==a.O.Alerting&&A[U].state!==a.O.Pending&&(A[U].state=a.O.Pending):A[U]={state:F,id:Object.keys(A).length,panelId:U,dashboardId:M}}})),Object.values(A)}));this.querySub=B.subscribe({next:j=>{const A=(0,r.Vc)(j);this.publishResults({state:g.Gu.Done,series:[{...A,meta:{...A.meta,dataTopic:s.QR.AlertStates}}],timeRange:T.state.value})},error:j=>{this.handleError(j),this.publishResults({state:g.Gu.Error,series:[],errors:[{message:(0,o.q)(j)}],timeRange:T.state.value})}})}canWork(T){const S=(0,E.YQ)(this),{uid:O}=S.state;return!(!O||i.$.publicDashboardAccessToken||T.state.value.raw.to!=="now"||this.hasAlertRules===!1||!(h.TP.hasPermission(v.AccessControlAction.AlertingRuleRead)&&h.TP.hasPermission(v.AccessControlAction.AlertingRuleExternalRead)))}}function C(b){return b===P.cF.Firing?a.O.Alerting:b===P.cF.Pending?a.O.Pending:a.O.OK}},38477:(G,R,e)=>{"use strict";e.d(R,{g:()=>i});var t=e(43127),n=e(33948),s=e(52622),a=e(32264),r=e(84537),g=e(90569);class i extends r.tV.g{async resolveDataSource(d){return a.$.publicDashboardAccessToken?new g.X:super.resolveDataSource(d)}processEvents(d,c){if(a.$.publicDashboardAccessToken){const h={series:[],timeRange:(0,t.E2)(),state:c.state},o=(0,n.I)(c.events);return o.meta={...o.meta,dataTopic:s.QR.Annotations},h.annotations=[o],h}else return super.processEvents(d,c)}}},33278:(G,R,e)=>{"use strict";e.d(R,{x:()=>x});var t=e(74848),n=e(32196),s=e(12470),a=e(13544),r=e(84537),g=e(40845),i=e(67061),l=e(90613),d=e(15292);function c({panelEditor:E}){const{tableView:D,dataPane:C}=E.useState();return(0,t.jsx)(t.Fragment,{children:C&&(0,t.jsx)(d.K,{label:"Table view",showLabel:!0,id:"table-view",value:!!D,onClick:E.onToggleTableView,"aria-label":"toggle-table-view","data-testid":a.Tp.components.PanelEditor.toggleTableView})})}var h=e(74730),o=e(80997),m=e(56034),u=e(52424),p=e(29304),f=e(4588);function y({links:E,uid:D}){return!E||!D?null:(0,t.jsx)(t.Fragment,{children:E.map((C,b)=>{const T=(0,p.mQ)().getAnchorInfo(C),S=`${C.title}-$${b}`;if(C.type==="dashboards")return(0,t.jsx)(u.aK,{link:C,linkInfo:T,dashboardUID:D},S);const O=f.G[C.icon],M=(0,t.jsx)(u.Zx,{icon:O,href:(0,o.Jf)(T.href),target:C.targetBlank?"_blank":void 0,rel:"noreferrer","data-testid":a.Tp.components.DashboardLinks.link,children:T.title});return(0,t.jsx)("div",{"data-testid":a.Tp.components.DashboardLinks.container,children:C.tooltip?(0,t.jsx)(m.m,{content:T.tooltip,children:M}):M},S)})})}class x extends r.Bs{constructor(D){super({variableControls:[],timePicker:D.timePicker??new r.KE({}),refreshPicker:D.refreshPicker??new r.WM({}),...D}),this._variableDependency=new r.Sh(this,{onAnyVariableChanged:this._onAnyVariableChanged.bind(this)}),this._urlSync=new r.So(this,{keys:["_dash.hideTimePicker","_dash.hideVariables","_dash.hideLinks"]}),this.addActivationHandler(()=>{let C;return this.state.hideTimeControls&&(C=this.state.refreshPicker.activate()),()=>{C&&C()}})}static{this.Component=v}getUrlState(){return{}}updateFromUrl(D){const{hideTimeControls:C,hideVariableControls:b,hideLinksControls:T}=this.state,S=O=>D[O]==="true"||D[O]==="";!C&&S("_dash.hideTimePicker")&&this.setState({hideTimeControls:!0}),!b&&S("_dash.hideVariables")&&this.setState({hideVariableControls:!0}),!T&&S("_dash.hideLinks")&&this.setState({hideLinksControls:!0})}_onAnyVariableChanged(){(0,h.YQ)(this).state.links?.length>0&&this.forceRender()}hasControls(){const D=r.jh.getVariables(this)?.state.variables.some(M=>M.state.hide!==s.zL.hideVariable),C=r.jh.getDataLayers(this).some(M=>M.state.isEnabled&&!M.state.isHidden),b=(0,h.YQ)(this).state.links?.length>0,T=this.state.hideLinksControls||!b,S=this.state.hideVariableControls||!C&&!D,O=this.state.hideTimeControls;return!(S&&T&&O)}}function v({model:E}){const{variableControls:D,refreshPicker:C,timePicker:b,hideTimeControls:T,hideVariableControls:S,hideLinksControls:O}=E.useState(),M=(0,h.YQ)(E),{links:I,editPanel:L}=M.useState(),B=(0,g.of)(P),j=location.search.includes("scene-debugger");return E.hasControls()?(0,t.jsxs)("div",{"data-testid":a.Tp.pages.Dashboard.Controls,className:B.controls,children:[(0,t.jsxs)(i.B,{grow:1,wrap:"wrap",children:[!S&&D.map(A=>(0,t.jsx)(A.Component,{model:A},A.state.key)),(0,t.jsx)(l.a,{grow:1}),!O&&!L&&(0,t.jsx)(y,{links:I,uid:M.state.uid}),L&&(0,t.jsx)(c,{panelEditor:L})]}),!T&&(0,t.jsxs)(i.B,{justifyContent:"flex-end",children:[(0,t.jsx)(b.Component,{model:b}),(0,t.jsx)(C.Component,{model:C})]}),j&&(0,t.jsx)(r.or,{scene:E},"scene-debugger")]}):null}function P(E){return{controls:(0,n.css)({display:"flex",alignItems:"flex-start",flex:"100%",gap:E.spacing(1),flexDirection:"row",flexWrap:"nowrap",position:"relative",width:"100%",marginLeft:"auto",[E.breakpoints.down("sm")]:{flexDirection:"column-reverse",alignItems:"stretch"}}),embedded:(0,n.css)({background:"unset",position:"unset"})}}},16279:(G,R,e)=>{"use strict";e.d(R,{s:()=>s});var t=e(74848),n=e(84537);class s extends n.ps{constructor(r){super({...r,name:r.name??"Data layers",annotationLayers:r.annotationLayers??[]}),this.addActivationHandler(()=>this._onActivate())}_onActivate(){return this._subs.add(this.subscribeToState((r,g)=>{r.annotationLayers!==g.annotationLayers&&(this.querySub?.unsubscribe(),this.subscribeToAllLayers(this.getAllLayers()))})),this.subscribeToAllLayers(this.getAllLayers()),()=>{this.querySub?.unsubscribe()}}addAnnotationLayer(r){this.setState({annotationLayers:[...this.state.annotationLayers,r]})}getAllLayers(){const r=[...this.state.annotationLayers];return this.state.alertStatesLayer&&r.push(this.state.alertStatesLayer),r}static{this.Component=({model:r})=>{const{annotationLayers:g}=r.useState();return(0,t.jsx)(t.Fragment,{children:g.map(i=>(0,t.jsx)(i.Component,{model:i},i.state.key))})}}}},39820:(G,R,e)=>{"use strict";e.d(R,{L:()=>a});var t=e(84537),n=e(14348),s=e(74730);class a extends t.Bs{constructor(g){super(g),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){const g=this.parent;let i,l;if(!(g instanceof t.dt))throw new Error("DashboardDatasourceBehaviour must be attached to a SceneQueryRunner");if(g.state.datasource?.uid!==n.K)return;try{l=(0,s.YQ)(g)}catch{return}const d=g.state.queries.find(p=>p.panelId!==void 0);if(!d)return;const c=d.panelId,h=(0,s.XA)(c),o=(0,s.vL)(l,h);if(!(o instanceof t.Eb))return;const m=(0,s.iL)(o);if(m&&!m.state.isLoaded){i=m.subscribeToState(p=>{this.handleLibPanelStateUpdates(p,g,o)});return}const u=(0,s.un)(o);if(!u)throw new Error("Could not find SceneQueryRunner for panel");return this.prevRequestId&&this.prevRequestId!==u.state.data?.request?.requestId&&g.runQueries(),()=>{this.prevRequestId=u?.state.data?.request?.requestId,i&&i.unsubscribe()}}handleLibPanelStateUpdates(g,i,l){if(g&&g?.isLoaded){if(!((0,s.un)(l)instanceof t.dt))throw new Error("Could not find SceneQueryRunner for library panel");i.runQueries()}}}},41507:(G,R,e)=>{"use strict";e.d(R,{U:()=>o});var t=e(74848),n=e(32196),s=e(2543),a=e.n(s),r=e(96540),g=e(32264),i=e(84537),l=e(15054),d=e(74730),c=e(7196),h=e(30195);class o extends i.Bs{constructor(y){super(y),this._variableDependency=new m(this),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){this.state.variableName&&(this._subs.add(this.subscribeToState((y,x)=>this._handleGridResize(y,x))),this.performRepeat())}_handleGridResize(y,x){const v=this.state.repeatedPanels?.length??1,P={};if(y.height!==x.height){if(this.getRepeatDirection()==="v"){const E=Math.ceil(y.height/v);P.itemHeight=E}else{const E=Math.ceil(v/this.getMaxPerRow());P.itemHeight=Math.ceil(y.height/E)}P.itemHeight!==this.state.itemHeight&&this.setState(P)}}performRepeat(){if(!this.state.variableName||i.jh.hasVariableDependencyInLoadingState(this))return;const y=i.jh.lookupVariable(this.state.variableName,this)??new i.yP({name:"_____default_sys_repeat_var_____",options:[],value:"",text:"",query:"A"});if(!(y instanceof i.n8)){console.error("DashboardGridItem: Variable is not a MultiValueVariable");return}const{values:x,texts:v}=(0,d.a7)(y);if((0,s.isEqual)(this._prevRepeatValues,x)){this.notifyRepeatedPanelsWaitingForVariables(y);return}const P=this.state.body,E=[],D={values:[""],texts:y.hasAllValue()?["All"]:["None"]},C=x.length?x:D.values,b=v.length?v:D.texts;for(let L=0;L<C.length;L++){const B={$variables:new i.Pj({variables:[new i.xc({name:y.state.name,value:C[L],text:String(b[L])})]}),key:`${P.state.key}-clone-${L}`};L>0&&(B.menu=new i.Lw({$behaviors:[c.t0]}));const j=P.clone(B);E.push(j)}const T=this.getRepeatDirection(),S={repeatedPanels:E},O=this.state.itemHeight??10,M=this.state.height,I=this.getMaxPerRow();if(T==="h"){const L=Math.ceil(E.length/I);S.height=L*O}else S.height=E.length*O;if(this.setState(S),M!==this.state.height){const L=i.jh.getLayout(this);L instanceof i.hy&&L.forceRender()}this._prevRepeatValues=x,this.publishEvent(new h.d({source:this}),!0)}setRepeatByVariable(y){const x={variableName:y};y&&!this.state.repeatDirection&&(x.repeatDirection="h"),this.state.body.state.$variables&&this.state.body.setState({$variables:void 0}),this.setState(x)}editingStarted(){this.state.variableName&&(this.state.repeatedPanels?.length??!1)&&this.state.body.setState({$variables:this.state.repeatedPanels[0].state.$variables?.clone(),$data:this.state.repeatedPanels[0].state.$data?.clone()})}editingCompleted(y){y&&(this._prevRepeatValues=void 0),this.state.variableName&&this.state.repeatDirection==="h"&&this.state.width!==l.cV&&this.setState({width:l.cV})}notifyRepeatedPanelsWaitingForVariables(y){for(const x of this.state.repeatedPanels??[]){const v=(0,d.un)(x);v&&v.variableDependency?.variableUpdateCompleted(y,!1)}}getMaxPerRow(){return this.state.maxPerRow??4}getRepeatDirection(){return this.state.repeatDirection==="v"?"v":"h"}getClassName(){return this.state.variableName?"panel-repeater-grid-item":""}isRepeated(){return this.state.variableName!==void 0}static{this.Component=({model:y})=>{const{repeatedPanels:x,itemHeight:v,variableName:P,body:E}=y.useState(),D=x?.length??0,C=u(y.getRepeatDirection(),D,y.getMaxPerRow(),v??10);return!P&&E instanceof i.Eb?(0,t.jsx)(E.Component,{model:E},E.state.key):x?(0,t.jsx)("div",{className:C,children:x.map(b=>(0,t.jsx)("div",{className:p,children:(0,t.jsx)(b.Component,{model:b},b.state.key)},b.state.key))}):null}}}class m{constructor(y){this._gridItem=y}getNames(){return this._gridItem.state.variableName?new Set([this._gridItem.state.variableName]):new Set}hasDependencyOn(y){return this._gridItem.state.variableName===y}variableUpdateCompleted(y,x){this._gridItem.state.variableName===y.state.name&&this._gridItem.performRepeat()}}function u(f,y,x,v){return(0,r.useMemo)(()=>{const P=g.$.theme2,E=v*l.sD*y+(y-1)*l.dU;if(f==="h"){const D=Math.ceil(y/x),C=Math.min(y,x);return(0,n.css)({display:"grid",height:"100%",width:"100%",gridTemplateColumns:`repeat(${C}, 1fr)`,gridTemplateRows:`repeat(${D}, 1fr)`,gridColumnGap:P.spacing(1),gridRowGap:P.spacing(1),[P.breakpoints.down("md")]:{display:"flex",flexDirection:"column",height:E}})}return(0,n.css)({display:"flex",height:"100%",width:"100%",flexDirection:"column",gap:P.spacing(1),[P.breakpoints.down("md")]:{height:E}})},[f,y,x,v])}const p=(0,n.css)({display:"flex",flexGrow:1,position:"relative"})},55600:(G,R,e)=>{"use strict";e.d(R,{H$:()=>po,vk:()=>fo});var t=e(71733),n=e(26272),s=e(41987),a=e(39601),r=e(32264),g=e(3591),i=e(84537),l=e(28138),d=e(15054),c=e(17422),h=e(33390),o=e(14792),m=e(34214),u=e(6473),p=e(53001),f=e(80484),y=e(28444),x=e(13530),v=e(74848),P=e(63021),E=e(40675),D=e(87978),C=e(54943),b=e(76459),T=e.n(b),S=e(96540),O=e(49785),M=e(13544),I=e(55852),L=e(42418),B=e(67061),j=e(88575),A=e(10354),K=e(21744),W=e(15292),U=e(90613),F=e(60029),V=e(36607),w=e(71500),z=e(17172),N=e(8484);function H(Qe){return(0,z.NF)(Qe)&&Qe.data&&Qe.data.status==="version-mismatch"}function Q(Qe){return(0,z.NF)(Qe)&&Qe.data&&Qe.data.status==="name-exists"}function X(Qe){return(0,z.NF)(Qe)&&Qe.data&&Qe.data.status==="plugin-dashboard"}function ee({cancelButton:Qe,saveButton:je}){return r.$.featureToggles.dashboardRestore&&r.$.featureToggles.dashboardRestoreUI?(0,v.jsxs)(L.F,{title:(0,N.t)("save-dashboards.name-exists.title","Dashboard name already exists"),severity:"error",children:[(0,v.jsx)("p",{children:(0,v.jsx)(N.x6,{i18nKey:"save-dashboards.name-exists.message-info",children:"A dashboard with the same name in the selected folder already exists, including recently deleted dashboards."})}),(0,v.jsx)("p",{children:(0,v.jsx)(N.x6,{i18nKey:"save-dashboards.name-exists.message-suggestion",children:"Please choose a different name or folder."})})]}):(0,v.jsxs)(L.F,{title:"Name already exists",severity:"error",children:[(0,v.jsx)("p",{children:"A dashboard with the same name in selected folder already exists. Would you still like to save this dashboard?"}),(0,v.jsx)(U.a,{paddingTop:2,children:(0,v.jsxs)(B.B,{alignItems:"center",children:[Qe,je(!0)]})})]})}function Z({overwrite:Qe,isLoading:je,isValid:qe,onSave:dt}){return(0,v.jsx)(I.$n,{disabled:!qe||je,icon:je?"spinner":void 0,onClick:()=>dt(Qe),variant:Qe?"destructive":"primary","data-testid":M.Tp.components.Drawer.DashboardSaveDrawer.saveButton,children:je?"Saving...":Qe?"Save and overwrite":"Save"})}var q=e(41053),ae=e(14110),k=e(3169),se=e(91219),te=e(55314),ne=e(31678),le=e(36974);function re(Qe=!1){const je=(0,ne.useDispatch)(),qe=(0,k._2)(),[dt]=(0,te.e8)(),[Lt,Vt]=(0,q.A)(async(Gt,en,bn)=>{{const En=await dt({dashboard:en,folderUid:bn.folderUid,message:bn.message,overwrite:bn.overwrite,showErrorAlert:!1,k8s:void 0});if("error"in En)throw En.error;const rs=En.data;Gt.saveCompleted(en,rs,bn.folderUid),l.A.publish(new y.Eu),qe.success("Dashboard saved"),(0,le.ko)(rs.uid),Qe?(0,ae.rR)("grafana_dashboard_copied",{name:en.title,url:rs.url}):(0,ae.rR)(`grafana_dashboard_${rs.uid?"saved":"created"}`,{name:en.title,url:rs.url});const js=a.Ny.getLocation(),Xs=t.I.stripBaseFromUrl(rs.url);return Xs!==js.pathname&&setTimeout(()=>{a.Ny.push({pathname:Xs,search:js.search})}),Gt.state.meta.isStarred&&je((0,se.TU)({id:rs.uid,title:Gt.state.title,url:Xs})),En.data}},[je,qe]);return{state:Lt,onSaveDashboard:Vt}}function de({dashboard:Qe,changeInfo:je}){const{changedSaveModel:qe}=je,{register:dt,handleSubmit:Lt,setValue:Vt,formState:Gt,getValues:en,watch:bn}=(0,O.mN)({mode:"onBlur",defaultValues:{title:je.isNew?qe.title:`${qe.title} Copy`,description:qe.description??"",folder:{uid:Qe.state.meta.folderUid,title:Qe.state.meta.folderTitle},copyTags:!1}}),{errors:En,isValid:rs,defaultValues:js}=Gt,Xs=bn(),{state:Ss,onSaveDashboard:Ys}=re(!1),[ea,_s]=(0,S.useState)({}),[qs,sa]=(0,S.useState)(!1),Va=async Ma=>{const Ta=en(),ya=pe(qe,Ta,je.isNew);(await Ys(Qe,ya,{overwrite:Ma,folderUid:Ta.folder.uid})).status==="success"?Qe.closeModal():_s({title:Ta.title,folderUid:Ta.folder.uid})},Zs=(0,v.jsx)(I.$n,{variant:"secondary",onClick:()=>Qe.closeModal(),fill:"outline",children:"Cancel"}),ba=Ma=>{const Ta=!rs&&qs?!0:rs;return(0,v.jsx)(Z,{isValid:Ta,isLoading:Ss.loading,onSave:Va,overwrite:Ma})};function ur(Ma){const Ta=Xs.title.trim()===ea.title&&Xs.folder.uid===ea.folderUid;return Q(Ma)&&Ta?(0,v.jsx)(ee,{cancelButton:Zs,saveButton:ba}):(0,v.jsxs)(v.Fragment,{children:[Ma&&Ta&&(0,v.jsx)(L.F,{title:"Failed to save dashboard",severity:"error",children:Ma.message&&(0,v.jsx)("p",{children:Ma.message})}),(0,v.jsxs)(B.B,{alignItems:"center",children:[Zs,ba(!1)]})]})}return(0,v.jsxs)("form",{onSubmit:Lt(()=>Va(!1)),children:[(0,v.jsx)(j.D,{label:(0,v.jsx)(oe,{dashboard:qe,onChange:Vt}),invalid:!!En.title,error:En.title?.message,children:(0,v.jsx)(A.p,{...dt("title",{required:"Required",validate:ce}),"aria-label":"Save dashboard title field","data-testid":M.Tp.components.Drawer.DashboardSaveDrawer.saveAsTitleInput,onChange:T()(async Ma=>{Vt("title",Ma.target.value,{shouldValidate:!0})},400)})}),(0,v.jsx)(j.D,{label:(0,v.jsx)(J,{dashboard:qe,onChange:Vt}),invalid:!!En.description,error:En.description?.message,children:(0,v.jsx)(K.f,{...dt("description",{required:!1}),"aria-label":"Save dashboard description field",autoFocus:!0})}),(0,v.jsx)(j.D,{label:"Folder",children:(0,v.jsx)(V.d,{onChange:(Ma,Ta)=>{Vt("folder",{uid:Ma,title:Ta});const ya=Qe.state.meta.folderUid;sa(Ma!==ya)},value:Xs.folder?.uid,initialTitle:js.folder.title,dashboardId:qe.id??void 0,enableCreateNew:!0})}),!je.isNew&&(0,v.jsx)(j.D,{label:"Copy tags",children:(0,v.jsx)(W.d,{...dt("copyTags")})}),(0,v.jsx)(U.a,{paddingTop:2,children:ur(Ss.error)})]})}function oe(Qe){return(0,v.jsx)(B.B,{justifyContent:"space-between",children:(0,v.jsx)(F.J,{htmlFor:"description",children:"Title"})})}function J(Qe){return(0,v.jsx)(B.B,{justifyContent:"space-between",children:(0,v.jsx)(F.J,{htmlFor:"description",children:"Description"})})}async function ce(Qe,je){if(Qe===je.folder.title?.trim())return"Dashboard name cannot be the same as folder name";try{return await w.P.validateNewDashboardName(je.folder.uid??"general",Qe),!0}catch(qe){return qe instanceof Error?qe.message:"Dashboard name is invalid"}}function pe(Qe,je,qe){return{...Qe,id:null,uid:"",title:je.title,description:je.description,tags:qe||je.copyTags?Qe.tags:[]}}var xe=e(10880);function fe({dashboard:Qe,drawer:je,changeInfo:qe}){const{changedSaveModel:dt,hasChanges:Lt}=qe,{state:Vt,onSaveDashboard:Gt}=re(!1),[en,bn]=(0,S.useState)({folderUid:Qe.state.meta.folderUid}),En=async Ss=>{(await Gt(Qe,dt,{...en,overwrite:Ss})).status==="success"&&(Qe.closeModal(),je.state.onSaveSuccess?.())},rs=(0,v.jsx)(I.$n,{variant:"secondary",onClick:()=>Qe.closeModal(),fill:"outline",children:"Cancel"}),js=Ss=>(0,v.jsx)(Z,{isValid:Lt,isLoading:Vt.loading,onSave:En,overwrite:Ss});function Xs(Ss){return H(Ss)?(0,v.jsxs)(L.F,{title:"Someone else has updated this dashboard",severity:"error",children:[(0,v.jsx)("p",{children:"Would you still like to save this dashboard?"}),(0,v.jsx)(U.a,{paddingTop:2,children:(0,v.jsxs)(B.B,{alignItems:"center",children:[rs,js(!0)]})})]}):Q(Ss)?(0,v.jsx)(ee,{cancelButton:rs,saveButton:js}):X(Ss)?(0,v.jsxs)(L.F,{title:"Plugin dashboard",severity:"error",children:[(0,v.jsxs)("p",{children:["Your changes will be lost when you update the plugin. Use ",(0,v.jsx)("strong",{children:"Save As"})," to create custom version."]}),(0,v.jsx)(U.a,{paddingTop:2,children:(0,v.jsxs)(B.B,{alignItems:"center",children:[rs,js(!0)]})})]}):(0,v.jsxs)(v.Fragment,{children:[Ss&&(0,v.jsx)(L.F,{title:"Failed to save dashboard",severity:"error",children:(0,v.jsx)("p",{children:Ss.message})}),(0,v.jsxs)(B.B,{alignItems:"center",children:[rs,js(!1),!Lt&&(0,v.jsx)("div",{children:"No changes to save"})]})]})}return(0,v.jsxs)(B.B,{gap:2,direction:"column",children:[(0,v.jsx)(Ee,{drawer:je,changeInfo:qe}),(0,v.jsx)(j.D,{label:"Message",children:(0,v.jsx)(K.f,{"aria-label":"message",value:en.message??"",onChange:Ss=>{bn({...en,message:Ss.currentTarget.value})},placeholder:"Add a note to describe your changes (optional).",autoFocus:!0,rows:5})}),Xs(Vt.error)]})}function Ee({drawer:Qe,changeInfo:je}){const{saveVariables:qe=!1,saveTimeRange:dt=!1,saveRefresh:Lt=!1}=Qe.useState(),{hasTimeChanges:Vt,hasVariableValueChanges:Gt,hasRefreshChange:en}=je;return(0,v.jsxs)(B.B,{direction:"column",alignItems:"flex-start",children:[Vt&&(0,v.jsx)(xe.S,{id:"save-timerange",checked:dt,onChange:Qe.onToggleSaveTimeRange,label:"Update default time range",description:"Will make current time range the new default","data-testid":M.Tp.pages.SaveDashboardModal.saveTimerange}),en&&(0,v.jsx)(xe.S,{id:"save-refresh",label:"Update default refresh value",description:"Will make the current refresh the new default",checked:Lt,onChange:Qe.onToggleSaveRefresh,"data-testid":M.Tp.pages.SaveDashboardModal.saveRefresh}),Gt&&(0,v.jsx)(xe.S,{id:"save-variables",label:"Update default variable values",description:"Will make the current values the new default",checked:qe,onChange:Qe.onToggleSaveVariables,"data-testid":M.Tp.pages.SaveDashboardModal.saveVariables})]})}var Se=e(32196),ye=e(4213),Ve=e.n(ye),Me=e(70713),Ce=e(32372),Ue=e(10534);function Ae({dashboard:Qe,drawer:je,changeInfo:qe}){const dt=(0,S.useMemo)(()=>JSON.stringify(qe.changedSaveModel,null,2),[qe]),Lt=(0,S.useCallback)(()=>{const Vt=new Blob([dt],{type:"application/json;charset=utf-8"});(0,ye.saveAs)(Vt,qe.changedSaveModel.title+"-"+new Date().getTime()+".json")},[qe.changedSaveModel,dt]);return(0,v.jsx)("div",{className:we.container,children:(0,v.jsxs)(B.B,{direction:"column",gap:2,grow:1,children:[(0,v.jsxs)("div",{children:["This dashboard cannot be saved from the Grafana UI because it has been provisioned from another source. Copy the JSON or save it to a file below, then you can update your dashboard in the provisioning source.",(0,v.jsx)("br",{}),(0,v.jsxs)("i",{children:["See"," ",(0,v.jsx)("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",target:"_blank",rel:"noreferrer",children:"documentation"})," ","for more information about provisioning."]}),(0,v.jsx)("br",{})," ",(0,v.jsx)("br",{}),(0,v.jsx)("strong",{children:"File path: "})," ",Qe.state.meta.provisionedExternalId]}),(0,v.jsx)(Ee,{drawer:je,changeInfo:qe}),(0,v.jsx)("div",{className:we.json,children:(0,v.jsx)(Me.Ay,{disableWidth:!0,children:({height:Vt})=>(0,v.jsx)(Ce.B,{width:"100%",height:Vt,language:"json",showLineNumbers:!0,showMiniMap:dt.length>100,value:dt,readOnly:!0})})}),(0,v.jsx)(U.a,{paddingTop:2,children:(0,v.jsxs)(B.B,{gap:2,children:[(0,v.jsx)(I.$n,{variant:"secondary",onClick:je.onClose,fill:"outline",children:"Cancel"}),(0,v.jsx)(Ue.b,{icon:"copy",getText:()=>dt,children:"Copy JSON to clipboard"}),(0,v.jsx)(I.$n,{type:"submit",onClick:Lt,children:"Save JSON to file"})]})})]})})}const we={container:(0,Se.css)({height:"100%",display:"flex"}),json:(0,Se.css)({flexGrow:1,maxHeight:"800px"})};var We=e(20455),_e=e(45429);function at(Qe,je,qe,dt){const Lt=(0,_e.Yy)(Qe.getInitialSaveModel(),(0,We.Uy)(Qe),je,qe,dt),Vt=Qe.getInitialState()?.meta.folderUid!==Qe.state.meta.folderUid;return{...Lt,hasFolderChanges:Vt,hasChanges:Lt.hasChanges||Vt}}class ut extends i.Bs{constructor(){super(...arguments),this.onClose=()=>{this.state.dashboardRef.resolve().setState({overlay:void 0})},this.onToggleSaveTimeRange=()=>{this.setState({saveTimeRange:!this.state.saveTimeRange})},this.onToggleSaveVariables=()=>{this.setState({saveVariables:!this.state.saveVariables})},this.onToggleSaveRefresh=()=>{this.setState({saveRefresh:!this.state.saveRefresh})}}static{this.Component=({model:je})=>{const{showDiff:qe,saveAsCopy:dt,saveTimeRange:Lt,saveVariables:Vt,saveRefresh:Gt}=je.useState(),en=at(je.state.dashboardRef.resolve(),Lt,Vt,Gt),{changedSaveModel:bn,initialSaveModel:En,diffs:rs,diffCount:js,hasFolderChanges:Xs}=en,Ss=js+(Xs?1:0),Ys=je.state.dashboardRef.resolve(),{meta:ea}=Ys.useState(),{provisioned:_s,folderTitle:qs}=ea,sa=(0,v.jsxs)(P.U,{children:[(0,v.jsx)(E.o,{label:"Details",active:!qe,onChangeTab:()=>je.setState({showDiff:!1})}),Ss>0&&(0,v.jsx)(E.o,{label:"Changes",active:qe,onChangeTab:()=>je.setState({showDiff:!0}),counter:Ss})]});let Va="Save dashboard";dt?Va="Save dashboard copy":_s&&(Va="Provisioned dashboard");const Zs=()=>qe?(0,v.jsx)(C.l,{diff:rs,oldValue:En,newValue:bn,hasFolderChanges:Xs,oldFolder:Ys.getInitialState()?.meta.folderTitle,newFolder:qs}):dt||en.isNew?(0,v.jsx)(de,{dashboard:Ys,changeInfo:en}):_s?(0,v.jsx)(Ae,{dashboard:Ys,changeInfo:en,drawer:je}):(0,v.jsx)(fe,{dashboard:Ys,changeInfo:en,drawer:je});return(0,v.jsx)(D._,{title:Va,subtitle:Ys.state.title,onClose:je.onClose,tabs:sa,children:Zs()})}}}var Tt=e(19997),It=e(57714),ge=e(64423),Ie=e(18226),ue=e(94624),me=e(72724),Pe=e(13989),Ne=e(53543),Fe=e(74730);class Be{constructor(je){this._scene=je,this.events=new Ie.o,this._subs=new ge.yU;const qe=i.jh.getTimeRange(je);this.formatDate=this.formatDate.bind(this),this._subs.add(qe.subscribeToState((dt,Lt)=>{dt.value!==Lt.value&&this.events.publish(new g.sR(dt.value))}))}get id(){return this._scene.state.id??null}get uid(){return this._scene.state.uid??null}get title(){return this._scene.state.title}get description(){return this._scene.state.description}get editable(){return this._scene.state.editable}get graphTooltip(){return this._getSyncMode()}get timepicker(){return{refresh_intervals:this._scene.state.controls.state.refreshPicker.state.intervals,hidden:this._scene.state.controls.state.hideTimeControls??!1}}get timezone(){return this.getTimezone()}get weekStart(){return i.jh.getTimeRange(this._scene).state.weekStart}get tags(){return this._scene.state.tags}get links(){return this._scene.state.links}get meta(){return this._scene.state.meta}get time(){const je=i.jh.getTimeRange(this._scene);return{from:je.state.from,to:je.state.to}}get panels(){return he(this._scene,qe=>qe instanceof i.Eb).map(qe=>new Ne.R(qe))}get annotations(){const je={list:[]};return this._scene.state.$data instanceof i.kh&&(je.list=(0,Pe.O)(this._scene.state.$data.state.layers)),je}getTimezone(){return i.jh.getTimeRange(this._scene).getTimeZone()}sharedTooltipModeEnabled(){return this._getSyncMode()>0}sharedCrosshairModeOnly(){return this._getSyncMode()===1}_getSyncMode(){if(this._scene.state.$behaviors){for(const je of this._scene.state.$behaviors)if(je instanceof i.Gg.K2)return je.state.sync}return ue.y.Off}otherPanelInFullscreen(je){return!1}formatDate(je,qe){return(0,me.LE)(je,{format:qe,timeZone:this.getTimezone()})}getPanelById(je){const qe=(0,Fe.vL)(this._scene,(0,Fe.XA)(je));return qe?new Ne.R(qe):null}removePanel(je){const qe=(0,Fe.vL)(this._scene,(0,Fe.XA)(je.id));if(!qe){console.error("Trying to remove a panel that was not found in scene",je);return}this._scene.removePanel(qe)}canEditAnnotations(je){return this._scene.canEditDashboard()?je?!!this._scene.state.meta.annotationsPermissions?.dashboard.canEdit:!!this._scene.state.meta.annotationsPermissions?.organization.canEdit:!1}panelInitialized(){}destroy(){this.events.removeAllListeners(),this._subs.unsubscribe()}hasUnsavedChanges(){return this._scene.state.isDirty}}function he(Qe,je){let qe=[];return Qe.forEachChild(dt=>{je(dt)?qe.push(dt):qe=qe.concat(he(dt,je))}),qe}var be=e(32023);function Ke(Qe){let je=5381;for(let qe=0;qe<Qe.length;qe++)je=je*33^Qe.charCodeAt(qe);return je>>>0}var ze=e(11982),nt=e(16678),tt=e(41507),ot=e(68435);class gt extends i.Bs{constructor(){super(...arguments),this.onClose=()=>{(0,Fe.YQ)(this).closeModal()},this.onAddLibraryPanel=je=>{const qe=(0,Fe.YQ)(this),dt=(0,Fe.O8)(qe);dt.setState({$behaviors:[new ot.u({uid:je.uid,name:je.name})]});const Lt=this.state.panelToReplaceRef?.resolve();if(Lt){const Vt=Lt.parent;if(!(Vt instanceof tt.U))throw new Error("Trying to replace a panel that does not have a DashboardGridItem");Vt.setState({body:dt})}else qe.addPanel(dt);this.onClose()}}static{this.Component=({model:je})=>{const qe=(0,N.t)("library-panel.add-widget.title","Add panel from panel library");return(0,v.jsx)(D._,{title:qe,onClose:je.onClose,children:(0,v.jsx)(nt.j,{onClick:je.onAddLibraryPanel,variant:nt.s.Tight,showPanelFilter:!0})})}}}var He=e(54148),et=e(64388),rt=e(23172),ht=e(40845),ft=e(57571),De=e(27673),Te=e(21780),Oe=e(7392),Ye=e(68064),Ge=e(70453),Je=e(46942),it=e.n(Je),St=e(77517);const zt="--panels-per-row";function Kt({dashboard:Qe,panelSearch:je="",panelsPerRow:qe}){const{body:dt}=Qe.state,Lt=[],Vt=(0,ht.of)(an),Gt=dt instanceof St.D?dt.state.grid:null;if(!Gt)return(0,v.jsx)(N.x6,{i18nKey:"panel-search.unsupported-layout",children:"Unsupported layout"});for(const en of Gt.state.children)if(en instanceof tt.U)Nn(en,Qe,je,Lt);else if(en instanceof i.tI)for(const bn of en.state.children)bn instanceof tt.U&&Nn(bn,Qe,je,Lt);return Lt.length>0?(0,v.jsx)("div",{className:it()(Vt.grid,{[Vt.perRow]:qe!==void 0}),style:{[zt]:qe},children:Lt.map(en=>(0,v.jsx)(Qt,{panel:en},en.state.key))}):(0,v.jsx)("p",{className:Vt.noHits,children:(0,v.jsx)(N.x6,{i18nKey:"panel-search.no-matches",children:"No matches found"})})}function Qt({panel:Qe}){return(0,S.useEffect)(()=>(0,Fe.M6)(Qe),[Qe]),(0,v.jsx)(Qe.Component,{model:Qe})}function an(Qe){return{grid:(0,Se.css)({display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(400px, 1fr))",gap:Qe.spacing(1),gridAutoRows:"320px"}),perRow:(0,Se.css)({gridTemplateColumns:`repeat(var(${zt}, 3), 1fr)`}),noHits:(0,Se.css)({display:"grid",placeItems:"center"})}}function Nn(Qe,je,qe,dt){const Lt=i.jh.interpolate(je,qe).toLowerCase();if(Qe.state.variableName&&!Qe.isActive){const Gt=Qe.state.body;Gt.interpolate(Gt.state.title,void 0,"text").toLowerCase().includes(Lt)&&Qe.activate()}const Vt=Qe.state.repeatedPanels??[Qe.state.body];for(const Gt of Vt)Gt.interpolate(Gt.state.title,void 0,"text").toLowerCase().includes(Lt)&&dt.push(Gt);return dt}var zn=e(84423),Yn=e(66827);const ss=({dashboard:Qe})=>{const qe=Qe.getDashboardPanels().some(Lt=>Lt instanceof i.Eb?zn.vI.includes(Lt.state.pluginId):!1);return r.$.featureToggles.angularDeprecationUI&&Qe.hasDashboardAngularPlugins()&&Qe.state.uid?(0,v.jsx)(Yn.j,{dashboardUid:Qe.state.uid,showAutoMigrateLink:qe},Qe.state.uid):null};function ds({model:Qe}){const{controls:je,overlay:qe,editview:dt,editPanel:Lt,isEmpty:Vt,meta:Gt,viewPanelScene:en,panelSearch:bn,panelsPerRow:En}=Qe.useState(),rs=(0,rt.k)(),js=(0,ht.of)(Ms,rs??0),Xs=(0,He.zy)(),Ss=(0,ne.useSelector)(ya=>ya.navIndex),Ys=Qe.getPageNav(Xs,Ss),ea=Qe.getBodyToRender(),_s=(0,c.tc)(Ss,"dashboards/browse"),qs=je?.hasControls(),sa=dt!==void 0,Va=r.$.featureToggles.singleTopNav;if((0,S.useMemo)(()=>{(en||sa||Lt)&&Qe.rememberScrollPos()},[sa,Lt,en,Qe]),(0,S.useEffect)(()=>{!en&&!sa&&!Lt&&Qe.restoreScrollPos()},[sa,Lt,en,Qe]),dt)return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(dt.Component,{model:dt}),qe&&(0,v.jsx)(qe.Component,{model:qe})]});const Zs=(0,v.jsx)(Ye.A,{dashboard:Qe,canCreate:!!Qe.state.meta.canEdit},"dashboard-empty-state"),ba=(0,v.jsx)("div",{className:(0,Se.cx)(js.body,!qs&&js.bodyWithoutControls),children:(0,v.jsx)(ea.Component,{model:ea})},"dashboard-panels"),ur=Gt.dashboardNotFound&&(0,v.jsx)(Oe.L,{entity:"Dashboard"},"dashboard-not-found");let Ta=[(0,v.jsx)(ss,{dashboard:Qe},"angular-deprecation-banner"),ba];return ur?Ta=[ur]:Vt?Ta=[Zs,ba]:(bn||En)&&(Ta=(0,v.jsx)(Kt,{panelSearch:bn,panelsPerRow:En,dashboard:Qe})),(0,v.jsxs)(Te.YW,{navModel:_s,pageNav:Ys,layout:et.k.Custom,toolbar:Va?(0,v.jsx)(Ge.v,{dashboard:Qe}):void 0,children:[Lt&&(0,v.jsx)(Lt.Component,{model:Lt}),!Lt&&(0,v.jsx)(De.A,{divId:"page-scrollbar",onSetScrollRef:Qe.onSetScrollRef,children:(0,v.jsxs)("div",{className:(0,Se.cx)(js.pageContainer,qs&&js.pageContainerWithControls),children:[!Va&&(0,v.jsx)(Ge.c,{dashboard:Qe}),je&&(0,v.jsx)("div",{className:js.controlsWrapper,children:(0,v.jsx)(je.Component,{model:je})}),(0,v.jsx)("div",{className:(0,Se.cx)(js.canvasContent),children:Ta})]})}),qe&&(0,v.jsx)(qe.Component,{model:qe})]})}function Ms(Qe,je){return{pageContainer:(0,Se.css)({display:"grid",gridTemplateAreas:`
  "panels"`,gridTemplateColumns:"1fr",gridTemplateRows:"1fr",flexGrow:1,[Qe.breakpoints.down("sm")]:{display:"flex",flexDirection:"column"}}),pageContainerWithControls:(0,Se.css)({gridTemplateAreas:`
        "controls"
        "panels"`,gridTemplateRows:"auto 1fr"}),controlsWrapper:(0,Se.css)({display:"flex",flexDirection:"column",flexGrow:0,gridArea:"controls",padding:Qe.spacing(2),":empty":{display:"none"},[Qe.breakpoints.up("md")]:{position:"sticky",zIndex:Qe.zIndex.activePanel,background:Qe.colors.background.canvas,top:r.$.featureToggles.singleTopNav?je+ft.l:je}}),canvasContent:(0,Se.css)({label:"canvas-content",display:"flex",flexDirection:"column",padding:Qe.spacing(.5,2),flexBasis:"100%",gridArea:"panels",flexGrow:1,minWidth:0}),body:(0,Se.css)({label:"body",flexGrow:1,display:"flex",gap:"8px",paddingBottom:Qe.spacing(2),boxSizing:"border-box"}),bodyWithoutControls:(0,Se.css)({paddingTop:Qe.spacing(2)})}}var Bs=e(65123),gs=e(54612),Zn=e(16560),Ls=e(29678),Ln=e(14578),Hn=e(62930),Qn=e(90182),mt=e(16233),Yt=e(83195),on=e(2619),ln=e(2543),fn=e(89667),yn=e(52622),wn=e(39070),Xn=e(68706),xn=e(41524);function Ut(Qe){const je=[];if(Qe?.series)for(const qe of Qe.series)je.push((0,fn.Nw)(qe));if(Qe?.annotations)for(const qe of Qe.annotations){const dt=(0,fn.Nw)(qe);dt.schema?.meta||(dt.schema.meta={}),dt.schema.meta.dataTopic=yn.QR.Annotations,je.push(dt)}return je}function nn(Qe,je){const qe={panelType:Qe.state.pluginId,datasource:"??"},dt=r.$.buildInfo.versionString;let Lt=`| Key | Value |
|--|--|
| Panel | ${qe.panelType} @ ${Qe.state.pluginVersion??dt} |
| Grafana | ${dt} // ${r.$.buildInfo.edition} |
`;return je&&(Lt+="<details><summary>Panel debug snapshot dashboard</summary>\n\n```json\n"+je+"\n```\n</details>"),Lt}async function hn(Qe,je,qe){let dt={type:""};const Lt=Qe.parent;(0,Fe.ME)(Qe)?dt={...(0,We.ZB)(Lt),...(0,We.Z6)(Qe)}:dt=(0,We.ZB)(Lt);const Vt=(0,ln.cloneDeep)(Pt),Gt={panelType:Qe.state.pluginId,datasource:"??"},en=(0,Fe.un)(Qe);if(!en.state.data)return;const bn=en.state.data,En=en?.state.datasource,rs=(0,xn.W)(Ut(bn),je),js=r.$.buildInfo.versionString,Xs=en.state.queries??[],Ss=bn.annotations?bn.annotations.reduce((ea,_s)=>_s.length+ea,0):0,Ys=`<table width="100%">
    <tr>
      <th width="2%">Panel</th>
      <td >${Gt.panelType} @ ${dt.pluginVersion??js}</td>
    </tr>
    <tr>
      <th>Queries</th>
      <td>${Xs.map(ea=>{const _s=ea.datasource??En;return`${ea.refId}[${_s?.type}]`}).join(", ")}</td>
    </tr>
    ${dn(dt)}
    ${Sn(bn,rs)}
    ${es(bn)}
    <tr>
      <th>Grafana</th>
      <td>${js} // ${r.$.buildInfo.edition}</td>
    </tr>
  </table>`.trim();if(Vt.panels[0]={...dt,...Vt.panels[0],targets:[{refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:Xn.nj.Snapshot,snapshot:rs}]},delete Vt.panels[0].libraryPanel,dt.transformations?.length){const ea=Vt.panels[Vt.panels.length-1];ea.title=ea.title+" (after transformations)";const _s=(0,ln.cloneDeep)(ea);_s.id=100,_s.title="Data (before transformations)",_s.gridPos.w=24,_s.targets[0].withTransforms=!1,Vt.panels.push(_s)}return Ss>0&&Vt.panels.push({id:7,gridPos:{h:6,w:24,x:0,y:20},type:"table",title:"Annotations",datasource:{type:"datasource",uid:"-- Dashboard --"},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,topic:yn.QR.Annotations,refId:"A"}]}),Vt.panels[1].options.content=Ys,Vt.panels[2].options.content=JSON.stringify(dt,null,2),Vt.title=`Debug: ${dt.title} // ${(0,me.LE)(new Date)}`,Vt.tags=["debug",`debug-${Gt.panelType}`],Vt.time={from:qe.from.toISOString(),to:qe.to.toISOString()},Vt}function dn(Qe){return Qe.transformations?`<tr>
      <th>Transform</th>
      <td>${Qe.transformations.map(je=>je.id).join(", ")}</td>
  </tr>`:""}function Sn(Qe,je){let qe=Qe.series.length??0,dt=0,Lt=0;for(const Vt of Qe.series)dt+=Vt.fields.length,Lt+=Vt.length;return`<tr><th>Data</th><td>${Qe.state!==wn.Gu.Done?Qe.state:""} ${qe} frames, ${dt} fields, ${Lt} rows </td></tr>`}function es(Qe){return Qe.annotations?.length?`<tr>
  <th>Annotations</th>
  <td>${Qe.annotations.reduce((je,qe)=>qe.length+je,0)}</td>
</tr>`:""}const Pt={panels:[{id:2,title:"Reproduced with embedded data",datasource:{type:"grafana",uid:"grafana"},gridPos:{h:13,w:15,x:0,y:0}},{gridPos:{h:7,w:9,x:15,y:0},id:5,options:{content:"...",mode:"html"},title:"Debug info",type:"text"},{id:6,title:"Original Panel JSON",type:"text",gridPos:{h:13,w:9,x:15,y:7},options:{content:"...",mode:"code",code:{language:"json",showLineNumbers:!0,showMiniMap:!0}}},{id:3,title:"Data from panel above",type:"table",datasource:{type:"datasource",uid:"-- Dashboard --"},gridPos:{h:7,w:15,x:0,y:13},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,refId:"A"}]}],schemaVersion:37};var Ze=(Qe=>(Qe[Qe.Support=0]="Support",Qe[Qe.Data=1]="Data",Qe))(Ze||{}),lt=(Qe=>(Qe[Qe.PanelSnapshot=0]="PanelSnapshot",Qe[Qe.GithubComment=1]="GithubComment",Qe))(lt||{});class yt extends on.Q{constructor(je){super({panel:je,panelTitle:i.jh.interpolate(je,je.state.title,{},"text"),currentTab:0,showMessage:1,snapshotText:"",markdownText:"",randomize:{},snapshotUpdate:0,options:[{label:"GitHub comment",description:"Copy and paste this message into a GitHub issue or comment",value:1},{label:"Panel support snapshot",description:"Dashboard JSON used to help troubleshoot visualization issues",value:0}]}),this.onCurrentTabChange=qe=>{this.setState({currentTab:qe})},this.onShowMessageChange=qe=>{this.setState({showMessage:qe.value})},this.onGetMarkdownForClipboard=()=>{const{markdownText:qe}=this.state,dt=Math.pow(1024,2)*1.5;return qe.length>dt?(this.setState({error:{title:"Copy to clipboard failed",message:"Snapshot is too large, consider download and attaching a file instead"}}),""):qe},this.onDownloadDashboard=()=>{const{snapshotText:qe,panelTitle:dt}=this.state,Lt=new Blob([qe],{type:"text/plain"}),Vt=`debug-${dt}-${(0,me.LE)(new Date)}.json.txt`;Ve()(Lt,Vt)},this.onSetSnapshotText=qe=>{this.setState({snapshotText:qe})},this.onToggleRandomize=qe=>{const{randomize:dt}=this.state;this.setState({randomize:{...dt,[qe]:!dt[qe]}})}}async buildDebugDashboard(){const{panel:je,randomize:qe,snapshotUpdate:dt}=this.state,Lt=await hn(je,qe,i.jh.getTimeRange(je).state.value),Vt=JSON.stringify(Lt,null,2),Gt=nn(je,Vt),en=(0,Yt.cN)((0,Yt.j_)("bytes")(Vt?.length??0));let bn;if(Lt)try{bn=(0,Tt.wM)({dashboard:Lt,meta:{isEmbedded:!0}}).state.body}catch(En){console.log("Error creating scene:",En)}this.setState({snapshot:Lt,snapshotText:Vt,markdownText:Gt,snapshotSize:en,snapshotUpdate:dt+1,scene:bn})}}function Nt({panel:Qe,onClose:je}){const qe=(0,ht.of)(wt),dt=(0,S.useMemo)(()=>new yt(Qe),[Qe]),Lt=Qe.getPlugin(),{currentTab:Vt,loading:Gt,error:en,options:bn,showMessage:En,snapshotSize:rs,markdownText:js,snapshotText:Xs,randomize:Ss,panelTitle:Ys,scene:ea}=dt.useState();if((0,S.useEffect)(()=>{dt.buildDebugDashboard()},[dt,Lt,Ss]),!Lt)return null;const _s=[{label:"Snapshot",value:Ze.Support},{label:"Data",value:Ze.Data}],qs=r.$.supportBundlesEnabled&&mt.TP.hasPermission(ne.AccessControlAction.ActionSupportBundlesCreate);return(0,v.jsxs)(D._,{title:"Get help with this panel",size:"lg",onClose:je,subtitle:(0,v.jsxs)(B.B,{direction:"column",gap:1,children:[(0,v.jsxs)(B.B,{direction:"row",gap:1,children:[(0,v.jsx)(Ls.y,{featureState:s.Ay.beta}),(0,v.jsxs)("a",{href:"https://grafana.com/docs/grafana/latest/troubleshooting/",target:"blank",className:"external-link",rel:"noopener noreferrer",children:["Troubleshooting docs ",(0,v.jsx)(Ln.I,{name:"external-link-alt"})]})]}),(0,v.jsx)("span",{className:"muted",children:"To request troubleshooting help, send a snapshot of this panel to Grafana Labs Technical Support. The snapshot contains query response data and panel settings."}),qs&&(0,v.jsxs)("span",{className:"muted",children:["You can also retrieve a support bundle containing information concerning your Grafana instance and configured datasources in the ",(0,v.jsx)("a",{href:"/support-bundles",children:"support bundles section"}),"."]})]}),tabs:(0,v.jsx)(P.U,{children:_s.map((sa,Va)=>(0,v.jsx)(E.o,{label:sa.label,active:sa.value===Vt,onChangeTab:()=>dt.onCurrentTabChange(sa.value)},`${sa.value}-${Va}`))}),children:[Gt&&(0,v.jsx)(Hn.y,{}),en&&(0,v.jsx)(L.F,{title:en.title,children:en.message}),Vt===Ze.Data&&(0,v.jsxs)("div",{className:qe.code,children:[(0,v.jsxs)("div",{className:qe.opts,children:[(0,v.jsx)(j.D,{label:"Template",className:qe.field,children:(0,v.jsx)(Qn.l6,{options:bn,value:En,onChange:dt.onShowMessageChange})}),En===lt.GithubComment?(0,v.jsx)(Ue.b,{icon:"copy",getText:dt.onGetMarkdownForClipboard,children:"Copy to clipboard"}):(0,v.jsxs)(I.$n,{icon:"download-alt",onClick:dt.onDownloadDashboard,children:["Download (",rs,")"]})]}),(0,v.jsx)(Me.Ay,{disableWidth:!0,children:({height:sa})=>(0,v.jsx)(Ce.B,{width:"100%",height:sa,language:En===lt.GithubComment?"markdown":"json",showLineNumbers:!0,showMiniMap:!0,value:En===lt.GithubComment?js:Xs,readOnly:!1,onBlur:dt.onSetSnapshotText})})]}),Vt===Ze.Support&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(j.D,{label:"Randomize data",description:"Modify the original data to hide sensitive information.  Note the lengths will stay the same, and duplicate values will be equal.",children:(0,v.jsxs)(B.B,{children:[(0,v.jsx)(W.K,{label:"Labels",id:"randomize-labels",showLabel:!0,value:!!Ss.labels,onChange:()=>dt.onToggleRandomize("labels")}),(0,v.jsx)(W.K,{label:"Field names",id:"randomize-field-names",showLabel:!0,value:!!Ss.names,onChange:()=>dt.onToggleRandomize("names")}),(0,v.jsx)(W.K,{label:"String values",id:"randomize-string-values",showLabel:!0,value:!!Ss.values,onChange:()=>dt.onToggleRandomize("values")})]})}),(0,v.jsx)(j.D,{label:"Support snapshot",description:`Panel: ${Ys}`,children:(0,v.jsxs)(B.B,{children:[(0,v.jsxs)(I.$n,{icon:"download-alt",onClick:dt.onDownloadDashboard,children:["Dashboard (",rs,")"]}),(0,v.jsx)(Ue.b,{icon:"github",getText:dt.onGetMarkdownForClipboard,title:"Copy a complete GitHub comment to the clipboard",children:"Copy to clipboard"})]})}),(0,v.jsx)(Me.Ay,{disableWidth:!0,children:({height:sa})=>(0,v.jsx)("div",{style:{height:sa,overflow:"auto"},children:ea&&(0,v.jsx)(ea.Component,{model:ea})})})]})]})}const wt=Qe=>({code:(0,Se.css)({flexGrow:1,height:"100%",overflow:"scroll"}),field:(0,Se.css)({width:"100%"}),opts:(0,Se.css)({display:"flex",width:"100%",flexGrow:0,alignItems:"center",justifyContent:"flex-end","& button":{marginLeft:Qe.spacing(1)}})});var Zt=e(61453);class pn extends i.Bs{constructor(je){super({...je,options:{withTransforms:!1,withFieldConfig:!0}}),this.onOptionsChange=qe=>{this.setState({options:qe})}}getTabLabel(){return(0,N.t)("dashboard.inspect.data-tab","Data")}getTabValue(){return Zn.q.Data}static{this.Component=({model:je})=>{const{options:qe}=je.useState(),dt=je.state.panelRef.resolve(),Lt=i.jh.getData(dt),{data:Vt}=An(Lt,qe.withTransforms).useState(),Gt=i.jh.getTimeRange(dt);return(0,v.jsx)(Zt.q,{isLoading:Vt?.state===wn.Gu.Loading,data:Vt?.series,options:qe,hasTransformations:On(Lt),timeZone:Gt.getTimeZone(),panelPluginId:dt.state.pluginId,dataName:dt.state.title,fieldConfig:dt.state.fieldConfig,onOptionsChange:je.onOptionsChange})}}}function On(Qe){return Qe instanceof i.Es?Qe.state.transformations.length>0:!1}function An(Qe,je){return!je&&Qe instanceof i.Es&&Qe.state.$data?Qe.state.$data:Qe}var qn=e(18803),cs=e(26323),Os=e(77938),xs=e(6204);class zs extends i.Bs{constructor(je){super({...je,source:"panel-json",jsonText:Ks("panel-json",je.panelRef.resolve())}),this.onChangeSource=qe=>{this.setState({source:qe.value,jsonText:Ks(qe.value,this.state.panelRef.resolve())})},this.onApplyChange=()=>{const qe=this.state.panelRef.resolve(),dt=(0,Fe.YQ)(qe),Lt=JSON.parse(this.state.jsonText),Vt=new m.a(Lt),Gt=(0,Tt.tt)(Vt),en=i.Go.cloneSceneObjectState(Gt.state);if(!(qe.parent instanceof tt.U)){console.error("Cannot update state of panel",qe,Gt);return}this.state.onClose(),dt.state.isEditing||dt.onEnterEditMode(),qe.parent.setState(en),(0,xs.B9)(Zn.q.JSON,"apply",{panel_type_changed:qe.state.pluginId!==Vt.type,panel_id_changed:(0,Fe.Cs)(qe)!==Vt.id,panel_grid_pos_changed:Ua(qe.parent.state,en),panel_targets_changed:Ra((0,Fe.un)(qe),(0,Fe.un)(en.$data))})},this.onCodeEditorBlur=qe=>{this.setState({jsonText:qe})}}getTabLabel(){return(0,N.t)("dashboard.inspect.json-tab","JSON")}getTabValue(){return Zn.q.JSON}getOptions(){const je=this.state.panelRef.resolve(),qe=je.state.$data??je.parent?.state.$data,dt=[{label:(0,N.t)("dashboard.inspect-json.panel-json-label","Panel JSON"),description:(0,N.t)("dashboard.inspect-json.panel-json-description","The model saved in the dashboard JSON that configures how everything works."),value:"panel-json"}];return qe&&(dt.push({label:(0,N.t)("dashboard.inspect-json.panel-data-label","Panel data"),description:(0,N.t)("dashboard.inspect-json.panel-data-description","The raw model passed to the panel visualization"),value:"panel-data"}),dt.push({label:(0,N.t)("dashboard.inspect-json.dataframe-label","DataFrame JSON (from Query)"),description:(0,N.t)("dashboard.inspect-json.dataframe-description","Raw data without transformations and field config applied. "),value:"data-frames"})),dt}isEditable(){if(this.state.source!=="panel-json")return!1;const je=this.state.panelRef.resolve();return(0,Fe.ME)(je)||je.parent instanceof tt.U&&je.parent.isRepeated()?!1:(0,Fe.YQ)(je).state.meta.canEdit}static{this.Component=({model:je})=>{const{source:qe,jsonText:dt}=je.useState(),Lt=(0,ht.of)(cs.A),Vt=je.getOptions();return(0,v.jsxs)("div",{className:Lt.wrap,children:[(0,v.jsxs)("div",{className:Lt.toolbar,"data-testid":M.Tp.components.PanelInspector.Json.content,children:[(0,v.jsx)(j.D,{label:(0,N.t)("dashboard.inspect-json.select-source","Select source"),className:"flex-grow-1",children:(0,v.jsx)(Qn.l6,{inputId:"select-source-dropdown",options:Vt,value:Vt.find(Gt=>Gt.value===qe)??Vt[0].value,onChange:je.onChangeSource})}),je.isEditable()&&(0,v.jsx)(I.$n,{className:Lt.toolbarItem,onClick:je.onApplyChange,children:"Apply"})]}),(0,v.jsx)("div",{className:Lt.content,children:(0,v.jsx)(Me.Ay,{disableWidth:!0,children:({height:Gt})=>(0,v.jsx)(Ce.B,{width:"100%",height:Gt,language:"json",showLineNumbers:!0,showMiniMap:dt.length>100,value:dt,readOnly:!je.isEditable(),onBlur:je.onCodeEditorBlur})})})]})}}}function Ks(Qe,je){let qe={};switch(Qe){case"panel-json":{(0,xs.B9)(Zn.q.JSON,"panelData");const dt=(0,Fe.ME)(je),Lt=je.parent;if(dt){qe=ma(je);break}Lt instanceof tt.U&&(qe=(0,We.ZB)(Lt));break}case"panel-data":{(0,xs.B9)(Zn.q.JSON,"panelJSON");const dt=i.jh.getData(je);dt.state.data&&(qe=je.applyFieldConfig(dt.state.data));break}case"data-frames":{(0,xs.B9)(Zn.q.JSON,"dataFrame");const dt=i.jh.getData(je);dt.state.data&&(dt instanceof i.Es&&dt.state.$data?.state.data?qe=(0,qn.B6)(dt.state.$data.state.data):qe=(0,qn.B6)(dt.state.data))}}return(0,Os.p)(qe)}function ma(Qe){if(!(0,Fe.ME)(Qe))throw"Panel not a library panel";const je=Qe.parent;if(!(je instanceof tt.U))throw"LibraryPanel not child of DashboardGridItem";const qe={x:je.state.x||0,y:je.state.y||0,h:je.state.height||0,w:je.state.width||0},dt=la(Qe),Lt=(0,We.Z6)(Qe.clone({$behaviors:void 0}),qe,!1,je);return{libraryPanel:{...dt},...Lt}}function la(Qe){if(!(0,Fe.ME)(Qe))throw new Error("Panel not a Library panel");const je=(0,Fe.iL)(Qe);if(!je)throw new Error("Library panel behavior not found");if(!je.state._loadedPanel)throw new Error("Library panel not loaded");return je.state._loadedPanel}function Ua(Qe,je){return Qe.x!==je.x||Qe.y!==je.y||Qe.width!==je.width||Qe.height!==je.height}function Ra(Qe,je){return Qe===void 0||je===void 0?!1:!(0,ln.isEqual)(Qe.state.queries,je.state.queries)}class Pa extends i.Bs{getTabLabel(){return(0,N.t)("dashboard.inspect.meta-tab","Meta data")}getTabValue(){return Zn.q.Meta}static{this.Component=({model:je})=>{const{panelRef:qe,dataSource:dt}=je.state,Lt=i.jh.getData(qe.resolve()),Vt=dt.components?.MetadataInspector;return!Lt.state.data||!Vt?null:(0,v.jsx)(Vt,{datasource:dt,data:Lt.state.data.series})}}}var wa=e(90820);class Ea extends i.Bs{constructor(){super(...arguments),this.onRefreshQuery=()=>{const je=(0,Fe.un)(this.state.panelRef.resolve());je&&je.runQueries()}}getTabLabel(){return(0,N.t)("dashboard.inspect.query-tab","Query")}getTabValue(){return Zn.q.Query}static{this.Component=({model:je})=>{const qe=i.jh.getData(je.state.panelRef.resolve()).useState();return qe.data?(0,v.jsx)(wa.e,{data:qe.data,onRefreshQuery:je.onRefreshQuery}):null}}}var Za=e(32067);class Na extends i.Bs{getTabLabel(){return(0,N.t)("dashboard.inspect.stats-tab","Stats")}getTabValue(){return Zn.q.Stats}static{this.Component=({model:je})=>{const qe=i.jh.getData(je.state.panelRef.resolve()).useState(),dt=i.jh.getTimeRange(je.state.panelRef.resolve());return qe.data?(0,v.jsx)(Za.N,{data:qe.data,timeZone:dt.getTimeZone()}):null}}}class gr extends i.Bs{constructor(je){super(je),this.onClose=()=>{const qe=(0,Fe.YQ)(this);a.Ny.push((0,ze.uZ)({uid:qe.state.uid,slug:qe.state.meta.slug,currentQueryParams:a.Ny.getLocation().search,updateQuery:{inspect:null,inspectTab:null}}))},this.addActivationHandler(()=>this._activationHandler())}static{this.Component=cr}_activationHandler(){this.buildTabs(0)}async buildTabs(je){const qe=this.state.panelRef,dt=qe.resolve()?.getPlugin(),Lt=[];if(dt||(je<2e3?setTimeout(()=>this.buildTabs(je+100),100):this.setState({pluginNotLoaded:!0})),qe){if((0,gs.$)(dt)){const Vt=i.jh.getData(qe.resolve());Lt.push(new pn({panelRef:qe})),Lt.push(new Na({panelRef:qe})),Lt.push(new Ea({panelRef:qe}));const Gt=await(0,Bs.BN)(Vt.state.data);Gt&&Lt.push(new Pa({panelRef:qe,dataSource:Gt}))}Lt.push(new zs({panelRef:qe,onClose:this.onClose}))}this.setState({tabs:Lt})}getDrawerTitle(){const je=this.state.panelRef?.resolve();return je?i.jh.interpolate(je,`Inspect: ${je.state.title}`):"Inspect panel"}}function cr({model:Qe}){const{tabs:je,pluginNotLoaded:qe,panelRef:dt}=Qe.useState(),Lt=(0,He.zy)(),Vt=new URLSearchParams(Lt.search);if(!je)return null;const Gt=Vt.get("inspectTab"),en=je.find(En=>En.getTabValue()===Gt)??je[0],bn=dt.resolve();return Gt===Zn.q.Help?(0,v.jsx)(Nt,{panel:bn,onClose:Qe.onClose}):(0,v.jsxs)(D._,{title:Qe.getDrawerTitle(),onClose:Qe.onClose,size:"md",tabs:(0,v.jsx)(P.U,{children:je.map(En=>(0,v.jsx)(E.o,{label:En.getTabLabel(),active:En===en,href:t.I.getUrlForPartial(Lt,{inspectTab:En.getTabValue()})},En.state.key))}),children:[qe&&(0,v.jsx)(L.F,{title:"Panel plugin not loaded",children:"Make sure the panel you want to inspect is visible and has been displayed before opening inspect."}),en&&en.Component&&(0,v.jsx)(en.Component,{model:en})]})}var Ha=e(34865),$a=e(10096),Xa=e(22391),_a=e(19347),vt=e(38477);class kt{constructor(je){this._scene=je}getKeys(){return["editIndex"]}getUrlState(){const je=this._scene.state;return{editIndex:je.editIndex!==void 0?String(je.editIndex):void 0}}updateFromUrl(je){let qe={};typeof je.editIndex=="string"?qe={editIndex:Number(je.editIndex)}:qe={editIndex:void 0},Object.keys(qe).length>0&&this._scene.setState(qe)}}var cn=e(16817),vn=e(84167),Pn=e(77268),Kn=e(82241),us=e(51612),Gn=e(46502);const ps="New annotation",Dt=({annotation:Qe,editIndex:je,panels:qe,onUpdate:dt,onBackToList:Lt,onDelete:Vt})=>{const Gt=(0,ht.of)(un),en=(0,S.useMemo)(()=>Qe.filter?Qe.filter.exclude?2:1:0,[Qe.filter]),{value:bn}=(0,cn.A)(()=>(0,_a.l)().get(Qe.datasource),[Qe.datasource]),En=(0,_a.l)().getInstanceSettings(Qe.datasource),rs=Zs=>{dt({...Qe,name:Zs.currentTarget.value},je)},js=Zs=>{const ba=(0,Xa.p$)(Zs);Qe.datasource?.type!==ba.type?dt({datasource:ba,builtIn:Qe.builtIn,enable:Qe.enable,iconColor:Qe.iconColor,name:Qe.name,hide:Qe.hide,filter:Qe.filter,mappings:Qe.mappings,type:Qe.type},je):dt({...Qe,datasource:ba},je)},Xs=Zs=>{const ba=Zs.currentTarget;dt({...Qe,[ba.name]:ba.type==="checkbox"?ba.checked:ba.value},je)},Ss=Zs=>{dt({...Qe,iconColor:Zs},je)},Ys=Zs=>{let ba=Zs.value===0?void 0:{exclude:Zs.value===2,ids:Qe.filter?.ids??[]};dt({...Qe,filter:ba},je)},ea=Zs=>{if(!Array.isArray(Zs))return;const ba={exclude:en===2,ids:[]};Zs.forEach(ur=>ur.value&&ba.ids.push(ur.value)),dt({...Qe,filter:ba},je)},_s=()=>{Vt(je),Lt()},qs=Qe.name===ps,sa=(Zs,ba)=>Zs.label&&ba.label?Zs.label.toLowerCase().localeCompare(ba.label.toLowerCase()):-1,Va=(0,S.useMemo)(()=>qe.filter(Zs=>r.$.panels[Zs.state.pluginId]).map(Zs=>({value:(0,Fe.Cs)(Zs),label:Zs.state.title??`Panel ${(0,Fe.Cs)(Zs)}`,description:Zs.state.description,imgUrl:r.$.panels[Zs.state.pluginId].info.logos.small})).sort(sa)??[],[qe]);return(0,v.jsxs)("div",{children:[(0,v.jsxs)(vn.n,{className:Gt.settingsForm,children:[(0,v.jsx)(j.D,{label:"Name",children:(0,v.jsx)(A.p,{"data-testid":M.Tp.pages.Dashboard.Settings.Annotations.Settings.name,name:"name",id:"name",autoFocus:qs,value:Qe.name,onChange:rs})}),(0,v.jsx)(j.D,{label:"Data source",htmlFor:"data-source-picker",children:(0,v.jsx)(us.s,{annotations:!0,variables:!0,current:Qe.datasource,onChange:js})}),!bn?.meta.annotations&&(0,v.jsx)(L.F,{title:"No annotation support for this data source",severity:"error",children:(0,v.jsx)(N.x6,{i18nKey:"errors.dashboard-settings.annotations.datasource",children:"The selected data source does not support annotations. Please select a different data source."})}),(0,v.jsx)(j.D,{label:"Enabled",description:"When enabled the annotation query is issued every dashboard refresh",children:(0,v.jsx)(xe.S,{name:"enable",id:"enable",value:Qe.enable,onChange:Xs,"data-testid":M.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.enable})}),(0,v.jsx)(j.D,{label:"Hidden",description:"Annotation queries can be toggled on or off at the top of the dashboard. With this option checked this toggle will be hidden.",children:(0,v.jsx)(xe.S,{name:"hide",id:"hide",value:Qe.hide,onChange:Xs,"data-testid":M.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.hide})}),(0,v.jsx)(j.D,{label:"Color",description:"Color to use for the annotation event markers",children:(0,v.jsx)(B.B,{children:(0,v.jsx)(Pn.a,{value:Qe?.iconColor,onChange:Ss})})}),(0,v.jsx)(j.D,{label:"Show in","data-testid":M.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.showInLabel,children:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(Qn.l6,{options:Jn,value:en,onChange:Ys,"data-testid":M.Tp.components.Annotations.annotationsTypeInput}),en!==0&&(0,v.jsx)(Qn.KF,{options:Va,value:Va.filter(Zs=>Qe.filter?.ids.includes(Zs.value)),onChange:ea,isClearable:!0,placeholder:"Choose panels",width:100,closeMenuOnSelect:!1,className:Gt.select,"data-testid":M.Tp.components.Annotations.annotationsChoosePanelInput})]})})]}),(0,v.jsxs)(vn.n,{children:[(0,v.jsx)("h3",{className:"page-heading",children:"Query"}),bn?.annotations&&En&&(0,v.jsx)(Kn.A,{datasource:bn,datasourceInstanceSettings:En,annotation:Qe,onChange:Zs=>dt(Zs,je)}),bn&&!bn.annotations&&(0,v.jsx)(Gn.F,{datasource:bn,annotation:Qe,onChange:Zs=>dt(Zs,je)})]}),(0,v.jsxs)(B.B,{children:[!Qe.builtIn&&(0,v.jsx)(I.$n,{variant:"destructive",onClick:_s,"data-testid":M.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.delete,children:"Delete"}),(0,v.jsx)(I.$n,{variant:"secondary",onClick:Lt,"data-testid":M.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.apply,children:"Back to list"})]})]})},un=Qe=>({settingsForm:(0,Se.css)({maxWidth:Qe.spacing(60),marginBottom:Qe.spacing(2)}),select:(0,Se.css)({marginTop:"8px"})});var Bn=(Qe=>(Qe[Qe.AllPanels=0]="AllPanels",Qe[Qe.IncludePanels=1]="IncludePanels",Qe[Qe.ExcludePanels=2]="ExcludePanels",Qe))(Bn||{});const Jn=[{label:"All panels",value:0,description:"Send the annotation data to all panels that support annotations"},{label:"Selected panels",value:1,description:"Send the annotations to the explicitly listed panels"},{label:"All panels except",value:2,description:"Do not send annotation data to the following panels"}];var In=e(29158),ms=e(91605),Es=e(69529),Cs=e(72109),hs=e(46991);const fa="Add annotation query",oa=({annotations:Qe,onNew:je,onEdit:qe,onMove:dt,onDelete:Lt})=>{const Vt=(0,ht.of)(na),Gt=Qe.length===0||Qe.length===1&&Qe[0].builtIn,en=En=>En.enable===!1?(0,v.jsxs)("em",{className:"muted",children:["(Disabled) \xA0 ",En.name]}):En.builtIn?(0,v.jsxs)("em",{className:"muted",children:[En.name," \xA0 (Built-in)"]}):(0,v.jsx)(v.Fragment,{children:En.name}),bn=(0,_a.l)();return(0,v.jsxs)(B.B,{direction:"column",children:[Qe.length>0&&(0,v.jsx)("div",{className:Vt.table,children:(0,v.jsxs)("table",{role:"grid",className:"filter-table filter-table--hover",children:[(0,v.jsx)("thead",{children:(0,v.jsxs)("tr",{children:[(0,v.jsx)("th",{children:"Query name"}),(0,v.jsx)("th",{children:"Data source"}),(0,v.jsx)("th",{colSpan:3})]})}),(0,v.jsx)("tbody",{"data-testid":M.Tp.pages.Dashboard.Settings.Annotations.List.annotations,children:Qe.map((En,rs)=>(0,v.jsxs)("tr",{children:[En.builtIn?(0,v.jsx)("td",{role:"gridcell",style:{width:"90%"},className:"pointer",onClick:()=>qe(rs),children:(0,v.jsx)(I.$n,{size:"sm",fill:"text",variant:"secondary",children:en(En)})}):(0,v.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>qe(rs),children:(0,v.jsx)(I.$n,{size:"sm",fill:"text",variant:"secondary",children:en(En)})}),(0,v.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>qe(rs),children:bn.getInstanceSettings(En.datasource)?.name||En.datasource?.uid}),(0,v.jsx)("td",{role:"gridcell",style:{width:"1%"},children:rs!==0&&(0,v.jsx)(In.K,{name:"arrow-up",onClick:()=>dt(rs,Bt.UP),tooltip:"Move up"})}),(0,v.jsx)("td",{role:"gridcell",style:{width:"1%"},children:Qe.length>1&&rs!==Qe.length-1?(0,v.jsx)(In.K,{name:"arrow-down",onClick:()=>dt(rs,Bt.DOWN),tooltip:"Move down"}):null}),(0,v.jsx)("td",{role:"gridcell",style:{width:"1%"},children:!En.builtIn&&(0,v.jsx)(ms.e,{size:"sm",onConfirm:()=>Lt(rs),"aria-label":`Delete query with title "${En.name}"`})})]},`${En.name}-${rs}`))})]})}),Gt&&(0,v.jsx)(B.B,{direction:"column",children:(0,v.jsxs)(Es.p,{variant:"call-to-action",button:(0,v.jsx)(I.$n,{"data-testid":M.Tp.components.CallToActionCard.buttonV2("Add annotation query"),icon:"comment-alt",onClick:je,size:"lg",children:(0,v.jsx)(N.x6,{i18nKey:"annotations.empty-state.button-title",children:"Add annotation query"})}),message:(0,N.t)("annotations.empty-state.title","There are no custom annotation queries added yet"),children:[(0,v.jsx)(N.x6,{i18nKey:"annotations.empty-state.info-box-content",children:(0,v.jsx)("p",{children:"Annotations provide a way to integrate event data into your graphs. They are visualized as vertical lines and icons on all graph panels. When you hover over an annotation icon you can get event text & tags for the event. You can add annotation events directly from grafana by holding CTRL or CMD + click on graph (or drag region). These will be stored in Grafana's annotation database."})}),(0,v.jsxs)(N.x6,{i18nKey:"annotations.empty-state.info-box-content-2",children:["Checkout the"," ",(0,v.jsx)(Cs.Y,{external:!0,href:"http://docs.grafana.org/reference/annotations/",children:"Annotations documentation"})," ","for more information."]})]})}),!Gt&&(0,v.jsx)(hs.d,{"data-testid":M.Tp.pages.Dashboard.Settings.Annotations.List.addAnnotationCTAV2,onClick:je,children:"New query"})]})},na=()=>({table:(0,Se.css)({width:"100%",overflowX:"auto"})});var Bt=(Qe=>(Qe[Qe.UP=-1]="UP",Qe[Qe.DOWN=1]="DOWN",Qe))(Bt||{});class Wt extends i.Bs{constructor(){super(...arguments),this._urlSync=new kt(this),this.getDataSourceRefForAnnotation=()=>{const je=(0,_a.l)().getInstanceSettings(null);if(!je||!je.meta.annotations){console.error("Default datasource does not support annotations");return}return(0,Xa.p$)(je)},this.onNew=async()=>{const je={name:ps,enable:!0,datasource:this.getDataSourceRefForAnnotation(),iconColor:"red"},qe=new vt.g({query:je,name:je.name,isEnabled:!!je.enable,isHidden:!!je.hide}),dt=be.b4.getDataLayers(this._dashboard);dt.addAnnotationLayer(qe),this.setState({editIndex:dt.state.annotationLayers.length-1})},this.onEdit=je=>{this.setState({editIndex:je})},this.onBackToList=()=>{this.setState({editIndex:void 0})},this.onMove=(je,qe)=>{const dt=be.b4.getDataLayers(this._dashboard),Lt=[...dt.state.annotationLayers],[Vt]=Lt.splice(je,1);Lt.splice(je+qe,0,Vt),dt.setState({annotationLayers:Lt})},this.onDelete=je=>{const qe=be.b4.getDataLayers(this._dashboard),dt=[...qe.state.annotationLayers];dt.splice(je,1),qe.setState({annotationLayers:dt})},this.onUpdate=(je,qe)=>{const dt=this.getDataLayer(qe);dt.setState({name:je.name,isEnabled:!!je.enable,isHidden:!!je.hide,query:je}),dt.runLayer()}}static{this.Component=_t}getUrlKey(){return"annotations"}get _dashboard(){return(0,Fe.YQ)(this)}getDataLayer(je){const dt=be.b4.getDataLayers(this._dashboard).state.annotationLayers[je];if(!(dt instanceof i.tV.g))throw new Error("AnnotationsDataLayer not found at index "+je);return dt}getDashboard(){return this._dashboard}}function _t({model:Qe}){const je=Qe.getDashboard(),{annotationLayers:qe}=be.b4.getDataLayers(je).useState(),{navModel:dt,pageNav:Lt}=Tr(je,Qe.getUrlKey()),{editIndex:Vt}=Qe.useState(),Gt=be.b4.getVizPanels(je),en=r.$.featureToggles.singleTopNav,bn=(0,Pe.O)(qe);return Vt!=null&&Vt<qe.length?(0,v.jsx)(sn,{annotationLayer:Qe.getDataLayer(Vt),pageNav:Lt,panels:Gt,editIndex:Vt,navModel:dt,dashboard:je,onUpdate:Qe.onUpdate,onBackToList:Qe.onBackToList,onDelete:Qe.onDelete}):(0,v.jsxs)(Te.YW,{navModel:dt,pageNav:Lt,layout:et.k.Standard,toolbar:en?(0,v.jsx)(Ge.v,{dashboard:je}):void 0,children:[!en&&(0,v.jsx)(Ge.c,{dashboard:je}),(0,v.jsx)(oa,{annotations:bn,onNew:Qe.onNew,onEdit:Qe.onEdit,onDelete:Qe.onDelete,onMove:Qe.onMove})]})}function sn({annotationLayer:Qe,pageNav:je,navModel:qe,panels:dt,editIndex:Lt,dashboard:Vt,onUpdate:Gt,onBackToList:en,onDelete:bn}){const{name:En,query:rs}=Qe.useState(),js=r.$.featureToggles.singleTopNav,Xs={text:En,parentItem:je};return(0,v.jsxs)(Te.YW,{navModel:qe,pageNav:Xs,layout:et.k.Standard,toolbar:js?(0,v.jsx)(Ge.v,{dashboard:Vt}):void 0,children:[!js&&(0,v.jsx)(Ge.c,{dashboard:Vt}),(0,v.jsx)(Dt,{annotation:rs,editIndex:Lt,panels:dt,onUpdate:Gt,onBackToList:en,onDelete:bn})]})}var Cn=e(14588),Fn=e(65857),$n=e(6199),ts=e(4588);class Vn extends i.Bs{constructor(){super(...arguments),this._urlSync=new kt(this),this.onNewLink=()=>{this.links=[...this.links,ts.q],this.setState({editIndex:this.links.length-1})},this.onDelete=je=>{this.links=[...this.links.slice(0,je),...this.links.slice(je+1)],this.setState({editIndex:void 0})},this.onDuplicate=je=>{this.links=[...this.links,{...je}]},this.onOrderChange=(je,qe)=>{this.links=Cn.moveItemImmutably(this.links,je,je+qe)},this.onEdit=je=>{this.setState({editIndex:je})},this.onUpdateLink=je=>{const qe=this.state.editIndex;qe!==void 0&&(this.links=[...this.links.slice(0,qe),je,...this.links.slice(qe+1)])},this.onGoBack=()=>{this.setState({editIndex:void 0})}}static{this.Component=Un}getUrlKey(){return"links"}get dashboard(){return(0,Fe.YQ)(this)}get links(){return this.dashboard.state.links}set links(je){this.dashboard.setState({links:je})}}function Un({model:Qe}){const{editIndex:je}=Qe.useState(),qe=(0,Fe.YQ)(Qe),{links:dt}=qe.useState(),{navModel:Lt,pageNav:Vt}=Tr(qe,Qe.getUrlKey()),Gt=je!==void 0?dt[je]:void 0,en=r.$.featureToggles.singleTopNav;return Gt?(0,v.jsx)(ys,{pageNav:Vt,navModel:Lt,link:Gt,dashboard:qe,onChange:Qe.onUpdateLink,onGoBack:Qe.onGoBack}):(0,v.jsxs)(Te.YW,{navModel:Lt,pageNav:Vt,layout:et.k.Standard,toolbar:en?(0,v.jsx)(Ge.v,{dashboard:qe}):void 0,children:[!en&&(0,v.jsx)(Ge.c,{dashboard:qe}),(0,v.jsx)($n.X,{links:dt,onNew:Qe.onNewLink,onEdit:Qe.onEdit,onDelete:Qe.onDelete,onDuplicate:Qe.onDuplicate,onOrderChange:Qe.onOrderChange})]})}function ys({pageNav:Qe,link:je,navModel:qe,dashboard:dt,onChange:Lt,onGoBack:Vt}){const Gt={text:"Edit link",parentItem:Qe},en=r.$.featureToggles.singleTopNav;return(0,v.jsxs)(Te.YW,{navModel:qe,pageNav:Gt,layout:et.k.Standard,toolbar:en?(0,v.jsx)(Ge.v,{dashboard:dt}):void 0,children:[!en&&(0,v.jsx)(Ge.c,{dashboard:dt}),(0,v.jsx)(Fn.d,{link:je,onUpdate:Lt,onGoBack:Vt})]})}var ws=e(79924),As=e(94354),$s=e(57418),Hs=e(75590),va=e(81394),Qs=e(27966),Ps=e(77431),Vs=e(24466);const Js=[{label:"Editable",value:!0},{label:"Read-only",value:!1}],Ca=[{value:0,label:"Default"},{value:1,label:"Shared crosshair"},{value:2,label:"Shared Tooltip"}];class Fa extends i.Bs{constructor(){super(...arguments),this.onTitleChange=je=>{this._dashboard.setState({title:je})},this.onDescriptionChange=je=>{this._dashboard.setState({description:je})},this.onTagsChange=je=>{this._dashboard.setState({tags:je})},this.onFolderChange=async(je,qe)=>{const dt={...this._dashboard.state.meta,folderUid:je||this._dashboard.state.meta.folderUid,folderTitle:qe||this._dashboard.state.meta.folderTitle};dt.folderUid&&await(0,Ps.Q)(dt.folderUid),this._dashboard.setState({meta:dt})},this.onEditableChange=je=>{this._dashboard.setState({editable:je})},this.onTimeZoneChange=je=>{this.getTimeRange().setState({timeZone:je})},this.onWeekStartChange=je=>{this.getTimeRange().setState({weekStart:je})},this.onRefreshIntervalChange=je=>{this.getRefreshPicker()?.setState({intervals:je})},this.onNowDelayChange=je=>{this.getTimeRange()?.setState({UNSAFE_nowDelay:je})},this.onHideTimePickerChange=je=>{this.getDashboardControls()?.setState({hideTimeControls:je})},this.onLiveNowChange=je=>{try{const qe=this.getLiveNowTimer();je?qe.enable():qe.disable()}catch(qe){console.error(qe)}},this.onTooltipChange=je=>{this.getCursorSync()?.setState({sync:je})},this.onPreloadChange=je=>{this._dashboard.setState({preload:je})},this.onDeleteDashboard=()=>{}}get _dashboard(){return(0,Fe.YQ)(this)}getUrlKey(){return"settings"}getDashboard(){return this._dashboard}getTimeRange(){return i.jh.getTimeRange(this._dashboard)}getRefreshPicker(){return this.getDashboardControls().state.refreshPicker}getCursorSync(){return be.b4.getCursorSync(this._dashboard)}getLiveNowTimer(){const je=i.jh.findObject(this._dashboard,qe=>qe instanceof i.Gg.en);if(je instanceof i.Gg.en)return je;throw new Error("LiveNowTimer could not be found")}getDashboardControls(){return this._dashboard.state.controls}static{this.Component=({model:je})=>{const qe=je.getDashboard(),{navModel:dt,pageNav:Lt}=Tr(qe,je.getUrlKey()),{title:Vt,description:Gt,tags:en,meta:bn,editable:En}=qe.useState(),{sync:rs}=je.getCursorSync()?.useState()||{},{timeZone:js,weekStart:Xs,UNSAFE_nowDelay:Ss}=je.getTimeRange().useState(),{intervals:Ys}=je.getRefreshPicker().useState(),{hideTimeControls:ea}=je.getDashboardControls().useState(),{enabled:_s}=je.getLiveNowTimer().useState(),qs=r.$.featureToggles.singleTopNav;return(0,v.jsxs)(Te.YW,{navModel:dt,pageNav:Lt,layout:et.k.Standard,toolbar:qs?(0,v.jsx)(Ge.v,{dashboard:qe}):void 0,children:[!qs&&(0,v.jsx)(Ge.c,{dashboard:qe}),(0,v.jsxs)("div",{style:{maxWidth:"600px"},children:[(0,v.jsxs)(U.a,{marginBottom:5,children:[(0,v.jsx)(j.D,{label:(0,v.jsxs)(B.B,{justifyContent:"space-between",children:[(0,v.jsx)(F.J,{htmlFor:"title-input",children:(0,v.jsx)(N.x6,{i18nKey:"dashboard-settings.general.title-label",children:"Title"})}),r.$.featureToggles.dashgpt&&(0,v.jsx)(Qs.Z,{onGenerate:sa=>je.onTitleChange(sa)})]}),children:(0,v.jsx)(A.p,{id:"title-input",name:"title",value:Vt,onChange:sa=>je.onTitleChange(sa.target.value)})}),(0,v.jsx)(j.D,{label:(0,v.jsxs)(B.B,{justifyContent:"space-between",children:[(0,v.jsx)(F.J,{htmlFor:"description-input",children:(0,N.t)("dashboard-settings.general.description-label","Description")}),r.$.featureToggles.dashgpt&&(0,v.jsx)(va.V,{onGenerate:sa=>je.onDescriptionChange(sa)})]}),children:(0,v.jsx)(K.f,{id:"description-input",name:"description",value:Gt,onChange:sa=>je.onDescriptionChange(sa.target.value)})}),(0,v.jsx)(j.D,{label:(0,N.t)("dashboard-settings.general.tags-label","Tags"),children:(0,v.jsx)(ws.u,{id:"tags-input",tags:en,onChange:je.onTagsChange,width:40})}),(0,v.jsx)(j.D,{label:(0,N.t)("dashboard-settings.general.folder-label","Folder"),children:(0,v.jsx)(V.d,{value:bn.folderUid,onChange:je.onFolderChange,initialTitle:bn.folderTitle,inputId:"dashboard-folder-input",enableCreateNew:!0,skipInitialLoad:!0})}),(0,v.jsx)(j.D,{label:(0,N.t)("dashboard-settings.general.editable-label","Editable"),description:(0,N.t)("dashboard-settings.general.editable-description","Set to read-only to disable all editing. Reload the dashboard for changes to take effect"),children:(0,v.jsx)(As.z,{value:En,options:Js,onChange:je.onEditableChange})})]}),(0,v.jsx)(Hs.p,{onTimeZoneChange:je.onTimeZoneChange,onWeekStartChange:je.onWeekStartChange,onRefreshIntervalChange:je.onRefreshIntervalChange,onNowDelayChange:je.onNowDelayChange,onHideTimePickerChange:je.onHideTimePickerChange,onLiveNowChange:je.onLiveNowChange,refreshIntervals:Ys,timePickerHidden:ea,nowDelay:Ss||"",liveNow:_s,timezone:js||"",weekStart:Xs||""}),(0,v.jsxs)($s.M,{label:(0,N.t)("dashboard-settings.general.panel-options-label","Panel options"),isOpen:!0,children:[(0,v.jsx)(j.D,{label:(0,N.t)("dashboard-settings.general.panel-options-graph-tooltip-label","Graph tooltip"),description:(0,N.t)("dashboard-settings.general.panel-options-graph-tooltip-description","Controls tooltip and hover highlight behavior across different panels. Reload the dashboard for changes to take effect"),children:(0,v.jsx)(As.z,{onChange:je.onTooltipChange,options:Ca,value:rs})}),(0,v.jsx)(j.D,{label:(0,N.t)("dashboard-settings.general.panels-preload-label","Preload panels"),description:(0,N.t)("dashboard-settings.general.panels-preload-description","When enabled all panels will start loading as soon as the dashboard has been loaded."),children:(0,v.jsx)(W.d,{id:"preload-panels-dashboards-toggle",value:qe.state.preload,onChange:sa=>je.onPreloadChange(sa.currentTarget.checked)})})]}),(0,v.jsx)(U.a,{marginTop:3,children:bn.canDelete&&(0,v.jsx)(Vs.c,{dashboard:qe})})]})]})}}}class nr extends i.Bs{constructor(je){super({...je,jsonText:""}),this.onCodeEditorBlur=qe=>{this.setState({jsonText:qe})},this.onSaveSuccess=qe=>{const dt=JSON.parse(this.state.jsonText),Lt=this.getDashboard();dt.version=qe.version;const Vt={dashboard:dt,meta:Lt.state.meta},Gt=(0,Tt.wM)(Vt),en=i.Go.cloneSceneObjectState(Gt.state);Lt.pauseTrackingChanges(),Lt.setInitialSaveModel(Vt.dashboard),Lt.setState(en),this.setState({jsonText:this.getJsonText()})},this.addActivationHandler(()=>this.setState({jsonText:this.getJsonText()}))}getUrlKey(){return"json-model"}getDashboard(){return(0,Fe.YQ)(this)}getSaveModel(){const je=this.getDashboard();return(0,We.Uy)(je)}getJsonText(){const je=this.getSaveModel();return(0,Os.p)(je)}static{this.Component=({model:je})=>{const{state:qe,onSaveDashboard:dt}=re(!1),[Lt,Vt]=(0,S.useState)(!1),Gt=je.getDashboard(),{navModel:en,pageNav:bn}=Tr(Gt,je.getUrlKey()),En=Gt.useState().meta.canSave,{jsonText:rs}=je.useState(),js=r.$.featureToggles.singleTopNav,Xs=async qs=>{const sa=await dt(Gt,JSON.parse(je.state.jsonText),{folderUid:Gt.state.meta.folderUid,overwrite:qs});Vt(!0),sa.status==="success"?(je.onSaveSuccess(sa),Vt(!1)):Vt(!0)},Ss=qs=>(0,v.jsx)(I.$n,{type:"submit",onClick:()=>{Xs(qs)},variant:qs?"destructive":"primary",children:qs?"Save and overwrite":(0,v.jsx)(N.x6,{i18nKey:"dashboard-settings.json-editor.save-button",children:"Save changes"})}),Ys=(0,v.jsx)(I.$n,{variant:"secondary",onClick:()=>Vt(!1),fill:"outline",children:"Cancel"}),ea=(0,ht.of)(ca);function _s(qs){if(qs&&Lt){if(H(qs))return(0,v.jsxs)(L.F,{title:"Someone else has updated this dashboard",severity:"error",children:[(0,v.jsx)("p",{children:"Would you still like to save this dashboard?"}),(0,v.jsx)(U.a,{paddingTop:2,children:(0,v.jsxs)(B.B,{alignItems:"center",children:[Ys,Ss(!0)]})})]});if(Q(qs))return(0,v.jsx)(ee,{saveButton:Ss,cancelButton:Ys});if(X(qs))return(0,v.jsxs)(L.F,{title:"Plugin dashboard",severity:"error",children:[(0,v.jsxs)("p",{children:["Your changes will be lost when you update the plugin. Use ",(0,v.jsx)("strong",{children:"Save As"})," to create custom version."]}),(0,v.jsx)(U.a,{paddingTop:2,children:(0,v.jsx)(B.B,{alignItems:"center",children:Ss(!0)})})]})}return(0,v.jsxs)(v.Fragment,{children:[qs&&Lt&&(0,v.jsx)(L.F,{title:"Failed to save dashboard",severity:"error",children:(0,v.jsx)("p",{children:qs.message})}),(0,v.jsx)(B.B,{alignItems:"center",children:Ss(!1)})]})}return(0,v.jsxs)(Te.YW,{navModel:en,pageNav:bn,layout:et.k.Standard,toolbar:js?(0,v.jsx)(Ge.v,{dashboard:Gt}):void 0,children:[!js&&(0,v.jsx)(Ge.c,{dashboard:Gt}),(0,v.jsxs)("div",{className:ea.wrapper,children:[(0,v.jsx)(N.x6,{i18nKey:"dashboard-settings.json-editor.subtitle",children:"The JSON model below is the data structure that defines the dashboard. This includes dashboard settings, panel settings, layout, queries, and so on."}),(0,v.jsx)(Ce.B,{width:"100%",value:rs,language:"json",showLineNumbers:!0,showMiniMap:!0,containerStyles:ea.codeEditor,onBlur:je.onCodeEditorBlur}),En&&(0,v.jsx)(U.a,{paddingTop:2,children:_s(qe.error)})]})]})}}}const ca=Qe=>({wrapper:(0,Se.css)({display:"flex",height:"100%",flexDirection:"column",gap:Qe.spacing(2)}),codeEditor:(0,Se.css)({flexGrow:1})});var st=e(74868);class bt extends i.Bs{static{this.Component=Mt}get _dashboard(){return(0,Fe.YQ)(this)}getUrlKey(){return"permissions"}getDashboard(){return this._dashboard}}function Mt({model:Qe}){const je=Qe.getDashboard(),{uid:qe}=je.useState(),{navModel:dt,pageNav:Lt}=Tr(je,Qe.getUrlKey()),Vt=$a.TP.hasPermission(ne.AccessControlAction.DashboardsPermissionsWrite),Gt=r.$.featureToggles.singleTopNav;return(0,v.jsxs)(Te.YW,{navModel:dt,pageNav:Lt,layout:et.k.Standard,toolbar:Gt?(0,v.jsx)(Ge.v,{dashboard:je}):void 0,children:[!Gt&&(0,v.jsx)(Ge.c,{dashboard:je}),(0,v.jsx)(st.x,{resource:"dashboards",resourceId:qe??"",canSetPermissions:Vt})]})}var qt=e(75505),rn=e(79422),tn=e(71678),Rn=e(96374),jn=e(39558),Wn=e(8964),bs=e(58975),as=e(85140),vs=e(14329),Ts=e(41820),is=e(85830),Ds=e(89458),fs=e(17663);function ks({onChange:Qe,type:je}){const qe=(0,S.useMemo)(()=>(0,fs.B$)(),[]),dt=(0,S.useMemo)(()=>qe.find(Lt=>Lt.value===je)??qe[0],[qe,je]);return(0,v.jsx)(Ds.v,{name:"Select variable type",value:dt,options:qe,onChange:Qe,testId:M.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalTypeSelectV2})}function La({variable:Qe,onTypeChange:je,onGoBack:qe,onDelete:dt,onValidateVariableName:Lt}){const Vt=(0,ht.of)(ja),[Gt,en]=(0,S.useState)(null),{name:bn,type:En,label:rs,description:js,hide:Xs,key:Ss}=Qe.useState(),Ys=(0,fs.bZ)(En)?(0,fs.CD)(En):void 0,[ea,_s]=(0,q.A)(async()=>{await(0,qt.s)(Qe.validateAndUpdate())},[Qe]),qs=ya=>{ya.value&&je(ya.value)},sa=(0,S.useCallback)(ya=>{const[,mr]=Lt(ya.currentTarget.value,Ss);Gt!==mr&&en(mr)},[Ss,Gt,Lt]),Va=ya=>{Gt||Qe.setState({name:ya.currentTarget.value})},Zs=ya=>Qe.setState({label:ya.currentTarget.value}),ba=ya=>Qe.setState({description:ya.currentTarget.value}),ur=ya=>Qe.setState({hide:ya}),Ma=(0,fs.n_)(Qe),Ta=ya=>()=>{(0,ae.rR)("Delete variable"),dt(bn),ya()};return(0,v.jsxs)("form",{"aria-label":"Variable editor Form",children:[(0,v.jsx)(ks,{onChange:qs,type:En}),(0,v.jsx)(bs.Y,{children:"General"}),(0,v.jsx)(vs._,{name:"Name",description:"The name of the template variable. (Max. 50 characters)",placeholder:"Variable name",defaultValue:bn??"",onChange:sa,onBlur:Va,testId:M.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalNameInputV2,maxLength:is.M.MaxSize,required:!0,invalid:!!Gt,error:Gt}),(0,v.jsx)(vs._,{name:"Label",description:"Optional display name",placeholder:"Label name",defaultValue:rs??"",onBlur:Zs,testId:M.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalLabelInputV2}),(0,v.jsx)(as.Z,{name:"Description",defaultValue:js??"",placeholder:"Descriptive text",onBlur:ba,width:52}),(0,v.jsx)(Wn.D,{onChange:ur,hide:Xs||rn.rw.hide,type:En}),Ys&&(0,v.jsx)(Ys,{variable:Qe,onRunQuery:_s}),Ma&&(0,v.jsx)(Ts.j,{options:Qe.getOptionsForSelect()}),(0,v.jsx)("div",{className:Vt.buttonContainer,children:(0,v.jsxs)(B.B,{gap:2,children:[(0,v.jsx)(tn.$s,{children:({showModal:ya,hideModal:mr})=>(0,v.jsx)(I.$n,{variant:"destructive",fill:"outline",onClick:()=>{ya(Rn.u,{title:"Delete variable",body:`Are you sure you want to delete: ${bn}?`,confirmText:"Delete variable",onConfirm:Ta(mr),onDismiss:mr,isOpen:!0})},children:"Delete"})}),(0,v.jsx)(I.$n,{variant:"secondary","data-testid":M.Tp.pages.Dashboard.Settings.Variables.Edit.General.applyButton,onClick:qe,children:"Back to list"}),Ma&&(0,v.jsx)(I.$n,{disabled:ea.loading,variant:"secondary","data-testid":M.Tp.pages.Dashboard.Settings.Variables.Edit.General.submitButton,onClick:_s,children:ea.loading?(0,v.jsx)(jn._,{className:Vt.loadingPlaceHolder,text:"Running query..."}):"Run query"})]})})]})}const ja=Qe=>({buttonContainer:(0,Se.css)({marginTop:Qe.spacing(2)}),loadingPlaceHolder:(0,Se.css)({marginBottom:0})});var br=e(91076),Lr=e(2223);function Qr(Qe){return Qe.map(je=>({id:je.state.name,label:`${je.state.name}`}))}function To(Qe,je){return Qe.filter(qe=>je.some(dt=>dt.from===qe.id||dt.to===qe.id))}const So=Qe=>{const je=[];for(const qe of Qe)for(const dt of Qe){if(qe===dt)continue;qe.variableDependency?.hasDependencyOn(dt.state.name)&&je.push({from:qe.state.name,to:dt.state.name})}return je},jr=({variables:Qe})=>{const je=(0,S.useMemo)(()=>Qr(Qe),[Qe]),qe=(0,S.useMemo)(()=>So(Qe),[Qe]);return qe.length?(0,v.jsx)(Lr.i,{show:!1,title:(0,N.t)("dashboards.settings.variables.dependencies.title","Dependencies"),nodes:To(je,qe),edges:qe,children:({showModal:dt})=>(0,v.jsx)(I.$n,{onClick:()=>{(0,ae.rR)("Show variable dependencies"),dt()},icon:"channel-add",variant:"secondary",children:(0,v.jsx)(N.x6,{i18nKey:"dashboards.settings.variables.dependencies.button",children:"Show dependencies"})})}):null};function Gs({index:Qe,variable:je,onEdit:qe,onDuplicate:dt,onDelete:Lt}){const Vt=(0,ht.$j)(),Gt=(0,ht.of)(io),en=(0,fs.Ao)(je),bn=je.state,En=bn.name,[rs,js]=(0,S.useState)(!1),Xs=Ys=>()=>{js(Ys)},Ss=()=>{(0,ae.rR)("Delete variable"),Lt(En)};return(0,v.jsx)(br.sx,{draggableId:JSON.stringify(En),index:Qe,children:(Ys,ea)=>(0,v.jsxs)("tr",{ref:Ys.innerRef,...Ys.draggableProps,style:{userSelect:ea.isDragging?"none":"auto",background:ea.isDragging?Vt.colors.background.secondary:void 0,...Ys.draggableProps.style},children:[(0,v.jsx)("td",{role:"gridcell",className:Gt.column,children:(0,v.jsx)(I.$n,{size:"xs",fill:"text",onClick:_s=>{_s.preventDefault(),qe(En)},className:Gt.nameLink,"data-testid":M.Tp.pages.Dashboard.Settings.Variables.List.tableRowNameFields(bn.name),children:bn.name})}),(0,v.jsx)("td",{role:"gridcell",className:Gt.definitionColumn,onClick:_s=>{_s.preventDefault(),qe(En)},"data-testid":M.Tp.pages.Dashboard.Settings.Variables.List.tableRowDefinitionFields(bn.name),children:en}),(0,v.jsx)("td",{role:"gridcell",className:Gt.column,children:(0,v.jsxs)("div",{className:Gt.icons,children:[(0,v.jsx)(In.K,{onClick:_s=>{_s.preventDefault(),(0,ae.rR)("Duplicate variable"),dt(En)},name:"copy",tooltip:"Duplicate variable","data-testid":M.Tp.pages.Dashboard.Settings.Variables.List.tableRowDuplicateButtons(bn.name)}),(0,v.jsx)(In.K,{onClick:_s=>{_s.preventDefault(),js(!0)},name:"trash-alt",tooltip:"Remove variable","data-testid":M.Tp.pages.Dashboard.Settings.Variables.List.tableRowRemoveButtons(bn.name)}),(0,v.jsx)(Rn.u,{isOpen:rs,title:"Delete variable",body:`Are you sure you want to delete: ${bn.name}?`,confirmText:"Delete variable",onConfirm:Ss,onDismiss:Xs(!1)}),(0,v.jsx)("div",{...Ys.dragHandleProps,className:Gt.dragHandle,children:(0,v.jsx)(Ln.I,{name:"draggabledots",size:"lg"})})]})})]})})}function io(Qe){return{dragHandle:(0,Se.css)({cursor:"grab",marginLeft:Qe.spacing(1)}),column:(0,Se.css)({width:"1%"}),nameLink:(0,Se.css)({cursor:"pointer",color:Qe.colors.primary.text}),definitionColumn:(0,Se.css)({width:"100%",maxWidth:"200px",cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),iconPassed:(0,Se.css)({color:Qe.v1.palette.greenBase,marginRight:Qe.spacing(2)}),iconFailed:(0,Se.css)({color:Qe.v1.palette.orange,marginRight:Qe.spacing(2)}),icons:(0,Se.css)({display:"flex",gap:Qe.spacing(2),alignItems:"center"})}}function Mo({variables:Qe,onChangeOrder:je,onDelete:qe,onDuplicate:dt,onAdd:Lt,onEdit:Vt}){const Gt=(0,ht.of)(Br),en=bn=>{!bn.destination||!bn.source||((0,ae.rR)("Variable drag and drop"),je(bn.source.index,bn.destination.index))};return(0,v.jsx)("div",{children:(0,v.jsxs)("div",{children:[Qe.length===0&&(0,v.jsx)(lo,{onAdd:Lt}),Qe.length>0&&(0,v.jsxs)(B.B,{direction:"column",gap:3,children:[(0,v.jsx)("div",{className:Gt.tableContainer,children:(0,v.jsxs)("table",{className:"filter-table filter-table--hover","data-testid":M.Tp.pages.Dashboard.Settings.Variables.List.table,role:"grid",children:[(0,v.jsx)("thead",{children:(0,v.jsxs)("tr",{children:[(0,v.jsx)("th",{children:"Variable"}),(0,v.jsx)("th",{children:"Definition"}),(0,v.jsx)("th",{colSpan:5})]})}),(0,v.jsx)(br.JY,{onDragEnd:en,children:(0,v.jsx)(br.gL,{droppableId:"variables-list",direction:"vertical",children:bn=>(0,v.jsxs)("tbody",{ref:bn.innerRef,...bn.droppableProps,children:[Qe.map((En,rs)=>{const js=En.state;return(0,v.jsx)(Gs,{index:rs,variable:En,onDelete:qe,onDuplicate:dt,onEdit:Vt},`${js.name}-${rs}`)}),bn.placeholder]})})})]})}),(0,v.jsxs)(B.B,{children:[(0,v.jsx)(jr,{variables:Qe}),(0,v.jsx)(I.$n,{"data-testid":M.Tp.pages.Dashboard.Settings.Variables.List.newButton,onClick:Lt,icon:"plus",children:"New variable"})]})]})]})})}function lo({onAdd:Qe}){return(0,v.jsx)(B.B,{direction:"column",children:(0,v.jsxs)(Es.p,{variant:"call-to-action",button:(0,v.jsx)(I.$n,{"data-testid":M.Tp.components.CallToActionCard.buttonV2("Add variable"),icon:"calculator-alt",onClick:Qe,size:"lg",children:(0,v.jsx)(N.x6,{i18nKey:"variables.empty-state.button-title",children:"Add variable"})}),message:(0,N.t)("variables.empty-state.title","There are no variables added yet"),children:[(0,v.jsx)("p",{children:(0,v.jsx)(N.x6,{i18nKey:"variables.empty-state.info-box-content",children:"Variables enable more interactive and dynamic dashboards. Instead of hard-coding things like server or sensor names in your metric queries you can use variables in their place. Variables are shown as list boxes at the top of the dashboard. These drop-down lists make it easy to change the data being displayed in your dashboard."})}),(0,v.jsxs)(N.x6,{i18nKey:"variables.empty-state.info-box-content-2",children:["Check out the"," ",(0,v.jsx)(Cs.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/variables/",children:"Templates and variables documentation"})," ","for more information."]})]})})}const Br=()=>({tableContainer:(0,Se.css)({overflow:"scroll",width:"100%"})});class Oo extends i.Bs{constructor(){super(...arguments),this._urlSync=new kt(this),this.getVariableIndex=je=>this.getVariables().findIndex(dt=>dt.state.name===je),this.replaceEditVariable=je=>{const qe=this.state.editIndex??-1,{variables:dt}=this.getVariableSet().state;if(!dt[qe]){console.error("Variable not found");return}const Vt=[...dt.slice(0,qe),je,...dt.slice(qe+1)];this.getVariableSet().setState({variables:Vt})},this.onDelete=je=>{const qe=this.getVariableIndex(je),{variables:dt}=this.getVariableSet().state;if(qe===-1){console.error("Variable not found");return}const Lt=[...dt.slice(0,qe),...dt.slice(qe+1)];this.getVariableSet().setState({variables:Lt}),this.setState({editIndex:void 0})},this.onDuplicated=je=>{const qe=this.getVariableIndex(je),dt=this.getVariableSet().state.variables;if(qe===-1){console.error("Variable not found");return}const Lt=dt[qe];let Vt=0,Gt=`copy_of_${Lt.state.name}`;for(;dt.some(En=>En.state.name===Gt);)Vt++,Gt=`copy_of_${Lt.state.name}_${Vt}`;const en=Lt.clone(Lt.state);en.setState({name:Gt});const bn=[...dt.slice(0,qe+1),en,...dt.slice(qe+1)];this.getVariableSet().setState({variables:bn})},this.onOrderChanged=(je,qe)=>{const dt=this.getVariableSet().state.variables;if(!this.getVariableSet())return;if(je<0||je>=dt.length||qe<0||qe>=dt.length){console.error("Invalid index");return}const Lt=[...dt],Vt=Lt.splice(je,1);Lt.splice(qe,0,Vt[0]),this.getVariableSet().setState({variables:Lt})},this.onEdit=je=>{const qe=this.getVariableIndex(je);if(qe===-1){console.error("Variable not found");return}this.setState({editIndex:qe})},this.onAdd=()=>{const je=this.getVariables(),qe=je.length,dt=(0,fs.kh)(je);this.getVariableSet().setState({variables:[...this.getVariables(),dt]}),this.setState({editIndex:qe})},this.onTypeChange=je=>{const qe=this.state.editIndex??-1,{variables:dt}=this.getVariableSet().state,Lt=dt[qe];if(!Lt){console.error("Variable not found");return}const{name:Vt,label:Gt}=Lt.state,en=(0,fs.No)(je,{name:Vt,label:Gt});this.replaceEditVariable(en)},this.onGoBack=()=>{this.setState({editIndex:void 0})},this.onValidateVariableName=(je,qe)=>{let dt=null;fs.cH.test(je)||(dt="Template names cannot begin with '__', that's reserved for Grafana's global variables"),fs.mJ.test(je)||(dt="Only word characters are allowed in variable names");const Lt=this.getVariableSet().getByName(je)?.state;return Lt&&Lt.key!==qe&&(dt="Variable with the same name already exists"),dt?[!0,dt]:[!1,null]}}static{this.Component=co}getUrlKey(){return"variables"}getDashboard(){return(0,Fe.YQ)(this)}getVariableSet(){return i.jh.getVariables(this.getDashboard())}getVariables(){return this.getVariableSet().state.variables}}function co({model:Qe}){const je=Qe.getDashboard(),{navModel:qe,pageNav:dt}=Tr(je,Qe.getUrlKey()),{onDelete:Lt,onDuplicated:Vt,onOrderChanged:Gt,onEdit:en,onTypeChange:bn,onGoBack:En,onAdd:rs}=Qe,{variables:js}=Qe.getVariableSet().useState(),{editIndex:Xs}=Qe.useState(),Ss=r.$.featureToggles.singleTopNav;if(Xs!==void 0&&js[Xs]){const Ys=js[Xs];if(Ys)return(0,v.jsx)(kr,{variable:Ys,onTypeChange:bn,onGoBack:En,pageNav:dt,navModel:qe,dashboard:je,onDelete:Lt,onValidateVariableName:Qe.onValidateVariableName})}return(0,v.jsxs)(Te.YW,{navModel:qe,pageNav:dt,layout:et.k.Standard,toolbar:Ss?(0,v.jsx)(Ge.v,{dashboard:je}):void 0,children:[!Ss&&(0,v.jsx)(Ge.c,{dashboard:je}),(0,v.jsx)(Mo,{variables:js,onDelete:Lt,onDuplicate:Vt,onChangeOrder:Gt,onAdd:rs,onEdit:en})]})}function kr({variable:Qe,pageNav:je,navModel:qe,dashboard:dt,onTypeChange:Lt,onGoBack:Vt,onDelete:Gt,onValidateVariableName:en}){const{name:bn}=Qe.useState(),En=r.$.featureToggles.singleTopNav,rs={text:bn,parentItem:je};return(0,v.jsxs)(Te.YW,{navModel:qe,pageNav:rs,layout:et.k.Standard,toolbar:En?(0,v.jsx)(Ge.v,{dashboard:dt}):void 0,children:[!En&&(0,v.jsx)(Ge.c,{dashboard:dt}),(0,v.jsx)(La,{variable:Qe,onTypeChange:Lt,onGoBack:Vt,onDelete:Gt,onValidateVariableName:en},Qe.state.key)]})}const Ao=10;class Io extends i.Bs{constructor(je){super({...je,versions:[],isLoading:!0,isAppending:!0,viewMode:"list",isNewLatest:!1,diffData:{lhs:"",rhs:""}}),this._limit=Ao,this._start=0,this.fetchVersions=(qe=!1)=>{const dt=this._dashboard.state.uid;dt&&(this.setState({isAppending:qe}),It.wL.getHistoryList(dt,{limit:this._limit,start:this._start}).then(Lt=>{this.setState({isLoading:!1,versions:[...this.state.versions??[],...this.decorateVersions(Lt)]}),this._start+=this._limit}).catch(Lt=>console.log(Lt)).finally(()=>this.setState({isAppending:!1})))},this.getDiff=async()=>{const qe=this.versions.filter(bn=>bn.checked),[dt,Lt]=qe,Vt=dt.version===this._dashboard.state.version;if(this.setState({isLoading:!0}),!this._dashboard.state.uid)return;const Gt=await It.wL.getDashboardVersion(this._dashboard.state.uid,Lt.version),en=await It.wL.getDashboardVersion(this._dashboard.state.uid,dt.version);this.setState({baseInfo:Lt,isLoading:!1,isNewLatest:Vt,newInfo:dt,viewMode:"compare",diffData:{lhs:Gt.data,rhs:en.data}})},this.reset=()=>{this.setState({baseInfo:void 0,diffData:{lhs:"",rhs:""},isNewLatest:!1,newInfo:void 0,versions:this.versions.map(qe=>({...qe,checked:!1})),viewMode:"list"})},this.onCheck=(qe,dt)=>{this.setState({versions:this.versions.map(Lt=>Lt.id===dt?{...Lt,checked:qe.currentTarget.checked}:Lt)})},this.addActivationHandler(()=>{this.fetchVersions()})}static{this.Component=Ro}get _dashboard(){return(0,Fe.YQ)(this)}get diffData(){return this.state.diffData??{lhs:"",rhs:""}}get versions(){return this.state.versions??[]}get limit(){return this._limit}get start(){return this._start}getUrlKey(){return"versions"}getDashboard(){return this._dashboard}getTimeRange(){return i.jh.getTimeRange(this._dashboard)}decorateVersions(je){const qe=this.getTimeRange().getTimeZone();return je.map(dt=>({...dt,createdDateString:(0,me.LE)(dt.created,{timeZone:qe}),ageString:(0,me.fq)(dt.created,{timeZone:qe}),checked:!1}))}}function Ro({model:Qe}){const je=Qe.getDashboard(),{isLoading:qe,isAppending:dt,viewMode:Lt,baseInfo:Vt,newInfo:Gt,isNewLatest:en}=Qe.useState(),{navModel:bn,pageNav:En}=Tr(je,Qe.getUrlKey()),rs=Qe.versions.filter(qs=>qs.checked).length===2,js=Qe.versions.length>1,Xs=Qe.versions.length>=Qe.limit,Ss=Qe.versions.find(qs=>qs.version===1),Ys=r.$.featureToggles.singleTopNav,ea=(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(It.me,{onClick:Qe.reset,baseVersion:Vt?.version,newVersion:Gt?.version,isNewLatest:en}),qe?(0,v.jsx)(Ur,{msg:"Fetching changes\u2026"}):(0,v.jsx)(It.Cc,{newInfo:Gt,baseInfo:Vt,isNewLatest:en,diffData:Qe.diffData,onRestore:je.onRestore})]}),_s=(0,v.jsxs)(v.Fragment,{children:[qe?(0,v.jsx)(Ur,{msg:"Fetching history list\u2026"}):(0,v.jsx)(It.bS,{versions:Qe.versions,onCheck:Qe.onCheck,canCompare:rs,onRestore:je.onRestore}),dt&&(0,v.jsx)(Ur,{msg:"Fetching more entries\u2026"}),js&&(0,v.jsx)(It.rJ,{hasMore:Xs,canCompare:rs,getVersions:Qe.fetchVersions,getDiff:Qe.getDiff,isLastPage:!!Ss})]});return(0,v.jsxs)(Te.YW,{navModel:bn,pageNav:En,layout:et.k.Standard,toolbar:Ys?(0,v.jsx)(Ge.v,{dashboard:je}):void 0,children:[!Ys&&(0,v.jsx)(Ge.c,{dashboard:je}),Lt==="compare"?ea:_s]})}const Ur=({msg:Qe})=>(0,v.jsxs)(B.B,{children:[(0,v.jsx)(Hn.y,{}),(0,v.jsx)("em",{children:Qe})]});function Tr(Qe,je){const qe=(0,He.zy)(),dt=(0,ne.useSelector)(en=>en.navIndex),Lt=(0,c.tc)(dt,"dashboards/browse"),Vt=Qe.getPageNav(qe,dt),Gt={text:"Settings",url:t.I.getUrlForPartial(qe,{editview:"settings",editIndex:null}),children:[],parentItem:Vt};return Qe.state.meta.canEdit&&(Gt.children.push({text:(0,N.t)("dashboard-settings.general.title","General"),url:t.I.getUrlForPartial(qe,{editview:"settings",editIndex:null}),active:je==="settings"}),Gt.children.push({text:(0,N.t)("dashboard-settings.annotations.title","Annotations"),url:t.I.getUrlForPartial(qe,{editview:"annotations",editIndex:null}),active:je==="annotations"}),Gt.children.push({text:(0,N.t)("dashboard-settings.variables.title","Variables"),url:t.I.getUrlForPartial(qe,{editview:"variables",editIndex:null}),active:je==="variables"}),Gt.children.push({text:(0,N.t)("dashboard-settings.links.title","Links"),url:t.I.getUrlForPartial(qe,{editview:"links",editIndex:null}),active:je==="links"})),Qe.state.id&&Qe.state.meta.canSave&&Gt.children.push({text:(0,N.t)("dashboard-settings.versions.title","Versions"),url:t.I.getUrlForPartial(qe,{editview:"versions",editIndex:null}),active:je==="versions"}),Qe.state.id&&Qe.state.meta.canAdmin&&$a.TP.hasPermission(ne.AccessControlAction.DashboardsPermissionsRead)&&Gt.children.push({text:(0,N.t)("dashboard-settings.permissions.title","Permissions"),url:t.I.getUrlForPartial(qe,{editview:"permissions",editIndex:null}),active:je==="permissions"}),Gt.children.push({text:(0,N.t)("dashboard-settings.json-editor.title","JSON Model"),url:t.I.getUrlForPartial(qe,{editview:"json-model",editIndex:null}),active:je==="json-model"}),{navModel:Lt,pageNav:Gt}}function Ar(Qe){switch(Qe){case"annotations":return new Wt({});case"variables":return new Oo({});case"links":return new Vn({});case"versions":return new Io({});case"json-model":return new nr({});case"permissions":return new bt({});case"settings":default:return new Fa({})}}var Nr=e(97246),Wr=e(11675);class Yr extends i.Bs{constructor(je){super(je),this.addActivationHandler(this._activationHandler.bind(this))}_activationHandler(){const je=this.state.panelRef.resolve();return(0,Fe.M6)(je)}getUrlKey(){return this.state.panelRef.resolve().state.key}static{this.Component=({model:je})=>{const{panelRef:qe}=je.useState(),dt=qe.resolve();return(0,v.jsx)(dt.Component,{model:dt})}}}var pr=e(30195);class Jr{constructor(je){this._scene=je}getKeys(){return["inspect","viewPanel","editPanel","editview","autofitpanels","kiosk","shareView"]}getUrlState(){const je=this._scene.state;return{inspect:je.inspectPanelKey,autofitpanels:this.getAutoFitPanels(),viewPanel:je.viewPanelScene?.getUrlKey(),editview:je.editview?.getUrlKey(),editPanel:je.editPanel?.getUrlKey()||void 0,kiosk:je.kioskMode===ne.KioskMode.Full?"":je.kioskMode===ne.KioskMode.TV?"tv":void 0,shareView:je.shareView}}getAutoFitPanels(){if(this._scene.state.body instanceof St.D)return this._scene.state.body.state.grid.state.UNSAFE_fitPanels?"true":void 0}updateFromUrl(je){const{inspectPanelKey:qe,viewPanelScene:dt,isEditing:Lt,editPanel:Vt,shareView:Gt}=this._scene.state,en={};if(typeof je.editview=="string"&&this._scene.canEditDashboard()?(en.editview=Ar(je.editview),Lt||(this._scene.state.editable?setTimeout(()=>this._scene.onEnterEditMode()):en.editview=void 0)):je.hasOwnProperty("editview")&&(en.editview=void 0),typeof je.inspect=="string"){let En=(0,Fe.vL)(this._scene,je.inspect);if(!En){l.A.emit(n.r1.alertError,["Panel not found"]),a.Ny.partial({inspect:null});return}en.inspectPanelKey=je.inspect,en.overlay=new gr({panelRef:En.getRef()})}else qe&&(en.inspectPanelKey=void 0,en.overlay=void 0);if(typeof je.viewPanel=="string"){const En=(0,Fe.vL)(this._scene,je.viewPanel);if(!En){if((0,Fe.SN)(je.viewPanel)){this._handleViewRepeatClone(je.viewPanel);return}l.A.emit(n.r1.alertError,["Panel not found"]),a.Ny.partial({viewPanel:null});return}en.viewPanelScene=new Yr({panelRef:En.getRef()})}else dt&&je.viewPanel===null&&(en.viewPanelScene=void 0);if(typeof je.editPanel=="string"){const En=(0,Fe.vL)(this._scene,je.editPanel);if(!En){console.warn(`Panel ${je.editPanel} not found`);return}this._scene.state.viewPanelScene&&this._scene.setState({viewPanelScene:void 0}),Lt||this._scene.onEnterEditMode();const rs=(0,Fe.iL)(En);if(rs&&!rs?.state.isLoaded){this._waitForLibPanelToLoadBeforeEnteringPanelEdit(En,rs);return}en.editPanel=(0,Ha.L)(En)}else Vt&&je.editPanel===null&&(en.editPanel=void 0);typeof je.shareView=="string"?(en.shareView=je.shareView,en.overlay=r.$.featureToggles.newDashboardSharingComponent?new Nr.j({shareView:je.shareView}):new Wr.Z({activeTab:je.shareView})):Gt&&je.shareView===null&&(en.overlay=void 0,en.shareView=void 0);const bn=this._scene.state.body;if(bn instanceof St.D){const En=typeof je.autofitpanels=="string";!!bn.state.grid.state.UNSAFE_fitPanels!==En&&bn.state.grid.setState({UNSAFE_fitPanels:En})}typeof je.kiosk=="string"&&(je.kiosk==="true"||je.kiosk===""?en.kioskMode=ne.KioskMode.Full:je.kiosk==="tv"&&(en.kioskMode=ne.KioskMode.TV)),Object.keys(en).length>0&&this._scene.setState(en)}_handleViewRepeatClone(je){this._eventSub||(this._eventSub=this._scene.subscribeToEvent(pr.d,()=>{const qe=(0,Fe.vL)(this._scene,je);qe&&(this._eventSub?.unsubscribe(),this._scene.setState({viewPanelScene:new Yr({panelRef:qe.getRef()})}))}))}_waitForLibPanelToLoadBeforeEnteringPanelEdit(je,qe){const dt=qe.subscribeToState(Lt=>{Lt.isLoaded&&(this._scene.setState({editPanel:(0,Ha.L)(je)}),dt.unsubscribe())})}}var qa=e(79284),Ga=e(20485),uo=e(69129),dr=e(4898);class Lo{constructor(){this._binds=[]}addBinding(je){dr.R.bind(je.key,qe=>{qe.preventDefault(),qe.stopPropagation(),qe.returnValue=!1,je.onTrigger()},"keydown"),this._binds.push(je)}removeAll(){this._binds.forEach(je=>{dr.R.unbind(je.key,je.type)}),this._binds=[]}}var Zr=e(22699),Xr=e(7196);function ho(Qe){const je=new Lo;let qe=null;const dt=Qe.canEditDashboard(),Lt=l.A.subscribe(uo.Tp,Gt=>{typeof Gt.payload.panelId=="string"&&(qe=Gt.payload.panelId)});function Vt(Gt,en){return()=>{const bn=i.jh.findObject(Gt,En=>En.state.key===qe);if(bn&&bn instanceof i.Eb){en(bn);return}}}return je.addBinding({key:"v",onTrigger:Vt(Qe,Gt=>{if(!Qe.state.viewPanelScene){const en=t.I.stripBaseFromUrl((0,ze.r7)(Gt));a.Ny.push(en)}})}),r.$.featureToggles.newDashboardSharingComponent?(je.addBinding({key:"p u",onTrigger:Vt(Qe,async Gt=>{const en=new Nr.j({shareView:Zr.wr.link,panelRef:Gt.getRef()});Qe.showModal(en)})}),je.addBinding({key:"p e",onTrigger:Vt(Qe,async Gt=>{const en=new Nr.j({shareView:Zr.wr.embed,panelRef:Gt.getRef()});Qe.showModal(en)})}),mt.TP.isSignedIn&&r.$.snapshotEnabled&&Qe.canEditDashboard()&&je.addBinding({key:"p s",onTrigger:Vt(Qe,async Gt=>{const en=new Nr.j({shareView:Zr.wr.snapshot,panelRef:Gt.getRef()});Qe.showModal(en)})})):je.addBinding({key:"p s",onTrigger:Vt(Qe,async Gt=>{Qe.showModal(new Wr.Z({panelRef:Gt.getRef()}))})}),je.addBinding({key:"i",onTrigger:Vt(Qe,async Gt=>{a.Ny.push((0,ze.Uu)(Gt))})}),je.addBinding({key:"p x",onTrigger:Vt(Qe,async Gt=>{const en=await(0,ze.Lp)(Gt);en&&a.Ny.push(en)})}),je.addBinding({key:"p l",onTrigger:Vt(Qe,Xr.vR)}),je.addBinding({key:"d r",onTrigger:()=>i.jh.getTimeRange(Qe).onRefresh()}),je.addBinding({key:"t z",onTrigger:()=>{_r(Qe)}}),je.addBinding({key:"ctrl+z",onTrigger:()=>{_r(Qe)}}),je.addBinding({key:"t a",onTrigger:()=>{be.b4.getTimePicker(Qe)?.toAbsolute()}}),je.addBinding({key:"t left",onTrigger:()=>{qr(Qe,"left")}}),je.addBinding({key:"t right",onTrigger:()=>{qr(Qe,"right")}}),dt&&(je.addBinding({key:"e",onTrigger:Vt(Qe,async Gt=>{if(Gt.getRoot()instanceof po){const bn=(0,Fe.Cs)(Gt);if(!Qe.state.editPanel){const En=t.I.stripBaseFromUrl((0,ze.e0)(bn));a.Ny.push(En)}}})}),je.addBinding({key:"d s",onTrigger:Qe.onOpenSettings}),je.addBinding({key:"mod+s",onTrigger:()=>Qe.openSaveDrawer({})}),je.addBinding({key:"p r",onTrigger:Vt(Qe,Gt=>{Qe.state.isEditing&&(0,Xr.MI)(Qe,Gt)})}),je.addBinding({key:"p d",onTrigger:Vt(Qe,Gt=>{Qe.state.isEditing&&Qe.duplicatePanel(Gt)})}),je.addBinding({key:"d shift+c",onTrigger:()=>{Qe.state.body instanceof St.D&&Qe.state.body.collapseAllRows()}}),je.addBinding({key:"d shift+e",onTrigger:()=>{Qe.state.body instanceof St.D&&Qe.state.body.expandAllRows()}})),()=>{je.removeAll(),Lt.unsubscribe()}}function _r(Qe){be.b4.getTimePicker(Qe)?.onZoom()}function qr(Qe,je){const qe=be.b4.getTimePicker(Qe);qe&&(je==="left"&&qe.onMoveBackward(),je==="right"&&qe.onMoveForward())}const fo=["title","description","tags","editable","graphTooltip","links","meta","preload"],eo="systemPanelFilterVar",go="systemDynamicRowSizeVar";class po extends i.Bs{constructor(je){super({title:"Dashboard",meta:{},editable:!0,$timeRange:je.$timeRange??new i.JZ({}),body:je.body??St.D.fromVizPanels(),links:je.links??[],...je}),this._urlSync=new Jr(this),this._variableDependency=new jo(this),this._fromExplore=!1,this.onEnterEditMode=(qe=!1)=>{this._fromExplore=qe,this._initialState=i.Go.cloneSceneObjectState(this.state),this._initialUrlState=a.Ny.getLocation(),this.setState({isEditing:!0}),this.state.body.editModeChanged(!0),this._scopesFacade?.enterReadOnly(),this._changeTracker.startTrackingChanges()},this.onRestore=async qe=>{const dt=await It.wL.restoreDashboard(qe.uid,qe.version);if(!Number.isInteger(dt.version))return!1;const Lt={dashboard:new m.G(qe.data),meta:this.state.meta},Vt=(0,Tt.wM)(Lt),Gt=i.Go.cloneSceneObjectState(Vt.state);return Gt.version=dt.version,this.setState(Gt),this.exitEditMode({skipConfirm:!0,restoreInitialState:!1}),!0},this.onOpenSettings=()=>{a.Ny.partial({editview:"settings"})},this.onSetScrollRef=qe=>{this._scrollRef=qe},this._scopesFacade=(0,p.DF)(this),this._changeTracker=new x.l(this),this.addActivationHandler(()=>this._activationHandler())}static{this.Component=ds}_activationHandler(){let je=window.__grafanaSceneContext;window.__grafanaSceneContext=this,this._initializePanelSearch(),this.state.isEditing&&(this._initialUrlState=a.Ny.getLocation(),this._changeTracker.startTrackingChanges()),this.state.meta.isNew&&(this.onEnterEditMode(),this.setState({isDirty:!0})),!this.state.meta.isEmbedded&&this.state.uid&&u.t.watch(this.state.uid);let qe=()=>{};r.$.publicDashboardAccessToken||(qe=ho(this));const dt=new Be(this);return(0,o.UA)().setCurrent(dt),()=>{window.__grafanaSceneContext=je,qe(),this._changeTracker.terminate(),dt.destroy(),u.t.leave()}}_initializePanelSearch(){const je=i.jh.lookupVariable(eo,this)?.getValue();typeof je=="string"&&this.setState({panelSearch:je});const qe=i.jh.lookupVariable(go,this)?.getValue();if(typeof qe=="string"){const dt=Number.parseInt(qe,10);this.setState({panelsPerRow:Number.isInteger(dt)?dt:void 0})}}saveCompleted(je,qe,dt){this._initialSaveModel={...je,id:qe.id,uid:qe.uid,version:qe.version},this._changeTracker.stopTrackingChanges(),this.setState({version:qe.version,isDirty:!1,uid:qe.uid,id:qe.id,meta:{...this.state.meta,uid:qe.uid,url:qe.url,slug:qe.slug,folderUid:dt,isNew:!1}}),this.state.editPanel?.dashboardSaved(),this._changeTracker.startTrackingChanges()}exitEditMode({skipConfirm:je,restoreInitialState:qe}){if(!this.canDiscard()){console.error("Trying to discard back to a state that does not exist, initialState undefined");return}if(!this.state.isDirty||je){this.exitEditModeConfirmed(qe||this.state.isDirty),this._scopesFacade?.exitReadOnly();return}l.A.publish(new y.bY({title:"Discard changes to dashboard?",text:"You have unsaved changes to this dashboard. Are you sure you want to discard them?",icon:"trash-alt",yesText:"Discard",onConfirm:()=>{this.exitEditModeConfirmed(),this._scopesFacade?.exitReadOnly()}}))}exitEditModeConfirmed(je=!0){this._changeTracker.stopTrackingChanges();const qe=t.I.getUrlForPartial(this._initialUrlState,{editPanel:null,editview:null,inspect:null,inspectTab:null,shareView:null});a.Ny.replace(t.I.stripBaseFromUrl(qe)),this._fromExplore&&this.cleanupStateFromExplore(),je?this.setState({...this._initialState,isEditing:!1}):this.setState({isEditing:!1}),this.state.editPanel&&this.state.editPanel.onDiscard(),this.state.body.editModeChanged(!1)}cleanupStateFromExplore(){this._fromExplore=!1,this._initialSaveModel?.panels&&(this._initialSaveModel.panels=this._initialSaveModel.panels.slice(1)),this._initialState&&this._initialState.body.cleanUpStateFromExplore?.()}canDiscard(){return this._initialState!==void 0}pauseTrackingChanges(){this._changeTracker.stopTrackingChanges()}resumeTrackingChanges(){this._changeTracker.startTrackingChanges()}openSaveDrawer({saveAsCopy:je,onSaveSuccess:qe}){this.state.isEditing&&this.setState({overlay:new ut({dashboardRef:this.getRef(),saveAsCopy:je,onSaveSuccess:qe})})}getPageNav(je,qe){const{meta:dt,viewPanelScene:Lt,editPanel:Vt}=this.state;if(dt.dashboardNotFound)return{text:"Not found"};let Gt={text:this.state.title,url:(0,ze.uZ)({uid:this.state.uid,slug:dt.slug,currentQueryParams:je.search,updateQuery:{viewPanel:null,inspect:null,editview:null,editPanel:null,tab:null,shareView:null},isHomeDashboard:!dt.url&&!dt.slug&&!dt.isNew})};const{folderUid:en}=dt;if(en){const bn=(0,c.tc)(qe,`folder-dashboards-${en}`).main;bn.id!=="not-found"&&(Gt={...Gt,parentItem:bn})}return Lt&&(Gt={text:"View panel",parentItem:Gt,url:(0,ze.r7)(Lt.state.panelRef.resolve())}),Vt&&(Gt={text:"Edit panel",parentItem:Gt}),Gt}getBodyToRender(){return this.state.viewPanelScene??this.state.body}getInitialState(){return this._initialState}addPanel(je){this.state.isEditing||this.onEnterEditMode(),this.state.body.addPanel(je)}createLibraryPanel(je,qe){const dt=je.clone({$behaviors:[new ot.u({uid:qe.uid,name:qe.name})]}),Lt=je.parent;if(!(Lt instanceof tt.U))throw new Error("Trying to replace a panel that doesn't have a parent grid item");Lt.setState({body:dt})}duplicatePanel(je){this.state.body.duplicatePanel(je)}copyPanel(je){if(!je.parent)return;let qe=je.parent;if(!(qe instanceof tt.U))throw console.error("Trying to copy a panel that is not DashboardGridItem child"),new Error("Trying to copy a panel that is not DashboardGridItem child");const dt=(0,We.ZB)(qe);h.A.set(d.tH,JSON.stringify(dt)),l.A.emit(n.r1.alertSuccess,["Panel copied. Use **Paste panel** toolbar action to paste."])}pastePanel(){const je=h.A.get(d.tH),qe=JSON.parse(je),dt=new m.a(qe),Lt=(0,Tt.tt)(dt),Vt=be.b4.getNextPanelId(this),Gt=Lt.state.body;Gt.setState({key:(0,Fe.XA)(Vt)}),Gt.clearParent(),this.state.body.addPanel(Gt),h.A.delete(d.tH)}removePanel(je){this.state.body.removePanel(je)}unlinkLibraryPanel(je){if(!je.parent)return;const qe=je.parent;if(!(qe instanceof tt.U)){console.error("Trying to unlink a lib panel in a layout that is not DashboardGridItem");return}qe.state.body.setState({$behaviors:void 0})}showModal(je){this.setState({overlay:je})}closeModal(){this.setState({overlay:void 0})}async onStarDashboard(){const{meta:je,uid:qe}=this.state;if(qe)try{const dt=await(0,o.UA)().starDashboard(qe,!!je.isStarred);this.setState({meta:{...je,isStarred:dt}})}catch(dt){console.error("Failed to star dashboard",dt)}}onShowAddLibraryPanelDrawer(je){this.setState({overlay:new gt({panelToReplaceRef:je})})}onCreateNewRow(){this.state.body.addNewRow()}onCreateNewPanel(){const je=(0,Fe.O8)(this);return this.addPanel(je),je}enrichDataRequest(je){const qe=(0,Fe.YQ)(je);let dt=(0,Fe.xz)(je);qe.state.isEditing&&qe.state.editPanel&&(dt=qe.state.editPanel.state.panelRef.resolve());let Lt=0;return dt&&dt.state.key&&((0,Fe.SN)(dt.state.key)?Lt=Ke(dt?.state.key):Lt=(0,Fe.Cs)(dt)),{app:s.Jk.Dashboard,dashboardUID:this.state.uid,panelId:Lt,panelPluginId:dt?.state.pluginId,scopes:this._scopesFacade?.value}}enrichFiltersRequest(){return{scopes:this._scopesFacade?.value}}canEditDashboard(){const{meta:je}=this.state;return!!(je.canEdit||je.canMakeEditable)}getInitialSaveModel(){return this._initialSaveModel}setInitialSaveModel(je){this._initialSaveModel=je}async onDashboardDelete(){this.setState({isDirty:!1}),a.Ny.replace("/")}getDashboardPanels(){return be.b4.getVizPanels(this)}hasDashboardAngularPlugins(){const je=this.state.body;return je instanceof St.D?je.state.grid.state.children.some(Lt=>{if(!(Lt instanceof tt.U))return!1;const Vt=(0,Ga.Wu)(Lt.state.body),Gt=(0,Ga.Tr)(Lt.state.body);return Vt||Gt}):!1}rememberScrollPos(){this._prevScrollPos=this._scrollRef?.scrollTop}restoreScrollPos(){this._prevScrollPos!==void 0&&this._scrollRef?.scrollTo(0,this._prevScrollPos)}}class jo{constructor(je){this._dashboard=je,this._emptySet=new Set}getNames(){return this._emptySet}hasDependencyOn(){return!1}variableUpdateCompleted(je,qe){if(qe&&(l.A.publish(new f.og({refreshAll:!0,panelIds:[]})),this._dashboard.publishEvent(new g._)),je.state.name===eo){const Lt=je.getValue();typeof Lt=="string"&&this._dashboard.setState({panelSearch:Lt})}else if(je.state.name===go){const Lt=je.getValue();if(typeof Lt=="string"){const Vt=Number.parseInt(Lt,10);this._dashboard.setState({panelsPerRow:Number.isInteger(Vt)?Vt:void 0})}}const dt=this._dashboard.state.body;if(dt instanceof St.D){for(const Lt of dt.state.grid.state.children)if(!(!(Lt instanceof i.tI)||!Lt.state.$behaviors))for(const Vt of Lt.state.$behaviors)Vt instanceof qa.L&&(Vt.isWaitingForVariables||Vt.state.variableName===je.state.name&&qe?Vt.performRepeat(!0):!Vt.isWaitingForVariables&&Vt.state.variableName===je.state.name&&Vt.notifyRepeatedPanelsWaitingForVariables(je))}}}},68435:(G,R,e)=>{"use strict";e.d(R,{u:()=>c});var t=e(74848),n=e(65158),s=e(84537),a=e(67061),r=e(8484),g=e(34214),i=e(57767),l=e(96556),d=e(41507);class c extends s.Bs{static{this.LOADING_VIZ_PANEL_PLUGIN_ID="library-panel-loading-plugin"}constructor(u){super(u),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){this.state.isLoaded||this.loadLibraryPanelFromPanelModel()}setPanelFromLibPanel(u){if(this.state._loadedPanel?.version===u.version)return;const p=this.parent;if(!(p instanceof s.Eb))return;const f=new g.a(u.model),y={title:f.title,options:f.options??{},fieldConfig:f.fieldConfig,pluginId:f.type,pluginVersion:f.pluginVersion,displayMode:f.transparent?"transparent":void 0,description:f.description,$data:(0,l.w)(f)};p.setState(y),p.changePluginType(f.type,y.options,y.fieldConfig),this.setState({_loadedPanel:u,isLoaded:!0,name:u.name,title:f.title});const x=p.parent;f.repeat&&x instanceof d.U&&(x.setState({variableName:f.repeat,repeatDirection:f.repeatDirection==="h"?"h":"v",maxPerRow:f.maxPerRow,itemHeight:x.state.height??10}),x.performRepeat())}unlink(){const u=this.parent;u instanceof s.Eb&&u.setState({$behaviors:u.state.$behaviors?.filter(p=>p!==this)})}async loadLibraryPanelFromPanelModel(){let u=this.parent;if(u instanceof s.Eb)try{const p=await(0,i.Yr)(this.state.uid,!0);this.setPanelFromLibPanel(p)}catch{u.setState({_pluginLoadError:`Unable to load library panel: ${this.state.uid}`})}}}const h=new n.m(o);function o(m){return(0,t.jsx)(a.B,{direction:"column",justifyContent:"space-between",children:(0,t.jsx)(r.x6,{i18nKey:"library-panels.loading-panel-text",children:"Loading library panel"})})}s.Go.registerRuntimePanelPlugin({pluginId:c.LOADING_VIZ_PANEL_PLUGIN_ID,plugin:h})},70453:(G,R,e)=>{"use strict";e.d(R,{c:()=>Z,v:()=>q});var t=e(74848),n=e(96540),s=e(32196),a=e(68941),r=e(13544),g=e(32264),i=e(39601),l=e(40845),d=e(27746),c=e(14578),h=e(39938),o=e(83122),m=e(38138),u=e(55852),p=e(19727),f=e(67061),y=e(15068),x=e(75269),v=e(10804),P=e(15054),E=e(10096),D=e(8484),C=e(14792),b=e(2609),T=e(53001),S=e(22699),O=e(34865),M=e(30040);const I=r.Tp.pages.Dashboard.DashNav.NewExportButton;function L({dashboard:te}){const[ne,le]=(0,n.useState)(!1),re=(0,n.useCallback)(oe=>{le(oe)},[]),de=()=>(0,t.jsx)(M.A,{dashboard:te});return(0,t.jsx)(p.e,{"data-testid":I.container,children:(0,t.jsx)(o.m,{overlay:de,placement:"bottom-end",onVisibleChange:re,children:(0,t.jsxs)(u.$n,{"data-testid":I.arrowMenu,size:"sm",variant:"secondary",fill:"solid",tooltip:(0,D.t)("export.menu.export-as-json-tooltip","Export"),children:[(0,t.jsx)(D.x6,{i18nKey:"export.menu.export-as-json-label",children:"Export"}),"\xA0",(0,t.jsx)(c.I,{name:ne?"angle-up":"angle-down",size:"sm"})]})})})}var B=e(41053),j=e(7758),A=e(66714),K=e(70439);const W=r.Tp.pages.Dashboard.DashNav.newShareButton;function U({dashboard:te,panel:ne}){const le=(0,l.of)(F),[re,de]=(0,n.useState)(!1),[oe,J]=(0,B.A)(async()=>(j.c.toolbarShareClick(),await(0,K.Xe)(te,ne)),[te]),ce=(0,n.useCallback)(xe=>{de(xe)},[]),pe=()=>(0,t.jsx)(A.Ay,{dashboard:te});return(0,t.jsxs)(p.e,{"data-testid":W.container,className:le.container,children:[(0,t.jsx)(u.$n,{"data-testid":W.shareLink,size:"sm",tooltip:(0,D.t)("share-dashboard.share-button-tooltip","Copy link"),onClick:J,children:(0,t.jsx)(D.x6,{i18nKey:"share-dashboard.share-button",children:"Share"})}),(0,t.jsx)(o.m,{overlay:pe,placement:"bottom-end",onVisibleChange:ce,children:(0,t.jsx)(u.$n,{"data-testid":W.arrowMenu,size:"sm",icon:re?"angle-up":"angle-down"})})]})}function F(te){return{container:(0,s.css)({gap:1})}}var V=e(99246),w=e(74730),z=e(80997),N=e(96374),H=e(28138),Q=e(28444);function X(te){return(0,t.jsx)(d.I,{"data-testid":"button-snapshot",tooltip:(0,D.t)("dashboard.toolbar.open-original","Open original dashboard"),icon:"link",onClick:()=>ee(te.originalURL)},"button-snapshot")}const ee=te=>{const ne=te??"",le=z.sQ.sanitizeUrl(ne);try{const re=new URL(le,g.$.appUrl),de=new URL(g.$.appUrl);re.host!==de.host?H.A.publish(new Q.S8({component:N.u,props:{title:"Proceed to external site?",modalClass:(0,s.css)({width:"max-content",maxWidth:"80vw"}),body:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{children:["This link connects to an external website at"," ",(0,t.jsx)("code",{children:ne})]}),(0,t.jsx)("p",{children:"Are you sure you'd like to proceed?"})]}),confirmVariant:"primary",confirmText:"Proceed",onConfirm:()=>{window.location.href=re.href}}})):i.Ny.push(le)}catch(re){console.error("Failed to open original dashboard",re)}},Z=n.memo(({dashboard:te})=>{const ne=(0,n.useId)(),le=(0,t.jsx)(q,{dashboard:te},ne);return(0,t.jsx)(x.H,{actions:le})});Z.displayName="NavToolbarActions";function q({dashboard:te}){const{isEditing:ne,viewPanelScene:le,isDirty:re,uid:de,meta:oe,editview:J,editPanel:ce,editable:pe}=te.useState(),{isPlaying:xe}=b._o.useState(),[fe,Ee]=(0,n.useState)(!1),Se=E.TP.hasEditPermissionInFolders,ye=[],Ve=(0,l.of)(se),Me=!!ce,Ce=!!le,Ue=k(ce),Ae=ce&&(0,w.ME)(ce.state.panelRef.resolve()),we=a.M.exists(P.tH),We=!J&&!Ce&&!Me,_e=ne&&We,at=g.$.featureToggles.singleTopNav&&g.$.featureToggles.scopeFilters;Me||ae(ye,V.C.left,"left-actions"),ye.push({group:"icon-actions",condition:de&&!!oe.canStar&&We&&!ne,render:()=>{let Ie=oe.isStarred?(0,D.t)("dashboard.toolbar.unmark-favorite","Unmark as favorite"):(0,D.t)("dashboard.toolbar.mark-favorite","Mark as favorite");return(0,t.jsx)(d.I,{tooltip:Ie,icon:(0,t.jsx)(c.I,{name:oe.isStarred?"favorite":"star",size:"lg",type:oe.isStarred?"mono":"default"}),"data-testid":r.Tp.components.NavToolbar.markAsFavorite,onClick:()=>{j.c.toolbarFavoritesClick(),te.onStarDashboard()}},"star-dashboard-button")}}),oe.publicDashboardEnabled&&ye.push({group:"icon-actions",condition:de&&!!oe.canStar&&We&&!ne,render:()=>(0,t.jsx)(h.E,{color:"blue",text:"Public",className:Ve.publicBadge,"data-testid":r.Tp.pages.Dashboard.DashNav.publicDashboardTag},"public-dashboard-button-badge")});const ut=g.$.buildInfo.env==="development";ye.push({group:"icon-actions",condition:ut&&de&&We&&!ne,render:()=>(0,t.jsx)(d.I,{tooltip:"Switch to old dashboard page",icon:"apps",onClick:()=>{i.Ny.partial({scenes:!1})}},"view-in-old-dashboard-button")}),ye.push({group:"icon-actions",condition:oe.isSnapshot&&!oe.dashboardNotFound&&!ne,render:()=>(0,t.jsx)(X,{originalURL:te.getInitialSaveModel()?.snapshot?.originalUrl??""},"go-to-snapshot-origin")}),!Me&&!ne&&ae(ye,V.C.right,"icon-actions"),ye.push({group:"add-panel",condition:_e,render:()=>(0,t.jsx)(o.m,{onVisibleChange:Ie=>{Ee(Ie),j.c.toolbarAddClick()},overlay:()=>(0,t.jsxs)(m.W,{children:[(0,t.jsx)(m.W.Item,{testId:r.Tp.pages.AddDashboard.itemButton("Add new visualization menu item"),label:(0,D.t)("dashboard.add-menu.visualization","Visualization"),onClick:()=>{const Ie=te.onCreateNewPanel();j.c.toolbarAddButtonClicked({item:"add_visualization"}),te.setState({editPanel:(0,O.L)(Ie,!0)})}},"add-visualization"),(0,t.jsx)(m.W.Item,{testId:r.Tp.pages.AddDashboard.itemButton("Add new panel from panel library menu item"),label:(0,D.t)("dashboard.add-menu.import","Import from library"),onClick:()=>{te.onShowAddLibraryPanelDrawer(),j.c.toolbarAddButtonClicked({item:"add_library_panel"})}},"add-panel-lib"),(0,t.jsx)(m.W.Item,{testId:r.Tp.pages.AddDashboard.itemButton("Add new row menu item"),label:(0,D.t)("dashboard.add-menu.row","Row"),onClick:()=>{te.onCreateNewRow(),j.c.toolbarAddButtonClicked({item:"add_row"})}},"add-row"),(0,t.jsx)(m.W.Item,{disabled:!we,testId:r.Tp.pages.AddDashboard.itemButton("Add new panel from clipboard menu item"),label:(0,D.t)("dashboard.add-menu.paste-panel","Paste panel"),onClick:()=>{te.pastePanel(),j.c.toolbarAddButtonClicked({item:"paste_panel"})}},"paste-panel")]}),placement:"bottom",offset:[0,6],children:(0,t.jsxs)(u.$n,{variant:"primary",size:"sm",fill:"outline","data-testid":r.Tp.components.PageToolbar.itemButton("Add button"),children:[(0,t.jsx)(D.x6,{i18nKey:"dashboard.toolbar.add",children:"Add"}),(0,t.jsx)(c.I,{name:fe?"angle-up":"angle-down",size:"lg"})]},"add-panel-button")},"add-panel-dropdown")}),ye.push({group:"playlist-actions",condition:xe&&We&&!ne,render:()=>(0,t.jsx)(d.I,{"data-testid":r.Tp.pages.Dashboard.DashNav.playlistControls.prev,tooltip:(0,D.t)("dashboard.toolbar.playlist-previous","Go to previous dashboard"),icon:"backward",onClick:()=>b._o.prev()},"play-list-prev")}),ye.push({group:"playlist-actions",condition:xe&&We&&!ne,render:()=>(0,t.jsx)(d.I,{onClick:()=>b._o.stop(),"data-testid":r.Tp.pages.Dashboard.DashNav.playlistControls.stop,children:(0,t.jsx)(D.x6,{i18nKey:"dashboard.toolbar.playlist-stop",children:"Stop playlist"})},"play-list-stop")}),ye.push({group:"playlist-actions",condition:xe&&We&&!ne,render:()=>(0,t.jsx)(d.I,{"data-testid":r.Tp.pages.Dashboard.DashNav.playlistControls.next,tooltip:(0,D.t)("dashboard.toolbar.playlist-next","Go to next dashboard"),icon:"forward",onClick:()=>b._o.next(),narrow:!0},"play-list-next")}),ye.push({group:"back-button",condition:(Ce||Me)&&!Ae,render:()=>(0,t.jsx)(u.$n,{onClick:()=>{i.Ny.partial({viewPanel:null,editPanel:null})},tooltip:"",variant:"secondary",size:"sm",icon:"arrow-left","data-testid":r.Tp.components.NavToolbar.editDashboard.backToDashboardButton,children:"Back to dashboard"},"back")}),ye.push({group:"back-button",condition:!!J,render:()=>(0,t.jsx)(u.$n,{onClick:()=>{i.Ny.partial({editview:null})},tooltip:"",fill:"text",variant:"secondary",size:"sm",icon:"arrow-left","data-testid":r.Tp.components.NavToolbar.editDashboard.backToDashboardButton,children:"Back to dashboard"},"back")});const Tt=de&&!ne&&!oe.isSnapshot&&!xe;ye.push({group:"main-buttons",condition:!g.$.featureToggles.newDashboardSharingComponent&&Tt,render:()=>(0,t.jsx)(u.$n,{tooltip:(0,D.t)("dashboard.toolbar.share","Share dashboard"),size:"sm",className:Ve.buttonWithExtraMargin,fill:"outline",onClick:()=>{j.c.toolbarShareClick(),i.Ny.partial({shareView:S.wr.link})},"data-testid":r.Tp.components.NavToolbar.shareDashboard,children:"Share"},"share-dashboard-button")}),ye.push({group:"main-buttons",condition:!ne&&te.canEditDashboard()&&!Ce&&!xe&&pe,render:()=>(0,t.jsx)(u.$n,{onClick:()=>{te.onEnterEditMode()},tooltip:"Enter edit mode",className:Ve.buttonWithExtraMargin,variant:g.$.featureToggles.newDashboardSharingComponent?"secondary":"primary",size:"sm","data-testid":r.Tp.components.NavToolbar.editDashboard.editButton,children:"Edit"},"edit")}),ye.push({group:"main-buttons",condition:!ne&&te.canEditDashboard()&&!Ce&&!xe&&!pe,render:()=>(0,t.jsx)(u.$n,{onClick:()=>{te.onEnterEditMode(),te.setState({editable:!0,meta:{...oe,canEdit:!0}})},tooltip:"This dashboard was marked as read only",className:Ve.buttonWithExtraMargin,variant:"secondary",size:"sm","data-testid":r.Tp.components.NavToolbar.editDashboard.editButton,children:"Make editable"},"edit")}),ye.push({group:"new-share-dashboard-buttons",condition:g.$.featureToggles.newDashboardSharingComponent&&Tt,render:()=>(0,t.jsx)(L,{dashboard:te},"new-export-dashboard-button")}),ye.push({group:"new-share-dashboard-buttons",condition:g.$.featureToggles.newDashboardSharingComponent&&Tt,render:()=>(0,t.jsx)(U,{dashboard:te},"new-share-dashboard-button")}),ye.push({group:"settings",condition:ne&&te.canEditDashboard()&&We,render:()=>(0,t.jsx)(u.$n,{onClick:()=>{te.onOpenSettings()},tooltip:"Dashboard settings",fill:"text",size:"sm",variant:"secondary","data-testid":r.Tp.components.NavToolbar.editDashboard.settingsButton,children:"Settings"},"settings")}),ye.push({group:"main-buttons",condition:ne&&!oe.isNew&&We,render:()=>(0,t.jsx)(u.$n,{onClick:()=>te.exitEditMode({skipConfirm:!1}),tooltip:"Exits edit mode and discards unsaved changes",size:"sm",fill:"text",variant:"primary","data-testid":r.Tp.components.NavToolbar.editDashboard.exitButton,children:"Exit edit"},"discard")}),ye.push({group:"main-buttons",condition:Me&&!Ae&&!J&&!Ce,render:()=>(0,t.jsx)(u.$n,{onClick:ce?.onDiscard,tooltip:ce?.state.isNewPanel?"Discard panel":"Discard panel changes",size:"sm",disabled:!Ue,fill:"outline",variant:"destructive","data-testid":r.Tp.components.NavToolbar.editDashboard.discardChangesButton,children:ce?.state.isNewPanel?"Discard panel":"Discard panel changes"},"discard")}),ye.push({group:"main-buttons",condition:Me&&Ae&&!J&&!Ce,render:()=>(0,t.jsx)(u.$n,{onClick:ce?.onDiscard,tooltip:"Discard library panel changes",size:"sm",fill:"outline",variant:"destructive","data-testid":r.Tp.components.NavToolbar.editDashboard.discardChangesButton,children:"Discard library panel changes"},"discardLibraryPanel")}),ye.push({group:"main-buttons",condition:Me&&Ae&&!J&&!Ce,render:()=>(0,t.jsx)(u.$n,{onClick:ce?.onUnlinkLibraryPanel,tooltip:"Unlink library panel",size:"sm",fill:"outline",variant:"secondary","data-testid":r.Tp.components.NavToolbar.editDashboard.unlinkLibraryPanelButton,children:"Unlink library panel"},"unlinkLibraryPanel")}),ye.push({group:"main-buttons",condition:Me&&Ae&&!J&&!Ce,render:()=>(0,t.jsx)(u.$n,{onClick:ce?.onSaveLibraryPanel,tooltip:"Save library panel",size:"sm",fill:"outline",variant:"primary","data-testid":r.Tp.components.NavToolbar.editDashboard.saveLibraryPanelButton,children:"Save library panel"},"saveLibraryPanel")}),ye.push({group:"main-buttons",condition:ne&&!Ae&&(oe.canSave||Se),render:()=>{if(oe.isNew)return(0,t.jsx)(u.$n,{onClick:()=>{te.openSaveDrawer({})},className:Ve.buttonWithExtraMargin,tooltip:"Save changes",size:"sm",variant:"primary","data-testid":r.Tp.components.NavToolbar.editDashboard.saveButton,children:"Save dashboard"},"save");if(Se&&!oe.canSave&&!oe.canMakeEditable)return(0,t.jsx)(u.$n,{onClick:()=>{te.openSaveDrawer({saveAsCopy:!0})},className:Ve.buttonWithExtraMargin,tooltip:"Save as copy",size:"sm",variant:re?"primary":"secondary",children:"Save as copy"},"save");const Ie=(0,t.jsxs)(m.W,{children:[(0,t.jsx)(m.W.Item,{label:"Save",icon:"save",onClick:()=>{te.openSaveDrawer({})}}),(0,t.jsx)(m.W.Item,{label:"Save as copy",icon:"copy",onClick:()=>{te.openSaveDrawer({saveAsCopy:!0})}})]});return(0,t.jsxs)(p.e,{className:Ve.buttonWithExtraMargin,children:[(0,t.jsx)(u.$n,{onClick:()=>{te.openSaveDrawer({})},tooltip:"Save changes",size:"sm","data-testid":r.Tp.components.NavToolbar.editDashboard.saveButton,variant:re?"primary":"secondary",children:"Save dashboard"}),(0,t.jsx)(o.m,{overlay:Ie,children:(0,t.jsx)(u.$n,{"aria-label":"More save options",icon:"angle-down",variant:re?"primary":"secondary",size:"sm"})})]},"save")}});const It=[];let ge="";for(const Ie of ye)Ie.condition&&(ge&&ge!==Ie.group&&ge&&It.push((0,t.jsx)(v.K,{},`${Ie.group}-separator`)),It.push(Ie.render()),ge=Ie.group);return(0,t.jsxs)(f.B,{flex:1,minWidth:0,justifyContent:at?"space-between":"flex-end",children:[at&&(0,t.jsx)(T.Dh,{}),(0,t.jsx)(y.U,{alignment:"right",children:It})]})}function ae(te,ne,le){if(ne.length>0)for(const re of ne){const de={dashboard:(0,C.UA)().getCurrent()};if(re.show(de)){const oe=re.component;te.push({group:le,condition:!0,render:()=>(0,n.createElement)(oe,{...de,key:te.length})})}}}function k(te){const[ne,le]=(0,n.useState)();return(0,n.useEffect)(()=>{if(te){const re=te.subscribeToState(de=>{de.isDirty!==ne&&le(de.isDirty)});return()=>re.unsubscribe()}},[te,ne]),ne}function se(te){return{buttonWithExtraMargin:(0,s.css)({margin:te.spacing(0,.5)}),publicBadge:(0,s.css)({color:"grey",backgroundColor:"transparent",border:"1px solid"})}}},42397:(G,R,e)=>{"use strict";e.d(R,{$:()=>d,m:()=>h});var t=e(74848),n=e(84537),s=e(91052),a=e(14578),r=e(83122),g=e(27746),i=e(38138),l=e(7196);class d extends n.Bs{static{this.Component=c}}function c({model:m}){const{menu:u,rawLinks:p}=m.useState();if(!(m.parent instanceof n.Eb))throw new Error("VizPanelLinks must be a child of VizPanel");if(!p||p.length===0)return null;if(p.length===1){const f=(0,l.eQ)(m.parent)[0];return(0,t.jsx)(s.NR.TitleItem,{href:f.href,onClick:f.onClick,target:f.target,title:f.title,children:(0,t.jsx)(a.I,{name:"external-link-alt",size:"md"})})}return(0,t.jsx)(r.m,{overlay:()=>(0,t.jsx)(u.Component,{model:u},u.state.key),children:(0,t.jsx)(g.I,{icon:"external-link-alt",iconSize:"md","aria-label":"panel links"})})}class h extends n.Bs{static{this.Component=o}}function o({model:m}){const{links:u}=m.useState();return u?(0,t.jsx)(i.W,{children:u?.map((p,f)=>(0,t.jsx)(i.W.Item,{label:p.title,url:p.href,target:p.target,onClick:p.onClick},f))}):null}},7196:(G,R,e)=>{"use strict";e.d(R,{eQ:()=>pe,MI:()=>fe,oV:()=>ce,_i:()=>re,t0:()=>de,vR:()=>Se});var t=e(74135),n=e(1933),s=e(76885),a=e(32264),r=e(4402),g=e(39601),i=e(84537),l=e(28138),d=e(8484),c=e(16233),h=e(63066),o=e(22699),m=e(16560),u=e(32349),p=e(75462),f=e(19347),y=e(74730),x=e(12518),v=e(40588),P=e(74848),E=e(73145);class D extends i.Bs{static{this.Component=C}constructor(Ce){super(Ce),this.trail=b(Ce)}}function C({model:Me}){return(0,P.jsx)(Me.trail.Component,{model:Me.trail})}function b({metric:Me,filters:Ce,dataSourceUid:Ue,timeRangeState:Ae}){return new E.b({$timeRange:new i.JZ(Ae),metric:Me,initialDS:Ue,initialFilters:Ce,embedded:!0})}var T=e(32196),S=e(40845),O=e(87978),M=e(28444);function I(Me){const{scene:Ce,title:Ue,onDismiss:Ae}=Me,we=(0,S.of)(j);return(0,P.jsx)(O._,{title:Ue,onClose:Ae,size:"lg",children:(0,P.jsx)("div",{className:we.drawerInnerWrapper,children:(0,P.jsx)(Ce.Component,{model:Ce})})})}class L extends i.Bs{constructor(Ce){super(Ce)}static Component({model:Ce}){const Ue=Ce.useState();return(0,P.jsx)(I,{...Ue})}}function B(Me){const Ce={component:I,props:Me};appEvents.publish(new ShowModalReactEvent(Ce))}function j(Me){return{drawerInnerWrapper:(0,T.css)({display:"flex",padding:Me.spacing(2),background:Me.isDark?Me.colors.background.canvas:Me.colors.background.primary,position:"absolute",left:0,right:0,top:0})}}var A=e(76040);function K(Me){return Me.op==="="}function W(Me){return Me.state.$timeRange.state}function U({metric:Me,labelFilters:Ce}){if(Ce.length===0)return Me;const Ue=`{${Ce.map(({label:Ae,op:we,value:We})=>`${Ae}${we}"${We}"`)}}`;return`${Me}${Ue}`}function F(Me){return Me?.map(Ce=>({key:Ce.label,value:Ce.value,operator:Ce.op}))}function V(Me){const Ce=[];return Me.forEach(Ue=>{const Ae=(0,A.u)(Ue);if(Ae.errors.length>0)return;const{metric:we,labels:We}=Ae.query;Ce.push({metric:we,labelFilters:We.filter(K),query:Ue}),Ae.query.binaryQueries?.forEach(({query:{metric:_e,labels:at}})=>{Ce.push({metric:_e,labelFilters:at.filter(K),query:Ue})})}),Ce}async function w(Me,Ce,Ue){if(Ce.state.pluginId!=="timeseries")return;const Ae=(0,y.un)(Ce);if(Ae==null)return;const{queries:we,datasource:We,data:_e}=Ae.state;if(We==null||We.type!=="prometheus")return;const at=await(0,f.l)().get(We);if(at.interpolateVariablesInQueries==null)return;const ut=at.interpolateVariablesInQueries(we,{__sceneObject:{value:Ce}},_e?.request?.filters).filter(X),It=V(ut.map(ge=>ge.expr)).map(ge=>({text:U(ge),onClick:Q(ge,Me,at)}));It.length>0&&Ue.push({text:"Explore metrics",iconClassName:"code-branch",subMenu:z(It)})}function z(Me){const Ce=new Set;function Ue({text:Ae}){const we=Ce.size;return Ce.add(Ae),Ce.size>we}return Me.filter(Ue)}function N({metric:Me,labelFilters:Ce,query:Ue},Ae,we){return{metric:Me,filters:F(Ce),dataSourceUid:we,timeRangeState:Ae}}function H(Me,Ce,Ue){const Ae=W(Ce),we=N(Me,Ae,Ue.uid),We=new D(we);return We.trail.addActivationHandler(()=>{We.trail.state.topScene instanceof x.R&&We.trail.state.topScene.setActionView("breakdown")}),{scene:We,title:"Explore metrics"}}function Q(Me,Ce,Ue){return()=>{const Ae=H(Me,Ce,Ue),we=new L({...Ae,onDismiss:()=>Ce.closeModal()});(0,v.z)("exploration_started",{cause:"dashboard_panel"}),Ce.showModal(we)}}function X(Me){return"expr"in Me}var ee=e(97246),Z=e(11675),q=e(7758),ae=e(11982),k=e(55600),se=e(42397),te=e(54174);class ne extends i.Bs{constructor(){super(...arguments),this.onDismiss=()=>{(0,y.YQ)(this).closeModal()},this.onConfirm=()=>{const Ce=(0,y.YQ)(this);Ce.unlinkLibraryPanel(this.state.panelRef.resolve()),Ce.closeModal()}}static{this.Component=le}}function le({model:Me}){return(0,P.jsx)(te.l,{isOpen:!0,onConfirm:()=>{Me.onConfirm(),Me.onDismiss()},onDismiss:Me.onDismiss})}function re(Me,Ce=!1){(async()=>{const Ae=Me.parent,we=Ae.getPlugin(),We=[],_e=[],at=(0,y.YQ)(Ae),{isEmbedded:ut}=at.state.meta,Tt=await oe(Ae);if(ut){Tt&&Me.setState({items:[Tt]});return}const It=!!at.state.editPanel;if(It||We.push({text:(0,d.t)("panel.header-menu.view","View"),iconClassName:"eye",shortcut:"v",href:(0,ae.r7)(Ae)}),at.canEditDashboard()&&at.state.editable&&!Ce&&!It&&We.push({text:(0,d.t)("panel.header-menu.edit","Edit"),iconClassName:"edit",shortcut:"e",href:(0,ae.e0)((0,y.Cs)(Ae))}),a.$.featureToggles.newDashboardSharingComponent){const Ie=[];Ie.push({text:(0,d.t)("share-panel.menu.share-link-title","Share link"),iconClassName:"link",shortcut:"p u",onClick:()=>{const ue=new ee.j({shareView:o.wr.link,panelRef:Ae.getRef()});at.showModal(ue)}}),Ie.push({text:(0,d.t)("share-panel.menu.share-embed-title","Share embed"),iconClassName:"arrow",shortcut:"p e",onClick:()=>{const ue=new ee.j({shareView:o.wr.embed,panelRef:Ae.getRef()});at.showModal(ue)}}),c.TP.isSignedIn&&a.$.snapshotEnabled&&at.canEditDashboard()&&Ie.push({text:(0,d.t)("share-panel.menu.share-snapshot-title","Share snapshot"),iconClassName:"camera",shortcut:"p s",onClick:()=>{const ue=new ee.j({shareView:o.wr.snapshot,panelRef:Ae.getRef()});at.showModal(ue)}}),We.push({type:"submenu",text:(0,d.t)("panel.header-menu.share","Share"),iconClassName:"share-alt",subMenu:Ie,onClick:ue=>{ue.preventDefault()}})}else We.push({text:(0,d.t)("panel.header-menu.share","Share"),iconClassName:"share-alt",onClick:()=>{at.showModal(new Z.Z({panelRef:Ae.getRef()}))},shortcut:"p s"});at.state.isEditing&&!Ce&&!It&&_e.push({text:(0,d.t)("panel.header-menu.duplicate","Duplicate"),iconClassName:"file-copy-alt",onClick:()=>{at.duplicatePanel(Ae)},shortcut:"p d"}),It||_e.push({text:(0,d.t)("panel.header-menu.copy","Copy"),iconClassName:"copy",onClick:()=>{at.copyPanel(Ae)}}),at.state.isEditing&&!Ce&&!It&&((0,y.ME)(Ae)?(_e.push({text:(0,d.t)("panel.header-menu.unlink-library-panel","Unlink library panel"),iconClassName:"link-broken",onClick:()=>{at.showModal(new ne({panelRef:Ae.getRef()}))}}),_e.push({text:(0,d.t)("panel.header-menu.replace-library-panel","Replace library panel"),iconClassName:"library-panel",onClick:()=>{at.onShowAddLibraryPanelDrawer(Ae.getRef())}})):a.$.featureToggles.newDashboardSharingComponent?_e.push({text:(0,d.t)("share-panel.menu.new-library-panel-title","New library panel"),iconClassName:"plus-square",onClick:()=>{const Ie=new ee.j({shareView:o.wr.libraryPanel,panelRef:Ae.getRef()});at.showModal(Ie)}}):_e.push({text:(0,d.t)("panel.header-menu.create-library-panel","Create library panel"),onClick:()=>{at.showModal(new Z.Z({panelRef:Ae.getRef(),activeTab:o.wr.libraryPanel}))}})),_e.push({text:(0,d.t)("panel.header-menu.new-alert-rule","New alert rule"),iconClassName:"bell",onClick:Ie=>Ee(Ae)}),ye(Ae.state.options)&&!It&&_e.push({text:Ae.state.options.legend.showLegend?(0,d.t)("panel.header-menu.hide-legend","Hide legend"):(0,d.t)("panel.header-menu.show-legend","Show legend"),iconClassName:Ae.state.options.legend.showLegend?"legend-hide":"legend-show",onClick:Ie=>{Ie.preventDefault(),Se(Ae)},shortcut:"p l"}),at.canEditDashboard()&&we&&!we.meta.skipDataQuery&&!Ce&&_e.push({text:(0,d.t)("panel.header-menu.get-help","Get help"),iconClassName:"question-circle",onClick:Ie=>{Ie.preventDefault(),Ve(Ae,m.q.Help)}}),a.$.featureToggles.exploreMetrics&&await w(at,Ae,We),Tt&&We.push(Tt),We.push(J(we,Ae,at));const{extensions:ge}=(0,r.Kf)({extensionPointId:t.S.DashboardPanelMenu,context:xe(Ae,at),limitPerPlugin:3});ge.length>0&&!at.state.isEditing&&We.push({text:"Extensions",iconClassName:"plug",type:"submenu",subMenu:(0,p.N9)(ge)}),_e.length&&We.push({type:"submenu",text:(0,d.t)("panel.header-menu.more","More..."),iconClassName:"cube",subMenu:_e,onClick:Ie=>{Ie.preventDefault()}}),at.state.isEditing&&!Ce&&!It&&(We.push({text:"",type:"divider"}),We.push({text:(0,d.t)("panel.header-menu.remove","Remove"),iconClassName:"trash-alt",onClick:()=>{fe(at,Ae)},shortcut:"p r"})),Me.setState({items:We})})()}const de=Me=>re(Me,!0);async function oe(Me){const Ce=await(0,ae.Lp)(Me);if(Ce)return{text:(0,d.t)("panel.header-menu.explore","Explore"),iconClassName:"compass",shortcut:"p x",href:Ce}}function J(Me,Ce,Ue){const Ae=[];return Me&&!Me.meta.skipDataQuery&&(Ae.push({text:(0,d.t)("panel.header-menu.inspect-data","Data"),href:(0,ae.Uu)(Ce,m.q.Data),onClick:we=>{we.preventDefault(),g.Ny.partial({inspect:Ce.state.key,inspectTab:m.q.Data})}}),Ue instanceof k.H$&&Ue.state.meta.canEdit&&Ae.push({text:(0,d.t)("panel.header-menu.query","Query"),href:(0,ae.Uu)(Ce,m.q.Query),onClick:we=>{we.preventDefault(),g.Ny.partial({inspect:Ce.state.key,inspectTab:m.q.Query})}})),Ae.push({text:(0,d.t)("panel.header-menu.inspect-json","Panel JSON"),href:(0,ae.Uu)(Ce,m.q.JSON),onClick:we=>{we.preventDefault(),g.Ny.partial({inspect:Ce.state.key,inspectTab:m.q.JSON})}}),{text:(0,d.t)("panel.header-menu.inspect","Inspect"),iconClassName:"info-circle",shortcut:"i",href:(0,ae.Uu)(Ce),onClick:we=>{we.isDefaultPrevented()||g.Ny.partial({inspect:Ce.state.key,inspectTab:m.q.Data})},subMenu:Ae.length>0?Ae:void 0}}function ce(Me){if(!(Me.parent instanceof se.$))throw new Error("parent of VizPanelLinksMenu must be VizPanelLinks");const Ce=Me.parent.parent;if(!(Ce instanceof i.Eb))throw new Error("parent of VizPanelLinks must be VizPanel");Me.setState({links:pe(Ce)})}function pe(Me){const Ce=(we,We)=>i.jh.interpolate(Me,we,We),Ue=(0,u.CH)(Me,Ce);if(!Ue)return[];const Ae=Ue.getLinks(Ce);return Ae.map(we=>({...we,onClick:(_e,at)=>{q.c.panelLinkClicked({has_multiple_links:Ae.length>1}),we.onClick?.(_e,at)}}))}function xe(Me,Ce){const Ue=i.jh.getTimeRange(Me);let Ae=(0,y.un)(Me);const we=Ae?.state.queries,We=(0,y.Cs)(Me);let _e={};if(Me.state.$variables&&Me.state.$variables.state.variables.forEach(at=>{at instanceof i.xc&&(_e={..._e,[at.state.name]:{value:at.getValue(),text:at.getValueText()}})}),Me.parent?.parent instanceof i.tI){const at=Me.parent.parent;at.state.$variables&&at.state.$variables.state.variables.forEach(ut=>{ut instanceof i.xc&&(_e={..._e,[ut.state.name]:{value:ut.getValue(),text:ut.getValueText()}})})}return{id:We,pluginId:Me.state.pluginId,title:Me.state.title,timeRange:Ue.state.value.raw,timeZone:(0,n.O)({timeZone:Ue.getTimeZone()}),dashboard:{uid:Ce.state.uid,title:Ce.state.title,tags:Ce.state.tags||[]},targets:we,scopedVars:_e,data:Ae?.state.data}}function fe(Me,Ce){l.A.publish(new M.bY({title:"Remove panel",text:"Are you sure you want to remove this panel?",icon:"trash-alt",yesText:"Remove",onConfirm:()=>Me.removePanel(Ce)}))}const Ee=async Me=>{const Ce=await(0,h.J6)(Me),Ue=s.kM.renderUrl("/alerting/new",{defaults:JSON.stringify(Ce),returnTo:location.pathname+location.search});g.Ny.push(Ue)};function Se(Me){const Ce=Me.state.options;ye(Ce)&&typeof Ce.legend.showLegend=="boolean"&&Me.onOptionsChange({legend:{showLegend:!Ce.legend.showLegend}})}function ye(Me){return Me!=null&&typeof Me=="object"&&"legend"in Me}const Ve=(Me,Ce)=>{g.Ny.partial({inspect:Me.state.key,inspectTab:Ce})}},7928:(G,R,e)=>{"use strict";e.d(R,{v:()=>o});var t=e(74848),n=e(32196),s=e(43127),a=e(65879),r=e(85858),g=e(84537),i=e(40845),l=e(56034),d=e(15666),c=e(91052),h=e(14578);class o extends g.XQ{static{this.Component=m}constructor(f={}){super({...f,from:"now-6h",to:"now",value:(0,s.E2)()}),this.addActivationHandler(()=>this._onActivate())}_onActivate(){this._subs.add(this.subscribeToState((f,y)=>{if(f.timeFrom!==y.timeFrom||f.timeShift!==y.timeShift){const{timeInfo:x,timeRange:v}=this.getTimeOverride(this.getAncestorTimeRange().state.value);this.setState({timeInfo:x,value:v})}}))}ancestorTimeRangeChanged(f){const y=this.getTimeOverride(f.value);this.setState({value:y.timeRange,timeInfo:y.timeInfo})}getTimeOverride(f){const{timeFrom:y,timeShift:x}=this.state,v={timeInfo:"",timeRange:f};if(y){const P=g.jh.interpolate(this,this.state.timeFrom),E=a.describeTextRange(P);if(E.invalid)return v.timeInfo="invalid time override",v;a.isRelativeTimeRange(f.raw)&&(v.timeInfo=E.display,v.timeRange={from:r.parse(E.from),to:r.parse(E.to),raw:{from:E.from,to:E.to}})}if(x){const P=g.jh.interpolate(this,this.state.timeShift);if(a.describeTextRange(P).invalid)return v.timeInfo="invalid timeshift",v;const D="-"+P;v.timeInfo+=" timeshift "+D;const C=r.parseDateMath(D,v.timeRange.from,!1),b=r.parseDateMath(D,v.timeRange.to,!0);v.timeRange={from:C,to:b,raw:{from:C,to:b}}}return v}}function m({model:p}){const{timeInfo:f,hideTimeOverride:y}=p.useState(),x=(0,i.of)(u);return!f||y?null:(0,t.jsx)(l.m,{content:(0,t.jsx)(d.xS,{timeRange:p.state.value,timeZone:p.getTimeZone()}),children:(0,t.jsxs)(c.NR.TitleItem,{className:x.timeshift,children:[(0,t.jsx)(h.I,{name:"clock-nine",size:"sm"})," ",f]})})}const u=p=>({timeshift:(0,n.css)({color:p.colors.text.link,gap:p.spacing(.5),whiteSpace:"nowrap"})})},79284:(G,R,e)=>{"use strict";e.d(R,{L:()=>l});var t=e(2543),n=e.n(t),s=e(84537),a=e(74730),r=e(41507),g=e(7196),i=e(30195);class l extends s.Bs{constructor(u){super(u),this._variableDependency=new s.Sh(this,{variableNames:[this.state.variableName],onVariableUpdateCompleted:()=>{}}),this.isWaitingForVariables=!1,this.addActivationHandler(()=>this._activationHandler())}notifyRepeatedPanelsWaitingForVariables(u){const p=[this._getRow(),...this._clonedRows??[]];for(const f of p)for(const y of f.state.children){if(!(y instanceof r.U))continue;const x=(0,a.un)(y.state.body);x&&x.variableDependency?.variableUpdateCompleted(u,!1)}}_activationHandler(){this.performRepeat();const u=this._getLayout(),p=this._getRow(),f=p.state.key+"-clone-",y=u.subscribeToState(()=>{const x=u.state.children.filter(v=>v instanceof s.tI&&v.state.key?.includes(f));for(const v of x){if(!(v instanceof s.tI)||v.state.children.length===p.state.children.length)continue;const P=v.state.children.find(E=>!E.state.key?.includes("clone"));if(P){const E=P.clone();if(v.setState({children:v.state.children.filter(D=>D!==P)}),p.state.children.find(D=>D.state.key===E.state.key))return;p.setState({children:[...p.state.children,E]}),this.performRepeat(!0)}}});return()=>{y.unsubscribe()}}_getRow(){if(!(this.parent instanceof s.tI))throw new Error("RepeatedRowBehavior: Parent is not a SceneGridRow");return this.parent}_getLayout(){const u=s.jh.getLayout(this);if(!(u instanceof s.hy))throw new Error("RepeatedRowBehavior: Layout is not a SceneGridLayout");return u}performRepeat(u=!1){if(this.isWaitingForVariables=this._variableDependency.hasDependencyInLoadingState(),this.isWaitingForVariables)return;const p=s.jh.lookupVariable(this.state.variableName,this.parent?.parent);if(!p){console.error("RepeatedRowBehavior: Variable not found");return}if(!(p instanceof s.n8)){console.error("RepeatedRowBehavior: Variable is not a MultiValueVariable");return}const f=this._getRow(),y=this._getLayout(),{values:x,texts:v}=(0,a.a7)(p);if((0,t.isEqual)(this._prevRepeatValues,x)&&!u)return;this._prevRepeatValues=x,this._clonedRows=[];const P=f.state.children,E=d(P);let D=0;const C={values:[""],texts:p.hasAllValue()?["All"]:["None"]},b=x.length?x:C.values,T=v.length?v:C.texts;for(let S=0;S<b.length;S++){const O=[],M=b[S];for(const L of P){const j=(L.state.y??0)+(E+1)*S,A=S>0?`${L.state.key}-clone-${M}`:L.state.key,K=L.clone({key:A,y:j});S>0&&(o(K,M),K instanceof r.U&&(K.setState({isDraggable:!1}),K.state.body.setState({menu:new s.Lw({$behaviors:[g.t0]})}))),O.push(K),D<j+K.state.height&&(D=j+K.state.height)}const I=this.getRowClone(f,S,M,T[S],E,O,p);this._clonedRows.push(I)}c(y,this._clonedRows,D,f),this.publishEvent(new i.d({source:this}),!0)}getRowClone(u,p,f,y,x,v,P){if(p===0)return u.setState({$variables:new s.Pj({variables:[new s.xc({name:this.state.variableName,value:f,text:String(y),isMulti:P.state.isMulti,includeAll:P.state.includeAll})]}),children:v}),u;const E=u.state.y??0;return u.clone({key:`${u.state.key}-clone-${f}`,$variables:new s.Pj({variables:[new s.xc({name:this.state.variableName,value:f,text:String(y),isMulti:P.state.isMulti,includeAll:P.state.includeAll})]}),$behaviors:[],children:v,y:E+x*p+p,actions:void 0})}removeBehavior(){const u=this._getRow(),p=this._getLayout(),f=h(this._getLayout(),this._getRow());p.setState({children:f}),u.setState({$behaviors:u.state.$behaviors.filter(y=>y!==this),$variables:void 0})}}function d(m){let u=0,p=Number.MAX_VALUE;if(m.length===0)return 0;for(const f of m)f.state.y+f.state.height>u&&(u=f.state.y+f.state.height),f.state.y<p&&(p=f.state.y);return u-p}function c(m,u,p,f){const y=h(m,f),x=y.indexOf(f);if(x===-1)throw new Error("RowRepeaterBehavior: Parent row not found in layout children");const v=[...y.slice(0,x),...u,...y.slice(x+1)];if(y.length>x+1){const P=y.slice(x+1),E=P[0].state.y,D=p-E;for(const C of P)if(C.setState({y:C.state.y+D}),C instanceof s.tI)for(const b of C.state.children)b.setState({y:b.state.y+D})}m.setState({children:v})}function h(m,u){return m.state.children.filter(p=>!p.state.key?.startsWith(`${u.state.key}-clone-`))}function o(m,u){m.forEachChild(p=>{p.setState({key:`${p.state.key}-clone-${u}`}),o(p,u)})}},54174:(G,R,e)=>{"use strict";e.d(R,{l:()=>s});var t=e(74848),n=e(96374);const s=({isOpen:a,onConfirm:r,onDismiss:g})=>(0,t.jsx)(n.u,{title:"Do you really want to unlink this panel?",icon:"question-circle",body:`If you unlink this panel, you will be able to edit it without affecting any other dashboards.
            However, once you make a change you will not be able to revert to its original reusable panel.`,confirmText:"Yes, unlink",onConfirm:()=>{r(),g()},onDismiss:g,isOpen:a})},20485:(G,R,e)=>{"use strict";e.d(R,{$L:()=>o,Tr:()=>f,Wu:()=>p});var t=e(74848),n=e(32196),s=e(32264),a=e(84537),r=e(40845),g=e(56034),i=e(91052),l=e(14578),d=e(84423),c=e(8480),h=e(74730);class o extends a.Bs{constructor(){super({}),this.onActivate=()=>{const P=this.parent;if(!P||!(P instanceof a.Eb))throw new Error("PanelNotices can be used only as title items for VizPanel")},this.addActivationHandler(this.onActivate)}static{this.Component=m}getPanel(){const P=this.parent;return P&&P instanceof a.Eb?P:null}}function m({model:v}){const P=v.getPanel(),E=(0,r.of)(x);if(!P)return null;if(y(P)){const b=`This ${u(f(P),p(P))} requires Angular (deprecated).`;return(0,t.jsx)(g.m,{content:b,children:(0,t.jsx)(i.NR.TitleItem,{className:E.angularNotice,"data-testid":"angular-deprecation-icon",children:(0,t.jsx)(l.I,{name:"exclamation-triangle",size:"md"})})})}return null}function u(v,P){return P?"panel":v?"data source":"panel or data source"}function p(v){return(s.$.panels[v.state.pluginId]?.angular?.detected||d.vI.includes(v.state.pluginId))&&!s.$.panels[v.state.pluginId]?.angular?.hideDeprecation}function f(v){const E=(0,h.un)(v)?.state.datasource;return E?.uid?(0,c.Hv)(E?.uid):!1}function y(v){return(s.$.featureToggles.angularDeprecationUI??!1)&&(f(v)||p(v))}function x(v){return{angularNotice:(0,n.css)({color:v.colors.warning.text})}}},77517:(G,R,e)=>{"use strict";e.d(R,{D:()=>l});var t=e(74848),n=e(84537),s=e(15054),a=e(74730),r=e(41507),g=e(79284),i=e(58029);class l extends n.Bs{editModeChanged(c){this.state.grid.setState({isDraggable:c,isResizable:c}),(0,a.X0)(this.state.grid,!0)}cleanUpStateFromExplore(){this.state.grid.setState({children:this.state.grid.state.children.slice(1)})}addPanel(c){const h=(0,a.Cs)(c),o=new r.U({height:a.sw,width:a.vm,x:0,y:0,body:c,key:`grid-item-${h}`});this.state.grid.setState({children:[o,...this.state.grid.state.children]})}addNewRow(){const c=this.getNextPanelId(),h=new n.tI({key:(0,a.XA)(c),title:"Row title",actions:new i.u({}),y:0}),o=this.state.grid,m=o.state.children.findIndex(p=>p instanceof n.tI),u=o.state.children.splice(0,m===-1?o.state.children.length:m).map(p=>p.clone());return u&&h.setState({children:u}),o.setState({children:[h,...o.state.children]}),h}removeRow(c,h=!1){const o=this.state.grid,m=o.state.children.filter(u=>u.state.key!==c.state.key);if(!h){const u=c.state.children.map(f=>f.clone()),p=o.state.children.findIndex(f=>f.state.key===c.state.key);m.splice(p,0,...u)}o.setState({children:m})}removePanel(c){const h=c.parent;if(!(h instanceof r.U))throw new Error("Trying to remove panel that is not inside a DashboardGridItem");const o=this.state.grid;let m;try{m=n.jh.getAncestor(h,n.tI)}catch{m=void 0}if(m){m.setState({children:m.state.children.filter(u=>u!==h)}),o.forceRender();return}this.state.grid.setState({children:o.state.children.filter(u=>u!==h)})}duplicatePanel(c){const h=c.parent;if(!(h instanceof r.U)){console.error("Trying to duplicate a panel that is not inside a DashboardGridItem");return}let o,m,u;const p=this.getNextPanelId(),f=this.state.grid;if(h instanceof r.U?(o=n.Go.cloneSceneObjectState(h.state.body.state),m=n.jh.getData(h.state.body).clone()):(o=n.Go.cloneSceneObjectState(c.state),m=n.jh.getData(c).clone()),delete m.state.data?.alertState,u=new r.U({x:h.state.x,y:h.state.y,height:h.state.height,width:h.state.width,variableName:h.state.variableName,repeatDirection:h.state.repeatDirection,maxPerRow:h.state.maxPerRow,key:`grid-item-${p}`,body:new n.Eb({...o,$data:m,key:(0,a.XA)(p)})}),h.parent instanceof n.tI){const y=h.parent;y.setState({children:[...y.state.children,u]}),f.forceRender();return}f.setState({children:[...f.state.children,u]})}getVizPanels(){const c=[];return this.state.grid.forEachChild(h=>{if(!(h instanceof r.U)&&!(h instanceof n.tI))throw new Error("Child is not a DashboardGridItem or SceneGridRow, invalid scene");h instanceof r.U?h.state.body instanceof n.Eb&&c.push(h.state.body):h instanceof n.tI&&h.forEachChild(o=>{o instanceof r.U&&o.state.body instanceof n.Eb&&c.push(o.state.body)})}),c}getNextPanelId(){let c=0;for(const h of this.state.grid.state.children){if(h instanceof r.U){const o=h.state.body;if(o){const m=(0,a.Cs)(o);m>c&&(c=m)}}if(h instanceof n.tI){const o=(0,a.Cs)(h);o>c&&(c=o);for(const m of h.state.children)if(m instanceof r.U){const u=m.state.body;if(u){const p=(0,a.Cs)(u);p>c&&(c=p)}}}}return c+1}collapseAllRows(){this.state.grid.state.children.forEach(c=>{c instanceof n.tI&&(c.state.isCollapsed||this.state.grid.toggleRow(c))})}expandAllRows(){this.state.grid.state.children.forEach(c=>{c instanceof n.tI&&c.state.isCollapsed&&this.state.grid.toggleRow(c)})}activateRepeaters(){this.state.grid.forEachChild(c=>{if(c instanceof r.U&&!c.isActive){c.activate();return}if(c instanceof n.tI&&c.state.$behaviors){for(const h of c.state.$behaviors)if(h instanceof g.L&&!c.isActive){c.activate();break}c.state.children.forEach(h=>{if(h instanceof r.U&&!h.isActive){h.activate();return}})}})}static fromVizPanels(c=[]){const h=[],m=s.cV/3;let u=0,p=0;for(let f of c)h.push(new r.U({key:`griditem-${(0,a.Cs)(f)}`,x:p,y:u,width:m,height:10,body:f})),p+=m,p+m>=s.cV&&(p=0,u+=10);return new l({grid:new n.hy({children:h,isDraggable:!1,isResizable:!1})})}static{this.Component=({model:c})=>(0,t.jsx)(c.state.grid.Component,{model:c.state.grid})}}},58029:(G,R,e)=>{"use strict";e.d(R,{u:()=>M});var t=e(74848),n=e(32196),s=e(84537),a=e(72109),r=e(40845),g=e(14578),i=e(28138),l=e(14348),d=e(28444),c=e(74730),h=e(41507),o=e(79284),m=e(77517),u=e(71678),p=e(37390),f=e(96540),y=e(49785),x=e(13544),v=e(88575),P=e(10354),E=e(42418),D=e(55852),C=e(92378);const b=({repeat:L,title:B,sceneContext:j,warning:A,onUpdate:K,onCancel:W})=>{const[U,F]=(0,f.useState)(L),V=(0,f.useCallback)(H=>F(H),[F]),{handleSubmit:w,register:z}=(0,y.mN)({defaultValues:{title:B}}),N=H=>{K(H.title,U)};return(0,t.jsxs)("form",{onSubmit:w(N),children:[(0,t.jsx)(v.D,{label:"Title",children:(0,t.jsx)(P.p,{...z("title"),type:"text"})}),(0,t.jsx)(v.D,{label:"Repeat for",children:(0,t.jsx)(C.U,{sceneContext:j,repeat:U,onChange:V})}),A&&(0,t.jsx)(E.F,{"data-testid":x.Tp.pages.Dashboard.Rows.Repeated.ConfigSection.warningMessage,severity:"warning",title:"",topSpacing:3,bottomSpacing:0,children:A}),(0,t.jsxs)(p.a.ButtonRow,{children:[(0,t.jsx)(D.$n,{type:"button",variant:"secondary",onClick:W,fill:"outline",children:"Cancel"}),(0,t.jsx)(D.$n,{type:"submit",children:"Update"})]})]})},T=({repeat:L,title:B,parent:j,onDismiss:A,onUpdate:K,warning:W})=>{const U=(0,r.of)(S);return(0,t.jsx)(p.a,{isOpen:!0,title:"Row options",onDismiss:A,className:U.modal,children:(0,t.jsx)(b,{sceneContext:j,repeat:L,title:B,onCancel:A,onUpdate:K,warning:W})})},S=()=>({modal:(0,n.css)({label:"RowOptionsModal",width:"500px"})}),O=({repeat:L,title:B,parent:j,onUpdate:A,warning:K})=>{const W=U=>(F,V)=>{A(F,V),U()};return(0,t.jsx)(u.$s,{children:({showModal:U,hideModal:F})=>(0,t.jsx)("button",{type:"button",className:"pointer","aria-label":"Row options",onClick:()=>{U(T,{title:B,repeat:L,parent:j,onDismiss:F,onUpdate:W(F),warning:K})},children:(0,t.jsx)(g.I,{name:"cog"})})})};O.displayName="RowOptionsButton";class M extends s.Bs{constructor(){super(...arguments),this.onUpdate=(B,j)=>{const A=this.getParent();let K;if(A.state.$behaviors)for(let W of A.state.$behaviors)W instanceof o.L&&(K=W);B!==A.state.title&&A.setState({title:B}),j?(K&&K.removeBehavior(),K=new o.L({variableName:j}),A.setState({$behaviors:[...A.state.$behaviors??[],K]})):K?.removeBehavior()},this.onDelete=()=>{i.A.publish(new d.bY({title:"Delete row",text:"Are you sure you want to remove this row and all its panels?",altActionText:"Delete row only",icon:"trash-alt",onConfirm:()=>this.removeRow(!0),onAltAction:()=>this.removeRow()}))},this.getWarning=()=>{if(this.getParent().state.children.some(K=>{if(!(K instanceof h.U))return!1;const W=K.state.body;return W instanceof s.Eb?(0,c.un)(W)?.state.datasource?.uid===l.K:!1}))return(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{children:["Panels in this row use the ",l.K," data source. These panels will reference the panel in the original row, not the ones in the repeated rows."]}),(0,t.jsx)(a.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/create-dashboard/#configure-repeating-rows",children:"Learn more"})]})}}getParent(){if(!(this.parent instanceof s.tI))throw new Error("RowActions must have a SceneGridRow parent");return this.parent}getDashboard(){return(0,c.YQ)(this)}removeRow(B){s.jh.getAncestor(this,m.D).removeRow(this.getParent(),B)}static{this.Component=({model:B})=>{const j=B.getDashboard(),A=B.getParent(),{title:K}=A.useState(),{meta:W,isEditing:U}=j.useState(),F=(0,r.of)(I),V=A.state.$behaviors?.find(w=>w instanceof o.L);return(0,t.jsx)(t.Fragment,{children:W.canEdit&&U&&(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:F.rowActions,children:[(0,t.jsx)(O,{title:K,repeat:V instanceof o.L?V.state.variableName:void 0,parent:j,onUpdate:B.onUpdate,warning:B.getWarning()}),(0,t.jsx)("button",{type:"button",onClick:B.onDelete,"aria-label":"Delete row",children:(0,t.jsx)(g.I,{name:"trash-alt"})})]})})})}}}const I=L=>({rowActions:(0,n.css)({color:L.colors.text.secondary,lineHeight:"27px",button:{color:L.colors.text.secondary,paddingLeft:L.spacing(2),background:"transparent",border:"none","&:hover":{color:L.colors.text.maxContrast}}})})},30195:(G,R,e)=>{"use strict";e.d(R,{d:()=>s});var t=e(65463);function n(a){return"switchLayout"in a}class s extends t.x{static{this.type="dashboard-repeats-processed"}}},71176:(G,R,e)=>{"use strict";e.d(R,{X:()=>a});var t=e(32264),n=e(79422),s=e(31193);async function a(r){let g=n.Ye.templating?.list;if(t.$.featureToggles.newDashboardWithFiltersAndGroupBy){const l=await(0,s.tR)().get();if(l.getTagKeys){const d={type:l.meta.id,uid:l.uid},c={datasource:d,filters:[],name:"Filter",type:"adhoc"},h={datasource:d,name:"Group by",type:"groupby"};g=(g||[]).concat([c,h])}}const i={meta:{canStar:!1,canShare:!1,canDelete:!1,isNew:!0,folderUid:""},dashboard:{...n.Ye,uid:"",title:"New dashboard",panels:[],timezone:t.$.bootData.user?.timezone||n.Ye.timezone}};return g&&(i.dashboard.templating={list:g}),r&&(i.meta.folderUid=r),i}},70665:(G,R,e)=>{"use strict";e.d(R,{x:()=>t});const t={name:"grafana",uid:"grafana"}},13989:(G,R,e)=>{"use strict";e.d(R,{O:()=>n});var t=e(84537);function n(s){const a=[];for(const r of s){if(!(r instanceof t.tV.g))continue;const g={...r.state.query,enable:!!r.state.isEnabled,hide:!!r.state.isHidden};a.push(g)}return a}},53287:(G,R,e)=>{"use strict";e.d(R,{C:()=>g});var t=e(32264),n=e(84537),s=e(79422),a=e(73134),r=e(74730);function g(l,d){const c=[];for(const h of l.state.variables){const o={name:h.state.name,label:h.state.label,description:h.state.description??void 0,skipUrlSync:!!h.state.skipUrlSync,hide:h.state.hide||s.zL.dontHide,type:h.state.type};if(n.Go.isQueryVariable(h)){let m=[];(h.state.refresh===a.CO.never||d)&&(m=i(h.state)),c.push({...o,current:{value:h.state.value,text:h.state.text},options:m,query:h.state.query,definition:h.state.definition,datasource:h.state.datasource,sort:h.state.sort,refresh:h.state.refresh,regex:h.state.regex,allValue:h.state.allValue,includeAll:h.state.includeAll,multi:h.state.isMulti,skipUrlSync:h.state.skipUrlSync})}else if(n.Go.isCustomVariable(h))c.push({...o,current:{text:h.state.value,value:h.state.value},options:i(h.state),query:h.state.query,multi:h.state.isMulti,allValue:h.state.allValue,includeAll:h.state.includeAll});else if(n.Go.isDataSourceVariable(h))c.push({...o,current:{value:h.state.value,text:h.state.text},options:[],regex:h.state.regex,refresh:a.CO.onDashboardLoad,query:h.state.pluginId,multi:h.state.isMulti,allValue:h.state.allValue,includeAll:h.state.includeAll});else if(n.Go.isConstantVariable(h))c.push({...o,current:{value:h.state.value,text:h.state.value},query:h.state.value,hide:s.zL.hideVariable});else if(n.Go.isIntervalVariable(h)){const m=(0,r.bx)(h.state.intervals);c.push({...o,current:{text:h.state.value,value:h.state.value},query:m,refresh:h.state.refresh,options:h.state.intervals.map(u=>({value:u,text:u,selected:u===h.state.value})),auto:h.state.autoEnabled,auto_min:h.state.autoMinInterval,auto_count:h.state.autoStepCount})}else if(n.Go.isTextBoxVariable(h)){const m={text:h.state.value,value:h.state.value};c.push({...o,current:m,options:[{...m,selected:!0}],query:h.state.value})}else if(n.Go.isGroupByVariable(h)&&t.$.featureToggles.groupByVariable)c.push({...o,datasource:h.state.datasource,options:h.state.defaultOptions?.map(m=>({text:m.text,value:String(m.value)})),current:{text:h.state.text,value:h.state.value}});else if(n.Go.isAdHocVariable(h))c.push({...o,name:h.state.name,type:"adhoc",datasource:h.state.datasource,baseFilters:h.state.baseFilters,filters:h.state.filters,defaultKeys:h.state.defaultKeys});else throw new Error("Unsupported variable type")}for(const h of c)h.hide===s.zL.dontHide&&delete h.hide,h.skipUrlSync||delete h.skipUrlSync,h.label===""&&delete h.label,h.multi||delete h.multi,h.sort===a.ZG.disabled&&delete h.sort;return c}function i(l){return l.options.map(d=>({value:String(d.value),text:d.label,selected:Array.isArray(l.value)?l.value.includes(d.value):l.value===d.value}))}},19997:(G,R,e)=>{"use strict";e.d(R,{tt:()=>oe,EH:()=>de,wM:()=>ne});var t=e(2543),n=e(32264),s=e(84537),a=e(34214),r=e(91309),g=e(38477),i=e(33278),l=e(16279),d=e(41507),c=e(74730);class h{constructor(Ee,Se){this._sceneObject=Se,this.state={name:Ee,type:"dashboard_macro"}}getValue(Ee){const Se=(0,c.YQ)(this._sceneObject);switch(Ee){case"uid":return Se.state.uid||"";case"title":case"name":case"id":default:return Se.state.title}}getValueText(){return""}}function o(){const fe=s.Go.registerVariableMacro("__dashboard",h);return()=>fe()}var m=e(55600),u=e(39601),p=e(53001);class f extends p.mN{constructor({reloadOnScopesChange:Ee,uid:Se}){super({handler:ye=>{Ee&&Se?u.Ny.reload():s.jh.getTimeRange(ye).onRefresh()}})}}var y=e(68435),x=e(42397),v=e(7196),P=e(74848),E=e(2038);class D extends s.Bs{constructor(){super({}),this.onActivate=()=>{const Ee=this.parent;if(!Ee||!(Ee instanceof s.Eb))throw new Error("PanelNotices can be used only as title items for VizPanel")},this.addActivationHandler(this.onActivate)}static{this.Component=C}getPanel(){const Ee=this.parent;return Ee&&Ee instanceof s.Eb?Ee:null}}function C({model:fe}){const Ee=fe.getPanel(),ye=s.jh.getData(fe).useState();if(!Ee)return null;const Ve=(0,c.Cs)(Ee);return ye.data?.series?(0,P.jsx)(E.Z,{frames:ye.data?.series,panelId:Ve}):null}var b=e(7928),T=e(79284),S=e(20485),O=e(77517),M=e(58029),I=e(41987),L=e(69129),B=e(19347),j=e(10154),A=e(32023);function K(fe,Ee){Ee.app=I.Jk.Dashboard,Ee.canAddAnnotations=()=>{const Se=(0,c.YQ)(fe);return!W(Se)||!Se.canEditDashboard()?!1:!!Se.state.meta.annotationsPermissions?.dashboard.canAdd},Ee.canEditAnnotations=Se=>{const ye=(0,c.YQ)(fe);return ye.canEditDashboard()?Se?!!ye.state.meta.annotationsPermissions?.dashboard.canEdit:!!ye.state.meta.annotationsPermissions?.organization.canEdit:!1},Ee.canDeleteAnnotations=Se=>{const ye=(0,c.YQ)(fe);return ye.canEditDashboard()?Se?!!ye.state.meta.annotationsPermissions?.dashboard.canDelete:!!ye.state.meta.annotationsPermissions?.organization.canDelete:!1},Ee.onAnnotationCreate=async Se=>{const ye=(0,c.YQ)(fe),Ve=Se.from!==Se.to,Me={dashboardUID:ye.state.uid,panelId:(0,c.Cs)(fe),isRegion:Ve,time:Se.from,timeEnd:Ve?Se.to:0,tags:Se.tags,text:Se.description};await(0,j.vJ)(Me),U(ye),Ee.eventBus.publish(new L.We(Me))},Ee.onAnnotationUpdate=async Se=>{const ye=(0,c.YQ)(fe),Ve=Se.from!==Se.to,Me={id:Se.id,dashboardUID:ye.state.uid,panelId:(0,c.Cs)(fe),isRegion:Ve,time:Se.from,timeEnd:Ve?Se.to:0,tags:Se.tags,text:Se.description};await(0,j.rJ)(Me),U(ye),Ee.eventBus.publish(new L.We(Me))},Ee.onAnnotationDelete=async Se=>{await(0,j.Xm)({id:Se}),U((0,c.YQ)(fe)),Ee.eventBus.publish(new L.We({id:Se}))},Ee.onAddAdHocFilter=Se=>{const ye=(0,c.YQ)(fe),Ve=(0,c.un)(fe);if(!Ve)return;const Me=F(ye,Ve.state.datasource);V(Me,Se)},Ee.onUpdateData=Se=>Promise.resolve(!0)}function W(fe){const Ee=A.b4.getDataLayers(fe);for(const Se of Ee.state.annotationLayers)if(Se instanceof s.tV.g&&Se.state.isEnabled&&Se.state.query.builtIn)return Se}function U(fe){const Ee=W(fe);Ee&&Ee.runLayer()}function F(fe,Ee){const Se=s.jh.getVariables(fe);for(const Ve of Se.state.variables)if(s.Go.isAdHocVariable(Ve)){const Me=Ve.state.datasource;if(Me===Ee||Me?.uid===Ee?.uid)return Ve}const ye=new s.H9({name:"Filters",datasource:Ee,supportsMultiValueOperators:!!(0,B.l)().getInstanceSettings(Ee)?.meta.multiValueFilterOperators,useQueriesAsFilterForOptions:!0,layout:n.$.featureToggles.newFiltersUI?"combobox":void 0});return Se.setState({variables:[...Se.state.variables,ye]}),ye}function V(fe,Ee){for(const Se of fe.state.filters)if(Se.key===Ee.key){fe.setState({filters:fe.state.filters.map(ye=>ye.key===Ee.key?Ee:ye)});return}fe.setState({filters:[...fe.state.filters,Ee]})}var w=e(96556),z=e(27734),N=e(7758),H=e(62467),Q=e(81160);class X extends s.n8{constructor(Ee){super({name:"",type:"snapshot",isReadOnly:!0,query:"",value:"",text:"",options:[],...Ee}),this._variableDependency=new s.Sh(this,{statePaths:[]})}getValueOptions(Ee){const Ve=(s.jh.interpolate(this,this.state.query).match(/(?:\\,|[^,])+/g)??[]).map(Me=>{Me=Me.replace(/\\,/g,",");const Ce=/^(.+)\s:\s(.+)$/g.exec(Me)??[];if(Ce.length===3){const[,Ue,Ae]=Ce;return{label:Ue.trim(),value:Ae.trim()}}else return{label:Me.trim(),value:Me.trim()}});return(0,H.of)(Ve)}validateAndUpdate(){return this.getValueOptions({}).pipe((0,Q.T)(Ee=>(this.state.options!==Ee&&this._updateValueGivenNewOptions(Ee),{})))}static{this.Component=({model:Ee})=>(0,s.yC)(Ee)}_updateValueGivenNewOptions(Ee){const{value:Se,text:ye}=this.state,Ve={options:Ee,loading:!1,value:Se??[],text:ye??[]};this.setState(Ve)}}function ee(fe){const Ee=fe.templating.list.map(Se=>{try{return ae(Se)}catch(ye){return console.error(ye),null}}).filter(Se=>!!Se);return new s.Pj({variables:Ee})}function Z(fe){const Ee=fe.templating.list.map(Se=>{try{return Se.type==="adhoc"?new s.H9({name:Se.name,label:Se.label,readOnly:!0,description:Se.description,skipUrlSync:Se.skipUrlSync,hide:Se.hide,datasource:Se.datasource,applyMode:"auto",filters:Se.filters??[],baseFilters:Se.baseFilters??[],defaultKeys:Se.defaultKeys,useQueriesAsFilterForOptions:!0,layout:n.$.featureToggles.newFiltersUI?"combobox":void 0,supportsMultiValueOperators:!!(0,B.l)().getInstanceSettings(Se.datasource)?.meta.multiValueFilterOperators}):q(Se)}catch(ye){return console.error(ye),null}}).filter(Se=>!!Se);return new s.Pj({variables:Ee})}function q(fe){let Ee,Se;if(fe.type==="interval"){const ye=(0,c.Sm)(fe.query),Ve=(0,c.pk)(fe,ye);return Ee=new X({name:fe.name,label:fe.label,description:fe.description,value:Ve,text:Ve,hide:fe.hide}),Ee}return fe.type==="system"||fe.type==="constant"||fe.type==="adhoc"?Se={value:"",text:""}:Se={value:fe.current?.value??"",text:fe.current?.text??""},Ee=new X({name:fe.name,label:fe.label,description:fe.description,value:Se?.value??"",text:Se?.text??"",hide:fe.hide}),Ee}function ae(fe){const Ee={name:fe.name,label:fe.label,description:fe.description};if(fe.type==="adhoc")return new s.H9({...Ee,description:fe.description,skipUrlSync:fe.skipUrlSync,hide:fe.hide,datasource:fe.datasource,applyMode:"auto",filters:fe.filters??[],baseFilters:fe.baseFilters??[],defaultKeys:fe.defaultKeys,useQueriesAsFilterForOptions:!0,layout:n.$.featureToggles.newFiltersUI?"combobox":void 0,supportsMultiValueOperators:!!(0,B.l)().getInstanceSettings(fe.datasource)?.meta.multiValueFilterOperators});if(fe.type==="custom")return new s.yP({...Ee,value:fe.current?.value??"",text:fe.current?.text??"",query:fe.query,isMulti:fe.multi,allValue:fe.allValue||void 0,includeAll:fe.includeAll,defaultToAll:!!fe.includeAll,skipUrlSync:fe.skipUrlSync,hide:fe.hide});if(fe.type==="query")return new s.fS({...Ee,value:fe.current?.value??"",text:fe.current?.text??"",query:fe.query,datasource:fe.datasource,sort:fe.sort,refresh:fe.refresh,regex:fe.regex,allValue:fe.allValue||void 0,includeAll:fe.includeAll,defaultToAll:!!fe.includeAll,isMulti:fe.multi,skipUrlSync:fe.skipUrlSync,hide:fe.hide,definition:fe.definition});if(fe.type==="datasource")return new s.mI({...Ee,value:fe.current?.value??"",text:fe.current?.text??"",regex:fe.regex,pluginId:fe.query,allValue:fe.allValue||void 0,includeAll:fe.includeAll,defaultToAll:!!fe.includeAll,skipUrlSync:fe.skipUrlSync,isMulti:fe.multi,hide:fe.hide});if(fe.type==="interval"){const Se=(0,c.Sm)(fe.query),ye=(0,c.pk)(fe,Se);return new s.Yj({...Ee,value:ye,intervals:Se,autoEnabled:fe.auto,autoStepCount:fe.auto_count,autoMinInterval:fe.auto_min,refresh:fe.refresh,skipUrlSync:fe.skipUrlSync,hide:fe.hide})}else{if(fe.type==="constant")return new s.x0({...Ee,value:fe.query,skipUrlSync:fe.skipUrlSync,hide:fe.hide});if(fe.type==="textbox"){let Se;return fe?.current?.value?typeof fe.current.value=="string"?Se=fe.current.value:Se=fe.current.value[0]:Se=fe.query,new s.TS({...Ee,value:Se,skipUrlSync:fe.skipUrlSync,hide:fe.hide})}else{if(n.$.featureToggles.groupByVariable&&fe.type==="groupby")return new s.ZG({...Ee,datasource:fe.datasource,value:fe.current?.value||[],text:fe.current?.text||[],skipUrlSync:fe.skipUrlSync,hide:fe.hide,defaultOptions:fe.options});throw new Error(`Scenes: Unsupported variable type ${fe.type}`)}}}var k=e(84423);function se(fe){return function(Se,ye){if(ye.angularPanelCtrl){Se.options={angularOptions:fe.getOptionsToRemember()};return}if((!fe.options||Object.keys(fe.options).length===0)&&(0,t.defaults)(Se,fe.getOptionsToRemember()),fe.autoMigrateFrom){const Ve=k.NB[fe.autoMigrateFrom]!=null,Me=fe.getOptionsToRemember(),Ce=fe.autoMigrateFrom;if(ye.onPanelTypeChanged){const Ue=Ve?{angular:Me}:Me.options;Object.assign(Se.options,ye.onPanelTypeChanged(Se,Ce,Ue,Se.fieldConfig))}}}}var te=e(70665);function ne(fe){const Ee=new a.G(fe.dashboard,fe.meta),Se=de(Ee,fe.dashboard);return Se.setInitialSaveModel(fe.dashboard),Se}function le(fe){const Ee=[];let Se=null,ye=[];for(const Ve of fe)if(Ve.type==="row")Se?Se.id!==Ve.id&&(Ee.push(re(Se,ye)),Ve.collapsed?(Ee.push(re(Ve,[])),Se=null):Se=Ve,ye=[]):Ve.collapsed?Ee.push(re(Ve,[])):Se=Ve;else{Ve.snapshotData&&pe(Ve);const Me=oe(Ve);Se?ye.push(Me):Ee.push(Me)}return Se&&Ee.push(re(Se,ye)),Ee}function re(fe,Ee){fe.collapsed&&fe.panels&&(Ee=fe.panels.map(Ve=>(Ve instanceof a.a||(Ve=new a.a(Ve)),oe(Ve))));let Se,ye=Ee;return fe.repeat&&(Se=[new T.L({variableName:fe.repeat})]),new s.tI({key:(0,c.XA)(fe.id),title:fe.title,y:fe.gridPos.y,isCollapsed:fe.collapsed,children:ye,$behaviors:Se,actions:new M.u({})})}function de(fe,Ee){let Se,ye=[],Ve;fe.templating?.list?.length?fe.meta.isSnapshot?Se=Z(fe):Se=ee(fe):Se=new s.Pj({variables:[]}),fe.annotations?.list?.length&&!fe.isSnapshot()&&(ye=fe.annotations?.list.map(Ue=>new g.g({key:(0,t.uniqueId)("annotations-"),query:Ue,name:Ue.name,isEnabled:!!Ue.enable,isHidden:!!Ue.hide})));let Me=n.$.unifiedAlertingEnabled;return Me||fe.panels.find(Ue=>!!Ue.alert)&&(Me=!0),Me&&(Ve=new r.C({key:"alert-states",name:"Alert States"})),new m.H$({description:fe.description,editable:fe.editable,preload:Ee.preload??!1,id:fe.id,isDirty:!1,links:fe.links||[],meta:fe.meta,tags:fe.tags||[],title:fe.title,uid:fe.uid,version:fe.version,body:new O.D({grid:new s.hy({isLazy:!Ee.preload,children:le(fe.panels),$behaviors:[xe]})}),$timeRange:new s.JZ({from:fe.time.from,to:fe.time.to,fiscalYearStartMonth:fe.fiscalYearStartMonth,timeZone:fe.timezone,weekStart:fe.weekStart,UNSAFE_nowDelay:fe.timepicker?.nowDelay}),$variables:Se,$behaviors:[new s.Gg.K2({sync:fe.graphTooltip}),new s.Gg.Hf,o,J,new s.Gg.en({enabled:fe.liveNow}),z.zf,new f({reloadOnScopesChange:fe.meta.reloadOnScopesChange,uid:fe.uid})],$data:new l.s({annotationLayers:ye,alertStatesLayer:Ve}),controls:new i.x({variableControls:[new s.K8({}),new s.i7],timePicker:new s.KE({}),refreshPicker:new s.WM({refresh:fe.refresh,intervals:fe.timepicker.refresh_intervals,withText:!0}),hideTimeControls:fe.timepicker.hidden})})}function oe(fe){const Ee=fe.repeat?{variableName:fe.repeat,repeatDirection:fe.repeatDirection==="h"?"h":"v"}:{},Se=[];n.$.featureToggles.angularDeprecationUI&&Se.push(new S.$L),Se.push(new x.$({rawLinks:fe.links,menu:new x.m({$behaviors:[v.oV]})})),Se.push(new D);const ye={key:(0,c.XA)(fe.id),title:fe.title,description:fe.description,pluginId:fe.type??"timeseries",options:fe.options??{},fieldConfig:fe.fieldConfig,pluginVersion:fe.pluginVersion,displayMode:fe.transparent?"transparent":void 0,hoverHeader:!fe.title&&!fe.timeFrom&&!fe.timeShift,hoverHeaderOffset:0,$data:(0,w.w)(fe),titleItems:Se,$behaviors:[],extendPanelContext:K,_UNSAFE_customMigrationHandler:se(fe)};fe.libraryPanel&&(ye.$behaviors.push(new y.u({uid:fe.libraryPanel.uid,name:fe.libraryPanel.name})),ye.pluginId=y.u.LOADING_VIZ_PANEL_PLUGIN_ID,ye.$data=void 0),n.$.publicDashboardAccessToken||(ye.menu=new s.Lw({$behaviors:[v._i]})),(fe.timeFrom||fe.timeShift)&&(ye.$timeRange=new b.v({timeFrom:fe.timeFrom,timeShift:fe.timeShift,hideTimeOverride:fe.hideTimeOverride}));const Ve=new s.Eb(ye);return new d.U({key:`grid-item-${fe.id}`,x:fe.gridPos.x,y:fe.gridPos.y,width:Ee.repeatDirection==="h"?24:fe.gridPos.w,height:fe.gridPos.h,itemHeight:fe.gridPos.h,body:Ve,maxPerRow:fe.maxPerRow,...Ee})}function J(fe){fe.subscribeToEvent(s.Kw,Ee=>{const{interaction:Se}=Ee.payload;switch(Se){case"panel-status-message-clicked":N.c.panelStatusMessageClicked();break;case"panel-cancel-query-clicked":N.c.panelCancelQueryClicked();break}})}const ce=fe=>fe.map(Ee=>({data:{values:Ee.fields.map(Se=>Se.values).filter(Se=>Se!==void 0)},schema:{fields:Ee.fields.map(Se=>({name:Se.name,type:Se.type,config:Se.config}))}})),pe=fe=>{fe.snapshotData&&(fe.datasource=te.x,fe.targets=[{refId:fe.snapshotData[0]?.refId??"",datasource:fe.datasource,queryType:"snapshot",snapshot:ce(fe.snapshotData)}],fe.snapshotData=[])};function xe(fe){(0,c.YQ)(fe).setState({isEmpty:fe.state.children.length===0});const Ee=fe.subscribeToState((Se,ye)=>{(Se.children.length!==ye.children.length||Se.children!==ye.children)&&(0,c.YQ)(fe).setState({isEmpty:Se.children.length===0})});return()=>{Ee.unsubscribe()}}},20455:(G,R,e)=>{"use strict";e.d(R,{Uy:()=>E,Z6:()=>C,ZB:()=>D,c:()=>O});var t=e(2543),n=e.n(t),s=e(92041),a=e(84537),r=e(79422),g=e(73134),i=e(28874),l=e(18803),d=e(79056),c=e(68706),h=e(16279),o=e(41507),m=e(7928),u=e(79284),p=e(77517),f=e(32023),y=e(74730),x=e(70665),v=e(13989),P=e(53287);function E(I,L=!1){const B=I.state,j=B.$timeRange.state,A=B.$data,K=B.$variables,W=B.body;let U=[],F=[];if(W instanceof p.D){for(const ee of W.state.grid.state.children)if(ee instanceof o.U&&(ee.state.variableName?U=U.concat(T(ee,L)):U.push(D(ee,L))),ee instanceof a.tI){if(ee.state.key.indexOf("-clone-")>0&&!L)continue;S(ee,U,L)}}let V=[];A instanceof h.s&&(V=(0,v.O)(A.state.annotationLayers)),K instanceof a.Pj&&(F=(0,P.C)(K));const w=B.controls?.state,z=w?.refreshPicker,N=M({refresh_intervals:z?.state.intervals,hidden:w?.hideTimeControls,nowDelay:j.UNSAFE_nowDelay},r.lt),H=B.$behaviors?.find(ee=>ee instanceof a.Gg.K2)?.state.sync??r.Ye.graphTooltip,Q=B.$behaviors?.find(ee=>ee instanceof a.Gg.en)?.isEnabled||void 0,X={...r.Ye,title:B.title,description:B.description||void 0,uid:B.uid,id:B.id,editable:B.editable,preload:B.preload,time:{from:j.from,to:j.to},timepicker:N,panels:U,annotations:{list:V},templating:{list:F},version:B.version,timezone:j.timeZone,fiscalYearStartMonth:j.fiscalYearStartMonth,weekStart:j.weekStart,tags:B.tags,links:B.links,graphTooltip:H,liveNow:Q,schemaVersion:d.O2,refresh:z?.state.refresh};return(0,i.v)(X)}function D(I,L=!1){let B,j=0,A=0,K=0,W=0,U=I;if(!(U.state.body instanceof a.Eb))throw new Error("DashboardGridItem body expected to be VizPanel");if(B=U.state.body,j=U.state.x??0,A=U.state.y??0,K=U.state.width??0,W=(U.state.variableName?U.state.itemHeight:U.state.height)??0,!B)throw new Error("Unsupported grid item type");return C(B,{x:j,y:A,h:W,w:K},L,U)}function C(I,L,B=!1,j){let A;if((0,y.ME)(I)){const U=(0,y.iL)(I);return A={id:(0,y.Cs)(I),title:U.state.title,gridPos:L,libraryPanel:{name:U.state.name,uid:U.state.uid}},A}else A={id:(0,y.Cs)(I),type:I.state.pluginId,title:I.state.title,description:I.state.description??void 0,gridPos:L,fieldConfig:I.state.fieldConfig??{defaults:{},overrides:[]},transformations:[],transparent:I.state.displayMode==="transparent",pluginVersion:I.state.pluginVersion,...b(I,B)};if(I.state.options){const{angularOptions:U,...F}=I.state.options;A.options=F,U&&(0,t.defaults)(A,U)}const K=I.state.$timeRange;K instanceof m.v&&(A.timeFrom=K.state.timeFrom,A.timeShift=K.state.timeShift,A.hideTimeOverride=K.state.hideTimeOverride),j instanceof o.U&&(j.state.variableName&&(A.repeat=j.state.variableName),j.state.maxPerRow&&(A.maxPerRow=j.state.maxPerRow),j.state.repeatDirection&&(A.repeatDirection=j.getRepeatDirection()));const W=f.b4.getPanelLinks(I);return A.links=W?.state.rawLinks??[],A.links.length===0&&delete A.links,A.transformations?.length===0&&delete A.transformations,A.transparent||delete A.transparent,A}function b(I,L=!1){const B=I.state.$data,j={},A=(0,y.un)(I);if(A&&(j.targets=A.state.queries,j.maxDataPoints=A.state.maxDataPoints,j.datasource=A.state.datasource,A.state.cacheTimeout&&(j.cacheTimeout=A.state.cacheTimeout),A.state.queryCachingTTL&&(j.queryCachingTTL=A.state.queryCachingTTL),A.state.minInterval&&(j.interval=A.state.minInterval)),B instanceof a.Es&&(j.transformations=B.state.transformations),B&&L){j.datasource=x.x;let K=(0,l.B6)(B.state.data);B instanceof a.Es&&(K=(0,l.B6)(B.state.$data.state.data)),j.targets=[{refId:"A",datasource:j.datasource,queryType:c.nj.Snapshot,snapshot:K}]}return j}function T(I,L=!1){if(L){if(I.state.body instanceof a.Eb&&(0,y.ME)(I.state.body)){const{x:B=0,y:j=0,width:A=0,height:K=0}=I.state;return[C(I.state.body,{x:B,y:j,w:A,h:K},L)]}if(I.state.repeatedPanels){const B=I.state.itemHeight??10,j=Math.ceil(I.state.repeatedPanels.length/I.getMaxPerRow()),A=Math.ceil(I.state.repeatedPanels.length/j),K=24/A,W=B;return I.state.repeatedPanels.map((F,V)=>{let w=0,z=0;I.state.repeatDirection==="v"?(w=I.state.x,z=V*W):(w=V%A*K,z=I.state.y+Math.floor(V/A)*W);const N={x:w,y:z,w:K,h:W},H=F.state.$variables.getByName(I.state.variableName);return{id:(0,y.Cs)(F),type:F.state.pluginId,title:F.state.title,gridPos:N,options:F.state.options,fieldConfig:F.state.fieldConfig??{defaults:{},overrides:[]},transformations:[],transparent:F.state.displayMode==="transparent",scopedVars:{[I.state.variableName]:{text:H?.state.text,value:H?.state.value}},...b(F,L)}})}return[]}else return[D(I)]}function S(I,L,B=!1){const j=!!I.state.isCollapsed,A={type:"row",id:(0,y.Cs)(I),title:I.state.title,gridPos:{x:I.state.x??0,y:I.state.y??0,w:I.state.width??24,h:I.state.height??1},collapsed:j,panels:[]};if(I.state.$behaviors?.length){const W=I.state.$behaviors[0];W instanceof u.L&&(A.repeat=W.state.variableName)}if(B&&I.state.$variables){const U=I.state.$variables.state.variables.reduce((F,V)=>({...F,[V.state.name]:{text:V.state.text,value:V.state.value}}),{});A.scopedVars=U}L.push(A);let K=[];B?I.state.children.forEach(W=>{W instanceof o.U&&(W.state.variableName?K=K.concat(T(W,!j)):K.push(D(W,!j)))}):K=I.state.children.map(W=>{if(!(W instanceof o.U))throw new Error("Row child expected to be DashboardGridItem");return D(W)}),I.state.isCollapsed?A.panels=K:L.push(...K)}function O(I,L,B,j){let A={...B,title:I,time:{from:L.from.toISOString(),to:L.to.toISOString()},links:[]};if(j){const K=B.panels?.find(W=>W.id===(0,y.Cs)(j));K&&(K.gridPos={w:24,x:0,y:0,h:20},A={...A,panels:[K]})}if(A.panels?.forEach(K=>{"links"in K&&(K.links=[])}),A.annotations){const W=(A.annotations.list?.filter(U=>U.enable)||[]).map(U=>({name:U.name,enable:U.enable,iconColor:U.iconColor,type:U.type,builtIn:U.builtIn,hide:U.hide,snapshotData:[]}));A.annotations.list=W}return A.templating&&A.templating.list?.forEach(K=>{"query"in K&&(K.query=""),"options"in K&&(K.options=K.current&&!(0,s.R)(K.current)?[K.current]:[]),"refresh"in K&&(K.refresh=g.CO.never)}),A}function M(I,L){const B={...I};for(const j in L)(0,t.isEqual)(B[j],L[j])&&delete B[j];return B}},24466:(G,R,e)=>{"use strict";e.d(R,{c:()=>u,h:()=>p});var t=e(74848),n=e(42941),s=e(41053),a=e(13544),r=e(14110),g=e(32264),i=e(55852),l=e(96374),d=e(94753),c=e(68402),h=e(37390),o=e(8484),m=e(55314);function u({dashboard:y}){const[x,v]=(0,n.A)(!1),[P]=(0,m.uz)(),[,E]=(0,s.A)(async()=>{(0,r.rR)("grafana_manage_dashboards_delete_clicked",{item_counts:{dashboard:1},source:"dashboard_scene_settings",restore_enabled:g.$.featureToggles.dashboardRestoreUI}),v(),y.state.uid&&await P({selectedItems:{dashboard:{[y.state.uid]:!0},folder:{}}}),await y.onDashboardDelete()},[y,v]);return y.state.meta.provisioned&&x?(0,t.jsx)(f,{dashboardId:y.state.meta.provisionedExternalId,onClose:v}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.$n,{variant:"destructive",onClick:v,"data-testid":a.Tp.pages.Dashboard.Settings.General.deleteDashBoard,children:(0,t.jsx)(o.x6,{i18nKey:"dashboard-settings.dashboard-delete-button",children:"Delete dashboard"})}),x&&(0,t.jsx)(p,{dashboardTitle:y.state.title,onConfirm:E,onClose:v})]})}function p({dashboardTitle:y,onConfirm:x,onClose:v}){return(0,t.jsx)(l.u,{isOpen:!0,body:(0,t.jsxs)(t.Fragment,{children:[g.$.featureToggles.dashboardRestore&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.E,{element:"p",children:(0,t.jsx)(o.x6,{i18nKey:"dashboard-settings.delete-modal-restore-dashboards-text",children:"This action will mark the dashboard for deletion in 30 days. Your organization administrator can restore it anytime before the 30 days expire."})}),(0,t.jsx)(c.$,{v:1})]}),(0,t.jsx)(d.E,{element:"p",children:(0,t.jsx)(o.x6,{i18nKey:"dashboard-settings.delete-modal-text",children:"Do you want to delete this dashboard?"})}),(0,t.jsx)(d.E,{element:"p",children:y}),(0,t.jsx)(c.$,{v:2})]}),onConfirm:x,onDismiss:v,title:(0,o.t)("dashboard-settings.delete-modal.title","Delete"),icon:"trash-alt",confirmText:(0,o.t)("dashboard-settings.delete-modal.delete-button","Delete"),confirmationText:(0,o.t)("dashboard-settings.delete-modal.confirmation-text","Delete")})}function f({dashboardId:y,onClose:x}){return(0,t.jsxs)(h.a,{isOpen:!0,title:"Cannot delete provisioned dashboard",icon:"trash-alt",onDismiss:x,children:[(0,t.jsx)("p",{children:"This dashboard is managed by Grafana provisioning and cannot be deleted. Remove the dashboard from the config file to delete it."}),(0,t.jsxs)("p",{children:[(0,t.jsxs)("i",{children:["See"," ",(0,t.jsx)("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",target:"_blank",rel:"noreferrer",children:"documentation"})," ","for more information about provisioning."]}),(0,t.jsx)("br",{}),"File path: ",y]}),(0,t.jsx)(h.a.ButtonRow,{children:(0,t.jsx)(i.$n,{variant:"primary",onClick:x,children:"OK"})})]})}},46502:(G,R,e)=>{"use strict";e.d(R,{F:()=>r});var t=e(74848),n=e(96540),s=e(32264),a=e(7376);class r extends n.PureComponent{constructor(){super(...arguments),this.ref=null}componentWillUnmount(){this.angularComponent&&this.angularComponent.destroy()}componentDidMount(){const i=s.$.angularSupportEnabled;this.ref&&i&&this.loadAngular()}componentDidUpdate(i){i.datasource!==this.props.datasource&&this.loadAngular(),this.scopeProps&&this.scopeProps.ctrl.currentAnnotation!==this.props.annotation&&(this.scopeProps.ctrl.ignoreNextWatcherFiring=!0,this.scopeProps.ctrl.currentAnnotation=this.props.annotation,this.angularComponent?.digest())}loadAngular(){this.angularComponent&&(this.angularComponent.destroy(),this.scopeProps=void 0);const i=(0,a.E)(),l='<plugin-component type="annotations-query-ctrl"> </plugin-component>',d={ctrl:{currentDatasource:this.props.datasource,currentAnnotation:this.props.annotation,ignoreNextWatcherFiring:!1}};this.angularComponent=i.load(this.ref,d,l),this.angularComponent.digest(),this.angularComponent.getScope().$watch(()=>{if(d.ctrl.ignoreNextWatcherFiring){d.ctrl.ignoreNextWatcherFiring=!1;return}this.props.onChange(d.ctrl.currentAnnotation)}),this.scopeProps=d}render(){return(0,t.jsx)("div",{ref:i=>this.ref=i})}}},65857:(G,R,e)=>{"use strict";e.d(R,{d:()=>o});var t=e(74848),n=e(88575),s=e(10354),a=e(90182),r=e(79924),g=e(57418),i=e(10880),l=e(55852),d=e(4588);const c=[{value:"dashboards",label:"Dashboards"},{value:"link",label:"Link"}],h=Object.keys(d.G).map(m=>({label:m,value:m}));function o({link:m,onUpdate:u,onGoBack:p}){const f=E=>{u({...m,tags:E})},y=E=>{const D={...m,type:E.value};D.type==="dashboards"?(D.url="",D.tooltip=""):D.tags=[],u(D)},x=E=>{u({...m,icon:E.value})},v=E=>{const D=E.currentTarget;u({...m,[D.name]:D.type==="checkbox"?D.checked:D.value})},P=m.title===d.q.title;return(0,t.jsxs)("div",{style:{maxWidth:"600px"},children:[(0,t.jsx)(n.D,{label:"Title",children:(0,t.jsx)(s.p,{name:"title",id:"title",value:m.title,onChange:v,autoFocus:P})}),(0,t.jsx)(n.D,{label:"Type",children:(0,t.jsx)(a.l6,{inputId:"link-type-input",value:m.type,options:c,onChange:y})}),m.type==="dashboards"&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.D,{label:"With tags",children:(0,t.jsx)(r.u,{tags:m.tags,onChange:f})})}),m.type==="link"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.D,{label:"URL",children:(0,t.jsx)(s.p,{name:"url",value:m.url,onChange:v})}),(0,t.jsx)(n.D,{label:"Tooltip",children:(0,t.jsx)(s.p,{name:"tooltip",value:m.tooltip,onChange:v,placeholder:"Open dashboard"})}),(0,t.jsx)(n.D,{label:"Icon",children:(0,t.jsx)(a.l6,{value:m.icon,options:h,onChange:x})})]}),(0,t.jsxs)(g.M,{label:"Options",isOpen:!0,children:[m.type==="dashboards"&&(0,t.jsx)(n.D,{children:(0,t.jsx)(i.S,{label:"Show as dropdown",name:"asDropdown",value:m.asDropdown,onChange:v})}),(0,t.jsx)(n.D,{children:(0,t.jsx)(i.S,{label:"Include current time range",name:"keepTime",value:m.keepTime,onChange:v})}),(0,t.jsx)(n.D,{children:(0,t.jsx)(i.S,{label:"Include current template variable values",name:"includeVars",value:m.includeVars,onChange:v})}),(0,t.jsx)(n.D,{children:(0,t.jsx)(i.S,{label:"Open link in new tab",name:"targetBlank",value:m.targetBlank,onChange:v})})]}),(0,t.jsx)(l.$n,{variant:"secondary",onClick:p,children:"Back to list"})]})}},6199:(G,R,e)=>{"use strict";e.d(R,{X:()=>m});var t=e(74848),n=e(32196),s=e(40845),a=e(67061),r=e(69529),g=e(55852),i=e(72109),l=e(14578),d=e(64149),c=e(29158),h=e(91605),o=e(8484);function m({links:p,onNew:f,onOrderChange:y,onEdit:x,onDuplicate:v,onDelete:P}){const E=(0,s.of)(u);return p.length===0?(0,t.jsx)(a.B,{direction:"column",children:(0,t.jsx)(r.p,{variant:"call-to-action",button:(0,t.jsx)(g.$n,{onClick:f,size:"lg",children:(0,t.jsx)(o.x6,{i18nKey:"dashboard-links.empty-state.button-title",children:"Add dashboard link"})}),message:(0,o.t)("dashboard-links.empty-state.title","There are no dashboard links added yet"),children:(0,t.jsxs)(o.x6,{i18nKey:"dashboard-links.empty-state.info-box-content",children:["Dashboard links allow you to place links to other dashboards and web sites directly below the dashboard header."," ",(0,t.jsx)(i.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/manage-dashboard-links/",children:"Learn more"})]})})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("table",{role:"grid",className:"filter-table filter-table--hover",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Type"}),(0,t.jsx)("th",{children:"Info"}),(0,t.jsx)("th",{colSpan:3})]})}),(0,t.jsx)("tbody",{children:p.map((C,b)=>(0,t.jsxs)("tr",{children:[(0,t.jsxs)("td",{role:"gridcell",className:"pointer",onClick:()=>x(b),children:[(0,t.jsx)(l.I,{name:"external-link-alt"})," \xA0 ",C.type]}),(0,t.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>x(b),children:(0,t.jsxs)(a.B,{children:[C.title&&(0,t.jsx)("span",{className:E.titleWrapper,children:C.title}),C.type==="link"&&(0,t.jsx)("span",{className:E.urlWrapper,children:C.url}),C.type==="dashboards"&&(0,t.jsx)(d.L,{tags:C.tags??[]})]})}),(0,t.jsx)("td",{style:{width:"1%"},role:"gridcell",children:b!==0&&(0,t.jsx)(c.K,{name:"arrow-up",onClick:()=>y(b,-1),tooltip:"Move link up"})}),(0,t.jsx)("td",{style:{width:"1%"},role:"gridcell",children:p.length>1&&b!==p.length-1?(0,t.jsx)(c.K,{name:"arrow-down",onClick:()=>y(b,1),tooltip:"Move link down"}):null}),(0,t.jsx)("td",{style:{width:"1%"},role:"gridcell",children:(0,t.jsx)(c.K,{name:"copy",onClick:()=>v(C),tooltip:"Copy link"})}),(0,t.jsx)("td",{style:{width:"1%"},role:"gridcell",children:(0,t.jsx)(h.e,{"aria-label":`Delete link with title "${C.title}"`,size:"sm",onConfirm:()=>P(b)})})]},`${C.title}-${b}`))})]}),(0,t.jsx)(g.$n,{className:E.newLinkButton,icon:"plus",onClick:f,children:"New link"})]})}const u=p=>({titleWrapper:(0,n.css)({width:"20vw",textOverflow:"ellipsis",overflow:"hidden"}),urlWrapper:(0,n.css)({width:"40vw",textOverflow:"ellipsis",overflow:"hidden"}),newLinkButton:(0,n.css)({marginTop:p.spacing(3)})})},4588:(G,R,e)=>{"use strict";e.d(R,{G:()=>n,q:()=>t});const t={icon:"external link",title:"New link",tooltip:"",type:"dashboards",url:"",asDropdown:!1,tags:[],targetBlank:!1,keepTime:!1,includeVars:!1},n={"external link":"external-link-alt",dashboard:"apps",question:"question-circle",info:"info-circle",bolt:"bolt",doc:"file-alt",cloud:"cloud"}},27803:(G,R,e)=>{"use strict";e.d(R,{Q:()=>h});var t=e(74848),n=e(96540),s=e(72436),a=e(13544),r=e(88575),g=e(42418),i=e(15292),l=e(32372),d=e(51612),c=e(58975);function h({datasource:o,infoText:m,onDataSourceChange:u,onDefaultKeysChange:p,defaultKeys:f}){const y=(0,n.useCallback)(x=>{const v=(0,s.Jh)(`key,value
`+x)[0],P=[];for(let E=0;E<v.length;E++)P.push({text:v.fields[0].values[E],value:v.fields[1].values[E]});p?.(P)},[p]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.Y,{children:"Ad-hoc options"}),(0,t.jsx)(r.D,{label:"Data source",htmlFor:"data-source-picker",children:(0,t.jsx)(d.s,{current:o,onChange:u,width:30,variables:!0,noDefault:!0})}),m?(0,t.jsx)(g.F,{title:m,severity:"info","data-testid":a.Tp.pages.Dashboard.Settings.Variables.Edit.AdHocFiltersVariable.infoText}):null,p&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.D,{label:"Use static key dimensions",description:"Provide dimensions as CSV: dimensionName, dimensionId",children:(0,t.jsx)(i.d,{"data-testid":a.Tp.pages.Dashboard.Settings.Variables.Edit.AdHocFiltersVariable.modeToggle,value:f!==void 0,onChange:x=>{p(f===void 0?[]:void 0)}})}),f!==void 0&&(0,t.jsx)(l.B,{height:300,language:"csv",value:f.map(x=>`${x.text},${x.value}`).join(`
`),onBlur:y,onSave:y,showMiniMap:!1,showLineNumbers:!0})]})]})}},95802:(G,R,e)=>{"use strict";e.d(R,{d:()=>r});var t=e(74848),n=e(13544),s=e(58975),a=e(14329);function r({onChange:g,constantValue:i}){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.Y,{children:"Constant options"}),(0,t.jsx)(a._,{defaultValue:i,name:"Value",placeholder:"your metric prefix",onBlur:g,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.ConstantVariable.constantOptionsQueryInputV2,width:30})]})}},58711:(G,R,e)=>{"use strict";e.d(R,{w:()=>g});var t=e(74848),n=e(13544),s=e(58975),a=e(85140),r=e(94618);function g({query:i,multi:l,allValue:d,includeAll:c,onQueryChange:h,onMultiChange:o,onIncludeAllChange:m,onAllValueChange:u}){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.Y,{children:"Custom options"}),(0,t.jsx)(a.Z,{name:"Values separated by comma",defaultValue:i,placeholder:"1, 10, mykey : myvalue, myvalue, escaped\\,value",onBlur:h,required:!0,width:52,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.CustomVariable.customValueInput}),(0,t.jsx)(s.Y,{children:"Selection options"}),(0,t.jsx)(r.B,{multi:l,includeAll:c,allValue:d,onMultiChange:o,onIncludeAllChange:m,onAllValueChange:u})]})}},98917:(G,R,e)=>{"use strict";e.d(R,{y:()=>i});var t=e(74848),n=e(13544),s=e(94618),a=e(58975),r=e(89458),g=e(14329);function i({query:l,regex:d,optionTypes:c,onChange:h,onRegExBlur:o,multi:m,includeAll:u,allValue:p,onMultiChange:f,onIncludeAllChange:y,onAllValueChange:x}){const v=c.find(P=>P.value===l)??c[0];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.Y,{children:"Data source options"}),(0,t.jsx)(r.v,{name:"Type",value:v,options:c,onChange:h,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.DatasourceVariable.datasourceSelect}),(0,t.jsx)(g._,{defaultValue:d,name:"Instance name filter",placeholder:"/.*-(.*)-.*/",onBlur:o,description:(0,t.jsxs)("div",{children:["Regex filter for which data source instances to choose from in the variable value list. Leave empty for all.",(0,t.jsx)("br",{}),(0,t.jsx)("br",{}),"Example: ",(0,t.jsx)("code",{children:"/^prod/"})]})}),(0,t.jsx)(a.Y,{children:"Selection options"}),(0,t.jsx)(s.B,{multi:m,includeAll:u,allValue:p,onMultiChange:f,onIncludeAllChange:y,onAllValueChange:x})]})}},49317:(G,R,e)=>{"use strict";e.d(R,{s:()=>d});var t=e(74848),n=e(32196),s=e(13544),a=e(40845),r=e(99615),g=e(58975),i=e(89458),l=e(14329);function d({intervals:h,onIntervalsChange:o,onAutoEnabledChange:m,onAutoMinIntervalChanged:u,onAutoCountChanged:p,autoEnabled:f,autoMinInterval:y,autoStepCount:x}){const v=[1,2,3,4,5,10,20,30,40,50,100,200,300,400,500].map(D=>({label:`${D}`,value:D})),P=(0,a.of)(c),E=v.find(D=>D.value===x)??v[0];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.Y,{children:"Interval options"}),(0,t.jsx)(l._,{defaultValue:h,name:"Values",placeholder:"1m,10m,1h,6h,1d,7d",onBlur:o,testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.intervalsValueInput,width:32,required:!0}),(0,t.jsx)(r.c,{value:f,name:"Auto option",description:"Dynamically calculates interval by dividing time range by the count specified",onChange:m,testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.autoEnabledCheckbox}),f&&(0,t.jsxs)("div",{className:P.autoFields,children:[(0,t.jsx)(i.v,{name:"Step count",description:"How many times the current time range should be divided to calculate the value",value:E,options:v,onChange:p,width:9,testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.stepCountIntervalSelect}),(0,t.jsx)(l._,{value:y,name:"Min interval",description:"The calculated value will not go below this threshold",placeholder:"10s",onChange:u,width:11,testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.minIntervalInput})]})]})}const c=h=>({autoFields:(0,n.css)({marginTop:h.spacing(2),display:"flex",flexDirection:"column"})})},44890:(G,R,e)=>{"use strict";e.d(R,{u:()=>O});var t=e(74848),n=e(16817),s=e(13544),a=e(19347),r=e(88575),g=e(39070),i=e(72574),l=e(90613),d=e(94753),c=e(24240);function h({query:M,datasource:I,VariableQueryEditor:L,onLegacyQueryChange:B,onQueryChange:j,timeRange:A}){let K;return typeof M=="string"?K=M||(I.variables?.getDefaultQuery?.()??""):K={...I.variables?.getDefaultQuery?.(),...M},L&&(0,c.VN)(L,I)?(0,t.jsxs)(l.a,{marginBottom:2,children:[(0,t.jsx)(d.E,{element:"h4",children:"Query"}),(0,t.jsx)(l.a,{marginTop:1,children:(0,t.jsx)(L,{datasource:I,query:K,templateSrv:(0,i.w)(),onChange:B},I.uid)})]}):L&&(0,c.CH)(L,I)?(0,t.jsxs)(l.a,{marginBottom:2,children:[(0,t.jsx)(d.E,{element:"h4",children:"Query"}),(0,t.jsx)(l.a,{marginTop:1,children:(0,t.jsx)(L,{datasource:I,query:K,onChange:j,onRunQuery:()=>{},data:{series:[],state:g.Gu.Done,timeRange:A},range:A,onBlur:()=>{},history:[]},I.uid)})]}):null}var o=e(94618),m=e(51612),u=e(70766),p=e(96540),f=e(12470),y=e(40845),x=e(94354),v=e(60619);const P=[{label:"On dashboard load",value:f.CO.onDashboardLoad},{label:"On time range change",value:f.CO.onTimeRangeChanged}];function E({onChange:M,refresh:I,testId:L}){const B=(0,y.$j)(),[j,A]=(0,p.useState)(!1);(0,v.Y)({breakpoint:B.breakpoints.values.sm,onChange:W=>{A(!W.matches)}});const K=(0,p.useMemo)(()=>P.find(W=>W.value===I)?.value??P[0].value,[I]);return(0,t.jsx)(r.D,{label:"Refresh",description:"When to update the values of this variable","data-testid":L,children:(0,t.jsx)(x.z,{options:P,onChange:M,value:K,size:j?"sm":"md"})})}var D=e(89458);const C=[{label:"Disabled",value:f.ZG.disabled},{label:"Alphabetical (asc)",value:f.ZG.alphabeticalAsc},{label:"Alphabetical (desc)",value:f.ZG.alphabeticalDesc},{label:"Numerical (asc)",value:f.ZG.numericalAsc},{label:"Numerical (desc)",value:f.ZG.numericalDesc},{label:"Alphabetical (case-insensitive, asc)",value:f.ZG.alphabeticalCaseInsensitiveAsc},{label:"Alphabetical (case-insensitive, desc)",value:f.ZG.alphabeticalCaseInsensitiveDesc},{label:"Natural (asc)",value:f.ZG.naturalAsc},{label:"Natural (desc)",value:f.ZG.naturalDesc}];function b({onChange:M,sort:I,testId:L}){const B=(0,p.useMemo)(()=>C.find(j=>j.value===I)??C[0],[I]);return(0,t.jsx)(D.v,{name:"Sort",description:"How to sort the values of this variable",value:B,options:C,onChange:M,testId:L,width:25})}var T=e(58975),S=e(85140);function O({datasource:M,onDataSourceChange:I,query:L,onQueryChange:B,onLegacyQueryChange:j,timeRange:A,regex:K,onRegExChange:W,sort:U,onSortChange:F,refresh:V,onRefreshChange:w,isMulti:z,onMultiChange:N,includeAll:H,onIncludeAllChange:Q,allValue:X,onAllValueChange:ee}){const{value:Z}=(0,n.A)(async()=>{const k=await(0,a.l)().get(M??""),se=await(0,u.y)(k);return{datasource:k,VariableQueryEditor:se}},[M]),{datasource:q,VariableQueryEditor:ae}=Z??{};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(T.Y,{children:"Query options"}),(0,t.jsx)(r.D,{label:"Data source",htmlFor:"data-source-picker",children:(0,t.jsx)(m.s,{current:M,onChange:I,variables:!0,width:30})}),q&&ae&&(0,t.jsx)(h,{onQueryChange:B,onLegacyQueryChange:j,datasource:q,query:L,VariableQueryEditor:ae,timeRange:A}),(0,t.jsx)(S.Z,{defaultValue:K??"",name:"Regex",description:(0,t.jsxs)("div",{children:["Optional, if you want to extract part of a series name or metric node segment.",(0,t.jsx)("br",{}),"Named capture groups can be used to separate the display text and value (",(0,t.jsx)("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/variables/filter-variables-with-regex#filter-and-modify-using-named-text-and-value-capture-groups",target:"__blank",children:"see examples"}),")."]}),placeholder:"/.*-(?<text>.*)-(?<value>.*)-.*/",onBlur:W,testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsRegExInputV2,width:52}),(0,t.jsx)(b,{testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsSortSelectV2,onChange:F,sort:U}),(0,t.jsx)(E,{testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsRefreshSelectV2,onChange:w,refresh:V}),(0,t.jsx)(T.Y,{children:"Selection options"}),(0,t.jsx)(o.B,{multi:!!z,includeAll:!!H,allValue:X,onMultiChange:N,onIncludeAllChange:Q,onAllValueChange:ee})]})}},94618:(G,R,e)=>{"use strict";e.d(R,{B:()=>g});var t=e(74848),n=e(13544),s=e(67061),a=e(99615),r=e(14329);function g({multi:i,includeAll:l,allValue:d,onMultiChange:c,onIncludeAllChange:h,onAllValueChange:o}){return(0,t.jsxs)(s.B,{direction:"column",gap:2,height:"inherit",alignItems:"start",children:[(0,t.jsx)(a.c,{value:i,name:"Multi-value",description:"Enables multiple values to be selected at the same time",onChange:c,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsMultiSwitch}),(0,t.jsx)(a.c,{value:l,name:"Include All option",description:"Enables an option to include all variables",onChange:h,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsIncludeAllSwitch}),l&&(0,t.jsx)(r._,{defaultValue:d??"",onBlur:o,name:"Custom all value",placeholder:"blank = auto",testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsCustomAllInput})]})}},99615:(G,R,e)=>{"use strict";e.d(R,{c:()=>a});var t=e(74848),n=e(92145),s=e(10880);function a({value:r,name:g,description:i,onChange:l,ariaLabel:d,testId:c}){const h=(0,n.Bi)();return(0,t.jsx)(s.S,{id:h,label:g,description:i,value:r,onChange:l,"aria-label":d,"data-testid":c})}},8964:(G,R,e)=>{"use strict";e.d(R,{D:()=>i});var t=e(74848),n=e(96540),s=e(12470),a=e(88575),r=e(94354);const g=[{label:"Label and value",value:s.zL.dontHide},{label:"Value",value:s.zL.hideLabel},{label:"Nothing",value:s.zL.hideVariable}];function i({onChange:l,hide:d,type:c}){const h=(0,n.useMemo)(()=>g.find(o=>o.value===d)?.value??g[0].value,[d]);return c==="constant"?null:(0,t.jsx)(a.D,{label:"Show on dashboard",children:(0,t.jsx)(r.z,{options:g,onChange:l,value:h})})}},58975:(G,R,e)=>{"use strict";e.d(R,{Y:()=>r});var t=e(74848),n=e(32196),s=e(40845),a=e(17408);function r({className:i,...l}){const d=(0,s.of)(g);return(0,t.jsx)(a.s,{...l,className:(0,n.cx)(d.legend,i)})}function g(i){return{legend:(0,n.css)({marginTop:i.spacing(3),marginBottom:i.spacing(1)})}}},89458:(G,R,e)=>{"use strict";e.d(R,{v:()=>i});var t=e(74848),n=e(32196),s=e(96540),a=e(40845),r=e(88575),g=e(90182);function i({name:d,description:c,value:h,options:o,onChange:m,testId:u,width:p}){const f=(0,a.of)(l),y=(0,s.useId)(),x=`variable-select-input-${d}-${y}`;return(0,t.jsx)(r.D,{label:d,description:c,htmlFor:x,children:(0,t.jsx)(g.l6,{"data-testid":u,inputId:x,onChange:m,value:h,width:p??30,options:o,className:f.selectContainer})})}function l(d){return{selectContainer:(0,n.css)({marginRight:d.spacing(.5)})}}},85140:(G,R,e)=>{"use strict";e.d(R,{$:()=>l,Z:()=>i});var t=e(74848),n=e(32196),s=e(92145),a=e(40845),r=e(88575),g=e(21744);function i({value:d,defaultValue:c,name:h,description:o,placeholder:m,onChange:u,onBlur:p,ariaLabel:f,required:y,width:x,testId:v}){const P=(0,a.of)(l),E=(0,s.Bi)();return(0,t.jsx)(r.D,{label:h,description:o,htmlFor:E,children:(0,t.jsx)(g.f,{id:E,rows:2,value:d,defaultValue:c,onChange:u,onBlur:p,placeholder:m,required:y,"aria-label":f,cols:x,className:P.textarea,"data-testid":v})})}function l(d){return{textarea:(0,n.css)({whiteSpace:"pre-wrap",minHeight:d.spacing(4),height:"auto",overflow:"auto",padding:`${d.spacing(.75)} ${d.spacing(1)}`,width:"inherit",[d.breakpoints.down("sm")]:{width:"100%"}})}}},14329:(G,R,e)=>{"use strict";e.d(R,{_:()=>r});var t=e(74848),n=e(92145),s=e(88575),a=e(10354);function r({value:g,defaultValue:i,name:l,placeholder:d="",onChange:c,testId:h,width:o,required:m,onBlur:u,grow:p,description:f,invalid:y,error:x,maxLength:v}){const P=(0,n.Bi)(l);return(0,t.jsx)(s.D,{label:l,description:f,invalid:y,error:x,htmlFor:P,children:(0,t.jsx)(a.p,{type:"text",id:P,placeholder:d,value:g,defaultValue:i,onChange:c,onBlur:u,width:p?void 0:o??30,"data-testid":h,maxLength:v,required:m})})}},41820:(G,R,e)=>{"use strict";e.d(R,{j:()=>d});var t=e(74848),n=e(32196),s=e(96540),a=e(13544),r=e(40845),g=e(39268),i=e(76892),l=e(55852);const d=({options:h})=>{const[o,m]=(0,s.useState)(20),[u,p]=(0,s.useState)([]),f=(0,s.useCallback)(x=>{x.preventDefault(),m(o+20)},[o,m]),y=(0,r.of)(c);return(0,s.useEffect)(()=>p(h.slice(0,o)),[o,h]),u.length?(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",marginTop:"16px"},children:[(0,t.jsx)("h5",{children:"Preview of values"}),(0,t.jsx)(g.C,{children:u.map((x,v)=>(0,t.jsx)(g.C,{className:y.optionContainer,children:(0,t.jsx)(i.c,{"data-testid":a.Tp.pages.Dashboard.Settings.Variables.Edit.General.previewOfValuesOption,children:(0,t.jsx)("div",{className:y.label,children:x.label})})},`${x.value}-${v}`))}),h.length>o&&(0,t.jsx)(g.C,{className:y.optionContainer,children:(0,t.jsx)(l.$n,{onClick:f,variant:"secondary",size:"sm","aria-label":"Variable editor Preview of Values Show More link",children:"Show more"})})]}):null};d.displayName="VariableValuesPreview";function c(h){return{wrapper:(0,n.css)({display:"flex",flexDirection:"column",marginTop:h.spacing(2)}),optionContainer:(0,n.css)({marginLeft:h.spacing(.5),marginBottom:h.spacing(.5)}),label:(0,n.css)({whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"50vw"})}}},17663:(G,R,e)=>{"use strict";e.d(R,{cH:()=>k,mJ:()=>se,Ao:()=>ee,e4:()=>Z,kh:()=>H,CD:()=>z,No:()=>N,B$:()=>w,n_:()=>X,bZ:()=>U,c7:()=>ae});var t=e(2543),n=e(32264),s=e(19347),a=e(84537),r=e(79422),g=e(74730),i=e(74848),l=e(16817),d=e(22391),c=e(27803);function h(te){const{variable:ne}=te,{datasource:le,defaultKeys:re}=ne.useState(),{value:de}=(0,l.A)(async()=>await(0,s.l)().get(le),[le]),oe=de?.getTagKeys?"Ad hoc filters are applied automatically to all queries that target this data source":"This data source does not support ad hoc filters yet.",J=pe=>{const xe=(0,d.p$)(pe);ne.setState({datasource:xe,supportsMultiValueOperators:pe.meta.multiValueFilterOperators})},ce=pe=>{ne.setState({defaultKeys:pe})};return(0,i.jsx)(c.Q,{datasource:le??void 0,infoText:oe,onDataSourceChange:J,defaultKeys:re,onDefaultKeysChange:ce})}var o=e(95802);function m({variable:te}){const{value:ne}=te.useState(),le=re=>{te.setState({value:re.currentTarget.value})};return(0,i.jsx)(o.d,{constantValue:String(ne),onChange:le})}var u=e(58711);function p({variable:te,onRunQuery:ne}){const{query:le,isMulti:re,allValue:de,includeAll:oe}=te.useState(),J=fe=>{te.setState({isMulti:fe.currentTarget.checked})},ce=fe=>{te.setState({includeAll:fe.currentTarget.checked})},pe=fe=>{te.setState({query:fe.currentTarget.value}),ne()},xe=fe=>{te.setState({allValue:fe.currentTarget.value})};return(0,i.jsx)(u.w,{query:le??"",multi:!!re,allValue:de??"",includeAll:!!oe,onMultiChange:J,onIncludeAllChange:ce,onQueryChange:pe,onAllValueChange:xe})}var f=e(98917);function y({variable:te,onRunQuery:ne}){const{pluginId:le,regex:re,isMulti:de,allValue:oe,includeAll:J}=te.useState(),ce=Z(),pe=ye=>{te.setState({pluginId:ye.value}),ne()},xe=ye=>{te.setState({regex:ye.currentTarget.value}),ne()},fe=ye=>{te.setState({isMulti:ye.currentTarget.checked})},Ee=ye=>{te.setState({includeAll:ye.currentTarget.checked})},Se=ye=>{te.setState({allValue:ye.currentTarget.value})};return(0,i.jsx)(f.y,{query:le,regex:re,multi:de||!1,allValue:oe,includeAll:J||!1,optionTypes:ce,onChange:pe,onRegExBlur:xe,onMultiChange:fe,onIncludeAllChange:Ee,onAllValueChange:Se})}var x=e(96540),v=e(72436),P=e(13544),E=e(88575),D=e(42418),C=e(15292),b=e(32372),T=e(51612),S=e(58975);function O({datasource:te,defaultOptions:ne,infoText:le,onDataSourceChange:re,onDefaultOptionsChange:de}){const oe=(0,x.useCallback)(J=>{const ce=(0,v.Jh)(`key,value
`+J)[0],pe=[];for(let xe=0;xe<ce.length;xe++)pe.push({text:ce.fields[0].values[xe],value:ce.fields[1].values[xe]});de(pe)},[de]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(S.Y,{children:"Group by options"}),(0,i.jsx)(E.D,{label:"Data source",htmlFor:"data-source-picker",children:(0,i.jsx)(T.s,{current:te,onChange:re,width:30,variables:!0,noDefault:!0})}),le?(0,i.jsx)(D.F,{title:le,severity:"info","data-testid":P.Tp.pages.Dashboard.Settings.Variables.Edit.GroupByVariable.infoText}):null,(0,i.jsx)(E.D,{label:"Use static Group By dimensions",description:"Provide dimensions as CSV: dimensionName, dimensionId",children:(0,i.jsx)(C.d,{"data-testid":P.Tp.pages.Dashboard.Settings.Variables.Edit.GroupByVariable.modeToggle,value:ne!==void 0,onChange:J=>{de(ne===void 0?[]:void 0)}})}),ne!==void 0&&(0,i.jsx)(b.B,{height:300,language:"csv",value:ne.map(J=>`${J.text},${J.value}`).join(`
`),onBlur:oe,onSave:oe,showMiniMap:!1,showLineNumbers:!0})]})}function M(te){const{variable:ne,onRunQuery:le}=te,{datasource:re,defaultOptions:de}=ne.useState(),{value:oe}=(0,l.A)(async()=>await(0,s.l)().get(re),[ne.state]),J=oe?.getTagKeys?"Group by dimensions are applied automatically to all queries that target this data source":"This data source does not support group by variable yet.",ce=async xe=>{const fe=(0,d.p$)(xe);ne.setState({datasource:fe}),le()},pe=async xe=>{ne.setState({defaultOptions:xe}),le()};return(0,i.jsx)(O,{defaultOptions:de,datasource:re??void 0,infoText:re?J:void 0,onDataSourceChange:ce,onDefaultOptionsChange:pe})}var I=e(49317);function L({variable:te,onRunQuery:ne}){const{intervals:le,autoStepCount:re,autoEnabled:de,autoMinInterval:oe,value:J}=te.useState(),ce=(0,g.bx)(le),pe=Se=>{const ye=(0,g.Sm)(Se.currentTarget.value),Ve=ye.includes(J)?J:ye[0];te.setState({intervals:ye,value:Ve}),ne()},xe=Se=>{te.setState({autoStepCount:Se.value})},fe=Se=>{te.setState({autoEnabled:Se.target.checked})},Ee=Se=>{te.setState({autoMinInterval:Se.currentTarget.value})};return(0,i.jsx)(I.s,{intervals:ce,autoStepCount:re,autoEnabled:de,onAutoCountChanged:xe,onIntervalsChange:pe,onAutoEnabledChange:fe,onAutoMinIntervalChanged:Ee,autoMinInterval:oe})}var B=e(44890);function j({variable:te,onRunQuery:ne}){const{datasource:le,regex:re,sort:de,refresh:oe,isMulti:J,includeAll:ce,allValue:pe,query:xe}=te.useState(),{value:fe}=a.jh.getTimeRange(te).useState(),Ee=we=>{te.setState({regex:we.currentTarget.value})},Se=we=>{te.setState({sort:we.value})},ye=we=>{te.setState({refresh:we})},Ve=we=>{te.setState({isMulti:we.currentTarget.checked})},Me=we=>{te.setState({includeAll:we.currentTarget.checked})},Ce=we=>{te.setState({allValue:we.currentTarget.value})},Ue=we=>{const We=(0,d.p$)(we);if(te.state.datasource&&te.state.datasource.type!==We.type){te.setState({datasource:We,query:"",definition:""});return}te.setState({datasource:We})},Ae=we=>{let We;typeof we=="string"?We=we:we.hasOwnProperty("query")&&typeof we.query=="string"?We=we.query:We="",te.setState({query:we,definition:We}),ne()};return(0,i.jsx)(B.u,{datasource:le??void 0,onDataSourceChange:Ue,query:xe,onQueryChange:Ae,onLegacyQueryChange:Ae,timeRange:fe,regex:re,onRegExChange:Ee,sort:de,onSortChange:Se,refresh:oe,onRefreshChange:ye,isMulti:!!J,onMultiChange:Ve,includeAll:!!ce,onIncludeAllChange:Me,allValue:pe??"",onAllValueChange:Ce})}var A=e(14329);function K({defaultValue:te,value:ne,onChange:le,onBlur:re}){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(S.Y,{children:"Text options"}),(0,i.jsx)(A._,{value:ne,defaultValue:te,name:"Default value",placeholder:"default value, if any",onChange:le,onBlur:re,width:30,testId:P.Tp.pages.Dashboard.Settings.Variables.Edit.TextBoxVariable.textBoxOptionsQueryInputV2})]})}function W({variable:te}){const{value:ne}=te.useState(),le=re=>{te.setState({value:re.currentTarget.value})};return(0,i.jsx)(K,{defaultValue:ne,onBlur:le})}function U(te){return te!=="system"}const F={custom:{name:"Custom",description:"Define variable values manually",editor:p},query:{name:"Query",description:"Variable values are fetched from a datasource query",editor:j},constant:{name:"Constant",description:"Define a hidden constant variable, useful for metric prefixes in dashboards you want to share",editor:m},interval:{name:"Interval",description:"Define a timespan interval (ex 1m, 1h, 1d)",editor:L},datasource:{name:"Data source",description:"Enables you to dynamically switch the data source for multiple panels",editor:y},adhoc:{name:"Ad hoc filters",description:"Add key/value filters on the fly",editor:h},groupby:{name:"Group by",description:"Add keys to group by on the fly",editor:M},textbox:{name:"Textbox",description:"Define a textbox variable, where users can enter any arbitrary string",editor:W}},V=["query","custom","textbox","constant","datasource","interval","adhoc","groupby"];function w(){const te=V.map(ne=>({label:F[ne].name,value:ne,description:F[ne].description}));return n.$.featureToggles.groupByVariable?te:te.filter(ne=>ne.value!=="groupby")}function z(te){return F[te].editor}function N(te,ne){switch(te){case"custom":return new a.yP(ne);case"query":return new a.fS(ne);case"constant":return new a.x0({...ne,hide:r.zL.hideVariable});case"interval":return new a.Yj(ne);case"datasource":return new a.mI(ne);case"adhoc":return new a.H9({...ne,layout:n.$.featureToggles.newFiltersUI?"combobox":void 0});case"groupby":return new a.ZG(ne);case"textbox":return new a.TS(ne)}}function H(te){const le=Q("query",te);return new a.fS({name:le})}function Q(te,ne){let le=0,re=`${te}${le}`;for(;ne.find(de=>de.state.name===re);)re=`${te}${++le}`;return re}function X(te){return"options"in te.state||"intervals"in te.state}function ee(te){let ne="";return te instanceof a.fS?ne=te.state.definition||(typeof te.state.query=="string"?te.state.query:""):te instanceof a.mI?ne=String(te.state.pluginId):te instanceof a.yP?ne=te.state.query:te instanceof a.Yj?ne=(0,g.bx)(te.state.intervals):(te instanceof a.TS||te instanceof a.x0)&&(ne=String(te.state.value)),ne}function Z(){const te=(0,s.l)().getList({metrics:!0,variables:!0}),ne=(0,t.chain)(te).uniqBy("meta.id").map(le=>({label:le.meta.name,value:le.meta.id})).value();return ne.unshift({label:"",value:""}),ne}function q(te){return"type"in te.state&&"getValue"in te}function ae(te){return q(te)?a.Go.isAdHocVariable(te)||a.Go.isConstantVariable(te)||a.Go.isCustomVariable(te)||a.Go.isDataSourceVariable(te)||a.Go.isIntervalVariable(te)||a.Go.isQueryVariable(te)||a.Go.isTextBoxVariable(te)||a.Go.isGroupByVariable(te):!1}const k=/^(?!__).*$/,se=/^\w+$/},19626:(G,R,e)=>{"use strict";e.d(R,{D:()=>o});var t=e(74848),n=e(32196),s=e(2543),a=e(40845),r=e(14578);const g=({diff:u})=>{const p=(0,a.of)(i),f=!(0,s.isUndefined)(u.originalValue)&&!(0,s.isArray)(u.originalValue)&&!(0,s.isObject)(u.originalValue),y=!(0,s.isUndefined)(u.value)&&!(0,s.isArray)(u.value)&&!(0,s.isObject)(u.value);return(0,t.jsxs)(t.Fragment,{children:[f&&(0,t.jsx)("span",{className:p,children:String(u.originalValue)}),f&&y?(0,t.jsx)(r.I,{name:"arrow-right"}):null,y&&(0,t.jsx)("span",{className:p,children:String(u.value)})]})},i=u=>(0,n.css)({backgroundColor:u.colors.action.hover,borderRadius:u.shape.radius.default,color:u.colors.text.primary,fontSize:u.typography.body.fontSize,margin:u.spacing(0,.5),padding:u.spacing(.25,.5)});var l=e(56596);const d={op:"replace",originalValue:void 0,path:[""],value:void 0,startLineNumber:0,endLineNumber:0},c=({diff:u,title:p})=>{const f=(0,a.of)(h);return u?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.I,{type:"mono",name:"circle",className:f[u.op],size:"xs"})," ",(0,t.jsx)("span",{className:f.embolden,children:p})," ",(0,t.jsx)("span",{children:(0,l.Fl)(u,u.path.length>1)})," ",(0,t.jsx)(g,{diff:u})]}):(0,t.jsxs)("div",{className:f.withoutDiff,children:[(0,t.jsx)(r.I,{type:"mono",name:"circle",className:f.replace,size:"xs"})," ",(0,t.jsx)("span",{className:f.embolden,children:p})," ",(0,t.jsx)("span",{children:(0,l.Fl)(d,!1)})]})},h=u=>({embolden:(0,n.css)({fontWeight:u.typography.fontWeightBold}),add:(0,n.css)({color:u.colors.success.main}),replace:(0,n.css)({color:u.colors.success.main}),move:(0,n.css)({color:u.colors.success.main}),copy:(0,n.css)({color:u.colors.success.main}),_get:(0,n.css)({color:u.colors.success.main}),test:(0,n.css)({color:u.colors.success.main}),remove:(0,n.css)({color:u.colors.success.main}),withoutDiff:(0,n.css)({marginBottom:u.spacing(1)})}),o=({diffs:u,title:p})=>{const f=(0,a.of)(m);return u.length===1?(0,t.jsx)("div",{className:f.container,"data-testid":"diffGroup",children:(0,t.jsx)(c,{title:p,diff:u[0]})}):(0,t.jsxs)("div",{className:f.container,"data-testid":"diffGroup",children:[(0,t.jsx)(c,{title:p}),(0,t.jsx)("ul",{className:f.list,children:u.map((y,x)=>(0,t.jsxs)("li",{className:f.listItem,children:[(0,t.jsx)("span",{children:(0,l.Fl)(y)})," ",(0,t.jsx)(g,{diff:y})]},`${(0,s.last)(y.path)}__${x}`))})]})},m=u=>({container:(0,n.css)({}),list:(0,n.css)({marginLeft:u.spacing(4)}),listItem:(0,n.css)({marginBottom:u.spacing(1),"&:last-child":{marginBottom:0}})})},22764:(G,R,e)=>{"use strict";e.d(R,{M:()=>i});var t=e(74848),n=e(32196),s=e(24773),a=e.n(s),r=e(84140),g=e(40845);const i=({oldValue:l,newValue:d,...c})=>{const h=(0,g.$j)(),o={variables:{dark:{diffViewerBackground:h.colors.background.canvas,diffViewerColor:h.colors.text.primary,addedBackground:(0,r.A)(h.v1.palette.greenShade).setAlpha(.3).toString(),addedColor:"white",removedBackground:(0,r.A)(h.v1.palette.redShade).setAlpha(.3).toString(),removedColor:"white",wordAddedBackground:(0,r.A)(h.v1.palette.greenBase).setAlpha(.4).toString(),wordRemovedBackground:(0,r.A)(h.v1.palette.redBase).setAlpha(.4).toString(),addedGutterBackground:(0,r.A)(h.v1.palette.greenShade).setAlpha(.2).toString(),removedGutterBackground:(0,r.A)(h.v1.palette.redShade).setAlpha(.2).toString(),gutterBackground:h.colors.background.primary,gutterBackgroundDark:h.colors.background.primary,highlightBackground:(0,r.A)(h.colors.primary.main).setAlpha(.4).toString(),highlightGutterBackground:(0,r.A)(h.colors.primary.shade).setAlpha(.2).toString(),codeFoldGutterBackground:h.colors.background.secondary,codeFoldBackground:h.colors.background.secondary,emptyLineBackground:h.colors.background.secondary,gutterColor:h.colors.text.disabled,addedGutterColor:h.colors.text.primary,removedGutterColor:h.colors.text.primary,codeFoldContentColor:h.colors.text.disabled,diffViewerTitleBackground:h.colors.background.secondary,diffViewerTitleColor:h.colors.text.disabled,diffViewerTitleBorderColor:h.colors.border.strong}},codeFold:{fontSize:h.typography.bodySmall.fontSize},gutter:{pre:{color:(0,r.A)(h.colors.text.disabled).setAlpha(1).toString(),opacity:.61}}};return(0,t.jsx)("div",{className:(0,n.css)({fontSize:h.typography.bodySmall.fontSize,pre:{all:"revert"}}),children:(0,t.jsx)(a(),{styles:o,oldValue:l,newValue:d,splitView:!1,compareMethod:s.DiffMethod.CSS,useDarkTheme:h.isDark,...c})})}},57714:(G,R,e)=>{"use strict";e.d(R,{Cc:()=>I,me:()=>v,bS:()=>u,rJ:()=>C,wL:()=>s});var t=e(17172);class n{getHistoryList(j,A){return typeof j!="string"?Promise.resolve([]):(0,t.AI)().get(`api/dashboards/uid/${j}/versions`,A)}getDashboardVersion(j,A){return typeof j!="string"?Promise.resolve({}):(0,t.AI)().get(`api/dashboards/uid/${j}/versions/${A}`)}restoreDashboard(j,A){if(typeof j!="string")return Promise.resolve({});const K=`api/dashboards/uid/${j}/restore`;return(0,t.AI)().post(K,{version:A})}}const s=new n;var a=e(74848),r=e(32196),g=e(40845),i=e(10880),l=e(78369),d=e(71678),c=e(55852),h=e(96374),o=e(3169);const m=({hideModal:B,onRestore:j,version:A})=>{const K=(0,o._2)(),W=async()=>{await j(A)?K.success("Dashboard restored",`Restored from version ${A.version}`):K.error("Dashboard restore failed",`Failed to restore from version ${A.version}`),B()};return(0,a.jsx)(h.u,{isOpen:!0,title:"Restore Version",icon:"history",onDismiss:B,onConfirm:W,body:(0,a.jsxs)("p",{children:["Are you sure you want to restore the dashboard to version ",A.version,"? All unsaved changes will be lost."]}),confirmText:`Yes, restore to version ${A.version}`})},u=({versions:B,canCompare:j,onCheck:A,onRestore:K})=>{const W=(0,g.of)(p);return(0,a.jsx)("div",{className:W.margin,children:(0,a.jsxs)("table",{className:"filter-table",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"width-4"}),(0,a.jsx)("th",{className:"width-4",children:"Version"}),(0,a.jsx)("th",{className:"width-14",children:"Date"}),(0,a.jsx)("th",{className:"width-10",children:"Updated by"}),(0,a.jsx)("th",{children:"Notes"}),(0,a.jsx)("th",{})]})}),(0,a.jsx)("tbody",{children:B.map((U,F)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:(0,a.jsx)(i.S,{"aria-label":`Toggle selection of version ${U.version}`,className:(0,r.css)({display:"inline"}),checked:U.checked,onChange:V=>A(V,U.id),disabled:!U.checked&&j})}),(0,a.jsx)("td",{children:U.version}),(0,a.jsx)("td",{children:U.createdDateString}),(0,a.jsx)("td",{children:U.createdBy}),(0,a.jsx)("td",{children:U.message}),(0,a.jsx)("td",{className:"text-right",children:F===0?(0,a.jsx)(l.v,{name:"Latest",colorIndex:17}):(0,a.jsx)(d.$s,{children:({showModal:V,hideModal:w})=>(0,a.jsx)(c.$n,{variant:"secondary",size:"sm",icon:"history",onClick:()=>{V(m,{version:U,hideModal:w,onRestore:K})},children:"Restore"})})})]},U.id))})]})})};function p(B){return{margin:(0,r.css)({marginBottom:B.spacing(4)})}}var f=e(2543),y=e(29158),x=e(14578);const v=({onClick:B=f.noop,baseVersion:j=0,newVersion:A=0,isNewLatest:K=!1})=>{const W=(0,g.of)(P);return(0,a.jsxs)("h3",{className:W.header,children:[(0,a.jsx)(y.K,{name:"arrow-left",size:"xl",onClick:B,tooltip:"Reset version"}),(0,a.jsxs)("span",{children:["Comparing ",j," ",(0,a.jsx)(x.I,{name:"arrows-h"})," ",A," ",K&&(0,a.jsx)("cite",{className:"muted",children:"(Latest)"})]})]})},P=B=>({header:(0,r.css)({fontSize:B.typography.h3.fontSize,display:"flex",gap:B.spacing(2),marginBottom:B.spacing(2)})});var E=e(67061),D=e(56034);const C=({hasMore:B,canCompare:j,getVersions:A,getDiff:K,isLastPage:W})=>(0,a.jsxs)(E.B,{children:[B&&(0,a.jsx)(c.$n,{type:"button",onClick:()=>A(!0),variant:"secondary",disabled:W,children:"Show more versions"}),(0,a.jsx)(D.m,{content:"Select two versions to start comparing",placement:"bottom",children:(0,a.jsx)(c.$n,{type:"button",disabled:!j,onClick:K,icon:"code-branch",children:"Compare versions"})})]});var b=e(90613),T=e(57418),S=e(19626),O=e(22764),M=e(56596);const I=({baseInfo:B,newInfo:j,diffData:A,isNewLatest:K,onRestore:W})=>{const U=(0,M.G4)(A.lhs,A.rhs),F=(0,g.of)(L);return(0,a.jsxs)(E.B,{direction:"column",gap:1,children:[(0,a.jsxs)(E.B,{justifyContent:"space-between",alignItems:"center",children:[(0,a.jsxs)(E.B,{alignItems:"center",children:[(0,a.jsxs)("span",{className:(0,r.cx)(F.versionInfo,F.noMarginBottom),children:[(0,a.jsxs)("strong",{children:["Version ",B.version]})," updated by ",B.createdBy," ",B.ageString,B.message]}),(0,a.jsx)(x.I,{name:"arrow-right",size:"sm"}),(0,a.jsxs)("span",{className:F.versionInfo,children:[(0,a.jsxs)("strong",{children:["Version ",j.version]})," updated by ",j.createdBy," ",j.ageString,j.message]})]}),K&&(0,a.jsx)(d.$s,{children:({showModal:V,hideModal:w})=>(0,a.jsxs)(c.$n,{variant:"destructive",icon:"history",onClick:()=>{V(m,{version:B,onRestore:W,hideModal:w})},children:["Restore to version ",B.version]})})]}),Object.entries(U).map(([V,w])=>(0,a.jsx)(S.D,{diffs:w,title:V},V)),(0,a.jsx)(b.a,{paddingTop:2,children:(0,a.jsx)(T.M,{isOpen:!1,label:"View JSON Diff",children:(0,a.jsx)(O.M,{oldValue:JSON.stringify(A.lhs,null,2),newValue:JSON.stringify(A.rhs,null,2)})})})]})},L=B=>({versionInfo:(0,r.css)({color:B.colors.text.secondary,fontSize:B.typography.bodySmall.fontSize}),noMarginBottom:(0,r.css)({marginBottom:0})})},56596:(G,R,e)=>{"use strict";e.d(R,{Fl:()=>g,G4:()=>r});var t=e(16111),n=e(25504),s=e(2543),a=e.n(s);const r=(d,c)=>{const h=(0,t.UD)(d,c),o=n.stringify(d,null,2),m=n.stringify(c,null,2),u=y=>y.map(x=>{let v,P,E=0,D=0;const C=(0,s.tail)(x.path.split("/"));return x.op==="replace"&&m.pointers[x.path]&&(v=(0,s.get)(d,C),P=x.value,E=m.pointers[x.path].value.line,D=m.pointers[x.path].valueEnd.line),x.op==="add"&&m.pointers[x.path]&&(P=x.value,E=m.pointers[x.path].value.line,D=m.pointers[x.path].valueEnd.line),x.op==="remove"&&o.pointers[x.path]&&(v=(0,s.get)(d,C),E=o.pointers[x.path].value.line,D=o.pointers[x.path].valueEnd.line),{op:x.op,value:P,path:C,originalValue:v,startLineNumber:E,endLineNumber:D}}),p=y=>(0,s.sortBy)(y,"startLineNumber"),f=y=>y.reduce((x,v)=>{const P=v.path[0];return x[P]||(x[P]=[]),x[P].push(v),x},{});return(0,s.flow)([u,p,f])(h)},g=(d,c=!0)=>{const h=(0,s.last)(d.path),o=i(h),m=d.op==="remove"?d.originalValue:d.value;let u=l(d.op);return c&&(o?u+=` item ${h}`:(0,s.isArray)(m)&&!(0,s.isEmpty)(m)?u+=` ${m.length} ${h}`:u+=` ${h}`),u},i=d=>!(0,s.isNaN)((0,s.toNumber)(d)),l=d=>d==="add"?"added":d==="remove"?"deleted":"changed"},30040:(G,R,e)=>{"use strict";e.d(R,{A:()=>o,i:()=>h});var t=e(74848),n=e(96540),s=e(13544),a=e(39601),r=e(38138),g=e(8484),i=e(22699),l=e(7758);const d=s.Tp.pages.Dashboard.DashNav.NewExportButton.Menu,c=[];function h(m){c.push(m)}function o({dashboard:m}){const u=y=>{a.Ny.partial({shareView:y})},p=(0,n.useCallback)(()=>{const y=[];return c.forEach(x=>y.push(x)),y.push({shareId:i.wr.export,testId:d.exportAsJson,icon:"arrow",label:(0,g.t)("share-dashboard.menu.export-json-title","Export as JSON"),renderCondition:!0,onClick:()=>u(i.wr.export)}),y.filter(x=>x.renderCondition)},[]),f=y=>{l.c.sharingCategoryClicked({item:y.shareId,shareResource:(0,i.hD)()}),y.onClick(m)};return(0,t.jsx)(r.W,{"data-testid":d.container,children:p().map(y=>(0,t.jsx)(r.W.Item,{testId:y.testId,label:y.label,icon:y.icon,description:y.description,onClick:()=>f(y)},y.label))})}},66714:(G,R,e)=>{"use strict";e.d(R,{Ay:()=>f,Hl:()=>u});var t=e(74848),n=e(96540),s=e(13544),a=e(39601),r=e(32264),g=e(38138),i=e(10096),l=e(8484),d=e(72254),c=e(22699),h=e(7758);const o=s.Tp.pages.Dashboard.DashNav.newShareButton.menu;let m=[];function u(y){m.push(y)}function p(){m=[]}function f({dashboard:y,panel:x}){const v=D=>{a.Ny.partial({shareView:D})},P=(0,n.useCallback)(()=>{const D=[];return D.push({shareId:c.wr.link,testId:o.shareInternally,icon:"building",label:(0,l.t)("share-dashboard.menu.share-internally-title","Share internally"),renderCondition:!0,onClick:()=>v(c.wr.link)}),D.push({shareId:c.wr.publicDashboard,testId:o.shareExternally,icon:"share-alt",label:(0,l.t)("share-dashboard.menu.share-externally-title","Share externally"),renderCondition:!x&&(0,d.iR)(),onClick:()=>{v(c.wr.publicDashboard)}}),m.forEach(C=>D.push(C)),D.push({shareId:c.wr.snapshot,testId:o.shareSnapshot,icon:"camera",label:(0,l.t)("share-dashboard.menu.share-snapshot-title","Share snapshot"),renderCondition:i.TP.isSignedIn&&r.$.snapshotEnabled&&y.canEditDashboard(),onClick:()=>{v(c.wr.snapshot)}}),D.filter(C=>C.renderCondition)},[x,y]),E=D=>{h.c.sharingCategoryClicked({item:D.shareId,shareResource:(0,c.hD)(x?.getRef())}),D.onClick(y)};return(0,t.jsx)(g.W,{"data-testid":o.container,children:P().map(D=>(0,t.jsx)(g.W.Item,{testId:D.testId,label:D.label,icon:D.icon,description:D.description,onClick:()=>E(D)},D.shareId))})}},70439:(G,R,e)=>{"use strict";e.d(R,{F7:()=>d,Xe:()=>g,yk:()=>l});var t=e(7030),n=e(22699),s=e(33390),a=e(7758);const r={useAbsoluteTimeRange:!0,useShortUrl:!0,theme:"current"},g=async(c,h)=>{const{useAbsoluteTimeRange:o,useShortUrl:m,theme:u}=l();return a.c.shareLinkCopied({currentTimeRange:o,theme:u,shortenURL:m,shareResource:(0,n.hD)(h?.getRef())}),await(0,t.Sp)(c,{useAbsoluteTimeRange:o,theme:u,useShortUrl:m})},i="grafana.dashboard.link.shareConfiguration";function l(){return s.A.exists(i)&&s.A.getObject(i)||r}function d(c){s.A.setObject(i,c)}},97246:(G,R,e)=>{"use strict";e.d(R,{j:()=>yn,K:()=>fn});var t=e(74848),n=e(39601),s=e(84537),a=e(87978),r=e(22699),g=e(74730),i=e(32196),l=e(16817),d=e(70713),c=e(13544),h=e(40845),o=e(67061),m=e(15292),u=e(60029),p=e(32372),f=e(62930),y=e(55852),x=e(10534),v=e(82467),P=e(3169),E=e(8484),D=e(99140),C=e(50056);const b=c.Tp.pages.ExportDashboardDrawer.ExportAsJson;class T extends C.N{static{this.Component=S}getTabLabel(){return(0,E.t)("export.json.title","Export dashboard JSON")}}function S({model:Ut}){const nn=(0,h.of)(O),{isSharingExternally:hn}=Ut.useState(),dn=(0,l.A)(async()=>{const Pt=await Ut.getExportableDashboardJson();return JSON.stringify(Pt,null,2)},[hn]),Sn=async()=>{await Ut.onSaveAsFile();const Pt=(0,E.t)("export.json.download-successful_toast_message","Your JSON has been downloaded");(0,D.JD)((0,v.dx)((0,P.tZ)(Pt)))},es=(0,E.t)("export.json.export-externally-label","Export the dashboard to use in another instance");return(0,t.jsxs)("div",{"data-testid":b.container,className:nn.container,children:[(0,t.jsx)("p",{children:(0,t.jsx)(E.x6,{i18nKey:"export.json.info-text",children:"Copy or download a JSON file containing the JSON of your dashboard"})}),(0,t.jsxs)(o.B,{gap:1,alignItems:"center",children:[(0,t.jsx)(m.d,{label:es,"data-testid":b.exportExternallyToggle,id:"export-externally-toggle",value:hn,onChange:Ut.onShareExternallyChange}),(0,t.jsx)(u.J,{children:es})]}),(0,t.jsx)("div",{className:nn.codeEditorBox,children:(0,t.jsx)(d.Ay,{"data-testid":b.codeEditor,children:({width:Pt,height:Ze})=>dn.value?(0,t.jsx)(p.B,{value:dn.value,language:"json",showMiniMap:!1,height:Ze,width:Pt,readOnly:!0}):dn.loading&&(0,t.jsx)(f.y,{})})}),(0,t.jsx)("div",{className:nn.buttonsContainer,children:(0,t.jsxs)(o.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,t.jsx)(y.$n,{"data-testid":b.saveToFileButton,variant:"primary",icon:"download-alt",onClick:Sn,children:(0,t.jsx)(E.x6,{i18nKey:"export.json.download-button",children:"Download file"})}),(0,t.jsx)(x.b,{"data-testid":b.copyToClipboardButton,variant:"secondary",icon:"copy",disabled:dn.loading,getText:()=>dn.value??"",children:(0,t.jsx)(E.x6,{i18nKey:"export.json.copy-button",children:"Copy to clipboard"})}),(0,t.jsx)(y.$n,{"data-testid":b.cancelButton,variant:"secondary",onClick:Ut.useState().onDismiss,fill:"outline",children:(0,t.jsx)(E.x6,{i18nKey:"export.json.cancel-button",children:"Cancel"})})]})})]})}function O(Ut){return{container:(0,i.css)({height:"100%"}),codeEditorBox:(0,i.css)({margin:`${Ut.spacing(2,0)}`,height:"75%"}),buttonsContainer:(0,i.css)({paddingBottom:Ut.spacing(2)})}}var M=e(96540),I=e(25994),L=e(10096),B=e(72686),j=e(4785),A=e(72254),K=e(7758),W=e(31678),U=e(94753),F=e(29158),V=e(45014);function w({onConfirm:Ut,onDismiss:nn,description:hn,confirmButtonLabel:dn,title:Sn,isActionLoading:es}){const Pt=(0,h.of)(z),Ze=()=>(0,t.jsx)("div",{className:Pt.bodyContainer,children:(0,t.jsxs)(o.B,{justifyContent:"space-between",children:[(0,t.jsxs)(o.B,{gap:1,alignItems:"center",children:[(0,t.jsx)(F.K,{size:"xl",name:"angle-left","aria-label":(0,E.t)("share-drawer.confirm-action.back-arrow-button","Back button"),onClick:nn}),(0,t.jsx)(U.E,{variant:"h4",children:Sn})]}),es&&(0,t.jsx)(f.y,{})]})});return(0,t.jsx)(V.k,{body:(0,t.jsx)(Ze,{}),description:hn,confirmButtonLabel:dn,confirmButtonVariant:"destructive",dismissButtonLabel:(0,E.t)("share-drawer.confirm-action.cancel-button","Cancel"),dismissButtonVariant:"secondary",justifyButtons:"flex-start",onConfirm:Ut,onDismiss:nn})}const z=Ut=>({bodyContainer:(0,i.css)({marginBottom:Ut.spacing(2)})}),N=(0,M.createContext)(void 0),H=()=>{const Ut=(0,M.useContext)(N);if(Ut===void 0)throw new Error("useShareDrawerContext must be used within a DrawerContext");return Ut};var Q=e(49785),X=e(84167),ee=e(88575),Z=e(56034),q=e(14578),ae=e(10354),k=e(3799);const se=c.Tp.pages.ShareDashboardDrawer.ShareExternally.Configuration;function te(){const Ut=(0,h.of)(ne),{dashboard:nn}=H(),[hn,{isLoading:dn}]=(0,B.T2)(),{data:Sn}=B.Sm.endpoints?.getPublicDashboard.useQueryState(nn.state.uid),es=L.TP.hasPermission(W.AccessControlAction.DashboardsPublicWrite),Pt=dn||!es,lt=s.jh.getTimeRange(nn).useState(),{handleSubmit:yt,setValue:Nt,control:wt}=(0,Q.mN)({defaultValues:{isAnnotationsEnabled:Sn?.annotationsEnabled,isTimeSelectionEnabled:Sn?.timeSelectionEnabled}}),Zt=async(On,An)=>{Nt(On,An),await yt(qn=>pn({...qn,[On]:An}))()},pn=On=>{const{isAnnotationsEnabled:An,isTimeSelectionEnabled:qn}=On;hn({dashboard:nn,payload:{...Sn,annotationsEnabled:An,timeSelectionEnabled:qn}})};return(0,t.jsxs)(o.B,{direction:"column",gap:2,children:[(0,t.jsx)(U.E,{element:"p",children:(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.configuration.settings-label",children:"Settings"})}),(0,t.jsxs)(o.B,{justifyContent:"space-between",children:[(0,t.jsx)("form",{onSubmit:yt(pn),children:(0,t.jsx)(X.n,{disabled:Pt,children:(0,t.jsxs)(o.B,{direction:"column",gap:2,children:[(0,t.jsxs)(o.B,{gap:1,children:[(0,t.jsx)(Q.xI,{render:({field:{ref:On,...An}})=>(0,t.jsx)(m.d,{...An,"data-testid":se.enableTimeRangeSwitch,onChange:qn=>{K.c.publicDashboardTimeSelectionChanged({enabled:qn.currentTarget.checked}),Zt("isTimeSelectionEnabled",qn.currentTarget.checked)},label:(0,E.t)("public-dashboard.configuration.enable-time-range-label","Enable time range")}),control:wt,name:"isTimeSelectionEnabled"}),(0,t.jsx)(u.J,{description:(0,E.t)("public-dashboard.configuration.enable-time-range-description","Allow people to change time range"),children:(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.configuration.enable-time-range-label",children:"Enable time range"})})]}),(0,t.jsxs)(o.B,{gap:1,children:[(0,t.jsx)(Q.xI,{render:({field:{ref:On,...An}})=>(0,t.jsx)(m.d,{...An,"data-testid":se.enableAnnotationsSwitch,onChange:qn=>{K.c.publicDashboardAnnotationsSelectionChanged({enabled:qn.currentTarget.checked}),Zt("isAnnotationsEnabled",qn.currentTarget.checked)},label:(0,E.t)("public-dashboard.configuration.display-annotations-label","Display annotations")}),control:wt,name:"isAnnotationsEnabled"}),(0,t.jsx)(u.J,{style:{flex:1},description:(0,E.t)("public-dashboard.configuration.display-annotations-description","Present annotations on this dashboard"),children:(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.configuration.display-annotations-label",children:"Display annotations"})})]}),(0,t.jsxs)(o.B,{gap:1,alignItems:"flex-start",children:[(0,t.jsx)("div",{className:Ut.timeRange,children:(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.configuration.time-range-label",children:"Time range"})}),(0,t.jsx)("div",{className:(0,i.cx)(Ut.timeRange,Ut.timeRangeValue),children:(0,t.jsx)(k.f,{value:lt.value})}),(0,t.jsx)(Z.m,{placement:"right",content:(0,E.t)("public-dashboard.configuration.time-range-tooltip","The shared dashboard uses the default time range settings of the dashboard"),children:(0,t.jsx)(q.I,{name:"info-circle",size:"md"})})]})]})})}),dn&&(0,t.jsx)(f.y,{})]})]})}const ne=Ut=>({timeRange:(0,i.css)({fontSize:Ut.typography.bodySmall.fontSize,fontWeight:Ut.typography.bodySmall.fontWeight}),timeRangeValue:(0,i.css)({color:Ut.colors.text.secondary})});var le=e(38138),re=e(83122);const de=c.Tp.pages.ShareDashboardModal.PublicDashboard.EmailSharingConfiguration,oe=({onDelete:Ut,onReshare:nn})=>(0,t.jsxs)(le.W,{children:[(0,t.jsx)(le.W.Item,{label:(0,E.t)("public-dashboard.email-sharing.resend-invite-label","Resend invite"),onClick:nn}),(0,t.jsx)(le.W.Item,{label:(0,E.t)("public-dashboard.email-sharing.revoke-access-label","Revoke access"),destructive:!0,onClick:Ut})]}),J=({recipients:Ut,dashboardUid:nn,publicDashboard:hn})=>{const dn=(0,h.of)(pe),[Sn,{isLoading:es}]=(0,B.$L)(),[Pt,{isLoading:Ze}]=(0,B.NA)(),lt=es||Ze,yt=(wt,Zt)=>{K.c.revokePublicDashboardEmailClicked(),Sn({recipientUid:wt,recipientEmail:Zt,dashboardUid:nn,uid:hn.uid})},Nt=wt=>{K.c.resendPublicDashboardEmailClicked(),Pt({recipientUid:wt,uid:hn.uid})};return(0,t.jsx)("table",{"data-testid":de.EmailSharingList,className:dn.table,children:(0,t.jsx)("tbody",{children:Ut.map((wt,Zt)=>(0,t.jsxs)("tr",{className:dn.listItem,children:[(0,t.jsx)("td",{className:dn.user,children:(0,t.jsxs)(o.B,{direction:"row",gap:1,alignItems:"center",children:[(0,t.jsx)("div",{className:dn.icon,children:(0,t.jsx)(q.I,{name:"user"})}),(0,t.jsx)(U.E,{children:wt.recipient})]})}),(0,t.jsx)("td",{children:lt&&(0,t.jsx)(f.y,{})}),(0,t.jsx)("td",{children:(0,t.jsx)(re.m,{overlay:(0,t.jsx)(oe,{onDelete:()=>yt(wt.uid,wt.recipient),onReshare:()=>Nt(wt.uid)}),children:(0,t.jsx)(F.K,{name:"ellipsis-v","aria-label":"email-menu",variant:"secondary",size:"lg"})})})]},wt.uid))})})},ce=({dashboard:Ut})=>{const nn=(0,h.of)(pe),{data:hn}=B.Sm.endpoints?.getPublicDashboard.useQueryState(Ut.state.uid);return(0,t.jsx)(ee.D,{label:(0,E.t)("public-dashboard.email-sharing.recipient-list-title","People with access"),description:(0,E.t)("public-dashboard.email-sharing.recipient-list-description","Only people you've directly invited can access this dashboard"),className:nn.listField,children:hn?.recipients?.length?(0,t.jsx)("div",{className:nn.listContainer,children:(0,t.jsx)(J,{recipients:hn.recipients,dashboardUid:Ut.state.uid,publicDashboard:hn})}):(0,t.jsx)(t.Fragment,{})})},pe=Ut=>({listField:(0,i.css)({marginBottom:0}),listContainer:(0,i.css)({maxHeight:"140px",overflowY:"auto"}),table:(0,i.css)({width:"100%"}),listItem:(0,i.css)({display:"flex",alignItems:"center",gap:Ut.spacing(.5),padding:Ut.spacing(.75,1),color:Ut.colors.text.secondary}),user:(0,i.css)({flex:1}),icon:(0,i.css)({border:`${Ut.spacing(.25)} solid ${Ut.colors.text.secondary}`,padding:Ut.spacing(.125,.5),borderRadius:Ut.shape.radius.circle,color:Ut.colors.text.secondary})}),xe=c.Tp.pages.ShareDashboardModal.PublicDashboard.EmailSharingConfiguration,fe=()=>{const{dashboard:Ut}=H(),{data:nn,isError:hn}=B.Sm.endpoints?.getPublicDashboard.useQueryState(Ut.state.uid),[dn,{isLoading:Sn}]=(0,B.NY)(),es=L.TP.hasPermission(W.AccessControlAction.DashboardsPublicWrite),{register:Pt,handleSubmit:Ze,formState:{errors:lt,isValid:yt},reset:Nt}=(0,Q.mN)({defaultValues:{email:""},mode:"onSubmit"}),wt=async Zt=>{K.c.publicDashboardEmailInviteClicked(),await dn({recipient:Zt.email,uid:nn.uid,dashboardUid:Ut.state.uid}).unwrap(),Nt({email:""})};return(0,t.jsxs)("div",{children:[(0,t.jsx)("form",{onSubmit:Ze(wt),children:(0,t.jsx)(X.n,{disabled:!es||hn,children:(0,t.jsx)(ee.D,{label:(0,t.jsxs)(o.B,{gap:1,alignItems:"center",children:[(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.email-sharing.recipient-invitation-button",children:"Invite"}),(0,t.jsx)(Z.m,{placement:"right",content:(0,E.t)("public-dashboard.email-sharing.recipient-invitation-tooltip","This dashboard contains sensitive data. By using this feature you will be sharing with external people."),children:(0,t.jsx)(q.I,{name:"info-circle",size:"sm"})})]}),description:(0,E.t)("public-dashboard.email-sharing.recipient-invitation-description","Invite someone by email"),error:lt.email?.message,invalid:!!lt.email?.message,children:(0,t.jsxs)(o.B,{direction:"row",children:[(0,t.jsx)(ae.p,{placeholder:(0,E.t)("public-dashboard.email-sharing.recipient-email-placeholder","Email"),autoCapitalize:"none",loading:Sn,...Pt("email",{required:(0,E.t)("public-dashboard.email-sharing.recipient-required-email-text","Email is required"),pattern:{value:A._l,message:(0,E.t)("public-dashboard.email-sharing.recipient-invalid-email-text","Invalid email")}}),"data-testid":xe.EmailSharingInput}),(0,t.jsx)(y.$n,{type:"submit",variant:"primary",disabled:Sn||!yt,"data-testid":xe.EmailSharingInviteButton,children:(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.email-sharing.recipient-invitation-button",children:"Invite"})})]})})})}),(0,t.jsx)(ce,{dashboard:Ut}),(0,t.jsx)(I.c,{}),(0,t.jsx)(te,{})]})};var Ee=e(10880),Se=e(42418);const ye="https://grafana.com/docs/grafana/next/dashboards/share-dashboards-panels/shared-dashboards/#share-externally-with-specific-people",Ve=c.Tp.pages.ShareDashboardDrawer.ShareExternally;function Me(){return(0,t.jsx)(Se.F,{title:"",severity:"info",bottomSpacing:0,"data-testid":Ve.emailSharingAlert,children:(0,t.jsxs)(o.B,{justifyContent:"space-between",gap:2,alignItems:"center",children:[(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.email-sharing.alert-text",children:"Sharing dashboards by email is billed per user for the duration of the 30-day token, regardless of how many dashboards are shared. Billing stops after 30 days unless you renew the token."}),(0,t.jsx)(y.$n,{variant:"secondary",onClick:()=>window.open(ye,"_blank"),type:"button",children:(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.email-sharing.learn-more-button",children:"Learn more"})})]})})}const Ce=c.Tp.pages.ShareDashboardDrawer.ShareExternally.Creation,Ue=({hasError:Ut})=>{const{dashboard:nn,onDismiss:hn}=H(),dn=(0,h.of)(Ae),[Sn,{isLoading:es,isError:Pt}]=(0,B.U9)(),Ze=L.TP.hasPermission(W.AccessControlAction.DashboardsPublicWrite),lt=!Ze||es||Pt||Ut,{handleSubmit:yt,register:Nt,formState:{isValid:wt}}=(0,Q.mN)({mode:"onChange"}),Zt=()=>{K.c.generatePublicDashboardUrlClicked({share:A.Xo.EMAIL}),Sn({dashboard:nn,payload:{share:A.Xo.EMAIL,isEnabled:!0}})};return(0,t.jsxs)(t.Fragment,{children:[Ze&&(0,t.jsx)(Me,{}),(0,t.jsx)("form",{onSubmit:yt(Zt),children:(0,t.jsxs)(X.n,{disabled:lt,children:[(0,t.jsx)("div",{className:dn.checkbox,children:(0,t.jsx)(Ee.S,{...Nt("billAcknowledgment",{required:!0}),label:(0,E.t)("public-dashboard.email-sharing.bill-ack","I understand that adding users requires payment.*")})}),(0,t.jsxs)(o.B,{direction:"row",gap:1,alignItems:"center",children:[(0,t.jsx)(y.$n,{type:"submit",disabled:!wt,"data-testid":Ce.EmailShare.createButton,children:(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.email-sharing.accept-button",children:"Accept"})}),(0,t.jsx)(y.$n,{variant:"secondary",onClick:hn,"data-testid":Ce.EmailShare.cancelButton,children:(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.email-sharing.cancel-button",children:"Cancel"})}),es&&(0,t.jsx)(f.y,{})]})]})})]})},Ae=Ut=>({checkbox:(0,i.css)({marginBottom:Ut.spacing(2)})}),we=()=>{const{dashboard:Ut}=H(),{data:nn,isError:hn}=B.Sm.endpoints?.getPublicDashboard.useQueryState(Ut.state.uid);return(0,t.jsx)(t.Fragment,{children:nn?(0,t.jsx)(fe,{}):(0,t.jsx)(Ue,{hasError:hn})})},We="https://grafana.com/docs/grafana/next/dashboards/share-dashboards-panels/shared-dashboards",_e=c.Tp.pages.ShareDashboardDrawer.ShareExternally,at=()=>(0,t.jsx)(Se.F,{title:"",severity:"info",bottomSpacing:0,"data-testid":_e.publicAlert,children:(0,t.jsxs)(o.B,{justifyContent:"space-between",gap:2,alignItems:"center",children:[(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.public-sharing.alert-text",children:"Sharing this dashboard externally makes it entirely accessible to anyone with the link."}),(0,t.jsx)(y.$n,{variant:"secondary",onClick:()=>window.open(We,"_blank"),type:"button",children:(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.public-sharing.learn-more-button",children:"Learn more"})})]})}),ut=c.Tp.pages.ShareDashboardDrawer.ShareExternally.Creation;function Tt({hasError:Ut}){const{dashboard:nn,onDismiss:hn}=H(),dn=(0,h.of)(It),Sn=L.TP.hasPermission(W.AccessControlAction.DashboardsPublicWrite),{handleSubmit:es,register:Pt,formState:{isValid:Ze}}=(0,Q.mN)({mode:"onChange"}),[lt,{isLoading:yt,isError:Nt}]=(0,B.U9)(),wt=()=>{K.c.generatePublicDashboardUrlClicked({share:A.Xo.PUBLIC}),lt({dashboard:nn,payload:{share:A.Xo.PUBLIC,isEnabled:!0}})},Zt=!Sn||yt||Nt||Ut;return(0,t.jsxs)(t.Fragment,{children:[Sn&&(0,t.jsx)(at,{}),(0,t.jsx)("form",{onSubmit:es(wt),children:(0,t.jsxs)(X.n,{disabled:Zt,children:[(0,t.jsx)("div",{className:dn.checkbox,children:(0,t.jsx)(Ee.S,{...Pt("publicAcknowledgment",{required:!0}),label:(0,E.t)("public-dashboard.public-sharing.public-ack","I understand that this entire dashboard will be public.*"),"data-testid":ut.willBePublicCheckbox})}),(0,t.jsxs)(o.B,{direction:"row",gap:1,alignItems:"center",children:[(0,t.jsx)(y.$n,{type:"submit",disabled:!Ze,"data-testid":ut.PublicShare.createButton,children:(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.public-sharing.accept-button",children:"Accept"})}),(0,t.jsx)(y.$n,{variant:"secondary",onClick:hn,"data-testid":ut.PublicShare.cancelButton,children:(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.public-sharing.cancel-button",children:"Cancel"})}),yt&&(0,t.jsx)(f.y,{})]})]})})]})}const It=Ut=>({checkbox:(0,i.css)({marginBottom:Ut.spacing(2)})});function ge(){const{dashboard:Ut}=H(),{data:nn,isError:hn}=B.Sm.endpoints?.getPublicDashboard.useQueryState(Ut.state.uid);return(0,t.jsx)(t.Fragment,{children:nn?(0,t.jsx)(te,{}):(0,t.jsx)(Tt,{hasError:hn})})}var Ie=e(12257),ue=e(10872),me=e(6923),Pe=e(59995);function Ne({publicDashboard:Ut}){const{dashboard:nn}=H(),hn=L.TP.hasPermission(W.AccessControlAction.DashboardsPublicWrite),dn=(0,Pe.b)(nn),Sn=(nn.state.$variables?.state.variables.length??0)>0;return(0,t.jsxs)(t.Fragment,{children:[hn&&Sn&&(0,t.jsx)(ue.D,{showDescription:!1}),!hn&&(0,t.jsx)(me.t,{mode:Ut?"edit":"create"}),hn&&!!dn?.length&&(0,t.jsx)(Ie.s,{unsupportedDataSources:dn.join(", ")}),Ut?.share===A.Xo.EMAIL&&(0,A.AY)()&&(0,t.jsx)(Me,{}),Ut?.share===A.Xo.PUBLIC&&(0,t.jsx)(at,{})]})}var Fe=e(8887),Be=e(90182);const he=()=>({label:(0,E.t)("public-dashboard.share-externally.public-share-type-option-label","Anyone with the link"),description:(0,E.t)("public-dashboard.share-externally.public-share-type-option-description","Anyone with the link can access dashboard"),value:A.Xo.PUBLIC,icon:"globe"}),be=()=>({label:(0,E.t)("public-dashboard.share-externally.email-share-type-option-label","Only specific people"),description:(0,E.t)("public-dashboard.share-externally.email-share-type-option-description","Only people with the link can access dashboard"),value:A.Xo.EMAIL,icon:"users-alt"}),Ke=c.Tp.pages.ShareDashboardDrawer.ShareExternally;function ze({setShareType:Ut,options:nn,value:hn}){const{dashboard:dn}=H(),Sn=(0,h.of)(nt),{data:es}=B.Sm.endpoints?.getPublicDashboard.useQueryState(dn.state.uid),[Pt,{isLoading:Ze}]=(0,B.ft)(),lt=L.TP.hasPermission(W.AccessControlAction.DashboardsPublicWrite),yt=he(),Nt=wt=>{if(!es)return;K.c.publicDashboardShareTypeChange({shareType:wt===A.Xo.EMAIL?"email":"public"});const Zt={dashboard:dn,payload:{...es,share:wt}};Pt(Zt)};return(0,t.jsxs)("div",{children:[(0,t.jsxs)(o.B,{justifyContent:"space-between",children:[(0,t.jsx)(u.J,{description:hn.description,children:(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.share-configuration.share-type-label",children:"Link access"})}),Ze&&(0,t.jsx)(f.y,{})]}),(0,A.AY)()?(0,t.jsx)(Be.l6,{"data-testid":Ke.shareTypeSelect,options:nn,value:hn,disabled:!lt,onChange:wt=>{Ut(wt),Nt(wt.value)},className:Sn.select}):(0,t.jsxs)(o.B,{gap:1,alignItems:"center",children:[(0,Fe.Uo)(yt.icon)&&(0,t.jsx)(q.I,{name:(0,Fe.Uo)(yt.icon)}),(0,t.jsx)(U.E,{children:yt.label})]})]})}const nt=()=>({select:(0,i.css)({flex:1})}),tt=c.Tp.pages.ShareDashboardDrawer.ShareExternally,ot=()=>(0,A.AY)()?[be(),he()]:[he()];class gt extends s.Bs{static{this.Component=He}getTabLabel(){return(0,E.t)("share-dashboard.menu.share-externally-title","Share externally")}}function He({model:Ut}){const[nn,hn]=(0,M.useState)(!1),dn=(0,h.of)(ht),Sn=(0,g.YQ)(Ut),{data:es,isLoading:Pt}=(0,B.Bs)(Sn.state.uid),[Ze,{isLoading:lt}]=(0,B.bN)(),yt=()=>{hn(!0)},Nt=async()=>{K.c.revokePublicDashboardClicked(),await Ze({dashboard:Sn,uid:es.uid,dashboardUid:Sn.state.uid}).unwrap(),hn(!1)};return Pt?(0,t.jsx)(j.a,{}):nn?(0,t.jsx)(w,{title:(0,E.t)("public-dashboard.share-externally.revoke-access-button","Revoke access"),confirmButtonLabel:(0,E.t)("public-dashboard.share-externally.revoke-access-button","Revoke access"),onConfirm:Nt,onDismiss:()=>hn(!1),description:(0,E.t)("public-dashboard.share-externally.revoke-access-description","Are you sure you want to revoke this access? The dashboard can no longer be shared."),isActionLoading:lt}):(0,t.jsx)("div",{className:dn.container,children:(0,t.jsx)(et,{publicDashboard:es,onRevokeClick:yt})})}function et({publicDashboard:Ut,onRevokeClick:nn}){const hn=ot(),dn=(0,M.useMemo)(()=>Ut&&(0,A.AY)()?hn.find(lt=>lt.value===Ut?.share)??hn[0]:hn[0],[Ut,hn]),[Sn,es]=(0,M.useState)(dn),Pt=(0,M.useMemo)(()=>Sn.value===A.Xo.EMAIL&&(0,A.AY)()?(0,t.jsx)(we,{}):(0,t.jsx)(ge,{}),[Sn]);return(0,t.jsxs)(o.B,{direction:"column",gap:2,"data-testid":tt.container,children:[(0,t.jsx)(Ne,{publicDashboard:Ut}),(0,t.jsx)(ze,{setShareType:es,value:Sn,options:hn}),Pt,Ut&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(I.c,{spacing:0}),(0,t.jsx)(rt,{publicDashboard:Ut,onRevokeClick:nn})]})]})}function rt({publicDashboard:Ut,onRevokeClick:nn}){const{dashboard:hn}=H(),[dn,{isLoading:Sn}]=(0,B.eq)(),es=(0,h.of)(ht),Pt=L.TP.hasPermission(W.AccessControlAction.DashboardsPublicWrite);function Ze(){K.c.publicDashboardUrlCopied()}const lt=async()=>{K.c.publicDashboardPauseSharingClicked({paused:!Ut.isEnabled}),dn({dashboard:hn,payload:{...Ut,isEnabled:!Ut.isEnabled}})};return(0,t.jsxs)(o.B,{alignItems:"center",direction:{xs:"column",sm:"row"},children:[(0,t.jsx)("div",{className:es.actionsContainer,children:(0,t.jsxs)(o.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,t.jsx)(x.b,{"data-testid":tt.Configuration.copyUrlButton,variant:"primary",fill:"outline",icon:"link",getText:()=>(0,A.mL)(Ut.accessToken),onClipboardCopy:Ze,children:(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.share-externally.copy-link-button",children:"Copy external link"})}),(0,t.jsx)(y.$n,{icon:"trash-alt",variant:"destructive",fill:"outline",disabled:Sn||!Pt,onClick:nn,"data-testid":tt.Configuration.revokeAccessButton,children:(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.share-externally.revoke-access-button",children:"Revoke access"})}),(0,t.jsx)(y.$n,{icon:Ut.isEnabled?"pause":"play",variant:"secondary",fill:"outline",tooltip:Ut.isEnabled?(0,E.t)("public-dashboard.share-externally.pause-access-tooltip","Pausing will temporarily disable access to this dashboard for all users"):"",onClick:lt,disabled:Sn||!Pt,"data-testid":tt.Configuration.toggleAccessButton,children:Ut.isEnabled?(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.share-externally.pause-access-button",children:"Pause access"}):(0,t.jsx)(E.x6,{i18nKey:"public-dashboard.share-externally.resume-access-button",children:"Resume access"})})]})}),Sn&&(0,t.jsx)(f.y,{})]})}const ht=Ut=>({container:(0,i.css)({paddingBottom:Ut.spacing(2)}),actionsContainer:(0,i.css)({width:"100%"})});var ft=e(87895);const De=c.Tp.pages.ShareDashboardDrawer.ShareInternally;function Te({useLockedTime:Ut,onToggleLockedTime:nn,useShortUrl:hn,onUrlShorten:dn,onChangeTheme:Sn,selectedTheme:es,isLoading:Pt}){return(0,t.jsxs)(o.B,{justifyContent:"space-between",children:[(0,t.jsxs)(o.B,{gap:2,direction:"column",children:[(0,t.jsxs)(o.B,{gap:1,direction:"column",children:[(0,t.jsxs)(o.B,{gap:1,alignItems:"start",children:[(0,t.jsx)(m.d,{label:(0,E.t)("link.share.time-range-label","Lock time range"),id:"share-current-time-range",value:Ut,onChange:nn,"data-testid":De.lockTimeRangeSwitch}),(0,t.jsx)(u.J,{description:(0,E.t)("link.share.time-range-description","Change the current relative time range to an absolute time range"),children:(0,t.jsx)(E.x6,{i18nKey:"link.share.time-range-label",children:"Lock time range"})})]}),(0,t.jsxs)(o.B,{gap:1,alignItems:"start",children:[(0,t.jsx)(m.d,{id:"share-short-url",value:hn,label:(0,E.t)("link.share.short-url-label","Shorten link"),onChange:dn,"data-testid":De.shortenUrlSwitch}),(0,t.jsx)(u.J,{children:(0,t.jsx)(E.x6,{i18nKey:"link.share.short-url-label",children:"Shorten link"})})]})]}),(0,t.jsx)(ft.w,{selectedTheme:es,onChange:Sn})]}),Pt&&(0,t.jsx)(f.y,{})]})}var Oe=e(58398),Ye=e(70439);const Ge=c.Tp.pages.ShareDashboardDrawer.ShareInternally;class Je extends Oe.R{static{this.Component=it}constructor(nn){const{useAbsoluteTimeRange:hn,useShortUrl:dn,theme:Sn}=(0,Ye.yk)();super({...nn,useLockedTime:hn,useShortUrl:dn,selectedTheme:Sn}),this.onToggleLockedTime=this.onToggleLockedTime.bind(this),this.onUrlShorten=this.onUrlShorten.bind(this),this.onThemeChange=this.onThemeChange.bind(this)}getTabLabel(){return(0,E.t)("share-dashboard.menu.share-internally-title","Share internally")}async onToggleLockedTime(){const nn=!this.state.useLockedTime;(0,Ye.F7)({useAbsoluteTimeRange:nn,useShortUrl:this.state.useShortUrl,theme:this.state.selectedTheme}),await super.onToggleLockedTime()}async onUrlShorten(){const nn=!this.state.useShortUrl;(0,Ye.F7)({useShortUrl:nn,useAbsoluteTimeRange:this.state.useLockedTime,theme:this.state.selectedTheme}),await super.onUrlShorten()}async onThemeChange(nn){(0,Ye.F7)({theme:nn,useShortUrl:this.state.useShortUrl,useAbsoluteTimeRange:this.state.useLockedTime}),await super.onThemeChange(nn)}}function it({model:Ut}){const nn=(0,h.of)(St),{useLockedTime:hn,useShortUrl:dn,selectedTheme:Sn,isBuildUrlLoading:es}=Ut.useState();return(0,t.jsxs)("div",{className:Ge.container,children:[(0,t.jsx)(Se.F,{severity:"info",title:(0,E.t)("link.share.config-alert-title","Link settings"),children:(0,t.jsx)(E.x6,{i18nKey:"link.share.config-alert-description",children:"Updating your settings will modify the default copy link to include these changes. Please note that these settings are saved within your current browser scope."})}),(0,t.jsx)("div",{className:nn.configDescription,children:(0,t.jsx)(U.E,{variant:"body",children:(0,t.jsx)(E.x6,{i18nKey:"link.share.config-description",children:"Create a personalized, direct link to share your dashboard within your organization, with the following customization settings:"})})}),(0,t.jsx)(Te,{useLockedTime:hn,onToggleLockedTime:Ut.onToggleLockedTime,useShortUrl:dn,onUrlShorten:Ut.onUrlShorten,selectedTheme:Sn,onChangeTheme:Ut.onThemeChange,isLoading:es}),(0,t.jsx)(I.c,{spacing:1}),(0,t.jsx)(o.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:(0,t.jsx)(x.b,{icon:"link",variant:"primary",fill:"outline",disabled:es,getText:Ut.getShareUrl,onClipboardCopy:Ut.onCopy,className:nn.copyButtonContainer,"data-testid":Ge.copyUrlButton,children:(0,t.jsx)(E.x6,{i18nKey:"link.share.copy-link-button",children:"Copy link"})})})]})}const St=Ut=>({configDescription:(0,i.css)({marginBottom:Ut.spacing(2)}),copyButtonContainer:(0,i.css)({marginTop:Ut.spacing(2)})});var zt=e(5805),Kt=e(72109),Qt=e(12962),an=e(94354),Nn=e(76412);const zn="https://grafana.com/docs/grafana/next/dashboards/share-dashboards-panels/#share-a-snapshot",Yn="https://grafana.com/docs/grafana/next/dashboards/share-dashboards-panels/#panel-snapshot";function ss({name:Ut,onNameChange:nn,onExpireChange:hn,selectedExpireOption:dn,panelRef:Sn,disableInputs:es,children:Pt}){const Ze=(0,h.of)(ds);return(0,t.jsxs)("div",{className:Ze.container,children:[(0,t.jsx)(Se.F,{severity:"info",title:"",children:(0,t.jsxs)(o.B,{justifyContent:"space-between",gap:2,alignItems:"center",children:[(0,t.jsx)(U.E,{children:Sn?(0,t.jsx)(E.x6,{i18nKey:"snapshot.share-panel.info-alert",children:"A Grafana panel snapshot publicly shares a panel while removing sensitive data such as queries and panel links, leaving only visible metrics and series names. Anyone with the link can access the snapshot."}):(0,t.jsx)(E.x6,{i18nKey:"snapshot.share.info-alert",children:"A Grafana dashboard snapshot publicly shares a dashboard while removing sensitive data such as queries and panel links, leaving only visible metrics and series names. Anyone with the link can access the snapshot."})}),(0,t.jsx)(y.$n,{variant:"secondary",onClick:()=>window.open(Sn?Yn:zn,"_blank"),type:"button",children:(0,t.jsx)(E.x6,{i18nKey:"snapshot.share.learn-more-button",children:"Learn more"})})]})}),(0,t.jsxs)("fieldset",{disabled:es,children:[(0,t.jsx)(ee.D,{label:(0,Nn.t)("snapshot.share.name-label","Snapshot name"),children:(0,t.jsx)(ae.p,{id:"snapshot-name-input",value:Ut,onChange:lt=>nn(lt.currentTarget.value)})}),(0,t.jsx)(ee.D,{label:(0,Nn.t)("snapshot.share.expiration-label","Expires in"),children:(0,t.jsx)(an.z,{id:"expire-select-input",options:(0,Qt.u)(),value:dn?.value,onChange:hn})})]}),(0,t.jsx)(I.c,{}),Pt]})}const ds=Ut=>({container:(0,i.css)({paddingBottom:Ut.spacing(2)})}),Ms=c.Tp.pages.ShareDashboardDrawer.ShareSnapshot;class Bs extends Qt.l{static{this.Component=gs}getTabLabel(){return(0,E.t)("share-dashboard.menu.share-snapshot-title","Share snapshot")}}function gs({model:Ut}){const[nn,hn]=(0,M.useState)(!1),[dn,Sn]=(0,M.useState)(!1),[es,Pt]=(0,M.useState)(1),{snapshotName:Ze,snapshotSharingOptions:lt,selectedExpireOption:yt,panelRef:Nt,onDismiss:wt,dashboardRef:Zt}=Ut.useState(),[pn,On]=(0,zt.default)(async(zs=!1)=>{const Ks=await Ut.onSnapshotCreate(zs);return Pt(2),Ks}),[An,qn]=(0,zt.default)(async zs=>{const Ks=await Ut.onSnapshotDelete(zs);return Pt(1),hn(!1),Sn(!0),Ks}),cs=()=>{wt?.()},Os=()=>{Ut.onSnasphotNameChange(Zt.resolve().state.title),Pt(1)},xs=async()=>{await qn(pn.value?.deleteUrl),Os()};return nn?(0,t.jsx)(w,{title:(0,E.t)("snapshot.share.delete-title","Delete snapshot"),confirmButtonLabel:(0,E.t)("snapshot.share.delete-button","Delete snapshot"),onConfirm:xs,onDismiss:()=>hn(!1),description:(0,E.t)("snapshot.share.delete-description","Are you sure you want to delete this snapshot?"),isActionLoading:An.loading}):(0,t.jsx)("div",{"data-testid":Ms.container,children:(0,t.jsxs)(t.Fragment,{children:[es===1&&dn&&(0,t.jsx)(Se.F,{severity:"info",title:"",onRemove:()=>Sn(!1),children:(0,t.jsx)(E.x6,{i18nKey:"snapshot.share.deleted-alert",children:"Snapshot deleted. It could take an hour to be cleared from CDN caches."})}),(0,t.jsx)(ss,{name:Ze??"",selectedExpireOption:yt,onNameChange:Ut.onSnasphotNameChange,onExpireChange:Ut.onExpireChange,disableInputs:es===2,panelRef:Nt,children:(0,t.jsxs)(o.B,{justifyContent:"space-between",gap:{xs:2},direction:{xs:"column",xl:"row"},children:[es===1?(0,t.jsx)(Zn,{onCreateClick:On,isLoading:pn.loading,onCancelClick:cs,sharingOptions:lt}):es===2&&pn.value&&(0,t.jsx)(Ls,{url:pn.value.url,onDeleteClick:()=>hn(!0),onNewSnapshotClick:Os}),(0,t.jsx)(Kt.Y,{icon:"external-link-alt",href:"/dashboard/snapshots",external:!0,children:(0,E.t)("snapshot.share.view-all-button","View all snapshots")})]})})]})})}const Zn=({isLoading:Ut,onCreateClick:nn,onCancelClick:hn,sharingOptions:dn})=>(0,t.jsxs)(o.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,t.jsx)(y.$n,{variant:"primary",disabled:Ut,onClick:()=>nn(),"data-testid":Ms.publishSnapshot,children:(0,t.jsx)(E.x6,{i18nKey:"snapshot.share.local-button",children:"Publish snapshot"})}),dn?.externalEnabled&&(0,t.jsx)(y.$n,{variant:"secondary",disabled:Ut,onClick:()=>nn(!0),children:dn?.externalSnapshotName}),(0,t.jsx)(y.$n,{variant:"secondary",fill:"outline",onClick:hn,children:(0,t.jsx)(E.x6,{i18nKey:"snapshot.share.cancel-button",children:"Cancel"})}),Ut&&(0,t.jsx)(f.y,{})]}),Ls=({url:Ut,onDeleteClick:nn,onNewSnapshotClick:hn})=>(0,t.jsxs)(o.B,{justifyContent:"flex-start",gap:1,direction:{xs:"column",sm:"row"},children:[(0,t.jsx)(x.b,{icon:"link",variant:"primary",fill:"outline",getText:()=>Ut,"data-testid":Ms.copyUrlButton,children:(0,t.jsx)(E.x6,{i18nKey:"snapshot.share.copy-link-button",children:"Copy link"})}),(0,t.jsx)(y.$n,{icon:"trash-alt",variant:"destructive",fill:"outline",onClick:nn,children:(0,t.jsx)(E.x6,{i18nKey:"snapshot.share.delete-button",children:"Delete snapshot"})}),(0,t.jsx)(y.$n,{variant:"secondary",fill:"solid",onClick:hn,children:(0,t.jsx)(E.x6,{i18nKey:"snapshot.share.new-snapshot-button",children:"New snapshot"})})]});var Ln=e(1397),Hn=e(3293),Qn=e(32264);class mt extends Oe.R{static{this.Component=Yt}constructor(nn){super(nn)}getTabLabel(){return(0,E.t)("share-panel.drawer.share-link-title","Link settings")}}function Yt({model:Ut}){const nn=(0,h.of)(on),{useLockedTime:hn,useShortUrl:dn,selectedTheme:Sn,isBuildUrlLoading:es,imageUrl:Pt}=Ut.useState(),lt=!!(0,g.YQ)(Ut).state.uid;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:nn.configDescription,children:(0,t.jsx)(U.E,{variant:"body",children:(0,t.jsx)(E.x6,{i18nKey:"link.share-panel.config-description",children:"Create a personalized, direct link to share your panel within your organization, with the following customization settings:"})})}),(0,t.jsx)(Te,{useLockedTime:hn,onToggleLockedTime:()=>Ut.onToggleLockedTime(),useShortUrl:dn,onUrlShorten:()=>Ut.onUrlShorten(),selectedTheme:Sn,onChangeTheme:yt=>Ut.onThemeChange(yt),isLoading:es}),(0,t.jsx)(I.c,{spacing:1}),(0,t.jsxs)(o.B,{gap:2,direction:"column",children:[(0,t.jsx)("div",{className:nn.buttonsContainer,children:(0,t.jsxs)(o.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,t.jsx)(x.b,{icon:"link",variant:"primary",fill:"outline",disabled:es,getText:Ut.getShareUrl,onClipboardCopy:Ut.onCopy,children:(0,t.jsx)(E.x6,{i18nKey:"link.share.copy-link-button",children:"Copy link"})}),(0,t.jsx)(y.z9,{href:Pt,icon:"external-link-alt",target:"_blank",variant:"secondary",fill:"solid",disabled:!Qn.$.rendererAvailable||!lt,children:(0,t.jsx)(E.x6,{i18nKey:"link.share-panel.render-image",children:"Render image"})})]})}),!lt&&(0,t.jsx)(Se.F,{severity:"info",title:(0,E.t)("share-modal.link.save-alert","Dashboard is not saved"),bottomSpacing:0,children:(0,t.jsx)(E.x6,{i18nKey:"share-modal.link.save-dashboard",children:"To render a panel image, you must save the dashboard first."})}),!Qn.$.rendererAvailable&&(0,t.jsx)(Se.F,{severity:"info",title:(0,E.t)("share-modal.link.render-alert","Image renderer plugin not installed"),bottomSpacing:0,children:(0,t.jsxs)(E.x6,{i18nKey:"share-modal.link.render-instructions",children:["To render a panel image, you must install the"," ",(0,t.jsx)("a",{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",target:"_blank",rel:"noopener noreferrer",className:"external-link",children:"Grafana image renderer plugin"}),". Please contact your Grafana administrator to install the plugin."]})})]})]})}const on=Ut=>({configDescription:(0,i.css)({marginBottom:Ut.spacing(2)}),buttonsContainer:(0,i.css)({marginTop:Ut.spacing(2)})}),ln=[];function fn(Ut){ln.push(Ut)}class yn extends s.Bs{constructor(nn){super({...nn}),this.onDismiss=()=>{this.state.panelRef?(0,g.YQ)(this).closeModal():n.Ny.partial({shareView:null})},this.addActivationHandler(()=>this.buildActiveShare(nn.shareView))}static{this.Component=wn}buildActiveShare(nn){const{panelRef:hn}=this.state,dn=(0,g.YQ)(this),Sn=hn?xn(nn,this.onDismiss,dn.getRef(),hn):Xn(nn,this.onDismiss,dn.getRef(),hn);this.setState({activeShare:Sn})}}function wn({model:Ut}){const{activeShare:nn}=Ut.useState(),hn=(0,g.YQ)(Ut);return(0,t.jsx)(a._,{title:nn?.getTabLabel(),onClose:Ut.onDismiss,size:"md",children:(0,t.jsx)(N.Provider,{value:{dashboard:hn,onDismiss:Ut.onDismiss},children:nn&&(0,t.jsx)(nn.Component,{model:nn})})})}function Xn(Ut,nn,hn,dn){const Sn=ln.find(es=>es.id===Ut);if(Sn)return new Sn.shareOption({onDismiss:nn});switch(Ut){case r.wr.link:return new Je({onDismiss:nn});case r.wr.publicDashboard:return new gt({onDismiss:nn});case r.wr.snapshot:return new Bs({dashboardRef:hn,panelRef:dn,onDismiss:nn});case r.wr.export:return new T({onDismiss:nn});default:return new Je({onDismiss:nn})}}function xn(Ut,nn,hn,dn){switch(Ut){case r.wr.link:return new mt({panelRef:dn,onDismiss:nn});case r.wr.snapshot:return new Bs({dashboardRef:hn,panelRef:dn,onDismiss:nn});case r.wr.embed:return new Hn.c({panelRef:dn,onDismiss:nn});case r.wr.libraryPanel:return new Ln.S({panelRef:dn,onDismiss:nn});default:return new mt({panelRef:dn,onDismiss:nn})}}},50056:(G,R,e)=>{"use strict";e.d(R,{N:()=>D});var t=e(74848),n=e(4213),s=e.n(n),a=e(16817),r=e(70713),g=e(84537),i=e(67061),l=e(88575),d=e(15292),c=e(37390),h=e(55852),o=e(32372),m=e(10534),u=e(8484),p=e(15858),f=e(22699),y=e(34214),x=e(20455),v=e(73788),P=e(7758),E=e(74730);class D extends g.Bs{constructor(T){super({isSharingExternally:!1,isViewingJSON:!1,...T}),this.tabId=f.wr.export,this._exporter=new p.M,this.onShareExternallyChange=()=>{this.setState({isSharingExternally:!this.state.isSharingExternally})},this.onViewJSON=()=>{this.setState({isViewingJSON:!this.state.isViewingJSON})},this.getExportableDashboardJson=async()=>{const{isSharingExternally:S}=this.state,O=(0,x.Uy)((0,E.YQ)(this));return S?await this._exporter.makeExportable(new y.G(O,void 0,{getVariablesFromState:()=>(0,v.E)(window.__grafanaSceneContext)})):O},this.onSaveAsFile=async()=>{const S=await this.getExportableDashboardJson(),O=JSON.stringify(S,null,2),{isSharingExternally:M}=this.state,I=new Blob([O],{type:"application/json;charset=utf-8"}),L=new Date().getTime();let B="dashboard";"title"in S&&S.title&&(B=S.title),s()(I,`${B}-${L}.json`),P.c.exportDownloadJsonClicked({externally:M})}}static{this.Component=C}getTabLabel(){return(0,u.t)("share-modal.tab-title.export","Export")}getClipboardText(){}}function C({model:b}){const{isSharingExternally:T,isViewingJSON:S,modalRef:O}=b.useState(),M=(0,a.A)(async()=>{if(S){const L=await b.getExportableDashboardJson();return JSON.stringify(L,null,2)}return""},[S]),I=(0,u.t)("share-modal.export.share-externally-label","Export for sharing externally");return(0,t.jsxs)(t.Fragment,{children:[!S&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{children:(0,t.jsx)(u.x6,{i18nKey:"share-modal.export.info-text",children:"Export this dashboard."})}),(0,t.jsx)(i.B,{gap:2,direction:"column",children:(0,t.jsx)(l.D,{label:I,children:(0,t.jsx)(d.d,{id:"share-externally-toggle",value:T,onChange:b.onShareExternallyChange})})}),(0,t.jsxs)(c.a.ButtonRow,{children:[(0,t.jsx)(h.$n,{variant:"secondary",onClick:()=>{O?.resolve().onDismiss()},fill:"outline",children:(0,t.jsx)(u.x6,{i18nKey:"share-modal.export.cancel-button",children:"Cancel"})}),(0,t.jsx)(h.$n,{variant:"secondary",icon:"brackets-curly",onClick:b.onViewJSON,children:(0,t.jsx)(u.x6,{i18nKey:"share-modal.export.view-button",children:"View JSON"})}),(0,t.jsx)(h.$n,{variant:"primary",icon:"save",onClick:()=>b.onSaveAsFile(),children:(0,t.jsx)(u.x6,{i18nKey:"share-modal.export.save-button",children:"Save to file"})})]})]}),S&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.Ay,{disableHeight:!0,children:({width:L})=>M.value?(0,t.jsx)(o.B,{value:M.value??"",language:"json",showMiniMap:!1,height:"500px",width:L}):M.loading?(0,t.jsx)("div",{children:"Loading..."}):null}),(0,t.jsxs)(c.a.ButtonRow,{children:[(0,t.jsx)(h.$n,{variant:"secondary",fill:"outline",onClick:b.onViewJSON,icon:"arrow-left",children:(0,t.jsx)(u.x6,{i18nKey:"share-modal.export.back-button",children:"Back to export config"})}),(0,t.jsx)(m.b,{variant:"secondary",icon:"copy",disabled:M.loading,getText:()=>M.value??"",children:(0,t.jsx)(u.x6,{i18nKey:"share-modal.view-json.copy-button",children:"Copy to Clipboard"})}),(0,t.jsx)(h.$n,{variant:"primary",icon:"save",disabled:M.loading,onClick:()=>b.onSaveAsFile(),children:(0,t.jsx)(u.x6,{i18nKey:"share-modal.export.save-button",children:"Save to file"})})]})]})]})}},1397:(G,R,e)=>{"use strict";e.d(R,{S:()=>h});var t=e(74848),n=e(32264),s=e(84537),a=e(8484),r=e(86394),g=e(22699),i=e(34214),l=e(41507),d=e(20455),c=e(74730);class h extends s.Bs{constructor(){super(...arguments),this.tabId=g.wr.libraryPanel}static{this.Component=o}getTabLabel(){return n.$.featureToggles.newDashboardSharingComponent?(0,a.t)("share-panel.drawer.new-library-panel-title","New library panel"):(0,a.t)("share-modal.tab-title.library-panel","Library panel")}}function o({model:m}){const{panelRef:u,modalRef:p}=m.useState();if(!u)return null;const f=u.resolve(),y=f.parent;if(y instanceof l.U){const x=(0,c.YQ)(m),v=(0,d.ZB)(y),P=new i.a(v),E=(0,d.Uy)(x),D=new i.G(E);return(0,t.jsx)(r.j,{initialFolderUid:x.state.meta.folderUid,dashboard:D,panel:P,onDismiss:()=>{p?p.resolve().onDismiss():x.closeModal()},onCreateLibraryPanel:C=>x.createLibraryPanel(f,C)})}return null}},58398:(G,R,e)=>{"use strict";e.d(R,{R:()=>P});var t=e(74848),n=e(47232),s=e(13544),a=e(32264),r=e(84537),g=e(84167),i=e(88575),l=e(15292),d=e(10354),c=e(10534),h=e(14578),o=e(42418),m=e(8484),u=e(7030),p=e(87895),f=e(22699),y=e(7758),x=e(11982),v=e(74730);class P extends r.Bs{constructor(b){super({...b,useLockedTime:b.useLockedTime??!0,useShortUrl:b.useShortUrl??!1,selectedTheme:b.selectedTheme??"current",shareUrl:"",imageUrl:"",isBuildUrlLoading:!1}),this.tabId=f.wr.link,this.getShareUrl=()=>this.state.shareUrl,this.onCopy=()=>{y.c.shareLinkCopied({currentTimeRange:this.state.useLockedTime,theme:this.state.selectedTheme,shortenURL:this.state.useShortUrl,shareResource:(0,f.hD)(this.state.panelRef)})},this.addActivationHandler(()=>{this.buildUrl()}),this.onToggleLockedTime=this.onToggleLockedTime.bind(this),this.onUrlShorten=this.onUrlShorten.bind(this),this.onThemeChange=this.onThemeChange.bind(this)}static{this.Component=E}async buildUrl(){this.setState({isBuildUrlLoading:!0});const{panelRef:b,useLockedTime:T,useShortUrl:S,selectedTheme:O}=this.state,M=(0,v.YQ)(this),I=b?.resolve(),L={useAbsoluteTimeRange:T,theme:O,useShortUrl:S};let B=(0,u.VN)(M,L,I);S&&(B=await(0,u.fn)(B));const j=r.jh.getTimeRange(I??M),A=(0,u.$l)(L,j,I);let K=A;I&&(delete K.viewPanel,K.panelId=I.state.key,K["__feature.dashboardSceneSolo"]=!0);const W=(0,x.uZ)({uid:M.state.uid,currentQueryParams:location.search,updateQuery:{...A,panelId:I?.state.key},absolute:!0,soloRoute:!0,render:!0,timeZone:D(j.getTimeZone())});this.setState({shareUrl:B,imageUrl:W,isBuildUrlLoading:!1})}getTabLabel(){return(0,m.t)("share-modal.tab-title.link","Link")}async onToggleLockedTime(){const b=!this.state.useLockedTime;this.setState({useLockedTime:b}),await this.buildUrl()}async onUrlShorten(){const b=!this.state.useShortUrl;this.setState({useShortUrl:b}),await this.buildUrl()}async onThemeChange(b){this.setState({selectedTheme:b}),await this.buildUrl()}}function E({model:C}){const b=C.useState(),{panelRef:T}=b,S=(0,v.YQ)(C),O=T?.resolve(),I=r.jh.getTimeRange(O??S).state.to==="now",{useLockedTime:L,useShortUrl:B,selectedTheme:j,shareUrl:A,imageUrl:K}=b,W=s.Tp.pages.SharePanelModal,U=!!S.state.uid,F=(0,m.t)("share-modal.link.time-range-label","Lock time range"),V=(0,m.t)("share-modal.link.time-range-description","Transforms the current relative time range to an absolute time range"),w=(0,m.t)("share-modal.link.shorten-url","Shorten URL"),z=(0,m.t)("share-modal.link.link-url","Link URL");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{children:(0,t.jsx)(m.x6,{i18nKey:"share-modal.link.info-text",children:"Create a direct link to this dashboard or panel, customized with the options below."})}),(0,t.jsxs)(g.n,{children:[(0,t.jsx)(i.D,{label:F,description:I?V:"",children:(0,t.jsx)(l.d,{id:"share-current-time-range",value:L,onChange:C.onToggleLockedTime})}),(0,t.jsx)(p.w,{selectedTheme:j,onChange:C.onThemeChange}),(0,t.jsx)(i.D,{label:w,children:(0,t.jsx)(l.d,{id:"share-shorten-url",value:B,onChange:C.onUrlShorten})}),(0,t.jsx)(i.D,{label:z,children:(0,t.jsx)(d.p,{id:"link-url-input",value:A,readOnly:!0,addonAfter:(0,t.jsx)(c.b,{icon:"copy",variant:"primary",getText:C.getShareUrl,onClipboardCopy:C.onCopy,children:(0,t.jsx)(m.x6,{i18nKey:"share-modal.link.copy-link-button",children:"Copy"})})})})]}),O&&a.$.rendererAvailable&&(0,t.jsxs)(t.Fragment,{children:[U&&(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsxs)("a",{href:K,target:"_blank",rel:"noreferrer","aria-label":W.linkToRenderedImage,children:[(0,t.jsx)(h.I,{name:"camera"}),"\xA0",(0,t.jsx)(m.x6,{i18nKey:"share-modal.link.rendered-image",children:"Direct link rendered image"})]})}),!U&&(0,t.jsx)(o.F,{severity:"info",title:(0,m.t)("share-modal.link.save-alert","Dashboard is not saved"),bottomSpacing:0,children:(0,t.jsx)(m.x6,{i18nKey:"share-modal.link.save-dashboard",children:"To render a panel image, you must save the dashboard first."})})]}),O&&!a.$.rendererAvailable&&(0,t.jsx)(o.F,{severity:"info",title:(0,m.t)("share-modal.link.render-alert","Image renderer plugin not installed"),bottomSpacing:0,children:(0,t.jsxs)(m.x6,{i18nKey:"share-modal.link.render-instructions",children:["To render a panel image, you must install the"," ",(0,t.jsx)("a",{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",target:"_blank",rel:"noopener noreferrer",className:"external-link",children:"Grafana image renderer plugin"}),". Please contact your Grafana administrator to install the plugin."]})})]})}function D(C){const b="UTC"+encodeURIComponent((0,n.KQ)().format("Z"));if(C==="utc")return"UTC";if(C==="browser"){if(!window.Intl)return b;const S=window.Intl.DateTimeFormat().resolvedOptions();return S.timeZone?S.timeZone:b}return C}},11675:(G,R,e)=>{"use strict";e.d(R,{Z:()=>F,m:()=>U});var t=e(74848),n=e(39601),s=e(32264),a=e(84537),r=e(25897),g=e(37390),i=e(40980),l=e(10096),d=e(8484),c=e(72254),h=e(22699),o=e(7758),m=e(74730),u=e(50056),p=e(1397),f=e(58398),y=e(3293),x=e(12962),v=e(72686),P=e(4785),E=e(32196),D=e(40845),C=e(59037),b=e(31678),T=e(96374);class S extends a.Bs{static{this.Component=O}constructor(z){super({confirmVariant:"destructive",dismissText:"Cancel",dismissVariant:"secondary",icon:"exclamation-triangle",confirmButtonVariant:"destructive",...z})}onDismiss(){}}function O({model:w}){const z=w.useState();return(0,t.jsx)(T.u,{...z})}var M=e(59995);function I({model:w,publicDashboard:z,isGetLoading:N}){const H=(0,D.of)(L),Q=l.TP.hasPermission(b.AccessControlAction.DashboardsPublicWrite),X=(0,m.YQ)(w),{isDirty:ee}=X.useState(),[Z]=(0,v.bN)(),q=(X.state.$variables?.state.variables.length??0)>0,ae=(0,M.b)(X),se=a.jh.getTimeRange(w).useState();return(0,t.jsx)(C.b,{dashboard:X,publicDashboard:z,unsupportedDatasources:ae,onRevoke:()=>{X.showModal(new S({isOpen:!0,title:"Revoke public URL",icon:"trash-alt",confirmText:"Revoke public URL",body:(0,t.jsx)("p",{className:H.description,children:"Are you sure you want to revoke this URL? The dashboard will no longer be public."}),onDismiss:()=>{X.showModal(new F({activeTab:h.wr.publicDashboard}))},onConfirm:()=>{Z({dashboard:X,dashboardUid:X.state.uid,uid:z.uid}),X.closeModal()}}))},timeRange:se.value,showSaveChangesAlert:Q&&ee,hasTemplateVariables:q})}const L=w=>({description:(0,E.css)({fontSize:w.typography.body.fontSize})});var B=e(22234);function j({model:w}){const z=(0,m.YQ)(w),N=(0,M.b)(z),H=(z.state.$variables?.state.variables.length??0)>0;return(0,t.jsx)(B.D,{dashboard:z,unsupportedDatasources:N,unsupportedTemplateVariables:H})}class A extends a.Bs{constructor(){super(...arguments),this.tabId=h.wr.publicDashboard}static{this.Component=K}getTabLabel(){return(0,d.t)("share-modal.tab-title.public-dashboard","Public Dashboard")}}function K({model:w}){const{data:z,isLoading:N}=(0,v.Bs)((0,m.YQ)(w).state.uid);return(0,t.jsx)(t.Fragment,{children:N?(0,t.jsx)(P.a,{}):(0,c.lI)(z)?(0,t.jsx)(I,{model:w,publicDashboard:z,isGetLoading:N}):(0,t.jsx)(j,{model:w})})}const W=[];function U(w){W.push(w)}class F extends a.Bs{constructor(z){super({activeTab:"link",...z}),this.onDismiss=()=>{this.state.panelRef?(0,m.YQ)(this).closeModal():n.Ny.partial({shareView:null})},this.onChangeTab=N=>{o.c.sharingCategoryClicked({item:N.value,shareResource:(0,h.hD)(this.state.panelRef)}),this.setState({activeTab:N.value})},this.addActivationHandler(()=>this.buildTabs(z.activeTab))}static{this.Component=V}buildTabs(z){const{panelRef:N}=this.state,H=this.getRef(),Q=[new f.R({panelRef:N,modalRef:H})],X=(0,m.YQ)(this);if(N||Q.push(new u.N({modalRef:H})),l.TP.isSignedIn&&s.$.snapshotEnabled&&X.canEditDashboard()&&Q.push(new x.l({panelRef:N,dashboardRef:X.getRef(),modalRef:H})),N){Q.push(new y.c({panelRef:N}));const Z=N.resolve();Z instanceof a.Eb&&((0,m.ME)(Z)||Q.push(new p.S({panelRef:N,modalRef:H})))}N||(Q.push(...W.map(Z=>new Z({modalRef:H}))),(0,c.iR)()&&Q.push(new A({modalRef:H})));const ee=Q.find(Z=>Z.tabId===z);this.setState({activeTab:ee?.tabId??Q[0].tabId,tabs:Q})}}function V({model:w}){const{panelRef:z,tabs:N,activeTab:H}=w.useState(),Q=z?(0,d.t)("share-modal.panel.title","Share Panel"):(0,d.t)("share-modal.dashboard.title","Share");if(!N)return;const X=N?.map(q=>({label:q.getTabLabel(),value:q.tabId})),ee=(0,t.jsx)(r.J,{title:Q,icon:"share-alt",tabs:X,activeTab:H,onChangeTab:w.onChangeTab}),Z=N.find(q=>q.tabId===H);return(0,t.jsx)(g.a,{isOpen:!0,title:ee,onDismiss:w.onDismiss,children:(0,t.jsx)(i.J,{children:Z&&(0,t.jsx)(Z.Component,{model:Z})})})}},3293:(G,R,e)=>{"use strict";e.d(R,{c:()=>c});var t=e(74848),n=e(32264),s=e(84537),a=e(8484),r=e(35280),g=e(22699),i=e(7928),l=e(11982),d=e(74730);class c extends s.Bs{constructor(u){super(u),this.tabId=g.wr.embed}static{this.Component=h}getTabLabel(){return n.$.featureToggles.newDashboardSharingComponent?(0,a.t)("share-panel.drawer.share-embed-title","Share embed"):(0,a.t)("share-modal.tab-title.panel-embed","Embed")}}function h({model:m}){const{panelRef:u}=m.useState(),p=u.resolve(),f=(0,d.YQ)(m),{uid:y}=f.useState(),x=(0,d.Cs)(p),v=s.jh.getTimeRange(p),P=v instanceof i.v?v.state.timeFrom:void 0;return(0,t.jsx)(r.D,{panel:{id:x,timeFrom:P},range:v.state.value,dashboard:{uid:y??"",time:v.state.value},buildIframe:o(f),onCancelClick:()=>f.closeModal()})}const o=m=>(u,p,f,y,x)=>{const v=(0,g.XV)({useCurrentTimeRange:u,selectedTheme:f,panel:y,range:x}),P=v.get("editPanel")??v.get("viewPanel")??"";return v.set("panelId",P),v.delete("editPanel"),v.delete("viewPanel"),v.set("__feature.dashboardSceneSolo","true"),`<iframe src="${(0,l.uZ)({absolute:!0,soloRoute:!0,uid:m.state.uid,slug:m.state.meta.slug,currentQueryParams:v.toString()})}" width="450" height="200" frameborder="0"></iframe>`}},12962:(G,R,e)=>{"use strict";e.d(R,{l:()=>b,u:()=>D});var t=e(74848),n=e(5805),s=e(13544),a=e(17172),r=e(84537),g=e(88575),i=e(10354),l=e(94354),d=e(37390),c=e(55852),h=e(67061),o=e(10534),m=e(82467),u=e(3169),p=e(8484),f=e(22699),y=e(69064),x=e(99140),v=e(20455),P=e(7758);const E=s.Tp.pages.ShareDashboardModal.SnapshotScene,D=()=>{const S={label:(0,p.t)("share-modal.snapshot.expire-week","1 Week"),value:604800};return[{label:(0,p.t)("share-modal.snapshot.expire-hour","1 Hour"),value:60*60},{label:(0,p.t)("share-modal.snapshot.expire-day","1 Day"),value:60*60*24},S,{label:(0,p.t)("share-modal.snapshot.expire-never","Never"),value:0}]},C=()=>D()[2];class b extends r.Bs{constructor(O){super({...O,snapshotName:O.dashboardRef.resolve().state.title,selectedExpireOption:C()}),this.tabId=f.wr.snapshot,this.onSnasphotNameChange=M=>{this.setState({snapshotName:M})},this.onExpireChange=M=>{this.setState({selectedExpireOption:D().find(I=>I.value===M)})},this.onSnapshotCreate=async(M=!1)=>{const{selectedExpireOption:I}=this.state,L=this.prepareSnapshot(),B={dashboard:L,name:L.title,expires:I?.value,external:M};try{const j=await(0,y.s)().create(B);return(0,x.JD)((0,m.dx)((0,u.tZ)((0,p.t)("snapshot.share.success-creation","Your snapshot has been created")))),j}finally{M?P.c.publishSnapshotClicked({expires:B.expires,shareResource:(0,f.hD)(this.state.panelRef)}):P.c.publishSnapshotLocalClicked({expires:B.expires,shareResource:(0,f.hD)(this.state.panelRef)})}},this.onSnapshotDelete=async M=>{const I=await(0,a.AI)().get(M);return(0,x.JD)((0,m.dx)((0,u.tZ)((0,p.t)("snapshot.share.success-delete","Your snapshot has been deleted")))),I},this.addActivationHandler(()=>{this._onActivate()})}static{this.Component=T}_onActivate(){(0,y.s)().getSharingOptions().then(O=>{this.isActive&&this.setState({snapshotSharingOptions:O})})}getTabLabel(){return(0,p.t)("share-modal.tab-title.snapshot","Snapshot")}prepareSnapshot(){const O=r.jh.getTimeRange(this),{dashboardRef:M,panelRef:I}=this.state,L=(0,v.Uy)(M.resolve(),!0);return(0,v.c)(this.state.snapshotName.trim()||"",O.state.value,L,I?.resolve())}}function T({model:S}){const{snapshotName:O,selectedExpireOption:M,modalRef:I,snapshotSharingOptions:L}=S.useState(),[B,j]=(0,n.default)(async(W=!1)=>S.onSnapshotCreate(W)),[A,K]=(0,n.default)(async W=>await(0,a.AI)().get(W));return A.value?(0,t.jsx)(p.x6,{i18nKey:"share-modal.snapshot.deleted-message",children:"The snapshot has been deleted. If you have already accessed it once, then it might take up to an hour before before it is removed from browser caches or CDN caches."}):(0,t.jsxs)(t.Fragment,{children:[!B.value&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{children:(0,t.jsx)(p.x6,{i18nKey:"share-modal.snapshot.info-text-1",children:"A snapshot is an instant way to share an interactive dashboard publicly. When created, we strip sensitive data like queries (metric, template, and annotation) and panel links, leaving only the visible metric data and series names embedded in your dashboard."})}),(0,t.jsx)("p",{children:(0,t.jsxs)(p.x6,{i18nKey:"share-modal.snapshot.info-text-2",children:["Keep in mind, your snapshot ",(0,t.jsx)("em",{children:"can be viewed by anyone"})," that has the link and can access the URL. Share wisely."]})})]}),(0,t.jsx)(g.D,{label:(0,p.t)("share-modal.snapshot.name","Snapshot name"),children:(0,t.jsx)(i.p,{id:"snapshot-name-input",width:30,defaultValue:O,onBlur:W=>S.onSnasphotNameChange(W.target.value)})}),(0,t.jsx)(g.D,{label:(0,p.t)("share-modal.snapshot.expire","Expire"),children:(0,t.jsx)(l.z,{id:"expire-select-input",options:D(),value:M?.value,onChange:S.onExpireChange})}),(0,t.jsxs)(d.a.ButtonRow,{children:[(0,t.jsx)(c.$n,{variant:"secondary",onClick:()=>{I?.resolve().onDismiss()},fill:"outline",children:(0,t.jsx)(p.x6,{i18nKey:"share-modal.snapshot.cancel-button",children:"Cancel"})}),L?.externalEnabled&&(0,t.jsx)(c.$n,{variant:"secondary",disabled:B.loading,onClick:()=>j(!0),children:L?.externalSnapshotName}),(0,t.jsx)(c.$n,{variant:"primary",disabled:B.loading,onClick:()=>j(),"data-testid":E.PublishSnapshot,children:(0,t.jsx)(p.x6,{i18nKey:"share-modal.snapshot.local-button",children:"Publish Snapshot"})})]})]}),B.value&&(0,t.jsxs)(h.B,{direction:"column",gap:0,children:[(0,t.jsx)(g.D,{label:(0,p.t)("share-modal.snapshot.url-label","Snapshot URL"),children:(0,t.jsx)(i.p,{"data-testid":E.CopyUrlInput,id:"snapshot-url-input",value:B.value.url,readOnly:!0,addonAfter:(0,t.jsx)(o.b,{"data-testid":E.CopyUrlButton,icon:"copy",variant:"primary",getText:()=>B.value.url,children:(0,t.jsx)(p.x6,{i18nKey:"share-modal.snapshot.copy-link-button",children:"Copy"})})})}),(0,t.jsxs)("div",{style:{alignSelf:"flex-end",padding:"5px"},children:[(0,t.jsx)(p.x6,{i18nKey:"share-modal.snapshot.mistake-message",children:"Did you make a mistake? "}),"\xA0",(0,t.jsx)(c.$n,{fill:"outline",size:"md",variant:"destructive",onClick:()=>{K(B.value.deleteUrl)},children:(0,t.jsx)(p.x6,{i18nKey:"share-modal.snapshot.delete-button",children:"Delete snapshot."})})]})]})]})}},59995:(G,R,e)=>{"use strict";e.d(R,{b:()=>d});var t=e(16817),n=e(26657),s=e(31204),a=e(31193),r=e(74730);const g=async c=>{let h=new Set;for(const o of c)s.z.has(o)&&await(0,a.tR)().get(o)instanceof n.iy||h.add(o);return Array.from(h)};function i(c){const h=new Set,o=c.state.body.getVizPanels();for(const m of o){const u=l(m);for(const p of u)h.add(p)}return Array.from(h).sort()}function l(c){const h=new Set,o=(0,r.un)(c);if(o)for(const m of o.state.queries)h.add(m.datasource?.type??"");return Array.from(h)}function d(c){const{value:h}=(0,t.A)(async()=>{const o=i(c);return g(o)},[]);return h}},53543:(G,R,e)=>{"use strict";e.d(R,{R:()=>s});var t=e(84537),n=e(74730);class s{constructor(r){this._vizPanel=r}get id(){const r=(0,n.Cs)(this._vizPanel);return isNaN(r)?(console.error("VizPanel key could not be translated to a legacy numeric panel id",this._vizPanel),0):r}get description(){return this._vizPanel.state.description}get type(){return this._vizPanel.state.pluginId}get title(){return this._vizPanel.state.title}get transformations(){return this._vizPanel.state.$data instanceof t.Es?this._vizPanel.state.$data.state.transformations:[]}get targets(){const r=(0,n.un)(this._vizPanel);return r?r.state.queries:[]}get datasource(){return(0,n.un)(this._vizPanel)?.state.datasource}get options(){return this._vizPanel.state.options}get fieldConfig(){return this._vizPanel.state.fieldConfig}get pluginVersion(){return this._vizPanel.state.pluginVersion}}},96556:(G,R,e)=>{"use strict";e.d(R,{w:()=>a});var t=e(32264),n=e(84537),s=e(39820);function a(r){if(!r.targets?.length||t.$.panels[r.type]?.skipDataQuery)return;let g;return g=new n.dt({datasource:r.datasource??void 0,queries:r.targets,maxDataPoints:r.maxDataPoints??void 0,maxDataPointsFromWidth:!0,cacheTimeout:r.cacheTimeout,queryCachingTTL:r.queryCachingTTL,minInterval:r.interval??void 0,dataLayerFilter:{panelId:r.id},$behaviors:[new s.L({})]}),new n.Es({$data:g,transformations:r.transformations||[]})}},32023:(G,R,e)=>{"use strict";e.d(R,{b4:()=>h});var t=e(84537),n=e(16279),s=e(42397);function a(o){return o.state.controls?.state.timePicker}function r(o){return o.state.controls?.state.refreshPicker}function g(o){return o.state.titleItems&&Array.isArray(o.state.titleItems)?o.state.titleItems.find(u=>u instanceof s.$)??null:null}function i(o){return o.state.body.getVizPanels()}function l(o){const m=t.jh.getData(o);if(!(m instanceof n.s))throw new Error("DashboardDataLayerSet not found");return m}function d(o){const m=o.state.$behaviors?.find(u=>u instanceof t.Gg.K2);if(m instanceof t.Gg.K2)return m}function c(o){return o.state.body.getNextPanelId()}const h={getTimePicker:a,getRefreshPicker:r,getPanelLinks:g,getVizPanels:i,getDataLayers:l,getNextPanelId:c,getCursorSync:d}},27734:(G,R,e)=>{"use strict";e.d(R,{Gq:()=>g,zf:()=>i});var t=e(76885),n=e(39601),s=e(32264),a=e(84537);const r="grafana.dashboard.preservedUrlFiltersState";function g(l){const d=window.sessionStorage.getItem(r);if(d){const c=new URLSearchParams(d),h=n.Ny.getSearch();c.forEach((m,u)=>{h.has(u)||h.append(u,m)});for(const m of Array.from(h.keys()))m.startsWith("var-")&&(l.state.$variables?.getByName(m.replace("var-",""))||h.delete(m));const o=h.toString();o&&n.Ny.replace({search:o})}}function i(l){if(s.$.featureToggles.preserveDashboardStateWhenNavigating)return()=>{if(!l.state.uid)return;const d=Object.fromEntries(Object.entries(new a.g5().getUrlState(l)).filter(([h])=>h.startsWith("var-")||h==="from"||h==="to"||h==="timezone")),c=Object.fromEntries(Object.entries(d).filter(([h,o])=>!(Array.isArray(o)&&o.length===0)));Object.keys(c).length>0?window.sessionStorage.setItem(r,t.kM.renderUrl("",c)):window.sessionStorage.removeItem(r)}}},73788:(G,R,e)=>{"use strict";e.d(R,{E:()=>s});var t=e(84537),n=e(53287);function s(a){const r=t.jh.getVariables(a);return(0,n.C)(r,!0)}},7758:(G,R,e)=>{"use strict";e.d(R,{c:()=>s});var t=e(14110);let n=!1;const s={dashboardInitialized:r=>{a("init_dashboard_completed",{...r})},panelLinkClicked:r=>{a("panelheader_datalink_clicked",r)},panelStatusMessageClicked:r=>{a("panelheader_statusmessage_clicked",r)},panelCancelQueryClicked:r=>{a("panelheader_cancelquery_clicked",r)},toolbarFavoritesClick:()=>{a("toolbar_actions_clicked",{item:"favorites"})},toolbarSettingsClick:()=>{a("toolbar_actions_clicked",{item:"settings"})},toolbarShareClick:()=>{a("toolbar_actions_clicked",{item:"share"})},toolbarAddClick:()=>{a("toolbar_actions_clicked",{item:"add"})},sharingCategoryClicked:r=>{a("sharing_category_clicked",r)},shareLinkCopied:r=>{a("sharing_link_copy_clicked",r)},embedSnippetCopy:r=>{a("sharing_embed_copy_clicked",r)},publishSnapshotClicked:r=>{a("sharing_snapshot_publish_clicked",r)},publishSnapshotLocalClicked:r=>{a("sharing_snapshot_local_clicked",r)},exportDownloadJsonClicked:r=>{a("sharing_export_download_json_clicked",r)},exportCopyJsonClicked:r=>{a("sharing_export_copy_json_clicked",r)},exportSaveJsonClicked:r=>{a("sharing_export_save_json_clicked",r)},exportViewJsonClicked:r=>{a("sharing_export_view_json_clicked",r)},generatePublicDashboardUrlClicked:r=>{a("sharing_public_generate_url_clicked",r)},revokePublicDashboardEmailClicked:r=>{a("sharing_public_email_revoke_clicked",r)},resendPublicDashboardEmailClicked:r=>{a("sharing_public_email_resend_clicked",r)},publicDashboardEmailInviteClicked:r=>{a("sharing_public_email_invite_clicked",r)},publicDashboardShareTypeChange:r=>{a("sharing_public_can_view_clicked",r)},publicDashboardTimeSelectionChanged:r=>{a("sharing_public_time_picker_clicked",r)},publicDashboardAnnotationsSelectionChanged:r=>{a("sharing_public_annotations_clicked",r)},publicDashboardUrlCopied:r=>{a("sharing_public_copy_url_clicked",r)},publicDashboardPauseSharingClicked:r=>{a("sharing_public_pause_clicked",r)},revokePublicDashboardClicked:r=>{a("sharing_public_revoke_clicked",r)},emptyDashboardButtonClicked:r=>{a("emptydashboard_clicked",r)},toolbarAddButtonClicked:r=>{a("toolbar_add_clicked",r)},setScenesContext:()=>(n=!0,()=>{n=!1})},a=(r,g)=>{const i=n?{scenesView:!0}:{};g?(0,t.rR)(`dashboards_${r}`,{...g,...i}):(0,t.rR)(`dashboards_${r}`)}},99246:(G,R,e)=>{"use strict";e.d(R,{C:()=>t,Y:()=>n});const t={left:[],right:[]};function n(s,a){t[s].push(a)}},11982:(G,R,e)=>{"use strict";e.d(R,{Lp:()=>m,Uu:()=>o,e0:()=>h,r7:()=>c,uZ:()=>d});var t=e(76885),n=e(71733),s=e(39601),a=e(32264),r=e(84537),g=e(10096),i=e(87490),l=e(74730);function d(u){let p=`/d/${u.uid}`;u.uid||(p="/dashboard/new"),u.soloRoute&&(p=`/d-solo/${u.uid}`),u.slug&&(p+=`/${u.slug}`),u.subPath&&(p+=u.subPath),u.render&&(p="/render"+p,u.updateQuery={...u.updateQuery,width:1e3,height:500,tz:u.timeZone}),u.isHomeDashboard&&(p="/");const f=u.currentQueryParams?(0,s.SE)(u.currentQueryParams):{};if(delete f.shareView,u.updateQuery)for(const x in u.updateQuery)u.updateQuery[x]===null||u.updateQuery[x]===void 0?delete f[x]:f[x]=u.updateQuery[x];const y=t.kM.renderUrl(p,f);return u.absolute?a.$.appUrl+y.slice(1):y}function c(u){return n.I.getUrlForPartial(s.Ny.getLocation(),{viewPanel:u.state.key,editPanel:void 0})}function h(u){return n.I.getUrlForPartial(s.Ny.getLocation(),{editPanel:u,viewPanel:void 0})}function o(u,p){const f=u.state.key?.replace("-view","");return n.I.getUrlForPartial(s.Ny.getLocation(),{inspect:f,inspectTab:p})}function m(u){const p=u.getPlugin(),f=(0,l.un)(u);if(!g.TP.hasAccessToExplore()||p?.meta.skipDataQuery||!f)return Promise.resolve(void 0);const y=r.jh.getTimeRange(u);return(0,i.Xe)({queries:f.state.queries,dsRef:f.state.datasource,timeRange:y.state.value,scopedVars:{__sceneObject:{value:u}},adhocFilters:f.state.data?.request?.filters})}},74730:(G,R,e)=>{"use strict";e.d(R,{Cs:()=>u,M6:()=>I,ME:()=>O,O8:()=>S,SN:()=>T,Sm:()=>v,X0:()=>y,XA:()=>m,YQ:()=>C,a7:()=>x,bx:()=>P,iL:()=>M,pk:()=>E,sw:()=>h,un:()=>D,vL:()=>p,vm:()=>o,xz:()=>b});var t=e(22391),n=e(19347),s=e(84537),a=e(81515),r=e(39820),g=e(55600),i=e(68435),l=e(42397),d=e(7196),c=e(32023);const h=8,o=12;function m(L){return`panel-${L}`}function u(L){return parseInt(L.state.key.replace("panel-",""),10)}function p(L,B){if(!B)return null;const j=f(L,B);if(j)return j;const A=parseInt(B,10);return isNaN(A)?null:f(L,m(A))}function f(L,B){if(!B)return null;const j=s.jh.findObject(L,A=>A.state.key===B?!0:(A instanceof s.Eb,!1));if(j){if(j instanceof s.Eb)return j;throw new Error(`Found panel with key ${B} but it was not a VizPanel`)}return null}function y(L,B){L.forEachChild(j=>{j.isActive&&(j.forceRender(),y(j,B))})}function x(L){const{value:B,text:j,options:A}=L.state;return L.hasAllValue()?{values:A.map(K=>K.value),texts:A.map(K=>K.label)}:{values:Array.isArray(B)?B:[B],texts:Array.isArray(j)?j:[j]}}function v(L){const B=L.match(/(["'])(.*?)\1|\w+/g);if(!B)return a.Ez.query?.split(",")??[];const j=new Set,A=B.reduce((K,W)=>{const U=W.replace(/["']+/g,"");return U.startsWith("$__auto_interval_")||K.add(U),K},j);return Array.from(A)}function P(L){return Array.isArray(L)?L.join(","):""}function E(L,B){const j=Array.isArray(L.current.value)?L.current.value[0]:L.current.value;return j.startsWith("$__auto_interval_")?"$__auto":B.includes(j)?j:B[0]}function D(L){if(!L)return;const B=L.state.$data??L.parent?.state.$data;if(B instanceof s.dt)return B;if(B instanceof s.Es)return D(B)}function C(L){const B=L.getRoot();if(B instanceof g.H$)return B;throw new Error("SceneObject root is not a DashboardScene")}function b(L){return L instanceof s.Eb?L:L.parent?b(L.parent):null}function T(L){return L.includes("clone")}function S(L){const B=c.b4.getNextPanelId(L);return new s.Eb({title:"Panel Title",key:m(B),pluginId:"timeseries",titleItems:[new l.$({menu:new l.m({})})],hoverHeaderOffset:0,menu:new s.Lw({$behaviors:[d._i]}),$data:new s.Es({$data:new s.dt({queries:[{refId:"A"}],datasource:(0,t.p$)((0,n.l)().getInstanceSettings(null)),$behaviors:[new r.L({})]}),transformations:[]})})}function O(L){return M(L)!==void 0}function M(L){const B=L.state.$behaviors?.find(j=>j instanceof i.u);if(B)return B}function I(L){let B,j;return L.isActive?B:(L.parent&&(j=I(L.parent)),B=L.activate(),()=>{j?.(),B()})}},28676:(G,R,e)=>{"use strict";e.d(R,{n:()=>c});var t=e(17172),n=e(32264),s=e(2468),a=e(48814),r=e(6473),g=e(53001);class i{constructor(){}saveDashboard(m){return r.t.ignoreNextSave(),(0,t.AI)().post("/api/dashboards/db/",{dashboard:m.dashboard,message:m.message??"",overwrite:m.overwrite??!1,folderUid:m.folderUid})}deleteDashboard(m,u){return(0,t.AI)().delete(`/api/dashboards/uid/${m}`,{showSuccessAlert:u})}getDashboardDTO(m){const u=n.$.featureToggles.passScopeToDashboardApi?(0,g.F_)():[],p=u.length>0?{scopes:u}:void 0;return(0,t.AI)().get(`/api/dashboards/uid/${m}`,p)}}class l{constructor(){this.client=new s.w({group:"dashboard.grafana.app",version:"v0alpha1",resource:"dashboards"})}saveDashboard(m){const u=m.dashboard,p={metadata:{...m?.k8s},spec:{...u}};return m.message?p.metadata.annotations={...p.metadata.annotations,[a.fY]:m.message}:p.metadata.annotations&&delete p.metadata.annotations[a.fY],m.folderUid&&(p.metadata.annotations={...p.metadata.annotations,[a.ew]:m.folderUid}),u.uid?(p.metadata.name=u.uid,this.client.update(p).then(f=>this.asSaveDashboardResponseDTO(f))):this.client.create(p).then(f=>this.asSaveDashboardResponseDTO(f))}asSaveDashboardResponseDTO(m){return{uid:m.metadata.name,version:m.spec.version??0,id:m.spec.id??0,status:"success",slug:"",url:""}}deleteDashboard(m,u){return this.client.delete(m).then(p=>({id:0,message:p.message,title:"deleted"}))}async getDashboardDTO(m){const u=await this.client.subresource(m,"dto");return{meta:{...u.access,isNew:!1,isFolder:!1,uid:u.metadata.name,k8s:u.metadata},dashboard:u.spec}}}let d;function c(){return d||(d=n.$.featureToggles.kubernetesDashboards?new l:new i),d}function h(o){throw new Error("dashboardAPI can be only overridden in test environment")}},72686:(G,R,e)=>{"use strict";e.d(R,{$L:()=>P,AK:()=>D,Bs:()=>u,NA:()=>E,NY:()=>v,Sm:()=>m,T2:()=>f,U9:()=>p,_e:()=>x,bN:()=>y,eq:()=>T,ft:()=>S,g9:()=>b,kd:()=>C});var t=e(75816),n=e(75505),s=e(17172),a=e(32264),r=e(82467),g=e(3169),i=e(8484),l=e(72254),d=e(55600);function c(O){return typeof O=="object"&&O!=null&&"error"in O}const h=({baseUrl:O})=>async M=>{try{const{data:I,...L}=await(0,n.s)((0,s.AI)().fetch({...M,url:O+M.url,showErrorAlert:M.showErrorAlert}));return{data:I,meta:L}}catch(I){return M.manageError?M.manageError(I):{error:I}}},o=O=>({error:(0,s.NF)(O)&&O.data.messageId!=="publicdashboards.notFound"?O:null}),m=(0,t.xP)({reducerPath:"publicDashboardApi",baseQuery:h({baseUrl:"/api"}),tagTypes:["PublicDashboard","AuditTablePublicDashboard","UsersWithActiveSessions","ActiveUserDashboards"],refetchOnMountOrArgChange:!0,endpoints:O=>({getPublicDashboard:O.query({query:M=>({url:`/dashboards/uid/${M}/public-dashboards`,manageError:o,showErrorAlert:!1}),async onQueryStarted(M,{dispatch:I,queryFulfilled:L}){try{await L}catch(B){c(B)&&(0,s.NF)(B.error)&&I((0,r.dx)((0,g.gi)(B.error.data.message)))}},providesTags:(M,I,L)=>[{type:"PublicDashboard",id:L}]}),createPublicDashboard:O.mutation({query:M=>({url:`/dashboards/uid/${M.dashboard instanceof d.H$?M.dashboard.state.uid:M.dashboard.uid}/public-dashboards`,method:"POST",data:M.payload}),async onQueryStarted({dashboard:M,payload:{share:I}},{dispatch:L,queryFulfilled:B}){const{data:j}=await B;let A=(0,i.t)("public-dashboard.sharing.success-creation","Dashboard is public!");a.$.featureToggles.newDashboardSharingComponent&&(A=I===l.Xo.PUBLIC?(0,i.t)("public-dashboard.public-sharing.success-creation","Your dashboard is now publicly accessible"):(0,i.t)("public-dashboard.email-sharing.success-creation","Your dashboard is ready for external sharing")),L((0,r.dx)((0,g.tZ)(A))),M instanceof d.H$?M.setState({meta:{...M.state.meta,publicDashboardEnabled:j.isEnabled}}):M.updateMeta({publicDashboardEnabled:j.isEnabled})},invalidatesTags:(M,I,{dashboard:L})=>[{type:"PublicDashboard",id:L instanceof d.H$?L.state.uid:L.uid}]}),updatePublicDashboard:O.mutation({query:({payload:M,dashboard:I})=>({url:`/dashboards/uid/${I instanceof d.H$?I.state.uid:I.uid}/public-dashboards/${M.uid}`,method:"PATCH",data:M}),async onQueryStarted({dashboard:M},{dispatch:I,queryFulfilled:L}){await L,I((0,r.dx)((0,g.tZ)(a.$.featureToggles.newDashboardSharingComponent?(0,i.t)("public-dashboard.configuration.success-update","Settings have been successfully updated"):(0,i.t)("public-dashboard.configuration.success-update-old","Public dashboard updated!"))))},invalidatesTags:(M,I,{payload:L})=>[{type:"PublicDashboard",id:L.dashboardUid},"AuditTablePublicDashboard"]}),pauseOrResumePublicDashboard:O.mutation({query:({payload:M,dashboard:I})=>({url:`/dashboards/uid/${I instanceof d.H$?I.state.uid:I.uid}/public-dashboards/${M.uid}`,method:"PATCH",data:M}),async onQueryStarted({dashboard:M,payload:{isEnabled:I}},{dispatch:L,queryFulfilled:B}){const{data:j}=await B;let A=(0,i.t)("public-dashboard.configuration.success-update-old","Public dashboard updated!");a.$.featureToggles.newDashboardSharingComponent&&(A=I?(0,i.t)("public-dashboard.configuration.success-resume","Your dashboard access has been resumed"):(0,i.t)("public-dashboard.configuration.success-pause","Your dashboard access has been paused")),L((0,r.dx)((0,g.tZ)(A))),M instanceof d.H$?M.setState({meta:{...M.state.meta,publicDashboardEnabled:j.isEnabled}}):M.updateMeta?.({publicDashboardEnabled:j.isEnabled})},invalidatesTags:(M,I,{payload:L})=>[{type:"PublicDashboard",id:L.dashboardUid},"AuditTablePublicDashboard"]}),updatePublicDashboardAccess:O.mutation({query:({payload:M,dashboard:I})=>({url:`/dashboards/uid/${I instanceof d.H$?I.state.uid:I.uid}/public-dashboards/${M.uid}`,method:"PATCH",data:M}),async onQueryStarted({dashboard:M,payload:{share:I}},{dispatch:L,queryFulfilled:B}){await B;let j=(0,i.t)("public-dashboard.configuration.success-update-old","Public dashboard updated!");a.$.featureToggles.newDashboardSharingComponent&&(j=I===l.Xo.PUBLIC?(0,i.t)("public-dashboard.public-sharing.success-share-type-change","Dashboard access updated: Anyone with the link can now access"):(0,i.t)("public-dashboard.email-sharing.success-share-type-change","Dashboard access updated: Only specific people can now access with the link")),L((0,r.dx)((0,g.tZ)(j)))},invalidatesTags:(M,I,{payload:L})=>[{type:"PublicDashboard",id:L.dashboardUid},"AuditTablePublicDashboard"]}),addRecipient:O.mutation({query:()=>({url:""})}),deleteRecipient:O.mutation({query:()=>({url:""})}),reshareAccessToRecipient:O.mutation({query:()=>({url:""})}),getActiveUsers:O.query({query:()=>({url:"/"}),providesTags:["UsersWithActiveSessions"]}),getActiveUserDashboards:O.query({query:()=>({url:""}),providesTags:(M,I,L)=>[{type:"ActiveUserDashboards",id:L}]}),listPublicDashboards:O.query({query:(M=1)=>({url:`/dashboards/public-dashboards?page=${M}&perpage=8`}),transformResponse:M=>({...M,totalPages:Math.ceil(M.totalCount/M.perPage)}),providesTags:["AuditTablePublicDashboard"]}),deletePublicDashboard:O.mutation({query:M=>({url:`/dashboards/uid/${M.dashboardUid}/public-dashboards/${M.uid}`,method:"DELETE"}),async onQueryStarted({dashboard:M},{dispatch:I,queryFulfilled:L}){await L,I((0,r.dx)((0,g.tZ)(a.$.featureToggles.newDashboardSharingComponent?(0,i.t)("public-dashboard.share.success-delete","Your dashboard is no longer shareable"):(0,i.t)("public-dashboard.share.success-delete-old","Public dashboard deleted!")))),I(m.util?.resetApiState()),M instanceof d.H$?M.setState({meta:{...M.state.meta,publicDashboardEnabled:!1}}):M?.updateMeta({publicDashboardEnabled:!1})},invalidatesTags:(M,I,{dashboardUid:L})=>[{type:"PublicDashboard",id:L},"AuditTablePublicDashboard","UsersWithActiveSessions","ActiveUserDashboards"]}),revokeAllAccess:O.mutation({query:()=>({url:""})})})}),{useGetPublicDashboardQuery:u,useCreatePublicDashboardMutation:p,useUpdatePublicDashboardMutation:f,useDeletePublicDashboardMutation:y,useListPublicDashboardsQuery:x,useAddRecipientMutation:v,useDeleteRecipientMutation:P,useReshareAccessToRecipientMutation:E,useGetActiveUsersQuery:D,useGetActiveUserDashboardsQuery:C,useRevokeAllAccessMutation:b,usePauseOrResumePublicDashboardMutation:T,useUpdatePublicDashboardAccessMutation:S}=m},15858:(G,R,e)=>{"use strict";e.d(R,{M:()=>h});var t=e(2543),n=e(12470),s=e(19347),a=e(2913),r=e(57767),g=e(75096),i=e(82792),l=e(98796),d=e(24240);function c(o){return!!(o.libraryPanel?.name&&o.libraryPanel?.uid)}class h{async makeExportable(m){m.cleanUpRepeats();const u=m.getSaveModelCloneOld();u.id=null,m.processRepeats();const p=[],f={},y={},x={},v=new Map;for(const C of u.getVariables())x[C.name]=C;const P=(C,b)=>{if(C.datasource===void 0){C.datasource=b;return}let T=C.datasource,S=null;const O=T?.uid,M=O&&g.SY.exec(O);if(M){const I=M[1]||M[2]||M[4];S=x[I],S&&S.current&&(T=S.current.value)}return(0,s.l)().get(T).then(I=>{if(I.meta?.builtIn||(f["datasource"+I.meta?.id]={type:"datasource",id:I.meta.id,name:I.meta.name,version:I.meta.info.version||"1.0.0"},S))return;const L=C.libraryPanel,B=L?"-for-library-panel":"";let j="DS_"+I.name.replace(" ","_").toUpperCase()+B.toUpperCase();if(y[j]={name:j,label:I.name,description:"",type:"datasource",pluginId:I.meta?.id,pluginName:I.meta?.name,usage:y[j]?.usage},L){const A=y[j]?.usage?.libraryPanels||[];A.push({name:L.name,uid:L.uid}),y[j].usage={libraryPanels:A}}C.datasource={type:I.meta.id,uid:"${"+j+"}"}})},E=async C=>{if(C.type!=="row"){if(await P(C),C.targets)for(const T of C.targets)await P(T,C.datasource);const b=a.Ay.panels[C.type];b&&(f["panel"+b.id]={type:"panel",id:b.id,name:b.name,version:b.info.version})}},D=async C=>{if((0,i.X)(C)){const{name:b,uid:T}=C.libraryPanel;let S=C.libraryPanel.model;S||(S=(await(0,r.Yr)(T,!0)).model),await P(S);const{gridPos:O,id:M,...I}=S;v.has(T)||v.set(T,{name:b,uid:T,kind:l.i.Panel,model:I})}};try{for(const T of u.panels)if(await E(T),T.collapsed!==void 0&&T.collapsed===!0&&T.panels)for(const S of T.panels)await E(S);for(const T of u.getVariables())T.type==="query"?(await P(T),T.options=[],T.current={},T.refresh=T.refresh!==n.CO.never?T.refresh:n.CO.onDashboardLoad):T.type==="datasource"&&(T.current={});for(const T of u.annotations.list)await P(T);f.grafana={type:"grafana",id:"grafana",name:"Grafana",version:a.Ay.buildInfo.version};for(const T of u.panels)if(await D(T),T.collapsed!==void 0&&T.collapsed===!0&&T.panels)for(const S of T.panels)await D(S);(0,t.each)(y,T=>{p.push(T)});for(const T of u.getVariables())if((0,d.VO)(T)){const S="VAR_"+T.name.replace(" ","_").toUpperCase();p.push({name:S,type:"constant",label:T.label||T.name,value:T.query,description:""}),T.query="${"+S+"}",T.current={value:T.query,text:T.query,selected:!1},T.options=[T.current]}const C=[...v.entries()].reduce((T,[S,O])=>(T[S]=O,T),{}),b=(0,t.defaults)({__inputs:p,__elements:C,__requires:(0,t.sortBy)(f,["id"])},u);for(let T=0;T<b.panels.length;T++){const S=b.panels[T];c(S)&&(b.panels[T]={gridPos:S.gridPos,id:S.id,libraryPanel:{uid:S.libraryPanel.uid,name:S.libraryPanel.name}})}return b}catch(C){return console.error("Export failed:",C),{error:C}}}}},20120:(G,R,e)=>{"use strict";e.d(R,{UP:()=>ne,fP:()=>le,Ay:()=>de});var t=e(74848),n=e(96540),s=e(32196),a=e(71468),r=e(54148),g=e(80997),i=e(13544),l=e(39601),d=e(69731),c=e(96374),h=e(39938),o=e(19727),m=e(27746),u=e(71678),p=e(15068),f=e(82467),y=e(10804),x=e(2913),v=e(3169),P=e(10096),E=e(16021),D=e(8484),C=e(91219),b=e(28215),T=e(83122),S=e(55852),O=e(14578),M=e(32264),I=e(38138),L=e(36974),B=e(7758),j=e(31678),A=e(28601);const W=({dashboard:ce})=>{const pe=(0,n.useMemo)(()=>(0,L._u)(),[]),xe=(0,j.useDispatch)(),fe=(0,j.useSelector)(Ee=>Ee.dashboard.initialDatasource);return(0,t.jsxs)(I.W,{children:[(0,t.jsx)(I.W.Item,{testId:i.Tp.pages.AddDashboard.itemButton("Add new visualization menu item"),label:(0,D.t)("dashboard.add-menu.visualization","Visualization"),onClick:()=>{const Ee=(0,L.OK)(ce,fe);B.c.toolbarAddButtonClicked({item:"add_visualization"}),l.Ny.partial({editPanel:Ee}),xe((0,A.Ub)(void 0))}},"add-visualisation"),M.$.featureToggles.vizAndWidgetSplit&&(0,t.jsx)(I.W.Item,{testId:i.Tp.pages.AddDashboard.itemButton("Add new widget menu item"),label:(0,D.t)("dashboard.add-menu.widget","Widget"),onClick:()=>{B.c.toolbarAddButtonClicked({item:"add_widget"}),l.Ny.partial({addWidget:!0})}},"add-widget"),(0,t.jsx)(I.W.Item,{testId:i.Tp.pages.AddDashboard.itemButton("Add new row menu item"),label:(0,D.t)("dashboard.add-menu.row","Row"),onClick:()=>{B.c.toolbarAddButtonClicked({item:"add_row"}),(0,L.SD)(ce)}},"add-row"),(0,t.jsx)(I.W.Item,{testId:i.Tp.pages.AddDashboard.itemButton("Add new panel from panel library menu item"),label:(0,D.t)("dashboard.add-menu.import","Import from library"),onClick:()=>{B.c.toolbarAddButtonClicked({item:"import_from_library"}),(0,L.s3)(ce)}},"add-panel-lib"),(0,t.jsx)(I.W.Item,{testId:i.Tp.pages.AddDashboard.itemButton("Add new panel from clipboard menu item"),label:(0,D.t)("dashboard.add-menu.paste-panel","Paste panel"),onClick:()=>{B.c.toolbarAddButtonClicked({item:"paste_panel"}),(0,L.no)(ce,pe)},disabled:!pe},"add-panel-clipboard")]})},F=({dashboard:ce,onToolbarAddMenuOpen:pe})=>{const[xe,fe]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{xe&&pe&&pe()},[xe,pe]),(0,t.jsx)(T.m,{overlay:()=>(0,t.jsx)(W,{dashboard:ce}),placement:"bottom",offset:[0,6],onVisibleChange:fe,children:(0,t.jsxs)(S.$n,{variant:"secondary",size:"sm",fill:"outline","data-testid":i.Tp.components.PageToolbar.itemButton("Add button"),children:[(0,t.jsx)(D.x6,{i18nKey:"dashboard.toolbar.add",children:"Add"}),(0,t.jsx)(O.I,{name:xe?"angle-up":"angle-down",size:"lg"})]})})};var V=e(70497),w=e(14792),z=e(2609),N=e(81862),H=e(28444),Q=e(99246),X=e(93030),ee=e(62367),Z=e(22699);const q=({dashboard:ce})=>(0,t.jsx)(S.$n,{"data-testid":i.Tp.pages.Dashboard.DashNav.shareButton,variant:"primary",size:"sm",onClick:()=>{B.c.toolbarShareClick(),l.Ny.partial({shareView:Z.wr.link})},children:(0,t.jsx)(D.x6,{i18nKey:"dashboard.toolbar.share-button",children:"Share"})}),ae={removeNavIndex:b.Im,setStarred:C.ci,updateTimeZoneForSession:N.Cj,updateNavIndex:f.Vz},k=ce=>({navIndex:ce.navIndex}),se=(0,a.connect)(k,ae),te=i.Tp.pages.Dashboard.DashNav;function ne(ce){(0,Q.Y)("left",ce)}function le(ce){(0,Q.Y)("right",ce)}const re=(0,n.memo)(ce=>{(0,r.zy)();const pe=(0,d.C)(),xe=x.Ay.featureToggles.singleTopNav;(0,E.u)(ce.dashboard.events,H.Cf);const fe=ce.dashboard.snapshot?.originalUrl??"",Ee=()=>{window.location.href=g.sQ.sanitizeUrl(ce.dashboard.snapshot.originalUrl)},Se=(0,v._2)(),ye=()=>{try{const It=new URL(g.sQ.sanitizeUrl(fe),x.Ay.appUrl),ge=new URL(x.Ay.appUrl);It.host!==ge.host?P.lE.publish(new H.S8({component:c.u,props:{title:"Proceed to external site?",modalClass:oe,body:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{children:["This link connects to an external website at"," ",(0,t.jsx)("code",{children:fe})]}),(0,t.jsx)("p",{children:"Are you sure you'd like to proceed?"})]}),confirmVariant:"primary",confirmText:"Proceed",onConfirm:Ee}})):Ee()}catch(It){Se.error("Invalid URL",It instanceof Error?It.message:void 0)}},Ve=()=>{B.c.toolbarFavoritesClick();const It=(0,w.UA)(),{dashboard:ge,navIndex:Ie,removeNavIndex:ue,setStarred:me,updateNavIndex:Pe}=ce;It.starDashboard(ge.uid,!!ge.meta.isStarred).then(Ne=>{me({id:ge.uid,title:ge.title,url:ge.meta.url??"",isStarred:Ne});const Fe=Ie.starred;if(Ne)Fe.children?.push({id:C.L1+ge.uid,text:ge.title,url:ge.meta.url??"",parentItem:Fe});else{ue(C.L1+ge.uid);const Be=Fe.children?.findIndex(he=>he.id===C.L1+ge.uid);Be&&Fe.children?.splice(Be,1)}Pe(Fe),ge.meta.isStarred=Ne,pe()})},Me=()=>{B.c.toolbarSettingsClick(),l.Ny.partial({editview:"settings"})},Ce=()=>{z._o.prev()},Ue=()=>{z._o.next()},Ae=()=>{z._o.stop(),pe()},we=(It,ge)=>{It.map((Ie,ue)=>{const me=Ie.component,Pe=(0,n.createElement)(me,{...ce,key:`button-custom-${ue}`});typeof Ie.index=="number"?ge.splice(Ie.index,0,Pe):ge.push(Pe)})},We=()=>z._o.state.isPlaying,_e=()=>{const It=x.Ay.buildInfo.env==="development",{dashboard:ge,kioskMode:Ie}=ce,{canStar:ue,isStarred:me}=ge.meta,Pe=[];if(Ie||We())return[];if(ue){let Ne=me?(0,D.t)("dashboard.toolbar.unmark-favorite","Unmark as favorite"):(0,D.t)("dashboard.toolbar.mark-favorite","Mark as favorite");Pe.push((0,t.jsx)(X._,{tooltip:Ne,icon:me?"favorite":"star",iconType:me?"mono":"default",iconSize:"lg",onClick:Ve},"button-star"))}return ge.meta.publicDashboardEnabled&&Pe.push((0,t.jsx)(h.E,{color:"blue",text:"Public",className:J,"data-testid":te.publicDashboardTag},"public-dashboard-button-badge")),It&&x.Ay.featureToggles.dashboardScene&&Pe.push((0,t.jsx)(X._,{tooltip:"View as Scene",icon:"apps",onClick:()=>{l.Ny.partial({scenes:!0})}},"button-scenes")),we(Q.C.left,Pe),Pe},at=()=>(0,t.jsxs)(o.e,{children:[(0,t.jsx)(m.I,{tooltip:(0,D.t)("dashboard.toolbar.playlist-previous","Go to previous dashboard"),icon:"backward",onClick:Ce,narrow:!0}),(0,t.jsx)(m.I,{onClick:Ae,children:(0,t.jsx)(D.x6,{i18nKey:"dashboard.toolbar.playlist-stop",children:"Stop playlist"})}),(0,t.jsx)(m.I,{tooltip:(0,D.t)("dashboard.toolbar.playlist-next","Go to next dashboard"),icon:"forward",onClick:Ue,narrow:!0})]},"playlist-buttons"),ut=()=>{const{dashboard:It,updateTimeZoneForSession:ge,hideTimePicker:Ie}=ce;return Ie?null:(0,t.jsx)(ee.$,{dashboard:It,onChangeTimeZone:ge},"time-controls")},Tt=()=>{const{dashboard:It,isFullscreen:ge,kioskMode:Ie,hideTimePicker:ue}=ce,{canSave:me,canEdit:Pe,showSettings:Ne,canShare:Fe}=It.meta,{snapshot:Be}=It,he=Be&&Be.originalUrl,be=[];return We()?[at(),ut()]:Ie===j.KioskMode.TV?[ut()]:(he&&be.push((0,t.jsx)(m.I,{tooltip:(0,D.t)("dashboard.toolbar.open-original","Open original dashboard"),onClick:ye,icon:"link"},"button-snapshot")),me&&!ge&&be.push((0,t.jsx)(u.$s,{children:({showModal:Ke,hideModal:ze})=>(0,t.jsx)(m.I,{tooltip:(0,D.t)("dashboard.toolbar.save","Save dashboard"),icon:"save",onClick:()=>{Ke(V.$,{dashboard:It,onDismiss:ze})}})},"button-save")),we(Q.C.right,be),Ne&&be.push((0,t.jsx)(m.I,{tooltip:(0,D.t)("dashboard.toolbar.settings","Dashboard settings"),icon:"cog",onClick:Me},"button-settings")),Pe&&!ge&&be.push((0,t.jsx)(F,{onToolbarAddMenuOpen:B.c.toolbarAddClick,dashboard:It},"panel-add-dropdown")),Fe&&be.push((0,t.jsx)(q,{dashboard:It},"button-share")),ue||be.push((0,t.jsx)(y.K,{},"toolbar-separator")),be.push(ut()),be)};return(0,t.jsxs)(t.Fragment,{children:[_e(),!xe&&(0,t.jsx)(y.K,{leftActionsSeparator:!0}),(0,t.jsx)(p.U,{alignment:"right",children:Tt()})]})});re.displayName="DashNav";const de=se(re),oe=(0,s.css)({width:"max-content",maxWidth:"80vw"}),J=(0,s.css)({color:"grey",backgroundColor:"transparent",border:"1px solid"})},93030:(G,R,e)=>{"use strict";e.d(R,{_:()=>r});var t=e(74848),n=e(32196),s=e(40845),a=e(29158);const r=({icon:i,iconType:l,iconSize:d,tooltip:c,onClick:h,children:o})=>{const m=(0,s.of)(g);return(0,t.jsxs)("div",{className:m.noBorderContainer,children:[i&&(0,t.jsx)(a.K,{name:i,size:d,iconType:l,tooltip:c,tooltipPlacement:"bottom",onClick:h}),o]})},g=i=>({noBorderContainer:(0,n.css)({padding:`0 ${i.spacing(.5)}`,display:"flex"})})},62367:(G,R,e)=>{"use strict";e.d(R,{$:()=>o});var t=e(74848),n=e(96540),s=e(85858),a=e(3591),r=e(11134),g=e(25573),i=e(10096),l=e(8484),d=e(16233),c=e(74856),h=e(28444);class o extends n.Component{constructor(){super(...arguments),this.onChangeRefreshInterval=u=>{(0,c.jG)().setAutoRefresh(u),this.forceUpdate()},this.onRefresh=()=>((0,c.jG)().refreshTimeModel(),Promise.resolve()),this.onMoveBack=()=>{i.lE.publish(new h.Io({direction:h.xL.Left}))},this.onMoveForward=()=>{i.lE.publish(new h.Io({direction:h.xL.Right}))},this.onChangeTimePicker=u=>{const{dashboard:p}=this.props,f=p.timepicker,y=f.nowDelay&&u.raw.to==="now",x=s.isMathString(u.raw.from)?u.raw.from:u.from,v=s.isMathString(u.raw.to)?u.raw.to:u.to,P={from:x,to:y?"now-"+f.nowDelay:v};(0,c.jG)().setTime(P)},this.onChangeTimeZone=u=>{this.props.dashboard.timezone=u,this.props.onChangeTimeZone(u),this.onRefresh()},this.onChangeFiscalYearStartMonth=u=>{this.props.dashboard.fiscalYearStartMonth=u,this.onRefresh()},this.onZoom=()=>{this.props.onToolbarZoomClick&&this.props.onToolbarZoomClick(),i.lE.publish(new h.U0({scale:2}))},this.onRefreshClick=()=>{this.props.onToolbarRefreshClick&&this.props.onToolbarRefreshClick(),this.onRefresh()}}componentDidMount(){this.sub=this.props.dashboard.events.subscribe(a.sR,()=>this.forceUpdate())}componentWillUnmount(){this.sub?.unsubscribe()}render(){const{dashboard:u,isOnCanvas:p}=this.props,{refresh_intervals:f}=u.timepicker,y=(0,c.jG)().getValidIntervals(f||r.cb),x=(0,c.jG)().timeRange(),v=u.getTimezone(),P=u.fiscalYearStartMonth,E=u.panelInEdit?.isEditing,D=u.weekStart;let C;return u.refresh===d.SM&&(C=(0,c.jG)().getAutoRefreshInteval().interval),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.m,{value:x,onChange:this.onChangeTimePicker,timeZone:v,fiscalYearStartMonth:P,onMoveBackward:this.onMoveBack,onMoveForward:this.onMoveForward,onZoom:this.onZoom,onChangeTimeZone:this.onChangeTimeZone,onChangeFiscalYearStartMonth:this.onChangeFiscalYearStartMonth,isOnCanvas:p,onToolbarTimePickerClick:this.props.onToolbarTimePickerClick,weekStart:D}),(0,t.jsx)(r.cC,{onIntervalChanged:this.onChangeRefreshInterval,onRefresh:this.onRefreshClick,value:u.refresh,intervals:y,isOnCanvas:p,tooltip:(0,l.t)("dashboard.toolbar.refresh","Refresh dashboard"),noIntervalPicker:E,showAutoInterval:!0,text:C})]})}}},46991:(G,R,e)=>{"use strict";e.d(R,{d:()=>r});var t=e(74848),n=e(32196),s=e(40845),a=e(55852);const r=({children:i,...l})=>{const d=(0,s.of)(g);return(0,t.jsx)("div",{className:d.buttonWrapper,children:(0,t.jsx)(a.$n,{icon:"plus",...l,children:i})})},g=i=>({buttonWrapper:(0,n.css)({padding:`${i.spacing(3)} 0`})})},75590:(G,R,e)=>{"use strict";e.d(R,{p:()=>x});var t=e(74848),n=e(2543),s=e(96540),a=e(65879),r=e(13544),g=e(57418),i=e(88575),l=e(20333),d=e(15648),c=e(10354),h=e(15292),o=e(8484),m=e(11134),u=e(74856);const p=({refreshIntervals:v,onRefreshIntervalChange:P,getIntervalsFunc:E=y,validateIntervalsFunc:D=f})=>{const[C,b]=(0,s.useState)(E(v??m.cb)),[T,S]=(0,s.useState)(null);(0,s.useEffect)(()=>{const L=E(v??m.cb);b(L)},[E,v]);const O=(0,s.useMemo)(()=>Array.isArray(C)?C.join(","):"",[C]),M=(0,s.useCallback)(L=>{const B=L.currentTarget.value?L.currentTarget.value.split(","):[];b(B)},[b]),I=(0,s.useCallback)(L=>{const B=D(C);B===null&&P(E(C)),S(B)},[E,C,P,D]);return(0,t.jsx)(i.D,{label:(0,o.t)("dashboard-settings.general.auto-refresh-label","Auto refresh"),description:(0,o.t)("dashboard-settings.general.auto-refresh-description","Define the auto refresh intervals that should be available in the auto refresh list. Use the format '5s' for seconds, '1m' for minutes, '1h' for hours, and '1d' for days (e.g.: '5s,10s,30s,1m,5m,15m,30m,1h,2h,1d')."),error:T,invalid:!!T,children:(0,t.jsx)(c.p,{id:"auto-refresh-input",invalid:!!T,value:O,onChange:M,onBlur:I})})},f=(v,P={getTimeSrv:u.jG})=>{try{return y(v,P),null}catch(E){return E instanceof Error?E.message:"Invalid intervals"}},y=(v,P={getTimeSrv:u.jG})=>{const E=v.filter(D=>D.trim()!=="").map(D=>D.replace(/\s+/g,""));return[...new Set(P.getTimeSrv().getValidIntervals(E))]};class x extends s.PureComponent{constructor(){super(...arguments),this.state={isNowDelayValid:!0},this.onNowDelayChange=P=>{const E=P.currentTarget.value;if((0,n.isEmpty)(E))return this.setState({isNowDelayValid:!0}),this.props.onNowDelayChange(E);if(a.isValidTimeSpan(E))return this.setState({isNowDelayValid:!0}),this.props.onNowDelayChange(E);this.setState({isNowDelayValid:!1})},this.onHideTimePickerChange=()=>{this.props.onHideTimePickerChange(!this.props.timePickerHidden)},this.onLiveNowChange=()=>{this.props.onLiveNowChange(!this.props.liveNow)},this.onTimeZoneChange=P=>{typeof P=="string"&&this.props.onTimeZoneChange(P)},this.onWeekStartChange=P=>{this.props.onWeekStartChange(P)}}render(){return(0,t.jsxs)(g.M,{label:(0,o.t)("dashboard-settings.time-picker.time-options-label","Time options"),isOpen:!0,children:[(0,t.jsx)(i.D,{label:(0,o.t)("dashboard-settings.time-picker.time-zone-label","Time zone"),"data-testid":r.Tp.components.TimeZonePicker.containerV2,children:(0,t.jsx)(l.U,{inputId:"time-options-input",includeInternal:!0,value:this.props.timezone,onChange:this.onTimeZoneChange,width:40})}),(0,t.jsx)(i.D,{label:(0,o.t)("dashboard-settings.time-picker.week-start-label","Week start"),"data-testid":r.Tp.components.WeekStartPicker.containerV2,children:(0,t.jsx)(d.l,{inputId:"week-start-input",width:40,value:this.props.weekStart,onChange:this.onWeekStartChange})}),(0,t.jsx)(p,{refreshIntervals:this.props.refreshIntervals,onRefreshIntervalChange:this.props.onRefreshIntervalChange}),(0,t.jsx)(i.D,{label:(0,o.t)("dashboard-settings.time-picker.now-delay-label","Now delay"),description:(0,o.t)("dashboard-settings.time-picker.now-delay-description","Exclude recent data that may be incomplete."),children:(0,t.jsx)(c.p,{id:"now-delay-input",invalid:!this.state.isNowDelayValid,placeholder:"0m",onChange:this.onNowDelayChange,defaultValue:this.props.nowDelay})}),(0,t.jsx)(i.D,{label:(0,o.t)("dashboard-settings.time-picker.hide-time-picker","Hide time picker"),children:(0,t.jsx)(h.d,{id:"hide-time-picker-toggle",value:!!this.props.timePickerHidden,onChange:this.onHideTimePickerChange})}),(0,t.jsx)(i.D,{label:(0,o.t)("dashboard-settings.time-picker.refresh-live-dashboards-label","Refresh live dashboards"),description:(0,o.t)("dashboard-settings.time-picker.refresh-live-dashboards-description","Continuously re-draw panels where the time range references 'now'"),children:(0,t.jsx)(h.d,{id:"refresh-live-dashboards-toggle",value:!!this.props.liveNow,onChange:this.onLiveNowChange})})]})}}},10740:(G,R,e)=>{"use strict";e.d(R,{n:()=>V,C:()=>F});var t=e(74848),n=e(32196),s=e(96540),a=e(40845),r=e(55852),g=e(94753),i=e(60782),l=e(62930),d=e(56034),c=e(42418),h=e(67061),o=e(10354),m=e(14578),u=e(72109),p=e(8484),f=e(29158);const y=({currentPage:z,numberOfPages:N,onNavigate:H,hideWhenSinglePage:Q,className:X})=>{const ee=(0,a.of)(x);return Q&&N<=1?null:(0,t.jsxs)("div",{className:(0,n.cx)(ee.wrapper,X),children:[(0,t.jsx)(f.K,{name:"angle-left",size:"md",tooltip:"Previous",onClick:()=>H(z-1),disabled:z===1}),z," of ",N,(0,t.jsx)(f.K,{name:"angle-right",size:"md",tooltip:"Next",onClick:()=>H(z+1),disabled:z===N})]})},x=z=>({wrapper:(0,n.css)({display:"flex",flexDirection:"row",gap:16,userSelect:"none"})}),v=({history:z,index:N,onNavigate:H})=>{const Q=(0,a.of)(P),X=z.length;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:Q.contentWrapper,children:(0,t.jsx)(g.E,{element:"p",color:"secondary",children:z[N-1]})}),(0,t.jsx)(y,{currentPage:N,numberOfPages:X,onNavigate:H,hideWhenSinglePage:!1,className:Q.paginationWrapper})]})},P=z=>({paginationWrapper:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"flex-end",marginTop:15}),contentWrapper:(0,n.css)({display:"flex",flexBasis:"100%",flexGrow:3,whiteSpace:"pre-wrap",maxHeight:110,overflowY:"scroll",backgroundColor:z.colors.background.secondary,border:`1px solid ${z.colors.border.weak}`,padding:z.spacing(1),minHeight:60})});var E=e(3363);const D=({onSuggestionClick:z,isGenerating:N})=>{const H=(0,a.of)(C);return(0,t.jsxs)("div",{className:H.quickSuggestionsWrapper,children:[(0,t.jsx)(r.$n,{onClick:()=>z(E.HG.Shorter),size:"sm",variant:"secondary",icon:"paragraph",disabled:N,children:E.HG.Shorter}),(0,t.jsx)(r.$n,{onClick:()=>z(E.HG.MoreDescriptive),size:"sm",variant:"secondary",icon:"document-layout-left",disabled:N,children:E.HG.MoreDescriptive}),(0,t.jsx)(r.$n,{onClick:()=>z(E.HG.Regenerate),icon:"sync",size:"sm",variant:"secondary",disabled:N,children:"Regenerate"})]})},C=z=>({quickSuggestionsWrapper:(0,n.css)({display:"flex",flexDirection:"row",gap:8})});var b=e(16817),T=e(65418),S=e(34867),O=e(3169);const M=(0,S.DW)("features.dashboards.genai");var I=(z=>(z.IDLE="idle",z.GENERATING="generating",z.COMPLETED="completed",z))(I||{});const L=1e4,B={model:E.C4,temperature:1};function j({model:z,temperature:N,onResponse:H}=B){const[Q,X]=(0,s.useState)([]),[ee,Z]=(0,s.useState)(""),[q,ae]=(0,s.useState)("idle"),[k,se]=(0,s.useState)(),{error:te}=(0,O._2)();let ne="";const le=(0,s.useCallback)(pe=>{ae("idle"),X([]),se(pe),te("Failed to generate content using OpenAI","Please try again or if the problem persists, contact your organization admin."),console.error(pe),M.logError(pe,{messages:JSON.stringify(Q),model:z,temperature:String(N)})},[Q,z,N,te]);(0,s.useEffect)(()=>{Q.length>0&&Z("")},[Q]);const{error:re,value:de}=(0,b.A)(async()=>await(0,E.QX)(),[E.QX]),{error:oe,value:J}=(0,b.A)(async()=>{if(!de||!Q.length)return{enabled:de};ae("generating"),se(void 0);const pe=T.qH({model:z,temperature:N,messages:Q}).pipe(T.qA());return{enabled:de,stream:pe.subscribe({next:xe=>{ne=xe},error:le,complete:()=>{Z(ne),ae("completed"),H?.(ne),X([]),se(void 0)}})}},[Q,de]);(0,s.useEffect)(()=>()=>{J?.stream?.unsubscribe()},[J]);const ce=(0,s.useCallback)(()=>{J?.stream?.unsubscribe(),ae("idle"),se(void 0),X([])},[J]);return(0,s.useEffect)(()=>{let pe;return q==="generating"&&ee===""&&(pe=setTimeout(()=>{le(new Error(`OpenAI stream timed out after ${L}ms`))},L)),()=>{clearTimeout(pe)}},[q,ee,le]),(oe||re)&&se(oe||re),{setMessages:X,stopGeneration:ce,messages:Q,reply:ee,streamStatus:q,error:k,value:J}}var A=e(57725);const K=.5,W=({eventTrackingSrc:z,history:N,messages:H,onApplySuggestion:Q,updateHistory:X})=>{const ee=(0,a.of)(U),[Z,q]=(0,s.useState)(1),[ae,k]=(0,s.useState)(""),se=(0,s.useCallback)(Ue=>{X((0,E.Kb)(Ue))},[X]),{setMessages:te,stopGeneration:ne,reply:le,streamStatus:re,error:de}=j({model:E.C4,temperature:K,onResponse:se}),oe=(Ue,Ae)=>(0,A.XX)(z,Ue,Ae),J=Ue=>{fe(Ue),oe(A.KR.customFeedback,{customFeedback:Ue})},ce=()=>{ne(),le&&se(le)},pe=()=>{Q(N[Z-1])},xe=Ue=>{q(Ue),oe(Ue>Z?A.KR.backHistoryItem:A.KR.forwardHistoryItem)},fe=Ue=>{te(Ae=>[...Ae,...(0,E.To)(N[Z-1],Ue)]),Ue in E.HG&&oe(A.KR.quickFeedback,{quickFeedbackItem:Ue})},Ee=Ue=>Ue.key==="Enter"&&J(ae),Se=Ue=>k(Ue.currentTarget.value),ye=()=>J(ae),Ve=()=>oe(A.KR.linkToDocs),Me=re===I.GENERATING,Ce=de&&!Me;return(0,t.jsxs)("div",{className:ee.container,children:[Ce&&(0,t.jsx)(c.F,{title:"",children:(0,t.jsx)(h.B,{direction:"column",children:(0,t.jsx)("p",{children:(0,t.jsx)(p.x6,{i18nKey:"gen-ai.incomplete-request-error",children:"Sorry, I was unable to complete your request. Please try again."})})})}),(0,t.jsx)(v,{history:N,index:Z,onNavigate:xe}),(0,t.jsx)("div",{className:ee.actionButtons,children:(0,t.jsx)(D,{onSuggestionClick:fe,isGenerating:Me})}),(0,t.jsx)(o.p,{placeholder:"Tell AI what to do next...",suffix:(0,t.jsx)(r.$n,{icon:"enter",variant:"secondary",fill:"text","aria-label":"Send custom feedback",onClick:ye,disabled:!ae,children:(0,t.jsx)(p.x6,{i18nKey:"gen-ai.send-custom-feedback",children:"Send"})}),value:ae,onChange:Se,onKeyDown:Ee}),(0,t.jsx)("div",{className:ee.applySuggestion,children:(0,t.jsx)(h.B,{justifyContent:"flex-end",direction:"row",children:Me?(0,t.jsx)(r.$n,{icon:"fa fa-spinner",onClick:ce,children:F}):(0,t.jsx)(r.$n,{icon:"check",onClick:pe,children:(0,t.jsx)(p.x6,{i18nKey:"gen-ai.apply-suggestion",children:"Apply"})})})}),(0,t.jsxs)("div",{className:ee.footer,children:[(0,t.jsx)(m.I,{name:"exclamation-circle","aria-label":"exclamation-circle",className:ee.infoColor}),(0,t.jsxs)(g.E,{variant:"bodySmall",color:"secondary",children:["This content is AI-generated using the"," ",(0,t.jsx)(u.Y,{variant:"bodySmall",inline:!0,href:"https://grafana.com/docs/grafana-cloud/alerting-and-irm/machine-learning/llm-plugin/",external:!0,onClick:Ve,children:"Grafana LLM plugin"})]})]})]})},U=z=>({container:(0,n.css)({display:"flex",flexDirection:"column",width:520,maxHeight:350,paddingBottom:25}),applySuggestion:(0,n.css)({paddingTop:z.spacing(2)}),actions:(0,n.css)({display:"flex",flexDirection:"row",flexWrap:"wrap"}),footer:(0,n.css)({position:"absolute",bottom:0,left:0,width:"100%",display:"flex",flexDirection:"row",margin:0,padding:z.spacing(1),paddingLeft:z.spacing(2),alignItems:"center",gap:z.spacing(1),borderTop:`1px solid ${z.colors.border.weak}`,marginTop:z.spacing(2)}),infoColor:(0,n.css)({color:z.colors.info.main}),actionButtons:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",padding:"24px 0 8px 0"})}),F="Stop generating",V=({text:z="Auto-generate",toggleTipTitle:N="",onClick:H,model:Q=E.C4,messages:X,onGenerate:ee,temperature:Z=1,eventTrackingSrc:q,disabled:ae,tooltip:k})=>{const se=(0,a.of)(w),[te,ne]=(0,s.useState)([]),le=(0,s.useCallback)(It=>{ne(ge=>[It,...ge])},[]),re=(0,s.useCallback)(It=>{const ge=(0,E.Kb)(It);ee(ge),le(ge)},[ee,le]),{setMessages:de,stopGeneration:oe,value:J,error:ce,streamStatus:pe}=j({model:Q,temperature:Z,onResponse:re}),[xe,fe]=(0,s.useState)(!1),Ee=te.length>0,Se=!Ee,ye=pe===I.GENERATING,Ve=ae||J&&!J.enabled&&!ce,Me=(0,s.useCallback)(It=>(0,A.XX)(q,It),[q]),Ce=ce||k?void 0:!1,Ue=ce?"Failed to generate content using OpenAI. Please try again or if the problem persists, contact your organization admin.":k||"",Ae=It=>{pe===I.GENERATING?oe():Ee?fe(!0):(H?.(It),de(ut()));const ge=ce?A.KR.erroredRetryButton:ye?A.KR.stopGenerationButton:Se?A.KR.autoGenerateButton:A.KR.improveButton;Me(ge)};if(!J?.enabled)return null;const we=It=>{Me(A.KR.applySuggestion),ee(It),fe(!1)},We=()=>{if(!ye)return ce||J&&!J.enabled?"exclamation-circle":"ai"},_e=()=>{let It=z;return ce&&(It="Retry"),ye&&(It=F),Ee&&(It="Improve"),It},at=(0,t.jsx)(r.$n,{icon:We(),onClick:Ae,fill:"text",size:"sm",disabled:Ve,variant:ce?"destructive":"primary",children:_e()}),ut=()=>typeof X=="function"?X():X,Tt=()=>{if(Ee){const It=(0,t.jsx)(g.E,{element:"p",children:N});return(0,t.jsx)(i.G,{title:It,content:(0,t.jsx)(W,{history:te,messages:ut(),onApplySuggestion:we,updateHistory:le,eventTrackingSrc:q}),placement:"left-start",fitContent:!0,show:xe,onClose:()=>fe(!1),onOpen:()=>fe(!0),children:at})}return at};return(0,t.jsxs)("div",{className:se.wrapper,children:[ye&&(0,t.jsx)(l.y,{size:"sm",className:se.spinner}),Se?(0,t.jsx)(d.m,{show:Ce,interactive:!0,content:Ue,children:at}):Tt()]})},w=z=>({wrapper:(0,n.css)({display:"flex"}),spinner:(0,n.css)({color:z.colors.text.link})})},81394:(G,R,e)=>{"use strict";e.d(R,{V:()=>l});var t=e(74848),n=e(14792),s=e(10740),a=e(57725),r=e(3363);const i=`You are an expert in creating Grafana Dashboards.
Your goal is to write a descriptive and concise dashboard description.
You will be given the title and description of the dashboard's panels.
The dashboard description is meant to explain the purpose of the dashboard and what its panels show.
If the dashboard has no panels, the description should be "Empty dashboard"
There should be no numbers in the description except where they are important.
The dashboard description should not have the dashboard title or any quotation marks in it.
The description should be, at most, 300 characters.
Respond with only the description of the dashboard.`,l=({onGenerate:c})=>{const h=(0,n.UA)().getCurrent(),o=(0,r.N3)(h);return(0,t.jsx)(s.n,{messages:d(h),onGenerate:c,eventTrackingSrc:a.ec.dashboardDescription,toggleTipTitle:"Improve your dashboard description",disabled:o.length===0,tooltip:o.length===0?r.ZN:void 0})};function d(c){return[{content:i,role:r.Xh.system},{content:`The title of the dashboard is "${c.title}"
${(0,r.BB)(c)}`,role:r.Xh.user}]}},27966:(G,R,e)=>{"use strict";e.d(R,{Z:()=>l});var t=e(74848),n=e(14792),s=e(10740),a=e(57725),r=e(3363);const i=`You are an expert in creating Grafana Dashboards.
Your goal is to write a concise dashboard title.
You will be given the title and description of the dashboard's panels.
The dashboard title is meant to say what it shows on one line for users to navigate to it.
If the dashboard has no panels, the title should be "Empty dashboard"
There should be no numbers in the title.
The dashboard title should not have quotation marks in it.
The title should be, at most, 50 characters.
Respond with only the title of the dashboard.`,l=({onGenerate:c})=>{const h=(0,n.UA)().getCurrent(),o=(0,r.N3)(h);return(0,t.jsx)(s.n,{messages:d(h),onGenerate:c,eventTrackingSrc:a.ec.dashboardTitle,toggleTipTitle:"Improve your dashboard title",disabled:o.length===0,tooltip:o.length===0?r.ZN:void 0})};function d(c){return[{content:i,role:r.Xh.system},{content:`The panels in the dashboard are: ${(0,r.BB)(c)}`,role:r.Xh.user}]}},20214:(G,R,e)=>{"use strict";e.d(R,{t:()=>l});var t=e(74848),n=e(14792),s=e(10740),a=e(57725),r=e(3363);const i=`You are an expert in creating Grafana Panels.
You will be given the title and description of the dashboard the panel is in as well as the JSON for the panel.
Your goal is to write a descriptive and concise panel description.
The panel description is meant to explain the purpose of the panel, not just its attributes.
Do not refer to the panel; simply describe its purpose.
There should be no numbers in the description except for thresholds.
The description should be, at most, 200 characters.`,l=({onGenerate:c,panel:h})=>(0,t.jsx)(s.n,{messages:()=>d(h),onGenerate:c,eventTrackingSrc:a.ec.panelDescription,toggleTipTitle:"Improve your panel description"});function d(c){const h=(0,n.UA)().getCurrent(),o=(0,r.hn)(c);return[{content:i,role:r.Xh.system},{content:`The panel is part of a dashboard with the title: ${h.title}
The panel is part of a dashboard with the description: ${h.description}
This is the JSON which defines the panel: ${o}`,role:r.Xh.user}]}},74410:(G,R,e)=>{"use strict";e.d(R,{h:()=>i});var t=e(74848),n=e(10740),s=e(57725),a=e(3363);const g="You are an expert in creating Grafana Panels.Your goal is to write short, descriptive, and concise panel title.The title should be shorter than 50 characters.",i=({onGenerate:d,panel:c,dashboard:h})=>(0,t.jsx)(n.n,{messages:()=>l(c,h),onGenerate:d,eventTrackingSrc:s.ec.panelTitle,toggleTipTitle:"Improve your panel title"});function l(d,c){const h=(0,a.hn)(d);return[{content:g,role:a.Xh.system},{content:`The panel is part of a dashboard with the title: ${c.title}
The panel is part of a dashboard with the description: ${c.description}
Use this JSON object which defines the panel: ${h}`,role:a.Xh.user}]}},57725:(G,R,e)=>{"use strict";e.d(R,{KR:()=>a,XX:()=>r,ec:()=>s});var t=e(14110);const n="dashboards_autogenerate_clicked";var s=(g=>(g.panelDescription="panel-description",g.panelTitle="panel-title",g.dashboardChanges="dashboard-changes",g.dashboardTitle="dashboard-title",g.dashboardDescription="dashboard-description",g.unknown="unknown",g))(s||{}),a=(g=>(g.autoGenerateButton="auto-generate-button",g.erroredRetryButton="errored-retry-button",g.stopGenerationButton="stop-generating-button",g.improveButton="improve-button",g.backHistoryItem="back-history-item",g.forwardHistoryItem="forward-history-item",g.quickFeedback="quick-feedback",g.linkToDocs="link-to-docs",g.customFeedback="custom-feedback",g.applySuggestion="apply-suggestion",g))(a||{});function r(g,i,l){(0,t.rR)(n,{src:g,item:i,...l})}},3363:(G,R,e)=>{"use strict";e.d(R,{ZN:()=>S,C4:()=>x,HG:()=>y,Xh:()=>f,Yy:()=>P,BB:()=>b,To:()=>C,hn:()=>T,N3:()=>O,QX:()=>D,Kb:()=>v});var t=e(2543),n=e(65418),s=e(32264),a=e(36974),r=e(90254),g=e(34214);function i(I,L){return I===L?L:Array.isArray(I)&&Array.isArray(L)?c(I,L):l(I)&&l(L)?d(I,L):L}function l(I){return typeof I=="object"&&!Array.isArray(I)&&I!==null}function d(I,L){const B=Object.keys(I),j={};for(const A of B)L.hasOwnProperty(A)&&(Array.isArray(I[A])&&Array.isArray(L[A])||typeof I[A]=="object"&&typeof L[A]=="object"?j[A]=i(I[A],L[A]):j[A]=L[A]);return j}function c(I,L){const B=new Array(I.length).fill(void 0),j=new Set([...Array(I.length).keys()]),A=new Set([...Array(L.length).keys()]);for(let K=0;K<I.length&&A.size!==0;K++){let W=I[K];for(let U=0;U<L.length;U++){if(!A.has(U))continue;let F=L[U];F=i(W,F),JSON.stringify(W)===JSON.stringify(F)&&(j.delete(K),A.delete(U),B[K]=F)}}return h(I,L,B,j,A),B.filter(K=>K!==void 0)}function h(I,L,B,j,A){let K={};A.forEach(U=>{let F=L[U];if(typeof F!="object"||Array.isArray(F)){B.push(F),A.delete(U);return}j.forEach(V=>{let w=I[V];if(typeof w!="object"||Array.isArray(w)){j.delete(V);return}let z=0;for(const N in w){let H=w[N];if(!F.hasOwnProperty(N))continue;let Q=F[N];typeof H!="string"&&typeof H!="number"||typeof H!=typeof Q||H===Q&&(N==="id"&&(z+=1e3),z++)}z!==0&&(K[z]===void 0&&(K[z]=[]),K[z].push([V,U]))})});const W=Object.keys(K).map(Number);W.sort((U,F)=>F-U);for(const U of W){let F=K[U];for(const V of F){const[w,z]=V;j.has(w)&&A.has(z)&&(B[w]=L[z],j.delete(w),A.delete(z))}}for(const U of A)B.push(L[U])}function o(I){const L=I.split(`
`);let B=I[0].startsWith("Index")?4:3,j=L.slice(0,B);const A=/("title"|Title|\{|\}|\[|\])/i;for(let K=B;K<L.length;K++){let W=L[K];(A.test(W)||W.startsWith("+")||W.startsWith("-"))&&j.push(W)}return j.join(`
`)+`
`}function m(I){if(I===null||I==="")return null;if(Array.isArray(I)){const B=I.map(j=>m(j)).filter(j=>j!==null);return B.length>0?B:null}if(typeof I!="object")return I;const L={};for(const B in I){const j=m(I[B]);if(j!==null){if(Array.isArray(j)&&j.length===0||typeof j=="object"&&Object.keys(j).length===0)continue;L[B]=j}}return Object.keys(L).length>0?L:null}function u(I){return JSON.parse(JSON.stringify(I,null,2))}function p(I){let L=u(I.getOriginalDashboard()),B=u(new g.G(L).getSaveModelClone()),j=u(I.getSaveModelClone());B=m(i(L,B)),j=m(i(B,j)),L=m(L);let A=(0,r.ss)("Before migration changes","After migration changes",JSON.stringify(L,null,2),JSON.stringify(B,null,2),"","",{context:20}),K=(0,r.ss)("Before user changes","After user changes",JSON.stringify(B,null,2),JSON.stringify(j,null,2),"","",{context:20});return A=o(A),K=o(K),{migrationDiff:A,userDiff:K}}var f=(I=>(I.system="system",I.user="user",I))(f||{}),y=(I=>(I.Shorter="Even shorter",I.MoreDescriptive="More descriptive",I.Regenerate="Please, regenerate",I))(y||{});const x="gpt-4",v=I=>I.replace(/^"|"$/g,"");function P(I){const{migrationDiff:L,userDiff:B}=p(I);return{userChanges:B,migrationChanges:L}}let E;async function D(){return s.$.apps["grafana-llm-app"]?E||(E=new Promise(I=>{n.vK().then(L=>{L.ok||(E=void 0),I(L.ok)})}),E):!1}const C=(I,L)=>[{role:"system",content:`Your previous response was: ${I}. The user has provided the following feedback: ${L}. Re-generate your response according to the provided feedback.`}];function b(I){const L=O(I);let B;if(L.length<=10)B=`The panels in the dashboard are:
${L.join(`
`)}`;else{const j=I.panels.filter(W=>W.description),A=I.panels.filter(W=>!W.description);let K;j.length>=10?K=j.slice(10).map(M).join(`
`):(K=j.map(M).join(`
`),K+=`
`,K+=A.slice(10-j.length).map(M).join("n")),B=`There are ${L.length} panels.
Due to space constraints, only the information for ten of them is presented.
These ten are not necessarily the first ten, but prioritized to those with descriptions.
The panels in the dashboard are:
${K}`}return B}function T(I){const L=["datasource","title","description","targets","type"],B={...(0,t.pick)(I,L),options:(0,t.pick)(I.options,["content"])};return JSON.stringify(B,null,2)}const S="To generate this content your dashboard must contain at least one panel with a valid title or description.";function O(I){return I.panels.filter(B=>B.title.length>0&&B.title!==a.LH||B.description&&B.description.length>0).map(M)}const M=(I,L)=>`- Panel ${L}
- Title: ${I.title}${I.description?`
- Description: ${I.description}`:""}`},18803:(G,R,e)=>{"use strict";e.d(R,{B6:()=>h,E_:()=>m,jD:()=>o});var t=e(2543),n=e.n(t),s=e(72985),a=e(89667),r=e(52622),g=e(72724),i=e(39070),l=e(32264),d=e(41524),c=e(68706);function h(x){const v=[];if(x?.series)for(const P of x.series)v.push((0,a.Nw)(P));if(x?.annotations)for(const P of x.annotations){const E=(0,a.Nw)(P);E.schema?.meta||(E.schema.meta={}),E.schema.meta.dataTopic=r.QR.Annotations,v.push(E)}return v}function o(x,v){const P=x.getSaveModel(),E={panelType:P.type,datasource:"??"},D=l.$.buildInfo.versionString;let C=`| Key | Value |
|--|--|
| Panel | ${E.panelType} @ ${P.pluginVersion??D} |
| Grafana | ${D} // ${l.$.buildInfo.edition} |
`;return v&&(C+="<details><summary>Panel debug snapshot dashboard</summary>\n\n```json\n"+v+"\n```\n</details>"),C}async function m(x,v,P){const E=x.getSaveModel(),D=(0,t.cloneDeep)(y),C={panelType:E.type,datasource:"??"},b=await(0,s._)(x.getQueryRunner().getData({withFieldConfig:!1,withTransforms:!1})),T=x.datasource,S=(0,d.W)(h(b),v),O=l.$.buildInfo.versionString,M=E?.targets??[],I=`<table width="100%">
    <tr>
      <th width="2%">Panel</th>
      <td >${C.panelType} @ ${E.pluginVersion??O}</td>
    </tr>
    <tr>
      <th>Queries</th>
      <td>${M.map(L=>{const B=L.datasource??T;return`${L.refId}[${B?.type}]`}).join(", ")}</td>
    </tr>
    ${u(E)}
    ${p(b,S)}
    ${f(b)}
    <tr>
      <th>Grafana</th>
      <td>${O} // ${l.$.buildInfo.edition}</td>
    </tr>
  </table>`.trim();if(D.panels[0]={...E,...D.panels[0],targets:[{refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:c.nj.Snapshot,snapshot:S}]},E.transformations?.length){const L=D.panels[D.panels.length-1];L.title=L.title+" (after transformations)";const B=(0,t.cloneDeep)(L);B.id=100,B.title="Data (before transformations)",B.gridPos.w=24,B.targets[0].withTransforms=!1,D.panels.push(B)}return b.annotations?.length&&D.panels.push({id:7,gridPos:{h:6,w:24,x:0,y:20},type:"table",title:"Annotations",datasource:{type:"datasource",uid:"-- Dashboard --"},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,topic:r.QR.Annotations,refId:"A"}]}),D.panels[1].options.content=I,D.panels[2].options.content=JSON.stringify(E,null,2),D.title=`Debug: ${E.title} // ${(0,g.LE)(new Date)}`,D.tags=["debug",`debug-${C.panelType}`],D.time={from:P.from.toISOString(),to:P.to.toISOString()},D}function u(x){return x.transformations?`<tr>
      <th>Transform</th>
      <td>${x.transformations.map(v=>v.id).join(", ")}</td>
  </tr>`:""}function p(x,v){let P=x.series.length??0,E=0,D=0;for(const C of x.series)E+=C.fields.length,D+=C.length;return`<tr><th>Data</th><td>${x.state!==i.Gu.Done?x.state:""} ${P} frames, ${E} fields, ${D} rows </td></tr>`}function f(x){return x.annotations?.length?`<tr>
  <th>Annotations</th>
  <td>${x.annotations.map((v,P)=>`<span>${v.length}</span>`)}</td>
</tr>`:""}const y={panels:[{id:2,title:"Reproduced with embedded data",datasource:{type:"grafana",uid:"grafana"},gridPos:{h:13,w:15,x:0,y:0}},{gridPos:{h:7,w:9,x:15,y:0},id:5,options:{content:"...",mode:"html"},title:"Debug info",type:"text"},{id:6,title:"Original Panel JSON",type:"text",gridPos:{h:13,w:9,x:15,y:7},options:{content:"...",mode:"code",code:{language:"json",showLineNumbers:!0,showMiniMap:!0}}},{id:3,title:"Data from panel above",type:"table",datasource:{type:"datasource",uid:"-- Dashboard --"},gridPos:{h:7,w:15,x:0,y:13},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,refId:"A"}]}],schemaVersion:37}},65123:(G,R,e)=>{"use strict";e.d(R,{BN:()=>l,kx:()=>d,sd:()=>i});var t=e(96540),n=e(24705),s=e(19347),a=e(8484),r=e(16560),g=e(54612);const i=c=>(0,n.A)(async()=>l(c),[c]).value;async function l(c){const h=c?.request?.targets||[];if(c&&c.series&&h.length){for(const o of c.series)if(o.meta&&o.meta.custom){const m=await(0,s.l)().get(h[0].datasource);if(m&&m.components?.MetadataInspector)return m}}}const d=(c,h,o,m,u)=>(0,t.useMemo)(()=>{const p=[];return(0,g.$)(o)&&(p.push({label:(0,a.t)("dashboard.inspect.data-tab","Data"),value:r.q.Data}),p.push({label:(0,a.t)("dashboard.inspect.stats-tab","Stats"),value:r.q.Stats})),u&&p.push({label:(0,a.t)("dashboard.inspect.meta-tab","Meta data"),value:r.q.Meta}),p.push({label:(0,a.t)("dashboard.inspect.json-tab","JSON"),value:r.q.JSON}),m&&p.push({label:(0,a.t)("dashboard.inspect.error-tab","Error"),value:r.q.Error}),h.meta.canEdit&&(0,g.$)(o)&&p.push({label:(0,a.t)("dashboard.inspect.query-tab","Query"),value:r.q.Query}),p},[o,u,h,m])},57755:(G,R,e)=>{"use strict";e.d(R,{D:()=>o});var t=e(74848),n=e(32196),s=e(96540),a=e(78685),r=e(13544),g=e(53402),i=e(40845),l=e(55852),d=e(83277),c=e(53466);const h="showCategory",o=s.memo(({id:p,title:f,children:y,forceOpen:x,isOpenDefault:v=!0,renderTitle:P,className:E,itemsCount:D,isNested:C=!1,sandboxId:b})=>{const[T,S]=(0,a.A)(u(p),{isExpanded:v}),[O,M]=(0,s.useState)(T?.isExpanded??v),I=(0,s.useRef)(0),L=(0,s.useRef)(null),[B,j]=(0,d.s)(),A=B[h]===p;(0,s.useEffect)(()=>{I.current&&Date.now()-I.current<200||(A||x)&&(O||M(!0),A&&L.current?.scrollIntoView())},[x,O,A]);const K=(0,s.useCallback)(()=>{I.current=Date.now(),j({[h]:O?void 0:p},!0),S({isExpanded:!O}),M(!O)},[S,M,j,O,p]);P||(P=function(z){return z||D===void 0||D===0?f:(0,t.jsxs)("span",{children:[f," ",(0,t.jsx)(g.p,{value:D})]})});const W=(0,i.of)(m),U=(0,n.cx)({[W.box]:!0,[W.boxNestedExpanded]:C&&O},E),F=(0,n.cx)(W.header,{[W.headerExpanded]:O,[W.headerNested]:C}),V=(0,n.cx)(W.body,{[W.bodyNested]:C});return(0,t.jsxs)("div",{className:U,"data-plugin-sandbox":b,"data-testid":r.Tp.components.OptionsGroup.group(p),ref:L,children:[(0,t.jsxs)("div",{className:F,onClick:K,children:[(0,t.jsx)(l.$n,{"data-testid":r.Tp.components.OptionsGroup.toggle(p),type:"button",fill:"text",size:"sm",variant:"secondary","aria-expanded":O,className:W.toggleButton,icon:O?"angle-down":"angle-right",onClick:K}),(0,t.jsx)("h6",{id:`button-${p}`,className:W.title,children:P(O)})]}),O&&(0,t.jsx)("div",{className:V,id:p,"aria-labelledby":`button-${p}`,children:y})]})});o.displayName="OptionsPaneCategory";const m=p=>({box:(0,n.css)({borderTop:`1px solid ${p.colors.border.weak}`}),boxNestedExpanded:(0,n.css)({marginBottom:p.spacing(2)}),title:(0,n.css)({flexGrow:1,overflow:"hidden",lineHeight:1.5,fontSize:"1rem",paddingLeft:"6px",fontWeight:p.typography.fontWeightMedium,margin:0}),header:(0,n.css)({display:"flex",cursor:"pointer",alignItems:"center",padding:p.spacing(.5),color:p.colors.text.primary,fontWeight:p.typography.fontWeightMedium,"&:hover":{background:p.colors.emphasize(p.colors.background.primary,.03)}}),toggleButton:(0,n.css)({alignSelf:"baseline"}),headerExpanded:(0,n.css)({color:p.colors.text.primary}),headerNested:(0,n.css)({padding:p.spacing(.5,0,.5,0)}),body:(0,n.css)({padding:p.spacing(1,2,1,4)}),bodyNested:(0,n.css)({position:"relative",paddingRight:0,"&:before":{content:"''",position:"absolute",top:0,left:"8px",width:"1px",height:"100%",background:p.colors.border.weak}})}),u=p=>`${c.wi}.optionGroup[${p}]`},48192:(G,R,e)=>{"use strict";e.d(R,{C:()=>s});var t=e(74848),n=e(57755);class s{constructor(r){this.props=r,this.items=[],this.categories=[]}addItem(r){return r.parent=this,this.items.push(r),this}addCategory(r){return r.props.isNested=!0,r.parent=this,this.categories.push(r),this}getCategory(r){let g=this.categories.find(i=>i.props.id===r);return g||(g=new s({title:r,id:r}),this.addCategory(g)),g}render(r){return this.props.customRender?this.props.customRender():(0,t.jsxs)(n.D,{...this.props,children:[this.items.map(g=>g.render(r)),this.categories.map(g=>g.render(r))]},this.props.title)}}},74097:(G,R,e)=>{"use strict";e.d(R,{v:()=>o});var t=e(74848),n=e(32196),s=e(23257),a=e.n(s),r=e(13544),g=e(60029),i=e(88575),l=e(40845),d=e(56034);function c({overrides:p}){const f=(0,l.of)(h);return(0,t.jsx)("div",{className:f.wrapper,children:p.map((y,x)=>(0,t.jsx)(d.m,{content:y.tooltip,placement:"top",children:(0,t.jsx)("div",{"aria-label":y.description,className:f[y.type]})},x.toString()))})}const h=p=>{const f={width:8,height:8,borderRadius:p.shape.radius.circle,marginLeft:p.spacing(1),top:"-1px"};return{wrapper:(0,n.css)({display:"flex"}),rule:(0,n.css)({...f,position:"relative",backgroundColor:p.colors.primary.main}),data:(0,n.css)({...f,position:"relative",backgroundColor:p.colors.warning.main})}};class o{constructor(f){this.props=f}getLabel(f){const{title:y,description:x,overrides:v,addon:P}=this.props;if(!f)return this.parent.props.title===y&&!v?.length?null:(0,t.jsx)(m,{title:y,description:x,overrides:v,addon:P});const E=[];return this.parent.parent&&E.push(this.highlightWord(this.parent.parent.props.title,f)),this.parent.props.title!==y&&E.push(this.highlightWord(this.parent.props.title,f)),(0,t.jsxs)(g.J,{description:x&&this.highlightWord(x,f),category:E,children:[this.highlightWord(y,f),v&&v.length>0&&(0,t.jsx)(c,{overrides:v})]})}highlightWord(f,y){return(0,t.jsx)(a(),{textToHighlight:f,searchWords:[y],highlightClassName:"search-fragment-highlight"})}renderOverrides(){const{overrides:f}=this.props;!f||f.length}render(f){const{title:y,description:x,render:v,showIf:P,skipField:E}=this.props,D=`${this.parent.props.id} ${y}`;return P&&!P()?null:E?v():(0,t.jsx)(i.D,{label:this.getLabel(f),description:x,"aria-label":r.Tp.components.PanelEditor.OptionsPane.fieldLabel(D),children:v()},D)}}function m({title:p,description:f,overrides:y,addon:x}){const v=(0,l.of)(u);return(0,t.jsxs)("div",{className:v.container,children:[(0,t.jsxs)(g.J,{description:f,children:[p,y&&y.length>0&&(0,t.jsx)(c,{overrides:y})]}),x]})}function u(p){return{container:(0,n.css)({display:"flex",justifyContent:"space-between"})}}},26443:(G,R,e)=>{"use strict";e.d(R,{gs:()=>q,Ff:()=>ee,Po:()=>ae});var t=e(74848),n=e(32196),s=e(96540),a=e(32264),r=e(40845),g=e(67647),i=e(94354),l=e(40276),d=e(74106),c=e(82792),h=e(71468),o=e(7376),m=e(79971),u=e(40334),p=e(33390);function f(se,te){p.A.set(`panel-edit-section-${se}`,te?"true":"false")}function y(se,te){return p.A.getBool(`panel-edit-section-${se}`,te)}const x=(se,te)=>({angularPanelComponent:(0,u.U)(se,te.panel)?.angularComponent}),v={changePanelPlugin:m.gW},P=(0,h.connect)(x,v);class E extends s.PureComponent{constructor(te){super(te)}componentDidMount(){this.loadAngularOptions()}componentDidUpdate(te){(this.props.plugin!==te.plugin||this.props.angularPanelComponent!==te.angularPanelComponent)&&this.cleanUpAngularOptions(),this.loadAngularOptions()}componentWillUnmount(){this.cleanUpAngularOptions()}cleanUpAngularOptions(){this.angularOptions&&(this.angularOptions.destroy(),this.angularOptions=null)}loadAngularOptions(){const{panel:te,angularPanelComponent:ne,changePanelPlugin:le}=this.props;if(!this.element||!ne||this.angularOptions)return;const re=ne.getScope();if(!re.$$childHead){setTimeout(()=>{this.forceUpdate()});return}const de=re.$$childHead.ctrl;de.initEditMode(),de.onPluginTypeChange=pe=>{le({panel:te,pluginId:pe.id})};let oe="";for(let pe=0;pe<de.editorTabs.length;pe++){const xe=de.editorTabs[pe];xe.isOpen=y(xe.title,pe===0),oe+=`
      <div class="panel-options-group" ng-cloak>
        <div class="panel-options-group__header" ng-click="toggleOptionGroup(${pe})" aria-label="${xe.title} section">
          <div class="panel-options-group__icon">
            <icon name="ctrl.editorTabs[${pe}].isOpen ? 'angle-down' : 'angle-right'"></icon>
          </div>
          <div class="panel-options-group__title">${xe.title}</div>
        </div>
        <div class="panel-options-group__body" ng-if="ctrl.editorTabs[${pe}].isOpen">
          <panel-editor-tab editor-tab="ctrl.editorTabs[${pe}]" ctrl="ctrl"></panel-editor-tab>
        </div>
      </div>
      `}const J=(0,o.E)(),ce={ctrl:de,toggleOptionGroup:pe=>{const xe=de.editorTabs[pe];xe.isOpen=!xe.isOpen,f(xe.title,!!xe.isOpen)}};this.angularOptions=J.load(this.element,ce,oe),this.angularOptions.digest()}render(){return(0,t.jsx)("div",{ref:te=>this.element=te})}}const D=(0,h.connect)(x,v)(E);var C=e(57755),b=e(22290),T=e(10354);const S=({panel:se,formatDate:te})=>{const ne=(0,r.of)(O),le=se.libraryPanel?.meta;return le?(0,t.jsxs)("div",{className:ne.info,children:[(0,t.jsxs)("div",{className:ne.libraryPanelInfo,children:[`Used on ${le.connectedDashboards} `,le.connectedDashboards===1?"dashboard":"dashboards"]}),(0,t.jsxs)("div",{className:ne.libraryPanelInfo,children:["Last edited on ",te?.(le.updated,"L")??le.updated," by",le.updatedBy.avatarUrl&&(0,t.jsx)("img",{width:"22",height:"22",className:ne.userAvatar,src:le.updatedBy.avatarUrl,alt:`Avatar for ${le.updatedBy.name}`}),le.updatedBy.name]})]}):null},O=se=>({info:(0,n.css)`
      line-height: 1;
    `,libraryPanelInfo:(0,n.css)`
      color: ${se.colors.text.secondary};
      font-size: ${se.typography.bodySmall.fontSize};
    `,userAvatar:(0,n.css)`
      border-radius: ${se.shape.radius.circle};
      box-sizing: content-box;
      width: 22px;
      height: 22px;
      padding-left: ${se.spacing(1)};
      padding-right: ${se.spacing(1)};
    `});var M=e(48192),I=e(74097);function L(se){const{panel:te,onPanelConfigChange:ne,dashboard:le}=se,re=new M.C({title:"Library panel options",id:"Library panel options",isOpenDefault:!0});return(0,c.X)(te)&&re.addItem(new I.v({title:"Name",value:te.libraryPanel.name,popularRank:1,render:function(){return(0,t.jsx)(T.p,{id:"LibraryPanelFrameName",defaultValue:te.libraryPanel.name,onBlur:oe=>ne("libraryPanel",{...te.libraryPanel,name:oe.currentTarget.value})})}})).addItem(new I.v({title:"Information",render:function(){return(0,t.jsx)(S,{panel:te,formatDate:le.formatDate})}})),re}var B=e(13544),j=e(21744),A=e(15292),K=e(64919),W=e(90182),U=e(29304),F=e(20214),V=e(74410),w=e(92378);function z(se){const{dashboard:te,panel:ne,onPanelConfigChange:le}=se,re=new M.C({title:"Panel options",id:"Panel options",isOpenDefault:!0}),de=J=>{const ce=document.getElementById("PanelFrameTitle");ce instanceof HTMLInputElement&&(ce.value=J,le("title",J))},oe=J=>{const ce=document.getElementById("description-text-area");ce instanceof HTMLTextAreaElement&&(ce.value=J,le("description",J))};return re.addItem(new I.v({title:"Title",value:ne.title,popularRank:1,render:function(){return(0,t.jsx)(T.p,{"data-testid":B.Tp.components.PanelEditor.OptionsPane.fieldInput("Title"),id:"PanelFrameTitle",defaultValue:ne.title,onBlur:ce=>le("title",ce.currentTarget.value)})},addon:a.$.featureToggles.dashgpt&&(0,t.jsx)(V.h,{onGenerate:de,panel:ne.getSaveModel(),dashboard:te.getSaveModelClone()})})).addItem(new I.v({title:"Description",description:ne.description,value:ne.description,render:function(){return(0,t.jsx)(j.f,{"data-testid":B.Tp.components.PanelEditor.OptionsPane.fieldInput("Description"),id:"description-text-area",defaultValue:ne.description,onBlur:ce=>le("description",ce.currentTarget.value)})},addon:a.$.featureToggles.dashgpt&&(0,t.jsx)(F.t,{onGenerate:oe,panel:ne.getSaveModel()})})).addItem(new I.v({title:"Transparent background",render:function(){return(0,t.jsx)(A.d,{"data-testid":B.Tp.components.PanelEditor.OptionsPane.fieldInput("Transparent background"),value:ne.transparent,id:"transparent-background",onChange:ce=>le("transparent",ce.currentTarget.checked)})}})).addCategory(new M.C({title:"Panel links",id:"Panel links",isOpenDefault:!1,itemsCount:ne.links?.length}).addItem(new I.v({title:"Panel links",render:function(){return(0,t.jsx)(K.e,{links:ne.links,onChange:ce=>le("links",ce),getSuggestions:U.Fq,data:[]})}}))).addCategory(new M.C({title:"Repeat options",id:"Repeat options",isOpenDefault:!1}).addItem(new I.v({title:"Repeat by variable",description:"Repeat this panel for each value in the selected variable. This is not visible while in edit mode. You need to go back to dashboard and then update the variable or reload the dashboard.",render:function(){return(0,t.jsx)(w.G,{id:"repeat-by-variable-select",repeat:ne.repeat,onChange:ce=>{le("repeat",ce)}})}})).addItem(new I.v({title:"Repeat direction",showIf:()=>!!ne.repeat,render:function(){const ce=[{label:"Horizontal",value:"h"},{label:"Vertical",value:"v"}];return(0,t.jsx)(i.z,{options:ce,value:ne.repeatDirection||"h",onChange:pe=>le("repeatDirection",pe)})}})).addItem(new I.v({title:"Max per row",showIf:()=>!!(ne.repeat&&ne.repeatDirection==="h"),render:function(){const ce=[2,3,4,6,8,12].map(pe=>({label:pe.toString(),value:pe}));return(0,t.jsx)(W.l6,{options:ce,value:ne.maxPerRow,onChange:pe=>le("maxPerRow",pe.value)})}})))}var N=e(66211);class H{constructor(te,ne){this.categories=te,this.overrides=ne}search(te){const ne=new RegExp(te,"i"),re=this.collectHits(this.categories,ne,[]).sort(Q).map(J=>J.item),oe=this.collectHits(this.overrides,ne,[]).sort(Q).map(J=>J.item);return{optionHits:re,overrideHits:this.buildOverrideHitCategories(oe),totalCount:this.getAllOptionsCount(this.categories)}}collectHits(te,ne,le){for(const re of te){const de=ne.test(re.props.title);for(const oe of re.items){if(ne.test(oe.props.title)){le.push({item:oe,rank:1});continue}if(oe.props.description&&ne.test(oe.props.description)){le.push({item:oe,rank:2});continue}de&&le.push({item:oe,rank:3})}re.categories.length>0&&this.collectHits(re.categories,ne,le)}return le}getAllOptionsCount(te){let ne=0;for(const le of te)ne+=le.items.length,le.categories.length>0&&(ne+=this.getAllOptionsCount(le.categories));return ne}buildOverrideHitCategories(te){const ne={};for(const le of te){let re=ne[le.parent.props.title];re||(re=ne[le.parent.props.title]=new M.C(le.parent.props),re.addItem(le.parent.items[0])),re.items[0].props.title!==le.props.title&&re.addItem(le)}return Object.values(ne)}}function Q(se,te){return se.rank-te.rank}function X(se){const te=[];for(const ne of se)for(const le of ne.items)le.props.title==="Unit"&&(le.props.popularRank=2),le.props.title==="Min"&&(le.props.popularRank=3),le.props.title==="Max"&&(le.props.popularRank=4),le.props.title==="Display name"&&(le.props.popularRank=5),le.props.popularRank&&te.push(le);return te.sort((ne,le)=>ne.props.popularRank-le.props.popularRank)}const ee=se=>{const{plugin:te,dashboard:ne,panel:le}=se,[re,de]=(0,s.useState)(""),[oe,J]=(0,s.useState)("All"),ce=(0,r.of)(k),[pe,xe,fe]=(0,s.useMemo)(()=>[z(se),(0,N.Zm)(se),L(se)],[le.configRev,se.data,se.instanceState,re]),Ee=(0,s.useMemo)(()=>(0,b.v)(se.panel.fieldConfig,se.plugin.fieldConfigRegistry,se.data?.series??[],re,se.onFieldConfigsChange),[le.configRev,se.data,se.instanceState,re]),Se=[],ye=re.length>0,Ve=(0,s.useMemo)(Z,[]),Me=(0,c.X)(le)?[fe,pe,...xe]:[pe,...xe];if(ye)Se.push(ae(Me,Ee,re)),se.plugin.angularPanelCtrl&&Se.push((0,t.jsx)("div",{className:ce.searchNotice,children:"This is an old visualization type that does not support searching all options."},"Search notice"));else switch(oe){case"All":(0,c.X)(le)&&Se.push(fe.render()),Se.push(pe.render()),se.plugin.angularPanelCtrl&&Se.push((0,t.jsx)(D,{plugin:te,dashboard:ne,panel:le},"AngularOptions"));for(const Ue of xe)Se.push(Ue.render());for(const Ue of Ee)Se.push(Ue.render());break;case"Overrides":for(const Ue of Ee)Se.push(Ue.render());break;case"Recent":Se.push((0,t.jsx)(C.D,{id:"Recent options",title:"Recent options",forceOpen:1,children:X(Me).map(Ue=>Ue.render())},"Recent options"));break}const Ce=!ye&&!te.fieldConfigRegistry.isEmpty();return(0,t.jsxs)("div",{className:ce.wrapper,children:[(0,t.jsxs)("div",{className:ce.formBox,children:[le.isAngularPlugin()&&!te.meta.angular?.hideDeprecation&&(0,t.jsx)(d.c,{className:ce.angularDeprecationWrapper,showPluginDetailsLink:!0,pluginId:te.meta.id,pluginType:te.meta.type,angularSupportEnabled:a.$?.angularSupportEnabled,interactionElementId:"panel-options"}),(0,t.jsx)("div",{className:ce.formRow,children:(0,t.jsx)(g.Z,{width:0,value:re,onChange:de,placeholder:"Search options"})}),Ce&&(0,t.jsx)("div",{className:ce.formRow,children:(0,t.jsx)(i.z,{options:Ve,value:oe,fullWidth:!0,onChange:J})})]}),(0,t.jsx)("div",{className:ce.scrollWrapper,children:(0,t.jsx)(l.E,{autoHeightMin:"100%",children:(0,t.jsx)("div",{className:ce.mainBox,children:Se})})})]})};function Z(){return[{label:"All",value:"All"},{label:"Overrides",value:"Overrides"}]}var q=(se=>(se.All="All",se.Overrides="Overrides",se.Recent="Recent",se))(q||{});function ae(se,te,ne){const le=new H(se,te),{optionHits:re,totalCount:de,overrideHits:oe}=le.search(ne);return(0,t.jsxs)("div",{children:[(0,t.jsx)(C.D,{id:"Found options",title:`Matched ${re.length}/${de} options`,forceOpen:1,children:re.map(J=>J.render(ne))},"Normal options"),oe.map(J=>J.render(ne))]},"search results")}const k=se=>({wrapper:(0,n.css)({height:"100%",display:"flex",flexDirection:"column",flex:"1 1 0",".search-fragment-highlight":{color:se.colors.warning.text,background:"transparent"}}),searchBox:(0,n.css)({display:"flex",flexDirection:"column",minHeight:0}),formRow:(0,n.css)({marginBottom:se.spacing(1)}),formBox:(0,n.css)({padding:se.spacing(1),background:se.colors.background.primary,border:`1px solid ${se.components.panel.borderColor}`,borderTopLeftRadius:se.shape.borderRadius(1.5),borderBottom:"none"}),closeButton:(0,n.css)({marginLeft:se.spacing(1)}),searchHits:(0,n.css)({padding:se.spacing(1,1,0,1)}),scrollWrapper:(0,n.css)({flexGrow:1,minHeight:0}),searchNotice:(0,n.css)({fontSize:se.typography.size.sm,color:se.colors.text.secondary,padding:se.spacing(1),textAlign:"center"}),mainBox:(0,n.css)({background:se.colors.background.primary,border:`1px solid ${se.components.panel.borderColor}`,borderTop:"none",flexGrow:1}),angularDeprecationWrapper:(0,n.css)({padding:se.spacing(1)})})},22290:(G,R,e)=>{"use strict";e.d(R,{v:()=>S});var t=e(74848),n=e(32196),s=e(2543),a=e(85200),r=e(37055),g=e(84349),i=e(51986),l=e(40845),d=e(29304),c=e(96540),h=e(23257),o=e.n(h),m=e(66864),u=e(60029),p=e(53402),f=e(29158),y=e(88575),x=e(57755);const v=({property:L,context:B,registry:j,onChange:A,onRemove:K,isSystemOverride:W,searchQuery:U})=>{const F=(0,l.of)(P),V=j?.getIfExists(L.id),w=(0,c.useId)();if(!V)return null;const z=Array.isArray(L.value)||L.id===r.uo.Thresholds||L.id===r.uo.Links||L.id===r.uo.Mappings,N=V.category?.filter(X=>X!==V.name);let H;const Q=(X=!0,ee=!1)=>(Z=!1)=>(0,t.jsxs)(m.Gy,{justify:"space-between",children:[(0,t.jsxs)(u.J,{category:N,description:X?V.description:void 0,htmlFor:w,children:[(0,t.jsx)(o(),{textToHighlight:V.name,searchWords:[U],highlightClassName:"search-fragment-highlight"}),!Z&&ee&&V.getItemsCount&&(0,t.jsx)(p.p,{value:V.getItemsCount(L.value)})]}),!W&&(0,t.jsx)("div",{children:(0,t.jsx)(f.K,{name:"times",onClick:K,tooltip:"Remove label"})})]});return z?H=(0,t.jsx)(x.D,{id:V.name,renderTitle:Q(!1,!0),className:(0,n.css)({paddingLeft:0,paddingRight:0}),isNested:!0,isOpenDefault:L.value!==void 0,children:(0,t.jsx)(V.override,{value:L.value,onChange:X=>{A(X)},item:V,context:B})}):H=(0,t.jsx)("div",{children:(0,t.jsx)(y.D,{label:Q()(),description:V.description,children:(0,t.jsx)(V.override,{value:L.value,onChange:X=>{A(X)},item:V,context:B,id:w})})}),(0,t.jsx)("div",{className:(0,n.cx)(z&&F.collapsibleOverrideEditor,!z&&"dynamicConfigValueEditor--nonCollapsible"),children:H})},P=L=>({collapsibleOverrideEditor:(0,n.css)({label:"collapsibleOverrideEditor","& + .dynamicConfigValueEditor--nonCollapsible":{marginTop:L.spacing(1)}})});var E=e(48192),D=e(74097),C=e(14578);const b=({isExpanded:L,registry:B,matcherUi:j,overrideName:A,override:K,onOverrideRemove:W})=>{const U=(0,l.of)(T),V=K.properties.map(z=>B.getIfExists(z.id)).filter(z=>!!z).map(z=>z?.name).join(", "),w=j.optionsToLabel(K.matcher.options);return(0,t.jsxs)("div",{children:[(0,t.jsxs)(m.Gy,{justify:"space-between",children:[(0,t.jsx)("div",{children:A}),(0,t.jsx)(f.K,{name:"trash-alt",onClick:W,tooltip:"Remove override"})]}),!L&&(0,t.jsx)("div",{className:U.overrideDetails,children:(0,t.jsxs)("div",{className:U.options,title:w,children:[w," ",(0,t.jsx)(C.I,{name:"angle-right"})," ",V]})})]})};b.displayName="OverrideTitle";const T=L=>({matcherUi:(0,n.css)({padding:L.spacing(1)}),propertyPickerWrapper:(0,n.css)({marginTop:L.spacing(2)}),overrideDetails:(0,n.css)({fontSize:L.typography.bodySmall.fontSize,color:L.colors.text.secondary,fontWeight:L.typography.fontWeightRegular}),options:(0,n.css)({overflow:"hidden",paddingRight:L.spacing(4)}),unknownLabel:(0,n.css)({marginBottom:0})});function S(L,B,j,A,K){const W=[],U=L;if(!B||B.isEmpty())return[];const F=(N,H)=>{let Q=(0,s.cloneDeep)(U.overrides);Q[N]=H,K({...U,overrides:Q})},V=N=>{let H=(0,s.cloneDeep)(U.overrides);H.splice(N,1),K({...U,overrides:H})},w=N=>{const H=a.sJ.get(N.value);H&&K({...U,overrides:[...U.overrides,{matcher:{id:H.id,options:H.defaultOptions},properties:[]}]})},z={data:j,getSuggestions:N=>(0,d.Hf)(j,N),isOverride:!0};for(let N=0;N<U.overrides.length;N++){const H=U.overrides[N],Q=`Override ${N+1}`,X=g.g.get(H.matcher.id),ee=O(B),Z=(0,r.Ow)(H),q=H.properties.length===0?1:0,ae=new E.C({title:Q,id:Q,forceOpen:q,renderTitle:function(ne){return(0,t.jsx)(b,{override:H,isExpanded:ne,registry:B,overrideName:Q,matcherUi:X,onOverrideRemove:()=>V(N)})}}),k=te=>{F(N,{...H,matcher:{...H.matcher,options:te}})},se=(te,ne)=>{const le=B.get(ne.value),re={id:le.id,value:le.defaultValue},de=te.properties??[];de.push(re),F(N,{...te,properties:de})};ae.addItem(new D.v({title:X.name,render:function(){return(0,t.jsx)(X.component,{id:`${X.matcher.id}-${N}`,matcher:X.matcher,data:j??[],options:H.matcher.options,onChange:k})}}));for(let te=0;te<H.properties.length;te++){const ne=H.properties[te],le=B.getIfExists(ne.id);if(!le)continue;const re=oe=>{F(N,{...H,properties:H.properties.map((J,ce)=>ce===te?{...J,value:oe}:J)})},de=()=>{F(N,{...H,properties:H.properties.filter((oe,J)=>J!==te)})};ae.addItem(new D.v({title:le.name,skipField:!0,render:function(){return(0,t.jsx)(v,{isSystemOverride:Z,onChange:re,onRemove:de,property:ne,registry:B,context:z,searchQuery:A},`${ne.id}/${te}`)}}))}!Z&&H.matcher.options&&ae.addItem(new D.v({title:"----------",skipField:!0,render:function(){return(0,t.jsx)(i.i,{label:"Add override property",variant:"secondary",isFullWidth:!0,icon:"plus",menuPlacement:"auto",options:ee,onChange:ne=>se(H,ne)},"Add override property")}})),W.push(ae)}return W.push(new E.C({title:"add button",id:"add button",customRender:function(){return(0,t.jsx)(M,{children:(0,t.jsx)(i.i,{icon:"plus",label:"Add field override",variant:"secondary",menuPlacement:"auto",isFullWidth:!0,size:"md",options:g.g.list().filter(H=>!H.excludeFromPicker).map(H=>({label:H.name,value:H.id,description:H.description})),onChange:H=>w(H)})},"Add override")}})),W}function O(L){return L.list().filter(B=>!B.hideFromOverrides).map(B=>{let j=B.name;return B.category&&(j=[...B.category,B.name].join(" > ")),{label:j,value:B.id,description:B.description}})}function M({children:L}){const B=(0,l.of)(I);return(0,t.jsx)("div",{className:B,children:L})}function I(L){return(0,n.css)({borderTop:`1px solid ${L.colors.border.weak}`,padding:`${L.spacing(2)}`,display:"flex"})}},66211:(G,R,e)=>{"use strict";e.d(R,{g5:()=>E,tN:()=>v,Zm:()=>x,Z4:()=>P});var t=e(74848),n=e(2543),s=e(60264),a=e(10354),r=e(32196),g=e(72724),i=e(40845);const l=({libraryPanel:D})=>{const C=(0,i.of)(d),b=D.useState(),T=b.$timeRange?.getTimeZone(),S=b._loadedPanel?.meta;return S?(0,t.jsxs)("div",{className:C.info,children:[(0,t.jsxs)("div",{className:C.libraryPanelInfo,children:[`Used on ${S.connectedDashboards} `,S.connectedDashboards===1?"dashboard":"dashboards"]}),(0,t.jsxs)("div",{className:C.libraryPanelInfo,children:[(0,g.LE)(S.updated,{format:"L",timeZone:T})," by",S.updatedBy.avatarUrl&&(0,t.jsx)("img",{className:C.userAvatar,src:S.updatedBy.avatarUrl,alt:`Avatar for ${S.updatedBy.name}`}),S.updatedBy.name]})]}):null},d=D=>({info:(0,r.css)({lineHeight:1}),libraryPanelInfo:(0,r.css)({color:D.colors.text.secondary,fontSize:D.typography.bodySmall.fontSize}),userAvatar:(0,r.css)({borderRadius:D.shape.radius.circle,boxSizing:"content-box",width:"22px",height:"22px",paddingLeft:D.spacing(1),paddingRight:D.spacing(1)})});var c=e(29304),h=e(48192),o=e(74097);const m="Some data fields have this option pre-configured. Add a field override rule to override the pre-configured value.",u="An override rule exists for this property";function p(D,C,b){const T=[];if(b){for(const O of b)for(const M of O.fields)if((0,n.get)(M.config,D.path)!=null){T.push({type:"data",description:m,tooltip:m});break}}return C.overrides.some(O=>O.properties.some(M=>M.id===D.id))&&T.push({type:"rule",description:u,tooltip:u}),T}var f=e(54612);function y({data:D,replaceVariables:C,options:b,eventBus:T,instanceState:S}){const O=D?.series??[];return{data:O,replaceVariables:C,options:b,eventBus:T,getSuggestions:I=>(0,c.Hf)(O,I),instanceState:S}}function x(D){const{plugin:C,panel:b,onPanelOptionsChanged:T,onFieldConfigsChange:S,data:O,dashboard:M,instanceState:I}=D,L=b.getOptions(),B=b.fieldConfig,j={},A=y({data:O,replaceVariables:b.replaceVariables,options:L,eventBus:M.events,instanceState:I}),K=U=>{const F=(U&&U[0])??`${C.meta.name}`,V=j[F];return V||(j[F]=new h.C({title:F,id:F,sandboxId:C.meta.id}))},W={getValue:U=>(0,n.get)(L,U),onChange:(U,F)=>{const V=(0,f.Sf)(L,U,F);T(V)}};E(C.getPanelOptionsSupplier(),W,K,A);for(const U of C.fieldConfigRegistry.list()){if(U.isCustom){if(U.showIf&&!U.showIf(B.defaults.custom,O?.series))continue}else if(U.showIf&&!U.showIf(B.defaults,O?.series))continue;if(U.hideFromDefaults)continue;const F=K(U.category),V=U.editor,w=B.defaults,z=U.isCustom?w.custom?(0,n.get)(w.custom,U.path):void 0:(0,n.get)(w,U.path);U.getItemsCount&&(F.props.itemsCount=U.getItemsCount(z)),F.addItem(new o.v({title:U.name,description:U.description,overrides:p(U,B,O?.series),render:function(){const H=Q=>{S((0,f.EQ)(B,U.path,Q,U.isCustom))};return(0,t.jsx)(V,{value:z,onChange:H,item:U,context:A,id:U.id})}}))}return Object.values(j)}function v(D){const C=new h.C({title:"Library panel options",id:"Library panel options",isOpenDefault:!0});return C.addItem(new o.v({title:"Name",value:D,popularRank:1,render:function(){return(0,t.jsx)(a.p,{id:"LibraryPanelFrameName","data-testid":"library panel name input",defaultValue:D.state.name,onBlur:T=>D.setState({name:T.currentTarget.value})})}})).addItem(new o.v({title:"Information",render:function(){return(0,t.jsx)(l,{libraryPanel:D})}})),C}function P(D){const{plugin:C,panel:b,data:T,eventBus:S,instanceState:O}=D,M={},I=K=>{const W=K?.[0]??C.meta.name,U=M[W];return U||(M[W]=new h.C({title:W,id:W,sandboxId:C.meta.id}))},L=b.state.options,B={getValue:K=>(0,n.get)(L,K),onChange:(K,W)=>{const U=(0,f.Sf)(L,K,W);b.onOptionsChange(U)}},j=y({data:T,replaceVariables:b.interpolate,options:L,eventBus:S,instanceState:O});E(C.getPanelOptionsSupplier(),B,I,j);const A=b.state.fieldConfig;for(const K of C.fieldConfigRegistry.list()){const W=K.showIf&&(K.isCustom?!K.showIf(A.defaults.custom,T?.series):!K.showIf(A.defaults,T?.series));if(K.hideFromDefaults||W)continue;const U=I(K.category),F=K.editor,V=A.defaults,w=K.isCustom?V.custom?(0,n.get)(V.custom,K.path):void 0:(0,n.get)(V,K.path);K.getItemsCount&&(U.props.itemsCount=K.getItemsCount(w)),U.addItem(new o.v({title:K.name,description:K.description,overrides:p(K,A,T?.series),render:function(){const N=H=>{b.onFieldConfigChange((0,f.EQ)(A,K.path,H,K.isCustom),!0)};return(0,t.jsx)(F,{value:w,onChange:N,item:K,context:j,id:K.id})}}))}return Object.values(M)}function E(D,C,b,T,S){const O=new s.pv;D(O,T);for(const M of O.getItems()){if(M.showIf&&!M.showIf(T.options,T.data))continue;let I=S;if(I?M.category?.[0]?.length&&(I=I.getCategory(M.category[0])):I=b(M.category),(0,s.iF)(M)){const B=M.getNestedValueAccess(C),j=B.getContext?B.getContext(T):{...T,options:C.getValue(M.path)};E(M.getBuilder(),B,b,j,I);continue}const L=M.editor;I.addItem(new o.v({title:M.name,description:M.description,render:function(){return(0,t.jsx)(L,{value:C.getValue(M.path),onChange:j=>{C.onChange(M.path,j)},item:M,context:T,id:M.id})}}))}}},53466:(G,R,e)=>{"use strict";e.d(R,{Ay:()=>v,GU:()=>h,MJ:()=>m,Ox:()=>u,eK:()=>f,fR:()=>p,kw:()=>y,wi:()=>i});var t=e(65307),n=e(39070),s=e(43127),a=e(33390),r=e(84423),g=e(32696);const i="grafana.dashboard.editor.ui",l={isPanelOptionsVisible:!0,rightPaneSize:400,topPaneSize:.45,mode:g.q5.Fill},d=()=>{const P=a.A.getObject(i,l);let E={...P};return typeof P.topPaneSize=="string"&&(E={...P,topPaneSize:parseFloat(P.topPaneSize)/100}),{getPanel:()=>new r.a9({}),getSourcePanel:()=>new r.a9({}),getData:()=>({state:n.Gu.NotStarted,series:[],timeRange:(0,s.E2)()}),initDone:!1,shouldDiscardChanges:!1,isOpen:!1,isVizPickerOpen:!1,tableViewEnabled:!1,ui:{...l,...E}}},c=(0,t.Z0)({name:"panelEditor",initialState:d(),reducers:{updateEditorInitState:(P,E)=>{P.getPanel=()=>E.payload.panel,P.getSourcePanel=()=>E.payload.sourcePanel,P.initDone=!0,P.isOpen=!0,P.shouldDiscardChanges=!1},setEditorPanelData:(P,E)=>{P.getData=()=>E.payload},setDiscardChanges:(P,E)=>{P.shouldDiscardChanges=E.payload},setPanelEditorUIState:(P,E)=>{P.ui={...P.ui,...E.payload},!P.ui.isPanelOptionsVisible&&P.isVizPickerOpen&&(P.isVizPickerOpen=!1)},toggleVizPicker:(P,E)=>{P.isVizPickerOpen=E.payload,P.isVizPickerOpen&&(P.ui.isPanelOptionsVisible=!0)},toggleTableView(P){P.tableViewEnabled=!P.tableViewEnabled},closeEditor:P=>{P.getPanel=()=>new r.a9({}),P.getSourcePanel=()=>new r.a9({}),P.isOpen=!1,P.initDone=!1,P.isVizPickerOpen=!1,P.tableViewEnabled=!1}}}),{updateEditorInitState:h,setEditorPanelData:o,setDiscardChanges:m,closeEditor:u,setPanelEditorUIState:p,toggleVizPicker:f,toggleTableView:y}=c.actions,v={panelEditor:c.reducer}},32696:(G,R,e)=>{"use strict";e.d(R,{M8:()=>t,Nt:()=>a,__:()=>g,q5:()=>n});var t=(i=>(i.Query="query",i.Transform="transform",i.Visualize="visualize",i.Alert="alert",i))(t||{}),n=(i=>(i[i.Fill=0]="Fill",i[i.Fit=1]="Fit",i[i.Exact=2]="Exact",i))(n||{}),s=(i=>(i[i.Off=0]="Off",i[i.Table=1]="Table",i))(s||{});const a=[{value:0,label:"Fill",description:"Use all available space"},{value:2,label:"Actual",description:"Make same size as on the dashboard"}],r=[{value:0,label:"Visualization",description:"Show using selected visualization"},{value:1,label:"Table",description:"Show raw data in table form"}];var g=(i=>(i[i.Visualizations=0]="Visualizations",i[i.LibraryPanels=1]="LibraryPanels",i[i.Suggestions=2]="Suggestions",i[i.Widgets=3]="Widgets",i))(g||{})},54612:(G,R,e)=>{"use strict";e.d(R,{$:()=>g,A:()=>r,EQ:()=>i,Sf:()=>l});var t=e(2543),n=e.n(t),s=e(15054),a=e(32696);function r(d,c,h,o){if(d===a.q5.Fill)return{width:c,height:h};const m=8*6,f=(window.innerWidth-60-s.dU*4)/s.cV*o.gridPos.w,y=s.sD*o.gridPos.h+m,x=Math.min(c/f,h/y);return f<=c&&y<=h?{width:f,height:y}:{width:f*x,height:y*x}}function g(d){return d?.meta.skipDataQuery===!1}const i=(d,c,h,o)=>{let m={...d.defaults};const u=h==null||h==="";return o?m.custom?u?m.custom=(0,t.omit)(m.custom,c):m.custom=l(m.custom,c,h):u||(m.custom=l(m.custom,c,h)):u?m=(0,t.omit)(m,c):m=l(m,c,h),{...d,defaults:m}};function l(d,c,h){const o=Array.isArray(c)?c:c.split("."),m=o.shift();if(m.endsWith("]")){const p=m.lastIndexOf("["),f=+m.substring(p+1,m.length-1),y=m.substring(0,p);let x=d[y];const v=Array.isArray(x)?[...x]:[];return o.length&&(x=v[f],(x==null||typeof x!="object")&&(x={}),h=l(x,o,h)),v[f]=h,{...d,[y]:v}}if(!o.length)return{...d,[m]:h};let u=d[m];return(u==null||typeof u!="object")&&(u={}),{...d,[m]:l(u,o,h)}}},31771:(G,R,e)=>{"use strict";e.d(R,{P:()=>d,Q:()=>c});var t=e(74848),n=e(32196),s=e(40845);const a="https://grafana.com/?src=grafananet&cnt=public-dashboards",r="public/img/grafana_text_logo_light.svg",g="public/img/grafana_text_logo_dark.svg",i="grafana-logo",l=o=>{const m=(0,s.$j)(),u=(0,s.of)(h),{footerHide:p,footerText:f,footerLink:y,footerLogo:x,headerLogoHide:v}=o||{footerHide:!1,footerText:"Powered by",footerLogo:i,footerLink:a,headerLogoHide:!1};return{footerHide:p,footerText:(0,t.jsx)("span",{className:u.text,children:f}),footerLogo:x===i?m.isDark?r:g:x,footerLink:y,headerLogoHide:v}};let d=()=>l();function c(o){d=()=>l(o)}const h=o=>({text:(0,n.css)({color:o.colors.text.secondary,fontSize:o.typography.body.fontSize})})},92378:(G,R,e)=>{"use strict";e.d(R,{G:()=>i,U:()=>l});var t=e(74848),n=e(96540),s=e(84537),a=e(90182),r=e(31678),g=e(87421);const i=({repeat:d,onChange:c,id:h})=>{const o=(0,r.useSelector)(p=>(0,g.SS)((0,g.y7)(p),p)),m=(0,n.useMemo)(()=>{const p=o.map(f=>({label:f.name,value:f.name}));return p.length===0&&p.unshift({label:"No template variables found",value:null}),p.unshift({label:"Disable repeating",value:null}),p},[o]),u=(0,n.useCallback)(p=>c(p.value),[c]);return(0,t.jsx)(a.l6,{inputId:h,value:d,onChange:u,options:m})},l=({sceneContext:d,repeat:c,id:h,onChange:o})=>{const u=(0,n.useMemo)(()=>s.jh.getVariables(d.getRoot()),[d]).useState().variables,p=(0,n.useMemo)(()=>{const y=u.map(x=>({label:x.state.name,value:x.state.name}));return y.length===0&&y.unshift({label:"No template variables found",value:null}),y.unshift({label:"Disable repeating",value:null}),y},[u]),f=(0,n.useCallback)(y=>o(y.value),[o]);return(0,t.jsx)(a.l6,{inputId:h,value:c,onChange:f,options:p})}},78050:(G,R,e)=>{"use strict";e.d(R,{C:()=>i,m:()=>l});var t=e(74848),n=e(13544),s=e(14110),a=e(71678),r=e(55852),g=e(70497);const i=({dashboard:d,onSaveSuccess:c,size:h})=>(0,t.jsx)(a.$s,{children:({showModal:o,hideModal:m})=>(0,t.jsx)(r.$n,{size:h,onClick:()=>{o(g.$,{dashboard:d,onSaveSuccess:c,onDismiss:m})},"aria-label":n.Tp.pages.Dashboard.Settings.General.saveDashBoard,children:"Save dashboard"})}),l=({dashboard:d,onClick:c,onSaveSuccess:h,variant:o,size:m})=>(0,t.jsx)(a.$s,{children:({showModal:u,hideModal:p})=>(0,t.jsx)(r.$n,{size:m,onClick:()=>{(0,s.rR)("grafana_dashboard_save_as_clicked"),c?.(),u(g.$,{dashboard:d,onSaveSuccess:h,onDismiss:p,isCopy:!0})},variant:o,"aria-label":n.Tp.pages.Dashboard.Settings.General.saveAsDashBoard,children:"Save as"})})},54943:(G,R,e)=>{"use strict";e.d(R,{l:()=>l});var t=e(74848),n=e(16817),s=e(67061),a=e(62930),r=e(90613),g=e(19626),i=e(22764);const l=({diff:d,oldValue:c,newValue:h,hasFolderChanges:o,oldFolder:m,newFolder:u})=>{const p=(0,n.A)(async()=>{const y=JSON.stringify(c??{},null,2),x=JSON.stringify(h??{},null,2);let v;const P=[];let E=0;if(d)for(const[D,C]of Object.entries(d)){const b=(0,t.jsx)(g.D,{diffs:C,title:D},D);D==="schemaVersion"?v=b:P.push(b),E+=C.length}return{schemaChange:v,diffs:P,count:E,showDiffs:E<15,jsonView:(0,t.jsx)(i.M,{oldValue:y,newValue:x})}},[d,c,h]),{value:f}=p;return(0,t.jsxs)(s.B,{direction:"column",gap:1,children:[o&&(0,t.jsx)(g.D,{diffs:[{op:"replace",value:u,originalValue:m,path:[],startLineNumber:0,endLineNumber:0}],title:"folder"},"folder"),(!f||!c)&&(0,t.jsx)(a.y,{}),f&&f.count>=1?(0,t.jsxs)(t.Fragment,{children:[f&&f.schemaChange&&f.schemaChange,f&&f.showDiffs&&f.diffs,(0,t.jsxs)(r.a,{paddingTop:1,children:[(0,t.jsx)("h4",{children:"Full JSON diff"}),f.jsonView]})]}):(0,t.jsx)(r.a,{paddingTop:1,children:"No changes in the dashboard JSON"})]})}},70497:(G,R,e)=>{"use strict";e.d(R,{$:()=>we});var t=e(74848),n=e(96540),s=e(17172),a=e(32264),r=e(87978),g=e(63021),i=e(40675),l=e(56596),d=e(32196),c=e(16817),h=e(40845),o=e(42418),m=e(27677);function u({dashboard:We}){const _e=(0,h.of)(p),{loading:at,value:ut,error:Tt}=(0,c.A)(async()=>{const ge=We.getSaveModelCloneOld();return m.IB.validateDashboard(ge).catch(ue=>{if(ue.status>=500)throw ue;return ue.data})},[We]);let It;if(at)It=(0,t.jsx)(o.F,{severity:"info",title:"Checking dashboard validity"});else if(ut)ut.isValid||(It=(0,t.jsxs)(o.F,{severity:"warning",title:"Dashboard failed schema validation",children:[(0,t.jsx)("p",{children:"Validation is provided for development purposes and should be safe to ignore. If you are a Grafana developer, consider checking and updating the dashboard schema"}),(0,t.jsx)("div",{className:_e.error,children:ut.message})]}));else{const ge=Tt?.message??"Unknown error";It=(0,t.jsx)(o.F,{severity:"info",title:"Error checking dashboard validity",children:(0,t.jsx)("p",{className:_e.error,children:ge})})}return It?(0,t.jsx)("div",{className:_e.root,children:It}):null}const p=We=>({root:(0,d.css)({marginTop:We.spacing(1)}),error:(0,d.css)({fontFamily:We.typography.fontFamilyMonospace,whiteSpace:"pre-wrap",overflowX:"auto",maxWidth:"100%"})}),f=u;var y=e(54943),x=e(96374),v=e(37390),P=e(55852),E=e(8484),D=e(78050),C=e(41053),b=e(71733),T=e(14110),S=e(39601),O=e(28138),M=e(3169),I=e(91219),L=e(55314),B=e(31678),j=e(28444),A=e(36974);const K=async(We,_e,at,ut)=>{const Tt=await ut({dashboard:We,folderUid:_e.folderUid??at.meta.folderUid??We.meta?.folderUid,message:_e.message,overwrite:_e.overwrite,k8s:at.meta.k8s});if("error"in Tt)throw Tt.error;return Tt.data},W=(We=!1)=>{const _e=(0,B.useDispatch)(),at=(0,M._2)(),[ut]=(0,L.e8)(),[Tt,It]=(0,C.A)(async(ge,Ie,ue)=>{try{const me=await K(ge,Ie,ue,ut);ue.version=me.version,ge.version=me.version,ue.clearUnsavedChanges(ge,Ie),O.A.publish(new j.Eu),at.success("Dashboard saved"),(0,A.ko)(me.uid),We?(0,T.rR)("grafana_dashboard_copied",{name:ue.title,url:me.url}):(0,T.rR)(`grafana_dashboard_${ue.id?"saved":"created"}`,{name:ue.title,url:me.url});const Pe=S.Ny.getLocation().pathname,Ne=b.I.stripBaseFromUrl(me.url);return Ne!==Pe&&me.url&&setTimeout(()=>S.Ny.replace(Ne)),ue.meta.isStarred&&_e((0,I.TU)({id:ue.uid,title:ue.title,url:Ne})),me}catch(me){throw me instanceof Error&&at.error(me.message??"Error saving dashboard"),me}},[_e,at]);return{state:Tt,onDashboardSave:It}},U=({dashboard:We,dashboardSaveModel:_e,error:at,onDismiss:ut,setErrorIsHandled:Tt})=>{const{onDashboardSave:It}=W(),ge=a.$.featureToggles.dashboardRestore&&a.$.featureToggles.dashboardRestoreUI;return(0,t.jsxs)(t.Fragment,{children:[at.data&&at.data.status==="version-mismatch"&&(0,t.jsx)(x.u,{isOpen:!0,title:"Conflict",body:(0,t.jsxs)("div",{children:["Someone else has updated this dashboard ",(0,t.jsx)("br",{})," ",(0,t.jsx)("small",{children:"Would you still like to save this dashboard?"})]}),confirmText:"Save and overwrite",onConfirm:async()=>{await It(_e,{overwrite:!0},We),ut()},onDismiss:ut}),at.data&&at.data.status==="name-exists"&&(0,t.jsx)(t.Fragment,{children:ge?(0,t.jsxs)(v.a,{isOpen:!0,title:(0,E.t)("save-dashboards.name-exists.title","Dashboard name already exists"),onDismiss:ut,children:[(0,t.jsx)("p",{children:(0,t.jsx)(E.x6,{i18nKey:"save-dashboards.name-exists.message-info",children:"A dashboard with the same name in the selected folder already exists, including recently deleted dashboards."})}),(0,t.jsx)("p",{children:(0,t.jsx)(E.x6,{i18nKey:"save-dashboards.name-exists.message-suggestion",children:"Please choose a different name or folder."})})]}):(0,t.jsx)(x.u,{isOpen:!0,title:"Conflict",body:(0,t.jsxs)("div",{children:["A dashboard with the same name in selected folder already exists. ",(0,t.jsx)("br",{}),(0,t.jsx)("small",{children:"Would you still like to save this dashboard?"})]}),confirmText:"Save and overwrite",onConfirm:async()=>{await It(_e,{overwrite:!0},We),ut()},onDismiss:ut})}),at.data&&at.data.status==="plugin-dashboard"&&(0,t.jsx)(F,{dashboard:We,onDismiss:()=>{Tt(!0),ut()}})]})},F=({onDismiss:We,dashboard:_e})=>{const{onDashboardSave:at}=W(),ut=(0,h.of)(w);return(0,t.jsxs)(v.a,{className:ut.modal,title:"Plugin dashboard",icon:"copy",isOpen:!0,onDismiss:We,children:[(0,t.jsxs)("div",{className:ut.modalText,children:["Your changes will be lost when you update the plugin.",(0,t.jsx)("br",{}),(0,t.jsxs)("small",{children:["Use ",(0,t.jsx)("strong",{children:"Save As"})," to create custom version."]})]}),(0,t.jsxs)(v.a.ButtonRow,{children:[(0,t.jsx)(P.$n,{variant:"secondary",onClick:We,fill:"outline",children:"Cancel"}),(0,t.jsx)(D.m,{onClick:We,dashboard:_e,onSaveSuccess:We}),(0,t.jsx)(P.$n,{variant:"destructive",onClick:async()=>{await at(_e.getSaveModelClone(),{overwrite:!0},_e),We()},children:"Overwrite"})]})]})},V=We=>{switch(We){case"version-mismatch":case"name-exists":case"plugin-dashboard":return!0;default:return!1}},w=We=>({modal:(0,d.css)({width:"500px"}),modalText:(0,d.css)({fontSize:We.typography.h4.fontSize,color:We.colors.text.primary,marginBottom:We.spacing(4),paddingTop:We.spacing(2)}),modalButtonRow:(0,d.css)({marginBottom:"14px","a, button":{marginRight:We.spacing(2)}})});var z=e(51253),N=e(16504),H=e(88575),Q=e(67061),X=e(60029),ee=e(10354),Z=e(21744),q=e(15292),ae=e(36607),k=e(71500),se=e(81394),te=e(27966);const ne=We=>{const _e=We.getSaveModelClone();return _e.id=null,_e.uid="",_e.title+=" Copy",_e.editable=!0,We.id>0&&_e.panels&&_e.panels.forEach(at=>{at.type==="graph"&&at.alert&&delete at.thresholds,delete at.alert}),_e},le=({dashboard:We,isLoading:_e,isNew:at,onSubmit:ut,onCancel:Tt,onSuccess:It})=>{const ge={title:at?We.title:`${We.title} Copy`,description:We.description,$folder:{uid:We.meta.folderUid,title:We.meta.folderTitle},copyTags:!1},Ie=ue=>async me=>{if(me&&me===ue().$folder.title?.trim())return"Dashboard name cannot be the same as folder name";try{return await k.P.validateNewDashboardName(ue().$folder.uid??"general",me),!0}catch(Pe){return Pe instanceof Error?Pe.message:"Dashboard name is invalid"}};return(0,t.jsx)(z.l,{defaultValues:ge,onSubmit:async ue=>{if(!ut)return;const me=ne(We);me.title=ue.title,me.description=ue.description,!at&&!ue.copyTags&&(me.tags=[]),(await ut(me,{folderUid:ue.$folder.uid},We)).status==="success"&&It()},children:({register:ue,control:me,errors:Pe,getValues:Ne})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(N.e,{render:({field:{ref:Fe,...Be}})=>(0,t.jsx)(H.D,{label:(0,t.jsxs)(Q.B,{justifyContent:"space-between",children:[(0,t.jsx)(X.J,{htmlFor:"title",children:"Title"}),a.$.featureToggles.dashgpt&&at&&(0,t.jsx)(te.Z,{onGenerate:he=>Be.onChange(he)})]}),invalid:!!Pe.title,error:Pe.title?.message,children:(0,t.jsx)(ee.p,{...Be,onChange:he=>Be.onChange(he.target.value),"aria-label":"Save dashboard title field",autoFocus:!0})}),control:me,name:"title",rules:{validate:Ie(Ne)}}),(0,t.jsx)(N.e,{render:({field:{ref:Fe,...Be}})=>(0,t.jsx)(H.D,{label:(0,t.jsxs)(Q.B,{justifyContent:"space-between",children:[(0,t.jsx)(X.J,{htmlFor:"description",children:"Description"}),a.$.featureToggles.dashgpt&&at&&(0,t.jsx)(se.V,{onGenerate:he=>Be.onChange(he)})]}),invalid:!!Pe.description,error:Pe.description?.message,children:(0,t.jsx)(Z.f,{...Be,onChange:he=>Be.onChange(he.target.value),"aria-label":"Save dashboard description field",autoFocus:!0})}),control:me,name:"description"}),(0,t.jsx)(H.D,{label:"Folder",children:(0,t.jsx)(N.e,{render:({field:{ref:Fe,...Be}})=>(0,t.jsx)(ae.d,{...Be,onChange:(he,be)=>Be.onChange({uid:he,title:be}),value:Be.value?.uid,initialTitle:We.meta.folderTitle,dashboardId:We.id,enableCreateNew:!0}),control:me,name:"$folder"})}),!at&&(0,t.jsx)(H.D,{label:"Copy tags",children:(0,t.jsx)(q.d,{...ue("copyTags")})}),(0,t.jsxs)(Q.B,{children:[(0,t.jsx)(P.$n,{type:"button",variant:"secondary",onClick:Tt,fill:"outline",children:"Cancel"}),(0,t.jsx)(P.$n,{disabled:_e,type:"submit","aria-label":"Save dashboard button",children:_e?"Saving...":"Save"})]})]})})};var re=e(13544),de=e(10880),oe=e(10740),J=e(57725),ce=e(3363);const pe=["You are an expert in Grafana Dashboards","Your goal is to write a description of the changes for a dashboard to display to the user","You will be given human-readable diffs with most irrelevant lines filtered out"].join(`.
`),xe=["Respond only with the diff description, which is meant to be loaded directly into the application for the user.",'If there are no substantial user or migration changes, the correct description is "Minor changes only"',`If there are too many changes of either kind, and those changes have a message saying 'too long', the correct response for that section is "Too many changes to auto-summarize"`,"In a diff, lines beginning with - are removed, and lines beginning with + are added.","Lines with neither + nor - are included for context. Be careful not to mark them as added or removed if they do not start with + or -.","If a line is changed, it will show a previous version removed and a new version added","When referring to panel changes, use the panel title","When using panel title, wrap it with double quotes","When the panel changes position, just mention that the panel has changed position","When an entire panel is added or removed, use the panel title and only say it was added or removed and disregard the rest of the changes for that panel","Group together similar changes into one line when multiple panels are affected","Refer to templating elements as variables","Try to make the response as short as possible"].join(`.
`),fe=({dashboard:We,onGenerate:_e,disabled:at})=>{const ut=(0,n.useCallback)(()=>Ee(We),[We]);return(0,t.jsx)(oe.n,{messages:ut,onGenerate:_e,temperature:0,model:"gpt-3.5-turbo-16k",eventTrackingSrc:J.ec.dashboardChanges,toggleTipTitle:"Improve your dashboard changes summary",disabled:at})};function Ee(We){let{userChanges:_e,migrationChanges:at}=(0,ce.Yy)(We);return _e.length>8e3&&(_e="User changes were too long, fill in the user changes section with 'User changes too long to auto-summarize'"),at.split(`
`).length<10?at="No significant migration changes":at.length>8e3&&(at="Migration changes were too long, fill in the migration changes section with 'Migration changes too long to auto-summarize'"),[{content:pe,role:ce.Xh.system},{content:`Summarize the following user changes diff under "User changes":
${_e}`,role:ce.Xh.system},{content:`Be sure to only include substantial user changes, such as adding or removing entire panels, changing panel titles or descriptions, etc.
Do not include "User Changes" section if there are no substantial user changes to report.`,role:ce.Xh.system},{content:`Summarize the following migration changes diff under "Migration changes":
${at}`,role:ce.Xh.system},{content:`Be sure to only include substantial migration changes, such as adding or removing entire panels, changing panel titles or descriptions, etc.
Ignore any threshold step changes or templating list changes.
Ignore other changes and do not include them in the summary. Do not include "Migration Changes" section if there are no substantial migration changes to report.
If there are substantial migration changes, add "Some autogenerated changes are included to update the dashboard to the latest valid schema version" at the end.`,role:ce.Xh.system},{content:xe,role:ce.Xh.system}]}const Se=({dashboard:We,isLoading:_e,saveModel:at,options:ut,onSubmit:Tt,onCancel:It,onSuccess:ge,onOptionsChange:Ie})=>{const ue=(0,n.useMemo)(()=>We.hasTimeChanged(),[We]),me=(0,n.useMemo)(()=>We.hasVariablesChanged(),[We]),[Pe,Ne]=(0,n.useState)(!1),[Fe,Be]=(0,n.useState)(ut.message),he=(0,h.of)(ye);return(0,t.jsx)("form",{onSubmit:async be=>{if(be.preventDefault(),!Tt)return;Ne(!0),ut={...ut,message:Fe},(await Tt(at.clone,ut,We)).status==="success"?ge():Ne(!1)},style:{maxWidth:600},children:(0,t.jsxs)(Q.B,{gap:2,direction:"column",alignItems:"flex-start",children:[ue&&(0,t.jsx)(de.S,{checked:!!ut.saveTimerange,onChange:()=>Ie({...ut,saveTimerange:!ut.saveTimerange}),label:"Save current time range as dashboard default","aria-label":re.Tp.pages.SaveDashboardModal.saveTimerange}),me&&(0,t.jsx)(de.S,{checked:!!ut.saveVariables,onChange:()=>Ie({...ut,saveVariables:!ut.saveVariables}),label:"Save current variable values as dashboard default","aria-label":re.Tp.pages.SaveDashboardModal.saveVariables}),(0,t.jsxs)("div",{className:he.message,children:[a.$.featureToggles.aiGeneratedDashboardChanges&&(0,t.jsx)(fe,{dashboard:We,onGenerate:be=>{Ie({...ut,message:be}),Be(be)},disabled:!at.hasChanges}),(0,t.jsx)(Z.f,{"aria-label":"message",value:Fe,onChange:be=>{Ie({...ut,message:be.currentTarget.value}),Be(be.currentTarget.value)},placeholder:"Add a note to describe your changes.",autoFocus:!0,rows:5})]}),(0,t.jsxs)(Q.B,{alignItems:"center",children:[(0,t.jsx)(P.$n,{variant:"secondary",onClick:It,fill:"outline",children:"Cancel"}),(0,t.jsx)(P.$n,{type:"submit",disabled:!at.hasChanges||_e,icon:Pe?"spinner":void 0,"aria-label":re.Tp.pages.SaveDashboardModal.save,children:_e?"Saving...":"Save"}),!at.hasChanges&&(0,t.jsx)("div",{children:"No changes to save"})]})]})})};function ye(We){return{message:(0,d.css)({display:"flex",alignItems:"end",flexDirection:"column",width:"100%"})}}var Ve=e(4213),Me=e(66864),Ce=e(10534);const Ue=({dashboard:We,onCancel:_e})=>{const[at,ut]=(0,n.useState)(()=>{const It=We.getSaveModelClone();return delete It.id,JSON.stringify(It,null,2)}),Tt=(0,n.useCallback)(()=>{const It=new Blob([at],{type:"application/json;charset=utf-8"});(0,Ve.saveAs)(It,We.title+"-"+new Date().getTime()+".json")},[We.title,at]);return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(Q.B,{direction:"column",gap:2,children:[(0,t.jsxs)("div",{children:["This dashboard cannot be saved from the Grafana UI because it has been provisioned from another source. Copy the JSON or save it to a file below, then you can update your dashboard in the provisioning source.",(0,t.jsx)("br",{}),(0,t.jsxs)("i",{children:["See"," ",(0,t.jsx)("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",target:"_blank",rel:"noreferrer",children:"documentation"})," ","for more information about provisioning."]}),(0,t.jsx)("br",{})," ",(0,t.jsx)("br",{}),(0,t.jsx)("strong",{children:"File path: "})," ",We.meta.provisionedExternalId]}),(0,t.jsx)(Z.f,{spellCheck:!1,value:at,onChange:It=>{ut(It.currentTarget.value)},className:Ae.json}),(0,t.jsxs)(Me.Gy,{children:[(0,t.jsx)(P.$n,{variant:"secondary",onClick:_e,fill:"outline",children:"Cancel"}),(0,t.jsx)(Ce.b,{icon:"copy",getText:()=>at,children:"Copy JSON to clipboard"}),(0,t.jsx)(P.$n,{type:"submit",onClick:Tt,children:"Save JSON to file"})]})]})})},Ae={json:(0,d.css)({height:"400px",width:"100%",overflow:"auto",resize:"none",fontFamily:"monospace"})},we=({dashboard:We,onDismiss:_e,onSaveSuccess:at,isCopy:ut})=>{const[Tt,It]=(0,n.useState)({}),ge=We.getOriginalDashboard(),Ie=We.meta.provisioned,ue=We.version===0,me=!!We.meta.hasUnsavedFolderChange,[Pe,Ne]=(0,n.useState)(!1),Fe=(0,n.useMemo)(()=>{const ot=We.getSaveModelClone({saveTimerange:!!Tt.saveTimerange,saveVariables:!!Tt.saveVariables});if(!ge)return{clone:ot,diff:{},diffCount:0,hasChanges:!1};const gt=(0,l.G4)(ge,ot);let He=0;for(const et of Object.values(gt))He+=et.length;return{clone:ot,diff:gt,diffCount:He,hasChanges:(He>0||me)&&!ue}},[We,ge,Tt,ue,me]),[Be,he]=(0,n.useState)(!1),{state:be,onDashboardSave:Ke}=W(ut),ze=at?()=>{_e(),at()}:_e,nt=()=>Be?(0,t.jsx)(y.l,{diff:Fe.diff,oldValue:ge,newValue:Fe.clone}):ue||ut?(0,t.jsx)(le,{dashboard:We,isLoading:be.loading,onCancel:_e,onSuccess:ze,onSubmit:Ke,isNew:ue}):Ie?(0,t.jsx)(Ue,{dashboard:We,onCancel:_e,onSuccess:ze}):(0,t.jsx)(Se,{dashboard:We,isLoading:be.loading,saveModel:Fe,onCancel:_e,onSuccess:ze,onSubmit:Ke,options:Tt,onOptionsChange:It});if(be.error&&!Pe&&(0,s.NF)(be.error)&&V(be.error.data.status))return(0,t.jsx)(U,{error:be.error,dashboard:We,dashboardSaveModel:Fe.clone,onDismiss:_e,setErrorIsHandled:Ne});let tt="Save dashboard";return ut?tt="Save dashboard copy":Ie&&(tt="Provisioned dashboard"),(0,t.jsxs)(r._,{title:tt,onClose:_e,subtitle:We.title,tabs:(0,t.jsxs)(g.U,{children:[(0,t.jsx)(i.o,{label:"Details",active:!Be,onChangeTab:()=>he(!1)}),Fe.hasChanges&&(0,t.jsx)(i.o,{label:"Changes",active:Be,onChangeTab:()=>he(!0),counter:Fe.diffCount})]}),children:[nt(),a.$.featureToggles.showDashboardValidationWarnings&&(0,t.jsx)(f,{dashboard:We})]})}},35280:(G,R,e)=>{"use strict";e.d(R,{D:()=>x});var t=e(74848),n=e(96540),s=e(94701),a=e(14110),r=e(32264),g=e(10534),i=e(88575),l=e(67061),d=e(15292),c=e(60029),h=e(21744),o=e(55852),m=e(37390),u=e(8484),p=e(7758),f=e(87895),y=e(22699);function x({panel:v,dashboard:P,range:E,onCancelClick:D,buildIframe:C=y.CF}){const[b,T]=(0,n.useState)(!0),[S,O]=(0,n.useState)("current"),[M,I]=(0,n.useState)("");(0,s.A)(()=>{(0,a.rR)("grafana_dashboards_embed_share_viewed",{shareResource:(0,y.hD)(v)})}),(0,n.useEffect)(()=>{const K=C(b,P.uid,S,v,E);I(K)},[S,b,P,v,E,C]);const L=K=>{I(K.currentTarget.value)},B=()=>{T(K=>!K)},j=K=>{O(K)},A=(0,t.jsx)(g.b,{icon:"copy",variant:"primary",getText:()=>M,onClipboardCopy:()=>{p.c.embedSnippetCopy({currentTimeRange:b,theme:S,shareResource:(0,y.hD)(v)})},children:(0,t.jsx)(u.x6,{i18nKey:"share-modal.embed.copy",children:"Copy to clipboard"})});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{children:(0,t.jsx)(u.x6,{i18nKey:"share-modal.embed.info",children:"Generate HTML for embedding an iframe with this panel"})}),(0,t.jsx)(i.D,{children:(0,t.jsxs)(l.B,{gap:1,alignItems:"start",children:[(0,t.jsx)(d.d,{label:(0,u.t)("share-modal.embed.time-range","Lock time range"),id:"share-current-time-range",value:b,onChange:B}),(0,t.jsx)(c.J,{description:(0,u.t)("embed.share.time-range-description","Change the current relative time range to an absolute time range"),children:(0,t.jsx)(u.x6,{i18nKey:"embed.share.time-range-label",children:"Lock time range"})})]})}),(0,t.jsx)(f.w,{selectedTheme:S,onChange:j}),(0,t.jsx)(i.D,{label:(0,u.t)("share-modal.embed.html","Embed HTML"),description:(0,u.t)("share-modal.embed.html-description","The HTML code below can be pasted and included in another web page. Unless anonymous access is enabled, the users viewing that page need to be signed into Grafana for the graph to load."),children:(0,t.jsx)(h.f,{"data-testid":"share-embed-html",id:"share-panel-embed-embed-html-textarea",rows:5,value:M,onChange:L})}),r.$.featureToggles.newDashboardSharingComponent?(0,t.jsxs)(l.B,{gap:1,justifyContent:"start",children:[A,(0,t.jsx)(o.$n,{variant:"secondary",fill:"outline",onClick:D,children:(0,t.jsx)(u.x6,{i18nKey:"snapshot.share.cancel-button",children:"Cancel"})})]}):(0,t.jsx)(m.a.ButtonRow,{children:A})]})}},86394:(G,R,e)=>{"use strict";e.d(R,{j:()=>i});var t=e(74848),n=e(96540),s=e(14110),a=e(8484),r=e(96227),g=e(22699);const i=({panel:l,initialFolderUid:d,onCreateLibraryPanel:c,onDismiss:h})=>((0,n.useEffect)(()=>{(0,s.rR)("grafana_dashboards_library_panel_share_viewed",{shareResource:(0,g.hD)(l)})},[l]),l?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{children:(0,t.jsx)(a.x6,{i18nKey:"share-modal.library.info",children:"Create library panel."})}),(0,t.jsx)(r.b,{panel:l,initialFolderUid:d,onCreateLibraryPanel:c,onDismiss:h})]}):null)},7686:(G,R,e)=>{"use strict";e.d(R,{Zy:()=>te,mJ:()=>Z});var t=e(74848),n=e(96540),s=e(25897),a=e(37390),r=e(40980),g=e(40845),i=e(2913),l=e(10096),d=e(8484),c=e(4785),h=e(72254),o=e(7758),m=e(82792),u=e(35280),p=e(4213),f=e(88575),y=e(15292),x=e(55852),v=e(15858),P=e(28444),E=e(70713),D=e(32372),C=e(10534);function b({json:ne,onDismiss:le}){const re=(0,n.useCallback)(()=>ne,[ne]);return(0,t.jsxs)(a.a,{title:"JSON",onDismiss:le,onClickBackdrop:le,isOpen:!0,children:[(0,t.jsx)(E.Ay,{disableHeight:!0,children:({width:de})=>(0,t.jsx)(D.B,{value:ne,language:"json",showMiniMap:!1,height:"500px",width:de})}),(0,t.jsx)(a.a.ButtonRow,{children:(0,t.jsx)(C.b,{icon:"copy",getText:re,onClipboardCopy:()=>{o.c.exportCopyJsonClicked()},children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.view-json.copy-button",children:"Copy to Clipboard"})})})]})}var T=e(22699);class S extends n.PureComponent{constructor(le){super(le),this.onShareExternallyChange=()=>{this.setState({shareExternally:!this.state.shareExternally})},this.onSaveAsFile=()=>{const{dashboard:re}=this.props,{shareExternally:de}=this.state;o.c.exportSaveJsonClicked({externally:de,shareResource:(0,T.hD)(this.props.panel)}),de?this.exporter.makeExportable(re).then(oe=>{this.openSaveAsDialog(oe)}):this.openSaveAsDialog(re.getSaveModelClone())},this.onViewJson=()=>{const{dashboard:re}=this.props,{shareExternally:de}=this.state;o.c.exportViewJsonClicked({externally:de,shareResource:(0,T.hD)(this.props.panel)}),de?this.exporter.makeExportable(re).then(oe=>{this.openJsonModal(oe)}):this.openJsonModal(re.getSaveModelClone())},this.openSaveAsDialog=re=>{const de=JSON.stringify(re,null,2),oe=new Blob([de],{type:"application/json;charset=utf-8"}),J=new Date().getTime();(0,p.saveAs)(oe,`${re.title}-${J}.json`)},this.openJsonModal=re=>{l.lE.publish(new P.S8({props:{json:JSON.stringify(re,null,2)},component:b})),this.props.onDismiss?.()},this.state={shareExternally:!1},this.exporter=new v.M}render(){const{onDismiss:le}=this.props,{shareExternally:re}=this.state,de=(0,d.t)("share-modal.export.share-externally-label","Export for sharing externally");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.export.info-text",children:"Export this dashboard."})}),(0,t.jsx)(f.D,{label:de,children:(0,t.jsx)(y.d,{id:"share-externally-toggle",value:re,onChange:this.onShareExternallyChange})}),(0,t.jsxs)(a.a.ButtonRow,{children:[(0,t.jsx)(x.$n,{variant:"secondary",onClick:le,fill:"outline",children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.export.cancel-button",children:"Cancel"})}),(0,t.jsx)(x.$n,{variant:"secondary",onClick:this.onViewJson,children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.export.view-button",children:"View JSON"})}),(0,t.jsx)(x.$n,{variant:"primary",onClick:this.onSaveAsFile,children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.export.save-button",children:"Save to file"})})]})]})}}var O=e(86394),M=e(13544),I=e(84167),L=e(10354),B=e(72109),j=e(42418),A=e(87895);class K extends n.PureComponent{constructor(le){super(le),this.buildUrl=async()=>{const{panel:re,dashboard:de}=this.props,{useCurrentTimeRange:oe,useShortUrl:J,selectedTheme:ce}=this.state,pe=await(0,T.Xe)(oe,ce,re,J),xe=(0,T.Lb)(oe,de.uid,ce,re);this.setState({shareUrl:pe,imageUrl:xe})},this.onUseCurrentTimeRangeChange=()=>{this.setState({useCurrentTimeRange:!this.state.useCurrentTimeRange})},this.onUrlShorten=()=>{this.setState({useShortUrl:!this.state.useShortUrl})},this.onThemeChange=re=>{this.setState({selectedTheme:re})},this.getShareUrl=()=>this.state.shareUrl,this.onCopy=()=>{o.c.shareLinkCopied({currentTimeRange:this.state.useCurrentTimeRange,theme:this.state.selectedTheme,shortenURL:this.state.useShortUrl,shareResource:(0,T.hD)(this.props.panel)})},this.state={useCurrentTimeRange:!0,useShortUrl:!1,selectedTheme:"current",shareUrl:"",imageUrl:""}}componentDidMount(){this.buildUrl()}componentDidUpdate(le,re){const{useCurrentTimeRange:de,useShortUrl:oe,selectedTheme:J}=this.state;(re.useCurrentTimeRange!==de||re.selectedTheme!==J||re.useShortUrl!==oe)&&this.buildUrl()}render(){const{panel:le,dashboard:re}=this.props,de=re?re.time.to==="now":!1,{useCurrentTimeRange:oe,useShortUrl:J,selectedTheme:ce,shareUrl:pe,imageUrl:xe}=this.state,fe=M.Tp.pages.SharePanelModal,Ee=!!re.id,Se=(0,d.t)("share-modal.link.time-range-label","Lock time range"),ye=(0,d.t)("share-modal.link.time-range-description","Transforms the current relative time range to an absolute time range"),Ve=(0,d.t)("share-modal.link.shorten-url","Shorten URL"),Me=(0,d.t)("share-modal.link.link-url","Link URL");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.link.info-text",children:"Create a direct link to this dashboard or panel, customized with the options below."})}),(0,t.jsxs)(I.n,{children:[(0,t.jsx)(f.D,{label:Se,description:de?ye:"",children:(0,t.jsx)(y.d,{id:"share-current-time-range",value:oe,onChange:this.onUseCurrentTimeRangeChange})}),(0,t.jsx)(A.w,{selectedTheme:ce,onChange:this.onThemeChange}),(0,t.jsx)(f.D,{label:Ve,children:(0,t.jsx)(y.d,{id:"share-shorten-url",value:J,onChange:this.onUrlShorten})}),(0,t.jsx)(f.D,{label:Me,children:(0,t.jsx)(L.p,{id:"link-url-input",value:pe,readOnly:!0,addonAfter:(0,t.jsx)(C.b,{icon:"copy",variant:"primary",getText:this.getShareUrl,onClipboardCopy:this.onCopy,children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.link.copy-link-button",children:"Copy"})})})})]}),le&&i.Ay.rendererAvailable&&(0,t.jsxs)(t.Fragment,{children:[Ee&&(0,t.jsx)(B.Y,{href:xe,external:!0,icon:"camera","aria-label":fe.linkToRenderedImage,children:(0,d.t)("share-modal.link.rendered-image","Direct link rendered image")}),!Ee&&(0,t.jsx)(j.F,{severity:"info",title:(0,d.t)("share-modal.link.save-alert","Dashboard is not saved"),bottomSpacing:0,children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.link.save-dashboard",children:"To render a panel image, you must save the dashboard first."})})]}),le&&!i.Ay.rendererAvailable&&(0,t.jsx)(j.F,{severity:"info",title:(0,d.t)("share-modal.link.render-alert","Image renderer plugin not installed"),bottomSpacing:0,children:(0,t.jsxs)(d.x6,{i18nKey:"share-modal.link.render-instructions",children:["To render a panel image, you must install the"," ",(0,t.jsx)(B.Y,{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",external:!0,children:"Grafana image renderer plugin"}),". Please contact your Grafana administrator to install the plugin."]})})]})}}var W=e(92041),U=e(12470),F=e(17172),V=e(90182),w=e(67061),z=e(62930),N=e(74856),H=e(69064);class Q extends n.PureComponent{constructor(le){super(le),this.createSnapshot=re=>()=>{const{timeoutSeconds:de}=this.state;this.dashboard.snapshot={timestamp:new Date},this.setState({isLoading:!0}),this.dashboard.startRefresh(),setTimeout(()=>{this.saveSnapshot(this.dashboard,re)},de*1e3)},this.saveSnapshot=async(re,de)=>{const{snapshotExpires:oe,timeoutSeconds:J}=this.state,ce=this.dashboard.getSaveModelCloneOld();this.scrubDashboard(ce);const pe={dashboard:ce,name:ce.title,expires:oe,external:de};try{const xe=await(0,H.s)().create(pe);this.setState({deleteUrl:xe.deleteUrl,snapshotUrl:xe.url,step:2})}finally{de?o.c.publishSnapshotClicked({expires:oe,timeout:J,shareResource:(0,T.hD)(this.props.panel)}):o.c.publishSnapshotLocalClicked({expires:oe,timeout:J,shareResource:(0,T.hD)(this.props.panel)}),this.setState({isLoading:!1})}},this.scrubDashboard=re=>{const{panel:de}=this.props,{snapshotName:oe}=this.state;re.title=oe,re.time=(0,N.jG)().timeRange(),re.links=[],re.panels.forEach(ce=>{ce.targets=[],ce.links=[],ce.datasource=null});const J=re.annotations.list.filter(ce=>ce.enable);if(re.annotations.list=J.map(ce=>({name:ce.name,enable:ce.enable,iconColor:ce.iconColor,snapshotData:ce.snapshotData,type:ce.type,builtIn:ce.builtIn,hide:ce.hide})),re.getVariables().forEach(ce=>{"query"in ce&&(ce.query=""),"options"in ce&&(ce.options=ce.current&&!(0,W.R)(ce.current)?[ce.current]:[]),"refresh"in ce&&(ce.refresh=U.CO.never)}),de){const ce=de.getSaveModel();ce.gridPos.w=24,ce.gridPos.x=0,ce.gridPos.y=0,ce.gridPos.h=20,re.panels=[ce]}delete this.dashboard.snapshot,this.dashboard.forEachPanel(ce=>{delete ce.snapshotData}),this.dashboard.annotations.list.forEach(ce=>{delete ce.snapshotData})},this.deleteSnapshot=async()=>{const{deleteUrl:re}=this.state;await(0,F.AI)().get(re),this.setState({step:3})},this.getSnapshotUrl=()=>this.state.snapshotUrl,this.onSnapshotNameChange=re=>{this.setState({snapshotName:re.target.value})},this.onTimeoutChange=re=>{this.setState({timeoutSeconds:Number(re.target.value)})},this.onExpireChange=re=>{this.setState({selectedExpireOption:re,snapshotExpires:re.value})},this.dashboard=le.dashboard,this.expireOptions=[{label:(0,d.t)("share-modal.snapshot.expire-hour","1 Hour"),value:60*60},{label:(0,d.t)("share-modal.snapshot.expire-day","1 Day"),value:60*60*24},{label:(0,d.t)("share-modal.snapshot.expire-week","1 Week"),value:60*60*24*7},{label:(0,d.t)("share-modal.snapshot.expire-never","Never"),value:0}],this.state={isLoading:!1,step:1,selectedExpireOption:this.expireOptions[2],snapshotExpires:this.expireOptions[2].value,snapshotName:le.dashboard.title,timeoutSeconds:4,snapshotUrl:"",deleteUrl:"",externalEnabled:!1,sharingButtonText:""}}componentDidMount(){this.getSnaphotShareOptions()}async getSnaphotShareOptions(){const le=await(0,H.s)().getSharingOptions();this.setState({sharingButtonText:le.externalSnapshotName,externalEnabled:le.externalEnabled})}renderStep1(){const{onDismiss:le}=this.props,{snapshotName:re,selectedExpireOption:de,timeoutSeconds:oe,isLoading:J,sharingButtonText:ce,externalEnabled:pe}=this.state,xe=(0,d.t)("share-modal.snapshot.name","Snapshot name"),fe=(0,d.t)("share-modal.snapshot.expire","Expire"),Ee=(0,d.t)("share-modal.snapshot.timeout","Timeout (seconds)"),Se=(0,d.t)("share-modal.snapshot.timeout-description","You might need to configure the timeout value if it takes a long time to collect your dashboard metrics.");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.snapshot.info-text-1",children:"A snapshot is an instant way to share an interactive dashboard publicly. When created, we strip sensitive data like queries (metric, template, and annotation) and panel links, leaving only the visible metric data and series names embedded in your dashboard."})}),(0,t.jsx)("p",{children:(0,t.jsxs)(d.x6,{i18nKey:"share-modal.snapshot.info-text-2",children:["Keep in mind, your snapshot ",(0,t.jsx)("em",{children:"can be viewed by anyone"})," that has the link and can access the URL. Share wisely."]})})]}),(0,t.jsx)(f.D,{label:xe,children:(0,t.jsx)(L.p,{id:"snapshot-name-input",width:30,value:re,onChange:this.onSnapshotNameChange})}),(0,t.jsx)(f.D,{label:fe,children:(0,t.jsx)(V.l6,{inputId:"expire-select-input",width:30,options:this.expireOptions,value:de,onChange:this.onExpireChange})}),(0,t.jsx)(f.D,{label:Ee,description:Se,children:(0,t.jsx)(L.p,{id:"timeout-input",type:"number",width:21,value:oe,onChange:this.onTimeoutChange})}),(0,t.jsxs)(a.a.ButtonRow,{children:[(0,t.jsx)(x.$n,{variant:"secondary",onClick:le,fill:"outline",children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.snapshot.cancel-button",children:"Cancel"})}),pe&&(0,t.jsx)(x.$n,{variant:"secondary",disabled:J,onClick:this.createSnapshot(!0),children:ce}),(0,t.jsx)(x.$n,{variant:"primary",disabled:J,onClick:this.createSnapshot(),children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.snapshot.local-button",children:"Publish Snapshot"})})]})]})}renderStep2(){const{snapshotUrl:le}=this.state;return(0,t.jsxs)(w.B,{direction:"column",gap:0,children:[(0,t.jsx)(f.D,{label:(0,d.t)("share-modal.snapshot.url-label","Snapshot URL"),children:(0,t.jsx)(L.p,{id:"snapshot-url-input",value:le,readOnly:!0,addonAfter:(0,t.jsx)(C.b,{icon:"copy",variant:"primary",getText:this.getSnapshotUrl,children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.snapshot.copy-link-button",children:"Copy"})})})}),(0,t.jsxs)("div",{style:{alignSelf:"flex-end",padding:"5px"},children:[(0,t.jsx)(d.x6,{i18nKey:"share-modal.snapshot.mistake-message",children:"Did you make a mistake? "}),"\xA0",(0,t.jsx)(x.z9,{fill:"text",target:"_blank",onClick:this.deleteSnapshot,children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.snapshot.delete-button",children:"Delete snapshot."})})]})]})}renderStep3(){return(0,t.jsx)("p",{children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.snapshot.deleted-message",children:"The snapshot has been deleted. If you have already accessed it once, then it might take up to an hour before before it is removed from browser caches or CDN caches."})})}render(){const{isLoading:le,step:re}=this.state;return(0,t.jsxs)(t.Fragment,{children:[re===1&&this.renderStep1(),re===2&&this.renderStep2(),re===3&&this.renderStep3(),le&&(0,t.jsx)(z.y,{inline:!0})]})}}const X=[],ee=[];function Z(ne){X.push(ne)}function q(ne){ee.push(ne)}function ae(ne,le,re){const oe=[{label:(0,d.t)("share-modal.tab-title.link","Link"),value:T.wr.link,component:K}];if(l.TP.isSignedIn&&i.$W.snapshotEnabled&&ne){const ce=(0,d.t)("share-modal.tab-title.snapshot","Snapshot");oe.push({label:ce,value:T.wr.snapshot,component:Q})}if(le){const ce=(0,d.t)("share-modal.tab-title.embed","Embed");if(oe.push({label:ce,value:T.wr.embed,component:u.D}),!(0,m.X)(le)){const pe=(0,d.t)("share-modal.tab-title.library-panel","Library panel");oe.push({label:pe,value:T.wr.libraryPanel,component:O.j})}oe.push(...ee)}else{const ce=(0,d.t)("share-modal.tab-title.export","Export");oe.push({label:ce,value:T.wr.export,component:S}),oe.push(...X),(0,h.iR)()&&oe.push({label:(0,d.t)("share-modal.tab-title.public-dashboard-title","Public dashboard"),value:T.wr.publicDashboard,component:c.b})}const J=oe.find(ce=>ce.value===re);return{tabs:oe,activeTab:J?.value??oe[0].value}}function k(ne){const{tabs:le,activeTab:re}=ae(ne.dashboard.canEditDashboard(),ne.panel,ne.activeTab);return{tabs:le,activeTab:re}}class se extends n.Component{constructor(le){super(le),this.onSelectTab=re=>{this.setState(de=>({...de,activeTab:re.value})),o.c.sharingCategoryClicked({item:re.value,shareResource:(0,T.hD)(this.props.panel)})},this.state=k(le)}getActiveTab(){const{tabs:le,activeTab:re}=this.state;return le.find(de=>de.value===re)}renderTitle(){const{panel:le}=this.props,{activeTab:re}=this.state,de=le?(0,d.t)("share-modal.panel.title","Share Panel"):(0,d.t)("share-modal.dashboard.title","Share"),oe=this.props.dashboard.canEditDashboard(),J=ae(oe,this.props.panel,this.state.activeTab).tabs;return(0,t.jsx)(s.J,{title:de,icon:"share-alt",tabs:J,activeTab:re,onChangeTab:this.onSelectTab})}render(){const{dashboard:le,panel:re}=this.props,oe=this.getActiveTab().component;return(0,t.jsx)(a.a,{isOpen:!0,title:this.renderTitle(),onDismiss:this.props.onDismiss,children:(0,t.jsx)(r.J,{children:(0,t.jsx)(oe,{dashboard:le,panel:re,onDismiss:this.props.onDismiss})})})}}const te=(0,g.cV)(se)},59037:(G,R,e)=>{"use strict";e.d(R,{K:()=>de,b:()=>re});var t=e(74848),n=e(32196),s=e(49785),a=e(13544),r=e(40845),g=e(88575),i=e(10354),l=e(10534),d=e(15292),c=e(60029),h=e(66864),o=e(55852),m=e(71678),u=e(8484),p=e(72686),f=e(21380),y=e(7758),x=e(90591),v=e(16233),P=e(31678),E=e(52908);const D=()=>{const{width:J}=(0,E.A)();return J>1024};var C=e(7686),b=e(22699),T=e(6923),S=e(42418);const O=()=>(0,t.jsx)(S.F,{title:(0,u.t)("public-dashboard.modal-alerts.save-dashboard-changes-alert-title","Please save your dashboard changes before updating the public configuration"),severity:"warning",bottomSpacing:0});var M=e(12257),I=e(10872),L=e(72254),B=e(84167),j=e(54230);const A=a.Tp.pages.ShareDashboardModal.PublicDashboard,K=({disabled:J,onChange:ce,register:pe,timeRange:xe})=>(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(B.n,{disabled:J,children:(0,t.jsxs)(h.gW,{spacing:"md",children:[(0,t.jsxs)(h.PE,{orientation:1,spacing:"xs",justify:"space-between",children:[(0,t.jsx)(c.J,{description:(0,u.t)("public-dashboard.settings-configuration.default-time-range-label-desc","The public dashboard uses the default time range settings of the dashboard"),children:(0,t.jsx)(u.x6,{i18nKey:"public-dashboard.settings-configuration.default-time-range-label",children:"Default time range"})}),(0,t.jsx)(j.b,{value:xe,disabled:!0,onChange:()=>{}})]}),(0,t.jsxs)(h.PE,{orientation:0,spacing:"sm",children:[(0,t.jsx)(d.d,{...pe("isTimeSelectionEnabled"),"data-testid":A.EnableTimeRangeSwitch,onChange:fe=>{ce("isTimeSelectionEnabled",fe.currentTarget.checked),y.c.publicDashboardTimeSelectionChanged({enabled:fe.currentTarget.checked})}}),(0,t.jsx)(c.J,{description:(0,u.t)("public-dashboard.settings-configuration.time-range-picker-label-desc","Allow viewers to change time range"),children:(0,t.jsx)(u.x6,{i18nKey:"public-dashboard.settings-configuration.time-range-picker-label",children:"Time range picker enabled"})})]}),(0,t.jsxs)(h.PE,{orientation:0,spacing:"sm",children:[(0,t.jsx)(d.d,{...pe("isAnnotationsEnabled"),onChange:fe=>{ce("isAnnotationsEnabled",fe.currentTarget.checked),y.c.publicDashboardAnnotationsSelectionChanged({enabled:fe.currentTarget.checked})},"data-testid":A.EnableAnnotationsSwitch}),(0,t.jsx)(c.J,{description:(0,u.t)("public-dashboard.settings-configuration.show-annotations-label-desc","Show annotations on public dashboard"),children:(0,t.jsx)(u.x6,{i18nKey:"public-dashboard.settings-configuration.show-annotations-label",children:"Show annotations"})})]})]})})});var W=e(19727),U=e(94354),F=e(62930),V=e(55600);const w=a.Tp.pages.ShareDashboardModal.PublicDashboard.EmailSharingConfiguration,z=({recipients:J,dashboardUid:ce,publicDashboardUid:pe})=>{const xe=(0,r.of)(H),[fe,{isLoading:Ee}]=(0,p.$L)(),[Se,{isLoading:ye}]=(0,p.NA)(),Ve=Ee||ye,Me=(Ue,Ae)=>{y.c.revokePublicDashboardEmailClicked(),fe({recipientUid:Ue,recipientEmail:Ae,dashboardUid:ce,uid:pe})},Ce=Ue=>{y.c.resendPublicDashboardEmailClicked(),Se({recipientUid:Ue,uid:pe})};return(0,t.jsx)("table",{className:xe.table,"data-testid":w.EmailSharingList,children:(0,t.jsx)("tbody",{children:J.map((Ue,Ae)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:Ue.recipient}),(0,t.jsx)("td",{children:(0,t.jsxs)(W.e,{className:xe.tableButtonsContainer,children:[(0,t.jsx)(o.$n,{type:"button",variant:"destructive",fill:"text",title:(0,u.t)("public-dashboard.email-sharing.revoke-button-title","Revoke"),size:"sm",disabled:Ve,onClick:()=>Me(Ue.uid,Ue.recipient),"data-testid":`${w.DeleteEmail}-${Ae}`,children:(0,t.jsx)(u.x6,{i18nKey:"public-dashboard.email-sharing.revoke-button",children:"Revoke"})}),(0,t.jsx)(o.$n,{type:"button",variant:"primary",fill:"text",title:(0,u.t)("public-dashboard.email-sharing.resend-button-title","Resend"),size:"sm",disabled:Ve,onClick:()=>Ce(Ue.uid),"data-testid":`${w.ReshareLink}-${Ae}`,children:(0,t.jsx)(u.x6,{i18nKey:"public-dashboard.email-sharing.resend-button",children:"Resend"})})]})})]},Ue.uid))})})},N=({dashboard:J})=>{const{width:ce}=(0,E.A)(),pe=(0,r.of)(H),xe=J instanceof V.H$?J.state.uid:J.uid,{data:fe}=(0,p.Bs)(xe),[Ee]=(0,p.ft)(),[Se,{isLoading:ye}]=(0,p.NY)(),Ve=v.TP.hasPermission(P.AccessControlAction.DashboardsPublicWrite),{register:Me,setValue:Ce,control:Ue,watch:Ae,handleSubmit:we,formState:{errors:We},reset:_e}=(0,s.mN)({defaultValues:{shareType:fe?.share||L.Xo.PUBLIC,email:""},mode:"onSubmit"}),at=Tt=>{const It={dashboard:J,payload:{...fe,share:Tt}};Ee(It)},ut=async Tt=>{y.c.publicDashboardEmailInviteClicked(),await Se({recipient:Tt.email,uid:fe.uid,dashboardUid:xe}).unwrap(),_e({email:"",shareType:L.Xo.EMAIL})};return(0,t.jsx)("form",{onSubmit:we(ut),children:(0,t.jsxs)(B.n,{disabled:!Ve,"data-testid":w.Container,className:pe.container,children:[(0,t.jsx)(g.D,{label:(0,u.t)("public-dashboard.config.can-view-dashboard-radio-button-label","Can view dashboard"),className:pe.field,children:(0,t.jsx)(s.xI,{name:"shareType",control:Ue,render:({field:Tt})=>{const{ref:It,...ge}=Tt,Ie=[{label:(0,u.t)("public-dashboard.config.public-share-type-option-label","Anyone with a link"),value:L.Xo.PUBLIC},{label:(0,u.t)("public-dashboard.config.email-share-type-option-label","Only specified people"),value:L.Xo.EMAIL}];return(0,t.jsx)(U.z,{...ge,size:ce<480?"sm":"md",options:Ie,onChange:ue=>{y.c.publicDashboardShareTypeChange({shareType:ue===L.Xo.EMAIL?"email":"public"}),Ce("shareType",ue),at(ue)}})}})}),Ae("shareType")===L.Xo.EMAIL&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.D,{label:(0,u.t)("public-dashboard.email-sharing.invite-field-label","Invite"),description:(0,u.t)("public-dashboard.email-sharing.invite-field-desc","Invite people by email"),error:We.email?.message,invalid:!!We.email?.message||void 0,className:pe.field,children:(0,t.jsxs)("div",{className:pe.emailContainer,children:[(0,t.jsx)(i.p,{className:pe.emailInput,placeholder:"email",autoCapitalize:"none",...Me("email",{required:(0,u.t)("public-dashboard.email-sharing.input-required-email-text","Email is required"),pattern:{value:L._l,message:(0,u.t)("public-dashboard.email-sharing.input-invalid-email-text","Invalid email")}}),"data-testid":w.EmailSharingInput}),(0,t.jsxs)(o.$n,{type:"submit",variant:"primary",disabled:ye,"data-testid":w.EmailSharingInviteButton,children:[(0,t.jsx)(u.x6,{i18nKey:"public-dashboard.email-sharing.invite-button",children:"Invite"}),ye&&(0,t.jsx)(F.y,{})]})]})}),!!fe?.recipients?.length&&(0,t.jsx)(z,{recipients:fe.recipients,dashboardUid:xe,publicDashboardUid:fe.uid})]})]})})},H=J=>({container:(0,n.css)({label:"emailConfigContainer",display:"flex",flexDirection:"column",flexWrap:"wrap",gap:J.spacing(3)}),field:(0,n.css)({label:"field-noMargin",marginBottom:0}),emailContainer:(0,n.css)({label:"emailContainer",display:"flex",gap:J.spacing(1)}),emailInput:(0,n.css)({label:"emailInput",flexGrow:1}),table:(0,n.css)({label:"table",display:"flex",maxHeight:"220px",overflowY:"scroll","& tbody":{display:"flex",flexDirection:"column",flexGrow:1},"& tr":{minHeight:"40px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:J.spacing(.5,1),":nth-child(odd)":{background:J.colors.background.secondary}}}),tableButtonsContainer:(0,n.css)({display:"flex",justifyContent:"end"})});var Q=e(96540),X=e(67892),ee=e(29158);function Z({headerElement:J,isContentVisible:ce=!1,onRowToggle:pe,title:xe,...fe}){const Ee=(0,r.of)(q),Se=J&&X.renderOrCallToRender(J,{className:Ee.summaryWrapper});return(0,t.jsx)("div",{className:Ee.wrapper,children:(0,t.jsxs)("div",{className:Ee.header,children:[(0,t.jsx)(ee.K,{name:ce?"angle-down":"angle-right",tooltip:ce?(0,u.t)("public-dashboard.settings-bar-header.collapse-settings-tooltip","Collapse settings"):(0,u.t)("public-dashboard.settings-bar-header.expand-settings-tooltip","Expand settings"),className:Ee.collapseIcon,onClick:pe,"aria-expanded":ce,...fe}),xe&&(0,t.jsx)("div",{className:Ee.titleWrapper,onClick:pe,children:(0,t.jsx)("span",{className:Ee.title,children:xe})}),Se]})})}Z.displayName="SettingsBarHeader";function q(J){return{wrapper:(0,n.css)({label:"header",padding:J.spacing(.5,.5),borderRadius:J.shape.radius.default,background:J.colors.background.secondary,minHeight:J.spacing(4),"&:focus":{outline:"none"}}),header:(0,n.css)({label:"column",display:"flex",alignItems:"center",whiteSpace:"nowrap"}),collapseIcon:(0,n.css)({marginLeft:J.spacing(.5),color:J.colors.text.disabled}),titleWrapper:(0,n.css)({display:"flex",alignItems:"center",cursor:"pointer",overflow:"hidden",marginRight:`${J.spacing(.5)}`,[J.breakpoints.down("sm")]:{flex:"1 1"}}),title:(0,n.css)({fontWeight:J.typography.fontWeightBold,marginLeft:J.spacing(.5),overflow:"hidden",textOverflow:"ellipsis"}),summaryWrapper:(0,n.css)({display:"flex",flexWrap:"wrap",[J.breakpoints.down("sm")]:{flex:"2 2"}})}}function ae({children:J,title:ce,headerElement:pe,...xe}){const fe=(0,r.of)(k),[Ee,Se]=(0,Q.useState)(!1);function ye(){Se(Ve=>!Ve)}return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Z,{onRowToggle:ye,isContentVisible:Ee,title:ce,headerElement:pe,...xe}),Ee&&(0,t.jsx)("div",{className:fe.content,children:J})]})}ae.displayName="SettingsBar";const k=J=>({content:(0,n.css)({marginTop:J.spacing(1),marginLeft:J.spacing(4)})});var se=e(3799);function te({className:J,isDataLoading:ce=!1,timeRange:pe,timeSelectionEnabled:xe,annotationsEnabled:fe}){const Ee=(0,r.of)(ne),Se=(0,u.t)("public-dashboard.settings-summary.time-range-picker-enabled-text","Time range picker = enabled"),ye=(0,u.t)("public-dashboard.settings-summary.time-range-picker-disabled-text","Time range picker = disabled"),Ve=(0,u.t)("public-dashboard.settings-summary.annotations-show-text","Annotations = show"),Me=(0,u.t)("public-dashboard.settings-summary.annotations-hide-text","Annotations = hide");return ce?(0,t.jsx)("div",{className:(0,n.cx)(Ee.summaryWrapper,J),children:(0,t.jsx)(F.y,{className:Ee.summary,inline:!0,size:"sm"})}):(0,t.jsxs)("div",{className:(0,n.cx)(Ee.summaryWrapper,J),children:[(0,t.jsxs)("span",{className:Ee.summary,children:[(0,t.jsx)(u.x6,{i18nKey:"public-dashboard.settings-summary.time-range-text",children:"Time range = "}),(0,t.jsx)(se.f,{className:Ee.timeRange,value:pe})]}),(0,t.jsx)("span",{className:Ee.summary,children:xe?Se:ye}),(0,t.jsx)("span",{className:Ee.summary,children:fe?Ve:Me})]})}te.displayName="SettingsSummary";const ne=J=>({summaryWrapper:(0,n.css)({display:"flex"}),summary:(0,n.css)({label:"collapsedText",marginLeft:`${J.spacing.gridSize*2}px`,fontSize:J.typography.bodySmall.fontSize,color:J.colors.text.secondary}),timeRange:(0,n.css)({display:"inline-block"})}),le=a.Tp.pages.ShareDashboardModal.PublicDashboard;function re({onRevoke:J,timeRange:ce,hasTemplateVariables:pe=!1,showSaveChangesAlert:xe=!1,unsupportedDatasources:fe=[],publicDashboard:Ee,dashboard:Se}){const ye=(0,r.of)(oe),Ve=D(),[Me,{isLoading:Ce}]=(0,p.T2)(),[Ue,{isLoading:Ae}]=(0,p.eq)(),we=v.TP.hasPermission(P.AccessControlAction.DashboardsPublicWrite),We=!we||Ce||Ae,{handleSubmit:_e,setValue:at,register:ut}=(0,s.mN)({defaultValues:{isAnnotationsEnabled:Ee?.annotationsEnabled,isTimeSelectionEnabled:Ee?.timeSelectionEnabled,isPaused:!Ee?.isEnabled}}),Tt=async me=>{const{isAnnotationsEnabled:Pe,isTimeSelectionEnabled:Ne,isPaused:Fe}=me;Me({dashboard:Se,payload:{...Ee,annotationsEnabled:Pe,timeSelectionEnabled:Ne,isEnabled:!Fe}})},It=async me=>{const{isAnnotationsEnabled:Pe,isTimeSelectionEnabled:Ne,isPaused:Fe}=me;Ue({dashboard:Se,payload:{...Ee,annotationsEnabled:Pe,timeSelectionEnabled:Ne,isEnabled:!Fe}})},ge=async(me,Pe)=>{at(me,Pe),await _e(Ne=>Tt(Ne))()},Ie=async me=>{at("isPaused",me),await _e(Pe=>It(Pe))()};function ue(){y.c.publicDashboardUrlCopied()}return(0,t.jsxs)("div",{className:ye.configContainer,children:[xe&&(0,t.jsx)(O,{}),!we&&(0,t.jsx)(T.t,{mode:"edit"}),pe&&(0,t.jsx)(I.D,{}),fe.length>0&&(0,t.jsx)(M.s,{unsupportedDataSources:fe.join(", ")}),(0,L.AY)()&&(0,t.jsx)(N,{dashboard:Se}),(0,t.jsx)(g.D,{label:(0,u.t)("public-dashboard.config.dashboard-url-field-label","Dashboard URL"),className:ye.fieldSpace,children:(0,t.jsx)(i.p,{value:(0,L.mL)(Ee.accessToken),readOnly:!0,disabled:!Ee?.isEnabled,"data-testid":le.CopyUrlInput,addonAfter:(0,t.jsx)(l.b,{"data-testid":le.CopyUrlButton,variant:"primary",disabled:!Ee?.isEnabled,getText:()=>(0,L.mL)(Ee.accessToken),onClipboardCopy:ue,children:(0,t.jsx)(u.x6,{i18nKey:"public-dashboard.config.copy-button",children:"Copy"})})})}),(0,t.jsx)(g.D,{className:ye.fieldSpace,children:(0,t.jsxs)(h.PE,{children:[(0,t.jsx)(d.d,{...ut("isPaused"),disabled:We,onChange:me=>{y.c.publicDashboardPauseSharingClicked({paused:me.currentTarget.checked}),Ie(me.currentTarget.checked)},"data-testid":le.PauseSwitch}),(0,t.jsx)(c.J,{className:(0,n.css)({marginBottom:0}),children:(0,t.jsx)(u.x6,{i18nKey:"public-dashboard.config.pause-sharing-dashboard-label",children:"Pause sharing dashboard"})})]})}),(0,t.jsx)(g.D,{className:ye.fieldSpace,children:(0,t.jsx)(ae,{title:(0,u.t)("public-dashboard.config.settings-title","Settings"),headerElement:({className:me})=>(0,t.jsx)(te,{className:me,isDataLoading:Ce,timeRange:ce,timeSelectionEnabled:Ee?.timeSelectionEnabled,annotationsEnabled:Ee?.annotationsEnabled}),"data-testid":le.SettingsDropdown,children:(0,t.jsx)(K,{disabled:We,onChange:ge,register:ut,timeRange:ce})})}),(0,t.jsx)(h.PE,{orientation:Ve?0:1,justify:Ve?"flex-end":"flex-start",align:Ve?"center":"normal",children:(0,t.jsx)(h.Gy,{justify:"flex-end",children:(0,t.jsx)(o.$n,{title:(0,u.t)("public-dashboard.config.revoke-public-URL-button-title","Revoke public URL"),onClick:J,type:"button",disabled:We,"data-testid":le.DeleteButton,variant:"destructive",fill:"outline",children:(0,t.jsx)(u.x6,{i18nKey:"public-dashboard.config.revoke-public-URL-button",children:"Revoke public URL"})})})})]})}function de({publicDashboard:J,unsupportedDatasources:ce}){const xe=(0,P.useSelector)(Me=>Me.dashboard).getModel(),fe=(0,f.z)(xe.getDefaultTime(),xe),Ee=v.TP.hasPermission(P.AccessControlAction.DashboardsPublicWrite),Se=(0,L.kD)(xe.getVariables()),[ye]=(0,p.bN)(),Ve=Me=>{ye({dashboard:xe,uid:J.uid,dashboardUid:xe.uid}),Me()};return(0,t.jsx)(m.$s,{children:({showModal:Me,hideModal:Ce})=>(0,t.jsx)(re,{publicDashboard:J,dashboard:xe,unsupportedDatasources:ce,timeRange:fe,showSaveChangesAlert:Ee&&xe.hasUnsavedChanges(),hasTemplateVariables:Se,onRevoke:()=>{y.c.revokePublicDashboardClicked(),Me(x.m,{onConfirm:()=>Ve(Ce),onDismiss:()=>{Me(C.Zy,{dashboard:xe,onDismiss:Ce,activeTab:b.wr.publicDashboard})}})}})})}const oe=J=>({configContainer:(0,n.css)({label:"config container",display:"flex",flexDirection:"column",flexWrap:"wrap",gap:J.spacing(3)}),fieldSpace:(0,n.css)({label:"field space",width:"100%",marginBottom:0}),timeRange:(0,n.css)({display:"inline-block"})})},22234:(G,R,e)=>{"use strict";e.d(R,{M:()=>S,D:()=>T});var t=e(74848),n=e(32196),s=e(49785),a=e(13544),r=e(40845),g=e(55852),i=e(62930),l=e(8484),d=e(16233),c=e(72686),h=e(7758),o=e(31678),m=e(6923),u=e(12257),p=e(10872),f=e(72254),y=e(71415),x=e(84167),v=e(66864),P=e(10880);const E=a.Tp.pages.ShareDashboardModal.PublicDashboard,D=({disabled:M,register:I})=>{const L=(0,r.of)(C),B=[{type:"publicAcknowledgment",description:(0,l.t)("public-dashboard.acknowledgment-checkboxes.public-ack-desc","Your entire dashboard will be public*"),testId:E.WillBePublicCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/dashboards/dashboard-public/",tooltip:(0,l.t)("public-dashboard.acknowledgment-checkboxes.public-ack-tooltip","Learn more about public dashboards")}},{type:"dataSourcesAcknowledgment",description:(0,l.t)("public-dashboard.acknowledgment-checkboxes.data-src-ack-desc","Publishing currently only works with a subset of data sources*"),testId:E.LimitedDSCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/datasources/",tooltip:(0,l.t)("public-dashboard.acknowledgment-checkboxes.data-src-ack-tooltip","Learn more about public datasources")}},{type:"usageAcknowledgment",description:(0,l.t)("public-dashboard.acknowledgment-checkboxes.usage-ack-desc","Making a dashboard public will cause queries to run each time it is viewed, which may increase costs*"),testId:E.CostIncreaseCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/enterprise/query-caching/",tooltip:(0,l.t)("public-dashboard.acknowledgment-checkboxes.usage-ack-desc-tooltip","Learn more about query caching")}}];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:L.title,children:(0,t.jsx)(l.x6,{i18nKey:"public-dashboard.acknowledgment-checkboxes.ack-title",children:"Before you make the dashboard public, acknowledge the following:"})}),(0,t.jsx)(x.n,{disabled:M,children:(0,t.jsx)(v.gW,{spacing:"md",children:B.map(j=>(0,t.jsxs)(v.Gy,{spacing:"none",align:"center",children:[(0,t.jsx)(P.S,{...I(j.type,{required:!0}),label:j.description,"data-testid":j.testId}),(0,t.jsx)(g.z9,{variant:"primary",href:j.info.href,target:"_blank",fill:"text",icon:"info-circle",rel:"noopener noreferrer",tooltip:j.info.tooltip})]},j.type))})})]})},C=M=>({title:(0,n.css)({fontWeight:M.typography.fontWeightBold})}),b=a.Tp.pages.ShareDashboardModal.PublicDashboard,T=({unsupportedDatasources:M=[],unsupportedTemplateVariables:I=!1,dashboard:L,hasError:B=!1})=>{const j=(0,r.of)(O),A=d.TP.hasPermission(o.AccessControlAction.DashboardsPublicWrite),[K,{isLoading:W,isError:U}]=(0,c.U9)(),F=()=>{K({dashboard:L,payload:{isEnabled:!0}}),h.c.generatePublicDashboardUrlClicked({})},{handleSubmit:V,register:w,formState:{isValid:z}}=(0,s.mN)({mode:"onChange"}),N=!A||W||U||B;return(0,t.jsxs)("div",{className:j.container,children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:j.title,children:(0,t.jsx)(l.x6,{i18nKey:"public-dashboard.create-page.welcome-title",children:"Welcome to public dashboards!"})}),(0,t.jsx)("p",{className:j.description,children:(0,t.jsx)(l.x6,{i18nKey:"public-dashboard.create-page.unsupported-features-desc",children:"Currently, we don\u2019t support template variables or frontend data sources"})})]}),!A&&(0,t.jsx)(m.t,{mode:"create"}),I&&(0,t.jsx)(p.D,{}),M.length>0&&(0,t.jsx)(u.s,{unsupportedDataSources:M.join(", ")}),(0,t.jsxs)("form",{onSubmit:V(F),children:[(0,t.jsx)("div",{className:j.checkboxes,children:(0,t.jsx)(D,{disabled:N,register:w})}),(0,t.jsx)("div",{className:j.buttonContainer,children:(0,t.jsxs)(g.$n,{type:"submit",disabled:N||!z,"data-testid":b.CreateButton,children:[(0,t.jsx)(l.x6,{i18nKey:"public-dashboard.create-page.generate-public-url-button",children:"Generate public URL"}),W&&(0,t.jsx)(i.y,{className:j.loadingSpinner})]})})]})]})};function S({hasError:M}){const L=(0,o.useSelector)(A=>A.dashboard).getModel(),{unsupportedDataSources:B}=(0,y.Z)(L),j=(0,f.kD)(L.getVariables());return(0,t.jsx)(T,{dashboard:L,unsupportedDatasources:B,unsupportedTemplateVariables:j,hasError:M})}const O=M=>({container:(0,n.css)({display:"flex",flexDirection:"column",gap:M.spacing(4)}),title:(0,n.css)({fontSize:M.typography.h4.fontSize,margin:M.spacing(0,0,2)}),description:(0,n.css)({color:M.colors.text.secondary,marginBottom:M.spacing(0)}),checkboxes:(0,n.css)({margin:M.spacing(0,0,4)}),buttonContainer:(0,n.css)({display:"flex",justifyContent:"end"}),loadingSpinner:(0,n.css)({marginLeft:M.spacing(1)})})},6923:(G,R,e)=>{"use strict";e.d(R,{t:()=>i});var t=e(74848),n=e(13544),s=e(32264),a=e(42418),r=e(8484);const g=n.Tp.pages.ShareDashboardModal.PublicDashboard,i=({mode:l})=>{const d=s.$.featureToggles.newDashboardSharingComponent?(0,r.t)("public-dashboard.share-externally.no-upsert-perm-alert-title","You don\u2019t have permission to {{ mode }} a shared dashboard",{mode:l}):(0,r.t)("public-dashboard.modal-alerts.no-upsert-perm-alert-title","You don\u2019t have permission to {{ mode }} a public dashboard",{mode:l});return(0,t.jsx)(a.F,{severity:"warning",title:d,"data-testid":g.NoUpsertPermissionsWarningAlert,bottomSpacing:0,children:s.$.featureToggles.newDashboardSharingComponent?(0,t.jsxs)(r.x6,{i18nKey:"public-dashboard.share-externally.no-upsert-perm-alert-desc",children:["Contact your admin to get permission to ",{mode:l}," shared dashboards"]}):(0,t.jsxs)(r.x6,{i18nKey:"public-dashboard.modal-alerts.no-upsert-perm-alert-desc",children:["Contact your admin to get permission to ",{mode:l}," public dashboards"]})})}},12257:(G,R,e)=>{"use strict";e.d(R,{s:()=>h});var t=e(74848),n=e(32196),s=e(46942),a=e.n(s),r=e(13544),g=e(32264),i=e(40845),l=e(42418),d=e(8484);const c=r.Tp.pages.ShareDashboardModal.PublicDashboard,h=({unsupportedDataSources:m})=>{const u=(0,i.of)(o);return(0,t.jsxs)(l.F,{severity:"warning",title:(0,d.t)("public-dashboard.modal-alerts.unsupported-data-source-alert-title","Unsupported data sources"),"data-testid":c.UnsupportedDataSourcesWarningAlert,bottomSpacing:0,children:[(0,t.jsx)("p",{className:u.unsupportedDataSourceDescription,children:g.$.featureToggles.newDashboardSharingComponent?(0,t.jsxs)(d.x6,{i18nKey:"public-dashboard.share-externally.unsupported-data-source-alert-desc",children:["There are data sources in this dashboard that are unsupported for shared dashboards. Panels that use these data sources may not function properly: ",{unsupportedDataSources:m},"."]}):(0,t.jsxs)(d.x6,{i18nKey:"public-dashboard.modal-alerts.unsupported-data-source-alert-desc",children:["There are data sources in this dashboard that are unsupported for public dashboards. Panels that use these data sources may not function properly: ",{unsupportedDataSources:m},"."]})}),(0,t.jsx)("a",{href:g.$.featureToggles.newDashboardSharingComponent?"https://grafana.com/docs/grafana/next/dashboards/share-dashboards-panels/shared-dashboards/#supported-data-sources":"https://grafana.com/docs/grafana/v11.2/dashboards/dashboard-public/#supported-data-sources",target:"blank",className:a()("text-link",u.unsupportedDataSourceDescription),children:(0,t.jsx)(d.x6,{i18nKey:"public-dashboard.modal-alerts.unsupport-data-source-alert-readmore-link",children:"Read more about supported data sources"})})]})},o=m=>({unsupportedDataSourceDescription:(0,n.css)({color:m.colors.text.secondary,marginBottom:m.spacing(1)})})},10872:(G,R,e)=>{"use strict";e.d(R,{D:()=>g});var t=e(74848),n=e(13544),s=e(42418),a=e(8484);const r=n.Tp.pages.ShareDashboardModal.PublicDashboard,g=({showDescription:i=!0})=>(0,t.jsx)(s.F,{severity:"warning",title:(0,a.t)("public-dashboard.modal-alerts.unsupported-template-variable-alert-title","Template variables are not supported"),"data-testid":r.TemplateVariablesWarningAlert,bottomSpacing:0,children:i&&(0,t.jsx)(a.x6,{i18nKey:"public-dashboard.modal-alerts.unsupported-template-variable-alert-desc",children:"This public dashboard may not work since it uses template variables"})})},4785:(G,R,e)=>{"use strict";e.d(R,{a:()=>o,b:()=>m});var t=e(74848),n=e(32196),s=e(40845),a=e(62930),r=e(72686),g=e(72254),i=e(31678),l=e(42930),d=e(59037),c=e(22234),h=e(71415);const o=()=>{const p=(0,s.of)(u);return(0,t.jsx)(l.G,{className:p.loadingContainer,children:(0,t.jsxs)(t.Fragment,{children:["Loading configuration",(0,t.jsx)(a.y,{size:"lg",className:p.spinner})]})})},m=p=>{const{data:f,isLoading:y,isError:x}=(0,r.Bs)(p.dashboard.uid),P=(0,i.useSelector)(D=>D.dashboard).getModel(),{unsupportedDataSources:E}=(0,h.Z)(P);return(0,t.jsx)(t.Fragment,{children:y?(0,t.jsx)(o,{}):(0,g.lI)(f)?(0,t.jsx)(d.K,{publicDashboard:f,unsupportedDatasources:E}):(0,t.jsx)(c.M,{hasError:x})})},u=p=>({loadingContainer:(0,n.css)({height:"280px",alignItems:"center",justifyContent:"center",gap:p.spacing(1)}),spinner:(0,n.css)({marginBottom:p.spacing(0)})})},72254:(G,R,e)=>{"use strict";e.d(R,{AY:()=>f,Xo:()=>l,_A:()=>h,_l:()=>u,gN:()=>m,iR:()=>p,kD:()=>d,lI:()=>c,mL:()=>o});var t=e(26657),n=e(32264),s=e(33378),a=e(2913),r=e(31193),g=e(22699),i=e(31204),l=(y=>(y.PUBLIC="public",y.EMAIL="email",y))(l||{});const d=y=>y.length>0,c=y=>y?.uid!==""&&y?.uid!==void 0,h=async y=>{let x=new Set;for(const v of y)for(const P of v.targets){const E=P?.datasource?.type;E&&(i.z.has(E)&&await(0,r.tR)().get(P.datasource)instanceof t.iy||x.add(E))}return Array.from(x).sort()},o=y=>`${(0,a.zj)().appUrl}public-dashboards/${y}`,m=(y,x)=>`/d/${y}/${x}?shareView=${g.wr.publicDashboard}`,u=/^[A-Z\d._%+-]+@[A-Z\d.-]+\.[A-Z]{2,}$/i,p=()=>!!n.$.featureToggles.publicDashboards&&n.$.publicDashboardsEnabled,f=()=>p()&&!!n.$.featureToggles.publicDashboardsEmailSharing&&(0,s.a)("publicDashboardsEmailSharing")},31204:(G,R,e)=>{"use strict";e.d(R,{z:()=>t});const t=new Set(["__expr__","aggregations-io-datasource","apache-iotdb-datasource","aquaqanalytics-kdbbackend-datasource","axiomhq-axiom-datasource","cloudwatch","cnos-cnosdb-datasource","datasource","dlopes7-appdynamics-datasource","dvelop-odata-datasource","elasticsearch","factry-historian-datasource","fiskaly-surrealdb-datasource","frser-sqlite-datasource","grafadruid-druid-datasource","grafana-athena-datasource","grafana-azure-data-explorer-datasource","grafana-azure-monitor-datasource","grafana-azurecosmosdb-datasource","grafana-bigquery-datasource","grafana-catchpoint-datasource","grafana-clickhouse-datasource","grafana-databricks-datasource","grafana-datadog-datasource","grafana-dynamodb-datasource","grafana-dynatrace-datasource","grafana-falconlogscale-datasource","grafana-github-datasource","grafana-gitlab-datasource","grafana-honeycomb-datasource","grafana-iot-sitewise-datasource","grafana-jira-datasource","grafana-looker-datasource","grafana-mock-datasource","grafana-mongodb-datasource","grafana-newrelic-datasource","grafana-odbc-datasource","grafana-opensearch-datasource","grafana-oracle-datasource","grafana-orbit-datasource","grafana-pagerduty-datasource","grafana-redshift-datasource","grafana-salesforce-datasource","grafana-saphana-datasource","grafana-sentry-datasource","grafana-servicenow-datasource","grafana-snowflake-datasource","grafana-splunk-datasource","grafana-splunk-monitoring-datasource","grafana-sumologic-datasource","grafana-surrealdb-datasource","grafana-testdata-datasource","grafana-timestream-datasource","grafana-wavefront-datasource","grafana-x-ray-datasource","graphite","hadesarchitect-cassandra-datasource","highlightinc-highlight-datasource","ibm-aql-datasource","ibm-kql-datasource","influxdata-flightsql-datasource","influxdb","innius-grpc-datasource","kniepdennis-neo4j-datasource","loki","manassehzhou-maxcompute-datasource","marcusolsson-csv-datasource","mssql","mysql","nagasudhirpulla-api-datasource","needleinajaystack-haystack-datasource","oci-metrics-datasource","opentsdb","parseable-parseable-datasource","postgres","prometheus","questdb-questdb-datasource","quickwit-quickwit-datasource","redis-datasource","retrodaredevil-wildgraphql-datasource","stackdriver","tdengine-datasource","timeplus-proton-datasource","trino-datasource","vertamedia-clickhouse-datasource","vertica-grafana-datasource","ydbtech-ydb-datasource","yesoreyeram-infinity-datasource"])},71415:(G,R,e)=>{"use strict";e.d(R,{Z:()=>s});var t=e(96540),n=e(72254);const s=a=>{const[r,g]=(0,t.useState)([]);return(0,t.useEffect)(()=>{(async()=>await(0,n._A)(a.panels))().then(l=>{g(l)})},[a.panels]),{unsupportedDataSources:r}}},87895:(G,R,e)=>{"use strict";e.d(R,{w:()=>r});var t=e(74848),n=e(88575),s=e(94354),a=e(8484);const r=({selectedTheme:g="current",onChange:i})=>{const l=[{label:(0,a.t)("share-modal.theme-picker.current","Current"),value:"current"},{label:(0,a.t)("share-modal.theme-picker.dark","Dark"),value:"dark"},{label:(0,a.t)("share-modal.theme-picker.light","Light"),value:"light"}];return(0,t.jsx)(n.D,{label:(0,a.t)("share-modal.theme-picker.field-name","Theme"),children:(0,t.jsx)(s.z,{options:l,value:g,onChange:i})})}},1702:(G,R,e)=>{"use strict";e.d(R,{ShareModal:()=>t.Zy,addDashboardShareTab:()=>t.mJ});var t=e(7686)},22699:(G,R,e)=>{"use strict";e.d(R,{CF:()=>m,Lb:()=>o,P_:()=>d,XV:()=>l,Xe:()=>c,hD:()=>p,wr:()=>f});var t=e(65879),n=e(76885),s=e(71733),a=e(47232),r=e(32264),g=e(7030),i=e(74856);function l({useCurrentTimeRange:y,selectedTheme:x,panel:v,search:P=window.location.search,range:E=(0,i.jG)().timeRange(),orgId:D=r.$.bootData.user.orgId}){const C=new URLSearchParams(P),b=v?.timeFrom;if(b){const{from:T,to:S}=t.describeTextRange(b);C.set("from",T),C.set("to",S)}else C.set("from",String(E.from.valueOf())),C.set("to",String(E.to.valueOf()));return C.set("orgId",String(D)),y||(C.delete("from"),C.delete("to")),x!=="current"&&C.set("theme",x),v&&!C.has("editPanel")&&C.set("viewPanel",String(v.id)),C.delete("auth_token"),C.delete("shareView"),C}function d(){let y=window.location.href;const x=y.indexOf("?");return x!==-1&&(y=y.substring(0,x)),y}async function c(y,x,v,P){const E=d(),D=l({useCurrentTimeRange:y,selectedTheme:x,panel:v}),C=n.kM.appendQueryToUrl(E,D.toString());return P?await(0,g.fn)(C):C}function h(y,x,v,P,E){const D=d(),C=l({useCurrentTimeRange:y,selectedTheme:v,panel:P,range:E});let b=D.replace(r.$.appSubUrl+"/dashboard/",r.$.appSubUrl+"/dashboard-solo/");b=b.replace(r.$.appSubUrl+"/d/",r.$.appSubUrl+"/d-solo/"),s.I.stripBaseFromUrl(D)==="/"&&(b=`${r.$.appUrl}d-solo/${x}`);const S=C.get("editPanel")??C.get("viewPanel")??"";return C.set("panelId",S),C.delete("editPanel"),C.delete("viewPanel"),n.kM.appendQueryToUrl(b,C.toString())}function o(y,x,v,P){let D=h(y,x,v,P).replace(r.$.appSubUrl+"/dashboard-solo/",r.$.appSubUrl+"/render/dashboard-solo/");return D=D.replace(r.$.appSubUrl+"/d-solo/",r.$.appSubUrl+"/render/d-solo/"),D+=`&width=${r.$.rendererDefaultImageWidth}&height=${r.$.rendererDefaultImageHeight}&scale=${r.$.rendererDefaultImageScale}`+u(),D}function m(y,x,v,P,E){return`<iframe src="${h(y,x,v,P,E)}" width="450" height="200" frameborder="0"></iframe>`}function u(){const y="&tz=UTC"+encodeURIComponent((0,a.KQ)().format("Z"));if(!window.Intl)return y;const x=window.Intl.DateTimeFormat();if(!x.resolvedOptions)return y;const v=x.resolvedOptions();return v.timeZone?"&tz="+encodeURIComponent(v.timeZone):y}const p=y=>y?"panel":"dashboard",f={link:"link",snapshot:"snapshot",export:"export",embed:"embed",libraryPanel:"library_panel",pdf:"pdf",report:"report",publicDashboard:"public_dashboard"}},52424:(G,R,e)=>{"use strict";e.d(R,{Zx:()=>E,aK:()=>f});var t=e(74848),n=e(32196),s=e(96540),a=e(16817),r=e(80997),g=e(13544),i=e(40845),l=e(38138),d=e(40276),c=e(83122),h=e(14578),o=e(55852),m=e(27677),u=e(29304);function p({dashboardUID:D,link:C}){const b=(0,i.of)(P),T=y({dashboardUID:D,link:C});return!T||v.length===0?null:(0,t.jsx)(l.W,{children:(0,t.jsx)("div",{className:b.dropdown,children:(0,t.jsx)(d.E,{children:T.map((S,O)=>(0,t.jsx)(l.W.Item,{url:S.url,target:C.targetBlank?"_blank":void 0,label:S.title,testId:g.Tp.components.DashboardLinks.link,"aria-label":`${S.title} dashboard`},`dashlinks-dropdown-item-${S.uid}-${O}`))})})})}const f=D=>{const{link:C,linkInfo:b,dashboardUID:T}=D,S=y(D),O=(0,i.of)(P);return C.asDropdown?(0,t.jsx)(c.m,{overlay:(0,t.jsx)(p,{link:C,dashboardUID:T}),children:(0,t.jsxs)(E,{"data-placement":"bottom","data-toggle":"dropdown","aria-controls":"dropdown-list","aria-haspopup":"menu",fill:"outline",variant:"secondary","data-testid":g.Tp.components.DashboardLinks.dropDown,children:[(0,t.jsx)(h.I,{"aria-hidden":!0,name:"bars",className:O.iconMargin}),(0,t.jsx)("span",{children:b.title})]})}):(0,t.jsx)(t.Fragment,{children:S.length>0&&S.map((M,I)=>(0,t.jsx)(E,{icon:"apps",variant:"secondary",fill:"outline",href:M.url,target:C.targetBlank?"_blank":void 0,rel:"noreferrer","data-testid":g.Tp.components.DashboardLinks.link,children:M.title},`dashlinks-list-item-${M.uid}-${I}`))})},y=({link:D,dashboardUID:C})=>{const{tags:b}=D,T=(0,a.A)(()=>x(b),[b]);return T.value?v(C,D,T.value):[]};async function x(D,C={getBackendSrv:m.AI}){return await C.getBackendSrv().search({tag:D,limit:100})}function v(D,C,b,T={getLinkSrv:u.mQ,sanitize:r.aj,sanitizeUrl:r.Jf}){return b.filter(S=>S.uid!==D).map(S=>{const O=S.uid,M=T.sanitize(S.title),I=T.getLinkSrv().getLinkUrl({...C,url:S.url}),L=T.sanitizeUrl(I);return{uid:O,title:M,url:L}})}function P(D){return{iconMargin:(0,n.css)({marginRight:D.spacing(.5)}),dropdown:(0,n.css)({maxWidth:"max(30vw, 300px)",maxHeight:"70vh",overflowY:"auto"}),button:(0,n.css)({color:D.colors.text.primary}),dashButton:(0,n.css)({fontSize:D.typography.bodySmall.fontSize,paddingLeft:D.spacing(1),paddingRight:D.spacing(1)})}}const E=(0,s.forwardRef)(({className:D,...C},b)=>{const T=(0,i.of)(P),S=C.href?o.z9:o.$n;return(0,t.jsx)(S,{...C,variant:"secondary",fill:"outline",className:(0,n.cx)(D,T.dashButton),ref:b})});E.displayName="DashboardLinkButton"},57650:(G,R,e)=>{"use strict";e.d(R,{A:()=>K});var t=e(74848),n=e(97497),s=e(96540),a=e(42941),r=e(1173),g=e(52622),i=e(13544),l=e(14110),d=e(96374),c=e(10343),h=e(7788),o=e(2913),m=e(10803),u=e(32196),p=e(69862),f=e(85200),y=e(2514),x=e(72574),v=e(40845),P=e(87978),E=e(24022),D=e(14578);const C=({debugMode:W,index:U,data:F,uiConfig:V,configs:w,onChange:z,toggleShowDebug:N})=>{const H=(0,v.of)(b),[Q,X]=(0,s.useState)([]),[ee,Z]=(0,s.useState)([]),q=(0,s.useMemo)(()=>w[U],[w,U]);(0,s.useEffect)(()=>{const k=w[U].transformation,se=k.filter?.options?(0,f.Dq)(k.filter):void 0,te=w.slice(0,U).map(oe=>oe.transformation),ne=w.slice(U,U+1).map(oe=>oe.transformation),le={interpolate:oe=>(0,x.w)().replace(oe)},re=(0,y.m)(te,F,le).subscribe(oe=>{se&&(oe=F.filter(J=>se(J))),X(oe)}),de=(0,y.m)(te,F,le).pipe((0,p.Z)(oe=>(0,y.m)(ne,oe,le))).subscribe(Z);return function(){re.unsubscribe(),de.unsubscribe()}},[U,F,w]);const ae=(0,s.useMemo)(()=>(0,s.createElement)(V.editor,{options:{...V.transformation.defaultOptions,...q.transformation.options},input:Q,onChange:k=>{z(U,{...q.transformation,options:k})}}),[V.editor,V.transformation.defaultOptions,q.transformation,Q,z,U]);return(0,t.jsxs)("div",{"data-testid":i.Tp.components.TransformTab.transformationEditor(V.name),children:[ae,W&&(0,t.jsx)(P._,{title:"Debug transformation",subtitle:V.name,onClose:N,children:(0,t.jsxs)("div",{className:H.debugWrapper,"data-testid":i.Tp.components.TransformTab.transformationEditorDebugger(V.name),children:[(0,t.jsxs)("div",{className:H.debug,children:[(0,t.jsx)("div",{className:H.debugTitle,children:"Input data"}),(0,t.jsx)("div",{className:H.debugJson,children:(0,t.jsx)(E.B,{json:Q})})]}),(0,t.jsx)("div",{className:H.debugSeparator,children:(0,t.jsx)(D.I,{name:"arrow-right"})}),(0,t.jsxs)("div",{className:H.debug,children:[(0,t.jsx)("div",{className:H.debugTitle,children:"Output data"}),(0,t.jsx)("div",{className:H.debugJson,children:ee&&(0,t.jsx)(E.B,{json:ee})})]})]})})]})},b=W=>({title:(0,u.css)({display:"flex",padding:"4px 8px 4px 8px",position:"relative",height:"35px",borderRadius:"4px 4px 0 0",flexWrap:"nowrap",justifyContent:"space-between",alignItems:"center"}),name:(0,u.css)({fontWeight:W.typography.fontWeightMedium,color:W.colors.primary.text}),iconRow:(0,u.css)({display:"flex"}),icon:(0,u.css)({background:"transparent",border:"none",boxShadow:"none",cursor:"pointer",color:W.colors.text.secondary,marginLeft:W.spacing(1),"&:hover":{color:W.colors.text.primary}}),debugWrapper:(0,u.css)({display:"flex",flexDirection:"row"}),debugSeparator:(0,u.css)({width:"48px",minHeight:"300px",display:"flex",alignItems:"center",alignSelf:"stretch",justifyContent:"center",margin:`0 ${W.spacing(.5)}`,color:W.colors.primary.text}),debugTitle:(0,u.css)({padding:`${W.spacing(1)} ${W.spacing(.25)}`,fontFamily:W.typography.fontFamilyMonospace,fontSize:W.typography.bodySmall.fontSize,color:W.colors.text.primary,borderBottom:`1px solid ${W.colors.border.weak}`,flexGrow:0,flexShrink:1}),debug:(0,u.css)({marginTop:W.spacing(1),padding:`0 ${W.spacing(1,1,1)}`,border:`1px solid ${W.colors.border.weak}`,background:`${W.isLight?W.v1.palette.white:W.v1.palette.gray05}`,borderRadius:W.shape.radius.default,width:"100%",minHeight:"300px",display:"flex",flexDirection:"column",alignSelf:"stretch"}),debugJson:(0,u.css)({flexGrow:1,height:"100%",overflow:"hidden",padding:W.spacing(.5)})});var T=e(22214),S=e(91847);const O=({isOpen:W,onCloseClick:U,transformer:F})=>{const{transformation:{name:V},help:w}=F,z=w||(0,S.$n)(),N=(0,t.jsx)(P._,{title:V,subtitle:"Transformation help",onClose:()=>U(!1),children:(0,t.jsx)(T.j,{markdown:z,styleOverrides:{borderTop:"2px solid"}})});return W?N:null};var M=e(88575),I=e(90182),L=e(19743);const B=({index:W,data:U,config:F,onChange:V})=>{const w=(0,v.of)(j),z=(0,s.useMemo)(()=>({context:{data:U.series},showTopic:!0,showFilter:F.topic!==g.QR.Annotations,source:[{value:g.QR.Series,label:"Query results"},{value:g.QR.Annotations,label:"Annotation data"}]}),[U,F.topic]);return(0,t.jsx)("div",{className:w.wrapper,children:(0,t.jsx)(M.D,{label:"Apply transformation to",children:(0,t.jsxs)(t.Fragment,{children:[z.showTopic&&(0,t.jsx)(I.l6,{isClearable:!0,options:z.source,value:z.source.find(N=>N.value===F.topic),placeholder:z.source[0].label,className:w.padded,onChange:N=>{V(W,{...F,topic:N?.value})}}),z.showFilter&&(0,t.jsx)(L.x,{value:F.filter,context:z.context,item:{},onChange:N=>V(W,{...F,filter:N})})]})})})},j=W=>{const U=W.shape.radius.default;return{wrapper:(0,u.css)({padding:W.spacing(2),border:`2px solid ${W.colors.background.secondary}`,borderTop:"none",borderRadius:`0 0 ${U} ${U}`,position:"relative",top:"-4px"}),padded:(0,u.css)({marginBottom:W.spacing(1)})}},A=({onRemove:W,index:U,id:F,data:V,configs:w,uiConfig:z,onChange:N})=>{const[H,Q]=(0,a.A)(!1),[X,ee]=(0,a.A)(!1),[Z,q]=(0,a.A)(!1),ae=!!w[U].transformation.disabled,k=w[U].transformation.topic,se=w[U].transformation.filter!=null||k!=null,te=se||V.series.length>0||(V.annotations?.length??0)>0,ne=(0,s.useCallback)(oe=>{const J=w[oe].transformation;N(oe,{...J,disabled:J.disabled?void 0:!0})},[N,w]),le=(0,s.useCallback)(()=>{let oe={...w[U].transformation};oe.filter?delete oe.filter:oe.filter={id:r.jR.byRefId,options:""},N(U,oe)},[N,U,w]),re=(0,s.useCallback)((oe,J,ce)=>pe=>{let xe="panel_editor_tabs_transformations_toggle";o.Ay.featureToggles.transformationsRedesign&&(xe="transformations_redesign_"+xe),(0,l.rR)(xe,{action:ce?"off":"on",toggleId:J,transformationId:w[U].transformation.id}),oe(pe)},[w,U]),de=()=>(0,t.jsxs)(t.Fragment,{children:[z.state&&(0,t.jsx)(m.p,{state:z.state}),(0,t.jsx)(c.A,{title:"Show transform help",icon:"info-circle",onClick:re(q,"help",Z),active:Z}),te&&(0,t.jsx)(c.A,{title:"Filter",icon:"filter",onClick:re(le,"filter",se),active:se}),(0,t.jsx)(c.A,{title:"Debug",icon:"bug",onClick:re(ee,"debug",X),active:X}),(0,t.jsx)(c.A,{title:"Disable transformation",icon:ae?"eye-slash":"eye",onClick:re(()=>ne(U),"disabled",ae),active:ae,dataTestId:i.Tp.components.Transforms.disableTransformationButton}),(0,t.jsx)(c.q,{title:"Remove",icon:"trash-alt",onClick:()=>o.Ay.featureToggles.transformationsRedesign?Q(!0):W(U)}),o.Ay.featureToggles.transformationsRedesign&&(0,t.jsx)(d.u,{isOpen:H,title:`Delete ${z.name}?`,body:"Note that removing one transformation may break others. If there is only a single transformation, you will go back to the main selection screen.",confirmText:"Delete",onConfirm:()=>{Q(!1),W(U)},onDismiss:()=>Q(!1)})]});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(h.u,{id:F,index:U,title:`${U+1} - ${z.name}`,draggable:!0,actions:de,disabled:ae,expanderMessages:{close:"Collapse transformation row",open:"Expand transformation row"},children:[se&&(0,t.jsx)(B,{index:U,config:w[U].transformation,data:V,onChange:N}),(0,t.jsx)(C,{debugMode:X,index:U,data:k===g.QR.Annotations?V.annotations??[]:V.series,configs:w,uiConfig:z,onChange:N,toggleShowDebug:ee})]}),(0,t.jsx)(O,{transformer:z,isOpen:Z,onCloseClick:q})]})},K=({data:W,onChange:U,onRemove:F,configs:V})=>(0,t.jsx)(t.Fragment,{children:V.map((w,z)=>{const N=n.h.getIfExists(w.transformation.id);return N?(0,t.jsx)(A,{index:z,id:`${w.id}`,data:W,configs:V,uiConfig:N,onRemove:F,onChange:U},`${w.id}`):null})})},21427:(G,R,e)=>{"use strict";e.d(R,{R:()=>E});var t=e(74848),n=e(32196),s=e(96540),a=e(81010),r=e(18282),g=e(97497),i=e(13544),l=e(40845),d=e(87978),c=e(10354),h=e(15292),o=e(92174),m=e(10860),u=e(29158),p=e(2913),f=e(10803),y=e(94397);const P=[["viewAll","View all"],...Object.entries(y.eJ)];function E(M){const I=(0,l.of)(D),{suffix:L,xforms:B,search:j,onSearchChange:A,onSearchKeyDown:K,showIllustrations:W,onTransformationAdd:U,selectedFilter:F,data:V,onClose:w,onShowIllustrationsChange:z,onSelectedFilterChange:N}=M,H=(0,s.useCallback)(Q=>{Q?.click()},[]);return(0,t.jsxs)(d._,{size:"md",onClose:()=>{w&&w()},title:"Add another transformation",children:[(0,t.jsxs)("div",{className:I.searchWrapper,children:[(0,t.jsx)(c.p,{"data-testid":i.Tp.components.Transforms.searchInput,className:I.searchInput,value:j??"",placeholder:"Search for transformation",onChange:A,onKeyDown:K,suffix:L,ref:H}),(0,t.jsxs)("div",{className:I.showImages,children:[(0,t.jsx)("span",{className:I.illustationSwitchLabel,children:"Show images"})," ",(0,t.jsx)(h.d,{value:W,onChange:()=>z&&z(!W)})]})]}),(0,t.jsx)("div",{className:I.filterWrapper,children:P.map(([Q,X])=>(0,t.jsx)(o.m,{onClick:()=>N&&N(Q),label:X,selected:F===Q},Q))}),(0,t.jsx)(C,{showIllustrations:W,transformations:B,data:V,onClick:Q=>{U({value:Q})}})]})}function D(M){return{showImages:(0,n.css)({flexBasis:"0",display:"flex",gap:"8px",alignItems:"center"}),pickerInformationLine:(0,n.css)({fontSize:"16px",marginBottom:`${M.spacing(2)}`}),pickerInformationLineHighlight:(0,n.css)({verticalAlign:"middle"}),searchWrapper:(0,n.css)({display:"flex",flexWrap:"wrap",columnGap:"27px",rowGap:"16px",width:"100%"}),searchInput:(0,n.css)({flexGrow:"1",width:"initial"}),illustationSwitchLabel:(0,n.css)({whiteSpace:"nowrap"}),filterWrapper:(0,n.css)({padding:`${M.spacing(1)} 0`,display:"flex",flexWrap:"wrap",rowGap:`${M.spacing(1)}`,columnGap:`${M.spacing(.5)}`})}}function C({showIllustrations:M,transformations:I,onClick:L,data:B}){const j=(0,l.of)(b);return(0,t.jsx)("div",{className:j.grid,children:I.map(A=>{let K=a.M.Applicable;A.transformation.isApplicable!==void 0&&(K=A.transformation.isApplicable(B));const W=K>0;let U=null;A.transformation.isApplicableDescription!==void 0&&(typeof A.transformation.isApplicableDescription=="function"?U=A.transformation.isApplicableDescription(B):U=A.transformation.isApplicableDescription);let F=j.newCard;return W||(F=(0,n.cx)(j.newCard,j.cardDisabled)),(0,t.jsxs)(m.Z,{className:F,"data-testid":i.Tp.components.TransformTab.newTransform(A.name),onClick:()=>L(A.id),children:[(0,t.jsxs)(m.Z.Heading,{className:j.heading,children:[(0,t.jsx)("span",{children:A.name}),(0,t.jsx)("span",{className:j.pluginStateInfoWrapper,children:(0,t.jsx)(f.p,{state:A.state})})]}),(0,t.jsxs)(m.Z.Description,{className:j.description,children:[(0,t.jsx)("span",{children:O(A.id)}),M&&(0,t.jsx)("span",{children:(0,t.jsx)("img",{className:j.image,src:T(A.id,!W),alt:A.name})}),!W&&U!==null&&(0,t.jsx)(u.K,{className:j.cardApplicableInfo,name:"info-circle",tooltip:U})]})]},A.id)})})}function b(M){return{heading:(0,n.css)({fontWeight:400,"> button":{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"nowrap"}}),description:(0,n.css)({fontSize:"12px",display:"flex",flexDirection:"column",justifyContent:"space-between"}),image:(0,n.css)({display:"block",maxEidth:"100%`",marginTop:`${M.spacing(2)}`}),grid:(0,n.css)({display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gridAutoRows:"1fr",gap:`${M.spacing(2)} ${M.spacing(1)}`,width:"100%"}),cardDisabled:(0,n.css)({backgroundColor:"rgb(204, 204, 220, 0.045)",color:`${M.colors.text.disabled} !important`,img:{filter:"grayscale(100%)",opacity:.33}}),cardApplicableInfo:(0,n.css)({position:"absolute",bottom:`${M.spacing(1)}`,right:`${M.spacing(1)}`}),newCard:(0,n.css)({gridTemplateRows:"min-content 0 1fr 0"}),pluginStateInfoWrapper:(0,n.css)({marginLeft:"5px"})}}const T=(M,I)=>`public/img/transformations/${p.Ay.theme2.isDark?"dark":"light"}/${M}.svg`,S={[r.F.concatenate]:"Combine all fields into a single frame.",[r.F.configFromData]:"Set unit, min, max and more.",[r.F.fieldLookup]:"Use a field value to lookup countries, states, or airports.",[r.F.filterFieldsByName]:"Remove parts of the query results using a regex pattern.",[r.F.filterByRefId]:"Remove rows from the data based on origin query",[r.F.filterByValue]:"Remove rows from the query results using user-defined filters.",[r.F.groupBy]:"Group data by a field value and create aggregate data.",[r.F.groupingToMatrix]:"Summarize and reorganize data based on three fields.",[r.F.joinByField]:"Combine rows from 2+ tables, based on a related field.",[r.F.labelsToFields]:"Group series by time and return labels or tags as fields.",[r.F.merge]:"Merge multiple series. Values will be combined into one row.",[r.F.organize]:"Re-order, hide, or rename fields.",[r.F.partitionByValues]:"Split a one-frame dataset into multiple series.",[r.F.prepareTimeSeries]:"Stretch data frames from the wide format into the long format.",[r.F.reduce]:"Reduce all rows or data points to a single value (ex. max, mean).",[r.F.renameByRegex]:"Rename parts of the query results using a regular expression and replacement pattern.",[r.F.seriesToRows]:"Merge multiple series. Return time, metric and values as a row."},O=M=>S[M]||g.h.getIfExists(M)?.description||""},66879:(G,R,e)=>{"use strict";e.d(R,{o:()=>U,e:()=>K});var t=e(74848),n=e(91076),s=e(96540),a=e(97497),r=e(13544),g=e(14110),i=e(29158),l=e(55852),d=e(96374),c=e(19727),h=e(40276),o=e(66864),m=e(40845),u=e(2913),p=e(79280),f=e(39601),y=e(32696);function x({message:F}){const V=(0,s.useCallback)(()=>{f.Ny.partial({tab:y.M8.Query})},[]);return(0,t.jsx)(o.PE,{justify:"center",style:{marginTop:"100px"},children:(0,t.jsxs)(o.gW,{spacing:"md",children:[(0,t.jsx)("h2",{children:F}),(0,t.jsx)("div",{children:(0,t.jsx)(l.$n,{size:"md",variant:"secondary",icon:"arrow-left",onClick:V,children:"Go back to Queries"})})]})})}var v=e(57650),P=e(32196),E=e(87885),D=e(42418),C=e(10354),b=e(10860),T=e(61680);const S={[E.f.Transformations]:"https://grafana.com/docs/grafana/latest/panels/transformations",[E.f.FieldConfig]:"https://grafana.com/docs/grafana/latest/panels/field-configuration-options/",[E.f.FieldConfigOverrides]:"https://grafana.com/docs/grafana/latest/panels/field-configuration-options/#override-a-field"},O=F=>S[F];var M=e(10803);const I="dashboard.components.TransformationEditor.featureInfoBox.isDismissed";function L(F){const{noTransforms:V,search:w,xforms:z,onSearchChange:N,onSearchKeyDown:H,onTransformationAdd:Q,suffix:X}=F;return(0,t.jsxs)(o.gW,{children:[V&&(0,t.jsx)(o.mc,{grow:1,children:(0,t.jsx)(T.b,{storageKey:I,defaultValue:!1,children:(ee,Z)=>ee?null:(0,t.jsxs)(D.F,{title:"Transformations",severity:"info",onRemove:()=>{Z(!0)},children:[(0,t.jsxs)("p",{children:["Transformations allow you to join, calculate, re-order, hide, and rename your query results before they are visualized. ",(0,t.jsx)("br",{}),"Many transforms are not suitable if you're using the Graph visualization, as it currently only supports time series data. ",(0,t.jsx)("br",{}),"It can help to switch to the Table visualization to understand what a transformation is doing."," "]}),(0,t.jsx)("a",{href:O(E.f.Transformations),className:"external-link",target:"_blank",rel:"noreferrer",children:"Read more"})]})})}),(0,t.jsx)(C.p,{"data-testid":r.Tp.components.Transforms.searchInput,value:w??"",autoFocus:!V,placeholder:"Search for transformation",onChange:N,onKeyDown:H,suffix:X}),z.map(ee=>(0,t.jsx)(B,{transform:ee,onClick:()=>{Q({value:ee.id})}},ee.name))]})}function B({transform:F,onClick:V}){const w=(0,m.of)(j);return(0,t.jsxs)(b.Z,{className:w.card,"data-testid":r.Tp.components.TransformTab.newTransform(F.name),onClick:V,children:[(0,t.jsx)(b.Z.Heading,{children:F.name}),(0,t.jsx)(b.Z.Description,{children:F.description}),F.state&&(0,t.jsx)(b.Z.Tags,{children:(0,t.jsx)(M.p,{state:F.state})})]})}function j(F){return{card:(0,P.css)({margin:"0",padding:`${F.spacing(1)}`})}}var A=e(21427);const K="viewAll";class W extends s.PureComponent{constructor(V){super(V),this.onSearchChange=N=>{this.setState({search:N.target.value})},this.onSearchKeyDown=N=>{if(N.key==="Enter"){const{search:H}=this.state;if(H){const Q=H.toLowerCase(),X=a.h.list().filter(ee=>(ee.name+ee.description).toLowerCase().indexOf(Q)>=0);X.length>0&&this.onTransformationAdd({value:X[0].id})}}else N.keyCode===27&&(this.setState({search:"",showPicker:!1}),N.stopPropagation())},this.getTransformationNextId=N=>{const{transformations:H}=this.state;let Q=0;const X=H.filter(ee=>ee.id.startsWith(N)).map(ee=>ee.id);return X.length!==0&&(Q=Math.max(...X.map(ee=>parseInt(ee.match(/\d+/)[0],10)))+1),`${N}-${Q}`},this.onTransformationAdd=N=>{let H="panel_editor_tabs_transformations_management";u.Ay.featureToggles.transformationsRedesign&&(H="transformations_redesign_"+H),(0,g.rR)(H,{action:"add",transformationId:N.value});const{transformations:Q}=this.state,X=this.getTransformationNextId(N.value);this.setState({search:"",showPicker:!1}),this.onChange([...Q,{id:X,transformation:{id:N.value,options:{}}}])},this.onTransformationChange=(N,H)=>{const{transformations:Q}=this.state,X=Array.from(Q);let ee="panel_editor_tabs_transformations_management";u.Ay.featureToggles.transformationsRedesign&&(ee="transformations_redesign_"+ee),(0,g.rR)(ee,{action:"change",transformationId:X[N].transformation.id}),X[N].transformation=H,this.onChange(X)},this.onTransformationRemove=N=>{const{transformations:H}=this.state,Q=Array.from(H);let X="panel_editor_tabs_transformations_management";u.Ay.featureToggles.transformationsRedesign&&(X="transformations_redesign_"+X),(0,g.rR)(X,{action:"remove",transformationId:Q[N].transformation.id}),Q.splice(N,1),this.onChange(Q)},this.onTransformationRemoveAll=()=>{this.onChange([]),this.setState({showRemoveAllModal:!1})},this.onDragEnd=N=>{const{transformations:H}=this.state;if(!N||!N.destination)return;const Q=N.source.index,X=N.destination.index;if(Q===X)return;const ee=Array.from(H),[Z]=ee.splice(Q,1);ee.splice(X,0,Z),this.onChange(ee)},this.renderEmptyMessage=()=>(0,t.jsx)(p.p,{onShowPicker:()=>{this.setState({showPicker:!0})}}),this.renderTransformationEditors=()=>{const{data:N,transformations:H}=this.state;return(0,t.jsx)(n.JY,{onDragEnd:this.onDragEnd,children:(0,t.jsx)(n.gL,{droppableId:"transformations-list",direction:"vertical",children:Q=>(0,t.jsxs)("div",{ref:Q.innerRef,...Q.droppableProps,children:[(0,t.jsx)(v.A,{configs:H,data:N,onRemove:this.onTransformationRemove,onChange:this.onTransformationChange}),Q.placeholder]})})})};const w=V.panel.transformations||[],z=this.buildTransformationIds(w);this.state={transformations:w.map((N,H)=>({transformation:N,id:z[H]})),data:{series:[]},search:"",selectedFilter:K,showIllustrations:!0}}buildTransformationIds(V){const w={},z=[];for(let N=0;N<V.length;N++){const H=V[N];w[H.id]===void 0?w[H.id]=0:w[H.id]+=1,z.push(`${V[N].id}-${w[V[N].id]}`)}return z}componentDidMount(){this.subscription=this.props.panel.getQueryRunner().getData({withTransforms:!1,withFieldConfig:!1}).subscribe({next:V=>this.setState({data:V})})}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe()}componentDidUpdate(V,w){if(u.Ay.featureToggles.transformationsRedesign){const N=!(w.transformations.length>0)||w.showPicker,Q=!(this.state.transformations.length>0)||this.state.showPicker;if(N!==Q){const X=Math.random()/2;this.setState({scrollTop:Q?X:Number.MAX_SAFE_INTEGER})}}}onChange(V){this.setState({transformations:V}),this.props.panel.setTransformations(V.map(w=>w.transformation))}renderTransformsPicker(){let{showPicker:V}=this.state;const{transformations:w,search:z}=this.state,{transformationsRedesign:N}=u.Ay.featureToggles,H=!w?.length,Q=w.length>0;let X=null,ee=a.h.list().sort((k,se)=>k.name>se.name?1:se.name>k.name?-1:0);if(!N&&H&&(V=!0),this.state.selectedFilter!==K&&(ee=ee.filter(k=>k.categories&&this.state.selectedFilter&&k.categories.has(this.state.selectedFilter))),z){const k=z.toLowerCase(),se=ee.filter(te=>(te.name+te.description).toLowerCase().indexOf(k)>=0);X=(0,t.jsxs)(t.Fragment,{children:[se.length," / ",ee.length," \xA0\xA0",(0,t.jsx)(i.K,{name:"times",onClick:()=>{this.setState({search:""})},tooltip:"Clear search"})]}),ee=se}!X&&V&&!H&&(X=(0,t.jsx)(i.K,{name:"times",onClick:()=>{this.setState({showPicker:!1})},tooltip:"Close picker"}));let Z=null,q=null;N?(Z=(0,t.jsx)(A.R,{noTransforms:H,search:z,suffix:X,xforms:ee,onClose:()=>this.setState({showPicker:!1}),onSelectedFilterChange:k=>this.setState({selectedFilter:k}),onShowIllustrationsChange:k=>this.setState({showIllustrations:k}),onSearchChange:this.onSearchChange,onSearchKeyDown:this.onSearchKeyDown,onTransformationAdd:this.onTransformationAdd,data:this.state.data.series,selectedFilter:this.state.selectedFilter,showIllustrations:this.state.showIllustrations}),q=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.$n,{icon:"times",variant:"secondary",onClick:()=>this.setState({showRemoveAllModal:!0}),style:{marginLeft:this.props.theme.spacing.md},children:"Delete all transformations"}),(0,t.jsx)(d.u,{isOpen:!!this.state.showRemoveAllModal,title:"Delete all transformations?",body:"By deleting all transformations, you will go back to the main selection screen.",confirmText:"Delete all",onConfirm:()=>this.onTransformationRemoveAll(),onDismiss:()=>this.setState({showRemoveAllModal:!1})})]})):Z=(0,t.jsx)(L,{noTransforms:H,search:z,suffix:X,xforms:ee,onSearchChange:this.onSearchChange,onSearchKeyDown:this.onSearchKeyDown,onTransformationAdd:this.onTransformationAdd});const ae=(0,t.jsxs)(c.e,{children:[(0,t.jsx)(l.$n,{icon:"plus",variant:"secondary",onClick:()=>{this.setState({showPicker:!0})},"data-testid":r.Tp.components.Transforms.addTransformationButton,children:"Add another transformation"}),q]});return(0,t.jsxs)(t.Fragment,{children:[V&&Z,N&&Q&&ae||!N&&!V&&Q&&ae]})}render(){const{panel:{alert:V}}=this.props,{transformations:w}=this.state,z=w.length>0;if(V){const N=z?"Transformations can't be used on a panel with alerts":"Transformations can't be used on a panel with existing alerts";return(0,t.jsx)(x,{message:N})}return(0,t.jsx)(h.E,{scrollTop:this.state.scrollTop,autoHeightMin:"100%",children:(0,t.jsx)(o.mc,{padding:"lg",children:(0,t.jsxs)("div",{"data-testid":r.Tp.components.TransformTab.content,children:[!z&&u.Ay.featureToggles.transformationsRedesign&&this.renderEmptyMessage(),z&&this.renderTransformationEditors(),this.renderTransformsPicker()]})})})}}const U=(0,m.SL)(W)},68064:(G,R,e)=>{"use strict";e.d(R,{A:()=>v});var t=e(74848),n=e(32196),s=e(13544),a=e(39601),r=e(32264),g=e(40845),i=e(67061),l=e(90613),d=e(94753),c=e(55852),h=e(8484),o=e(36974),m=e(34865),u=e(55600),p=e(7758),f=e(31678),y=e(28601);const v=({dashboard:E,canCreate:D})=>{const C=(0,g.of)(P),b=(0,f.useDispatch)(),T=(0,f.useSelector)(M=>M.dashboard.initialDatasource),S=()=>{let M;if(E instanceof u.H$){const I=E.onCreateNewPanel();E.setState({editPanel:(0,m.L)(I,!0)}),a.Ny.partial({firstPanel:!0})}else M=(0,o.OK)(E,T),b((0,y.Ub)(void 0)),a.Ny.partial({editPanel:M,firstPanel:!0});p.c.emptyDashboardButtonClicked({item:"add_visualization"})},O=()=>{p.c.emptyDashboardButtonClicked({item:"import_from_library"}),E instanceof u.H$?E.onShowAddLibraryPanelDrawer():(0,o.s3)(E)};return(0,t.jsx)(i.B,{alignItems:"center",justifyContent:"center",children:(0,t.jsx)("div",{className:C.wrapper,children:(0,t.jsxs)(i.B,{alignItems:"stretch",justifyContent:"center",gap:4,direction:"column",children:[(0,t.jsx)(l.a,{borderColor:"strong",borderStyle:"dashed",padding:4,children:(0,t.jsxs)(i.B,{direction:"column",alignItems:"center",gap:2,children:[(0,t.jsx)(d.E,{element:"h1",textAlignment:"center",weight:"medium",children:(0,t.jsx)(h.x6,{i18nKey:"dashboard.empty.add-visualization-header",children:"Start your new dashboard by adding a visualization"})}),(0,t.jsx)(l.a,{marginBottom:2,paddingX:4,children:(0,t.jsx)(d.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,t.jsx)(h.x6,{i18nKey:"dashboard.empty.add-visualization-body",children:"Select a data source and then query and visualize your data with charts, stats and tables or create lists, markdowns and other widgets."})})}),(0,t.jsx)(c.$n,{size:"lg",icon:"plus","data-testid":s.Tp.pages.AddDashboard.itemButton("Create new panel button"),onClick:S,disabled:!D,children:(0,t.jsx)(h.x6,{i18nKey:"dashboard.empty.add-visualization-button",children:"Add visualization"})})]})}),(0,t.jsxs)(i.B,{direction:{xs:"column",md:"row"},wrap:"wrap",gap:4,children:[r.$.featureToggles.vizAndWidgetSplit&&(0,t.jsx)(l.a,{borderColor:"strong",borderStyle:"dashed",padding:3,flex:1,children:(0,t.jsxs)(i.B,{direction:"column",alignItems:"center",gap:1,children:[(0,t.jsx)(d.E,{element:"h3",textAlignment:"center",weight:"medium",children:(0,t.jsx)(h.x6,{i18nKey:"dashboard.empty.add-widget-header",children:"Add a widget"})}),(0,t.jsx)(l.a,{marginBottom:2,children:(0,t.jsx)(d.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,t.jsx)(h.x6,{i18nKey:"dashboard.empty.add-widget-body",children:"Create lists, markdowns and other widgets"})})}),(0,t.jsx)(c.$n,{icon:"plus",fill:"outline","data-testid":s.Tp.pages.AddDashboard.itemButton("Create new widget button"),onClick:()=>{p.c.emptyDashboardButtonClicked({item:"add_widget"}),a.Ny.partial({addWidget:!0})},disabled:!D,children:(0,t.jsx)(h.x6,{i18nKey:"dashboard.empty.add-widget-button",children:"Add widget"})})]})}),(0,t.jsx)(l.a,{borderColor:"strong",borderStyle:"dashed",padding:3,flex:1,children:(0,t.jsxs)(i.B,{direction:"column",alignItems:"center",gap:1,children:[(0,t.jsx)(d.E,{element:"h3",textAlignment:"center",weight:"medium",children:(0,t.jsx)(h.x6,{i18nKey:"dashboard.empty.add-library-panel-header",children:"Import panel"})}),(0,t.jsx)(l.a,{marginBottom:2,children:(0,t.jsx)(d.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,t.jsx)(h.x6,{i18nKey:"dashboard.empty.add-library-panel-body",children:"Add visualizations that are shared with other dashboards."})})}),(0,t.jsx)(c.$n,{icon:"plus",fill:"outline","data-testid":s.Tp.pages.AddDashboard.itemButton("Add a panel from the panel library button"),onClick:O,disabled:!D,children:(0,t.jsx)(h.x6,{i18nKey:"dashboard.empty.add-library-panel-button",children:"Add library panel"})})]})}),(0,t.jsx)(l.a,{borderColor:"strong",borderStyle:"dashed",padding:3,flex:1,children:(0,t.jsxs)(i.B,{direction:"column",alignItems:"center",gap:1,children:[(0,t.jsx)(d.E,{element:"h3",textAlignment:"center",weight:"medium",children:(0,t.jsx)(h.x6,{i18nKey:"dashboard.empty.import-a-dashboard-header",children:"Import a dashboard"})}),(0,t.jsx)(l.a,{marginBottom:2,children:(0,t.jsx)(d.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,t.jsxs)(h.x6,{i18nKey:"dashboard.empty.import-a-dashboard-body",children:["Import dashboards from files or ",(0,t.jsx)("a",{href:"https://grafana.com/grafana/dashboards/",children:"grafana.com"}),"."]})})}),(0,t.jsx)(c.$n,{icon:"upload",fill:"outline","data-testid":s.Tp.pages.AddDashboard.itemButton("Import dashboard button"),onClick:()=>{p.c.emptyDashboardButtonClicked({item:"import_dashboard"}),(0,o.VF)()},disabled:!D,children:(0,t.jsx)(h.x6,{i18nKey:"dashboard.empty.import-dashboard-button",children:"Import dashboard"})})]})})]})]})})})};function P(E){return{wrapper:(0,n.css)({label:"dashboard-empty-wrapper",flexDirection:"column",maxWidth:"890px",gap:E.spacing.gridSize*4,paddingTop:E.spacing(2),[E.breakpoints.up("sm")]:{paddingTop:E.spacing(12)}})}}},2038:(G,R,e)=>{"use strict";e.d(R,{Z:()=>o});var t=e(74848),n=e(96540),s=e(39601),a=e(32196),r=e(40845),g=e(27746),i=e(14578),l=e(56034),d=e(16797);const c=({notice:m,onClick:u})=>{const p=(0,r.of)(h),f=m.severity==="error"||m.severity==="warning"?"exclamation-triangle":"file-landscape-alt";return m.inspect&&u?(0,t.jsx)(g.I,{className:p.notice,icon:f,iconSize:"md",tooltip:m.text,onClick:y=>u(y,m.inspect)},m.severity):m.link?(0,t.jsx)("a",{className:p.notice,"aria-label":m.text,href:m.link,target:"_blank",rel:"noreferrer",children:(0,t.jsx)(i.I,{name:f,style:{marginRight:"8px"},size:"md"})}):(0,t.jsx)(l.m,{content:m.text,children:(0,t.jsx)("span",{className:p.iconTooltip,children:(0,t.jsx)(i.I,{name:f,size:"md"})})},m.severity)},h=m=>({notice:(0,a.css)({background:"inherit",border:"none",borderRadius:m.shape.radius.default}),iconTooltip:(0,a.css)({color:`${m.colors.text.secondary}`,backgroundColor:"inherit",cursor:"auto",border:"none",borderRadius:`${m.shape.radius.default}`,padding:`${m.spacing(0,1)}`,height:` ${m.spacing(m.components.height.md)}`,display:"flex",alignItems:"center",justifyContent:"center","&:focus, &:focus-visible":{...(0,d.getFocusStyles)(m),zIndex:1},"&: focus:not(:focus-visible)":(0,d.getMouseFocusStyles)(m),"&:hover ":{boxShadow:`${m.shadows.z1}`,color:`${m.colors.text.primary}`,background:`${m.colors.background.secondary}`}})}),o=({frames:m,panelId:u})=>{const p=(0,n.useCallback)((y,x)=>{y.stopPropagation(),s.Ny.partial({inspect:u,inspectTab:x})},[u]),f={};for(const y of m)if(!(!y.meta||!y.meta.notices))for(const x of y.meta.notices)f[x.severity]=x;return(0,t.jsx)(t.Fragment,{children:Object.values(f).map(y=>(0,t.jsx)(c,{notice:y,onClick:p},y.severity))})}},91126:(G,R,e)=>{"use strict";e.d(R,{M:()=>c});var t=e(37055),n=e(58972),s=e(1173),a=e(11261),r=e(28240),g=e(85200),i=e(88895);const l="hideSeriesFrom",d=(0,t.ZW)(l);function c(y,x,v,P){const{overrides:E}=v,D=y,C=E.findIndex(d);if(C<0){if(x===i.B.ToggleSelection){const I=h([D,...f(E,P)]);return{...v,overrides:[...v.overrides,I]}}const O=p(P,D),M=h(O);return{...v,overrides:[...v.overrides,M]}}const b=Array.from(E),[T]=b.splice(C,1);if(x===i.B.ToggleSelection){let O=m(T);const M=f(b,P);if(M.length>0&&(O=O.filter(L=>M.indexOf(L)<0)),O[0]===D&&O.length===1)return{...v,overrides:b};const I=h([D,...M]);return{...v,overrides:[...b,I]}}const S=o(T,D);return u(S,P)?{...v,overrides:b}:{...v,overrides:[...b,S]}}function h(y,x=n.PP.exclude,v){return v=v??{id:"custom.hideFrom",value:{viz:!0,legend:!1,tooltip:!1}},{__systemRef:l,matcher:{id:s.Ct.byNames,options:{mode:x,names:y,prefix:x===n.PP.exclude?"All except:":void 0,readOnly:!0}},properties:[{...v,value:{viz:!0,legend:!1,tooltip:!1}}]}}const o=(y,x,v=n.PP.exclude)=>{const P=y.properties.find(C=>C.id==="custom.hideFrom"),E=m(y),D=E.findIndex(C=>C===x);return D<0?E.push(x):E.splice(D,1),h(E,v,P)},m=y=>{const x=y.matcher.options?.names;return Array.isArray(x)?[...x]:[]},u=(y,x)=>m(y).length===p(x).length,p=(y,x)=>{const v=new Set;for(const P of y)for(const E of P.fields){if(E.type!==a.PU.number)continue;const D=(0,r.Ct)(E,P,y);D!==x&&v.add(D)}return Array.from(v)},f=(y,x)=>{let v=[];for(const P of y){const E=P.properties.find(D=>D.id==="custom.hideFrom");if(E!==void 0&&E.value?.legend===!0){const C=g.sJ.get(P.matcher.id).get(P.matcher.options);for(const b of x)for(const T of b.fields){if(T.type!==a.PU.number)continue;const S=(0,r.Ct)(T,b,x);C(T,b,x)&&v.push(S)}}}return v}},61582:(G,R,e)=>{"use strict";e.d(R,{a:()=>l});var t=e(49426),n=e(47232),s=e(85858);const a=100;class r{constructor(){this.listeners=[],this.budget=1,this.threshold=1.5,this.ok=new t.t(!0),this.lastUpdate=Date.now(),this.isLive=!1,this.liveTimeOffset=0,this.measure=()=>{const c=Date.now();this.budget=(c-this.lastUpdate)/a;const h=this.ok.getValue(),o=this.budget<=this.threshold;if(h!==o&&this.ok.next(o),this.lastUpdate=c,this.isLive&&this.ok.getValue()&&this.timeRange){let m;for(const u of this.listeners){if(!u.panel.props.isInView)continue;if(c-u.last>=u.intervalMs){if(!m){const{raw:f}=this.timeRange;m={raw:f,from:(0,n.KQ)(c-this.liveTimeOffset),to:(0,n.KQ)(c)}}u.panel.liveTimeChanged(m),u.last=c}}}}}setLiveTimeRange(c){if(this.timeRange=c,this.isLive=c?.raw?.to==="now",this.isLive){const h=s.parse(c.raw.from,!1)?.valueOf(),o=s.parse(c.raw.to,!0)?.valueOf();this.liveTimeOffset=o-h;for(const m of this.listeners)m.intervalMs=i(this.liveTimeOffset,m.panel.props.width)}}listen(c){this.listeners.push({last:this.lastUpdate,panel:c,intervalMs:i(6e4,c.props.width)})}remove(c){this.listeners=this.listeners.filter(h=>h.panel!==c)}updateInterval(c){if(!(!this.timeRange||!this.isLive)){for(const h of this.listeners)if(h.panel===c){h.intervalMs=i(this.liveTimeOffset,h.panel.props.width);return}}}}const g=5*60*1e3;function i(d,c){const h=Math.ceil(d/c/100)*100;return h>g?g:h}const l=new r;setInterval(l.measure,a)},17493:(G,R,e)=>{"use strict";e.d(R,{Fu:()=>P,np:()=>E});var t=e(34796),n=e.n(t),s=e(2543),a=e.n(s),r=e(95093),g=e.n(r),i=e(26272),l=e(85858),d=e(17172),c=e(39601),h=e(27677),o=e(62301),m=e(68576),u=e(72255),p=e(31193),f=e(10096),y=e(28676),x=e(14792),v=e(69064);class P{constructor(){}_dashboardLoadFailed(b,T){return T=T||!1,{meta:{canStar:!1,isSnapshot:T,canDelete:!1,canSave:!1,canEdit:!1,canShare:!1,dashboardNotFound:!0},dashboard:{title:b,uid:b,schemaVersion:0}}}loadDashboard(b,T,S){const O=(0,u.sP)();let M;if(b==="script"&&T)M=this._loadScriptedDashboard(T);else if(b==="snapshot"&&T)M=(0,v.s)().getSnapshot(T).catch(()=>this._dashboardLoadFailed("Snapshot not found",!0));else if(b==="ds"&&T)M=this._loadFromDatasource(T);else if(b==="public"&&S)M=h.IB.getPublicDashboardByUid(S).then(I=>I).catch(I=>{const L=I.data.statusCode===403&&I.data.messageId==="publicdashboards.notEnabled",B=I.data.statusCode===404&&I.data.messageId==="publicdashboards.notFound",j=I.data.statusCode===404&&I.data.messageId==="publicdashboards.dashboardNotFound",A=this._dashboardLoadFailed(L?"Public Dashboard paused":"Public Dashboard Not found",!0);return{...A,meta:{...A.meta,publicDashboardEnabled:B?void 0:!L,dashboardNotFound:B||j}}});else if(S){const I=O.getDashboardFromCache(S);if(I)return Promise.resolve(I);M=(0,y.n)().getDashboardDTO(S).then(L=>{if(L.meta.isFolder)throw f.lE.emit(i.r1.alertError,["Dashboard not found"]),new Error("Dashboard not found");return L}).catch(()=>{const L=this._dashboardLoadFailed("Not found",!0);return L.dashboard.uid=S,L})}else throw new Error("Dashboard uid or slug required");return M.then(I=>(I.meta.dashboardNotFound!==!0&&o.A.addDashboardImpression(I.dashboard.uid),I)),M}_loadScriptedDashboard(b){const T="public/dashboards/"+b.replace(/\.(?!js)/,"/")+"?"+new Date().getTime();return(0,d.AI)().get(T).then(this._executeScript.bind(this)).then(S=>({meta:{fromScript:!0,canDelete:!1,canSave:!1,canStar:!1},dashboard:S.data}),S=>(console.error("Script dashboard error "+S),f.lE.emit(i.r1.alertError,["Script Error","Please make sure it exists and returns a valid dashboard"]),this._dashboardLoadFailed("Scripted dashboard")))}async _loadFromDatasource(b){const T=await(0,p.tR)().get(b);if(!T)return Promise.reject("can not find datasource: "+b);const S=new URLSearchParams(window.location.search),O=S.get("path");if(!O)return Promise.reject("expecting path parameter");const M={};return S.forEach((I,L)=>{M[L]=I}),(0,d.AI)().get(`/api/datasources/uid/${T.uid}/resources/${O}`,M).then(I=>({meta:{fromScript:!0,canDelete:!1,canSave:!1,canStar:!1},dashboard:I}))}_executeScript(b){const T={dashboardSrv:(0,x.UA)(),datasourceSrv:(0,p.tR)()},O=new Function("ARGS","kbn","dateMath","_","moment","window","document","$","jQuery","services",b)(c.Ny.getSearchObject(),m.A,l,a(),g(),window,document,n(),n(),T);return(0,s.isFunction)(O)?new Promise(M=>{O(I=>{M({data:I})})}):{data:O}}}let E=new P;const D=C=>{throw new Error("dashboardLoaderSrv can be only overriden in test environment")}},14792:(G,R,e)=>{"use strict";e.d(R,{UA:()=>o});var t=e(26272),n=e(28138),s=e(8484),a=e(27677),r=e(28676),g=e(28444),i=e(98365),l=e(19752);class d{constructor(){this.onRemovePanel=u=>{const p=this.getCurrent();p&&(0,l.FC)(p,p.getPanelById(u),!0)},n.l.subscribe(g.Vz,u=>this.onRemovePanel(u.payload))}create(u,p){return new i.G(u,p)}setCurrent(u){this.dashboard=u}getCurrent(){return this.dashboard}saveJSONDashboard(u){const p=JSON.parse(u);return(0,r.n)().saveDashboard({dashboard:p,folderUid:this.dashboard?.meta.folderUid||p.folderUid})}saveDashboard(u,p){return(0,r.n)().saveDashboard({message:u.message,folderUid:u.folderUid,dashboard:u.dashboard.getSaveModelClone(),showErrorAlert:p?.showErrorAlert})}starDashboard(u,p){const f=(0,a.AI)(),y={showSuccessAlert:!1,url:"/api/user/stars/dashboard/uid/"+u,method:p?"DELETE":"POST"};return f.request(y).then(()=>{const x=!p;this.dashboard?.uid===u&&(this.dashboard.meta.isStarred=x);const v=x?(0,s.t)("notifications.starred-dashboard","Dashboard starred"):(0,s.t)("notifications.unstarred-dashboard","Dashboard unstarred");return n.l.emit(t.r1.alertSuccess,[v]),x})}}let c;function h(m){c=m}function o(){return c||(c=new d),c}},69064:(G,R,e)=>{"use strict";e.d(R,{s:()=>l});var t=e(75505),n=e(81160),s=e(17172),a=e(32264),r=e(10096);const g={create:d=>(0,s.AI)().post("/api/snapshots",d),getSnapshots:()=>(0,s.AI)().get("/api/dashboard/snapshots"),getSharingOptions:()=>(0,s.AI)().get("/api/snapshot/shared-options"),deleteSnapshot:d=>(0,s.AI)().delete("/api/snapshots/"+d),getSnapshot:async d=>{const c=await(0,s.AI)().get("/api/snapshots/"+d);return c.meta.canShare=!1,c}};class i{constructor(){this.apiVersion="dashboardsnapshot.grafana.app/v0alpha1",this.url=`/apis/${this.apiVersion}/namespaces/${a.$.namespace}/dashboardsnapshots`}async create(c){return(0,s.AI)().post(this.url+"/create",c)}async getSnapshots(){return(await(0,s.AI)().get(this.url)).items.map(h=>({key:h.metadata.name,name:h.spec.title,external:h.spec.externalUrl!=null,externalUrl:h.spec.externalUrl}))}deleteSnapshot(c){return(0,s.AI)().delete(this.url+"/"+c)}async getSharingOptions(){return(0,s.AI)().get("/api/snapshot/shared-options")}async getSnapshot(c){const h={};if(!r.TP.isSignedIn){alert("TODO... need a barer token for anonymous use case");const o=`??? TODO, get anon token for snapshots (${r.TP.user?.name}) ???`;h.Authorization=`Bearer ${o}`}return(0,t.s)((0,s.AI)().fetch({url:this.url+"/"+c+"/body",method:"GET",headers:h}).pipe((0,n.T)(o=>({dashboard:o.data.dashboard,meta:{isSnapshot:!0,canSave:!1,canEdit:!1,canAdmin:!1,canStar:!1,canShare:!1,canDelete:!1,isFolder:!1,provisioned:!1}}))))}}function l(){return a.$.featureToggles.kubernetesSnapshots?new i:g}},74856:(G,R,e)=>{"use strict";e.d(R,{jG:()=>E});var t=e(2543),n=e(47232),s=e(43127),a=e(65879),r=e(26272),g=e(85858),i=e(39601),l=e(84537),d=e(76412),c=e(28138),h=e(2913),o=e(16233),m=e(80582),u=e(21380),p=e(28444),f=e(11134);function y({urlRefresh:D,currentRefresh:C,isAllowedIntervalFn:b,minRefreshInterval:T,refreshIntervals:S=f.cb}){if(!D)return C;const O=b(D),M=S.find(I=>I===D);if(!O||!M){const I=T?S.find(B=>B===T):void 0,L=S?.length?S[0]:void 0;return I??L??C}return D||C}class x{constructor(C){this.contextSrv=C,this.timeRangeForUrl=()=>{const b=this.timeRange().raw;return(0,n.Ar)(b.from)&&(b.from=b.from.valueOf().toString()),(0,n.Ar)(b.to)&&(b.to=b.to.valueOf().toString()),b},this.time=(0,s.E2)().raw,this.timeAtLoad=(0,s.E2)().raw,this.refreshTimeModel=this.refreshTimeModel.bind(this),c.A.subscribe(p.U0,b=>{this.zoomOut(b.payload.scale,b.payload.updateUrl)}),c.A.subscribe(p.Io,b=>{this.shiftTime(b.payload.direction,b.payload.updateUrl)}),c.A.subscribe(p.Rh,b=>{this.makeAbsoluteTime(b.payload.updateUrl)}),c.A.subscribe(p.Bt,()=>{this.copyTimeRangeToClipboard()}),c.A.subscribe(p.VZ,b=>{this.pasteTimeRangeFromClipboard(b.payload.updateUrl)}),document.addEventListener("visibilitychange",()=>{this.autoRefreshBlocked&&document.visibilityState==="visible"&&(this.autoRefreshBlocked=!1,this.refreshTimeModel())})}init(C){this.timeModel=C,this.time=C.time,this.refresh=C.refresh,this.initTimeFromUrl(),this.parseTime(),this.timeAtLoad=(0,t.cloneDeep)(this.time),this.refresh&&this.setAutoRefresh(this.refresh)}getValidIntervals(C){return this.contextSrv.getValidIntervals(C)}parseTime(){(0,t.isString)(this.time.from)&&this.time.from.indexOf("Z")>=0&&(this.time.from=(0,n.KQ)(this.time.from).utc()),(0,t.isString)(this.time.to)&&this.time.to.indexOf("Z")>=0&&(this.time.to=(0,n.KQ)(this.time.to).utc())}parseUrlParam(C,b){if(C.indexOf("now")!==-1)return C;if(C.length===8){const T=(0,n.yT)(C,"YYYYMMDD");if(T.isValid())return T}else if(C.length===15){const T=(0,n.yT)(C,"YYYYMMDDTHHmmss");if(T.isValid())return T}if(!isNaN(Number(C))){const T=parseInt(C,10);return b?(0,n.oZ)(b,T):(0,n.yT)(T)}return null}getTimeWindow(C,b){const T=parseInt(C,10);let S;return b.match(/^\d+$/)&&parseInt(b,10)?S=parseInt(b,10):S=a.intervalToMs(b),{from:(0,n.yT)(T-S/2),to:(0,n.yT)(T+S/2)}}initTimeFromUrl(){if(h.$W.publicDashboardAccessToken&&this.timeModel?.timepicker?.hidden)return;const C=i.Ny.getSearch();C.get("time")&&C.get("time.window")&&(this.time=this.getTimeWindow(C.get("time"),C.get("time.window")));const b=this.timeModel?.getTimezone();C.get("from")&&(this.time.from=this.parseUrlParam(C.get("from"),b)||this.time.from),C.get("to")&&(this.time.to=this.parseUrlParam(C.get("to"),b)||this.time.to),C.get("to")&&C.get("to").indexOf("now")===-1&&(this.refresh=!1,this.timeModel&&(this.timeModel.refresh=void 0)),this.refresh=y({urlRefresh:C.get("refresh"),currentRefresh:this.refresh,refreshIntervals:Array.isArray(this.timeModel?.timepicker?.refresh_intervals)?this.timeModel?.timepicker?.refresh_intervals:void 0,isAllowedIntervalFn:this.contextSrv.isAllowedInterval,minRefreshInterval:h.$W.minRefreshInterval})}updateTimeRangeFromUrl(){const C=i.Ny.getSearch();if(C.get("left"))return;const b=this.timeRangeForUrl(),T=C.get("from"),S=C.get("to");T&&S?(T!==b.from||S!==b.to)&&(this.initTimeFromUrl(),this.setTime(this.time,!1)):this.timeHasChangedSinceLoad()&&this.setTime(this.timeAtLoad,!0)}timeHasChangedSinceLoad(){return this.timeAtLoad&&(this.timeAtLoad.from!==this.time.from||this.timeAtLoad.to!==this.time.to)}setAutoRefresh(C){this.timeModel&&(this.timeModel.refresh=C),this.stopAutoRefresh();const b=i.Ny.getSearchObject();if(!C){b.refresh&&i.Ny.partial({refresh:null},!0);return}let T=C,S=60*1e3;C===o.SM?S=this.getAutoRefreshInteval().intervalMs:(T=this.contextSrv.getValidInterval(C),S=a.intervalToMs(T)),this.refreshMS=S,this.refreshTimer=window.setTimeout(()=>{this.startNextRefreshTimer(S),this.refreshTimeModel()},S),b.refresh!==T&&i.Ny.partial({refresh:T},!0)}getAutoRefreshInteval(){const C=window?.innerWidth??2e3;return a.calculateInterval(this.timeRange(),C,h.$W.minRefreshInterval)}refreshTimeModel(){this.timeModel?.timeRangeUpdated(this.timeRange())}startNextRefreshTimer(C){this.refreshTimer=window.setTimeout(()=>{this.startNextRefreshTimer(C),this.contextSrv.isGrafanaVisible()?this.refreshTimeModel():this.autoRefreshBlocked=!0},C)}stopAutoRefresh(){clearTimeout(this.refreshTimer),this.refreshTimer=void 0,this.refreshMS=void 0}resumeAutoRefresh(){this.timeModel?.refresh&&this.setAutoRefresh(this.timeModel.refresh)}setTime(C,b=!0){if((0,t.extend)(this.time,C),(0,n.Ar)(C.to)?(this.oldRefresh=this.timeModel?.refresh||this.oldRefresh,this.setAutoRefresh("")):this.oldRefresh&&this.oldRefresh!==this.timeModel?.refresh&&(this.setAutoRefresh(this.oldRefresh),this.oldRefresh=void 0),b===!0){const T=this.timeRangeForUrl(),S=i.Ny.getSearchObject();if(S.from===T.from.toString()&&S.to===T.to.toString())return;S.from=T.from.toString(),S.to=T.to.toString(),i.Ny.partial(S)}this.timeModel?.refresh===o.SM&&this.getAutoRefreshInteval().intervalMs!==this.refreshMS&&this.setAutoRefresh(o.SM),this.refreshTimeModel()}timeRange(){return window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive?l.jh.getTimeRange(window.__grafanaSceneContext).state.value:(0,u.z)(this.time,this.timeModel)}zoomOut(C,b=!0){const T=this.timeRange(),{from:S,to:O}=(0,m.Zk)(T,C);this.setTime({from:(0,n.yT)(S),to:(0,n.yT)(O)},b)}shiftTime(C,b=!0){const T=this.timeRange(),{from:S,to:O}=(0,m.Wb)(C,T);this.setTime({from:(0,n.yT)(S),to:(0,n.yT)(O)},b)}makeAbsoluteTime(C){const{from:b,to:T}=this.timeRange();this.setTime({from:b,to:T},C)}copyTimeRangeToClipboard(){const{raw:C}=this.timeRange();navigator.clipboard.writeText(JSON.stringify({from:C.from,to:C.to})),c.A.emit(r.r1.alertSuccess,[(0,d.t)("time-picker.copy-paste.copy-success-message","Time range copied to clipboard")])}async pasteTimeRangeFromClipboard(C=!0){const{range:b,isError:T}=await(0,m.zG)();if(T===!0){c.A.emit(r.r1.alertError,[(0,d.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,d.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:b})]);return}const{from:S,to:O}=b;this.setTime({from:S,to:O},C)}isRefreshOutsideThreshold(C,b=.05){const T=this.timeRange();if(g.isMathString(T.raw.from)){const S=T.to.diff(T.from),O=Date.now()-C,M=S*b;return O>=M}return!1}}let v;function P(D){v=D}function E(){return v||(v=new x(o.TP)),v}},79056:(G,R,e)=>{"use strict";e.d(R,{O2:()=>K,SW:()=>W,og:()=>N});var t=e(2543),n=e(69550),s=e(92041),a=e(12470),r=e(22391),g=e(76885),i=e(6709),l=e(25019),d=e(47737),c=e(1173),h=e(11261),o=e(6829),m=e(58140),u=e(19347),p=e(52622),f=e(57021),y=e(79648),x=e(2913),v=e(15054);function P(k){return Array.from(new Array(k+1),(se,te)=>te).filter(se=>k%se===0)}var E=e(68576),D=e(31193),C=e(24240),b=e(86886),T=e(14678),S=e(14738),O=e(36373),M=e(77789),I=e(25640);function L(k,se){const te=[];if(k?.statistics&&k?.statistics.length){k.statistic=k.statistics[0];for(const ne of k.statistics.splice(1))te.push({...k,statistic:ne})}for(const ne of te)ne.refId=(0,M.M)(se),delete ne.statistics,se.push(ne);return delete k.statistics,te}function B(k){const se=[];if(k&&"statistics"in k&&k?.statistics?.length){for(const te of k.statistics.splice(1)){const{statistics:ne,name:le,...re}=k;se.push({...re,statistic:te,name:`${le} - ${te}`})}k.statistic=k.statistics[0],se.length!==0&&(k.name=`${k.name} - ${k.statistic}`),delete k.statistics}return se}function j(k){k.hasOwnProperty("metricQueryType")||(k.metricQueryType=I.d$.Search),k.hasOwnProperty("metricEditorMode")||(k.metricQueryType===I.d$.Insights?k.metricEditorMode=I.Rx.Code:k.metricEditorMode=k.expression?I.Rx.Code:I.Rx.Builder)}var A=e(84423);n.D.setInit(y.H),n.G.setInit(y.u);const K=40;class W{constructor(se){this.dashboard=se,(0,u.l)()||(0,u.h)(new D.xq)}updateSchema(se){let te,ne,le,re;const de=this.dashboard.schemaVersion,oe=[];if(this.dashboard.schemaVersion=K,de!==this.dashboard.schemaVersion){if(de<2&&(se.services&&se.services.filter&&(this.dashboard.time=se.services.filter.time,this.dashboard.templating.list=se.services.filter.list||[]),oe.push(J=>(J.type==="graphite"&&(J.type="graph"),J.type!=="graph"||((0,t.isBoolean)(J.legend)&&(J.legend={show:J.legend}),J.grid&&(J.grid.min&&(J.grid.leftMin=J.grid.min,delete J.grid.min),J.grid.max&&(J.grid.leftMax=J.grid.max,delete J.grid.max)),J.y_format&&(J.y_formats||(J.y_formats=[]),J.y_formats[0]=J.y_format,delete J.y_format),J.y2_format&&(J.y_formats||(J.y_formats=[]),J.y_formats[1]=J.y2_format,delete J.y2_format)),J))),de<3){let J=this.dashboard.getNextPanelId();oe.push(ce=>(ce.id||(ce.id=J,J+=1),ce))}if(de<4&&oe.push(J=>(J.type!=="graph"||((0,t.each)(J.aliasYAxis,(ce,pe)=>{J.seriesOverrides=[{alias:pe,yaxis:ce}]}),delete J.aliasYAxis),J)),de<6){const J=(0,t.find)(se.pulldowns,{type:"annotations"});for(J&&(this.dashboard.annotations={list:J.annotations||[]}),te=0;te<this.dashboard.templating.list.length;te++){const ce=this.dashboard.templating.list[te];ce.datasource===void 0&&(ce.datasource=null),ce.type==="filter"&&(ce.type="query"),ce.type===void 0&&(ce.type="query"),ce.allFormat===void 0&&delete ce.allFormat}}if(de<7&&(se.nav&&se.nav.length&&(this.dashboard.timepicker=se.nav[0]),oe.push(J=>((0,t.each)(J.targets,ce=>{ce.refId||(ce.refId=J.getNextQueryLetter&&J.getNextQueryLetter())}),J))),de<8&&oe.push(J=>((0,t.each)(J.targets,ce=>{ce.fields&&ce.tags&&ce.groupBy&&(ce.rawQuery?(delete ce.fields,delete ce.fill):(ce.select=(0,t.map)(ce.fields,pe=>{const xe=[];return xe.push({type:"field",params:[pe.name]}),xe.push({type:pe.func,params:[]}),pe.mathExpr&&xe.push({type:"math",params:[pe.mathExpr]}),pe.asExpr&&xe.push({type:"alias",params:[pe.asExpr]}),xe}),delete ce.fields,(0,t.each)(ce.groupBy,pe=>{pe.type==="time"&&pe.interval&&(pe.params=[pe.interval],delete pe.interval),pe.type==="tag"&&pe.key&&(pe.params=[pe.key],delete pe.key)}),ce.fill&&(ce.groupBy.push({type:"fill",params:[ce.fill]}),delete ce.fill)))}),J)),de<9&&oe.push(J=>{if(J.type!=="singlestat"&&J.thresholds!=="")return J;if(J.thresholds){const ce=J.thresholds.split(",");ce.length>=3&&(ce.shift(),J.thresholds=ce.join(","))}return J}),de<10&&oe.push(J=>(J.type!=="table"||(0,t.each)(J.styles,ce=>{if(ce.thresholds&&ce.thresholds.length>=3){const pe=ce.thresholds;pe.shift(),ce.thresholds=pe}}),J)),de<12&&(0,t.each)(this.dashboard.getVariables(),J=>{"refresh"in J&&(J.refresh&&(J.refresh=1),J.refresh||(J.refresh=0)),"hideVariable"in J&&J.hideVariable?J.hide=2:"hideLabel"in J&&J.hideLabel&&(J.hide=1)}),de<12&&oe.push(J=>(J.type!=="graph"||!J.grid||J.yaxes||(J.yaxes=[{show:J["y-axis"],min:J.grid.leftMin,max:J.grid.leftMax,logBase:J.grid.leftLogBase,format:J.y_formats[0],label:J.leftYAxisLabel},{show:J["y-axis"],min:J.grid.rightMin,max:J.grid.rightMax,logBase:J.grid.rightLogBase,format:J.y_formats[1],label:J.rightYAxisLabel}],J.xaxis={show:J["x-axis"]},delete J.grid.leftMin,delete J.grid.leftMax,delete J.grid.leftLogBase,delete J.grid.rightMin,delete J.grid.rightMax,delete J.grid.rightLogBase,delete J.y_formats,delete J.leftYAxisLabel,delete J.rightYAxisLabel,delete J["y-axis"],delete J["x-axis"]),J)),de<13&&oe.push(J=>{if(J.type!=="graph"||!J.grid)return J;J.thresholds||(J.thresholds=[]);const ce={},pe={};return J.grid.threshold1!==null&&(ce.value=J.grid.threshold1,J.grid.thresholdLine?(ce.line=!0,ce.lineColor=J.grid.threshold1Color,ce.colorMode="custom"):(ce.fill=!0,ce.fillColor=J.grid.threshold1Color,ce.colorMode="custom")),J.grid.threshold2!==null&&(pe.value=J.grid.threshold2,J.grid.thresholdLine?(pe.line=!0,pe.lineColor=J.grid.threshold2Color,pe.colorMode="custom"):(pe.fill=!0,pe.fillColor=J.grid.threshold2Color,pe.colorMode="custom")),(0,t.isNumber)(ce.value)&&((0,t.isNumber)(pe.value)?ce.value>pe.value?(ce.op=pe.op="lt",J.thresholds.push(ce),J.thresholds.push(pe)):(ce.op=pe.op="gt",J.thresholds.push(ce),J.thresholds.push(pe)):(ce.op="gt",J.thresholds.push(ce))),delete J.grid.threshold1,delete J.grid.threshold1Color,delete J.grid.threshold2,delete J.grid.threshold2Color,delete J.grid.thresholdLine,J}),de<14&&(this.dashboard.graphTooltip=se.sharedCrosshair?1:0),de<16&&this.upgradeToGridLayout(se),de<17&&oe.push(J=>{if(J.minSpan){const ce=v.cV/J.minSpan,pe=P(v.cV);J.maxPerRow=pe[(0,t.findIndex)(pe,xe=>xe>ce)-1]}return delete J.minSpan,J}),de<18&&oe.push(J=>(J["options-gauge"]&&(J.options=J["options-gauge"],J.options.valueOptions={unit:J.options.unit,stat:J.options.stat,decimals:J.options.decimals,prefix:J.options.prefix,suffix:J.options.suffix},J.options.thresholds&&J.options.thresholds.reverse(),delete J.options.options,delete J.options.unit,delete J.options.stat,delete J.options.decimals,delete J.options.prefix,delete J.options.suffix,delete J["options-gauge"]),J)),de<19&&oe.push(J=>(J.links&&(0,t.isArray)(J.links)&&(J.links=J.links.map(V)),J)),de<20){const J=ce=>({...ce,url:w(ce.url)});oe.push(ce=>(ce.options&&ce.options.dataLinks&&(0,t.isArray)(ce.options.dataLinks)&&(ce.options.dataLinks=ce.options.dataLinks.map(J)),ce.options&&ce.options.fieldOptions&&ce.options.fieldOptions.defaults&&(ce.options.fieldOptions.defaults.links&&(0,t.isArray)(ce.options.fieldOptions.defaults.links)&&(ce.options.fieldOptions.defaults.links=ce.options.fieldOptions.defaults.links.map(J)),ce.options.fieldOptions.defaults.title&&(ce.options.fieldOptions.defaults.title=w(ce.options.fieldOptions.defaults.title))),ce))}if(de<21){const J=ce=>({...ce,url:ce.url.replace(/__series.labels/g,"__field.labels")});oe.push(ce=>(ce.options&&ce.options.dataLinks&&(0,t.isArray)(ce.options.dataLinks)&&(ce.options.dataLinks=ce.options.dataLinks.map(J)),ce.options&&ce.options.fieldOptions&&ce.options.fieldOptions.defaults&&ce.options.fieldOptions.defaults.links&&(0,t.isArray)(ce.options.fieldOptions.defaults.links)&&(ce.options.fieldOptions.defaults.links=ce.options.fieldOptions.defaults.links.map(J)),ce))}if(de<22&&oe.push(J=>(J.type!=="table"||(0,t.each)(J.styles,ce=>{ce.align="auto"}),J)),de<23)for(const J of this.dashboard.templating.list){if(!(0,C.iv)(J))continue;const{multi:ce,current:pe}=J;(0,s.R)(pe)||(J.current=(0,b.C)(pe,ce))}if(de<24&&oe.push(J=>{const ce=J.type==="table";if(ce&&!J.styles)return J;const pe=J.table==="table2";return!ce||pe||(J.type=ce?"table-old":"table"),J}),de<25,de<26&&oe.push(J=>(J.type==="text2"&&(J.type="text",delete J.options.angular),J)),de<27&&(this.removeRepeatedPanels(),this.dashboard.templating.list=this.dashboard.templating.list.map(J=>{if(!(0,C.VO)(J))return J;const ce={...J};return ce.current={selected:!0,text:ce.query??"",value:ce.query??""},ce.options=[ce.current],ce.hide===a.zL.dontHide||ce.hide===a.zL.hideLabel?{...ce,type:"textbox"}:ce})),de<28){oe.push(J=>J.type==="singlestat"?z(J):J);for(const J of this.dashboard.templating.list)J.tags&&delete J.tags,J.tagsQuery&&delete J.tagsQuery,J.tagValuesQuery&&delete J.tagValuesQuery,J.useTags&&delete J.useTags}if(de<29)for(const J of this.dashboard.templating.list)J.type==="query"&&(J.refresh!==1&&J.refresh!==2&&(J.refresh=1),J.options?.length&&(J.options=[]));if(de<30&&(oe.push(Q),oe.push(q)),de<31&&oe.push(J=>{if(J.transformations){for(const ce of J.transformations)if(ce.id===o.V.id)return H(J,o.V.id,{id:m.o.id,options:{}})}return J}),de<32,de<33&&oe.push(J=>{if(J.datasource=N(J.datasource,{returnDefaultAsNull:!0}),!J.targets)return J;for(const ce of J.targets){const pe=N(ce.datasource,{returnDefaultAsNull:!0});pe!=null&&(ce.datasource=pe)}return J}),de<34&&(oe.push(J=>(this.migrateCloudWatchQueries(J),J)),this.migrateCloudWatchAnnotationQuery()),de<35&&oe.push(ae),de<36){for(const ce of this.dashboard.annotations.list)ce.datasource=N(ce.datasource,{returnDefaultAsNull:!1});const J=(0,u.l)().getInstanceSettings(null);if(J){for(const ce of this.dashboard.templating.list)ce.type==="query"&&ce.datasource===null&&(ce.datasource=(0,r.p$)(J));oe.push(ce=>{if(ce.targets){let pe=!1;ce.datasource==null&&ce.targets.length>0&&(ce.datasource=(0,r.p$)(J),pe=!0);for(const xe of ce.targets)(xe.datasource==null||xe.datasource.uid==null)&&(ce.datasource?.uid!==T.uv?xe.datasource={...ce.datasource}:xe.datasource=N(xe.datasource,{returnDefaultAsNull:!1})),pe&&xe.datasource?.uid!=="__expr__"&&(ce.datasource=xe.datasource)}return ce})}}if(de<37&&oe.push(J=>(J.options?.legend&&(J.options.legend.displayMode==="hidden"||J.options.legend.showLegend===!1)?(J.options.legend.displayMode="list",J.options.legend.showLegend=!1):J.options?.legend&&(J.options.legend={...J.options?.legend,showLegend:!0}),J)),de<38&&oe.push(J=>{if(J.type==="table"&&J.fieldConfig!==void 0){const ce=J.fieldConfig.defaults?.custom?.displayMode;if(ce!==void 0&&(J.fieldConfig.defaults.custom.cellOptions=(0,f.o7)(ce),delete J.fieldConfig.defaults.custom.displayMode),J.fieldConfig?.overrides)for(const pe of J.fieldConfig.overrides)for(let xe=0;xe<pe.properties?.length;xe++){let fe=pe.properties[xe].value;pe.properties[xe].id==="custom.displayMode"&&(pe.properties[xe].id="custom.cellOptions",pe.properties[xe].value=(0,f.o7)(fe))}}return J}),de<39&&oe.push(J=>(J.transformations?.forEach(ce=>{if(ce.id==="timeSeriesTable"&&ce.options!==void 0&&ce.options.refIdToStat!==void 0){let pe={};for(const[xe,fe]of Object.entries(ce.options.refIdToStat)){let Ee={};Ee.stat=fe,pe[xe]=Ee}ce.options=pe}}),J)),de<40&&typeof this.dashboard.refresh!="string"&&(this.dashboard.refresh=""),oe.length!==0)for(ne=0;ne<this.dashboard.panels.length;ne++)for(le=0;le<oe.length;le++){this.dashboard.panels[ne]=oe[le].call(this,this.dashboard.panels[ne]);const J=this.dashboard.panels[ne].panels;if(J)for(re=0;re<J.length;re++)J[re]=oe[le].call(this,J[re])}}}removeRepeatedPanels(){const se=[];for(const te of this.dashboard.panels)te.repeatPanelId||te.repeatByRow||(te.type==="row"&&Array.isArray(te.panels)&&(te.panels=te.panels.filter(ne=>!ne.repeatPanelId)),se.push(te));this.dashboard.panels=se}migrateCloudWatchQueries(se){for(const te of se.targets||[])if(X(te)&&(j(te),te.hasOwnProperty("statistics"))){const ne=L(te,[...se.targets]);for(const le of ne)se.targets.push(le)}}migrateCloudWatchAnnotationQuery(){for(const se of this.dashboard.annotations.list)if(ee(se)){const te=B(se);for(const ne of te)this.dashboard.annotations.list.push(ne)}}upgradeToGridLayout(se){let te=0;const ne=v.cV/12;let re=(0,t.max)((0,t.flattenDeep)((0,t.map)(se.rows,oe=>(0,t.map)(oe.panels,"id"))))+1;if(!se.rows)return;const de=(0,t.some)(se.rows,oe=>oe.collapse||oe.showTitle||oe.repeat);for(const oe of se.rows){if(oe.repeatIteration)continue;const J=oe.height||v.bJ,ce=U(J),pe={};let xe;de&&(pe.id=re,pe.type="row",pe.title=oe.title,pe.collapsed=oe.collapse,pe.repeat=oe.repeat,pe.panels=[],pe.gridPos={x:0,y:te,w:v.cV,h:ce},xe=new A.a9(pe),re++,te++);const fe=new F(ce,v.cV,te);for(const Ee of oe.panels){Ee.span=Ee.span||v.o9,Ee.minSpan&&(Ee.minSpan=Math.min(v.cV,v.cV/12*Ee.minSpan));const Se=Math.floor(Ee.span)*ne,ye=Ee.height?U(Ee.height):ce,Ve=fe.getPanelPosition(ye,Se);te=fe.yPos,Ee.gridPos={x:Ve.x,y:te+Ve.y,w:Se,h:ye},fe.addPanel(Ee.gridPos),delete Ee.span,xe&&pe.collapsed?xe.panels?.push(Ee):this.dashboard.panels.push(new A.a9(Ee))}xe&&this.dashboard.panels.push(xe),xe&&pe.collapsed||(te+=ce)}}}function U(k){return(0,t.isString)(k)&&(k=parseInt(k.replace("px",""),10)),k<v.cx&&(k=v.cx),Math.ceil(k/(v.sD+v.dU))}class F{constructor(se,te=v.cV,ne=0){this.area=new Array(te).fill(0),this.yPos=ne,this.height=se}reset(){this.area.fill(0)}addPanel(se){for(let te=se.x;te<se.x+se.w;te++)(!this.area[te]||se.y+se.h-this.yPos>this.area[te])&&(this.area[te]=se.y+se.h-this.yPos);return this.area}getPanelPosition(se,te,ne=!1){let le,re,de;for(let oe=this.area.length-1;oe>=0&&this.height-this.area[oe]>0;oe--)if(re===void 0)re=oe;else if(oe<this.area.length-1&&this.area[oe]<=this.area[oe+1])le=oe;else break;if(le!==void 0&&re!==void 0&&re-le>=te-1){const oe=(0,t.max)(this.area.slice(le));de={x:le,y:oe}}else return ne?null:(this.yPos+=this.height,this.reset(),this.getPanelPosition(se,te,!0));return de}}function V(k){let se=k.url;return!se&&k.dashboard&&(se=`dashboard/db/${E.A.slugifyForUrl(k.dashboard)}`),!se&&k.dashUri&&(se=`dashboard/${k.dashUri}`),se||(se="/"),k.keepTime&&(se=g.kM.appendQueryToUrl(se,`$${i.c.keepTime}`)),k.includeVars&&(se=g.kM.appendQueryToUrl(se,`$${i.c.includeVars}`)),k.params&&(se=g.kM.appendQueryToUrl(se,k.params)),{url:se,title:k.title,targetBlank:k.targetBlank}}function w(k){const se=/(__series_name)|(\$__series_name)|(__value_time)|(__field_name)|(\$__field_name)/g;return k.replace(se,(te,ne,le,re,de,oe)=>ne?"__series.name":le?"${__series.name}":re?"__value.time":de?"__field.name":oe?"${__field.name}":te)}function z(k){if(x.$W.panels["grafana-singlestat-panel"])return k.type="grafana-singlestat-panel",k;let se=!1;return k.changePlugin||(se=!0,k=new A.a9(k)),k.plugin={angularPanelCtrl:{}},k.gauge?.show?(S.plugin.meta=x.$W.panels.gauge,k.changePlugin(S.plugin)):(O.plugin.meta=x.$W.panels.stat,k.changePlugin(O.plugin)),se?k.getSaveModel():k}function N(k,se){if(se.returnDefaultAsNull&&(k==null||k==="default"))return null;if((0,r.fN)(k))return k;const te=(0,u.l)().getInstanceSettings(k);return te?(0,r.p$)(te):{uid:k||void 0}}function H(k,se,te){if(k.transformations){const ne=[];for(const le of k.transformations)ne.push(le),le.id===se&&ne.push({...te});k.transformations=ne}return k}function Q(k){const se=k.fieldConfig;if(!se)return k;if(se.defaults&&se.defaults.mappings&&(se.defaults.mappings=Z(se.defaults.mappings,se.defaults.thresholds)),Array.isArray(se.overrides))for(const te of se.overrides)for(const ne of te.properties)ne.id==="mappings"&&(ne.value=Z(ne.value));return k}function X(k){return k.hasOwnProperty("dimensions")&&k.hasOwnProperty("namespace")&&k.hasOwnProperty("region")&&k.hasOwnProperty("metricName")}function ee(k){return k.hasOwnProperty("dimensions")&&k.hasOwnProperty("namespace")&&k.hasOwnProperty("region")&&k.hasOwnProperty("prefixMatching")&&k.hasOwnProperty("statistics")}function Z(k,se){if(!k)return;const te={type:l.d.ValueToText,options:{}},ne=[];for(const le of k){if(le.type&&le.options){le.type===l.d.ValueToText?te.options={...te.options,...le.options}:ne.push(le);continue}let re;const de=parseFloat(le.text);if(se&&!isNaN(de)){const oe=(0,d.yQ)(de,se.steps);oe&&oe.color&&(re=oe.color)}switch(le.type){case 1:le.value!=null&&(le.value==="null"?ne.push({type:l.d.SpecialValue,options:{match:l.W.Null,result:{text:le.text,color:re}}}):te.options[String(le.value)]={text:le.text,color:re});break;case 2:ne.push({type:l.d.RangeToText,options:{from:+le.from,to:+le.to,result:{text:le.text,color:re}}});break}}return Object.keys(te.options).length>0&&ne.unshift(te),ne}function q(k){return(k.type==="timeseries"||k.type==="xychart"||k.type==="xychart2")&&k.options.tooltipOptions&&(k.options={...k.options,tooltip:k.options.tooltipOptions},delete k.options.tooltipOptions),k}function ae(k){return k.type==="timeseries"&&k.fieldConfig?.defaults.custom?.axisPlacement===p.vM.Hidden&&(k.fieldConfig={...k.fieldConfig,overrides:[...k.fieldConfig.overrides,{matcher:{id:c.Ct.byType,options:h.PU.time},properties:[{id:"custom.axisPlacement",value:p.vM.Auto}]}]}),k}},98365:(G,R,e)=>{"use strict";e.d(R,{G:()=>j});var t=e(2543),n=e(64423),s=e(18226),a=e(72724),r=e(47232),g=e(3591),i=e(32264),l=e(24284),d=e(15054),c=e(16233),h=e(28874),o=e(8480),m=e(20601),u=e(72401),p=e(87421),f=e(31678),y=e(28444),x=e(10096),v=e(99140),P=e(80484),E=e(75096),D=e(74856),C=e(34214);const b=new Set(["gridPos","title","description","transparent"]);function T(W,U){const F=[],V={changed:!1,actions:{add:[],remove:[],replace:[],update:[],noop:[]},panels:F};let w=0;const z=new Map;for(let N of U){let{id:H}=N;H||(w||(w=O([W,U])),H=w++,N={...N,id:H}),z.set(H,N)}for(const N of W){const H=z.get(N.id);if(!H){V.changed=!0,V.actions.remove.push(N.id),N.destroy();continue}if(z.delete(N.id),H===N){F.push(N),V.actions.noop.push(N.id);continue}if(N.type===H.type){const X=N.getSaveModel();let ee=!0,Z=!1;for(const[q,ae]of Object.entries(H))if(!(0,t.isEqualWith)(ae,X[q],S))if(V.changed=!0,ee=!1,b.has(q))N[q]=ae,Z=!0;else{Z=!1;break}if(ee){F.push(N),V.actions.noop.push(N.id);continue}if(Z){F.push(N),V.actions.update.push(N.id);continue}}N.destroy();const Q=new C.a(H);Q.key=`${Q.id}-update-${Date.now()}`,F.push(Q),V.changed=!0,V.actions.replace.push(N.id)}for(const N of z.values())F.push(new C.a(N)),V.changed=!0,V.actions.add.push(N.id);return V}function S(W,U){if(W==null&&(U===1/0||U===-1/0||U==null)||U==null&&(W===1/0||W===-1/0||W==null))return!0}function O(W){let U=0;for(const F of W)for(const V of F)V.id>U&&(U=V.id);return U+1}var M=e(79056),I=e(84423);function L(W,U){return W.repeatDirection===d.HG?!1:U.gridPos.x>=W.gridPos.x+W.gridPos.w&&U.gridPos.y===W.gridPos.y}function B(W){for(const U of W)if(delete U.scopedVars,U.panels?.length)for(const F of U.panels)delete F.scopedVars}class j{constructor(U,F,V){this.timeRangeUpdatedDuringEditOrView=!1,this.originalDashboard=null,this.getVariablesFromState=V?.getVariablesFromState??p.SS,this.events=new s.o,this.id=U.id||null,this.uid=U.uid||null,this.revision=U.revision??void 0,this.title=U.title??"No Title",this.description=U.description,this.tags=U.tags??[],this.timezone=U.timezone??"",this.weekStart=U.weekStart??"",this.editable=U.editable!==!1,this.graphTooltip=U.graphTooltip||0,this.time=U.time??{from:"now-6h",to:"now"},this.timepicker=U.timepicker??{},this.liveNow=U.liveNow,this.templating=this.removeNullValuesFromVariables(this.ensureListExist(U.templating)),this.annotations=this.ensureListExist(U.annotations),this.refresh=U.refresh,this.snapshot=U.snapshot,this.schemaVersion=U.schemaVersion??0,this.fiscalYearStartMonth=U.fiscalYearStartMonth??0,this.version=U.version??0,this.links=U.links??[],this.gnetId=U.gnetId||null,this.panels=(0,t.map)(U.panels??[],w=>new I.a9(w)),this.originalDashboard=(0,t.cloneDeep)(U),this.originalTemplating=(0,t.cloneDeep)(this.templating),this.originalTime=(0,t.cloneDeep)(this.time),this.ensurePanelsHaveUniqueIds(),this.formatDate=this.formatDate.bind(this),this.initMeta(F),this.updateSchema(U),this.addBuiltInAnnotationQuery(),this.sortPanelsByGridPos(),this.panelsAffectedByVariableChange=null,this.appEventsSubscription=new n.yU,this.lastRefresh=Date.now(),this.appEventsSubscription.add(x.lE.subscribe(P.og,this.variablesChangedHandler.bind(this))),this.appEventsSubscription.add(x.lE.subscribe(P.BS,this.variablesTimeRangeProcessDoneHandler.bind(this))),this.appEventsSubscription.add(x.lE.subscribe(P.eF,this.variablesChangedInUrlHandler.bind(this)))}static{this.nonPersistedProperties={events:!0,meta:!0,panels:!0,templating:!0,originalTime:!0,originalTemplating:!0,originalLibraryPanels:!0,panelInEdit:!0,panelInView:!0,getVariablesFromState:!0,formatDate:!0,appEventsSubscription:!0,panelsAffectedByVariableChange:!0,lastRefresh:!0,timeRangeUpdatedDuringEditOrView:!0,originalDashboard:!0}}addBuiltInAnnotationQuery(){this.annotations.list.some(F=>F.builtIn===1)||this.annotations.list.unshift({datasource:{uid:"-- Grafana --",type:"grafana"},name:"Annotations & Alerts",type:"dashboard",iconColor:l.Mk,enable:!0,hide:!0,builtIn:1})}initMeta(U){U=U||{},U.canShare=U.canShare!==!1,U.canSave=U.canSave!==!1,U.canStar=U.canStar!==!1,U.canEdit=U.canEdit!==!1,U.canDelete=U.canDelete!==!1,U.showSettings=U.canEdit,U.canMakeEditable=U.canSave&&!this.editable,U.hasUnsavedFolderChange=!1,this.editable||(U.canEdit=!1,U.canDelete=!1,U.canSave=!1),this.meta=U}getSaveModelCloneOld(U){const F=(0,t.defaults)(U||{},{saveVariables:!0,saveTimerange:!0});let V={};for(const w in this)j.nonPersistedProperties[w]||!this.hasOwnProperty(w)||(V[w]=(0,t.cloneDeep)(this[w]));return V.templating=this.getTemplatingSaveModel(F),F.saveTimerange||(V.time=this.originalTime),V.panels=this.getPanelSaveModels(),V=(0,h.v)(V),V.getVariables=()=>V.templating.list,V}getSaveModelClone(U){const F=this.getSaveModelCloneOld(U),V=JSON.stringify(F);return JSON.parse(V)}updatePanels(U){const F=T(this.panels,U??[]);return F.changed&&(this.panels=F.panels??[],this.sortPanelsByGridPos(),this.events.publish(new y.Q$)),F}getPanelSaveModels(){return this.panels.filter(U=>this.isSnapshotTruthy()||!(U.repeatPanelId||U.repeatedByRow)).map(U=>{if(U.libraryPanel){const{id:F,title:V,libraryPanel:w,gridPos:z}=U;return{id:F,title:V,gridPos:z,libraryPanel:{uid:w.uid,name:w.name}}}return this.panelInEdit&&this.panelInEdit.id===U.id?this.panelInEdit.getSaveModel():U.getSaveModel()}).map(U=>(this.isSnapshotTruthy()||(delete U.scopedVars,U.type==="row"&&U.panels&&U.panels.length>0&&(U.panels=U.panels.filter(F=>!F.repeatPanelId).map(F=>(delete F.scopedVars,F)))),U))}getTemplatingSaveModel(U){const F=this.originalTemplating?.list??[],w=this.getVariablesFromState(this.uid).map(N=>{const H=m.B.get(N.type).getSaveModel(N,U.saveVariables);if(!U.saveVariables){const Q=F.find(({name:X,type:ee})=>X===N.name&&ee===N.type);if(!Q)return H;N.type==="adhoc"?H.filters=Q.filters:(H.current=Q.current,H.options=Q.options)}return H});return{list:(0,h.v)(w)}}timeRangeUpdated(U){this.events.publish(new g.sR(U)),(0,v.JD)((0,u.RK)(this.uid,U)),(this.panelInEdit||this.panelInView)&&(this.timeRangeUpdatedDuringEditOrView=!0)}startRefresh(U={refreshAll:!0,panelIds:[]}){if(this.events.publish(new g._),this.lastRefresh=Date.now(),this.panelInEdit&&(U.refreshAll||U.panelIds.includes(this.panelInEdit.id))){this.panelInEdit.refresh();return}const F=this.panels.filter(V=>!this.otherPanelInFullscreen(V)&&(U.refreshAll||U.panelIds.includes(V.id)));if(!this.isSnapshot())for(const V of F)V.refreshWhenInView=!0;for(const V of F)V.refresh()}render(){this.events.publish(new y.XM);for(const U of this.panels)U.render()}panelInitialized(U){const F=U.getQueryRunner().getLastResult();!this.otherPanelInFullscreen(U)&&!F&&U.refresh()}otherPanelInFullscreen(U){return(this.panelInEdit||this.panelInView)&&!(U.isViewing||U.isEditing)}initEditPanel(U){return(0,D.jG)().stopAutoRefresh(),this.panelInEdit=U.getEditClone(),this.timeRangeUpdatedDuringEditOrView=!1,this.panelInEdit}exitPanelEditor(){this.panelInEdit.destroy(),this.panelInEdit=void 0,(0,D.jG)().resumeAutoRefresh(),this.refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged()}initViewPanel(U){this.panelInView=U,this.timeRangeUpdatedDuringEditOrView=!1,U.setIsViewing(!0)}exitViewPanel(U){this.panelInView=void 0,U.setIsViewing(!1),this.refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged()}refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged(){(this.panelsAffectedByVariableChange||this.timeRangeUpdatedDuringEditOrView)&&(this.startRefresh({panelIds:this.panelsAffectedByVariableChange??[],refreshAll:this.timeRangeUpdatedDuringEditOrView}),this.panelsAffectedByVariableChange=null,this.timeRangeUpdatedDuringEditOrView=!1)}ensurePanelsHaveUniqueIds(){const U=new Set;let F=this.getNextPanelId();for(const V of this.panelIterator())(!V.id||U.has(V.id))&&(V.id=F++),U.add(V.id)}removeNullValuesFromVariables(U){if(!U.list.length)return U;for(const F of U.list)F.current&&(F.current.value===null||Array.isArray(F.current.value)&&F.current.value.includes(null))&&(F.current=void 0);return U}ensureListExist(U={}){return U.list??=[],U}getNextPanelId(){let U=0;for(const F of this.panelIterator())F.id>U&&(U=F.id);return U+1}*panelIterator(){for(const U of this.panels){yield U;const F=U.panels??[];for(const V of F)yield V}}forEachPanel(U){for(let F=0;F<this.panels.length;F++)U(this.panels[F],F)}getPanelById(U,F=!1){if(this.panelInEdit&&this.panelInEdit.id===U)return this.panelInEdit;if(F){for(const V of this.panelIterator())if(V.id===U)return V;return null}else return this.panels.find(V=>V.id===U)??null}canEditPanel(U){return!!(this.meta.canEdit&&U&&!U.repeatPanelId&&U.type!=="row")}canEditPanelById(U){return this.canEditPanel(this.getPanelById(U))}addPanel(U){U.id=this.getNextPanelId(),this.panels.unshift(new I.a9(U)),this.sortPanelsByGridPos(),this.events.publish(new y.Q$)}updateMeta(U){this.meta={...this.meta,...U},this.events.publish(new y.Cf)}makeEditable(){this.editable=!0,this.updateMeta({canMakeEditable:!1,canEdit:!0,canSave:!0})}sortPanelsByGridPos(){this.panels.sort((U,F)=>U.gridPos.y===F.gridPos.y?U.gridPos.x-F.gridPos.x:U.gridPos.y-F.gridPos.y)}clearUnsavedChanges(U,F){for(const V of this.panels)V.configRev=0;this.panelInEdit&&(this.panelInEdit.hasSavedPanelEditChange=this.panelInEdit.configRev>0,this.panelInEdit.configRev=0),this.originalDashboard=U,this.originalTemplating=U.templating,F.saveTimerange&&(this.originalTime=U.time)}hasUnsavedChanges(){return!!this.panels.find(F=>F.hasChanged)}cleanUpRepeats(){if(this.isSnapshotTruthy()||!this.hasVariables())return;B(this.panels);const U=this.panels.filter(F=>(!F.repeat||F.repeatedByRow)&&F.repeatPanelId);(0,t.pull)(this.panels,...U),U.map(F=>F.destroy()),this.sortPanelsByGridPos()}processRepeats(){if(!(this.isSnapshotTruthy()||!this.hasVariables()||this.panelInView)){this.cleanUpRepeats();for(let U=0;U<this.panels.length;U++){const F=this.panels[U];F.repeat&&this.repeatPanel(F,U)}this.sortPanelsByGridPos(),this.events.publish(new y.Q$)}}cleanUpRowRepeats(U){const F=U.map(w=>w.id),V=U.filter(w=>!w.repeat&&w.repeatPanelId&&F.includes(w.repeatPanelId));(0,t.pull)(U,...V),(0,t.pull)(this.panels,...V)}processRowRepeats(U){if(this.isSnapshotTruthy()||!this.hasVariables())return;let F=U.panels??[];if(!U.collapsed){const V=this.panels.findIndex(w=>w.id===U.id);F=this.getRowPanels(V)}this.cleanUpRowRepeats(F);for(const V of F)if(V.repeat){const w=this.panels.findIndex(z=>z.id===V.id);this.repeatPanel(V,w)}}getPanelRepeatClone(U,F,V){if(F===0)return U;const w=U.getSaveModel();w.id=this.getNextPanelId();const z=new I.a9(w);return this.panels.splice(V+F,0,z),z.repeatPanelId=U.id,z.repeat=void 0,this.panelInView?.id===z.id&&(z.setIsViewing(!0),this.panelInView=z),z}getRowRepeatClone(U,F,V){if(F===0){if(!U.collapsed){const H=this.getRowPanels(V);U.panels=H}return U}const w=new I.a9(U.getSaveModel());let z,N;return U.collapsed?(z=(0,t.cloneDeep)(U.panels)??[],w.panels=z,N=V+F):(z=this.getRowPanels(V),w.panels=z.map(H=>H.getSaveModel()),N=V+(z.length+1)*F),this.panels.splice(N,0,w),this.updateRepeatedPanelIds(w),w}repeatPanel(U,F){const V=this.getPanelRepeatVariable(U);if(!V)return;if(U.type==="row"){this.repeatRow(U,F,V);return}const w=this.getSelectedVariableOptions(V),z=U.maxPerRow||4;let N=0,H=U.gridPos.y;for(let X=0;X<w.length;X++){const ee=w[X];let Z;Z=this.getPanelRepeatClone(U,X,F),Z.scopedVars??={},Z.scopedVars[V.name]=ee,U.repeatDirection===d.Pz?(X>0&&(H+=Z.gridPos.h),Z.gridPos.y=H):(Z.gridPos.w=Math.max(d.cV/w.length,d.cV/z),Z.gridPos.x=N,Z.gridPos.y=H,N+=Z.gridPos.w,N+Z.gridPos.w>d.cV&&(N=0,H+=Z.gridPos.h))}const Q=H-U.gridPos.y;if(Q>0){const X=F+w.length;for(const ee of this.panels.slice(X))L(U,ee)||(ee.gridPos.y+=Q)}}repeatRow(U,F,V){const w=this.getSelectedVariableOptions(V);for(let z=0;z<w.length;z++){const N=w[z],H=this.getRowRepeatClone(U,z,F);K(H,V,N);const Q=this.getRowHeight(H),X=H.panels||[];let ee;if(U.collapsed){for(const Z of X)K(Z,V,N),z>0&&this.updateRepeatedPanelIds(Z,!0);H.gridPos.y+=z,ee=F+z+1}else{const Z=F+(X.length+1)*z+1;X.forEach((q,ae)=>{if(K(q,V,N),z>0){const k=new I.a9(q);this.updateRepeatedPanelIds(k,!0),k.gridPos.y+=Q*z,this.panels.splice(Z+ae,0,k)}}),H.panels=[],H.gridPos.y+=Q*z,ee=Z+X.length}if(w.length>1)for(const Z of this.panels.slice(ee))Z.gridPos.y+=Q}}updateRepeatedPanelIds(U,F){return U.repeatPanelId=U.id,U.id=this.getNextPanelId(),F?U.repeatedByRow=!0:U.repeat=void 0,U}getSelectedVariableOptions(U){let F;return(0,E.ML)(U)?F=U.options.slice(1,U.options.length):F=(0,t.filter)(U.options,{selected:!0}),F}getRowHeight(U){if(!U.panels||U.panels.length===0)return 0;if(U.collapsed)return 1;const F=(0,t.maxBy)(U.panels,({gridPos:V})=>V.y+V.h).gridPos;return F.y+F.h-U.gridPos.y}removePanel(U){this.panels=this.panels.filter(F=>F!==U),U.destroy(),this.events.publish(new y.Q$)}removeRow(U,F){(!F&&U.collapsed||F&&!U.collapsed)&&this.toggleRow(U),this.removePanel(U)}expandRows(){const U=this.panels.filter(F=>F.type==="row"&&F.collapsed);for(const F of U)this.toggleRow(F)}collapseRows(){const U=this.panels.filter(F=>F.type==="row"&&!F.collapsed);for(const F of U)this.toggleRow(F)}isSubMenuVisible(){return this.links.length>0||this.getVariables().some(U=>U.hide!==2)||this.annotations.list.some(U=>!U.hide)}getPanelInfoById(U){const F=this.panels.findIndex(V=>V.id===U);return F>=0?{panel:this.panels[F],index:F}:null}duplicatePanel(U){const F=U.getSaveModel();return F.id=this.getNextPanelId(),delete F.repeat,delete F.repeatIteration,delete F.repeatPanelId,delete F.scopedVars,F.alert&&delete F.thresholds,delete F.alert,U.gridPos.x+U.gridPos.w*2<=d.cV?F.gridPos.x+=U.gridPos.w:F.gridPos.y+=U.gridPos.h,this.addPanel(F),F}formatDate(U,F){return(0,a.LE)(U,{format:F,timeZone:this.getTimezone()})}destroy(){this.appEventsSubscription.unsubscribe(),this.events.removeAllListeners();for(const U of this.panels)U.destroy()}toggleRow(U){const F=(0,t.indexOf)(this.panels,U);if(!U.collapsed){const N=this.getRowPanels(F);(0,t.pull)(this.panels,...N),U.panels=N.map(H=>H.getSaveModel()),U.collapsed=!0,N.some(H=>H.hasChanged)&&U.configRev++,this.events.publish(new y.Q$);return}U.collapsed=!1;const V=U.panels??[],w=V.some(N=>N.repeat),z=U.repeat;if(V.length>0){const H=(V[0].gridPos.y??U.gridPos.y)-(U.gridPos.y+U.gridPos.h);let Q=F+1,X=U.gridPos.y;for(const Z of V){if(z){const q=this.getPanelRepeatVariable(U);if(Z.scopedVars??={},q){const ae=this.getSelectedVariableOptions(q);Z.scopedVars={...Z.scopedVars,[q.name]:ae[0]}}}Z.gridPos.y??(Z.gridPos.y=U.gridPos.y),Z.gridPos.y-=H,this.panels.splice(Q,0,new I.a9(Z)),Q+=1,X=Math.max(X,Z.gridPos.y+Z.gridPos.h)}const ee=X-U.gridPos.y-1;for(const Z of this.panels.slice(Q))Z.gridPos.y+=ee;U.panels=[],w&&this.processRowRepeats(U)}this.sortPanelsByGridPos(),this.events.publish(new y.Q$)}getRowPanels(U){const F=this.panels.slice(U+1),V=F.findIndex(z=>z.type==="row");return F.slice(0,V>=0?V:this.panels.length)}on(U,F){console.log("DashboardModel.on is deprecated use events.subscribe"),this.events.on(U,F)}off(U,F){console.log("DashboardModel.off is deprecated"),this.events.off(U,F)}cycleGraphTooltip(){this.graphTooltip=(this.graphTooltip+1)%3}sharedTooltipModeEnabled(){return this.graphTooltip>0}sharedCrosshairModeOnly(){return this.graphTooltip===1}getRelativeTime(U){return(0,a.fq)(U,{timeZone:this.getTimezone()})}isSnapshot(){return this.snapshot!==void 0}getTimezone(){return this.timezone?this.timezone:c.TP?.user?.timezone}updateSchema(U){new M.SW(this).updateSchema(U)}hasTimeChanged(){const{time:U,originalTime:F}=this;return!((0,t.isEqual)(U,F)||(0,t.isEqual)((0,r.KQ)(U?.from),(0,r.KQ)(F?.from))&&(0,t.isEqual)((0,r.KQ)(U?.to),(0,r.KQ)(F?.to)))}autoFitPanels(U,F){const V=Math.max(...this.panels.map(X=>X.gridPos.h+X.gridPos.y)),w=55;let N=U-w-20;F&&F!==f.KioskMode.TV&&(N+=w);const H=Math.floor(N/(d.sD+d.dU)),Q=V/H;for(const X of this.panels)X.gridPos.y=Math.round(X.gridPos.y/Q)||1,X.gridPos.h=Math.round(X.gridPos.h/Q)||1}templateVariableValueUpdated(){this.processRepeats(),this.events.emit(f.CoreEvents.bG)}getPanelByUrlId(U){const F=parseInt(U??"0",10),V=this.panels.filter(w=>w.collapsed);for(const w of V)w.panels?.some(N=>N.id===F)&&this.toggleRow(w);return this.getPanelById(F)}toggleLegendsForAll(){const U=this.panels.filter(A),F=U.filter(z=>z.legend.show).length,V=U.length-F,w=F>=V;for(const z of U)z.legend.show=!w,z.render()}toggleExemplarsForAll(){for(const U of this.panels)for(const F of U.targets){if(!(F.datasource&&F.datasource.type==="prometheus"))continue;const V=F;V.exemplar=!V.exemplar}this.startRefresh()}getVariables(){return this.getVariablesFromState(this.uid)}canEditAnnotations(U){let F=!0;return U?F=!!this.meta.annotationsPermissions?.dashboard.canEdit:F=!!this.meta.annotationsPermissions?.organization.canEdit,(i.$.featureToggles.annotationPermissionUpdate||this.canEditDashboard())&&F}canDeleteAnnotations(U){let F=!0;return U?F=!!this.meta.annotationsPermissions?.dashboard.canDelete:F=!!this.meta.annotationsPermissions?.organization.canDelete,i.$.featureToggles.annotationPermissionUpdate?F:F&&this.canEditDashboard()}canAddAnnotations(){return this.annotations.list.find(F=>F.builtIn===1)?.enable===!1?!1:i.$.featureToggles.annotationPermissionUpdate?!!this.meta.annotationsPermissions?.dashboard.canAdd:!!this.meta.annotationsPermissions?.dashboard.canAdd&&this.canEditDashboard()}canEditDashboard(){return!!(this.meta.canEdit||this.meta.canMakeEditable)}shouldUpdateDashboardPanelFromJSON(U,F){!(0,t.isEqual)(U?.gridPos,F?.gridPos)&&this.events.publish(new y.Q$)}getDefaultTime(){return this.originalTime}getPanelRepeatVariable(U){return this.getVariablesFromState(this.uid).find(F=>F.name===U.repeat)}isSnapshotTruthy(){return this.snapshot}hasVariables(){return this.getVariablesFromState(this.uid).length>0}hasVariablesChanged(){const U=this.originalTemplating?.list??[],F=this.getTemplatingSaveModel({saveVariables:!0}).list;return U.length!==F.length?!1:!(0,t.isEqual)(F,U)}variablesTimeRangeProcessDoneHandler(U){const F=U.payload.variableIds.length>0;this.variablesChangedHandler(new P.og({panelIds:[],refreshAll:!0}),F)}variablesChangedHandler(U,F=!0){if(F&&this.processRepeats(),U.payload.refreshAll||(0,D.jG)().isRefreshOutsideThreshold(this.lastRefresh)){this.startRefresh({refreshAll:!0,panelIds:[]});return}(this.panelInEdit||this.panelInView)&&(this.panelsAffectedByVariableChange=U.payload.panelIds.filter(V=>V!==(this.panelInEdit?.id??this.panelInView?.id))),this.startRefresh(U.payload)}variablesChangedInUrlHandler(U){this.templateVariableValueUpdated(),this.startRefresh(U.payload)}getOriginalDashboard(){return this.originalDashboard}hasAngularPlugins(){return this.panels.some(U=>{const F=(i.$.panels[U.type]?.angular?.detected||I.vI.includes(U.type))&&!i.$.panels[U.type]?.angular?.hideDeprecation;let V=!1;return U.datasource?.uid&&(V=(0,o.Hv)(U.datasource?.uid)),F||V})}}function A(W){return!!W.legend}function K(W,U,F){W.scopedVars??={},W.scopedVars[U.name]=F}},84423:(G,R,e)=>{"use strict";e.d(R,{NB:()=>v,a9:()=>E,tD:()=>P,tw:()=>C,vI:()=>x});var t=e(2543),n=e.n(t),s=e(62938),a=e(18226),r=e(77789),g=e(41987),i=e(581),l=e(3591),d=e(72574),c=e(2913),h=e(87490),o=e(28444),m=e(80924),u=e(96382);const p={events:!0,isViewing:!0,isEditing:!0,isInView:!0,hasRefreshed:!0,cachedPluginOptions:!0,plugin:!0,queryRunner:!0,replaceVariables:!0,configRev:!0,hasSavedPanelEditChange:!0,getDisplayTitle:!0,dataSupport:!0,key:!0,isNew:!0,refreshWhenInView:!0},f={id:!0,gridPos:!0,type:!0,title:!0,scopedVars:!0,repeat:!0,repeatPanelId:!0,repeatDirection:!0,repeatedByRow:!0,minSpan:!0,collapsed:!0,panels:!0,targets:!0,datasource:!0,timeFrom:!0,timeShift:!0,hideTimeOverride:!0,description:!0,links:!0,fullscreen:!0,isEditing:!0,isViewing:!0,hasRefreshed:!0,events:!0,cacheTimeout:!0,queryCachingTTL:!0,cachedPluginOptions:!0,transparent:!0,pluginVersion:!0,queryRunner:!0,transformations:!0,fieldConfig:!0,maxDataPoints:!0,interval:!0,replaceVariables:!0,libraryPanel:!0,getDisplayTitle:!0,configRev:!0,key:!0},y={gridPos:{x:0,y:0,h:3,w:6},targets:[{refId:"A"}],cachedPluginOptions:{},transparent:!1,options:{},links:[],transformations:[],fieldConfig:{defaults:{},overrides:[]},title:""},x=["graph","table-old","grafana-piechart-panel","grafana-worldmap-panel","singlestat","grafana-singlestat-panel"],v={graph:"timeseries","table-old":"table",singlestat:"stat","grafana-singlestat-panel":"stat","grafana-piechart-panel":"piechart","grafana-worldmap-panel":"geomap"},P={"heatmap-new":"heatmap"};class E{constructor(T){this.datasource=null,this.isViewing=!1,this.isEditing=!1,this.isInView=!1,this.configRev=0,this.refreshWhenInView=!0,this.cachedPluginOptions={},this.events=new a.o,this.restoreModel(T),this.replaceVariables=this.replaceVariables.bind(this),this.key=(0,s.A)()}restoreModel(T){for(const O in this)p[O]||!this.hasOwnProperty(O)||T[O]||typeof this[O]!="function"&&typeof this[O]!="symbol"&&delete this[O];for(const O in T)this[O]=T[O];const S=(0,u.p)(this);S&&(this.autoMigrateFrom=this.type,this.type=S),(0,t.defaultsDeep)(this,(0,t.cloneDeep)(y)),this.ensureQueryIds()}generateNewKey(){this.key=(0,s.A)()}ensureQueryIds(){if(this.targets&&(0,t.isArray)(this.targets))for(const T of this.targets)T.refId||(T.refId=(0,r.M)(this.targets))}getOptions(){return this.options}get hasChanged(){return this.configRev>0}updateOptions(T){this.options=T,this.configRev++,this.events.publish(new o.PR),this.render()}updateFieldConfig(T){this.fieldConfig=T,this.configRev++,this.events.publish(new o.PR),this.resendLastResult(),this.render()}getSaveModel(){const T={};for(const S in this)p[S]||!this.hasOwnProperty(S)||(0,t.isEqual)(this[S],y[S])||(T[S]=(0,t.cloneDeep)(this[S]));return this.type==="row"&&this.panels&&this.panels.length>0&&(T.panels=this.panels.map(S=>{if(S.libraryPanel){const{id:O,title:M,libraryPanel:I,gridPos:L}=S;return{id:O,title:M,gridPos:L,libraryPanel:{uid:I.uid,name:I.name}}}return S})),T}setIsViewing(T){this.isViewing=T}updateGridPos(T,S=!0){T.x===this.gridPos.x&&T.y===this.gridPos.y&&T.h===this.gridPos.h&&T.w===this.gridPos.w||(this.gridPos.x=T.x,this.gridPos.y=T.y,this.gridPos.w=T.w,this.gridPos.h=T.h,S&&this.configRev++,this.render())}runAllPanelQueries({dashboardUID:T,dashboardTimezone:S,timeData:O,width:M}){this.getQueryRunner().run({datasource:this.datasource,queries:this.targets,panelId:this.id,panelPluginId:this.type,dashboardUID:T,timezone:S,timeRange:O.timeRange,timeInfo:O.timeInfo,maxDataPoints:this.maxDataPoints||Math.floor(M),minInterval:this.interval,scopedVars:this.scopedVars,cacheTimeout:this.cacheTimeout,queryCachingTTL:this.queryCachingTTL,transformations:this.transformations,app:this.isEditing?g.Jk.PanelEditor:this.isViewing?g.Jk.PanelViewer:g.Jk.Dashboard})}refresh(){this.hasRefreshed=!0,this.events.publish(new l._)}render(){this.hasRefreshed?this.events.publish(new o.XM):this.refresh()}getOptionsToRemember(){return Object.keys(this).reduce((T,S)=>p[S]||f[S]?T:{...T,[S]:this[S]},{})}restorePanelOptions(T){const S=this.cachedPluginOptions[T];S&&(Object.keys(S.properties).map(O=>{this[O]=S.properties[O]}),this.fieldConfig=(0,i.H9)(this.fieldConfig,S.fieldConfig))}applyPluginOptionDefaults(T,S){const O=(0,i.F)({plugin:T,currentOptions:this.options,currentFieldConfig:this.fieldConfig,isAfterPluginChange:S});this.fieldConfig=O.fieldConfig,this.options=O.options}async pluginLoaded(T){this.plugin=T;const S=D(T);if(this.autoMigrateFrom){const O=v[this.autoMigrateFrom]!=null,M=this.getOptionsToRemember(),I=this.autoMigrateFrom,L=this.type;this.clearPropertiesBeforePluginChange(),this.type=L,this.plugin=T,this.callPanelTypeChangeHandler(T,I,M,O)}if(T.onPanelMigration&&S!==this.pluginVersion){const O=T.onPanelMigration(this);this.options=await O,this.pluginVersion=S}this.applyPluginOptionDefaults(T,!1),this.resendLastResult()}clearPropertiesBeforePluginChange(){for(const T in this)f[T]||delete this[T];this.options={},this.fieldConfig={defaults:{...this.fieldConfig.defaults,custom:{}},overrides:(0,i.aW)(this.fieldConfig.overrides,i.nx)}}callPanelTypeChangeHandler(T,S,O,M){if(T.onPanelTypeChanged){const I=M?{angular:O}:O.options;Object.assign(this.options,T.onPanelTypeChanged(this,S,I,this.fieldConfig))}}changePlugin(T){const S=T.meta.id,O=this.getOptionsToRemember(),M=this.fieldConfig,I=this.type,L=this.isAngularPlugin()||!!v[I];this.cachedPluginOptions[I]={properties:O,fieldConfig:M},this.clearPropertiesBeforePluginChange(),this.restorePanelOptions(S),this.callPanelTypeChangeHandler(T,I,O,L),this.type=S,this.plugin=T,this.configRev++,this.applyPluginOptionDefaults(T,!0),T.onPanelMigration&&(this.pluginVersion=D(T))}updateQueries(T){const{dataSource:S}=T;this.datasource=S,this.cacheTimeout=T.cacheTimeout,this.queryCachingTTL=T.queryCachingTTL,this.timeFrom=T.timeRange?.from,this.timeShift=T.timeRange?.shift,this.hideTimeOverride=T.timeRange?.hide,this.interval=T.minInterval,this.maxDataPoints=T.maxDataPoints,this.targets=T.queries,this.configRev++,this.events.publish(new o.zq)}addQuery(T){T=T||{refId:"A"},T.refId=(0,r.M)(this.targets),this.targets.push(T),this.configRev++}changeQuery(T,S){T.refId=this.targets[S].refId,this.configRev++,this.targets=this.targets.map((O,M)=>M===S?T:O)}getEditClone(){const T=this.getSaveModel(),S=new E(T);S.isEditing=!0,S.plugin=this.plugin;const O=this.getQueryRunner();return S.getQueryRunner().useLastResultFrom(O),S}getTransformations(){return this.transformations}getFieldOverrideOptions(){if(this.plugin)return{fieldConfig:this.fieldConfig,replaceVariables:this.replaceVariables,fieldConfigRegistry:this.plugin.fieldConfigRegistry,theme:c.Ay.theme2}}getDataSupport(){return this.plugin?.dataSupport??{annotations:!1,alertStates:!1}}getQueryRunner(){return this.queryRunner||(this.queryRunner=new m.Z(this)),this.queryRunner}hasTitle(){return this.title&&this.title.length>0}isAngularPlugin(){return(this.plugin&&this.plugin.angularPanelCtrl)!==void 0||(this.plugin?.meta?.angular?.detected??!1)}destroy(){this.events.removeAllListeners(),this.queryRunner&&this.queryRunner.destroy()}setTransformations(T){this.transformations=T,this.resendLastResult(),this.configRev++,this.events.publish(new o.JI)}setProperty(T,S){this[T]=S,this.configRev++,T==="repeat"&&(this.repeat&&!this.repeatDirection?this.repeatDirection="h":this.repeat||(delete this.repeatDirection,delete this.maxPerRow))}replaceVariables(T,S,O){const M=this.getQueryRunner().getLastRequest(),I=Object.assign({},this.scopedVars,M?.scopedVars,S);return(0,d.w)().replace(T,I,O)}resendLastResult(){this.plugin&&this.getQueryRunner().resendLastResult()}getDisplayTitle(){return this.replaceVariables(this.title,void 0,"text")}initLibraryPanel(T){for(const[S,O]of Object.entries(T.model)){switch(S){case"id":case"gridPos":case"libraryPanel":continue}this[S]=O}this.libraryPanel=T}unlinkLibraryPanel(){delete this.libraryPanel,this.configRev++,this.render()}}function D(b){return b&&b.meta.info.version?b.meta.info.version:c.Ay.buildInfo.version}function C(b){const T={};return Object.entries(b).filter(([S,O])=>!p[S]&&b.hasOwnProperty(S)&&!(0,t.isEqual)(O,y[S])).forEach(([S,O])=>{T[S]=O}),(0,h.MA)(T)}},41176:(G,R,e)=>{"use strict";e.d(R,{B:()=>s});var t=e(61298),n=e(14110);function s(a){const r={dashboardId:a.id,dashboardName:a.title,dashboardUid:a.uid,folderName:a.meta.folderTitle,eventName:t.n_.DashboardView};(0,n.G$)(r)}},96382:(G,R,e)=>{"use strict";e.d(R,{p:()=>s});var t=e(2913),n=e(84423);function s(a,r){if(n.tD[a.type])return n.tD[a.type];const g=l=>{const d="__feature."+l,h=new URLSearchParams(window.location.search).get(d);return h==="true"||h===""},i=r||!t.Ay.angularSupportEnabled||t.Ay.featureToggles.autoMigrateOldPanels||g("autoMigrateOldPanels")||g("disableAngular");if(a.type==="graph"&&(i||t.Ay.featureToggles.autoMigrateGraphPanel||g("autoMigrateGraphPanel")))return a.xaxis?.mode==="series"?a.legend?.values?"bargauge":"barchart":a.xaxis?.mode==="histogram"?"histogram":"timeseries";if(i)return n.NB[a.type];if(a.type==="table-old"&&(t.Ay.featureToggles.autoMigrateTablePanel||g("autoMigrateTablePanel")))return"table";if(a.type==="grafana-piechart-panel"&&(t.Ay.featureToggles.autoMigratePiechartPanel||g("autoMigratePiechartPanel")))return"piechart";if(a.type==="grafana-worldmap-panel"&&(t.Ay.featureToggles.autoMigrateWorldmapPanel||g("autoMigrateWorldmapPanel")))return"geomap";if((a.type==="singlestat"||a.type==="grafana-singlestat-panel")&&t.Ay.featureToggles.autoMigrateStatPanel||g("autoMigrateStatPanel"))return"stat"}},34214:(G,R,e)=>{"use strict";e.d(R,{G:()=>t.G,a:()=>n.a9});var t=e(98365),n=e(84423)},20470:(G,R,e)=>{"use strict";e.d(R,{us:()=>U,vR:()=>W,yZ:()=>V,OI:()=>F});var t=e(71733),n=e(47232),s=e(69129),a=e(39601),r=e(17172),g=e(32264),i=e(82467),l=e(28138),d=e(3169),c=e(27677),h=e(33390),o=e(78160),m=e(17493),u=e(14792),p=e(74856),f=e(72255),y=e(71176),x=e(71101),v=e(54650);function P(w){return async z=>{const N=await c.IB.getFolderByUid(w);return z((0,v.jl)(N)),z((0,i.Vz)((0,x.R4)(N))),N}}var E=e(6473),D=e(2609),C=e(75096),b=e(31678),T=e(42972),S=e(72401),O=e(87421),M=e(16833),I=e(98365),L=e(41176),B=e(28601);const j="initDashboard";async function A(w,z,N){const H=h.A.getObject(U);if(H)return V(),H;try{switch(w.routeName){case b.DashboardRoutes.Home:{const X=(0,f.sP)().getDashboardFromCache(f.m6);if(X)return X;const ee=await c.IB.get("/api/dashboards/home");if(ee.redirectUri){const Z=t.I.stripBaseFromUrl(ee.redirectUri);return a.Ny.replace(Z),null}return ee.meta.canSave=!1,ee.meta.canShare=!1,ee.meta.canStar=!1,ee}case b.DashboardRoutes.Public:return await m.np.loadDashboard("public",w.urlSlug,w.accessToken);case b.DashboardRoutes.Normal:{const Q=await m.np.loadDashboard(w.urlType,w.urlSlug,w.urlUid);if(Q.meta.folderUid)try{await z(P(Q.meta.folderUid))}catch(X){console.warn("Error fetching parent folder",Q.meta.folderUid,"for dashboard",X)}if(w.fixUrl&&Q.meta.url&&!D._o.state.isPlaying){const X=t.I.stripBaseFromUrl(Q.meta.url),ee=a.Ny.getLocation().pathname;X!==ee&&(a.Ny.replace({...a.Ny.getLocation(),pathname:X}),console.log("not correct url correcting",X,ee))}return Q}case b.DashboardRoutes.New:return w.urlFolderUid&&await z(P(w.urlFolderUid)),await(0,y.X)(w.urlFolderUid);case b.DashboardRoutes.Path:{const Q=w.urlSlug??"";return await m.np.loadDashboard(b.DashboardRoutes.Path,Q,Q)}default:throw{message:"Unknown route "+w.routeName}}}catch(Q){return(0,r.NF)(Q)&&Q.cancelled||(z((0,B.ig)({message:"Failed to fetch dashboard",error:Q})),console.error(Q)),null}}const K=(w,z={})=>(w.forEach(N=>{N.panels?K(N.panels,z):N.targets&&N.targets.forEach(H=>{H.datasource?.type&&(z[H.datasource.type]?z[H.datasource.type].push(H):z[H.datasource.type]=[H])})}),z);function W(w){return async(z,N)=>{(0,o.j)(j),z((0,B.xS)());const H=await A(w,z,N),Q=H?.dashboard?.version;if(!H)return;z((0,B.X1)());let X;try{X=new I.G(H.dashboard,H.meta)}catch(ne){z((0,B.ig)({message:"Failed create dashboard model",error:ne})),console.error(ne);return}const ee=N(),Z=a.Ny.getSearchObject();Z.orgId||a.Ny.partial({orgId:ee.user.orgId},!0);const q=(0,p.jG)();(0,u.UA)().setCurrent(X),q.init(X);const k=(0,C.q4)(w.urlUid??X.uid);if(await z((0,S._q)(k,X)),(0,T.nm)({dashboard:X,timeSrv:q}).run({dashboard:X,range:q.timeRange()}),(0,O.Tk)(N())!==k||N().dashboard.initPhase!==b.DashboardInitPhase.Services)return;try{X.processRepeats(),Z.autofitpanels&&X.autoFitPanels(window.innerHeight,Z.kiosk),g.$.publicDashboardAccessToken||w.keybindingSrv.setupDashboardBindings(X)}catch(ne){ne instanceof Error&&z((0,i.dx)((0,d.gi)("Dashboard init failed",ne))),console.error(ne)}w.routeName!==b.DashboardRoutes.New?((0,L.B)(X),E.t.watch(X.uid)):E.t.leave(),X.weekStart!==""?(0,n.$D)(X.weekStart):(0,n.$D)(g.$.bootData.user.weekStart),l.A.publish(new s.gc({dashboardId:X.uid,orgId:ee.user.orgId,userId:ee.user.user?.id,grafanaVersion:g.$.buildInfo.version,queries:K(X.panels)}));const te=(0,o.z)(j);(0,M.d)(X,te?.duration,Q),z((0,B.O9)(X))}}const U="DASHBOARD_FROM_LS_KEY";function F(w){h.A.setObject(U,w)}function V(){h.A.delete(U)}},28601:(G,R,e)=>{"use strict";e.d(R,{Ay:()=>p,O9:()=>d,Ub:()=>m,X1:()=>c,ig:()=>l,p0:()=>h,xS:()=>i});var t=e(65307),n=e(79422),s=e(31678),a=e(98365);const r={initPhase:s.DashboardInitPhase.NotStarted,getModel:()=>null,initError:null,initialDatasource:void 0},g=(0,t.Z0)({name:"dashboard",initialState:r,reducers:{dashboardInitFetching:f=>{f.initPhase=s.DashboardInitPhase.Fetching},dashboardInitServices:f=>{f.initPhase=s.DashboardInitPhase.Services},dashboardInitCompleted:(f,y)=>{f.getModel=()=>y.payload,f.initPhase=s.DashboardInitPhase.Completed},dashboardInitFailed:(f,y)=>{f.initPhase=s.DashboardInitPhase.Failed,f.initError=y.payload,f.getModel=()=>new a.G({...n.Ye,title:"Dashboard init failed"},{canSave:!1,canEdit:!1})},cleanUpDashboard:f=>{f.initPhase=s.DashboardInitPhase.NotStarted,f.initError=null,f.getModel=()=>null},addPanel:(f,y)=>{},setInitialDatasource:(f,y)=>{f.initialDatasource=y.payload}}}),{dashboardInitFetching:i,dashboardInitFailed:l,dashboardInitCompleted:d,dashboardInitServices:c,cleanUpDashboard:h,addPanel:o,setInitialDatasource:m}=g.actions,p={dashboard:g.reducer}},36974:(G,R,e)=>{"use strict";e.d(R,{B1:()=>v,CW:()=>y,LH:()=>l,OK:()=>d,SD:()=>h,VF:()=>o,_u:()=>p,dH:()=>P,ko:()=>x,no:()=>u,ob:()=>c,s3:()=>m});var t=e(2543),n=e.n(t),s=e(39601),a=e(2913),r=e(15054),g=e(33390),i=e(19752);const l="Panel Title";function d(D,C){const b={type:"timeseries",title:l,gridPos:(0,i.Ft)(D),datasource:C?{uid:C}:null,isNew:!0};return D.addPanel(b),b.id}function c(D,C){const b={type:C,title:"Widget title",gridPos:(0,i.Ft)(D),datasource:null,isNew:!0};return D.addPanel(b),b.id}function h(D){const C={type:"row",title:"Row title",gridPos:{x:0,y:0}};D.addPanel(C)}function o(){s.Ny.push("/dashboard/import")}function m(D){const C={type:"add-library-panel",gridPos:(0,i.Ft)(D)};D.addPanel(C)}function u(D,C){if(!C)return;const b=(0,i.Ft)(D),T={type:C.id,title:l,gridPos:{x:b.x,y:b.y,w:C.defaults.gridPos.w,h:C.defaults.gridPos.h}};C.defaults&&((0,t.defaults)(T,C.defaults),T.title=C.defaults.title,g.A.delete(r.tH)),D.addPanel(T)}function p(){const D=(0,t.chain)(a.Ay.panels).filter({hideFromList:!1}).map(b=>b).value(),C=g.A.get(r.tH);if(C){const b=JSON.parse(C),T=(0,t.find)(D,{id:b.type});if(T){const S=(0,t.cloneDeep)(T);return S.name=b.title,S.sort=-1,{...S,defaults:{...b}}}}}const f="grafana.dashboards.panelEdit.lastUsedDatasource";function y(D){if(g.A.exists(f)){const C=g.A.getObject(f);if(C?.dashboardUid===D)return C}}function x(D){if(!g.A.exists(f))return;const b=g.A.getObject(f)?.datasourceUid??"";E(D,b)}function v(D){g.A.setObject(f,{dashboardUid:D,datasourceUid:""})}function P(D,C){const b=y(D);if(!b)E(D,C);else{const T=b?.dashboardUid??"";E(T,C)}}function E(D,C){g.A.setObject(f,{dashboardUid:D,datasourceUid:C})}},19752:(G,R,e)=>{"use strict";e.d(R,{ET:()=>S,FC:()=>v,Ft:()=>L,KJ:()=>E,Mc:()=>D,ZY:()=>b,d7:()=>C,iU:()=>P,nk:()=>O});var t=e(2543),n=e.n(t),s=e(26272),a=e(65879),r=e(47232),g=e(85858),i=e(72574),l=e(28138),d=e(2913),c=e(15054),h=e(33390),o=e(1702),m=e(84423),u=e(54174),p=e(96227),f=e(79971),y=e(99140),x=e(28444);const v=(B,j,A)=>{if(A!==!1){const K=j.alert?"YES":void 0;l.A.publish(new x.bY({title:"Remove panel",text:"Are you sure you want to remove this panel?",icon:"trash-alt",confirmText:K,yesText:"Remove",onConfirm:()=>v(B,j,!1)}));return}B.removePanel(j),(0,y.JD)((0,f.O6)(j.key))},P=(B,j)=>{B.duplicatePanel(j)},E=B=>{let j=B;B instanceof m.a9&&(j=B.getSaveModel()),h.A.set(c.tH,JSON.stringify(j)),l.A.emit(s.r1.alertSuccess,["Panel copied. Click **Add panel** icon to paste."])},D=(B,j)=>{l.A.publish(new x.S8({component:o.ShareModal,props:{dashboard:B,panel:j}}))},C=(B,j)=>{l.A.publish(new x.S8({component:p.o,props:{panel:j,initialFolderUid:B.meta.folderUid,isOpen:!0}}))},b=B=>{l.A.publish(new x.S8({component:u.l,props:{onConfirm:()=>B.unlinkLibraryPanel(),isOpen:!0}}))},T=B=>{B.refresh()},S=B=>{const j={...B.options};j.legend.showLegend===!0?j.legend.showLegend=!1:j.legend.showLegend=!0,B.updateOptions(j)};function O(B,j){const A={timeInfo:"",timeRange:j};if(B.timeFrom){const K=(0,i.w)().replace(B.timeFrom,B.scopedVars),W=a.describeTextRange(K);if(W.invalid)return A.timeInfo="invalid time override",A;if((0,t.isString)(j.raw.from)){const U=(0,r.AN)(j.from).tz(),F=(0,r.AN)(j.to).tz(),V=g.parse(W.from,void 0,U);A.timeInfo=W.display,A.timeRange={from:V,to:g.parse(W.to,void 0,F),raw:{from:W.from,to:W.to}}}}if(B.timeShift){const K=(0,i.w)().replace(B.timeShift,B.scopedVars);if(a.describeTextRange(K).invalid)return A.timeInfo="invalid timeshift",A;const U="-"+K;A.timeInfo+=" timeshift "+U;const F=g.parseDateMath(U,A.timeRange.from,!1),V=g.parseDateMath(U,A.timeRange.to,!0);A.timeRange={from:F,to:V,raw:{from:F,to:V}}}return B.hideTimeOverride&&(A.timeInfo=""),A}function M(B){const A=document.getElementsByTagName("html")[0].getBoundingClientRect().width;return B.maxDataPoints?B.maxDataPoints:Math.ceil(A*(B.gridPos.w/24))}function I(B,j){const A=B.plugin&&B.plugin.noPadding?0:config.theme.panelPadding*2,K=B.hasTitle()?config.theme.panelHeaderHeight:0;return j-K-A-PANEL_BORDER}function L(B){for(const A of B.panelIterator())A.gridPos.y+=8;return{x:0,y:0,w:12,h:8}}},21380:(G,R,e)=>{"use strict";e.d(R,{z:()=>s});var t=e(47232),n=e(85858);const s=(a,r)=>{const g={from:(0,t.Ar)(a.from)?(0,t.KQ)(a.from):a.from,to:(0,t.Ar)(a.to)?(0,t.KQ)(a.to):a.to},i=r?r.getTimezone():void 0;return{from:n.parse(g.from,!1,i,r?.fiscalYearStartMonth),to:n.parse(g.to,!0,i,r?.fiscalYearStartMonth),raw:g}}},16833:(G,R,e)=>{"use strict";e.d(R,{D:()=>s,d:()=>n});var t=e(7758);function n(l,d,c){const h=r(l.templating.list),o=a(l.panels);t.c.dashboardInitialized({uid:l.uid,title:l.title,theme:l.style,schemaVersion:l.schemaVersion,version_before_migration:c,panels_count:l.panels.length,...o,...h,settings_nowdelay:l.timepicker.nowDelay,settings_livenow:!!l.liveNow,duration:d,isScene:!1})}function s(l,d){const c=l.getInitialSaveModel();if(c){const h=a(c.panels||[]),o=r(c.templating?.list||[]);t.c.dashboardInitialized({uid:c.uid,title:c.title,theme:void 0,schemaVersion:c.schemaVersion,version_before_migration:c.version,panels_count:c.panels?.length||0,...h,...o,settings_nowdelay:void 0,settings_livenow:!!c.liveNow,duration:d,isScene:!0})}}function a(l){return l.map(d=>d.type).reduce((d,c)=>(d[i(c)]=1+d[i(c)]||1,d),{})}function r(l){return l.map(d=>d.type).reduce((d,c)=>(d[g(c)]=1+d[g(c)]||1,d),{})}const g=l=>`variable_type_${l}_count`,i=l=>`panel_type_${l}_count`},40489:(G,R,e)=>{"use strict";e.d(R,{ZF:()=>g,vI:()=>r,o2:()=>i});var t=e(88483),n=e(14236);function s(l){const d=new Set;return Object.keys(l).forEach(c=>{l[c].forEach(h=>{d.add(h)})}),d}function a(l){const d=Array.from(s(l));return d.length===1?d[0]:`${d.slice(0,-1).join(", ")} or ${d.slice(-1)}`}function r(l){return new t.c(d=>{let c=0;Promise.all([e.e(2136),e.e(3686)]).then(e.bind(e,22136)).then(h=>{l.forEach(o=>{const m=new FileReader;m.readAsArrayBuffer(o),m.onload=()=>{const u=m.result;if(u&&u instanceof ArrayBuffer){if(o.type==="application/json"){const p=new TextDecoder("utf-8"),f=JSON.parse(p.decode(u));d.next({dataFrames:[(0,n.Vc)(f)],file:o})}else d.next({dataFrames:h.readSpreadsheet(u),file:o});++c>=l.length&&d.complete()}}})}).catch(()=>{throw"Failed to load sheets module"})})}const g={"text/plain":[".csv",".txt"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"],"application/vnd.apple.numbers":[".numbers"],"application/vnd.oasis.opendocument.spreadsheet":[".ods"],"application/json":[".json"]},i=5e5},32738:(G,R,e)=>{"use strict";e.d(R,{r:()=>l});var t=e(74848),n=e(71733),s=e(55852),a=e(10096),r=e(8484),g=e(6320),i=e(31678);function l({variant:d,onClick:c}){const h=a.TP.hasPermission(i.AccessControlAction.DataSourcesCreate),o=n.I.assureBaseUrl(g.b.DataSourcesNew);return(0,t.jsx)(s.z9,{variant:d||"primary",href:o,disabled:!h,tooltip:h?void 0:"You do not have permission to configure new data sources",onClick:c,target:"_blank",children:(0,t.jsx)(r.x6,{i18nKey:"data-source-picker.add-new-data-source",children:"Configure a new data source"})})}},2221:(G,R,e)=>{"use strict";e.d(R,{A:()=>g});var t=e(74848),n=e(32196),s=e(40845),a=e(10860),r=e(64149);function g({ds:l,onClick:d,selected:c,description:h,...o}){const m=(0,s.$j)(),u=i(m,l.meta.builtIn);return(0,t.jsxs)(a.Z,{onClick:d,className:(0,n.cx)(u.card,c?u.selected:void 0),...o,children:[(0,t.jsx)(a.Z.Heading,{className:u.heading,children:(0,t.jsxs)("div",{className:u.headingContent,children:[(0,t.jsxs)("span",{className:u.name,children:[l.name," ",l.isDefault?(0,t.jsx)(r.L,{tags:["default"]}):null]}),(0,t.jsx)("small",{className:u.type,children:h||l.meta.name})]})}),(0,t.jsx)(a.Z.Figure,{className:u.logo,children:(0,t.jsx)("img",{src:l.meta.info.logos.small,alt:`${l.meta.name} Logo`})})]},l.uid)}function i(l,d=!1){return{card:(0,n.css)`
      cursor: pointer;
      background-color: ${l.colors.background.primary};
      border-bottom: 1px solid ${l.colors.border.weak};
      // Move to list component
      margin-bottom: 0;
      border-radius: 0;
      padding: ${l.spacing(1)};
    `,heading:(0,n.css)`
      width: 100%;
      overflow: hidden;
      // This is needed to enable ellipsis when text overlfows
      > button {
        width: 100%;
      }
    `,headingContent:(0,n.css)`
      color: ${l.colors.text.secondary};
      width: 100%;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      display: flex;
      justify-content: space-between;
    `,logo:(0,n.css)`
      width: 32px;
      height: 32px;
      padding: ${l.spacing(0,1)};
      display: flex;
      align-items: center;

      > img {
        max-height: 100%;
        min-width: 24px;
        filter: invert(${d&&l.isLight?1:0});
      }
    `,name:(0,n.css)`
      color: ${l.colors.text.primary};
      display: flex;
      gap: ${l.spacing(2)};
    `,type:(0,n.css)`
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      display: flex;
      align-items: center;
    `,separator:(0,n.css)`
      margin: 0 ${l.spacing(1)};
      color: ${l.colors.border.weak};
    `,selected:(0,n.css)`
      background-color: ${l.colors.background.secondary};
    `,meta:(0,n.css)`
      display: block;
      overflow-wrap: unset;
      white-space: nowrap;
      width: 100%;
      overflow: hidden;
      text-overflow: ellipsis;
    `}}},11219:(G,R,e)=>{"use strict";e.d(R,{S:()=>o});var t=e(74848),n=e(32196),s=e(96540),a=e(13544),r=e(72574),g=e(40845),i=e(8484),l=e(87282),d=e(32738),c=e(2221),h=e(47311);function o(y){const x=(0,s.useRef)(null),[v,P]=(0,l.dR)({keyboardEvents:y.keyboardEvents,containerRef:x}),E=(0,g.$j)(),D=f(E,P),{className:C,current:b,onChange:T,enableKeyboardNavigation:S,onClickEmptyStateCTA:O}=y,M=(0,l.Kr)({alerting:y.alerting,annotations:y.annotations,dashboard:y.dashboard,logs:y.logs,metrics:y.metrics,mixed:y.mixed,pluginId:y.pluginId,tracing:y.tracing,type:y.type,variables:y.variables}),[I,L]=(0,l.TX)(),B=y.filter?M.filter(y.filter):M;return(0,t.jsxs)("div",{ref:x,className:(0,n.cx)(C,D.container),"data-testid":a.Tp.components.DataSourcePicker.dataSourceList,children:[B.length===0&&(0,t.jsx)(m,{className:D.emptyState,onClickCTA:O}),B.sort((0,h.Tj)(b,I,p())).map(j=>(0,t.jsx)(c.A,{"data-testid":"data-source-card",ds:j,onClick:()=>{L(j),T(j)},selected:(0,h.Df)(j,b),...S?v:{}},j.uid))]})}function m({className:y,onClickCTA:x}){const v=(0,g.of)(u);return(0,t.jsxs)("div",{className:(0,n.cx)(y,v.container),children:[(0,t.jsx)("p",{className:v.message,children:(0,t.jsx)(i.x6,{i18nKey:"data-source-picker.list.no-data-source-message",children:"No data sources found"})}),(0,t.jsx)(d.r,{onClick:x})]})}function u(y){return{container:(0,n.css)`
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    `,message:(0,n.css)`
      margin-bottom: ${y.spacing(3)};
    `}}function p(){return(0,r.w)().getVariables().filter(x=>x.type==="datasource").map(x=>`\${${x.id}}`)}function f(y,x){return{container:(0,n.css)`
      display: flex;
      flex-direction: column;
      ${x} {
        background-color: ${y.colors.background.secondary};
      }
    `,emptyState:(0,n.css)`
      height: 100%;
      flex: 1;
    `}}},50481:(G,R,e)=>{"use strict";e.d(R,{p:()=>S});var t=e(74848),n=e(32196),s=e(2543),a=e(96540),r=e(14110),g=e(32264),i=e(40845),l=e(37390),d=e(10354),c=e(14578),h=e(40276),o=e(37270),m=e(8484),u=e(40489),p=e(90478),f=e(87282),y=e(32738),x=e(13544),v=e(2221),P=e(47311);function E(M){switch(M){case"grafana":return(0,m.t)("data-source-picker.built-in-list.description-grafana","Discover visualizations using mock data");case"-- Mixed --":return(0,m.t)("data-source-picker.built-in-list.description-mixed","Use multiple data sources");case"-- Dashboard --":return(0,m.t)("data-source-picker.built-in-list.description-dashboard","Reuse query results from other visualizations");default:return""}}function D({className:M,current:I,onChange:L,tracing:B,dashboard:j,mixed:A,metrics:K,type:W,annotations:U,variables:F,alerting:V,pluginId:w,logs:z,filter:N}){const Q=(0,f.Kr)({tracing:B,dashboard:j,mixed:A,metrics:K,type:W,annotations:U,variables:F,alerting:V,pluginId:w,logs:z}).filter(X=>(N?N?.(X):!0)&&!!X.meta.builtIn);return(0,t.jsx)("div",{className:M,"data-testid":x.Tp.components.DataSourcePicker.advancedModal.builtInDataSourceList,children:Q.map(X=>(0,t.jsx)(v.A,{ds:X,description:E(X.uid),selected:(0,P.Df)(X,I),onClick:()=>L(X)},X.uid))})}var C=e(11219);const b="dashboards_dspickermodal_clicked",T={SELECT_DS:"select_ds",UPLOAD_FILE:"upload_file",CONFIG_NEW_DS:"config_new_ds",CONFIG_NEW_DS_EMPTY_STATE:"config_new_ds_empty_state",SEARCH:"search",DISMISS:"dismiss"};function S({tracing:M,dashboard:I,mixed:L,metrics:B,type:j,annotations:A,variables:K,alerting:W,pluginId:U,logs:F,uploadFile:V,filter:w,onChange:z,current:N,onDismiss:H,reportedInteractionFrom:Q}){const X=(0,i.of)(O),[ee,Z]=(0,a.useState)(""),q=Q||"modal",ae=()=>{H(),(0,r.rR)(b,{item:T.DISMISS,src:q})},k=re=>{z(re),(0,r.rR)(b,{item:T.SELECT_DS,ds_type:re.type,src:q})},se=(0,a.useMemo)(()=>(0,s.once)(()=>{(0,r.rR)(b,{item:"search",src:q})}),[q]),te=(0,f.ps)("-- Grafana --"),ne=(0,p.j)((re,de)=>{te&&(z(te,[re]),(0,r.rR)(b,{item:T.UPLOAD_FILE,src:q}),de.length<1&&H())}),le=({className:re})=>(0,t.jsx)(D,{className:re,onChange:k,current:N,filter:w,variables:K,tracing:M,metrics:B,type:j,annotations:A,alerting:W,pluginId:U,logs:F,dashboard:I,mixed:L});return(0,t.jsxs)(l.a,{title:(0,m.t)("data-source-picker.modal.title","Select data source"),closeOnEscape:!0,closeOnBackdropClick:!0,isOpen:!0,className:X.modal,contentClassName:X.modalContent,onClickBackdrop:ae,onDismiss:ae,children:[(0,t.jsxs)("div",{className:X.leftColumn,children:[(0,t.jsx)(d.p,{type:"search",autoFocus:!0,className:X.searchInput,value:ee,prefix:(0,t.jsx)(c.I,{name:"search"}),placeholder:(0,m.t)("data-source-picker.modal.input-placeholder","Select data source"),onChange:re=>{Z(re.currentTarget.value),se()}}),(0,t.jsxs)(h.E,{children:[(0,t.jsx)(C.S,{onChange:k,current:N,onClickEmptyStateCTA:()=>(0,r.rR)(b,{item:T.CONFIG_NEW_DS_EMPTY_STATE,src:q}),filter:re=>(w?w?.(re):!0)&&(0,P.Zn)(re,ee)&&!re.meta.builtIn,variables:K,tracing:M,metrics:B,type:j,annotations:A,alerting:W,pluginId:U,logs:F,dashboard:I,mixed:L}),(0,t.jsx)(le,{className:X.appendBuiltInDataSourcesList})]})]}),(0,t.jsxs)("div",{className:X.rightColumn,children:[(0,t.jsxs)("div",{className:X.builtInDataSources,children:[(0,t.jsx)(h.E,{className:X.builtInDataSourcesList,children:(0,t.jsx)(le,{})}),V&&g.$.featureToggles.editPanelCSVDragAndDrop&&(0,t.jsx)(o.gH,{readAs:"readAsArrayBuffer",fileListRenderer:()=>{},options:{maxSize:u.o2,multiple:!1,accept:u.ZF,onDrop:ne},children:(0,t.jsx)(o.wI,{})})]}),(0,t.jsxs)("div",{className:X.newDSSection,children:[(0,t.jsx)("span",{className:X.newDSDescription,children:(0,t.jsx)(m.x6,{i18nKey:"data-source-picker.modal.configure-new-data-source",children:"Open a new tab and configure a data source"})}),(0,t.jsx)(y.r,{variant:"secondary",onClick:()=>{(0,r.rR)(b,{item:T.CONFIG_NEW_DS,src:q}),H()}})]})]})]})}function O(M){return{modal:(0,n.css)`
      width: 80%;
      height: 80%;
      max-width: 1200px;
      max-height: 900px;

      ${M.breakpoints.down("md")} {
        width: 100%;
      }
    `,modalContent:(0,n.css)`
      display: flex;
      flex-direction: row;
      height: 100%;

      ${M.breakpoints.down("md")} {
        flex-direction: column;
      }
    `,leftColumn:(0,n.css)`
      display: flex;
      flex-direction: column;
      width: 50%;
      height: 100%;
      padding-right: ${M.spacing(4)};
      border-right: 1px solid ${M.colors.border.weak};

      ${M.breakpoints.down("md")} {
        width: 100%;
        border-right: 0;
        padding-right: 0;
        flex: 1;
        overflow-y: auto;
      }
    `,rightColumn:(0,n.css)`
      display: flex;
      flex-direction: column;
      width: 50%;
      height: 100%;
      justify-items: space-evenly;
      align-items: stretch;
      padding-left: ${M.spacing(4)};

      ${M.breakpoints.down("md")} {
        width: 100%;
        padding-left: 0;
        flex: 0;
      }
    `,builtInDataSources:(0,n.css)`
      flex: 1 1;
      margin-bottom: ${M.spacing(4)};

      ${M.breakpoints.down("md")} {
        flex: 0;
      }
    `,builtInDataSourcesList:(0,n.css)`
      ${M.breakpoints.down("md")} {
        display: none;
        margin-bottom: 0;
      }

      margin-bottom: ${M.spacing(4)};
    `,appendBuiltInDataSourcesList:(0,n.css)`
      ${M.breakpoints.up("md")} {
        display: none;
      }
    `,newDSSection:(0,n.css)`
      display: flex;
      flex-direction: row;
      width: 100%;
      justify-content: space-between;
      align-items: center;
    `,newDSDescription:(0,n.css)`
      flex: 1 0;
      text-overflow: ellipsis;
      overflow: hidden;
      white-space: nowrap;
      color: ${M.colors.text.secondary};
    `,searchInput:(0,n.css)`
      width: 100%;
      min-height: 32px;
      margin-bottom: ${M.spacing(1)};
    `}}},51612:(G,R,e)=>{"use strict";e.d(R,{s:()=>j});var t=e(74848),n=e(32196),s=e(34743),a=e(83505),r=e(46885),g=e(18828),i=e(85690),l=e(93225),d=e(96540),c=e(13544),h=e(14110),o=e(40845),m=e(10354),u=e(14578),p=e(17464),f=e(40276),y=e(71678),x=e(55852),v=e(2913),P=e(8484),E=e(97427),D=e(68706),C=e(87282),b=e(11219);function T(V){const{dataSource:w}=V,z=(0,o.$j)(),N=O(z,w?.meta.builtIn);return w?(0,t.jsx)("img",{className:N.pickerDSLogo,alt:`${w.meta.name} logo`,src:w.meta.info.logos.small}):S()}function S(){const V=(0,o.of)(O);return(0,t.jsx)("div",{className:V.pickerDSLogo})}function O(V,w=!1){return{pickerDSLogo:(0,n.css)`
      height: 20px;
      width: 20px;
      filter: invert(${w&&V.isLight?1:0});
    `}}var M=e(50481),I=e(47311);const L="dashboards_dspicker_clicked",B={OPEN_DROPDOWN:"open_dspicker",SELECT_DS:"select_ds",ADD_FILE:"add_file",OPEN_ADVANCED_DS_PICKER:"open_advanced_ds_picker",CONFIG_NEW_DS_EMPTY_STATE:"config_new_ds_empty_state"};function j(V){const{current:w,onChange:z,hideTextValue:N=!1,width:H,inputId:Q,noDefault:X=!1,disabled:ee=!1,placeholder:Z="Select data source",...q}=V,ae=(0,o.of)(A,V),[k,se]=(0,d.useState)(!1),[te,ne]=(0,d.useState)(!1),[le,re]=(0,d.useState)(""),{onKeyDown:de,keyboardEvents:oe}=(0,E.d)(),J=(0,d.useRef)(null),[ce,pe]=(0,d.useState)(),[xe,fe]=(0,d.useState)(),Ee=(0,C.ps)(w),Se=(0,C.ps)("-- Grafana --"),ye=!w&&X?void 0:Ee,Ve=le&&k?(0,t.jsx)(S,{}):(0,t.jsx)(T,{dataSource:ye}),Me=[(0,s.cY)(4),(0,s.Ej)({apply({availableHeight:Ie,elements:ue}){ue.floating.style.maxHeight=`${Math.max(200,Ie-20)}px`,ue.floating.style.minHeight="200px"}}),(0,s.UU)({fallbackStrategy:"initialPlacement",crossAxis:!1,boundary:document.body}),(0,s.BN)()],{refs:Ce,floatingStyles:Ue}=(0,a.we)({open:k,placement:"bottom-start",onOpenChange:se,middleware:Me,whileElementsMounted:r.ll,strategy:"fixed"}),Ae=(0,d.useCallback)(Ie=>{Ce.setReference(Ie),pe(Ie)},[Ce]),we=(0,d.useCallback)(()=>{re(""),se(!1),ce?.focus()},[se,ce]),{overlayProps:We,underlayProps:_e}=(0,l.e)({onClose:we,isDismissable:!0,isOpen:k,shouldCloseOnInteractOutside:Ie=>ce?!ce.isSameNode(Ie):!1},J),{dialogProps:at}=(0,g.s)({"aria-label":"Opened data source picker list"},J);function ut(){(0,h.rR)(L,{item:B.OPEN_DROPDOWN}),se(!0),ce?.focus()}function Tt(){Se&&z(Se,[D.dx])}function It(Ie){Ie.key==="Tab"&&!Ie.shiftKey&&k&&(Ie.preventDefault(),xe?.focus()),Ie.key==="Tab"&&Ie.shiftKey&&k&&we(),de(Ie)}function ge(Ie){Ie.shiftKey?(Ie.preventDefault(),ce?.focus()):we()}return(0,d.useEffect)(()=>{const Ie=oe.subscribe({next:ue=>{switch(ue?.code){case"ArrowDown":ut(),ue.preventDefault();break;case"ArrowUp":ut(),ue.preventDefault();break;case"Escape":we(),ue.preventDefault();break}}});return()=>Ie.unsubscribe()}),(0,t.jsxs)("div",{className:ae.container,"data-testid":c.Tp.components.DataSourcePicker.container,children:[(0,t.jsx)("div",{className:ae.trigger,onClick:ut,children:(0,t.jsx)(m.p,{id:Q||"data-source-picker",className:te?void 0:ae.input,"data-testid":c.Tp.components.DataSourcePicker.inputV2,"aria-label":"Select a data source",autoComplete:"off",prefix:ye?Ve:void 0,suffix:(0,t.jsx)(u.I,{name:k?"search":"angle-down"}),placeholder:N?"":(0,I.q7)(ye)||Z,onFocus:()=>{ne(!0)},onBlur:()=>{ne(!1)},onKeyDown:It,value:le,onChange:Ie=>{ut(),re(Ie.currentTarget.value)},ref:Ae,disabled:ee})}),k?(0,t.jsxs)(p.ZL,{children:[(0,t.jsx)("div",{..._e}),(0,t.jsx)("div",{ref:J,...We,...at,children:(0,t.jsx)(K,{...q,style:Ue,ref:Ce.setFloating,footerRef:fe,current:ye,filterTerm:le,keyboardEvents:oe,onChange:(Ie,ue)=>{we(),Ie.uid!==ye?.uid&&(z(Ie,ue),(0,h.rR)(L,{item:B.SELECT_DS,ds_type:Ie.type}))},onClose:we,onClickAddCSV:Tt,onDismiss:we,onNavigateOutsiteFooter:ge})})]}):null]})}function A(V,w){return{container:(0,n.css)({position:"relative",cursor:w.disabled?"not-allowed":"pointer",width:V.spacing(w.width||"auto")}),trigger:(0,n.css)({cursor:"pointer",pointerEvents:w.disabled?"none":"auto"}),input:(0,n.css)({"input::placeholder":{color:w.disabled?V.colors.action.disabledText:V.colors.text.primary}})}}const K=d.forwardRef((V,w)=>{const{filterTerm:z,onChange:N,onClose:H,onClickAddCSV:Q,current:X,filter:ee}=V,Z=(0,d.useCallback)(k=>{N(k)},[N]),q=(0,d.useCallback)(()=>{Q?.(),H(),(0,h.rR)(L,{item:B.ADD_FILE})},[Q,H]),ae=(0,o.of)(W);return(0,t.jsxs)("div",{style:V.style,ref:w,className:ae.container,children:[(0,t.jsx)(f.E,{children:(0,t.jsx)(b.S,{...V,enableKeyboardNavigation:!0,className:ae.dataSourceList,current:X,onChange:Z,filter:k=>(ee?ee?.(k):!0)&&(0,I.Zn)(k,z),onClickEmptyStateCTA:()=>(0,h.rR)(L,{item:B.CONFIG_NEW_DS_EMPTY_STATE})})}),(0,t.jsx)(i.n1,{children:(0,t.jsx)(U,{...V,onClickAddCSV:q,onChange:Z,onNavigateOutsiteFooter:V.onNavigateOutsiteFooter})})]})});K.displayName="PickerContent";function W(V){return{container:(0,n.css)({display:"flex",flexDirection:"column",background:V.colors.background.primary,boxShadow:V.shadows.z3}),picker:(0,n.css)({background:V.colors.background.secondary}),dataSourceList:(0,n.css)({flex:1}),footer:(0,n.css)({flex:0,display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",padding:V.spacing(1.5),borderTop:`1px solid ${V.colors.border.weak}`,backgroundColor:V.colors.background.secondary})}}function U({onClose:V,onChange:w,onClickAddCSV:z,...N}){const H=(0,o.of)(F),Q=N.uploadFile&&v.Ay.featureToggles.editPanelCSVDragAndDrop,X=Z=>{Z.key==="Tab"&&N.onNavigateOutsiteFooter(Z)},ee=Z=>{Z.key==="Tab"&&Z.shiftKey&&N.onNavigateOutsiteFooter(Z)};return(0,t.jsxs)("div",{className:H.footer,children:[(0,t.jsx)(y.$s,{children:({showModal:Z,hideModal:q})=>(0,t.jsxs)(x.$n,{size:"sm",variant:"secondary",fill:"text",onClick:()=>{V(),Z(M.p,{reportedInteractionFrom:"ds_picker",tracing:N.tracing,dashboard:N.dashboard,mixed:N.mixed,metrics:N.metrics,type:N.type,annotations:N.annotations,variables:N.variables,alerting:N.alerting,pluginId:N.pluginId,logs:N.logs,filter:N.filter,uploadFile:N.uploadFile,current:N.current,onDismiss:q,onChange:(ae,k)=>{w(ae,k),q()}}),(0,h.rR)(L,{item:B.OPEN_ADVANCED_DS_PICKER})},ref:N.footerRef,onKeyDown:Q?ee:X,children:[(0,t.jsx)(P.x6,{i18nKey:"data-source-picker.open-advanced-button",children:"Open advanced data source picker"}),(0,t.jsx)(u.I,{name:"arrow-right"})]})}),Q&&(0,t.jsx)(x.$n,{variant:"secondary",size:"sm",onClick:z,onKeyDown:X,children:"Add csv or spreadsheet"})]})}function F(V){return{footer:(0,n.css)({flex:0,display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",padding:V.spacing(1.5),borderTop:`1px solid ${V.colors.border.weak}`,backgroundColor:V.colors.background.secondary})}}},47311:(G,R,e)=>{"use strict";e.d(R,{Df:()=>a,Tj:()=>g,Zn:()=>i,q7:()=>r,tw:()=>l});var t=e(14792),n=e(36974),s=e(14678);function a(d,c){return!d||!c?!1:typeof c=="string"?d.uid===c:d.uid===c.uid}function r(d){if(d){if(typeof d=="string")return`${d} - not found`;if("name"in d)return d.name;if(d.uid)return`${d.uid} - not found`}}function g(d,c,h){return(m,u)=>{const p=m.name.toUpperCase(),f=u.name.toUpperCase();if(d&&a(m,d))return-1;if(d&&a(u,d))return 1;const y=c.indexOf(m.uid),x=c.indexOf(u.uid);if(y>-1&&y>x)return-1;if(x>-1&&x>y)return 1;const v=h.includes(m.uid),P=h.includes(u.uid);return v&&!P?-1:P&&!v||m.meta.builtIn&&!u.meta.builtIn?1:u.meta.builtIn&&!m.meta.builtIn||p<f?-1:1}}function i(d,c=""){return d.name.toLowerCase().includes(c.toLowerCase())}function l(d){if(!d.uid)return;const c=(0,t.UA)().getCurrent()?.uid??"";if(d.uid===s.uv)return(0,n.B1)(c);(0,n.dH)(c,d.uid)}},83883:(G,R,e)=>{"use strict";e.d(R,{I:()=>t});const t={List:"/datasources",Edit:"/datasources/edit/:uid",Dashboards:"/datasources/edit/:uid/dashboards",New:"/datasources/new"}},87282:(G,R,e)=>{"use strict";e.d(R,{Kr:()=>g,TX:()=>r,dR:()=>l,ps:()=>i});var t=e(96540),n=e(78685),s=e(19347);const a="grafana.features.datasources.components.picker.DataSourceDropDown.history";function r(){const[d=[],c]=(0,n.A)(a,[]),h=(0,t.useCallback)(o=>{o.meta.builtIn||(d.includes(o.uid)?(d.splice(d.findIndex(m=>o.uid===m),1),c([...d,o.uid])):c([...d,o.uid].slice(1,6)))},[d,c]);return[d,h]}function g(d){return(0,s.l)().getList(d)}function i(d){const c=(0,s.l)();return c.getInstanceSettings(d)}function l(d){const{keyboardEvents:c,containerRef:h}=d,o=(0,t.useRef)(0),m="data-role",u="keyboardSelectableItem",p={[m]:u},f=`[${m}="${u}"`,y="data-selectedItem",x=`[${y}="true"]`,v=(0,t.useCallback)(E=>{const D=h?.current?.querySelectorAll(f),C=D?.item(E%D?.length);D?.forEach(b=>b.setAttribute(y,"false")),C&&(C.scrollIntoView({block:"center"}),C.setAttribute(y,"true"))},[h,f]),P=(0,t.useCallback)(()=>{h?.current?.querySelector(x)?.querySelector("button")?.click()},[h,x]);return(0,t.useEffect)(()=>{if(!c)return;const E=c.subscribe({next:D=>{switch(D?.code){case"ArrowDown":{v(++o.current),D.preventDefault();break}case"ArrowUp":o.current=o.current>0?o.current-1:o.current,v(o.current),D.preventDefault();break;case"Enter":P();break}}});return()=>E.unsubscribe()},[c,v,P]),(0,t.useEffect)(()=>{const E=new MutationObserver(D=>{D.some(b=>b.addedNodes&&b.addedNodes.length>0||b.removedNodes&&b.removedNodes.length>0)&&v(0)});return h.current&&E.observe(h.current,{childList:!0}),()=>{E.disconnect()}},[h,f,v]),[p,x]}},36227:(G,R,e)=>{"use strict";e.d(R,{Ay:()=>b,Bs:()=>c,C_:()=>u,E1:()=>g,Gc:()=>l,IJ:()=>y,Ks:()=>x,QZ:()=>P,TN:()=>r,Tk:()=>p,UP:()=>D,eB:()=>o,f$:()=>d,gZ:()=>i,jz:()=>a,lg:()=>E,qR:()=>v,rb:()=>m});var t=e(65307),n=e(19484);const s={dataSources:[],plugins:[],categories:[],dataSource:{},layoutMode:n.R.List,searchQuery:"",dataSourcesCount:0,dataSourceTypeSearchQuery:"",isLoadingDataSources:!1,isLoadingDataSourcePlugins:!1,dataSourceMeta:{},isSortAscending:!0},a=(0,t.VP)("dataSources/dataSourceLoaded"),r=(0,t.VP)("dataSources/dataSourcesLoad"),g=(0,t.VP)("dataSources/dataSourcesLoaded"),i=(0,t.VP)("dataSources/dataSourceMetaLoaded"),l=(0,t.VP)("dataSources/dataSourcePluginsLoad"),d=(0,t.VP)("dataSources/dataSourcePluginsLoaded"),c=(0,t.VP)("dataSources/setDataSourcesSearchQuery"),h=(0,t.VP)("dataSources/setDataSourcesLayoutMode"),o=(0,t.VP)("dataSources/setDataSourceTypeSearchQuery"),m=(0,t.VP)("dataSources/setDataSourceName"),u=(0,t.VP)("dataSources/setIsDefault"),p=(0,t.VP)("dataSources/setIsSortAscending"),f=(T=s,S)=>r.match(S)?{...T,isLoadingDataSources:!0}:g.match(S)?{...T,isLoadingDataSources:!1,dataSources:S.payload,dataSourcesCount:S.payload.length}:a.match(S)?{...T,dataSource:S.payload}:c.match(S)?{...T,searchQuery:S.payload}:h.match(S)?{...T,layoutMode:S.payload}:l.match(S)?{...T,plugins:[],isLoadingDataSourcePlugins:!0}:d.match(S)?{...T,plugins:S.payload.plugins,categories:S.payload.categories,isLoadingDataSourcePlugins:!1}:o.match(S)?{...T,dataSourceTypeSearchQuery:S.payload}:i.match(S)?{...T,dataSourceMeta:S.payload}:m.match(S)?{...T,dataSource:{...T.dataSource,name:S.payload}}:u.match(S)?{...T,dataSource:{...T.dataSource,isDefault:S.payload}}:p.match(S)?{...T,isSortAscending:S.payload}:T,y={testingStatus:{},loadError:null,loading:!0,plugin:null},x=(0,t.VP)("dataSourceSettings/initDataSourceSettingsSucceeded"),v=(0,t.VP)("dataSourceSettings/initDataSourceSettingsFailed"),P=(0,t.VP)("dataSourceSettings/testDataSourceStarting"),E=(0,t.VP)("dataSourceSettings/testDataSourceSucceeded"),D=(0,t.VP)("dataSourceSettings/testDataSourceFailed"),b={dataSources:f,dataSourceSettings:(T=y,S)=>x.match(S)?{...T,plugin:S.payload,loadError:null,loading:!1}:v.match(S)?{...T,plugin:null,loadError:S.payload.message,loading:!1}:P.match(S)?{...T,testingStatus:{message:"Testing... this could take up to a couple of minutes",status:"info"}}:E.match(S)?{...T,testingStatus:{status:S.payload?.status,message:S.payload?.message,details:S.payload?.details}}:D.match(S)?{...T,testingStatus:{status:"error",message:S.payload?.message,details:S.payload?.details}}:T}},38074:()=>{"use strict"},25148:(G,R,e)=>{"use strict";e.d(R,{n:()=>f});var t=e(74848),n=e(32196),s=e(96540),a=e(40845),r=e(55852),g=e(39268),i=e(14186),l=e(10354),d=e(95868),c=e(13840),h=e(40321),o=e(47694),m=e(21813),u=e(80744),p=e(19448);const f=v=>{const{value:P,src:E,name:D,placeholder:C,onChange:b,onClear:T,mediaType:S,folderName:O,size:M,color:I,maxFiles:L}=v,B=(0,a.of)(x),j=(0,a.$j)(),A=(0,s.createRef)(),K=(0,t.jsx)(p.i,{onChange:b,value:P,mediaType:S,folderName:O,maxFiles:L});let W=E;!W&&P&&(W=(0,m.D)(P));const U=I&&{fill:j.visualization.getColorByName(I)},F=()=>P&&W?(0,t.jsx)(o.y,{src:W,className:B.icon,style:{...U}}):(0,t.jsx)(r.z9,{variant:"primary",fill:"text",size:"sm",children:"Set icon"}),V=()=>(0,t.jsx)(g.C,{children:(0,t.jsx)(i.I,{label:null,grow:!0,children:(0,t.jsx)(l.p,{value:y(E,D),placeholder:C,readOnly:!0,prefix:W&&(0,t.jsx)(o.y,{src:W,className:B.icon,style:{...U}}),suffix:(0,t.jsx)(r.$n,{icon:"times",variant:"secondary",fill:"text",size:"sm",onClick:T})})})});return(0,t.jsx)(d.I,{content:K,children:(w,z,N)=>(0,t.jsxs)(t.Fragment,{children:[A.current&&(0,t.jsx)(c.A,{...N,referenceElement:A.current,onMouseEnter:w,onKeyDown:H=>{(0,h.Q)(H,z)}}),(0,t.jsxs)("div",{ref:A,className:B.pointer,onClick:w,onKeyDown:H=>{H.key==="Enter"&&w()},role:"button",tabIndex:0,children:[M===u.Iy.SMALL&&F(),M===u.Iy.NORMAL&&V()]})]})})};function y(v,P){if(v?.startsWith("public/img/icons")){const E=P?.lastIndexOf(".svg")??0;if(E>0)return P.substring(0,E)}return P}const x=v=>({pointer:(0,n.css)`
    cursor: pointer;
    input[readonly] {
      cursor: pointer;
    }
  `,icon:(0,n.css)`
    vertical-align: middle;
    display: inline-block;
    fill: currentColor;
    width: 25px;
  `})},19448:(G,R,e)=>{"use strict";e.d(R,{i:()=>W});var t=e(74848),n=e(32196),s=e(18828),a=e(85690),r=e(93225),g=e(96540),i=e(17172),l=e(40845),d=e(55852),c=e(2913),h=e(80744),o=e(88575),m=e(37270),u=e(47694);function p({secondaryText:F="Drag and drop here or browse"}){const V=(0,l.of)(y);return(0,t.jsxs)("div",{className:V.iconWrapper,children:[(0,t.jsx)("small",{className:V.small,children:F}),(0,t.jsx)(d.$n,{type:"button",icon:"upload",children:"Upload"})]})}const f=({mediaType:F,setFormData:V,setUpload:w,error:z})=>{const N=(0,l.of)(y),[H,Q]=(0,g.useState)(!1),[X,ee]=(0,g.useState)(""),Z=()=>(0,t.jsx)(o.D,{label:"Preview",children:(0,t.jsxs)("div",{className:N.iconPreview,children:[F===h.zu.Icon&&(0,t.jsx)(u.y,{src:X,className:N.img}),F===h.zu.Image&&(0,t.jsx)("img",{src:X,alt:"Preview of the uploaded file",className:N.img})]})}),q=k=>{fetch(`/api/storage/delete/upload/${k.file.name}`,{method:"DELETE"}).catch(se=>console.error("cannot delete file",se))},ae=F==="icon"?{"image/*":[".svg",".xml"]}:{"image/*":[".jpeg",".png",".gif",".webp"]};return(0,t.jsx)(m.gH,{readAs:"readAsBinaryString",onFileRemove:q,options:{accept:ae,multiple:!1,onDrop:k=>{let se=new FormData;se.append("file",k[0]),ee(URL.createObjectURL(k[0])),Q(!0),V(se),w(!0)}},children:z.message!==""&&H?(0,t.jsx)("p",{children:z.message}):H?(0,t.jsx)(Z,{}):(0,t.jsx)(p,{})})};function y(F,V){return{container:(0,n.css)`
      display: flex;
      flex-direction: column;
      width: 100%;
    `,dropzone:(0,n.css)`
      display: flex;
      flex: 1;
      flex-direction: column;
      align-items: center;
      padding: ${F.spacing(6)};
      border-radius: 2px;
      border: 2px dashed ${F.colors.border.medium};
      background-color: ${V?F.colors.background.secondary:F.colors.background.primary};
      cursor: pointer;
    `,iconWrapper:(0,n.css)`
      display: flex;
      flex-direction: column;
      align-items: center;
    `,acceptMargin:(0,n.css)`
      margin: ${F.spacing(2,0,1)};
    `,small:(0,n.css)`
      color: ${F.colors.text.secondary};
      margin-bottom: ${F.spacing(2)};
    `,iconContainer:(0,n.css)`
      display: flex;
      flex-direction: column;
      width: 80%;
      align-items: center;
      align-self: center;
    `,iconPreview:(0,n.css)`
      width: 238px;
      height: 198px;
      border: 1px solid ${F.colors.border.medium};
      display: flex;
      align-items: center;
      justify-content: center;
    `,img:(0,n.css)`
      width: 147px;
      height: 147px;
      fill: ${F.colors.text.primary};
    `}}var x=e(90182),v=e(67647),P=e(31193),E=e(70713),D=e(91793);const C=(0,g.memo)(function(V){const{columnIndex:w,rowIndex:z,style:N,data:H}=V,{cards:Q,columnCount:X,onChange:ee,selected:Z}=H,q=w+z*X,ae=Q[q],k=(0,l.of)(T);return(0,t.jsx)("div",{style:N,children:ae&&(0,t.jsxs)("div",{className:Z===ae.value?(0,n.cx)(k.card,k.selected):k.card,onClick:()=>ee(ae.value),onKeyDown:se=>{se.key==="Enter"&&ee(ae.value)},role:"button",tabIndex:0,children:[ae.imgUrl.endsWith(".svg")?(0,t.jsx)(u.y,{src:ae.imgUrl,className:k.img}):(0,t.jsx)("img",{src:ae.imgUrl,alt:"",className:k.img}),(0,t.jsx)("h6",{className:k.text,children:ae.label.slice(0,-4)})]},ae.value)})},D.t7),b=F=>{const{onChange:V,cards:w,value:z}=F,N=(0,l.of)(T);return(0,t.jsx)(E.Ay,{defaultWidth:680,children:({width:H,height:Q})=>{const Z=Math.floor(H/90),q=Math.ceil(w.length/Z);return(0,t.jsx)(D.yi,{width:H,height:Q,columnCount:Z,columnWidth:90,rowCount:q,rowHeight:90,itemData:{cards:w,columnCount:Z,onChange:V,selected:z},className:N.grid,children:C})}})},T=F=>({card:(0,n.css)`
    display: inline-block;
    width: 90px;
    height: 90px;
    margin: 0.75rem;
    margin-left: 15px;
    text-align: center;
    cursor: pointer;
    position: relative;
    background-color: transparent;
    border: 1px solid transparent;
    border-radius: 8px;
    padding-top: 6px;
    :hover {
      border-color: ${F.colors.action.hover};
      box-shadow: ${F.shadows.z2};
    }
  `,selected:(0,n.css)`
    border: 2px solid ${F.colors.primary.main};
    :hover {
      border-color: ${F.colors.primary.main};
    }
  `,img:(0,n.css)`
    width: 40px;
    height: 40px;
    object-fit: cover;
    vertical-align: middle;
    fill: ${F.colors.text.primary};
  `,text:(0,n.css)`
    color: ${F.colors.text.primary};
    white-space: nowrap;
    font-size: 12px;
    text-overflow: ellipsis;
    display: block;
    overflow: hidden;
  `,grid:(0,n.css)`
    border: 1px solid ${F.colors.border.medium};
  `}),S=F=>F===h.zu.Icon?[h.Iu.Icon,h.Iu.IOT,h.Iu.Marker]:[h.Iu.BG],O=(F,V)=>F.find(w=>V.startsWith(w.value))??F[0],M=F=>{const{value:V,mediaType:w,folderName:z,newValue:N,setNewValue:H,maxFiles:Q}=F,X=(0,l.of)(I),ee=S(w).map(de=>({label:de,value:de})),[Z,q]=(0,g.useState)(),[ae,k]=(0,g.useState)(O(ee,V?.length?V:z)),[se,te]=(0,g.useState)([]),[ne,le]=(0,g.useState)([]),re=de=>{de?(de=de.toLowerCase(),le(se.filter(oe=>oe.search.includes(de)))):le(se)};return(0,g.useEffect)(()=>{const de=ae?.value;if(de){const oe=w===h.zu.Icon?J=>J.name.endsWith(".svg"):J=>J.name.endsWith(".png")||J.name.endsWith(".gif");(0,P.tR)().get("-- Grafana --").then(J=>{J.listFiles(de,Q).subscribe({next:ce=>{const pe=[];ce.forEach(xe=>{if(oe(xe)){const fe=xe.name.lastIndexOf(".");pe.push({value:`${de}/${xe.name}`,label:xe.name,search:(fe?xe.name.substring(0,fe):xe.name).toLowerCase(),imgUrl:`public/${de}/${xe.name}`})}}),te(pe),le(pe)}})})}},[w,ae,Q]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.D,{children:(0,t.jsx)(x.l6,{options:ee,onChange:k,value:ae,menuShouldPortal:!1})}),(0,t.jsx)(o.D,{children:(0,t.jsx)(v.Z,{value:Z??"",placeholder:"Search",onChange:de=>{re(de),q(de)}})}),ne&&(0,t.jsx)("div",{className:X.cardsWrapper,children:(0,t.jsx)(b,{cards:ne,onChange:de=>H(de),value:N})})]})},I=F=>({cardsWrapper:(0,n.css)`
    height: 30vh;
    min-height: 50px;
    margin-top: 5px;
    max-width: 680px;
  `});var L=e(10354),B=e(60029),j=e(21813);const A=F=>{const{newValue:V,setNewValue:w,mediaType:z}=F,N=(0,l.of)(K),H=(0,j.D)(V);let Q=V?.substring(V.lastIndexOf("/")+1,V.lastIndexOf("."));return Q.length>20&&(Q=Q.substring(0,20)+"..."),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.D,{children:(0,t.jsx)(L.p,{onChange:X=>w(X.currentTarget.value),value:V})}),(0,t.jsxs)("div",{className:N.iconContainer,children:[(0,t.jsx)(o.D,{label:"Preview",children:(0,t.jsxs)("div",{className:N.iconPreview,children:[z===h.zu.Icon&&(0,t.jsx)(u.y,{src:H,className:N.img}),z===h.zu.Image&&V&&(0,t.jsx)("img",{src:H,alt:"Preview of the selected URL",className:N.img})]})}),(0,t.jsx)(B.J,{children:Q})]})]})},K=F=>({iconContainer:(0,n.css)`
    display: flex;
    flex-direction: column;
    width: 80%;
    align-items: center;
    align-self: center;
  `,iconPreview:(0,n.css)`
    width: 238px;
    height: 198px;
    border: 1px solid ${F.colors.border.medium};
    display: flex;
    align-items: center;
    justify-content: center;
  `,img:(0,n.css)`
    width: 147px;
    height: 147px;
    fill: ${F.colors.text.primary};
  `}),W=F=>{const{value:V,onChange:w,mediaType:z,folderName:N,maxFiles:H}=F,Q=(0,l.of)(U),X=()=>{w(V)},ee=(0,g.createRef)(),{dialogProps:Z}=(0,s.s)({},ee),{overlayProps:q}=(0,r.e)({onClose:X,isDismissable:!0,isOpen:!0},ee),ae=V&&V.includes("://"),[k,se]=(0,g.useState)(V??""),[te,ne]=(0,g.useState)(ae?h.QC.URL:h.QC.Folder),[le,re]=(0,g.useState)(new FormData),[de,oe]=(0,g.useState)(!1),[J,ce]=(0,g.useState)({message:""}),pe=ye=>`${Q.resourcePickerPopoverTab} ${te===ye&&Q.resourcePickerPopoverActiveTab}`,xe=()=>(0,t.jsx)(M,{value:V,mediaType:z,folderName:N,newValue:k,setNewValue:se,maxFiles:H}),fe=()=>(0,t.jsx)(A,{newValue:k,setNewValue:se,mediaType:z}),Ee=()=>(0,t.jsx)(f,{mediaType:z,setFormData:re,setUpload:oe,newValue:k,error:J}),Se=()=>{switch(te){case h.QC.Folder:return xe();case h.QC.URL:return fe();case h.QC.Upload:return Ee();default:return xe()}};return(0,t.jsx)(a.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("section",{ref:ee,...q,...Z,children:(0,t.jsxs)("div",{className:Q.resourcePickerPopover,children:[(0,t.jsxs)("div",{className:Q.resourcePickerPopoverTabs,children:[(0,t.jsx)("button",{className:pe(h.QC.Folder),onClick:()=>ne(h.QC.Folder),children:"Folder"}),(0,t.jsx)("button",{className:pe(h.QC.URL),onClick:()=>ne(h.QC.URL),children:"URL"})]}),(0,t.jsxs)("div",{className:Q.resourcePickerPopoverContent,children:[Se(),(0,t.jsxs)("div",{className:Q.buttonRow,children:[(0,t.jsx)(d.$n,{variant:"secondary",onClick:()=>X(),fill:"outline",children:"Cancel"}),(0,t.jsx)(d.$n,{variant:k&&k!==V?"primary":"secondary",onClick:()=>{de?fetch("/api/storage/upload",{method:"POST",body:le}).then(ye=>{if(ye.status>=400){ye.json().then(Ve=>ce(Ve));return}else return ye.json()}).then(ye=>{(0,i.AI)().get(`api/storage/read/${ye.path}`).then(()=>se(`${c.$W.appUrl}api/storage/read/${ye.path}`)).then(()=>w(`${c.$W.appUrl}api/storage/read/${ye.path}`))}).catch(ye=>console.error(ye)):w(k)},children:"Select"})]})]})]})})})},U=F=>({resourcePickerPopover:(0,n.css)`
    border-radius: ${F.shape.radius.default};
    box-shadow: ${F.shadows.z3};
    background: ${F.colors.background.primary};
    border: 1px solid ${F.colors.border.weak};
  `,resourcePickerPopoverTab:(0,n.css)`
    width: 50%;
    text-align: center;
    padding: ${F.spacing(1,0)};
    background: ${F.colors.background.secondary};
    color: ${F.colors.text.secondary};
    font-size: ${F.typography.bodySmall.fontSize};
    cursor: pointer;
    border: none;

    &:focus:not(:focus-visible) {
      outline: none;
      box-shadow: none;
    }

    :focus-visible {
      position: relative;
    }
  `,resourcePickerPopoverActiveTab:(0,n.css)`
    color: ${F.colors.text.primary};
    font-weight: ${F.typography.fontWeightMedium};
    background: ${F.colors.background.primary};
  `,resourcePickerPopoverContent:(0,n.css)`
    width: 315px;
    font-size: ${F.typography.bodySmall.fontSize};
    min-height: 184px;
    padding: ${F.spacing(1)};
    display: flex;
    flex-direction: column;
  `,resourcePickerPopoverTabs:(0,n.css)`
    display: flex;
    width: 100%;
    border-radius: ${F.shape.radius.default} ${F.shape.radius.default} 0 0;
  `,buttonRow:(0,n.css)({display:"flex",justifyContent:"center",gap:F.spacing(2),padding:F.spacing(1)})})},63577:(G,R,e)=>{"use strict";e.d(R,{MediaType:()=>t.zu,ResourceFolderName:()=>t.Iu,findField:()=>r.UI,findFieldIndex:()=>r.gG,getColorDimension:()=>g,getPublicOrAbsoluteUrl:()=>u.D,getResourceDimension:()=>u.$,getScalarDimension:()=>f.H,getScaledDimension:()=>l.hX,getScaledDimensionForField:()=>l.qx,getTextDimension:()=>o});var t=e(80744),n=e(8066),s=e(58563),a=e(57875),r=e(33924);function g(y,x,v){return i((0,r.UI)(y,x.field),x,v)}function i(y,x,v){if(!y){const D=v.visualization.getColorByName(x.fixed??"grey");return{isAssumed:!!x.field?.length||!x.fixed,fixed:D,value:()=>D,get:C=>D}}const P=(0,n.Qi)(y);if(P.isByValue||y.config.mappings?.length){const D=(0,s.xg)(y,!0);D!==y.config&&(y={...y,config:D},y.state=void 0);const C=(0,a.J)({field:y,theme:v}),b=T=>C(T).color??"#ccc";return{field:y,get:T=>b(y.values[T]),value:()=>b((0,r.sB)(y))}}const E=P.getCalculator(y,v)(0,0);return{fixed:E,value:()=>E,get:D=>E,field:y}}var l=e(18379),d=e(11261),c=e(83195),h=e(52622);function o(y,x){const v=x.field?(0,r.UI)(y,x.field):y?.fields.find(P=>P.type===d.PU.string);return m(v,x)}function m(y,x){let v=x.fixed;const P=x.mode??h.RU.Fixed;if(P===h.RU.Fixed)return{isAssumed:!v,fixed:v,value:()=>v,get:D=>v};if(P===h.RU.Template){const D=C=>`TEMPLATE[${x.fixed} // ${C}]`;return y?{field:y,get:C=>D(y.values[C]),value:()=>D((0,r.sB)(y))}:(v=D(""),{isAssumed:!0,fixed:v,value:()=>v,get:C=>v})}if(!y)return{isAssumed:!0,fixed:v,value:()=>v,get:D=>v};let E=D=>(0,c.cN)(y.display(D));return{field:y,get:D=>E(y.values[D]),value:()=>E((0,r.sB)(y))}}var u=e(21813),p=e(38074),f=e(26781)},21813:(G,R,e)=>{"use strict";e.d(R,{$:()=>a,D:()=>s});var t=e(52622),n=e(33924);function s(r){return r?r.indexOf(":/")>0?r:window.__grafana_public_path__+r:""}function a(r,g){const i=g.mode??t.q_.Fixed;if(i===t.q_.Fixed){const c=s(g.fixed);return{isAssumed:!c,fixed:c,value:()=>c,get:h=>c}}const l=(0,n.UI)(r,g.field);if(!l){const c="";return{isAssumed:!0,fixed:c,value:()=>c,get:h=>c}}if(i===t.q_.Mapping){const c=h=>s(`${h}`);return{field:l,get:h=>c(l.values[h]),value:()=>c((0,n.sB)(l))}}const d=c=>{if(l&&l.display){const h=l.display(c).icon;return s(h??"")}return""};return{field:l,get:c=>d(l.values[c]),value:()=>d((0,n.sB)(l))}}},26781:(G,R,e)=>{"use strict";e.d(R,{H:()=>s});var t=e(52622),n=e(33924);function s(r,g){return a((0,n.UI)(r,g?.field),g)}function a(r,g){if(!r){const d=g.fixed??0;return{isAssumed:!!g.field?.length||!g.fixed,fixed:d,value:()=>d,get:()=>d}}let i=d=>d%g.max;return g.mode===t.WQ.Clamped&&(i=d=>d<g.min?g.min:d>g.max?g.max:d),{field:r,get:d=>{const c=r.values[d];return c===null||typeof c!="number"?0:i(c)},value:()=>(0,n.sB)(r)}}},18379:(G,R,e)=>{"use strict";e.d(R,{Nn:()=>g,Ru:()=>i,hX:()=>a,qx:()=>r});var t=e(58563),n=e(52622),s=e(33924);function a(l,d){return r((0,s.UI)(l,d?.field),d)}function r(l,d,c){if(!l){const f=d.fixed??0;return{isAssumed:!!d.field?.length||!d.fixed,fixed:f,value:()=>f,get:()=>f}}const h=(0,t.AP)(l),o=d.max-d.min;if(l.values.length<1||o<=0||h.delta<=0)return{fixed:d.min,value:()=>d.min,get:()=>d.min};let u=f=>d.min+f*o;if(c===n.QH.Quad){const f=Math.PI*(d.max/2)**2,y=Math.PI*(d.min/2)**2,x=f-y;u=v=>{let P=y+x*v;return Math.sqrt(P/Math.PI)*2}}const p=f=>{const y=l.values[f];let x=0;return y!==-1/0&&(x=(y-h.min)/h.delta),x>1?x=1:x<0&&(x=0),u(x)};return{get:p,value:()=>p((0,s.sB)(l)),field:l}}function g(l){return l||(l={min:0,max:1}),l.min==null&&(l.min=0),l.max==null&&(l.max=1),l}function i(l,d){let{min:c,max:h}=g(d);if(l||(l={}),l.max==null&&(l.max=h),l.min==null&&(l.min=c),l.min>l.max){const o=l.max;l.max=l.min,l.min=o}return l.min<c&&(l.min=c),l.max>h&&(l.max=h),l.fixed==null&&(l.fixed=l.min+(l.max-l.min)/2),l.field||(l.fixed>h?l.fixed=h:l.fixed<c&&(l.fixed=c)),l}},80744:(G,R,e)=>{"use strict";e.d(R,{Iu:()=>s,Iy:()=>g,QC:()=>r,nG:()=>n,zu:()=>a});var t=e(52622);const n=Object.freeze({fixed:"",mode:t.RU.Field,field:""});var s=(i=>(i.Icon="img/icons/unicons",i.IOT="img/icons/iot",i.Marker="img/icons/marker",i.BG="img/bg",i))(s||{}),a=(i=>(i.Icon="icon",i.Image="image",i))(a||{}),r=(i=>(i.Folder="folder",i.URL="url",i.Upload="upload",i))(r||{}),g=(i=>(i.SMALL="small",i.NORMAL="normal",i))(g||{})},33924:(G,R,e)=>{"use strict";e.d(R,{B_:()=>d,UI:()=>h,Wb:()=>g,XV:()=>i,b5:()=>l,gG:()=>o,sB:()=>m,wv:()=>c});var t=e(28240),n=e(75059),s=e(32264),a=e(63577),r=e(26781);function g(u,p){if(u?.series&&p.field)for(const f of u.series){const y=(0,a.getColorDimension)(f,p,s.$.theme2);if(!y.isAssumed||u.series.length===1)return y}return(0,a.getColorDimension)(void 0,p,s.$.theme2)}function i(u,p){if(u?.series&&p.field)for(const f of u.series){const y=(0,a.getScaledDimension)(f,p);if(!y.isAssumed||u.series.length===1)return y}return(0,a.getScaledDimension)(void 0,p)}function l(u,p){if(u?.series&&p.field)for(const f of u.series){const y=(0,r.H)(f,p);if(!y.isAssumed||u.series.length===1)return y}return(0,r.H)(void 0,p)}function d(u,p){if(u?.series&&p.field)for(const f of u.series){const y=(0,a.getResourceDimension)(f,p);if(!y.isAssumed||u.series.length===1)return y}return(0,a.getResourceDimension)(void 0,p)}function c(u,p){if(u?.series&&p.field)for(const f of u.series){const y=(0,a.getTextDimension)(f,p);if(!y.isAssumed||u.series.length===1)return y}return(0,a.getTextDimension)(void 0,p)}function h(u,p){const f=o(p,u);return f==null?void 0:u.fields[f]}function o(u,p,f){if(!(!p||!u?.length))for(let y=0;y<p.fields.length;y++){const x=p.fields[y];if(u===x.name)return y;const v=(0,t.Ct)(x,p,f);if(u===v)return y}}function m(u){const p=u.state?.calcs;if(p){const x=p[n.gy.lastNotNull];if(x!=null)return x}const f=u.values;let y=f.length-1;for(;y>=0;){const x=f[y--];if(x!=null)return x}}},9791:(G,R,e)=>{"use strict";e.d(R,{k:()=>C});var t=e(74848),n=e(2543),s=e(96540),a=e(28528),r=e(24293),g=e(90708),i=e(28240),l=e(94624),d=e(24308),c=e(52622),h=e(40845),o=e(79041),m=e(41706),u=e(91126),p=e(33368),f=e(1932);function y(b,T,S){return(0,f.jM)(b,O=>{O.defaults.custom===void 0&&(O.defaults.custom={}),O.defaults.max=S;const{custom:M}=O.defaults;switch(M.stacking===void 0&&(M.stacking={group:"A"}),T){case"lines":M.drawStyle=c.GR.Line,M.stacking.mode=c.gs.None,M.fillOpacity=0;break;case"bars":M.drawStyle=c.GR.Bars,M.stacking.mode=c.gs.None,M.fillOpacity=100;break;case"points":M.drawStyle=c.GR.Points,M.stacking.mode=c.gs.None,M.fillOpacity=0;break;case"stacked_lines":M.drawStyle=c.GR.Line,M.stacking.mode=c.gs.Normal,M.fillOpacity=100,M.axisSoftMin=0;break;case"stacked_bars":M.drawStyle=c.GR.Bars,M.stacking.mode=c.gs.Normal,M.fillOpacity=100,M.axisSoftMin=0;break;default:{const I=T;throw new Error(`Invalid graph-style: ${I}`)}}})}function x(b,T,S){return(0,f.jM)(b,O=>{O.defaults.thresholds=S,O.defaults.custom=O.defaults.custom??{},O.defaults.custom.thresholdsStyle=T})}var v=e(56737),P=e(84596),E=e(21423);function D(b){const[T,{inc:S}]=(0,v.A)(1),O=(0,P.A)(b);return(0,s.useMemo)(()=>{O&&!(0,E.J3)(b,O,E.bW)&&S()},[b,O,S]),T}function C({data:b,height:T,width:S,timeZone:O,timeRange:M,onChangeTime:I,loadingState:L,annotations:B,onHiddenSeriesChanged:j,splitOpenFn:A,graphStyle:K,tooltipDisplayMode:W=c.$N.Single,anchorToZero:U=!1,yAxisMaximum:F,thresholdsConfig:V,thresholdsStyle:w,eventBus:z,vizLegendOverrides:N,toggleLegendRef:H}){const Q=(0,h.$j)(),X=(0,s.useMemo)(()=>(0,a.O)((0,m.V)(m.S),"Explore"),[]),[ee,Z]=(0,s.useState)({defaults:{min:U?0:void 0,max:F||void 0,unit:"short",color:{mode:r.Y.PaletteClassic},custom:{drawStyle:c.GR.Line,fillOpacity:0,pointSize:5}},overrides:[]}),q=(0,s.useMemo)(()=>{const J=y(ee,K,F);return x(J,w,V)},[ee,K,F,V,w]),ae=(0,p.h)(A,M),k=(0,s.useMemo)(()=>(0,g.we)({fieldConfig:q,data:b,timeZone:O,replaceVariables:J=>J,theme:Q,fieldConfigRegistry:X,dataLinkPostProcessor:ae}),[X,b,O,Q,q,ae]),se=(0,s.useMemo)(()=>(0,g.we)({fieldConfig:{defaults:{},overrides:[]},data:B,timeZone:O,replaceVariables:J=>J,theme:Q,dataLinkPostProcessor:ae}),[B,O,Q,ae]),te=D(k),ne=(0,s.useRef)(j),le=(0,s.useRef)(void 0);(0,s.useEffect)(()=>{if(ne.current){const J=[];k.forEach(ce=>{ce.fields.map(xe=>xe.config?.custom?.hideFrom?.viz).every(n.identity)&&J.push((0,i.Ri)(ce))}),(le.current===void 0||!(0,n.isEqual)((0,n.sortBy)(J),(0,n.sortBy)(le.current)))&&(le.current=J,ne.current(J))}},[k]);const re={eventsScope:"explore",eventBus:z,sync:()=>l.y.Off,onToggleSeriesVisibility(J,ce){Z((0,u.M)(J,ce,ee,b))},dataLinkPostProcessor:ae};function de(J,ce){Z((0,u.M)(J,ce,ee,b))}H&&(H.current=de);const oe=(0,s.useMemo)(()=>({tooltip:{mode:W,sort:c.xB.None},legend:{displayMode:c.lm.List,showLegend:!0,placement:"bottom",calcs:[],...N}}),[W,N]);return(0,t.jsx)(o.XF,{value:re,children:(0,t.jsx)(d.m,{data:{series:k,timeRange:M,state:L,annotations:se,structureRev:te},pluginId:"timeseries",title:"",width:S,height:T,onChangeTimeRange:I,timeZone:O,options:oe})})}},72519:(G,R,e)=>{"use strict";e.d(R,{y:()=>b});var t=e(74848),n=e(32196),s=e(96540),a=e(42941),r=e(40845),g=e(91052),i=e(14578),l=e(56034),d=e(55852),c=e(8484),h=e(34028),o=e(9791),m=e(94354),u=e(31678);const p=u.EXPLORE_GRAPH_STYLES.map(S=>({value:S,label:S[0].toUpperCase()+S.slice(1).replace(/_/," ")}));function f(S){const{graphStyle:O,onChangeGraphStyle:M}=S;return(0,t.jsx)(m.z,{size:"sm",options:p,value:O,onChange:M})}var y=e(33390);const x="grafana.explore.style.graph",v=S=>{store.set(x,S)},P=()=>D(y.A.get(x)),E="lines",D=S=>u.EXPLORE_GRAPH_STYLES.find(M=>M===S)??E,C=20,b=({data:S,eventBus:O,height:M,width:I,timeRange:L,timeZone:B,annotations:j,onChangeTime:A,splitOpenFn:K,thresholdsConfig:W,thresholdsStyle:U,loadingState:F,statusMessage:V})=>{const[w,z]=(0,a.A)(!1),[N,H]=(0,s.useState)(P),Q=(0,r.of)(T),X=(0,s.useCallback)(Z=>{(0,h.ng)(Z),H(Z)},[]),ee=(0,s.useMemo)(()=>w?S:S.slice(0,C),[S,w]);return(0,t.jsx)(g.NR,{title:(0,c.t)("graph.container.title","Graph"),titleItems:[!w&&C<S.length&&(0,t.jsxs)("div",{className:Q.timeSeriesDisclaimer,children:[(0,t.jsxs)("span",{className:Q.warningMessage,children:[(0,t.jsx)(i.I,{name:"exclamation-triangle","aria-hidden":"true"}),(0,t.jsxs)(c.x6,{i18nKey:"graph.container.show-only-series",children:["Showing only ",{MAX_NUMBER_OF_TIME_SERIES:C}," series"]})]}),(0,t.jsx)(l.m,{content:(0,c.t)("graph.container.content","Rendering too many series in a single panel may impact performance and make data harder to read. Consider refining your queries."),children:(0,t.jsx)(d.$n,{variant:"secondary",size:"sm",onClick:z,children:(0,t.jsxs)(c.x6,{i18nKey:"graph.container.show-all-series",children:["Show all ",{length:S.length}]})})})]},"disclaimer")].filter(Boolean),width:I,height:M,loadingState:F,statusMessage:V,actions:(0,t.jsx)(f,{graphStyle:N,onChangeGraphStyle:X}),children:(Z,q)=>(0,t.jsx)(o.k,{graphStyle:N,data:ee,height:q,width:Z,timeRange:L,onChangeTime:A,timeZone:B,annotations:j,splitOpenFn:K,loadingState:F,thresholdsConfig:W,thresholdsStyle:U,eventBus:O})})},T=S=>({timeSeriesDisclaimer:(0,n.css)({label:"time-series-disclaimer",display:"flex",alignItems:"center",gap:S.spacing(1)}),warningMessage:(0,n.css)({display:"flex",alignItems:"center",gap:S.spacing(.5),color:S.colors.warning.main,fontSize:S.typography.bodySmall.fontSize})})},9651:(G,R,e)=>{"use strict";e.d(R,{a:()=>i,d:()=>l});var t=e(74848),n=e(32196),s=e(75212),a=e(40845),r=e(9663);const g=(d,c)=>({valueNavigation:(0,n.css)`
      width: ${r.QH};
      font-weight: bold;
    `,valueNavigationWrapper:(0,n.css)`
      display: flex;
      justify-content: flex-end;
    `,itemLabelsWrap:(0,n.css)`
      ${c?"":`border-bottom: 1px solid ${d.colors.border.medium}`};
    `}),i=d=>d.includes(s.gs)?d.replace(s.gs,""):d,l=({valueLabels:d,expanded:c})=>{const h=(0,a.of)(g,c);return(0,t.jsx)("div",{className:h.itemLabelsWrap,children:(0,t.jsx)("div",{className:h.valueNavigationWrapper,children:d.map((o,m)=>(0,t.jsx)("span",{className:h.valueNavigation,children:i(o.name)},o.name))})})}},9663:(G,R,e)=>{"use strict";e.d(R,{Ay:()=>P,QH:()=>p,Jd:()=>f});var t=e(74848),n=e(32196),s=e(73287),a=e(14110),r=e(40845),g=e(29158),i=e(9651),l=e(57408);const d=(E,D)=>({rowWrapper:(0,n.css)`
    position: relative;
    min-width: ${p};
    padding-right: 5px;
  `,rowValue:(0,n.css)`
    white-space: nowrap;
    overflow-x: auto;
    -ms-overflow-style: none; /* IE and Edge */
    scrollbar-width: none; /* Firefox */
    display: block;
    padding-right: 10px;

    &::-webkit-scrollbar {
      display: none; /* Chrome, Safari and Opera */
    }

    &:before {
      pointer-events: none;
      content: '';
      width: 100%;
      height: 100%;
      position: absolute;
      left: 0;
      top: 0;
      background: linear-gradient(to right, transparent calc(100% - 25px), ${E.colors.background.primary});
    }
  `,rowValuesWrap:(0,n.css)`
    padding-left: ${f};
    width: calc(${D} * ${p});
    display: flex;
  `}),c=({totalNumberOfValues:E,values:D,hideFieldsWithoutValues:C})=>{const b=(0,r.of)(d,E);return(0,t.jsx)("div",{role:"cell",className:b.rowValuesWrap,children:D?.map(T=>C&&(T.value===void 0||T.value===l.M)?null:(0,t.jsx)("span",{className:b.rowWrapper,children:(0,t.jsx)("span",{className:b.rowValue,children:T.value})},T.key))})},h=E=>{const D=E.isDark?"#ce9178":"#a31515",C=E.isDark?"#73bf69":"#56a64b";return{metricName:(0,n.css)`
      color: ${C};
    `,metricValue:(0,n.css)`
      color: ${D};
    `,expanded:(0,n.css)`
      display: block;
      text-indent: 1em;
    `}},m=({value:E,index:D,length:C,isExpandedView:b})=>{const T=(0,r.of)(h),S=E.key,O=E.value;return(0,t.jsxs)("span",{className:b?T.expanded:"",children:[(0,t.jsx)("span",{className:T.metricName,children:S}),(0,t.jsx)("span",{children:"="}),(0,t.jsx)("span",{children:'"'}),(0,t.jsx)("span",{className:T.metricValue,children:O}),(0,t.jsx)("span",{children:'"'}),D<C-1&&(0,t.jsx)("span",{children:", "})]},D)},u="20px",p="80px",f="25px",y=(E,D,C)=>({rowWrapper:(0,n.css)`
    border-bottom: 1px solid ${E.colors.border.medium};
    display: flex;
    position: relative;
    padding-left: 22px;
    ${C?"":"align-items: center;"}
    ${C?"":"height: 100%;"}
  `,copyToClipboardWrapper:(0,n.css)`
    position: absolute;
    left: 0;
    ${C?"":"bottom: 0;"}
    ${C?"top: 4px;":"top: 0;"}
    margin: auto;
    z-index: 1;
    height: 16px;
    width: 16px;
  `,rowLabelWrapWrap:(0,n.css)`
    position: relative;
    width: calc(100% - (${D} * ${p}) - ${f});
  `,rowLabelWrap:(0,n.css)`
    white-space: nowrap;
    overflow-x: auto;
    -ms-overflow-style: none; /* IE and Edge */
    scrollbar-width: none; /* Firefox */
    padding-right: ${u};

    &::-webkit-scrollbar {
      display: none; /* Chrome, Safari and Opera */
    }

    &:after {
      pointer-events: none;
      content: '';
      width: 100%;
      height: 100%;
      position: absolute;
      left: 0;
      top: 0;
      background: linear-gradient(
        to right,
        transparent calc(100% - ${u}),
        ${E.colors.background.primary}
      );
    }
  `});function x(E){let D=[],C=[];for(const b in E)b in E&&E[b]&&!b.includes("Value")?D.push({key:b,value:E[b]}):b in E&&E[b]&&b.includes("Value")&&C.push({key:b,value:E[b]});return{values:C,attributeValues:D}}const P=({listItemData:E,listKey:D,totalNumberOfValues:C,valueLabels:b,isExpandedView:T})=>{const{__name__:S,...O}=E,[M,I]=(0,s.A)(),L=b?.length??C,B=(0,r.of)(y,L,T),{values:j,attributeValues:A}=x(O),K=F=>F==="\u221E"||F==="Infinity"?"+Inf":F,W=`${S}{${A.map(F=>`${F.key}="${K(F.value)}"`)}}`,U=!!(b&&b?.length);return(0,t.jsxs)(t.Fragment,{children:[b!==void 0&&T&&(0,t.jsx)(i.d,{valueLabels:b,expanded:T}),(0,t.jsxs)("div",{className:B.rowWrapper,children:[(0,t.jsx)("span",{className:B.copyToClipboardWrapper,children:(0,t.jsx)(g.K,{tooltip:"Copy to clipboard",onClick:()=>{(0,a.rR)("grafana_explore_prometheus_instant_query_ui_raw_toggle_expand"),I(W)},name:"copy"})}),(0,t.jsx)("span",{role:"cell",className:B.rowLabelWrapWrap,children:(0,t.jsxs)("div",{className:B.rowLabelWrap,children:[(0,t.jsx)("span",{children:S}),(0,t.jsx)("span",{children:"{"}),(0,t.jsx)("span",{children:A.map((F,V)=>(0,t.jsx)(m,{isExpandedView:T,value:F,index:V,length:A.length},V))}),(0,t.jsx)("span",{children:"}"})]})}),(0,t.jsx)(c,{hideFieldsWithoutValues:U,totalNumberOfValues:L,values:j})]},D)]})}},57408:(G,R,e)=>{"use strict";e.d(R,{E:()=>s,M:()=>n});var t=e(83195);const n=" ",s=a=>{const r={},g=[],i=a.fields.filter(c=>!["Time"].includes(c.name));let l=i.find(c=>c.name==="__name__")?.values??[];!l.length&&i.length&&i[0].values.length&&(l=Array(i[0].values.length).fill(""));const d=a.fields.filter(c=>!["__name__"].includes(c.name));return l.forEach(function(c,h){r[c]={};const o=r[c][h]??{};for(const m of d){const u=m.name;if(u!=="Time")if(typeof m?.display=="function"){const p=m?.display(m.values[h]);if(!isNaN(p.numeric))o[u]=p.numeric.toString(10);else{const f=(0,t.cN)(p);f?o[u]=f:u.includes("Value #")&&(o[u]=n)}}else console.warn("Field display method is missing!")}g.push({...o,__name__:c})}),g}},97814:(G,R,e)=>{"use strict";e.d(R,{g:()=>s});var t=e(74848),n=e(47232);const s=({timeInMs:r,className:g,humanize:i})=>(0,t.jsx)("span",{className:g,children:a(r,i)}),a=(r,g=!1)=>{const i=r/1e3;if(!g)return`${i.toFixed(1)}s`;const l=(0,n.Ah)(i,"seconds"),d=l.hours(),c=l.minutes(),h=l.seconds();return d?`${d}h ${c}m ${h}s`:c?`${c}m ${h}s`:`${h}s`}},11140:(G,R,e)=>{"use strict";e.d(R,{v:()=>B});var t=e(74848),n=e(2543),s=e(96540),a=e(49785),r=e(71733),g=e(14110),i=e(39601),l=e(32264),d=e(88575),c=e(94354),h=e(42418),o=e(37390),m=e(55852),u=e(59429),p=e(16233),f=e(20470),y=e(31678),x=e(9955),v=e(28676),P=e(71176),E=(j=>(j.FETCH_DASHBOARD="fetch-dashboard",j.SET_DASHBOARD_LS="set-dashboard-ls-error",j))(E||{});function D(j,A){let K=[];return j==="table"&&A.panelState?.logs?.columns&&(A.panelState.logs?.labelFieldName&&K.push({id:"extractFields",options:{source:A.panelState.logs.labelFieldName}}),K.push({id:"organize",options:{indexByName:Object.values(A.panelState.logs.columns).reduce((W,U,F)=>({...W,[U]:F}),{}),includeByName:Object.values(A.panelState.logs.columns).reduce((W,U)=>({...W,[U]:!0}),{})}})),K}async function C(j){const A=S(j.queries,j.queryResponse,j?.panelState),K={targets:j.queries,type:A,title:"New Panel",gridPos:{x:0,y:0,w:12,h:8},datasource:j.datasource,transformations:D(A,j)};let W;if(j.dashboardUid)try{W=await(0,v.n)().getDashboardDTO(j.dashboardUid)}catch{throw"fetch-dashboard"}else W=await(0,P.X)();W.dashboard.panels=[K,...W.dashboard.panels??[]],W.dashboard.time=j.time;try{(0,f.OI)(W)}catch{throw"set-dashboard-ls-error"}}const b=j=>!j.hide,T=j=>A=>A.refId===j;function S(j,A,K){for(const{refId:W}of j.filter(b)){const U=T(W);if(A.flameGraphFrames.some(U))return"flamegraph";if(A.graphFrames.some(U))return"timeseries";if(A.logsFrames.some(U))return K?.logs?.visualisationType?K.logs.visualisationType:"logs";if(A.nodeGraphFrames.some(U))return"nodeGraph";if(A.traceFrames.some(U))return"traces";if(A.customFrames.some(U))return A.customFrames.find(U)?.meta?.preferredVisualisationPluginId??"table"}return"table"}var O=(j=>(j.NewDashboard="new-dashboard",j.ExistingDashboard="existing-dashboard",j))(O||{});function M(j){}function I(j){return j?`d/${j}`:"dashboard/new"}var L=(j=>(j.UNKNOWN="unknown-error",j.NAVIGATION="navigation-error",j))(L||{});function B(j){const{exploreId:A,onClose:K}=j,W=(0,y.useSelector)((0,x.qq)(A)),[U,F]=(0,s.useState)(),{handleSubmit:V,control:w,formState:{errors:z},watch:N}=(0,a.mN)({defaultValues:{saveTarget:"new-dashboard"}}),H=p.TP.hasPermission(y.AccessControlAction.DashboardsCreate),Q=p.TP.hasPermission(y.AccessControlAction.DashboardsWrite),X=[];H&&X.push({label:"New dashboard",value:"new-dashboard"}),Q&&X.push({label:"Existing dashboard",value:"existing-dashboard"});const ee=X.length>1?N("saveTarget"):X[0].value,Z=async(q,ae)=>{F(void 0);const k=ae.saveTarget==="existing-dashboard"?ae.dashboardUid:void 0;(0,g.rR)("e_2_d_submit",{newTab:q,saveTarget:ae.saveTarget,queries:W.queries.length});const{from:se,to:te}=W.range.raw;try{await C({dashboardUid:k,datasource:W.datasourceInstance?.getRef(),queries:W.queries,queryResponse:W.queryResponse,panelState:W?.panelsState,time:{from:typeof se=="string"?se:se.toISOString(),to:typeof te=="string"?te:te.toISOString()}})}catch(re){switch(re){case E.FETCH_DASHBOARD:F({error:re,message:"Could not fetch dashboard information. Please try again."});break;case E.SET_DASHBOARD_LS:F({error:re,message:"Could not add panel to dashboard. Please try again."});break;default:F({error:"unknown-error",message:"Something went wrong. Please try again."})}return}const ne=I(k);if(!q){K(),i.Ny.push(r.I.stripBaseFromUrl(ne));return}if(!!!e.g.open(l.$.appUrl+ne,"_blank")){F({error:"navigation-error",message:"Could not navigate to the selected dashboard. Please try again."}),(0,f.yZ)();return}K()};return(0,s.useEffect)(()=>{(0,g.rR)("e_2_d_open")},[]),(0,t.jsxs)("form",{children:[X.length>1&&(0,t.jsx)(a.xI,{control:w,render:({field:{ref:q,...ae}})=>(0,t.jsx)(d.D,{label:"Target dashboard",description:"Choose where to add the panel.",children:(0,t.jsx)(c.z,{options:X,...ae,id:"e2d-save-target"})}),name:"saveTarget"}),ee==="existing-dashboard"&&(0,t.jsx)(a.xI,{render:({field:{ref:q,value:ae,onChange:k,...se}})=>(0,t.jsx)(d.D,{label:"Dashboard",description:"Select in which dashboard the panel will be created.",error:z.dashboardUid?.message,invalid:!!z.dashboardUid,children:(0,t.jsx)(u.b,{...se,inputId:"e2d-dashboard-picker",defaultOptions:!0,onChange:te=>k(te?.uid)})}),control:w,name:"dashboardUid",shouldUnregister:!0,rules:{required:{value:!0,message:"This field is required."}}}),U&&(0,t.jsx)(h.F,{severity:"error",title:"Error adding the panel",children:U.message}),(0,t.jsxs)(o.a.ButtonRow,{children:[(0,t.jsx)(m.$n,{type:"reset",onClick:K,fill:"outline",variant:"secondary",children:"Cancel"}),(0,t.jsx)(m.$n,{type:"submit",variant:"secondary",onClick:V((0,n.partial)(Z,!0)),icon:"external-link-alt",children:"Open in new tab"}),(0,t.jsx)(m.$n,{type:"submit",variant:"primary",onClick:V((0,n.partial)(Z,!1)),icon:"apps",children:"Open dashboard"})]})]})}},12881:(G,R,e)=>{"use strict";e.d(R,{t:()=>s});var t=e(16233),n=e(31678);function s(){const a=t.TP.hasPermission(n.AccessControlAction.DashboardsCreate),r=t.TP.hasPermission(n.AccessControlAction.DashboardsWrite);return a&&!r?"Add panel to new dashboard":r&&!a?"Add panel to existing dashboard":"Add panel to dashboard"}},24401:(G,R,e)=>{"use strict";e.d(R,{s:()=>i});var t=e(74848),n=e(71733),s=e(39601),a=e(37390),r=e(67061),g=e(55852);function i(l){const{onDismiss:d,path:c,title:h}=l,o=()=>{e.g.open(n.I.assureBaseUrl(c),"_blank"),d()},m=()=>s.Ny.push(c);return(0,t.jsxs)(a.a,{title:h,isOpen:!0,onDismiss:d,children:[(0,t.jsx)(r.B,{direction:"column",gap:1,children:(0,t.jsx)("p",{children:"Do you want to proceed in the current tab or open a new tab?"})}),(0,t.jsxs)(a.a.ButtonRow,{children:[(0,t.jsx)(g.$n,{onClick:d,fill:"outline",variant:"secondary",children:"Cancel"}),(0,t.jsx)(g.$n,{type:"submit",variant:"secondary",onClick:o,icon:"external-link-alt",children:"Open in new tab"}),(0,t.jsx)(g.$n,{type:"submit",variant:"primary",onClick:m,icon:"apps",children:"Open"})]})]})}},30973:(G,R,e)=>{"use strict";e.d(R,{w:()=>r});var t=e(74848),n=e(96540),s=e(38138),a=e(75462);function r({extensions:l,onSelect:d}){const{categorised:c,uncategorised:h}=i(l),o=h.length>0&&Object.keys(c).length>0;return(0,t.jsx)(s.W,{children:(0,t.jsxs)(t.Fragment,{children:[Object.keys(c).map(m=>(0,t.jsx)(s.W.Group,{label:(0,a.pL)(m,25),children:g(c[m],d)},m)),o&&(0,t.jsx)(s.W.Divider,{},"divider"),g(h,d)]})})}function g(l,d){return l.map(c=>(0,t.jsx)(s.W.Item,{ariaLabel:c.title,icon:c?.icon||"plug",label:(0,a.pL)(c.title,25),onClick:h=>{if(c.path)return d(c);c.onClick?.(h)}},c.id))}function i(l){return(0,n.useMemo)(()=>{const d=[],c={};for(const h of l){if(!h.category){d.push(h);continue}Array.isArray(c[h.category])||(c[h.category]=[]),c[h.category].push(h)}return{uncategorised:d,categorised:c}},[l])}},33368:(G,R,e)=>{"use strict";e.d(R,{h:()=>s});var t=e(96540),n=e(96192);const s=(a,r)=>(0,t.useMemo)(()=>(0,n.YV)(a,r),[a,r])},39590:(G,R,e)=>{"use strict";e.d(R,{m:()=>X,s:()=>Z});var t=e(96540),n=e(76888),s=e(3169),a=e(31678),r=e(9955),g=e(34028);const i={parse:q=>{if(!q.left&&!q.right)return{to:{left:{datasource:null,queries:[],range:{from:g.kn.from,to:g.kn.to}},schemaVersion:0},error:!1};let ae,k,se,te;return typeof q.left=="string"&&([ae,se]=h(q.left)),typeof q.right=="string"?[k,te]=h(q.right):q.right&&(k=c,te=!0),ae||(ae=c),{to:{schemaVersion:0,left:ae,...k&&{right:k}},error:!!se||!!te}}},l=(q,...ae)=>ae.some(k=>q.hasOwnProperty(k));var d=(q=>(q[q.RangeFrom=0]="RangeFrom",q[q.RangeTo=1]="RangeTo",q[q.Datasource=2]="Datasource",q[q.SegmentsStart=3]="SegmentsStart",q))(d||{});const c={datasource:null,queries:[],range:g.kn};function h(q){let ae;try{ae=JSON.parse(q)}catch{return[c,!0]}if(!Array.isArray(ae))return[{queries:[],range:g.kn,...ae},!1];if(ae.length<=3)return[c,!0];const k={from:ae[0],to:ae[1]},se=ae[2],te=ae.slice(3),ne=te.filter(re=>!l(re,"ui","mode","__panelsState")),le=te.find(re=>l(re,"__panelsState"))?.__panelsState;return[{datasource:se,queries:ne,range:k,panelsState:le},!1]}var o=e(87490),m=e(15961);const u={parse:q=>{if(!q||!q.panes||typeof q.panes!="string")return{to:{schemaVersion:1,panes:{[(0,o.o$)()]:p}},error:!1};let ae;try{ae=JSON.parse(q.panes)}catch{}if(ae==null||typeof ae!="object")return{to:{schemaVersion:1,panes:{[(0,o.o$)()]:p}},error:!0};const k=Object.entries(ae).map(([se,te])=>[se,f(te)]).reduce((se,[te,ne])=>{let le=te;return(le.length!==3||/^\d+$/.test(le)||le.split("").some(re=>o.WP.indexOf(re)===-1))&&(le=(0,o.o$)()),{...se,[le]:ne}},{});return Object.keys(k).length||(k[(0,o.o$)()]=p),{to:{schemaVersion:1,panes:k},error:!1}},migrate:q=>({schemaVersion:1,panes:{[(0,o.o$)()]:q.left,...q.right&&{[(0,o.o$)()]:q.right}}})},p={datasource:null,queries:[],range:g.kn};function f(q){return!q||typeof q!="object"?p:{...p,...(0,m.C)("queries",q)&&Array.isArray(q.queries)&&{queries:q.queries},...(0,m.C)("datasource",q)&&typeof q.datasource=="string"&&{datasource:q.datasource},...(0,m.C)("panelsState",q)&&!!q.panelsState&&typeof q.panelsState=="object"&&{panelsState:q.panelsState},...(0,m.C)("range",q)&&!!q.range&&typeof q.range=="object"&&(0,m.C)("from",q.range)&&(0,m.C)("to",q.range)&&typeof q.range.from=="string"&&typeof q.range.to=="string"&&{range:{from:q.range.from,to:q.range.to}}}}const y=q=>v(q),x=[i,u],v=q=>{const ae=P(q),[k,...se]=x.slice(ae),{error:te,to:ne}=k.parse(q);return[se.reduce((re,de)=>de.migrate?de.migrate(re):re,ne),te]};function P(q){return!q||!("schemaVersion"in q)||!q.schemaVersion?0:typeof q.schemaVersion=="number"?q.schemaVersion:typeof q.schemaVersion=="string"?Number.parseInt(q.schemaVersion,10):0}var E=e(2543),D=e(18226),C=e(62860),b=e(62256),T=e(29436),S=e(23994),O=e(89224),M=e(27649),I=e(39070),L=e(41987),B=e(31193),j=e(14678);const A=(q,ae)=>{const k=!(0,E.isEqual)(ae?.datasource,q?.datasource),se=!(0,E.isEqual)(ae?.queries,q?.queries),te=!(0,E.isEqual)(ae?.range||g.kn,q?.range||g.kn),ne=!(0,E.isEqual)(ae?.panelsState,q?.panelsState);return{datasource:k,queries:se,range:te,panelsState:ne}};async function K(q,ae,k){if(q)try{return await(0,B.tR)().get(q)}catch{}const se=[...new Set(ae.map(te=>te.datasource).filter(I.zz).map(te=>typeof te=="string"?te:te.uid))];try{if(se.length>=1){const te=(await Promise.allSettled(se.map(ne=>(0,B.tR)().get(ne)))).filter(m.s);if(te.length>1)return await(0,B.tR)().get(j.uv);if(te.length===1)return await(0,B.tR)().get(se[0])}}catch{}return(0,B.tR)().get((0,o.HQ)(k)).catch(()=>(0,B.tR)().get()).catch(()=>{})}function W(q){return{...q.getDefaultQuery?.(L.Jk.Explore),refId:"A",datasource:q.getRef()}}function U(q){return q.name===j.uv}function F(q){return q&&U(q)?ae=>!!ae.datasource:ae=>ae.datasource?typeof ae.datasource=="string"?ae.datasource===q?.uid||ae.datasource===q?.name:ae.datasource.uid===q?.uid:!0}async function V(q){return(await Promise.allSettled(q.map(k=>(0,B.tR)().get(k.datasource).then(se=>({query:k,ds:se}))))).filter(m.s).map(({value:k})=>k.query)}function w(q,ae,k){const se=Object.values(q.panes);if(se.length>1){const te=se.some(({range:ne},le,[{range:re}])=>!(0,E.isEqual)(ne,re));k((0,T.qz)({syncedTimes:!te}))}Object.entries(q.panes).forEach(async([te,ne],le)=>{const{datasource:re,queries:de,range:oe,panelsState:J}=ne,ce=ae[te];if(ce!==void 0){const pe=A(ne,X(ce));Promise.resolve().then(async()=>{pe.datasource&&re&&await k((0,C.wh)({exploreId:te,datasource:re}))}).then(async()=>{pe.range&&k((0,O.JA)({exploreId:te,rawRange:(0,g.Z9)(oe)})),pe.queries&&k((0,S.h9)({exploreId:te,queries:(0,M.v)(de)})),(pe.queries||pe.range)&&(await k((0,S.hS)(te)),k((0,S.Od)({exploreId:te}))),pe.panelsState&&J&&k((0,b.fx)({exploreId:te,panelsState:J}))})}else k((0,b.Gd)({exploreId:te,datasource:re||"",queries:(0,M.v)(de),range:(0,g.Z9)(oe),panelsState:J,position:le,eventBridge:new D.o}))}),Object.keys(ae).filter(te=>!Object.keys(q.panes).includes(te)).forEach(te=>k((0,T.J8)(te)))}function z(q,ae,k,se,te){se((0,T.Ve)()),Promise.all(Object.entries(q.panes).map(([ne,{datasource:le,queries:re,range:de,panelsState:oe}])=>K(le,re,k).then(J=>Promise.resolve(J?re.length?(0,M.v)(re).filter(F(J)).map(U(J)?E.identity:ce=>({...ce,datasource:J.getRef()})):(0,B.tR)().get(U(J)?void 0:J.getRef()).then(ce=>[W(ce)]):[]).then(async ce=>{let pe=await V(ce);return!pe.length&&J&&(pe=[W(U(J)?await(0,B.tR)().get():J)]),{exploreId:ne,range:de,panelsState:oe,queries:pe,datasource:J}})))).then(async ne=>{const le=await Promise.all(ne.map(({exploreId:ce,range:pe,panelsState:xe,queries:fe,datasource:Ee})=>se((0,b.Gd)({exploreId:ce,datasource:Ee,queries:fe,range:(0,g.Z9)(pe),panelsState:xe,eventBridge:new D.o})).unwrap()));if(le.length>1){const ce=le.some(({state:pe},xe,[{state:fe}])=>!(0,E.isEqual)(pe.range.raw,fe.range.raw));se((0,T.qz)({syncedTimes:!ce}))}const re=le.reduce((ce,{exploreId:pe,state:xe})=>({...ce,[pe]:X(xe)}),{}),de=te.getSearchObject();let oe={};for(const[ce,pe]of Object.entries(de).filter(([xe])=>!["schemaVersion","panes","orgId","left","right"].includes(xe)))oe[ce]=pe;const J=new URLSearchParams({schemaVersion:`${q.schemaVersion}`,panes:JSON.stringify(re),orgId:`${k}`,...oe});te.replace({pathname:te.getLocation().pathname,search:J.toString()}),ae.current="done"})}function N(q,ae){return q.current=C.wh.pending.type===ae.type,[T.J8.type,T.ve.fulfilled.type,S.Od.pending.type,O.eM.type,b.fx.type,C.wh.fulfilled.type].includes(ae.type)&&!q.current}function H(q,ae,k,se){const te=Object.entries(q.panes).reduce((ne,[le,re])=>re?{...ne,[le]:X(re)}:ne,{});if(!(0,E.isEqual)(ae.current.panes,JSON.stringify(te))){const ne=!!ae.current.panes&&Object.values(ae.current.panes).filter(Boolean).length===0||k.current==="pending";ae.current={panes:JSON.stringify(te)},se.partial({panes:ae.current.panes},ne)}}var Q=e(76885);function X(q){return{datasource:q.datasourceInstance?.uid||"",queries:q.queries.map(o.w4),range:(0,Q.sQ)(q.range.raw),panelsState:ee(q.panelsState)}}function ee(q){let ae=(0,E.mapValues)(q,k=>(0,E.isObject)(k)?ee(k):k);if(ae=(0,E.omitBy)(ae,E.isEmpty),!(0,E.isEmpty)(ae))return ae}function Z(q){const{location:ae}=(0,n.Il)(),k=(0,a.useDispatch)(),se=(0,a.useSelector)(r.Qb),te=(0,t.useRef)(se),ne=(0,a.useSelector)(J=>J.user.orgId),le=(0,t.useRef)(q),re=(0,t.useRef)("notstarted"),de=(0,t.useRef)(!1),{warning:oe}=(0,s._2)();(0,t.useEffect)(()=>{q.panes||(re.current="notstarted",le.current=q)},[q]),(0,t.useEffect)(()=>{const J=k((0,a.addListener)({predicate:ce=>N(de,ce),effect:async(ce,{cancelActiveListeners:pe,delay:xe,getState:fe})=>{pe(),await xe(200),H(fe().explore,le,re,ae)}}));return()=>J()},[k,ae]),(0,t.useEffect)(()=>{te.current=se},[se]),(0,t.useEffect)(()=>{const J=le.current?.panes!==q.panes,[ce,pe]=y(q);pe&&oe("Could not parse Explore URL","The requested URL contains invalid parameters, a default Explore state has been loaded."),!J&&re.current==="notstarted"&&(re.current="pending",z(ce,re,ne,k,ae)),le.current=q,J&&re.current==="done"&&w(ce,te.current,k)},[k,ne,ae,q,oe])}},15961:(G,R,e)=>{"use strict";e.d(R,{C:()=>n,s:()=>t});const t=s=>s.status==="fulfilled";function n(s,a){return s in a}},324:(G,R,e)=>{"use strict";e.d(R,{M:()=>h,v:()=>m});var t=e(88483),n=e(19347),s=e(14110),a=e(82467),r=e(3169),g=e(18380),i=e(99140),l=e(62256),d=e(29436),c=e(23994);const h=u=>new t.c(p=>{const f=i.M_.getState().explore.panes[u]?.correlations;if(f)p.next(f),p.complete();else{const y=i.M_.subscribe(()=>{const x=i.M_.getState().explore.panes[u]?.correlations;x&&(y(),p.next(x),p.complete())})}});function o(u){return async(p,f)=>{const y=f().explore.panes[u];if(y.datasourceInstance?.uid!==void 0){let x=y.datasourceInstance.meta.mixed?y.queries.map(P=>P.datasource?.uid).filter(P=>P!==null):[y.datasourceInstance.uid];const v=await(0,g.J6)(x);p((0,l.Fb)({exploreId:u,correlations:v.correlations||[]}))}}}function m(u,p,f){return async(y,x)=>{const v=Object.keys(x().explore?.panes),P=x().explore?.panes[v[0]],E=x().explore?.panes[v[1]];if(!P||!E)return;const D=P.datasourceInstance?.meta.mixed?P.queries[0].datasource:P.datasourceInstance?.getRef(),C=E.datasourceInstance?.meta.mixed?E.queries[0].datasource:E.datasourceInstance?.getRef(),[b,T]=await Promise.all([(0,n.l)().get(D),(0,n.l)().get(C)]);if(b?.uid&&T?.uid&&E.correlationEditorHelperData?.resultField){const S={sourceUID:b.uid,targetUID:T.uid,label:u||await(0,g.tZ)(P,E),description:p,type:"query",config:{field:E.correlationEditorHelperData.resultField,target:E.queries[0],transformations:f}};await(0,g.$q)(b.uid,S).then(async()=>{y((0,d.J8)(v[1])),await y(o(v[0])),await y((0,c.Od)({exploreId:v[0]})),(0,s.rR)("grafana_explore_correlation_editor_saved",{sourceDatasourceType:b.type,targetDataSourceType:T.type})}).catch(O=>{y((0,a.dx)((0,r.gi)("Error creating correlation",O))),console.error(O)})}}}},62860:(G,R,e)=>{"use strict";e.d(R,{YR:()=>u,wh:()=>m});var t=e(65307),n=e(14110),s=e(11134),a=e(87490),r=e(18380),g=e(31678),i=e(57288),l=e(62256),d=e(23994),c=e(89224),h=e(34028);const o=(0,t.VP)("explore/updateDatasourceInstance"),m=(0,g.createAsyncThunk)("explore/changeDatasource",async({datasource:p,exploreId:f,options:y},{getState:x,dispatch:v})=>{const P=x().user.orgId,{history:E,instance:D}=await(0,h.BE)(P,p),C=x().explore.panes[f].datasourceInstance;(0,n.rR)("explore_change_ds",{from:(C?.meta?.mixed?"mixed":C?.type)||"unknown",to:D.meta.mixed?"mixed":D.type,exploreId:f}),v(o({exploreId:f,datasourceInstance:D,history:E}));const b=x().explore.panes[f].queries,T=(0,h.dq)(D.uid,b),S=await(0,r.J6)(T);v((0,l.Fb)({exploreId:f,correlations:S.correlations||[]})),y?.importQueries&&await v((0,d.y2)(f,b,C,D)),x().explore.panes[f].isLive&&v((0,c.hO)({exploreId:f,refreshInterval:s.cC.offOption.value})),y?.importQueries&&v((0,d.Od)({exploreId:f}))}),u=(p,f)=>{if(o.match(f)){const{datasourceInstance:y,history:x}=f.payload;return(0,a._u)(p.querySubscription),{...p,datasourceInstance:y,graphResult:null,tableResult:null,logsResult:null,supplementaryQueries:(0,i.Ez)(),queryResponse:(0,h.RA)(),queryKeys:[],history:x}}return p}},62256:(G,R,e)=>{"use strict";e.d(R,{EA:()=>o,Fb:()=>f,Gd:()=>x,LJ:()=>v,QZ:()=>y,fx:()=>h,nE:()=>m});var t=e(65307),n=e(87490),s=e(18380),a=e(32901),r=e(31678),g=e(62860),i=e(23994),l=e(89224),d=e(34028);const c=(0,t.VP)("explore/changeSize"),h=(0,t.VP)("explore/changePanels");function o(P,E,D){return async(C,b)=>{const T=b().explore.panes[P];if(T===void 0)return;const{panelsState:S}=T;C(h({exploreId:P,panelsState:{...S,[E]:D}}))}}const m=(0,t.VP)("explore/changeCorrelationHelperData"),u=(0,t.VP)("explore/initializeExploreAction"),p=(0,t.VP)("explore/setUrlReplaced"),f=(0,t.VP)("explore/saveCorrelationsAction");function y(P,{width:E}){return c({exploreId:P,width:E})}const x=(0,r.createAsyncThunk)("explore/initializeExplore",async({exploreId:P,datasource:E,queries:D,range:C,panelsState:b,correlationHelperData:T,eventBridge:S},{dispatch:O,getState:M,fulfillWithValue:I})=>{let L,B=[];if(E){const j=M().user.orgId,A=await(0,d.BE)(j,E);L=A.instance,B=A.history}if(O(u({exploreId:P,queries:D,range:(0,d.eO)(C,(0,a.O)(M().user)),datasourceInstance:L,history:B,eventBridge:S})),b!==void 0&&O(h({exploreId:P,panelsState:b})),O((0,l.JA)({exploreId:P})),L){const j=(0,d.dq)(L.uid,D),A=await(0,s.J6)(j);O(f({exploreId:P,correlations:A.correlations||[]})),O((0,i.Od)({exploreId:P}))}return T!==void 0&&M().explore.correlationEditorDetails?.editorMode&&O(m({exploreId:P,correlationEditorHelperData:T})),I({exploreId:P,state:M().explore.panes[P]})}),v=(P=(0,d.HZ)(),E)=>{if(P=(0,i.JQ)(P,E),P=(0,g.YR)(P,E),P=(0,l.QP)(P,E),c.match(E)){const D=E.payload.width;return{...P,containerWidth:D}}if(h.match(E)){const{panelsState:D}=E.payload;return{...P,panelsState:D}}if(m.match(E)){const{correlationEditorHelperData:D}=E.payload;return{...P,correlationEditorHelperData:D}}if(f.match(E))return{...P,correlations:E.payload.correlations};if(u.match(E)){const{queries:D,range:C,datasourceInstance:b,history:T,eventBridge:S}=E.payload;return{...P,range:C,queries:D,initialized:!0,eventBridge:S,queryKeys:(0,n.dY)(D),datasourceInstance:b,history:T,queryResponse:(0,d.RA)(),cache:[],correlations:[]}}return P}},72433:(G,R,e)=>{"use strict";e.d(R,{Bj:()=>y,H9:()=>d,PA:()=>p,Uu:()=>m,VM:()=>c,fP:()=>f,jX:()=>o,ri:()=>i,s1:()=>h,sh:()=>l,wk:()=>u});var t=e(65307),n=e(81523),s=e(11401),a=e(29436);const r=(0,t.VP)("explore/historyUpdated"),g=({updatedQuery:x,deletedId:v})=>async(P,E)=>{const D=E().explore.richHistory,C=D.map(T=>T.id===x?.id?x:T).filter(T=>T.id!==v),b=D.length-C.length;P((0,a.U2)({richHistoryResults:{richHistory:C,total:E().explore.richHistoryTotal-b}}))},i=(x,v,P,E,D)=>async(C,b)=>{const T=D?{quotaExceededError:!1,limitExceededWarning:!1,otherErrors:!1}:{quotaExceededError:!b().explore.richHistoryStorageFull,limitExceededWarning:!b().explore.richHistoryLimitExceededWarningShown},{richHistoryStorageFull:S,limitExceeded:O}=await(0,n.l0)({localOverride:x,datasource:{uid:v,name:P},queries:E,starred:!1,showNotif:T});D||(S&&C((0,a.fj)()),O&&C((0,a.D)()))},l=(x,v)=>async(P,E)=>{const D=await(0,n.oU)(x,v);P(g({updatedQuery:D}))},d=(x,v)=>async P=>{const E=await(0,n.cX)(x,v);P(g({updatedQuery:E}))},c=x=>async v=>{const P=await(0,n.NC)(x);v(g({deletedId:P}))},h=()=>async x=>{await(0,n.X1)(),x((0,a.U2)({richHistoryResults:{richHistory:[],total:0}})),x((0,a.U2)({richHistoryResults:{richHistory:[],total:0}}))},o=()=>async(x,v)=>{const P=v().explore.richHistorySearchFilters;if(P){const E=await(0,n.DI)(P);x((0,a.U2)({richHistoryResults:E}))}},m=()=>async(x,v)=>{const P=v().explore.richHistorySearchFilters,E=v().explore.richHistory;if(P&&E){const D={...P,page:(P?.page||1)+1},C=await(0,n.DI)(D),b=[...E,...C.richHistory];x((0,a.Ju)({filters:D})),x((0,a.U2)({richHistoryResults:{richHistory:b,total:C.total}}))}},u=()=>async x=>{x((0,a.Ju)({filters:void 0})),x((0,a.U2)({richHistoryResults:{richHistory:[],total:0}}))},p=()=>async(x,v)=>{let P=v().explore.richHistorySettings;P||(P=await(0,n.Gx)(),x((0,a.bZ)(P)))},f=x=>async v=>{v((0,a.bZ)(x)),await(0,n.rs)(x)},y=x=>async(v,P)=>{await v((0,a.Ju)({filters:{...x}}));const E=P().explore.richHistorySettings;(0,s.gQ)().lastUsedDataSourcesAvailable&&await v(f({...E,lastUsedDatasourceFilters:x.datasourceFilters}))}},29436:(G,R,e)=>{"use strict";e.d(R,{Ay:()=>B,D:()=>p,J8:()=>E,JA:()=>P,Ju:()=>y,U2:()=>m,Ve:()=>C,am:()=>S,bZ:()=>f,fj:()=>u,nD:()=>x,ow:()=>O,qz:()=>o,tP:()=>v,ve:()=>b});var t=e(65307),n=e(2543),s=e.n(n),a=e(18226),r=e(39601),g=e(87490),i=e(23989),l=e(31678),d=e(27649),c=e(62256),h=e(34028);const o=(0,t.VP)("explore/syncTimes"),m=(0,t.VP)("explore/richHistoryUpdated"),u=(0,t.VP)("explore/richHistoryStorageFullAction"),p=(0,t.VP)("explore/richHistoryLimitExceededAction"),f=(0,t.VP)("explore/richHistorySettingsUpdated"),y=(0,t.VP)("explore/richHistorySearchFiltersUpdatedAction"),x=(0,t.VP)("explore/splitSizeUpdateAction"),v=(0,t.VP)("explore/maximizePaneAction"),P=(0,t.VP)("explore/evenPaneResizeAction"),E=(0,t.VP)("explore/splitClose"),D=(0,t.VP)("explore/setPaneState"),C=(0,t.VP)("explore/clearPanes"),b=(0,l.createAsyncThunk)("explore/splitOpen",async(j,{getState:A,dispatch:K})=>{const W=Object.values(A().explore.panes)[0],U=j?.queries??W?.queries??[];Object.keys(A().explore.panes).forEach((w,z)=>{z>=1&&K(E(w))});const F=j?.range||W?.range.raw||h.kn;let V=(0,g.o$)();for(;A().explore.panes[V];)V=(0,g.o$)();await K(T({exploreId:V,datasource:j?.datasourceUid||W?.datasourceInstance?.getRef(),queries:(0,d.v)(U),range:F,panelsState:j?.panelsState||W?.panelsState,correlationHelperData:j?.correlationHelperData,eventBridge:new a.o})),W?.range&&await K(o({syncedTimes:(0,n.isEqual)(W.range.raw,F)}))}),T=(0,l.createAsyncThunk)("explore/createNewSplitOpen",async(j,{dispatch:A})=>{await A((0,c.Gd)(j))}),S=(0,t.VP)("explore/changeCorrelationEditorDetails"),O=(j,A)=>async K=>{const{timeRange:W,getExploreUrl:U,openInNewWindow:F}=A,V=await U({queries:j.targets,dsRef:j.datasource,scopedVars:j.scopedVars,timeRange:W,adhocFilters:(0,i.w)().getAdhocFilters(j.datasource?.uid??"",!0)});if(F&&V){F(V);return}r.Ny.push(V)},M=(0,h.HZ)(),I={syncedTimes:!1,panes:{},correlationEditorDetails:{editorMode:!1,correlationDirty:!1,queryEditorDirty:!1,isExiting:!1},richHistoryStorageFull:!1,richHistoryLimitExceededWarningShown:!1,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0,richHistory:[]},B={explore:(j=I,A)=>{if(E.match(A)){const{[A.payload]:W,...U}={...j.panes};return{...j,panes:U,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0,syncedTimes:!1}}if(x.match(A)){const{largerExploreId:W}=A.payload;return{...j,largerExploreId:W,maxedExploreId:void 0,evenSplitPanes:W===void 0}}if(v.match(A)){const{exploreId:W}=A.payload;return{...j,largerExploreId:W,maxedExploreId:W,evenSplitPanes:!1}}if(P.match(A))return{...j,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0};if(o.match(A))return{...j,syncedTimes:A.payload.syncedTimes};if(u.match(A))return{...j,richHistoryStorageFull:!0};if(p.match(A))return{...j,richHistoryLimitExceededWarningShown:!0};if(f.match(A)){const W=A.payload;return{...j,richHistorySettings:W}}if(m.match(A)){const{richHistory:W,total:U}=A.payload.richHistoryResults;return{...j,richHistory:W,richHistoryTotal:U}}if(y.match(A)){const W=A.payload.filters;return{...j,richHistorySearchFilters:W}}if(T.pending.match(A))return{...j,panes:{...j.panes,[A.meta.arg.exploreId]:M}};if(c.Gd?.pending.match(A)){const W=Object.entries(j.panes),U=W.slice(0,A.meta.arg.position),F=W.slice(U.length),V=[...U,[A.meta.arg.exploreId,M],...F].reduce((w,[z,N])=>({...w,[z]:N}),{});return{...j,panes:V}}if(C.match(A))return{...j,panes:{}};if(S.match(A)){const{editorMode:W,label:U,description:F,canSave:V,correlationDirty:w,queryEditorDirty:z,isExiting:N,postConfirmAction:H,transformations:Q}=A.payload;return{...j,correlationEditorDetails:{editorMode:!!(W??j.correlationEditorDetails?.editorMode),canSave:!!(V??j.correlationEditorDetails?.canSave),label:U??j.correlationEditorDetails?.label,description:F??j.correlationEditorDetails?.description,transformations:Q??j.correlationEditorDetails?.transformations,correlationDirty:!!(w??j.correlationEditorDetails?.correlationDirty),queryEditorDirty:!!(z??j.correlationEditorDetails?.queryEditorDirty),isExiting:!!(N??j.correlationEditorDetails?.isExiting),postConfirmAction:H}}}const K=A.payload?.exploreId;return typeof K=="string"?{...j,panes:Object.entries(j.panes).reduce((W,[U,F])=>({...W,[U]:U===K?(0,c.LJ)(F,A):F}),{})}:j}}},23994:(G,R,e)=>{"use strict";e.d(R,{_0:()=>It,He:()=>gt,hS:()=>ge,bO:()=>me,IL:()=>He,rR:()=>We,y2:()=>Pe,Az:()=>et,PD:()=>Ne,JQ:()=>ht,S6:()=>be,Od:()=>he,GI:()=>ot,q9:()=>at,h1:()=>de,qk:()=>we,Rk:()=>tt,h9:()=>Ue,TO:()=>rt});var t=e(65307),n=e(32017),s=e.n(n),a=e(2543),r=e(49510),g=e(62467),i=e(58307),l=e(69862),d=e(99165),c=e(39070),h=e(73372),o=e(47232),m=e(9557),u=e(40187),p=e(26272),f=e(14236),y=e(80822),x=e(19347),v=e(32264),P=e(87490),E=e(80582),D=e(18380),C=e(31193),b=e(32901),T=e(13137),S=e(14678),O=e(31678),M=e(82467),I=e(3169),L=e(39374),B=e(81160),j=e(57875),A=e(91890),K=e(97522),W=e(11261),U=e(69147),F=e(91002),V=e(15162);const w=De=>{const Te=[],Oe=[],Ye=[],Ge=[],Je=[],it=[],St=[],zt=[];for(const Kt of De.series){if(q(Kt)){zt.push(Kt);continue}switch(Kt.meta?.preferredVisualisationType){case"logs":Ge.push(Kt);break;case"graph":Te.push(Kt);break;case"trace":Je.push(Kt);break;case"table":Oe.push(Kt);break;case"rawPrometheus":Ye.push(Kt);break;case"nodeGraph":it.push(Kt);break;case"flamegraph":St.push(Kt);break;default:Z(Kt)&&Te.push(Kt),Oe.push(Kt)}}return{...De,graphFrames:Te,tableFrames:Oe,logsFrames:Ge,traceFrames:Je,nodeGraphFrames:it,customFrames:zt,flameGraphFrames:St,rawPrometheusFrames:Ye,graphResult:null,tableResult:null,logsResult:null,rawPrometheusResult:null}},z=({showCorrelationEditorLinks:De,queries:Te,correlations:Oe,defaultTargetDatasource:Ye})=>Ge=>{if(De&&Ye)for(const Je of Ge.series)for(const it of Je.fields){it.config.links=[],it.display=it.display||(0,j.H)();const St={};Je.fields.map(zt=>{St[`${zt.name}`]=`\${__data.fields.['${zt.name}']}`}),it.config.links.push({url:"",origin:A.x0.ExploreCorrelationsEditor,title:`Correlate with ${it.name}`,internal:{datasourceUid:Ye.uid,datasourceName:Ye.name,query:{datasource:{uid:Ye.uid}}},meta:{correlationData:{resultField:it.name,vars:St,origVars:St}}})}else if(Te?.length&&Oe?.length){const Je=(0,a.mapValues)((0,a.groupBy)(Te,"refId"),"0.datasource.uid");(0,D.cA)(Ge.series,Oe,Je)}return Ge},N=De=>De.graphFrames.length?{...De,graphResult:De.graphFrames}:{...De,graphResult:null},H=De=>{if(De.tableFrames.length===0)return(0,g.of)({...De,tableResult:null});De.tableFrames.sort((Ge,Je)=>{const it=Ge.refId,St=Je.refId;return it>St?1:it<St?-1:0});const Te=De.tableFrames.every(Ge=>Z(Ge)),Oe={interpolate:Ge=>Ge};return(Te?(0,g.of)(De.tableFrames).pipe(K.c.joinByFieldTransformer.operator({},Oe)):(0,g.of)(De.tableFrames).pipe(K.c.mergeTransformer.operator({},Oe))).pipe((0,B.T)(Ge=>{for(const Je of Ge)for(const it of Je.fields)it.display=it.display??(0,j.J)({field:it,theme:v.$.theme2,timeZone:De.request?.timezone??"browser"});return{...De,tableResult:Ge}}))},Q=De=>{const Te=De.rawPrometheusFrames;if(!Te||Te.length===0)return(0,g.of)({...De,tableResult:null});Te.sort((Je,it)=>{const St=Je.refId,zt=it.refId;return St>zt?1:St<zt?-1:0});const Oe=Te.every(Je=>Z(Je)),Ye={interpolate:Je=>Je};return(Oe?(0,g.of)(Te).pipe(K.c.joinByFieldTransformer.operator({},Ye)):(0,g.of)(Te).pipe(K.c.mergeTransformer.operator({},Ye))).pipe((0,B.T)(Je=>{const it=Je[0];for(const St of it.fields)St.display=St.display??(0,j.J)({field:St,theme:v.$.theme2,timeZone:De.request?.timezone??"browser"});return{...De,rawPrometheusResult:it}}))},X=(De={})=>Te=>{if(Te.logsFrames.length===0)return{...Te,logsResult:null};const Oe=Te.request?.intervalMs,Ye=(0,U.HT)(Te.logsFrames,Oe,De.absoluteRange,De.queries,De.deduplicate),Ge=(0,P.uE)(De.refreshInterval),Je=(0,F.zy)(Ye,Ge),it=Je.rows,St=Je.series,zt={...Je,rows:it,series:St};return{...Te,logsResult:zt}};function ee(De,Te,Oe,Ye,Ge,Je,it){return(0,g.of)(De).pipe((0,B.T)(St=>(0,f.N$)(St,Te)),(0,B.T)(z({defaultTargetDatasource:it,showCorrelationEditorLinks:Je,queries:Ye,correlations:Ge})),(0,B.T)(w),(0,B.T)(N),(0,B.T)(Oe),(0,l.Z)(Q),(0,l.Z)(H))}function Z(De){const Te=(0,a.groupBy)(De.fields,Oe=>Oe.type);return!!(Object.keys(Te).length===2&&Te[W.PU.time]?.length===1&&Te[W.PU.number])}function q(De){return De.meta?.preferredVisualisationPluginId?(0,V.oZ)(De.meta?.preferredVisualisationPluginId):!1}var ae=e(57288),k=e(324),se=e(62256),te=e(72433),ne=e(29436),le=e(89224),re=e(34028);const de=De=>Te=>{const Oe=Te.explore.panes[De];return Oe&&Oe.queryResponse?Oe.queryResponse.state===c.Gu.Loading||Oe.queryResponse.state===c.Gu.Streaming:!1},oe=(0,t.VP)("explore/addQueryRow"),J=(0,t.VP)("explore/changeQueries"),ce=(0,t.VP)("explore/cancelQueries"),pe=(0,t.VP)("explore/queriesImported"),xe=(0,t.VP)("explore/queryStoreSubscription"),fe=(0,t.VP)("explore/setSupplementaryQueryEnabledAction"),Ee=(0,t.VP)("explore/storeSupplementaryQueryDataProviderAction"),Se=(0,t.VP)("explore/cleanSupplementaryQueryDataProviderAction"),ye=(0,t.VP)("explore/cleanSupplementaryQueryAction"),Ve=(0,t.VP)("explore/storeSupplementaryQueryDataSubscriptionAction"),Me=(0,t.VP)("explore/updateSupplementaryQueryDataAction"),Ce=(0,t.VP)("explore/queryStreamUpdated"),Ue=(0,t.VP)("explore/setQueries"),Ae=(0,t.VP)("changeLoadingState"),we=(0,t.VP)("explore/setPausedState"),We=(0,t.VP)("explore/clearLogs"),_e=(0,t.VP)("explore/scanStart"),at=(0,t.VP)("explore/scanStop"),ut=(0,t.VP)("explore/addResultsToCache"),Tt=(0,t.VP)("explore/clearCache");function It(De,Te){return async(Oe,Ye)=>{const Ge=Ye().explore.panes[De];let Je;Ge.datasourceInstance?.meta.mixed?Je=(0,a.findLast)(Ge.queries,St=>!!St.datasource)?.datasource||void 0:Je=Ge.datasourceInstance?.getRef();const it=await(0,P.Ll)(Ge.queries,Te,Je);Oe(oe({exploreId:De,index:Te,query:it}))}}function ge(De){return(Te,Oe)=>{Te(at({exploreId:De})),Te(ce({exploreId:De}));const Ye=Oe().explore.panes[De].supplementaryQueries;for(const Ge of ae.VW)Te(Se({exploreId:De,type:Ge})),Ye[Ge]?.data?.state!==c.Gu.Done&&Te(ye({exploreId:De,type:Ge}))}}const Ie=(De,Te)=>{const Oe=De.getRef();return Te.map(Ye=>({...Ye,datasource:Oe}))},ue=async(De,Te,Oe)=>{let Ye=[];if(Te.meta?.id===De.meta?.id)Ye=Oe;else if((0,h.Ee)(Te)&&(0,h.FL)(De)){const Ge=await Te.exportToAbstractQueries(Oe);Ye=await De.importFromAbstractQueries(Ge)}else De.importQueries&&(Ye=await De.importQueries(Oe,Te));return Ie(De,Ye)},me=(0,O.createAsyncThunk)("explore/changeQueries",async({queries:De,exploreId:Te},{getState:Oe,dispatch:Ye})=>{let Ge=!1;const Je=Oe().explore.panes[Te].queries,it=Oe().explore.panes[Te].datasourceInstance?.uid,St=Oe().explore.correlationEditorDetails,zt=St?.editorMode||!1;!(Object.keys(Oe().explore.panes)[0]===Te)&&zt&&!St?.queryEditorDirty&&Ye((0,ne.am)({queryEditorDirty:!0}));for(const Qt of De)for(const an of Je){if(Qt.refId===an.refId&&Qt.datasource?.type!==an.datasource?.type){const Nn=await(0,x.l)().get(an.datasource),zn=await(0,x.l)().get({uid:Qt.datasource?.uid});await Ye(Pe(Te,Je,Nn,zn,Qt.refId)),Ge=!0}if(it===S.uv&&Qt.refId===an.refId&&Qt.datasource?.uid!==an.datasource?.uid){const Nn=(0,re.dq)(S.uv,De),zn=await(0,D.J6)(Nn);Ye((0,se.Fb)({exploreId:Te,correlations:zn.correlations||[]}))}}Ge||Ye(J({queries:De,exploreId:Te})),De.length<Je.length&&Ye(he({exploreId:Te}))}),Pe=(De,Te,Oe,Ye,Ge)=>async Je=>{if(!Oe){Je(pe({exploreId:De,queries:Te}));return}let it=Te;if(Ye.uid===S.uv)it=Te.map(zt=>({...zt,datasource:Oe.getRef()}));else if(Oe.uid===S.uv){const zt=(0,a.groupBy)(Te,Qt=>Qt.datasource?.uid),Kt=await Promise.all(Object.keys(zt).map(async Qt=>{const an=await(0,x.l)().get({uid:Qt});return await ue(Ye,an,zt[Qt])}));it=(0,a.flatten)(Kt.filter(Qt=>Qt.length>0))}else{let zt=Te;if(Ge!==void 0){const Kt=Te.find(Qt=>Qt.refId===Ge);Kt&&(zt=[Kt])}it=await ue(Ye,Oe,zt)}let St=await(0,P.di)(it,Ye.getRef());if(Ge!==void 0){it.length===0&&(it=[await(0,P.Ll)([],void 0,Ye.getRef())]);const zt=Te.findIndex(Qt=>Qt.refId===Ge),Kt={...St[0],refId:Te[zt].refId};St=[...Te],St[zt]=Kt}return Je(pe({exploreId:De,queries:St})),St};function Ne(De,Te,Oe){return async(Ye,Ge)=>{const Je=Ge().explore.panes[De],{queries:it}=Je,zt=(await Promise.all(it.map(Kt=>Oe({...Kt},Te)))).map((Kt,Qt)=>(0,P.eF)(Kt,it,Qt));Ye(Ue({exploreId:De,queries:zt})),Te.preventSubmit||Ye(he({exploreId:De}))}}function Fe(De,Te){if(!(De.filterQuery&&!De.filterQuery(Te)))return Te}async function Be(De,Te,Oe,Ye){const Je=(await Promise.all(Ye.map(async it=>{if(it.datasource?.uid===Oe.uid)return Fe(Oe,it);{const St=await(0,C.tR)().get(it.datasource);return Fe(St,it)}}))).filter(it=>!!it);Je.length>0&&(De((0,te.ri)(!0,Oe.uid,Oe.name,Je,v.$.queryHistoryEnabled)),v.$.queryHistoryEnabled&&De((0,te.ri)(!1,Oe.uid,Oe.name,Je,!1)),await De((0,te.jX)()))}const he=(0,O.createAsyncThunk)("explore/runQueries",async({exploreId:De,preserveCache:Te},{dispatch:Oe,getState:Ye})=>{Oe(ge(De));const{defaultCorrelationEditorDatasource:Ge,scopedVars:Je,showCorrelationEditorLinks:it}=await(0,re.aj)(Ye(),De),St=(0,k.M)(De);Oe((0,le.JA)({exploreId:De})),Te!==!0&&Oe(He(De));const Kt=Ye().explore.panes[De],{datasourceInstance:Qt,containerWidth:an,isLive:Nn,range:zn,scanning:Yn,queryResponse:ss,querySubscription:ds,refreshInterval:Ms,absoluteRange:Bs,cache:gs,supplementaryQueries:Zn}=Kt;let Ls,Ln;const Hn=Kt.queries.map(mt=>({...mt,datasource:mt.datasource||Qt?.getRef()}));Qt!=null&&Be(Oe,Ye().explore,Qt,Hn);const Qn=(0,re.rk)(gs,Bs);if(Qn)Ls=(0,r.z)([(0,g.of)(Qn),St]).pipe((0,l.Z)(([mt,Yt])=>ee(mt,ss,X({absoluteRange:Bs,refreshInterval:Ms,queries:Hn}),Hn,Yt,it,Ge))),Ln=Ls.subscribe(mt=>{Oe(Ce({exploreId:De,response:mt}))});else{if(!(0,P.zT)(Hn)||!Qt)return;const mt=Qt?.interval;(0,P._u)(ds);const Yt={minInterval:mt,maxDataPoints:an,liveStreaming:Nn},on=(0,b.O)(Ye().user),ln=(0,P.bI)(De,Hn,Yt,zn,Yn,on,Je);if(Oe(Ae({exploreId:De,loadingState:c.Gu.Loading})),Ls=(0,r.z)([(0,L.BN)(Qt,ln.request).pipe(Nn?(0,d.c)(500):i.D),St]).pipe((0,l.Z)(([fn,yn])=>ee(fn,ss,X({absoluteRange:Bs,refreshInterval:Ms,queries:Hn}),Hn,yn,it,Ge))),Ln=Ls.subscribe({next(fn){const yn=Ye().explore.panes[De];if(Oe(Ce({exploreId:De,response:fn})),yn.scanning)if(fn.state===c.Gu.Done&&fn.series.length===0){const wn=(0,E.Wb)(-1,yn.range);Oe((0,le.JA)({exploreId:De,absoluteRange:wn})),Oe(he({exploreId:De}))}else Oe(at({exploreId:De}))},error(fn){Oe((0,M.dx)((0,I.gi)("Query processing error",fn))),Oe(Ae({exploreId:De,loadingState:c.Gu.Error})),console.error(fn)},complete(){Ye().explore.panes[De].queryResponse.state===c.Gu.Loading&&Oe(Ae({exploreId:De,loadingState:c.Gu.Done}))}}),Nn)for(const fn of ae.VW)Oe(Se({exploreId:De,type:fn})),Oe(ye({exploreId:De,type:fn}));else Oe(ze({exploreId:De,datasourceInstance:Qt,transaction:ln,newQuerySource:Ls,supplementaryQueries:Zn,queries:Hn,absoluteRange:Bs}))}Oe(xe({exploreId:De,querySubscription:Ln}))}),be=(0,O.createAsyncThunk)("explore/runLoadMoreQueries",async({exploreId:De,absoluteRange:Te},{dispatch:Oe,getState:Ye})=>{Oe(ge(De));const{datasourceInstance:Ge,containerWidth:Je,queryResponse:it}=Ye().explore.panes[De],{defaultCorrelationEditorDatasource:St,scopedVars:zt,showCorrelationEditorLinks:Kt}=await(0,re.aj)(Ye(),De),Qt=(0,k.M)(De);let an;const Nn=it.logsResult?.queries||[],zn=it.logsFrames.map(gs=>gs.refId),Yn=Nn.filter(gs=>zn.includes(gs.refId)).map(gs=>({...gs,datasource:gs.datasource||Ge?.getRef(),refId:gs.refId,supportingQueryType:T.Q$.InfiniteScroll}));if(!(0,P.zT)(Yn)||!Ge)return;const ss={minInterval:Ge?.interval,maxDataPoints:Je},ds=(0,b.O)(Ye().user),Ms=(0,P.zq)(ds,{from:(0,o.oZ)(ds,Te.from),to:(0,o.oZ)(ds,Te.to)},(0,b.q)(Ye().user)),Bs=(0,P.bI)(De,Yn,ss,Ms,!1,ds,zt);Oe(Ae({exploreId:De,loadingState:c.Gu.Loading})),an=(0,r.z)([(0,L.BN)(Ge,Bs.request),Qt]).pipe((0,l.Z)(([gs,Zn])=>gs.state!==c.Gu.Done?(0,g.of)({...it,state:c.Gu.Loading}):ee((0,y._k)(it,gs),it,X({absoluteRange:Te,queries:Nn,deduplicate:!0}),Yn,Zn,Kt,St))),an.subscribe({next(gs){Oe(Ce({exploreId:De,response:gs}))},error(gs){Oe((0,M.dx)((0,I.gi)("Query processing error",gs))),Oe(Ae({exploreId:De,loadingState:c.Gu.Error})),console.error(gs)},complete(){Oe(Ae({exploreId:De,loadingState:c.Gu.Done}))}})}),Ke=async(De,Te)=>{const Oe=De.filter(Ge=>Ge.datasource?.uid!==S.uv),Ye=(0,a.groupBy)(Oe,"datasource.uid");return await Promise.all(Object.values(Ye).map(async Ge=>({datasource:await(0,x.l)().get(Ge[0].datasource,Te),targets:Ge})))},ze=(0,O.createAsyncThunk)("explore/handleSupplementaryQueries",async({datasourceInstance:De,exploreId:Te,transaction:Oe,newQuerySource:Ye,supplementaryQueries:Ge,queries:Je,absoluteRange:it},{dispatch:St})=>{let zt;De.meta.mixed?zt=await Ke(Oe.request.targets,Oe.request.scopedVars):zt=[{datasource:De,targets:Oe.request.targets}];for(const Kt of ae.VW){const Qt=(0,ae.Pm)(zt,Kt,{...Oe.request,requestId:`${Oe.request.requestId}_${(0,a.snakeCase)(Kt)}`},Ye);Qt?(St(Ee({exploreId:Te,type:Kt,dataProvider:Qt})),nt(Ge[Kt].data,Je,it)||(St(ye({exploreId:Te,type:Kt})),Ge[Kt].enabled&&St(et(Te,Kt)))):St(Se({exploreId:Te,type:Kt}))}});function nt(De,Te,Oe){if(!De)return!1;const Ye=(0,a.zipObject)((0,a.map)(Te,"refId"),Te),Ge=(0,a.mapValues)((0,a.groupBy)(De.data.map(zt=>zt.meta?.custom?.sourceQuery),"refId"),a.head),Je=De.data.every(zt=>zt.meta?.custom?.logsVolumeType===m.Aj.FullRange),it=s()(Ye,Ge),St=De.data.every(zt=>{const Kt=zt.meta?.custom?.absoluteRange;return Kt?Kt&&Kt.from<=Oe.from&&Oe.to<=Kt.to:!0});return Je&&it&&St}function tt(De,Te){return(Oe,Ye)=>{const Ge=Ye().explore.panes[De].queries,Je=Te.map((it,St)=>(0,P.eF)(it,Ge,St));Oe(Ue({exploreId:De,queries:Je})),Oe(he({exploreId:De}))}}function ot(De){return(Te,Oe)=>{Te(_e({exploreId:De}));const Ye=(0,E.Wb)(-1,Oe().explore.panes[De].range);Te((0,le.JA)({exploreId:De,absoluteRange:Ye})),Te(he({exploreId:De}))}}function gt(De){return(Te,Oe)=>{const Ye=Oe().explore.panes[De].queryResponse,Ge=Oe().explore.panes[De].absoluteRange,Je=(0,re.O2)(Ge);Ye.state===c.Gu.Done&&Te(ut({exploreId:De,cacheKey:Je,queryResponse:Ye}))}}function He(De){return(Te,Oe)=>{Te(Tt({exploreId:De}))}}function et(De,Te){return(Oe,Ye)=>{const{supplementaryQueries:Ge}=Ye().explore.panes[De],Je=Ge[Te].dataProvider;if(Je){const it=Je.subscribe({next:St=>{Oe(Me({exploreId:De,type:Te,data:St}))}});Oe(Ve({exploreId:De,type:Te,dataSubscription:it}))}}}function rt(De,Te,Oe){return(Ye,Ge)=>{Ye(fe({exploreId:De,enabled:Te,type:Oe})),(0,ae.Oi)(Te,Oe),Te&&Ye(et(De,Oe))}}const ht=(De,Te)=>{if(oe.match(Te)){const{queries:Oe}=De,{index:Ye,query:Ge}=Te.payload,Je=[...Oe.slice(0,Ye+1),{...Ge},...Oe.slice(Ye+1)];return{...De,queries:Je,queryKeys:(0,P.dY)(Je)}}if(J.match(Te)){const{queries:Oe}=Te.payload;return{...De,queries:Oe}}if(ce.match(Te))return(0,P._u)(De.querySubscription),{...De,...De.queryResponse?{queryResponse:{...De.queryResponse,state:c.Gu.Done}}:{}};if(Ue.match(Te)){const{queries:Oe}=Te.payload;return{...De,queries:Oe.slice(),queryKeys:(0,P.dY)(Oe)}}if(xe.match(Te)){const{querySubscription:Oe}=Te.payload;return{...De,querySubscription:Oe}}if(fe.match(Te)){const{enabled:Oe,type:Ye}=Te.payload,{supplementaryQueries:Ge}=De,Je=Ge[Ye].dataSubscription;!Oe&&Je&&Je.unsubscribe();const it={...Ge,[Ye]:{...Ge[Ye],enabled:Oe,data:void 0}};return{...De,supplementaryQueries:it}}if(Ee.match(Te)){const{dataProvider:Oe,type:Ye}=Te.payload,{supplementaryQueries:Ge}=De,Je=Ge[Ye];Je?.dataSubscription&&Je.dataSubscription.unsubscribe();const it={...Ge,[Ye]:{...Je,dataProvider:Oe,dataSubscription:void 0}};return{...De,supplementaryQueries:it}}if(Se.match(Te)){const{type:Oe}=Te.payload,{supplementaryQueries:Ye}=De,Ge=Ye[Oe];Ge?.dataSubscription&&Ge.dataSubscription.unsubscribe();const Je={...Ye,[Oe]:{...Ge,dataProvider:void 0,dataSubscription:void 0}};return{...De,supplementaryQueries:Je}}if(ye.match(Te)){const{type:Oe}=Te.payload,{supplementaryQueries:Ye}=De,Ge={...Ye,[Oe]:{...Ye[Oe],data:void 0}};return{...De,supplementaryQueries:Ge}}if(Ve.match(Te)){const{dataSubscription:Oe,type:Ye}=Te.payload,{supplementaryQueries:Ge}=De,Je={...Ge,[Ye]:{...Ge[Ye],dataSubscription:Oe}};return{...De,supplementaryQueries:Je}}if(Me.match(Te)){let{data:Oe,type:Ye}=Te.payload;const{supplementaryQueries:Ge}=De,Je={...Ge,[Ye]:{...Ge[Ye],data:Oe}};return{...De,supplementaryQueries:Je}}if(Ce.match(Te))return ft(De,Te);if(pe.match(Te)){const{queries:Oe}=Te.payload;return{...De,queries:Oe,queryKeys:(0,P.dY)(Oe)}}if(Ae.match(Te)){const{loadingState:Oe}=Te.payload;return{...De,queryResponse:{...De.queryResponse,state:Oe}}}if(we.match(Te)){const{isPaused:Oe}=Te.payload;return{...De,isPaused:Oe}}if(_e.match(Te))return{...De,scanning:!0};if(at.match(Te))return{...De,scanning:!1,scanRange:void 0};if(ut.match(Te)){const{cache:Ye}=De,{queryResponse:Ge,cacheKey:Je}=Te.payload;let it=[...Ye];return it.some(zt=>zt.key===Je)||(it=[{key:Je,value:Ge},...it].slice(0,5)),{...De,cache:it}}if(Tt.match(Te))return{...De,cache:[]};if(We.match(Te)){if(!De.logsResult)return{...De,clearedAtIndex:null};if(De.queryResponse.state===c.Gu.Loading)return{...De,clearedAtIndex:null,logsResult:{...De.logsResult,rows:[]}};const Oe=De.clearedAtIndex?De.clearedAtIndex+De.logsResult.rows.length:De.logsResult.rows.length-1;return{...De,clearedAtIndex:Oe,logsResult:{...De.logsResult,rows:[]}}}return De},ft=(De,Te)=>{const{response:Oe}=Te.payload,{request:Ye,series:Ge,error:Je,graphResult:it,logsResult:St,tableResult:zt,rawPrometheusResult:Kt,traceFrames:Qt,nodeGraphFrames:an,flameGraphFrames:Nn,rawPrometheusFrames:zn,customFrames:Yn}=Oe;if(Je){if(Je.type===u.v2.Timeout||Je.type===u.v2.Cancelled)return{...De};v.$.angularSupportEnabled&&De.datasourceInstance?.components?.QueryCtrl&&De.eventBridge.emit(p.ee.dataError,Je)}if(!Ye)return{...De};if(v.$.angularSupportEnabled&&De.datasourceInstance?.components?.QueryCtrl){const ss=Ge.map(ds=>(0,f.w3)(ds));De.eventBridge.emit(p.ee.dataReceived,ss)}return{...De,queryResponse:Oe,graphResult:it,tableResult:zt,rawPrometheusResult:Kt,logsResult:De.isLive&&St?{...St,rows:(0,re.pg)(De.clearedAtIndex,St.rows)}:St,showLogs:!!St,showMetrics:!!it,showTable:!!zt?.length,showTrace:!!Qt.length,showNodeGraph:!!an.length,showRawPrometheus:!!zn.length,showFlameGraph:!!Nn.length,showCustom:!!Yn?.length,clearedAtIndex:De.isLive?De.clearedAtIndex:null}}},9955:(G,R,e)=>{"use strict";e.d(R,{Jr:()=>c,K6:()=>i,Kl:()=>m,Qb:()=>a,i6:()=>g,pF:()=>l,qq:()=>h,st:()=>d,vC:()=>o});var t=e(25508),n=e(2543),s=e.n(n);const a=u=>u.explore.panes,r=u=>u.explore,g=u=>u.explore.richHistorySettings,i=(0,t.Mz)(a,Object.entries),l=(0,t.Mz)(i,u=>u.length>1),d=(0,t.Mz)(i,u=>u.some(p=>p[1].correlationEditorHelperData!==void 0)),c=u=>(0,t.Mz)(a,p=>Object.keys(p)[0]===u),h=u=>(0,t.Mz)(a,p=>p[u]),o=(0,t.Mz)(r,u=>u.correlationEditorDetails),m=(0,t.Mz)(i,u=>{const p=u.map(([x,v])=>{const P=[v?.datasourceInstance?.getRef()],E=v?.queries.map(C=>C.datasource)||[],D=[...P,...E].filter(C=>!!C);if(!(D===void 0||D.length===0))return{exploreId:x,datasources:(0,n.uniqBy)(D,C=>C.uid)}}).filter(x=>!!x),y=(0,n.uniqBy)((0,n.flatten)(p.map(x=>x.datasources)),x=>x.uid).map(x=>{let v=[];return p.forEach(P=>{P.datasources.some(E=>E.uid===x.uid)&&v.push(P.exploreId)}),{datasource:x,exploreIds:v}});return{exploreToDS:p,dsToExplore:y}})},89224:(G,R,e)=>{"use strict";e.d(R,{$_:()=>C,GA:()=>O,GH:()=>x,Iy:()=>b,JA:()=>P,QP:()=>M,Xk:()=>S,eM:()=>f,hO:()=>y,iO:()=>E,ke:()=>T,zY:()=>v});var t=e(65307),n=e(47232),s=e(26272),a=e(39070),r=e(72574),g=e(11134),i=e(76412),l=e(28138),d=e(87490),c=e(80582),h=e(74856),o=e(91002),m=e(32901),u=e(29436),p=e(23994);const f=(0,t.VP)("explore/changeRange"),y=(0,t.VP)("explore/changeRefreshInterval"),x=I=>(L,B)=>{const{syncedTimes:j}=B().explore;j?Object.keys(B().explore.panes).forEach(A=>{L(P({...I,exploreId:A})),L((0,p.Od)({exploreId:A,preserveCache:!0}))}):(L(P({...I})),L((0,p.Od)({exploreId:I.exploreId,preserveCache:!0})))},v=I=>L=>{L((0,p.S6)({...I}))},P=I=>(L,B)=>{const{exploreId:j,absoluteRange:A,rawRange:K}=I,W=B().explore.panes[j],U=(0,m.O)(B().user),F=(0,m.q)(B().user),{range:V}=W;let w=V.raw;A&&(w={from:(0,n.oZ)(U,A.from),to:(0,n.oZ)(U,A.to)}),K&&(w=K);const z=(0,d.zq)(U,w,F),N={from:z.from.valueOf(),to:z.to.valueOf()};(0,h.jG)().init({timepicker:{},getTimezone:()=>U,timeRangeUpdated(H){},time:z.raw}),(0,r.w)().updateTimeRange(z),L(f({exploreId:j,range:z,absoluteRange:N}))};function E(I){return(L,B)=>{const j=B().explore.panes[I].range.raw;Object.keys(B().explore.panes).filter(K=>K!==I).forEach(K=>{L(x({exploreId:K,rawRange:j}))});const A=B().explore.syncedTimes;L((0,u.qz)({syncedTimes:!A}))}}function D(I){return(L,B)=>{const j=(0,m.O)(B().user),A=(0,m.q)(B().user);Object.entries(B().explore.panes).forEach(([K,W])=>{const U=(0,d.zq)(j,W.range.raw,A);I(K,W,U,L)})}}function C(){return D((I,L,B,j)=>{const A={from:B.from.valueOf(),to:B.to.valueOf()};j(x({exploreId:I,absoluteRange:A}))})}function b(I){return D((L,B,j,A)=>{const K=(0,c.Wb)(I,j);A(x({exploreId:L,absoluteRange:K}))})}function T(I){return D((L,B,j,A)=>{const K=(0,c.Zk)(j,I);A(x({exploreId:L,absoluteRange:K}))})}function S(){return(I,L)=>{const B=L().explore.panes[Object.keys(L().explore.panes)[0]].range.raw;navigator.clipboard.writeText(JSON.stringify(B)),l.A.emit(s.r1.alertSuccess,[(0,i.t)("time-picker.copy-paste.copy-success-message","Time range copied to clipboard")])}}function O(){return async(I,L)=>{const{range:B,isError:j}=await(0,c.zG)();if(j===!0){l.A.emit(s.r1.alertError,[(0,i.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,i.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:B})]);return}if(L().explore.syncedTimes){I(x({exploreId:Object.keys(L().explore.panes)[0],rawRange:B})),I(x({exploreId:Object.keys(L().explore.panes)[1],rawRange:B}));return}I(x({exploreId:Object.keys(L().explore.panes)[0],rawRange:B}))}}const M=(I,L)=>{if(y.match(L)){const{refreshInterval:B}=L.payload,j=g.cC.isLive(B),A=(0,d.uE)(B),K=(0,o.zy)(I.logsResult,A);return g.cC.isLive(I.refreshInterval)&&!j&&(0,d._u)(I.querySubscription),{...I,refreshInterval:B,queryResponse:{...I.queryResponse,state:j?a.Gu.Streaming:a.Gu.Done},isLive:j,isPaused:j?!1:I.isPaused,logsResult:K}}if(f.match(L)){const{range:B,absoluteRange:j}=L.payload;return{...I,range:B,absoluteRange:j}}return I}},34028:(G,R,e)=>{"use strict";e.d(R,{BE:()=>D,HZ:()=>P,O2:()=>C,RA:()=>E,Z9:()=>S,aj:()=>L,dq:()=>I,eO:()=>T,kn:()=>y,ng:()=>v,pg:()=>M,rk:()=>b});var t=e(2543),n=e.n(t),s=e(39070),a=e(43127),r=e(85858),g=e(47232),i=e(32264),l=e(19347),d=e(11401),c=e(81523),h=e(14678),o=e(33390),m=e(87490),u=e(31193),p=e(57288);const f=100,y={from:`now-${i.$.exploreDefaultTimeOffset}`,to:"now"},x="grafana.explore.style.graph",v=B=>{o.A.set(x,B)},P=B=>({containerWidth:0,datasourceInstance:null,history:[],queries:[],initialized:!1,range:{from:null,to:null,raw:y},absoluteRange:{from:null,to:null},scanning:!1,queryKeys:[],isLive:!1,isPaused:!1,queryResponse:E(),tableResult:null,graphResult:null,logsResult:null,clearedAtIndex:null,rawPrometheusResult:null,eventBridge:null,cache:[],supplementaryQueries:(0,p.Ez)(),panelsState:{},correlations:void 0,...B}),E=()=>({state:s.Gu.NotStarted,series:[],timeRange:(0,a.E2)(),graphFrames:[],logsFrames:[],traceFrames:[],nodeGraphFrames:[],flameGraphFrames:[],customFrames:[],tableFrames:[],rawPrometheusFrames:[],rawPrometheusResult:null,graphResult:null,logsResult:null,tableResult:null});async function D(B,j){let A;try{A=await(0,u.tR)().get(j)}catch{A=await(0,u.tR)().get()}if(A.init)try{A.init()}catch(F){console.error(F)}let K=[];const W=(0,d.tU)(),U=await W.getRichHistory({search:"",sortOrder:c.xB.Ascending,datasourceFilters:[A.name],starred:!1});if((U.total||0)>0&&U.richHistory.forEach(F=>{F.queries.forEach(V=>{K.push({ts:parseInt(F.id,10),query:V})})}),K.length<f){const F=await W.getRichHistory({search:"",sortOrder:c.xB.Ascending,datasourceFilters:[h.uv],starred:!1});(F.total||0)>0&&F.richHistory.forEach(V=>{V.queries.forEach(w=>{w?.datasource?.uid===A.uid&&K.push({ts:parseInt(V.id,10),query:w})})})}if(K.length<f){const F=`grafana.explore.history.${A.meta?.id}`;K=[...K,...o.A.getObject(F,[])]}return K.length>f&&(K.length=f),(0,m.dr)(B,A.uid),{history:K,instance:A}}function C(B){const j={from:B.from,to:B.to};return Object.entries(j).map(([K,W])=>`${encodeURIComponent(K)}=${encodeURIComponent(W.toString())}`).join("&")}function b(B,j){const A=C(j),K=B.findIndex(U=>U.key===A);return K>=0?B[K].value:void 0}function T(B,j){return{from:r.parse(B.from,!1,j),to:r.parse(B.to,!0,j),raw:B}}function S(B){let j=y,A={from:O(B.from),to:O(B.to)};return A.from!==null&&A.to!==null&&(j={from:A.from,to:A.to}),j}function O(B){if(B===null)return null;if((0,g.Ar)(B))return B;if(typeof B!="string")return null;const j=B;if(j.indexOf("now")!==-1)return j;if(j.length===8)return(0,g.yT)(j,"YYYYMMDD");if(j.length===15)return(0,g.yT)(j,"YYYYMMDDTHHmmss");if(j.length===19)return(0,g.yT)(j,"YYYY-MM-DD HH:mm:ss");if(j.match(/^\d+$/)){const K=parseInt(j,10);return(0,g.yT)(K)}const A=(0,g.yT)(j);return A.isValid()?A:null}const M=(B,j)=>j?B?j.slice(B+1):j:[],I=(B,j)=>B===h.uv?(0,t.uniq)(j.map(A=>A.datasource?.uid).filter(A=>!!A)):[B];async function L(B,j){const A=B.explore.panes[j].correlationEditorHelperData,K=B.explore.correlationEditorDetails?.editorMode||!1,W=Object.keys(B.explore.panes)[0]===j,U=K&&W,F=U?await(0,l.l)().get():void 0,V=K&&!W&&A!==void 0;let w={};return V&&A!==void 0&&Object.entries(A?.vars).forEach(z=>{w[z[0]]={value:z[1]}}),{defaultCorrelationEditorDatasource:F,scopedVars:w,showCorrelationEditorLinks:U}}},96192:(G,R,e)=>{"use strict";e.d(R,{JQ:()=>E,O1:()=>C,QL:()=>v,YV:()=>x,_O:()=>S});var t=e(2543),n=e.n(t),s=e(96540),a=e(92461),r=e(91890),g=e(41987),i=e(6709),l=e(76885),d=e(72574),c=e(14110),h=e(16233),o=e(67023),m=e(29304),u=e(39590);const f=[O=>!O.internal||h.TP.hasAccessToExplore()],y="grafana_data_link_clicked",x=(O,M)=>L=>{const{field:B,dataLinkScopedVars:j,frame:A,link:K,linkModel:W}=L,{valueRowIndex:U}=L.config;if(U===void 0)return W;const F=v({field:B,rowIndex:U,splitOpenFn:O,range:M,vars:j,dataFrame:A,linksToProcess:[K]});return F.length?(0,t.first)(F):void 0},v=O=>{const{field:M,vars:I,splitOpenFn:L,range:B,rowIndex:j,dataFrame:A}=O,K={...I||{}};K.__value={value:{raw:M.values[j]},text:"Raw value"};let W;A&&(W=(0,a.F)({frame:A,rowIndex:j}),K.__data={value:{name:A.name,refId:A.refId,fields:W},text:"Data"},A.fields.forEach(F=>{W&&W[F.name]&&(K[F.name]={value:W[F.name]})}),K.__targetField={value:W[M.name]});const U=O.linksToProcess||M.config.links;return U?U.filter(w=>f.every(z=>z(w,K))).map(w=>{let z={};w.meta?.transformations&&w.meta?.transformations.forEach(X=>{let ee;X.field?ee=A?.fields.find(q=>q.name===X.field)?.values[j]:ee=M.values[j],z={...z,...(0,o.k)(X,ee,M.name)}});const N={...K,...z},H=C(w,N);let Q=[];if(H.variables.length===0){const X=M.name.toString();Q.push({variableName:X,value:"",match:""})}else Q=H.variables;if(H.allVariablesDefined)if(w.internal){const X=Z=>{(0,c.rR)(y,{origin:w.origin||r.x0.Datasource,app:g.Jk.Explore,internal:!0}),L?.(Z)};return{...(0,i.u)({link:w,internalLink:w.internal,scopedVars:N,range:B,field:M,onClickFn:O.splitOpenFn?Z=>X(Z):void 0,replaceVariables:(0,d.w)().replace.bind((0,d.w)())}),variables:Q}}else{const X=(Z,q)=>(0,d.w)().replace(Z,{...q,...N,...K}),ee=(0,m.mQ)().getDataLinkUIModel(w,X,M);return ee.title||(ee.title=P(ee.href)),ee.target="_blank",{...ee,variables:Q}}else return}).filter(w=>!!w):[]};function P(O){O.indexOf("://")<0&&(O=`http://${O}`);let M;try{M=new URL(O).hostname}catch{M=O}return M}function E(O,M){return(0,s.useCallback)((I,L)=>I.fields.flatMap(B=>B.config?.links&&B.config?.links.length?v({field:B,rowIndex:L,range:O,dataFrame:I,splitOpenFn:M}):[]),[O,M])}const D=["__from","__to","__interval","__interval_ms","__org","__user","__range","__rate_interval","__timeFilter","timeFilter"];function C(O,M){let I=[];return(0,d.w)().replace.bind((0,d.w)())(b(O),M,void 0,I),I=(0,t.uniqBy)(I,"variableName"),{variables:I,allVariablesDefined:I.filter(B=>!D.includes(B.variableName)).every(B=>B.found)}}function b(O){let M="",I;for(I in O)typeof O[I]=="string"?M+=" "+O[I]:typeof O[I]=="object"&&(M+=" "+b(O[I]));return M}const T=O=>O[1]!==void 0,S=O=>{const M=Object.entries(O).filter(T).map(([I,L])=>{const B=(0,u.m)(L);return B.range={to:L.range.to.valueOf().toString(),from:L.range.from.valueOf().toString()},[I,B]}).reduce((I,[L,B])=>({...I,[L]:B}),{});return l.kM.renderUrl("/explore",{schemaVersion:1,panes:JSON.stringify(M)})}},27649:(G,R,e)=>{"use strict";e.d(R,{v:()=>n});var t=e(77789);function n(s){const a=new Set(s.map(r=>r.refId).filter(Boolean));return a.size===s.length?s:(a.clear(),s.map(r=>{if(r.refId&&!a.has(r.refId))return a.add(r.refId),r;const g=(0,t.M)(s);return a.add(g),{...r,refId:g}}))}},57288:(G,R,e)=>{"use strict";e.d(R,{Ez:()=>u,Oi:()=>m,Pm:()=>y,VW:()=>h});var t=e(2543),n=e.n(t),s=e(88483),a=e(44240),r=e(6276),g=e(29405),i=e(9557),l=e(39070),d=e(33390),c=e(69147);const h=[i.cF.LogsVolume,i.cF.LogsSample],o=x=>`grafana.explore.logs.enable${x}`,m=(x,v)=>{d.A.set(o(v),x?"true":"false")},u=()=>{let x={[i.cF.LogsVolume]:{enabled:!0},[i.cF.LogsSample]:{enabled:!1}};for(const v of h){if(v===i.cF.LogsSample)continue;d.A.get(o(v))==="false"&&(x[v]={enabled:!1})}return x},p=(x,v,P)=>new s.c(E=>x.subscribe(D=>{if(D.logsResult&&D.logsResult.rows&&D.logsResult.visibleRange&&D.logsResult.bucketSize!==void 0&&D.state===l.Gu.Done){const C=D.logsResult.bucketSize,b=v.map(O=>O.refId),T=(0,t.groupBy)(D.logsResult.rows,"dataFrame.refId");let S=[];b.forEach(O=>{if(T[O]?.length){const M=(0,c.J9)(T[O],C);S=[...S,...M];const I={logsVolumeType:i.Aj.Limited,absoluteRange:D.logsResult?.visibleRange,datasourceName:P,sourceQuery:v.find(L=>L.refId===O)};E.next({data:S.map(L=>{const B=L.meta?.custom||{};return{...L,meta:{custom:{...B,...I}}}}),state:D.state})}}),E.complete()}})),f=(x,v,P,E)=>{if(x===i.cF.LogsVolume)return p(v,P,E)},y=(x,v,P,E)=>{const C=x.map(({datasource:b,targets:T},S)=>{const O=(0,t.cloneDeep)(P);if(O.requestId=`${O.requestId||""}_${S}`,O.targets=T,(0,i.Nc)(b,v)){if(b.getDataProvider)return b.getDataProvider(v,O);if(b.getSupplementaryRequest){const M=b.getSupplementaryRequest(v,O);return M?v===i.cF.LogsVolume?(0,c.sg)(b,M,{targets:O.targets}):(0,c.Wr)(b,M):void 0}else return}else return f(v,E,T,b.name)}).filter(l.zz);if(C.length!==0)return C.length===1?C[0]:(0,a.h)(...C).pipe((0,g.S)((b,T)=>b.errors&&b.errors.length||T.state===l.Gu.NotStarted?b:T.state===l.Gu.Loading&&b.state===l.Gu.NotStarted?{...b,state:l.Gu.Loading}:T.state&&T.state!==l.Gu.Done?b:{...b,data:[...b.data,...T.data],state:l.Gu.Done},{data:[],state:l.Gu.NotStarted}),(0,r.d)())}},53478:(G,R,e)=>{"use strict";e.d(R,{Ex:()=>b,$i:()=>C});var t=e(65474),n=e(69862),s=e(43429),a=e(26657),r=e(72574),g=e(19347),i=e(74848),l=e(96540),d=e(14186),c=e(90182),h=e(98808),o=e(71680),m=e(1712),u=e(34263),p=e(18225),f=e(76658),y=e(66718),x=e(76942);const v=15;function P(){const T=(0,l.useRef)({}),S=(0,l.useCallback)(M=>{switch(M){case y.Tz.math:case y.Tz.reduce:case y.Tz.resample:case y.Tz.threshold:case y.Tz.sql:return T.current[M];case y.Tz.classic:return}},[]),O=(0,l.useCallback)((M,I)=>{switch(M){case y.Tz.math:T.current.math=I;break;case y.Tz.reduce:case y.Tz.resample:case y.Tz.resample:T.current.reduce=I,T.current.resample=I,T.current.threshold=I;break;case y.Tz.sql:T.current.sql=I}},[]);return{getCachedExpression:S,setCachedExpression:O}}function E(T){const{query:S,queries:O,onRunQuery:M,onChange:I}=T,{getCachedExpression:L,setCachedExpression:B}=P();(0,l.useEffect)(()=>{B(S.type,S.expression)},[S.expression,S.type,B]);const j=(0,l.useCallback)(W=>{const U=L(W.value),F=(0,x.rV)({...S,type:W.value});I({...F,expression:U??F.expression})},[S,I,L]),A=()=>{const W=O.filter(U=>S.refId!==U.refId).map(U=>({value:U.refId,label:U.refId}));switch(S.type){case y.Tz.math:return(0,i.jsx)(o.z,{onChange:I,query:S,labelWidth:v,onRunQuery:M});case y.Tz.reduce:return(0,i.jsx)(m.Z,{refIds:W,onChange:I,labelWidth:v,query:S});case y.Tz.resample:return(0,i.jsx)(u.C,{query:S,labelWidth:v,onChange:I,refIds:W});case y.Tz.classic:return(0,i.jsx)(h.z,{onChange:I,query:S,refIds:W});case y.Tz.threshold:return(0,i.jsx)(f.O,{onChange:I,query:S,labelWidth:v,refIds:W});case y.Tz.sql:return(0,i.jsx)(p.k,{onChange:I,query:S,refIds:W})}},K=y.uQ.find(W=>W.value===S.type);return(0,i.jsxs)("div",{children:[(0,i.jsx)(d.I,{label:"Operation",labelWidth:v,children:(0,i.jsx)(c.l6,{options:y.uQ,value:K,onChange:j,width:25})}),A()]})}class D extends a.iy{constructor(S){super(S),this.instanceSettings=S}applyTemplateVariables(S,O){const M=(0,r.w)();return{...S,expression:M.replace(S.expression,O),window:M.replace(S.window,O)}}getCollapsedText(S){return`Expression: ${S.type}`}query(S){let O=S.targets.map(async I=>{const L=await(0,g.l)().get(I.datasource);return L.interpolateVariablesInQueries?L?.interpolateVariablesInQueries([I],S.scopedVars,S.filters)[0]:I});return(0,t.H)(Promise.all(O)).pipe((0,n.Z)(I=>super.query({...S,targets:I})))}newQuery(S){return{refId:"--",datasource:a.dR,type:S?.type??y.Tz.math,...S}}}const C={id:-100,uid:y.Uj,name:a.dR.name,type:a.dR.type,access:"proxy",meta:{baseUrl:"",module:"",type:s.QE.datasource,name:a.dR.type,id:a.dR.type,info:{author:{name:"Grafana Labs"},logos:{small:"public/img/icn-datasource.svg",large:"public/img/icn-datasource.svg"},description:"Adds expression support to Grafana",screenshots:[],links:[],updated:"",version:""}},jsonData:{},readOnly:!0},b=new D(C);b.meta={id:a.dR.type,info:{logos:{small:"public/img/icn-datasource.svg",large:"public/img/icn-datasource.svg"}}},b.components={QueryEditor:E}},98808:(G,R,e)=>{"use strict";e.d(R,{z:()=>v});var t=e(74848),n=e(39268),s=e(14186),a=e(55852),r=e(14578),g=e(76942),i=e(32196),l=e(40845),d=e(67061),c=e(9261),h=e(90182),o=e(10354),m=e(55907);const u=m.A.reducerTypes.map(P=>({label:P.text,value:P.value})),p=m.A.evalOperators.map(P=>({label:P.text,value:P.value})),f=m.A.evalFunctions.map(P=>({label:P.text,value:P.value})),y=({condition:P,index:E,onChange:D,onRemoveCondition:C,refIds:b})=>{const T=(0,l.of)(x),S=A=>{D({...P,operator:{type:A.value}})},O=A=>{D({...P,reducer:{type:A.value,params:[]}})},M=A=>{D({...P,query:{params:[A.value]}})},I=A=>{D({...P,evaluator:{params:P.evaluator.params,type:A.value}})},L=(A,K)=>{const W=parseFloat(A.currentTarget.value),U=[...P.evaluator.params];U[K]=W,D({...P,evaluator:{...P.evaluator,params:U}})},B=(0,i.css)`
    width: 75px;
  `,j=P.evaluator.type===m.p.IsWithinRange||P.evaluator.type===m.p.IsOutsideRange;return(0,t.jsxs)(d.B,{children:[(0,t.jsxs)("div",{style:{flex:1},children:[(0,t.jsxs)(n.C,{children:[E===0?(0,t.jsx)("div",{className:(0,i.cx)(T.button,B),children:"WHEN"}):(0,t.jsx)(c.f,{className:(0,i.cx)(T.buttonSelectText,B),options:p,onChange:S,value:p.find(A=>A.value===P.operator.type)}),(0,t.jsx)(h.l6,{options:u,onChange:O,width:20,value:u.find(A=>A.value===P.reducer.type)}),(0,t.jsx)("div",{className:T.button,children:"OF"}),(0,t.jsx)(h.l6,{onChange:M,options:b,width:"auto",value:b.find(A=>A.value===P.query.params[0])})]}),(0,t.jsxs)(n.C,{children:[(0,t.jsx)(c.f,{className:T.buttonSelectText,options:f,onChange:I,value:f.find(A=>A.value===P.evaluator.type)}),j?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.p,{type:"number",width:10,onChange:A=>L(A,0),value:P.evaluator.params[0]}),(0,t.jsx)("div",{className:T.button,children:"TO"}),(0,t.jsx)(o.p,{type:"number",width:10,onChange:A=>L(A,1),value:P.evaluator.params[1]})]}):P.evaluator.type!==m.p.HasNoValue?(0,t.jsx)(o.p,{type:"number",width:10,onChange:A=>L(A,0),value:P.evaluator.params[0]}):null]})]}),(0,t.jsx)(a.$n,{variant:"secondary",type:"button",onClick:()=>C(E),children:(0,t.jsx)(r.I,{name:"trash-alt"})})]})},x=P=>{const E=(0,i.css)`
    color: ${P.colors.primary.text};
    font-size: ${P.typography.bodySmall.fontSize};
  `;return{buttonSelectText:E,button:(0,i.cx)((0,i.css)`
        display: flex;
        align-items: center;
        border-radius: ${P.shape.radius.default};
        font-weight: ${P.typography.fontWeightMedium};
        border: 1px solid ${P.colors.border.weak};
        white-space: nowrap;
        padding: 0 ${P.spacing(1)};
        background-color: ${P.colors.background.canvas};
      `,E)}},v=({onChange:P,query:E,refIds:D})=>{const C=(S,O)=>{E.conditions&&P({...E,conditions:[...E.conditions.slice(0,O),S,...E.conditions.slice(O+1)]})},b=()=>{if(E.conditions){const S=E.conditions.at(-1)?.query?.params??[],O={...g.P0,query:{params:S}};P({...E,conditions:E.conditions.length>0?[...E.conditions,O]:[O]})}},T=S=>{if(E.conditions){const O=E.conditions[S],M=E.conditions.filter(I=>I!==O).map((I,L)=>L===0?{...I,operator:{type:"when"}}:I);P({...E,conditions:M})}};return(0,t.jsxs)("div",{children:[(0,t.jsx)(n.C,{children:(0,t.jsx)(s.I,{label:"Conditions",labelWidth:14,children:(0,t.jsx)("div",{children:E.conditions?.map((S,O)=>{if(S)return(0,t.jsx)(y,{index:O,condition:S,onChange:M=>C(M,O),onRemoveCondition:T,refIds:D},O)})})})}),(0,t.jsx)(a.$n,{variant:"secondary",type:"button",onClick:b,children:(0,t.jsx)(r.I,{name:"plus-circle"})})]})}},71680:(G,R,e)=>{"use strict";e.d(R,{z:()=>h});var t=e(74848),n=e(32196),s=e(40845),a=e(67061),r=e(14186),g=e(76892),i=e(60782),l=e(14578),d=e(21744);const c="Math operations on one or more queries. You reference the query by ${refId} ie. $A, $B, $C etc\nThe sum of two scalar values: $A + $B > 10",h=({labelWidth:p,onChange:f,query:y,onRunQuery:x})=>{const v=D=>{f({...y,expression:D.target.value})},P=(0,s.of)(m),E=()=>{y.expression&&x()};return(0,t.jsx)(a.B,{children:(0,t.jsx)(r.I,{label:(0,t.jsx)(g.c,{width:"auto",children:(0,t.jsx)(i.G,{fitContent:!0,content:(0,t.jsxs)("div",{className:P.documentationContainer,children:[(0,t.jsxs)("div",{children:["Run math operations on one or more queries. You reference the query by ","${refId}"," ie. $A, $B, $C etc.",(0,t.jsx)("br",{}),"Example: ",(0,t.jsx)("code",{children:"$A + $B"})]}),(0,t.jsx)("header",{className:P.documentationHeader,children:"Available Math functions"}),(0,t.jsxs)("div",{className:P.documentationFunctions,children:[(0,t.jsx)(o,{name:"abs",description:"returns the absolute value of its argument which can be a number or a series"}),(0,t.jsx)(o,{name:"is_inf",description:"returns 1 for Inf values (negative or positive) and 0 for other values. It's able to operate on series or scalar values."}),(0,t.jsx)(o,{name:"is_nan",description:"returns 1 for NaN values and 0 for other values. It's able to operate on series or scalar values."}),(0,t.jsx)(o,{name:"is_null",description:"returns 1 for null values and 0 for other values. It's able to operate on series or scalar values."}),(0,t.jsx)(o,{name:"is_number",description:"returns 1 for all real number values and 0 for non-number. It's able to operate on series or scalar values."}),(0,t.jsx)(o,{name:"log",description:"returns the natural logarithm of its argument, which can be a number or a series"}),(0,t.jsx)(o,{name:"inf, infn, nan, and null",description:"The inf for infinity positive, infn for infinity negative, nan, and null functions all return a single scalar value that matches its name."}),(0,t.jsx)(o,{name:"round",description:"returns a rounded integer value. It's able to operate on series or escalar values."}),(0,t.jsx)(o,{name:"ceil",description:"rounds the number up to the nearest integer value. It's able to operate on series or escalar values."}),(0,t.jsx)(o,{name:"floor",description:"rounds the number down to the nearest integer value. It's able to operate on series or escalar values."})]})]}),title:(0,t.jsxs)(a.B,{gap:1,direction:"row",children:[(0,t.jsx)(l.I,{name:"book-open"})," Math operator"]}),footer:(0,t.jsxs)("div",{children:["See our additional documentation on"," ",(0,t.jsxs)("a",{className:P.documentationLink,target:"_blank",href:"https://grafana.com/docs/grafana/latest/panels/query-a-data-source/use-expressions-to-manipulate-data/about-expressions/#math",rel:"noreferrer",children:[(0,t.jsx)(l.I,{size:"xs",name:"external-link-alt"})," Math expressions"]}),"."]}),closeButton:!0,placement:"bottom-start",children:(0,t.jsxs)("div",{className:P.info,children:["Expression ",(0,t.jsx)(l.I,{name:"info-circle"})]})})}),labelWidth:p,grow:!0,shrink:!0,children:(0,t.jsx)(d.f,{value:y.expression,onChange:v,rows:1,placeholder:c,onBlur:E,style:{minWidth:250,lineHeight:"26px",minHeight:32}})})})},o=({name:p,description:f})=>{const y=(0,s.of)(u);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:y.name,children:p}),(0,t.jsx)("span",{className:y.description,children:f})]})},m=p=>({documentationHeader:(0,n.css)`
    font-size: ${p.typography.h5.fontSize};
    font-weight: ${p.typography.h5.fontWeight};
  `,documentationLink:(0,n.css)`
    color: ${p.colors.text.link};
  `,documentationContainer:(0,n.css)`
    display: flex;
    flex: 1;
    flex-direction: column;
    gap: ${p.spacing(2)};

    padding: ${p.spacing(1)} ${p.spacing(2)};
  `,documentationFunctions:(0,n.css)`
    display: grid;
    grid-template-columns: max-content auto;
    column-gap: ${p.spacing(2)};
  `,info:(0,n.css)`
    display: flex;
    flex-direction: row;
    align-items: center;
    cursor: pointer;
    gap: ${p.spacing(1)};
  `}),u=p=>({name:(0,n.css)`
    font-weight: ${p.typography.fontWeightBold};
  `,description:(0,n.css)`
    font-size: ${p.typography.bodySmall.fontSize};
    color: ${p.colors.text.disabled};
  `})},1712:(G,R,e)=>{"use strict";e.d(R,{Z:()=>i});var t=e(74848),n=e(14186),s=e(10354),a=e(39268),r=e(90182),g=e(66718);const i=({labelWidth:l="auto",onChange:d,refIds:c,query:h})=>{const o=g.Cu.find(P=>P.value===h.reducer),m=P=>{d({...h,expression:P.value})},u=P=>{d({...h,reducer:P.value})},p=P=>{d({...h,settings:P})},f=P=>{let E;switch(P.value){case g.Mt.ReplaceNonNumbers:let D=0;h.settings?.mode===g.Mt.ReplaceNonNumbers&&(D=h.settings?.replaceWithValue??0),E={mode:g.Mt.ReplaceNonNumbers,replaceWithValue:D};break;default:E={mode:P.value}}p(E)},y=P=>{const E=P.currentTarget.valueAsNumber;p({mode:g.Mt.ReplaceNonNumbers,replaceWithValue:E??0})},x=h.settings?.mode??g.Mt.Strict,v=()=>{if(x===g.Mt.ReplaceNonNumbers)return(0,t.jsx)(n.I,{label:"Replace With",labelWidth:l,children:(0,t.jsx)(s.p,{type:"number",width:10,onChange:y,value:h.settings?.replaceWithValue??0})})};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.C,{children:(0,t.jsx)(n.I,{label:"Input",labelWidth:l,children:(0,t.jsx)(r.l6,{onChange:m,options:c,value:h.expression,width:"auto"})})}),(0,t.jsxs)(a.C,{children:[(0,t.jsx)(n.I,{label:"Function",labelWidth:l,children:(0,t.jsx)(r.l6,{options:g.Cu,value:o,onChange:u,width:20})}),(0,t.jsx)(n.I,{label:"Mode",labelWidth:l,children:(0,t.jsx)(r.l6,{onChange:f,options:g.HZ,value:x,width:25})}),v()]})]})}},34263:(G,R,e)=>{"use strict";e.d(R,{C:()=>i});var t=e(74848),n=e(39268),s=e(14186),a=e(90182),r=e(10354),g=e(66718);const i=({labelWidth:l="auto",onChange:d,refIds:c,query:h})=>{const o=g.PN.find(x=>x.value===h.downsampler),m=g.iX.find(x=>x.value===h.upsampler),u=x=>{d({...h,window:x.target.value})},p=x=>{d({...h,expression:x.value})},f=x=>{d({...h,downsampler:x.value})},y=x=>{d({...h,upsampler:x.value})};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.C,{children:(0,t.jsx)(s.I,{label:"Input",labelWidth:l,children:(0,t.jsx)(a.l6,{onChange:p,options:c,value:h.expression,width:20})})}),(0,t.jsxs)(n.C,{children:[(0,t.jsx)(s.I,{label:"Resample to",labelWidth:l,tooltip:"10s, 1m, 30m, 1h",children:(0,t.jsx)(r.p,{onChange:u,value:h.window,width:15})}),(0,t.jsx)(s.I,{label:"Downsample",children:(0,t.jsx)(a.l6,{options:g.PN,value:o,onChange:f,width:25})}),(0,t.jsx)(s.I,{label:"Upsample",children:(0,t.jsx)(a.l6,{options:g.iX,value:m,onChange:y,width:25})})]})]})}},18225:(G,R,e)=>{"use strict";e.d(R,{k:()=>a});var t=e(74848),n=e(96540),s=e(6867);const a=({onChange:r,refIds:g,query:i})=>{const d=`select * from ${(0,n.useMemo)(()=>g.map(h=>h.value),[g])[0]} limit 1`,c=h=>{r({...i,expression:h})};return(0,t.jsx)(s.Y,{query:i.expression||d,onChange:c})}},76658:(G,R,e)=>{"use strict";e.d(R,{O:()=>S});var t=e(74848),n=e(32196),s=e(96540),a=e(46819),r=e(40845),g=e(39268),i=e(14186),l=e(90182),d=e(9261),c=e(10354),h=e(15292),o=e(2913),m=e(55907),u=e(66718),p=e(65307);const f=(0,p.VP)("thresold/updateRefId"),y=(0,p.VP)("thresold/updateThresholdType"),x=(0,p.VP)("thresold/updateThresholdParams"),v=(0,p.VP)("thresold/updateHysteresis"),P=(0,p.VP)("thresold/updateUnloadParams"),E=(0,p.vy)({type:u.Tz.threshold,refId:"",conditions:[]},I=>{I.addCase(f,(L,B)=>{L.expression=B.payload}),I.addCase(y,(L,B)=>{const j=B.payload.evalFunction,A=B.payload.onError;if(L.conditions[0].evaluator.type=j,!!L.conditions[0].unloadEvaluator){const W=D(L.conditions[0].evaluator.type);A&&A(void 0),L.conditions[0].evaluator.type=j;const U={type:W,params:L.conditions[0].evaluator?.params??[0,0]};L.conditions[0].unloadEvaluator=U}}),I.addCase(x,(L,B)=>{const{param:j,index:A}=B.payload;L.conditions[0].evaluator.params[A]=j}),I.addCase(v,(L,B)=>{const{hysteresisChecked:j,onError:A}=B.payload;j?L.conditions[0].unloadEvaluator={type:D(L.conditions[0].evaluator.type),params:L.conditions[0].evaluator?.params??[0,0]}:(L.conditions[0].unloadEvaluator=void 0,A&&A(void 0))}),I.addCase(P,(L,B)=>{const{param:j,index:A,onError:K}=B.payload;L.conditions[0].unloadEvaluator?L.conditions[0].unloadEvaluator.params[A]=j:L.conditions[0].unloadEvaluator={type:D(L.conditions[0].evaluator.type),params:L.conditions[0].evaluator?.params??[0,0]};const W=C(L.conditions[0]),{errorMsg:U,errorMsgFrom:F,errorMsgTo:V}=W??{};K&&K(U||F||V)})});function D(I){return I===m.p.IsAbove?m.p.IsBelow:I===m.p.IsBelow?m.p.IsAbove:I===m.p.IsWithinRange?m.p.IsOutsideRange:I===m.p.IsOutsideRange?m.p.IsWithinRange:m.p.IsBelow}function C(I){const{unloadEvaluator:L,evaluator:B}=I;if(!B)return;if(L?.params[0]===void 0||Number.isNaN(L?.params[0]))return{errorMsg:"This value cannot be empty"};const{type:j,params:A}=B,{params:K}=L;if(j===m.p.IsWithinRange||j===m.p.IsOutsideRange){if(K[0]===void 0||Number.isNaN(K[0]))return{errorMsgFrom:"This value cannot be empty"};if(K[1]===void 0||Number.isNaN(K[1]))return{errorMsgTo:"This value cannot be empty"}}const[W,U]=L.params,[F,V]=A;switch(j){case m.p.IsAbove:if(W>F)return{errorMsg:`Enter a number less than or equal to ${F}`};break;case m.p.IsBelow:if(W<F)return{errorMsg:`Enter a number more than or equal to ${F}`};break;case m.p.IsOutsideRange:if(W<F)return{errorMsgFrom:`Enter a number more than or equal to ${F}`};if(U>V)return{errorMsgTo:`Enter a number less than or equal to ${V}`};break;case m.p.IsWithinRange:if(W>F)return{errorMsgFrom:`Enter a number less than or equal to ${F}`};if(U<V)return{errorMsgTo:`Enter a number be more than or equal to ${V}`};break;default:throw new Error(`evaluator function type ${j} not supported.`)}}const b=m.p.IsAbove,T={type:"query",evaluator:{type:b,params:[0,0]},query:{params:[]},reducer:{params:[],type:"last"}},S=({labelWidth:I,onChange:L,refIds:B,query:j,onError:A,useHysteresis:K=!1})=>{const W=(0,r.of)(M),U={...j,conditions:j.conditions?.length?j.conditions:[T]},[F,V]=(0,s.useReducer)(E,U),w=F.conditions[0],z=u.zd.find(q=>q.value===F.conditions[0].evaluator?.type),N=q=>{V(f(q.value))};(0,s.useEffect)(()=>{F&&L(F)},[F]);const H=q=>{V(y({evalFunction:q.value??b,onError:A}))},Q=(q,ae)=>{V(x({param:parseFloat(q.currentTarget.value),index:ae}))},X=w.evaluator.type===m.p.IsWithinRange||w.evaluator.type===m.p.IsOutsideRange,ee=!!o.$W.featureToggles?.recoveryThreshold&&K;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.C,{children:(0,t.jsx)(i.I,{label:"Input",labelWidth:I,children:(0,t.jsx)(l.l6,{onChange:N,options:B,value:j.expression,width:20})})}),(0,t.jsxs)(g.C,{children:[(0,t.jsx)(d.f,{className:W.buttonSelectText,options:u.zd,onChange:H,value:z}),X?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.p,{type:"number",width:10,onChange:q=>Q(q,0),defaultValue:w.evaluator.params[0]}),(0,t.jsx)("div",{className:W.button,children:"TO"}),(0,t.jsx)(c.p,{type:"number",width:10,onChange:q=>Q(q,1),defaultValue:w.evaluator.params[1]})]}):(0,t.jsx)(c.p,{type:"number",width:10,onChange:q=>Q(q,0),defaultValue:w.evaluator.params[0]||0})]}),ee&&(0,t.jsx)(Z,{isRange:X,onError:A})]});function Z({isRange:q,onError:ae}){const k=!!w.unloadEvaluator,se=le=>{V(v({hysteresisChecked:le.currentTarget.checked,onError:ae})),te.current=!0},te=s.useRef(!0),ne=()=>{te.current=!1};return(0,t.jsxs)("div",{className:W.hysteresis,children:[(0,t.jsx)("div",{onMouseDown:ne,children:(0,t.jsx)(h.K,{showLabel:!0,label:"Custom recovery threshold",value:k,onChange:se,className:W.switch})}),k&&(0,t.jsx)(O,{isRange:q,condition:w,onError:ae,dispatch:V,allowOnblur:te})]})}};function O({isRange:I,condition:L,onError:B,dispatch:j,allowOnblur:A}){const K=(0,r.of)(M),W=(H,Q)=>{const X=parseFloat(H.currentTarget.value);j(P({param:X,index:Q,onError:B}))},U=C(L),{errorMsg:F,errorMsgFrom:V,errorMsgTo:w}=U??{};if(I)return(0,t.jsx)(z,{allowOnblur:A});return(0,t.jsx)(N,{allowOnblur:A});function z({allowOnblur:H}){return L.evaluator.type===m.p.IsWithinRange?(0,t.jsx)(g.C,{className:K.hysteresis,children:(0,t.jsx)(i.I,{label:"Stop alerting when outside range",labelWidth:"auto",children:(0,t.jsxs)(a.B,{direction:"row",gap:0,children:[(0,t.jsx)("div",{className:K.range,children:(0,t.jsx)(i.I,{invalid:!!V,error:V,className:K.noMargin,children:(0,t.jsx)(c.p,{type:"number",width:10,onBlur:Q=>H.current&&W(Q,0),defaultValue:L.unloadEvaluator?.params[0]})})}),(0,t.jsx)("div",{className:K.button,children:"TO"}),(0,t.jsx)("div",{className:K.range,children:(0,t.jsx)(i.I,{invalid:!!w,error:w,children:(0,t.jsx)(c.p,{type:"number",width:10,onBlur:Q=>H.current&&W(Q,1),defaultValue:L.unloadEvaluator?.params[1]})})})]})})}):(0,t.jsx)(g.C,{className:K.hysteresis,children:(0,t.jsx)(i.I,{label:"Stop alerting when inside range",labelWidth:"auto",children:(0,t.jsxs)(a.B,{direction:"row",gap:0,children:[(0,t.jsx)("div",{className:K.range,children:(0,t.jsx)(i.I,{invalid:!!V,error:V,children:(0,t.jsx)(c.p,{type:"number",width:10,onBlur:Q=>H.current&&W(Q,0),defaultValue:L.unloadEvaluator?.params[0]})})}),(0,t.jsx)("div",{className:K.button,children:"TO"}),(0,t.jsx)("div",{className:K.range,children:(0,t.jsx)(i.I,{invalid:!!w,error:w,children:(0,t.jsx)(c.p,{type:"number",width:10,onBlur:Q=>H.current&&W(Q,1),defaultValue:L.unloadEvaluator?.params[1]})})})]})})})}function N({allowOnblur:H}){return L.evaluator.type===m.p.IsAbove?(0,t.jsx)(g.C,{className:K.hysteresis,children:(0,t.jsx)(i.I,{label:"Stop alerting when below",labelWidth:"auto",invalid:!!F,error:F,children:(0,t.jsx)(c.p,{type:"number",width:10,onBlur:Q=>{H.current&&W(Q,0)},defaultValue:L.unloadEvaluator?.params[0]})})}):(0,t.jsx)(g.C,{className:K.hysteresis,children:(0,t.jsx)(i.I,{label:"Stop alerting when above",labelWidth:"auto",invalid:!!F,error:F,children:(0,t.jsx)(c.p,{type:"number",width:10,onBlur:Q=>{H.current&&W(Q,0)},defaultValue:L.unloadEvaluator?.params[0]})})})}}const M=I=>({buttonSelectText:(0,n.css)({color:I.colors.primary.text,fontSize:I.typography.bodySmall.fontSize,textTransform:"uppercase",padding:`0 ${I.spacing(1)}`}),button:(0,n.css)({height:"32px",color:I.colors.primary.text,fontSize:I.typography.bodySmall.fontSize,textTransform:"uppercase",display:"flex",alignItems:"center",borderRadius:I.shape.radius.default,fontWeight:I.typography.fontWeightBold,border:`1px solid ${I.colors.border.medium}`,whiteSpace:"nowrap",padding:`0 ${I.spacing(1)}`,backgroundColor:I.colors.background.primary}),range:(0,n.css)({width:"min-content"}),hysteresis:(0,n.css)({marginTop:I.spacing(2)}),switch:(0,n.css)({paddingLeft:I.spacing(1)}),noMargin:(0,n.css)({margin:0})})},69437:(G,R,e)=>{"use strict";e.d(R,{f:()=>s,z:()=>a});var t=e(26657),n=e(66718);const s=r=>{if(!r)return!1;if((0,t.s9)(r.datasource))return!0;const g=r;return typeof g.type!="string"?!1:Object.values(n.Tz).includes(g.type)};function a(r){return["avg","min","max","sum","count","last","median","diff","diff_abs","percent_diff","percent_diff_abs","count_non_null"].includes(r)}},66718:(G,R,e)=>{"use strict";e.d(R,{Cu:()=>l,HZ:()=>c,Mt:()=>d,NI:()=>g,PN:()=>h,Tz:()=>r,Uj:()=>a,iX:()=>o,uQ:()=>i,zd:()=>m});var t=e(75059),n=e(2913),s=e(55907);const a="__expr__";var r=(u=>(u.math="math",u.reduce="reduce",u.resample="resample",u.classic="classic_conditions",u.threshold="threshold",u.sql="sql",u))(r||{});const g=u=>{switch(u){case"math":return"Math";case"reduce":return"Reduce";case"resample":return"Resample";case"classic_conditions":return"Classic condition (legacy)";case"threshold":return"Threshold";case"sql":return"SQL"}},i=[{value:"math",label:"Math",description:"Free-form math formulas on time series or number data."},{value:"reduce",label:"Reduce",description:"Takes one or more time series returned from a query or an expression and turns each series into a single number."},{value:"resample",label:"Resample",description:"Changes the time stamps in each time series to have a consistent time interval."},{value:"classic_conditions",label:"Classic condition (legacy)",description:"Takes one or more time series returned from a query or an expression and checks if any of the series match the condition. Disables multi-dimensional alerts for this rule."},{value:"threshold",label:"Threshold",description:"Takes one or more time series returned from a query or an expression and checks if any of the series match the threshold condition."},{value:"sql",label:"SQL",description:"Transform data using SQL. Supports Aggregate/Analytics functions from DuckDB"}].filter(u=>u.value==="sql"?n.$W.featureToggles?.sqlExpressions:!0),l=[{value:t.gy.min,label:"Min",description:"Get the minimum value"},{value:t.gy.max,label:"Max",description:"Get the maximum value"},{value:t.gy.mean,label:"Mean",description:"Get the average value"},{value:t.gy.median,label:"Median",description:"Get the median value"},{value:t.gy.sum,label:"Sum",description:"Get the sum of all values"},{value:t.gy.count,label:"Count",description:"Get the number of values"},{value:t.gy.last,label:"Last",description:"Get the last value"}];var d=(u=>(u.Strict="",u.ReplaceNonNumbers="replaceNN",u.DropNonNumbers="dropNN",u))(d||{});const c=[{value:"",label:"Strict",description:"Result can be NaN if series contains non-numeric data"},{value:"dropNN",label:"Drop Non-numeric Values",description:"Drop NaN, +/-Inf and null from input series before reducing"},{value:"replaceNN",label:"Replace Non-numeric Values",description:"Replace NaN, +/-Inf and null with a constant value before reducing"}],h=[{value:t.gy.last,label:"Last",description:"Fill with the last value"},{value:t.gy.min,label:"Min",description:"Fill with the minimum value"},{value:t.gy.max,label:"Max",description:"Fill with the maximum value"},{value:t.gy.mean,label:"Mean",description:"Fill with the average value"},{value:t.gy.sum,label:"Sum",description:"Fill with the sum of all values"}],o=[{value:"pad",label:"pad",description:"fill with the last known value"},{value:"backfilling",label:"backfilling",description:"fill with the next known value"},{value:"fillna",label:"fillna",description:"Fill with NaNs"}],m=[{value:s.p.IsAbove,label:"Is above"},{value:s.p.IsBelow,label:"Is below"},{value:s.p.IsWithinRange,label:"Is within range"},{value:s.p.IsOutsideRange,label:"Is outside range"}]},76942:(G,R,e)=>{"use strict";e.d(R,{H3:()=>i,P0:()=>g,rV:()=>r});var t=e(75059),n=e(55907),s=e(69437),a=e(66718);const r=l=>{switch(l.type){case a.Tz.reduce:l.reducer||(l.reducer=t.gy.mean);break;case a.Tz.resample:l.downsampler||(l.downsampler=t.gy.mean),l.upsampler||(l.upsampler="fillna"),l.reducer=void 0;break;case a.Tz.math:l.expression=void 0;break;case a.Tz.classic:l.conditions||(l.conditions=[g]);break;default:l.reducer=void 0}return l},g={type:"query",reducer:{params:[],type:"avg"},operator:{type:"and"},query:{params:[]},evaluator:{params:[0,0],type:n.p.IsAbove}};function i(l){if((0,s.z)(l))return l}},71101:(G,R,e)=>{"use strict";e.d(R,{Cg:()=>i,Fk:()=>d,R4:()=>o,Rj:()=>g,pq:()=>l});var t=e(32264),n=e(8484),s=e(16233),a=e(36689),r=e(31678);const g="manage-folder",i=u=>`folder-dashboards-${u}`,l=u=>`folder-library-panels-${u}`,d=u=>`folder-alerting-${u}`,c=u=>`folder-permissions-${u}`,h=u=>`folder-settings-${u}`;function o(u,p){const f=p??("parents"in u?u.parents:void 0),y={icon:"folder",id:g,subTitle:(0,a.o)("manage-folder"),url:u.url,text:u.title,children:[{active:!1,icon:"apps",id:i(u.uid),text:(0,n.t)("browse-dashboards.manage-folder-nav.dashboards","Dashboards"),url:u.url}]};if(f&&f.length>0){const x=f[f.length-1],v=f.slice(0,f.length-1);y.parentItem=o(x,v)}return y.children.push({active:!1,icon:"library-panel",id:l(u.uid),text:(0,n.t)("browse-dashboards.manage-folder-nav.panels","Panels"),url:`${u.url}/library-panels`}),s.TP.hasPermission(r.AccessControlAction.AlertingRuleRead)&&t.$.unifiedAlertingEnabled&&y.children.push({active:!1,icon:"bell",id:d(u.uid),text:(0,n.t)("browse-dashboards.manage-folder-nav.alert-rules","Alert rules"),url:`${u.url}/alerting`}),y}function m(u){const p=o({created:"",createdBy:"",hasAcl:!1,updated:"",updatedBy:"",id:1,uid:"loading",title:"Loading",url:"url",canSave:!0,canEdit:!0,canAdmin:!0,canDelete:!0,version:0});return p.children[u].active=!0,{main:p,node:p.children[u]}}},54650:(G,R,e)=>{"use strict";e.d(R,{Ay:()=>d,jl:()=>g});var t=e(65307),n=e(55314);const s={id:0,uid:"loading",title:"loading",url:"",canSave:!1,canDelete:!1,hasChanged:!1,version:1},a=(c,h)=>({...c,...h.payload,hasChanged:!1}),r=(0,t.Z0)({name:"folder",initialState:s,reducers:{loadFolder:a,setFolderTitle:(c,h)=>({...c,title:h.payload,hasChanged:h.payload.trim().length>0})},extraReducers:c=>{c.addMatcher(n.vZ.getFolder.matchFulfilled,a)}}),{loadFolder:g,setFolderTitle:i}=r.actions,d={folder:r.reducer}},84350:(G,R,e)=>{"use strict";e.d(R,{G:()=>d});var t=e(74848),n=e(32196),s=e(96540),a=e(40845),r=e(90182),g=e(42418),i=e(67140);const l=[{label:"Countries",description:"Lookup countries by name, two letter code, or three letter code",value:i.fx},{label:"USA States",description:"Lookup states by name or 2 ",value:"public/gazetteer/usa-states.json"},{label:"Airports",description:"Lookup airports by id or code",value:"public/gazetteer/airports.geojson"}],d=({value:h,onChange:o,context:m,item:u})=>{const p=(0,a.of)(c),[f,y]=(0,s.useState)(),x=u.settings;(0,s.useEffect)(()=>{async function E(){const D=await(0,i.q3)(h);y(D)}E()},[h,y]);const{current:v,options:P}=(0,s.useMemo)(()=>{let E=x?.options?[...x.options]:[...l],D=E?.find(C=>C.value===f?.path);return!D&&f&&(D={label:f.path,value:f.path},E.push(D)),{options:E,current:D}},[f,x?.options]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.l6,{value:v,options:P,onChange:E=>o(E.value),allowCustomValue:!0,formatCreateLabel:E=>`Load from URL: ${E}`}),f&&(0,t.jsxs)(t.Fragment,{children:[f.error&&(0,t.jsx)(g.F,{title:f.error,severity:"warning"}),f.count&&(0,t.jsxs)("div",{className:p.keys,children:[(0,t.jsxs)("b",{children:["(",f.count,")"]}),f.examples(10).map(E=>(0,t.jsxs)("span",{children:[E,","]},E)),f.count>10&&" ..."]})]})]})},c=()=>({keys:(0,n.css)`
    margin-top: 4px;
    text-overflow: ellipsis;
    overflow: hidden;
    white-space: nowrap;

    > span {
      margin-left: 4px;
    }
  `})},61983:(G,R,e)=>{"use strict";e.d(R,{G:()=>x});var t=e(11261),n=e(52622),s=e(84350),a=e(74848),r=e(32196),g=e(96540),i=e(13544),l=e(40845),d=e(42418),c=e(14578),h=e(90182),o=e(66864),m=e(31484);const u=[{value:n.aG.Auto,label:"Auto",ariaLabel:i.Tp.components.Transforms.SpatialOperations.location.autoOption,description:"Automatically identify location data based on default field names"},{value:n.aG.Coords,label:"Coords",ariaLabel:i.Tp.components.Transforms.SpatialOperations.location.coords.option,description:"Specify latitude and longitude fields"},{value:n.aG.Geohash,label:"Geohash",ariaLabel:i.Tp.components.Transforms.SpatialOperations.location.geohash.option,description:"Specify geohash field"},{value:n.aG.Lookup,label:"Lookup",ariaLabel:i.Tp.components.Transforms.SpatialOperations.location.lookup.option,description:"Specify Gazetteer and lookup field"}],p="https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/geomap/#location",f=({value:v,onChange:P,context:E,item:D})=>{const[C,b]=(0,g.useState)();(0,g.useEffect)(()=>{D.settings?.source&&D.settings?.data?.length&&D.settings.data[0]&&(0,m.nE)(D.settings.source).then(O=>{D.settings&&D.settings.data&&b((0,m.FM)(D.settings.data[0],O))})},[D.settings]);const T=(0,l.of)(y),S=()=>{if(C){if(C.warning)return(0,a.jsx)(d.F,{title:C.warning,severity:"warning",buttonContent:(0,a.jsx)(c.I,{name:"question-circle",size:"xl"}),className:T.alert,onRemove:()=>{const O=window.open(p,"_blank","noopener,noreferrer");O&&(O.opener=null)}});if(v===n.aG.Auto&&C.description)return(0,a.jsx)("span",{children:C.description})}return null};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.l6,{options:u,value:v,onChange:O=>{P(O.value)}}),(0,a.jsx)(o.Gy,{className:T.hGroup,children:S()})]})},y=v=>({alert:(0,r.css)`
      & div {
        padding: 4px;
      }
      margin-bottom: 0px;
      margin-top: 5px;
      padding: 2px;
    `,hGroup:(0,r.css)`
      & div {
        width: 100%;
      }
    `});function x(v,P,E,D,C){switch(E.addCustomEditor({id:"modeEditor",path:`${P}mode`,name:"Location Mode",editor:f,settings:{data:C,source:D}}),D?.mode){case n.aG.Coords:E.addFieldNamePicker({path:`${P}latitude`,name:"Latitude field",settings:{filter:b=>b.type===t.PU.number,noFieldsMessage:"No numeric fields found"}}).addFieldNamePicker({path:`${P}longitude`,name:"Longitude field",settings:{filter:b=>b.type===t.PU.number,noFieldsMessage:"No numeric fields found"}});break;case n.aG.Geohash:E.addFieldNamePicker({path:`${P}geohash`,name:"Geohash field",settings:{filter:b=>b.type===t.PU.string,noFieldsMessage:"No strings fields found"}});break;case n.aG.Lookup:E.addFieldNamePicker({path:`${P}lookup`,name:"Lookup field",settings:{filter:b=>b.type===t.PU.string,noFieldsMessage:"No strings fields found"}}).addCustomEditor({id:"gazetteer",path:`${P}gazetteer`,name:"Gazetteer",editor:s.G})}}},96606:(G,R,e)=>{"use strict";e.d(R,{RA:()=>o,XR:()=>m,Dc:()=>h,qy:()=>d,Pz:()=>c});var t=e(44294),n=e(34338),s=e(11217),a=e(22796),r=e(11261),g=e(78134);function i(p){if(!p?.length)return;const f=[16,8,4,2,1],y="0123456789bcdefghjkmnpqrstuvwxyz";let x=!0;const v=[],P=[];v[0]=-90,v[1]=90,P[0]=-180,P[1]=180;let E;p.split("").forEach(b=>{E=y.indexOf(b),f.forEach(T=>{l(x?P:v,E,T),x=!x})});const D=(v[0]+v[1])/2;return[(P[0]+P[1])/2,D]}function l(p,f,y){f&y?p[0]=(p[0]+p[1])/2:p[1]=(p[0]+p[1])/2}function d(p){return{name:p.name??"Point",type:r.PU.geo,values:p.values.map(f=>{const y=i(f);if(y)return new t.A((0,a.Rb)(y))}),config:u}}function c(p,f){const y=new Array(p.values.length);for(let x=0;x<p.values.length;x++){const v=p.values[x],P=f.values[x];v===null||P===null||(y[x]=new t.A((0,a.Rb)([v,P])))}return{name:"Point",type:r.PU.geo,values:y,config:u}}function h(p,f){const y=f.values.length,x=new Array(y);for(let v=0;v<y;v++)x[v]=p.find(f.values[v])?.geometry();return{name:"Geometry",type:r.PU.geo,values:x,config:u}}function o(p,f){const y=p.values,x=f.values;if(!y||!x)throw"missing src/dest";if(y.length!==x.length)throw"Source and destination field lengths do not match";const v=p.values.length,P=new Array(v);for(let E=0;E<v;E++){const D=y[E],C=x[E];D&&C?P[E]=new n.A([D,C]):D?P[E]=D:C&&(P[E]=C)}return{name:"Geometry",type:r.PU.geo,values:P,config:u}}function m(p,f){const y=p.values,x=f.values;if(!y||!x)throw"missing src/dest";if(y.length!==x.length)throw"Source and destination field lengths do not match";const v=p.values.length,P=new Array(v);for(let E=0;E<v;E++){const D=y[E],C=x[E];D&&C&&(P[E]=new s.A([(0,g.EX)(D),(0,g.EX)(C)]))}return{name:"Geometry",type:r.PU.geo,values:P,config:u}}const u=Object.freeze({custom:{hideFrom:{tooltip:!0}}})},67140:(G,R,e)=>{"use strict";e.d(R,{fx:()=>p,q3:()=>f});var t=e(70915),n=e(44294),s=e(14236),a=e(11261),r=e(17172),g=e(11365);function i(y){const x=new g.A().readFeatures(y,{featureProjection:"EPSG:3857"}),v=x.length,P=new Array(v).fill(null),E=[],D=new Map,C=O=>{let M=D.get(O);return M||(M={types:new Set,values:new Array(v).fill(null),count:0},E.push(O),D.set(O,M)),M},b=(...O)=>{for(const M of O)if(!D.has(M))return M;return"___"+O[0]},T={types:new Set,values:new Array(v).fill(null),count:0};for(let O=0;O<v;O++){const M=x[O];P[O]=M.getGeometry();const I=M.getId();I!=null&&(T.values[O]=I,T.types.add((0,s.oE)(I)),T.count++);for(const L of M.getKeys()){const B=M.get(L);if(B===P[O]||B==null)continue;const j=C(L);j.values[O]=B,j.types.add((0,s.oE)(B)),j.count++}}const S=[];if(T.count>0){const O=l(T);S.push({name:b("id","_id","__id"),type:O,values:T.values,config:{}})}S.push({name:b("geo","geometry"),type:a.PU.geo,values:P,config:{}});for(const O of E){const M=D.get(O);if(!M)continue;const I=l(M);S.push({name:O,type:I,values:M.values,config:{}})}return{fields:S,length:v}}function l(y){return y.count<1?a.PU.other:y.types.size>1?(y.values=y.values.map(x=>x!=null?`${x}`:x),a.PU.string):y.types.values().next().value}var d=e(96606),c=e(22796);function h(y,x){let v=0;const P=new Map;for(const E of x){const D=new n.A((0,c.Rb)([E.longitude,E.latitude])),C={point:()=>D,geometry:()=>D};if(E.name&&(P.set(E.name,C),P.set(E.name.toUpperCase(),C)),E.key&&(P.set(E.key,C),P.set(E.key.toUpperCase(),C)),E.keys)for(const b of E.keys)P.set(b,C),P.set(b.toUpperCase(),C);v++}return{path:y,find:E=>{let D=P.get(E);return!D&&typeof E=="string"&&(D=P.get(E.toUpperCase())),D},count:v,examples:E=>{const D=[];if(P.size<1)D.push("no values found");else for(const C of P.keys())if(D.push(C),D.length>=E)break;return D}}}function o(y,x){let v;if(Array.isArray(x)){const P=x[0];if(P.latitude&&P.longitude&&(P.key||P.keys))return h(y,x)}else Array.isArray(x?.features)&&x?.type==="FeatureCollection"&&(v=i(x));if(!v)try{v=(0,s.Vc)(x)}catch(P){return{path:y,error:`${P}`,find:E=>{},examples:E=>[]}}return m(v,{path:y})}function m(y,x){const v=[];let P,E,D,C,b;for(const O of y.fields)if(O.type===a.PU.geo&&(P=O),!b&&O.type===a.PU.string&&(b=O),O.name){x.keys&&x.keys.includes(O.name)&&v.push(O);const M=O.name.toUpperCase();switch(M){case"LAT":case"LATITUTE":E=O;break;case"LON":case"LNG":case"LONG":case"LONGITUE":D=O;break;case"GEOHASH":C=O;break;case"ID":case"UID":case"KEY":case"CODE":x.keys||v.push(O);break;default:x.keys||(M.endsWith("_ID")||M.endsWith("_CODE"))&&v.push(O)}}!v.length&&b&&v.push(b);let T=!1;P?T=P.values[0]?.getType()==="Point":C?(P=(0,d.qy)(C),T=!0):E&&D&&(P=(0,d.Pz)(D,E),T=!0);const S=new Map;return v.forEach(O=>{O.values.forEach((M,I)=>{const L=`${M}`;S.set(L.toUpperCase(),I),S.set(L,I)})}),{path:x.path,find:O=>{const M=S.get(O);if(M!=null){const I=P?.values[M];return{frame:y,index:M,point:()=>!I||T?I:new n.A((0,t.q1)(I.getExtent())),geometry:()=>I}}},examples:O=>{const M=[];for(let I of S.keys())if(M.push(I),M.length>O)break;return M},frame:()=>y,count:y.length}}const u={},p="public/gazetteer/countries.json";async function f(y){y||(y=p);let x=u[y];if(!x){try{const v=await(0,r.AI)().get(y);x=o(y,v)}catch(v){console.warn("Error loading placename lookup",y,v),x={path:y,error:"Error loading URL",find:P=>{},examples:P=>[]}}u[y]=x}return x}},31484:(G,R,e)=>{"use strict";e.d(R,{FM:()=>m,nE:()=>h});var t=e(28240),n=e(11261),s=e(85200),a=e(1173),r=e(52622),g=e(96606),i=e(67140);function l(u){return p=>{for(const f of p.fields)if(u(f,p,[]))return f}}function d(u){return p=>{for(const f of p.fields){if(u.has(f.name.toLowerCase()))return f;const y=(0,t.Ct)(f,p);if(u.has(y))return f}}}const c={mode:r.aG.Auto,geohash:d(new Set(["geohash"])),latitude:d(new Set(["latitude","lat"])),longitude:d(new Set(["longitude","lon","lng"])),h3:d(new Set(["h3"])),wkt:d(new Set(["wkt"])),lookup:d(new Set(["lookup"])),geo:u=>u.fields.find(p=>p.type===n.PU.geo)};async function h(u){const p={...c,mode:u?.mode??r.aG.Auto};switch(p.gazetteer=await(0,i.q3)(u?.gazetteer),p.mode){case r.aG.Geohash:u?.geohash?p.geohash=l((0,s.NS)({id:a.Ct.byName,options:u.geohash})):p.geohash=()=>{};break;case r.aG.Lookup:const f=u?.lookup?.length?(0,s.NS)({id:a.Ct.byName,options:u.lookup}):(0,s.NS)({id:a.Ct.byType,options:n.PU.string});p.lookup=l(f);break;case r.aG.Coords:u?.latitude?p.latitude=l((0,s.NS)({id:a.Ct.byName,options:u.latitude})):p.latitude=()=>{},u?.longitude?p.longitude=l((0,s.NS)({id:a.Ct.byName,options:u.longitude})):p.longitude=()=>{};break}return p}function o(u,p){const f={mode:p.mode??r.aG.Auto};if(f.mode===r.aG.Auto){if(f.geo=p.geo(u),f.geo)return f;if(f.latitude=p.latitude(u),f.longitude=p.longitude(u),f.latitude&&f.longitude)return f.mode=r.aG.Coords,f;if(f.geohash=p.geohash(u),f.geohash)return f.mode=r.aG.Geohash,f;if(f.lookup=p.lookup(u),f.lookup)return f.mode=r.aG.Lookup,f}switch(f.mode){case r.aG.Coords:f.latitude=p.latitude(u),f.longitude=p.longitude(u);break;case r.aG.Geohash:f.geohash=p.geohash(u);break;case r.aG.Lookup:f.lookup=p.lookup(u);break}return f}function m(u,p){const f=o(u,p);switch(f.mode){case r.aG.Auto:return f.geo?{field:f.geo}:{warning:"Unable to find location fields"};case r.aG.Coords:return f.latitude&&f.longitude?{field:(0,g.Pz)(f.longitude,f.latitude),derived:!0,description:`${f.mode}: ${f.latitude.name}, ${f.longitude.name}`}:{warning:"Select latitude/longitude fields"};case r.aG.Geohash:return f.geohash?{field:(0,g.qy)(f.geohash),derived:!0,description:`${f.mode}`}:{warning:"Select geohash field"};case r.aG.Lookup:return f.lookup?p.gazetteer?{field:(0,g.Dc)(p.gazetteer,f.lookup),derived:!0,description:`${f.mode}: ${p.gazetteer.path}`}:{warning:"Gazetteer not found"}:{warning:"Select lookup field"}}return{warning:"unable to find geometry"}}},61453:(G,R,e)=>{"use strict";e.d(R,{q:()=>L});var t=e(74848),n=e(2543),s=e(96540),a=e(70713),r=e(18282),g=e(2514),i=e(90708),l=e(13544),d=e(14110),c=e(72574),h=e(55852),o=e(62930),m=e(77093),u=e(2913),p=e(8484),f=e(69147),y=e(28240),x=e(40845),v=e(66864),P=e(88575),E=e(90182),D=e(15292),C=e(7788),b=e(32196);const T=j=>(0,b.css)`
  padding: ${j.spacing(0,2)};
  font-size: ${j.typography.bodySmall.fontSize};
  color: ${j.colors.text.secondary};
  overflow: hidden;
  text-overflow: ellipsis;
`,S=({children:j})=>{const A=(0,x.of)(T);return(0,t.jsx)("div",{className:A,children:j})};var O=e(26323);const M=({options:j,actions:A,formattedDataDescription:K,onOptionsChange:W,hasTransformations:U,data:F,dataFrames:V,transformationOptions:w,selectedDataFrame:z,onDataFrameChange:N,downloadForExcel:H,toggleDownloadForExcel:Q})=>{const X=(0,x.of)(O.A);let ee=V;z===r.F.joinByField&&(ee=F);const Z=ee.map((k,se)=>({value:se,label:`${(0,y.Ri)(k)} (${se})`})),q=[...w,...Z];function ae(){let k="";if(!F)return k;const se=[];return z===r.F.joinByField?se.push((0,p.t)("dashboard.inspect-data.series-to-columns","Series joined by time")):F.length>1&&se.push((0,y.Ri)(F[z])),(j.withTransforms||j.withFieldConfig)&&(j.withTransforms&&se.push((0,p.t)("dashboard.inspect-data.panel-transforms","Panel transforms")),j.withTransforms&&j.withFieldConfig,j.withFieldConfig&&se.push((0,p.t)("dashboard.inspect-data.formatted","Formatted data"))),H&&se.push((0,p.t)("dashboard.inspect-data.excel-header","Excel header")),se.join(", ")}return(0,t.jsx)("div",{className:X.dataDisplayOptions,children:(0,t.jsx)(C.u,{id:"Data options",index:0,title:(0,p.t)("dashboard.inspect-data.data-options","Data options"),headerElement:(0,t.jsx)(S,{children:ae()}),isOpen:!1,actions:A,children:(0,t.jsx)("div",{className:X.options,"data-testid":"dataOptions",children:(0,t.jsxs)(v.gW,{spacing:"none",children:[F.length>1&&(0,t.jsx)(P.D,{label:(0,p.t)("dashboard.inspect-data.dataframe-label","Show data frame"),children:(0,t.jsx)(E.l6,{options:q,value:z,onChange:N,width:30,"aria-label":(0,p.t)("dashboard.inspect-data.dataframe-aria-label","Select dataframe")})}),(0,t.jsxs)(v.Gy,{children:[U&&W&&(0,t.jsx)(P.D,{label:(0,p.t)("dashboard.inspect-data.transformations-label","Apply panel transformations"),description:(0,p.t)("dashboard.inspect-data.transformations-description","Table data is displayed with transformations defined in the panel Transform tab."),children:(0,t.jsx)(D.d,{value:!!j.withTransforms,onChange:()=>W({...j,withTransforms:!j.withTransforms})})}),W&&(0,t.jsx)(P.D,{label:(0,p.t)("dashboard.inspect-data.formatted-data-label","Formatted data"),description:K||(0,p.t)("dashboard.inspect-data.formatted-data-description","Table data is formatted with options defined in the Field and Override tabs."),children:(0,t.jsx)(D.d,{id:"formatted-data-toggle",value:!!j.withFieldConfig,onChange:()=>W({...j,withFieldConfig:!j.withFieldConfig})})}),(0,t.jsx)(P.D,{label:(0,p.t)("dashboard.inspect-data.download-excel-label","Download for Excel"),description:(0,p.t)("dashboard.inspect-data.download-excel-description","Adds header to CSV for use with Excel"),children:(0,t.jsx)(D.d,{id:"excel-toggle",value:H,onChange:Q})})]})]})})})})};var I=e(18358);class L extends s.PureComponent{constructor(A){super(A),this.onExportLogsAsTxt=()=>{const{data:K,dataName:W,app:U}=this.props;(0,d.rR)("grafana_logs_download_logs_clicked",{app:U,format:"logs",area:"inspector"});const F=(0,f.HT)(K||[]);(0,I.Zy)(F,W)},this.onExportTracesAsJson=()=>{const{data:K,dataName:W,app:U}=this.props;if(K)for(const F of K){if(F.meta?.preferredVisualisationType!=="trace")continue;const V=(0,I.ek)(F,W+"-traces");(0,d.rR)("grafana_traces_download_traces_clicked",{app:U,grafana_version:u.$W.buildInfo.version,trace_format:V,location:"inspector"})}},this.onExportServiceGraph=()=>{const{data:K,dataName:W,app:U}=this.props;(0,d.rR)("grafana_traces_download_service_graph_clicked",{app:U,grafana_version:u.$W.buildInfo.version,location:"inspector"}),K&&(0,I.ny)(K,W)},this.onDataFrameChange=K=>{this.setState({transformId:K.value===r.F.joinByField?r.F.joinByField:r.F.noop,dataFrameIndex:typeof K.value=="number"?K.value:0,selectedDataFrame:K.value})},this.onToggleDownloadForExcel=()=>{this.setState(K=>({downloadForExcel:!K.downloadForExcel}))},this.state={selectedDataFrame:0,dataFrameIndex:0,transformId:r.F.noop,transformationOptions:B(),transformedData:A.data??[],downloadForExcel:!1}}componentDidUpdate(A,K){if(!this.props.data){this.setState({transformedData:[]});return}if(this.props.options.withTransforms){this.setState({transformedData:this.props.data});return}if(A.data!==this.props.data||K.transformId!==this.state.transformId){const W=this.state.transformationOptions.find(U=>U.value===this.state.transformId);if(W&&W.transformer.id!==r.F.noop){const U=this.state.selectedDataFrame,F=this.state.dataFrameIndex,V=(0,g.m)([W.transformer],this.props.data).subscribe(w=>{this.setState({transformedData:w,selectedDataFrame:U,dataFrameIndex:F},()=>V.unsubscribe())});return}this.setState({transformedData:this.props.data});return}}exportCsv(A,K){const{dataName:W}=this.props,{transformId:U}=this.state,F=A[this.state.dataFrameIndex];K&&(0,d.rR)("grafana_logs_download_clicked",{app:this.props.app,format:"csv"}),(0,I.EM)(F,W,{useExcelHeader:this.state.downloadForExcel},U)}getProcessedData(){const{options:A,panelPluginId:K,fieldConfig:W,timeZone:U}=this.props,F=this.state.transformedData;if(!A.withFieldConfig)return(0,i.K3)(F);let V=W??{defaults:{},overrides:[]};return K==="table"&&W&&(V=this.cleanTableConfigFromFieldConfig(W)),(0,i.we)({data:F,theme:u.$W.theme2,fieldConfig:V,timeZone:U,replaceVariables:(w,z,N)=>(0,c.w)().replace(w,z,N)})}cleanTableConfigFromFieldConfig(A){A=(0,n.cloneDeep)(A),A.defaults.custom={};for(const K of A.overrides)for(const W of K.properties)if(W.id.startsWith("custom.")){const U=K.properties.indexOf(W);K.properties.slice(U,1)}return A}renderActions(A,K,W,U){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.$n,{variant:"primary",onClick:()=>this.exportCsv(A,K),size:"sm",children:(0,t.jsx)(p.x6,{i18nKey:"dashboard.inspect-data.download-csv",children:"Download CSV"})}),K&&(0,t.jsx)(h.$n,{variant:"primary",onClick:this.onExportLogsAsTxt,size:"sm",children:(0,t.jsx)(p.x6,{i18nKey:"dashboard.inspect-data.download-logs",children:"Download logs"})}),W&&(0,t.jsx)(h.$n,{variant:"primary",onClick:this.onExportTracesAsJson,size:"sm",children:(0,t.jsx)(p.x6,{i18nKey:"dashboard.inspect-data.download-traces",children:"Download traces"})}),U&&(0,t.jsx)(h.$n,{variant:"primary",onClick:this.onExportServiceGraph,size:"sm",children:(0,t.jsx)(p.x6,{i18nKey:"dashboard.inspect-data.download-service",children:"Download service graph"})})]})}render(){const{isLoading:A,options:K,data:W,formattedDataDescription:U,onOptionsChange:F,hasTransformations:V}=this.props,{dataFrameIndex:w,transformationOptions:z,selectedDataFrame:N,downloadForExcel:H}=this.state,Q=(0,O.c)();if(A)return(0,t.jsxs)("div",{children:[(0,t.jsx)(o.y,{inline:!0})," Loading"]});const X=this.getProcessedData();if(!X||!X.length)return(0,t.jsx)("div",{children:"No Data"});const ee=X[w]?w:0,Z=X[ee],q=X.some(se=>se?.meta?.preferredVisualisationType==="logs"),ae=X.some(se=>se?.meta?.preferredVisualisationType==="trace"),k=X.some(se=>se?.meta?.preferredVisualisationType==="nodeGraph");return(0,t.jsxs)("div",{className:Q.wrap,"aria-label":l.Tp.components.PanelInspector.Data.content,children:[(0,t.jsx)("div",{className:Q.toolbar,children:(0,t.jsx)(M,{data:W,hasTransformations:V,options:K,dataFrames:X,transformationOptions:z,selectedDataFrame:N,downloadForExcel:H,formattedDataDescription:U,onOptionsChange:F,onDataFrameChange:this.onDataFrameChange,toggleDownloadForExcel:this.onToggleDownloadForExcel,actions:this.renderActions(X,q,ae,k)})}),(0,t.jsx)("div",{className:Q.content,children:(0,t.jsx)(a.Ay,{children:({width:se,height:te})=>se===0?null:(0,t.jsx)(m.X,{width:se,height:te,data:Z,showTypeIcons:!0})})})]})}}function B(){return[{value:r.F.joinByField,label:(0,p.t)("dashboard.inspect-data.transformation","Series joined by time"),transformer:{id:r.F.joinByField,options:{byField:void 0}}}]}},32067:(G,R,e)=>{"use strict";e.d(R,{N:()=>u});var t=e(74848),n=e(32196),s=e(13544),a=e(8484),r=e(57875),g=e(11261),i=e(83195),l=e(40845);const d=({timeZone:f,name:y,stats:x})=>{const v=(0,l.$j)(),P=(0,l.of)(h);return!x||!x.length?null:(0,t.jsxs)("div",{className:P.wrapper,children:[(0,t.jsx)("div",{className:P.heading,children:y}),(0,t.jsx)("table",{className:"filter-table width-30",children:(0,t.jsx)("tbody",{children:x.map((E,D)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:E.displayName}),(0,t.jsx)("td",{className:P.cell,children:c(E,f,v)})]},`${E.displayName}-${D}`))})})]})};function c(f,y,x){const v=(0,r.J)({field:{type:g.PU.number,config:f},theme:x,timeZone:y});return(0,i.cN)(v(f.value))}const h=f=>({heading:(0,n.css)({fontSize:f.typography.body.fontSize,marginBottom:f.spacing(1)}),wrapper:(0,n.css)({paddingBottom:f.spacing(2)}),cell:(0,n.css)({textAlign:"right"})}),o=({name:f,traceIds:y})=>{const x=(0,l.of)(m);return y.length===0?null:(0,t.jsxs)("div",{className:x.wrapper,children:[(0,t.jsx)("div",{className:x.heading,children:f}),(0,t.jsx)("table",{className:"filter-table width-30",children:(0,t.jsx)("tbody",{children:y.map((v,P)=>(0,t.jsx)("tr",{children:(0,t.jsx)("td",{children:v})},`${v}-${P}`))})})]})},m=f=>({heading:(0,n.css)({fontSize:f.typography.body.fontSize,marginBottom:f.spacing(1)}),wrapper:(0,n.css)({paddingBottom:f.spacing(2)}),cell:(0,n.css)({textAlign:"right"})}),u=({data:f,timeZone:y})=>{if(!f.request)return null;let x=[];const v=f.request.endTime?f.request.endTime-f.request.startTime:-1,P=f.timings?.dataProcessingTime||-1;let E=0;for(const S of f.series)E+=S.length;v>0&&x.push({displayName:(0,a.t)("dashboard.inspect-stats.request-time","Total request time"),value:v,unit:"ms"}),P>0&&x.push({displayName:(0,a.t)("dashboard.inspect-stats.processing-time","Data processing time"),value:P,unit:"ms"}),x.push({displayName:(0,a.t)("dashboard.inspect-stats.queries","Number of queries"),value:f.request.targets?.length??0}),x.push({displayName:(0,a.t)("dashboard.inspect-stats.rows","Total number rows"),value:E});let D=[];for(const S of f.series)S.meta&&S.meta.stats&&(D=D.concat(S.meta.stats));const C=(0,a.t)("dashboard.inspect-stats.table-title","Stats"),b=(0,a.t)("dashboard.inspect-stats.data-title","Data source stats"),T=(0,a.t)("dashboard.inspect-stats.data-traceids","Trace IDs");return(0,t.jsxs)("div",{"aria-label":s.Tp.components.PanelInspector.Stats.content,className:p,children:[(0,t.jsx)(d,{timeZone:y,name:C,stats:x}),(0,t.jsx)(d,{timeZone:y,name:b,stats:D}),(0,t.jsx)(o,{name:T,traceIds:f.traceIds??[]})]})},p=(0,n.css)`
  height: 100%;
  overflow-y: scroll;
`},90820:(G,R,e)=>{"use strict";e.d(R,{e:()=>f});var t=e(74848),n=e(32196),s=e(96540),a=e(64423),r=e(39070),g=e(13544),i=e(32264),l=e(67061),d=e(55852),c=e(10534),h=e(39558),o=e(24022),m=e(8484),u=e(27677),p=e(26323);class f extends s.PureComponent{constructor(x){super(x),this.subs=new a.yU,this.setFormattedJson=v=>{this.formattedJson=v},this.getTextForClipboard=()=>JSON.stringify(this.formattedJson,null,2),this.onToggleExpand=()=>{this.setState(v=>({...v,allNodesExpanded:!this.state.allNodesExpanded}))},this.onToggleMocking=()=>{this.setState(v=>({...v,isMocking:!this.state.isMocking}))},this.getNrOfOpenNodes=()=>this.state.allNodesExpanded===null?3:this.state.allNodesExpanded?20:1,this.state={executedQueries:[],allNodesExpanded:null,isMocking:!1,mockedResponse:"",response:{}}}componentDidMount(){this.subs.add(u.IB.getInspectorStream().subscribe({next:x=>{let v=!0;if(this.props.instanceId&&x?.requestId&&(v=x.requestId.startsWith(this.props.instanceId)),v)return this.onDataSourceResponse(x.response)}}))}componentDidUpdate(x){this.props.data!==x.data&&this.updateQueryList()}updateQueryList(){const{data:x}=this.props,v=x.series,P=[];if(v?.length){let E;v.forEach((D,C)=>{const b=D.meta?.executedQueryString;if(b){const T=D.refId||"?";E?.refId===T?(E.frames++,E.rows+=D.length):(E={refId:T,frames:0,rows:D.length,query:b},P.push(E))}})}this.setState({executedQueries:P})}componentWillUnmount(){this.subs.unsubscribe()}onDataSourceResponse(x){x.config?.hideFromInspector||(x={...x},x.headers&&delete x.headers,x.config&&(x.request=x.config,delete x.config,delete x.request.transformRequest,delete x.request.transformResponse,delete x.request.paramSerializer,delete x.request.jsonpCallbackParam,delete x.request.headers,delete x.request.requestId,delete x.request.inspect,delete x.request.retry,delete x.request.timeout),x.data&&(x.response=x.data,delete x.config,delete x.data,delete x.status,delete x.statusText,delete x.ok,delete x.url,delete x.redirected,delete x.type,delete x.$$config),this.setState({response:x}))}renderExecutedQueries(x){if(!x.length)return null;const v={refId:(0,n.css)`
        font-weight: ${i.$.theme.typography.weight.semibold};
        color: ${i.$.theme.colors.textBlue};
        margin-right: 8px;
      `};return(0,t.jsx)("div",{children:x.map(P=>(0,t.jsxs)(l.B,{gap:1,direction:"column",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("span",{className:v.refId,children:[P.refId,":"]}),P.frames>1&&(0,t.jsxs)("span",{children:[P.frames," frames, "]}),(0,t.jsxs)("span",{children:[P.rows," rows"]})]}),(0,t.jsx)("pre",{children:P.query})]},P.refId))})}render(){const{allNodesExpanded:x,executedQueries:v,response:P}=this.state,{onRefreshQuery:E,data:D}=this.props,C=this.getNrOfOpenNodes(),b=(0,p.A)(i.$.theme2),T=Object.keys(P).length>0,S=D.state===r.Gu.Loading;return(0,t.jsxs)("div",{className:b.wrap,children:[(0,t.jsxs)("div",{"aria-label":g.Tp.components.PanelInspector.Query.content,children:[(0,t.jsx)("h3",{className:b.heading,children:"Query inspector"}),(0,t.jsx)("p",{className:"small muted",children:(0,t.jsx)(m.x6,{i18nKey:"inspector.query.description",children:"Query inspector allows you to view raw request and response. To collect this data Grafana needs to issue a new query. Click refresh button below to trigger a new query."})})]}),this.renderExecutedQueries(v),(0,t.jsxs)("div",{className:b.toolbar,children:[(0,t.jsx)(d.$n,{icon:"sync",onClick:E,"aria-label":g.Tp.components.PanelInspector.Query.refreshButton,children:(0,t.jsx)(m.x6,{i18nKey:"inspector.query.refresh",children:"Refresh"})}),T&&x&&(0,t.jsx)(d.$n,{icon:"minus",variant:"secondary",className:b.toolbarItem,onClick:this.onToggleExpand,children:(0,t.jsx)(m.x6,{i18nKey:"inspector.query.collapse-all",children:"Collapse all"})}),T&&!x&&(0,t.jsx)(d.$n,{icon:"plus",variant:"secondary",className:b.toolbarItem,onClick:this.onToggleExpand,children:(0,t.jsx)(m.x6,{i18nKey:"inspector.query.expand-all",children:"Expand all"})}),T&&(0,t.jsx)(c.b,{getText:this.getTextForClipboard,className:b.toolbarItem,icon:"copy",variant:"secondary",children:(0,t.jsx)(m.x6,{i18nKey:"inspector.query.copy-to-clipboard",children:"Copy to clipboard"})}),(0,t.jsx)("div",{className:"flex-grow-1"})]}),(0,t.jsxs)("div",{className:b.content,children:[S&&(0,t.jsx)(h._,{text:"Loading query inspector..."}),!S&&T&&(0,t.jsx)(o.B,{json:P,open:C,onDidRender:this.setFormattedJson}),!S&&!T&&(0,t.jsx)("p",{className:"muted",children:(0,t.jsx)(m.x6,{i18nKey:"inspector.query.no-data",children:"No request and response collected yet. Hit refresh button"})})]})]})}}},26323:(G,R,e)=>{"use strict";e.d(R,{A:()=>r,c:()=>a});var t=e(32196),n=e(3911),s=e(2913);const a=(0,n.N)(()=>r(s.$W.theme2)),r=g=>({heading:(0,t.css)({fontSize:g.typography.body.fontSize,marginBottom:g.spacing(1)}),wrap:(0,t.css)({display:"flex",flexDirection:"column",height:"100%",width:"100%",flex:"1 1 0",minHeight:0}),toolbar:(0,t.css)({display:"flex",width:"100%",flexGrow:0,alignItems:"center",justifyContent:"flex-end",marginBottom:g.v1.spacing.sm}),toolbarItem:(0,t.css)({marginLeft:g.v1.spacing.md}),content:(0,t.css)({flexGrow:1,height:"100%"}),editor:(0,t.css)({fontFamily:"monospace",height:"100%",flexGrow:1}),viewer:(0,t.css)({overflow:"scroll"}),dataFrameSelect:(0,t.css)({flexGrow:2}),leftActions:(0,t.css)({display:"flex",flexGrow:1,maxWidth:"85%","@media (max-width: 1345px)":{maxWidth:"75%"}}),options:(0,t.css)({paddingTop:g.v1.spacing.sm}),dataDisplayOptions:(0,t.css)({flexGrow:1,minWidth:"300px",marginRight:g.v1.spacing.sm}),selects:(0,t.css)({display:"flex","> *":{marginRight:g.v1.spacing.sm}})})},16560:(G,R,e)=>{"use strict";e.d(R,{q:()=>t});var t=(n=>(n.Data="data",n.Meta="meta",n.Error="error",n.Stats="stats",n.JSON="json",n.Query="query",n.Help="help",n))(t||{})},18358:(G,R,e)=>{"use strict";e.d(R,{ny:()=>j,EM:()=>B,Zy:()=>L,ek:()=>A});var t=e(4213),n=e.n(t),s=e(72724),a=e(18282),r=e(72436),g=e(37471),i=e(19071),l=e(2543);const c=Object.defineProperty({archiveEnabled:!1,dependencies:{dagMaxNumServices:100,menuEnabled:!0},linkPatterns:[],search:{maxLookback:{label:"2 Days",value:"2d"},maxLimit:1500},tracking:{gaID:null,trackErrors:!0}},"__mergeFields",{value:["dependencies","search","tracking"]});function h(){return defaultConfig}function o(K){return _get(h(),K)}function m(K){let W;const U=new Set(K.map(({spanID:F})=>F));for(let F=0;F<K.length;F++){if(K[F].references&&K[F].references.some(({traceID:N,spanID:H})=>N===K[F].traceID&&U.has(H)))continue;if(!W){W=K[F];continue}const w=K[F].references&&K[F].references.length||0,z=W.references&&W.references.length||0;(w<z||w===z&&K[F].startTime<W.startTime)&&(W=K[F])}return W?`${W.process.serviceName}: ${W.operationName}`:""}const u=(0,l.memoize)(m,K=>K.length?K[0].traceID:0);function p(K){const W=new Map,U=K.reduce((V,w)=>(V.some(z=>z.key===w.key&&z.value===w.value)?W.set(`${w.key}:${w.value}`,`Duplicate tag "${w.key}:${w.value}"`):V.push(w),V),[]),F=Array.from(W.values());return{dedupedTags:U,warnings:F}}function f(K,W){const U=K?.slice()??[],F=(W||[]).map(V=>V.toLowerCase());return U.sort((V,w)=>{const z=V.key.toLowerCase(),N=w.key.toLowerCase();for(let H=0;H<F.length;H++){const Q=F[H];if(z.startsWith(Q)&&!N.startsWith(Q))return-1;if(!z.startsWith(Q)&&N.startsWith(Q))return 1}return z>N?1:z<N?-1:0}),U}function y(K){if(!K?.traceID)return null;const W=K.traceID.toLowerCase();let U=0,F=Number.MAX_SAFE_INTEGER;const V=new Map,w=new Map;K.spans=K.spans.filter(Z=>!!Z.startTime),K.processes=Object.entries(K.processes).reduce((Z,[q,ae])=>(Z[q]={...ae,tags:f(ae.tags)},Z),{});const z=K.spans.length;for(let Z=0;Z<z;Z++){const q=K.spans[Z],{startTime:ae,duration:k,processID:se}=q;let te=q.spanID;ae<F&&(F=ae),ae+k>U&&(U=ae+k);const ne=V.get(te);ne!=null?(console.warn(`Dupe spanID, ${ne+1} x ${te}`,q,w.get(te)),_isEqual(q,w.get(te))&&console.warn("	 two spans with same ID have `isEqual(...) === true`"),V.set(te,ne+1),te=`${te}_${ne}`,q.spanID=te):V.set(te,1),q.process=K.processes[se],w.set(te,q)}const N=getTraceSpanIdsAsTree(K,w),H=[],Q={};N.walk((Z,q,ae=0)=>{if(Z==="__root__"||typeof Z!="string")return;const k=w.get(Z);if(!k)return;const{serviceName:se}=k.process;Q[se]=(Q[se]||0)+1,k.relativeStartTime=k.startTime-F,k.depth=ae-1,k.hasChildren=q.children.length>0,k.childSpanCount=q.children.length,k.warnings=k.warnings||[],k.tags=k.tags||[],k.references=k.references||[],k.childSpanIds=q.children.slice().sort((ne,le)=>{const re=w.get(ne.value),de=w.get(le.value);return de.startTime+de.duration-(re.startTime+re.duration)}).map(ne=>ne.value);const te=p(k.tags);k.tags=f(te.dedupedTags,getConfigValue("topTagPrefixes")),k.warnings=k.warnings.concat(te.warnings),k.references.forEach((ne,le)=>{const re=w.get(ne.spanID);re&&(ne.span=re,le>0&&(re.subsidiarilyReferencedBy=re.subsidiarilyReferencedBy||[],re.subsidiarilyReferencedBy.push({spanID:Z,traceID:W,span:k,refType:ne.refType})))}),H.push(k)});const X=getTraceName(H);return{services:Object.keys(Q).map(Z=>({name:Z,numberOfSpans:Q[Z]})),spans:H,traceID:W,traceName:X,processes:K.processes,duration:U-F,startTime:F,endTime:U}}function x(K){const W=K.spans.map(F=>v(F,K.processes)),U=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string},{name:"spanID",type:FieldType.string},{name:"parentSpanID",type:FieldType.string},{name:"operationName",type:FieldType.string},{name:"serviceName",type:FieldType.string},{name:"serviceTags",type:FieldType.other},{name:"startTime",type:FieldType.number},{name:"duration",type:FieldType.number},{name:"logs",type:FieldType.other},{name:"references",type:FieldType.other,values:[]},{name:"tags",type:FieldType.other},{name:"warnings",type:FieldType.other},{name:"stackTraces",type:FieldType.other}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"jaeger"}}});for(const F of W)U.add(F);return U}function v(K,W){const U=K.references?.find(F=>F.refType==="CHILD_OF")?.spanID;return{spanID:K.spanID,traceID:K.traceID,parentSpanID:U,operationName:K.operationName,startTime:K.startTime/1e3,duration:K.duration/1e3,logs:K.logs.map(F=>({...F,timestamp:F.timestamp/1e3})),tags:K.tags,warnings:K.warnings??void 0,stackTraces:K.stackTraces,references:K.references?.filter(F=>F.spanID!==U)??[],serviceName:W[K.processID].serviceName,serviceTags:W[K.processID].tags}}function P(K,W){const U=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Trace ID",links:[{title:"Trace: ${__value.raw}",url:"",internal:{datasourceUid:W.uid,datasourceName:W.name,query:{query:"${__value.raw}"}}}]}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Trace name"}},{name:"startTime",type:FieldType.time,config:{displayNameFromDS:"Start time"}},{name:"duration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"\xB5s"}}],meta:{preferredVisualisationType:"table"}}),F=K.map(E).sort((V,w)=>w?.startTime-V?.startTime);for(const V of F)U.add(V);return U}function E(K){const W=transformTraceData(K);if(W)return{traceID:W.traceID,startTime:W.startTime/1e3,duration:W.duration,traceName:W.traceName}}function D(K){let W={traceID:"",spans:[],processes:{},warnings:null},U=[];for(let F=0;F<K.length;F++){const V=K.get(F);W.traceID||(W.traceID=V.traceID),U.find(w=>w===V.serviceName)||(U.push(V.serviceName),W.processes[`p${U.length}`]={serviceName:V.serviceName,tags:V.serviceTags}),W.spans.push({traceID:V.traceID,spanID:V.spanID,duration:V.duration*1e3,references:V.parentSpanID?[{refType:"CHILD_OF",spanID:V.parentSpanID,traceID:V.traceID}]:[],flags:0,logs:V.logs.map(w=>({...w,timestamp:w.timestamp*1e3})),operationName:V.operationName,processID:Object.keys(W.processes).find(w=>W.processes[w].serviceName===V.serviceName)||"",startTime:V.startTime*1e3,tags:V.tags,warnings:V.warnings?V.warnings:null})}return{data:[W],total:0,limit:0,offset:0,errors:null}}function C(K){const W=K.map(b),U=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,values:[]},{name:"spanID",type:FieldType.string,values:[]},{name:"parentSpanID",type:FieldType.string,values:[]},{name:"operationName",type:FieldType.string,values:[]},{name:"serviceName",type:FieldType.string,values:[]},{name:"serviceTags",type:FieldType.other,values:[]},{name:"startTime",type:FieldType.number,values:[]},{name:"duration",type:FieldType.number,values:[]},{name:"logs",type:FieldType.other,values:[]},{name:"tags",type:FieldType.other,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"zipkin"}}});for(const F of W)U.add(F);return U}function b(K){const W={traceID:K.traceId,spanID:K.id,parentSpanID:K.parentId,operationName:K.name,serviceName:K.localEndpoint?.serviceName||K.remoteEndpoint?.serviceName||"unknown",serviceTags:S(K),startTime:K.timestamp/1e3,duration:K.duration/1e3,logs:K.annotations?.map(T)??[],tags:Object.keys(K.tags||{}).reduce((U,F)=>F==="error"?(U.push({key:"error",value:!0}),U.push({key:"errorValue",value:K.tags.error}),U):(U.push({key:F,value:K.tags[F]}),U),[])};return K.kind&&(W.tags=[{key:"kind",value:K.kind},...W.tags??[]]),K.shared&&(W.tags=[{key:"shared",value:K.shared},...W.tags??[]]),W}function T(K){return{timestamp:K.timestamp,fields:[{key:"annotation",value:K.value}]}}function S(K){const W=K.localEndpoint||K.remoteEndpoint;return W?[O("ipv4",W.ipv4),O("ipv6",W.ipv6),O("port",W.port),O("endpointType",K.localEndpoint?"local":"remote")].filter(U=>!!U):[]}function O(K,W){if(W)return{key:K,value:W}}const M=K=>{let W=[];for(let U=0;U<K.length;U++){const F=K.get(U);W.push({traceId:F.traceID,parentId:F.parentSpanID,name:F.operationName,id:F.spanID,timestamp:F.startTime*1e3,duration:F.duration*1e3,...I(F),annotations:F.logs.length?F.logs.map(V=>({timestamp:V.timestamp,value:V.fields[0].value})):void 0,tags:F.tags.length?F.tags.filter(V=>V.key!=="kind"&&V.key!=="endpointType"&&V.key!=="shared").reduce((V,w)=>w.key==="error"?{...V,[w.key]:F.tags.find(z=>z.key==="errorValue").value||""}:{...V,[w.key]:w.value},{}):void 0,kind:F.tags.find(V=>V.key==="kind")?.value,shared:F.tags.find(V=>V.key==="shared")?.value})}return W},I=K=>{const W=K.serviceTags.find(U=>U.key==="endpointType")?.value==="local"?"localEndpoint":"remoteEndpoint";return K.serviceName!=="unknown"?{[W]:{serviceName:K.serviceName,ipv4:K.serviceTags.find(U=>U.key==="ipv4")?.value,ipv6:K.serviceTags.find(U=>U.key==="ipv6")?.value,port:K.serviceTags.find(U=>U.key==="port")?.value}}:void 0};function L(K,W){let U="";K.meta?.forEach(w=>{const z=`${w.label}: ${JSON.stringify(w.value)}
`;U=U+z}),U=U+`

`,K.rows.forEach(w=>{const z=(0,s.LE)(w.timeEpochMs,{defaultWithMS:!0})+"	"+w.entry+`
`;U=U+z});const F=new Blob([U],{type:"text/plain;charset=utf-8"}),V=`${W}-logs-${(0,s.LE)(new Date)}.txt`;n()(F,V)}function B(K,W,U,F=a.F.noop){const V=(0,r._O)([K],U),w=U?.useExcelHeader?"\uFEFF":"",z=new Blob([w,V],{type:"text/csv;charset=utf-8"}),N=F!==a.F.noop?"-as-"+F.toLocaleLowerCase():"",H=`${W}-data${N}-${(0,s.LE)(new Date)}.csv`;n()(z,H)}function j(K,W){const U=new Blob([JSON.stringify(K)],{type:"application/json"}),F=`${W}-${(0,s.LE)(new Date)}.json`;n()(U,F)}function A(K,W){let U="otlp";switch(K.meta?.custom?.traceFormat){case"jaeger":{let F=D(new g.k(K));j(F,W),U="jaeger";break}case"zipkin":{let F=M(new g.k(K));j(F,W),U="zipkin";break}case"otlp":default:{let F=(0,i.xw)(new g.k(K));j(F,W);break}}return U}},77938:(G,R,e)=>{"use strict";e.d(R,{p:()=>s});var t=e(26272),n=e(28138);function s(r){let g="";try{g=JSON.stringify(r,a(),2)}catch(i){i instanceof Error&&(i.toString().includes("RangeError")||i.toString().includes("allocation size overflow"))?n.A.emit(t.r1.alertError,[i.toString(),"Cannot display JSON, the object is too big."]):n.A.emit(t.r1.alertError,[i instanceof Error?i.toString():i])}return g}function a(){const r=new WeakSet;return(g,i)=>{if(g==="__dataContext"||g==="__sceneObject")return"Filtered out in JSON serialization";if(typeof i=="object"&&i!==null){if(r.has(i))return;r.add(i)}return i}}},47259:(G,R,e)=>{"use strict";e.d(R,{G7:()=>a,KU:()=>r,eb:()=>g});var t=e(17172),n=e(10096),s=e(31678);const a=(0,s.createAsyncThunk)("users/fetchInvitees",async()=>n.TP.hasPermission(s.AccessControlAction.OrgUsersAdd)?await(0,t.AI)().get("/api/org/invites"):[]),r=(0,s.createAsyncThunk)("users/addInvitee",async(i,{dispatch:l})=>{await(0,t.AI)().post("/api/org/invites",i),await l(a())}),g=(0,s.createAsyncThunk)("users/revokeInvite",async i=>(await(0,t.AI)().patch(`/api/org/invites/${i}/revoke`,{}),i))},40823:(G,R,e)=>{"use strict";e.d(R,{Ay:()=>l,Tp:()=>a});var t=e(65307),n=e(47259);const s=(0,t.pU)({selectId:d=>d.code}),a=s.getSelectors(),r=s.getInitialState({status:"idle"}),l={invites:(0,t.Z0)({name:"invites",initialState:r,reducers:{},extraReducers:d=>{d.addCase(n.G7.pending,c=>{c.status="loading"}).addCase(n.G7.fulfilled,(c,{payload:h})=>{s.setAll(c,h),c.status="succeeded"}).addCase(n.G7.rejected,c=>{c.status="failed"}).addCase(n.eb.fulfilled,(c,{payload:h})=>{s.removeOne(c,h),c.status="succeeded"})}}).reducer}},96227:(G,R,e)=>{"use strict";e.d(R,{b:()=>f,o:()=>y});var t=e(74848),n=e(96540),s=e(40996),a=e(16817),r=e(17172),g=e(32264),i=e(88575),l=e(10354),d=e(67061),c=e(55852),h=e(37390),o=e(36607),m=e(8484),u=e(57767),p=e(88861);const f=({panel:x,initialFolderUid:v,onCreateLibraryPanel:P,onDismiss:E})=>{const[D,C]=(0,n.useState)(v),[b,T]=(0,n.useState)(x.title),[S,O]=(0,n.useState)(x.title),[M,I]=(0,n.useState)(!1);(0,n.useEffect)(()=>I(!0),[b]),(0,s.A)(()=>O(b),350,[b]);const{saveLibraryPanel:L}=(0,p.b)(),B=(0,n.useCallback)(()=>{x.libraryPanel={uid:"",name:b},L(x,D).then(K=>{(0,r.NF)(K)?x.libraryPanel=void 0:(E?.(),P?.(K))})},[x,b,L,D,E,P]),j=(0,a.A)(async()=>{try{return!(await(0,u.e9)(b)).some(K=>K.folderUid===D)}catch(K){return(0,r.NF)(K)&&(K.isHandled=!0),!0}finally{I(!1)}},[S,D]);console.log("isValidName:",j);const A=!j?.value&&j.value!==void 0&&b===S&&!M;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.D,{label:(0,m.t)("library-panel.add-modal.name","Library panel name"),invalid:A,error:A?(0,m.t)("library-panel.add-modal.error","Library panel with this name already exists"):"",children:(0,t.jsx)(l.p,{id:"share-panel-library-panel-name-input",name:"name",value:b,onChange:K=>T(K.currentTarget.value)})}),(0,t.jsx)(i.D,{label:(0,m.t)("library-panel.add-modal.folder","Save in folder"),description:(0,m.t)("library-panel.add-modal.folder-description","Library panel permissions are derived from the folder permissions"),children:(0,t.jsx)(o.d,{onChange:K=>C(K),value:D,inputId:"share-panel-library-panel-folder-picker"})}),g.$.featureToggles.newDashboardSharingComponent?(0,t.jsxs)(d.B,{gap:1,justifyContent:"start",children:[(0,t.jsx)(c.$n,{onClick:B,disabled:A,children:(0,t.jsx)(m.x6,{i18nKey:"share-panel.new-library-panel.create-button",children:"Create library panel"})}),(0,t.jsx)(c.$n,{variant:"secondary",onClick:E,fill:"outline",children:(0,t.jsx)(m.x6,{i18nKey:"share-panel.new-library-panel.cancel-button",children:"Cancel"})})]}):(0,t.jsxs)(h.a.ButtonRow,{children:[(0,t.jsx)(c.$n,{variant:"secondary",onClick:E,fill:"outline",children:(0,t.jsx)(m.x6,{i18nKey:"library-panel.add-modal.cancel",children:"Cancel"})}),(0,t.jsx)(c.$n,{onClick:B,disabled:A,children:(0,t.jsx)(m.x6,{i18nKey:"library-panel.add-modal.create",children:"Create library panel"})})]})]})},y=({isOpen:x=!1,panel:v,initialFolderUid:P,...E})=>(0,t.jsx)(h.a,{title:"Create library panel",isOpen:x,onDismiss:E.onDismiss,children:(0,t.jsx)(f,{panel:v,initialFolderUid:P,onDismiss:E.onDismiss})})},86474:(G,R,e)=>{"use strict";e.d(R,{E:()=>I});var t=e(74848),n=e(32196),s=e(96540),a=e(70255),r=e(32264),g=e(40845),i=e(14578),l=e(50720),d=e(72129),c=e(41394),h=e(25701),o=e(39070),m=e(37390),u=e(55852),p=e(43535),f=e(38928),y=e(57767),x=e(65307);const v={loadingState:o.Gu.Loading,dashboardTitles:[]},P=(0,x.VP)("libraryPanels/delete/searchCompleted"),E=(j=v,A)=>P.match(A)?{...j,dashboardTitles:A.payload.dashboards.map(K=>K.title),loadingState:o.Gu.Done}:j;function D(j){return async function(A){const K=await(0,y.xV)(j.uid);A(P({dashboards:K}))}}const C=({libraryPanel:j,onDismiss:A,onConfirm:K})=>{const W=(0,g.of)(p.o),[{dashboardTitles:U,loadingState:F},V]=(0,s.useReducer)(E,v),w=(0,s.useMemo)(()=>(0,f.QC)(V),[V]);(0,s.useEffect)(()=>{w(D(j))},[w,j]);const z=!!U.length,N=F===o.Gu.Done;return(0,t.jsxs)(m.a,{className:W.modal,title:"Delete library panel",icon:"trash-alt",onDismiss:A,isOpen:!0,children:[N?null:(0,t.jsx)(b,{}),N?(0,t.jsxs)("div",{children:[z?(0,t.jsx)(S,{dashboardTitles:U}):null,z?null:(0,t.jsx)(T,{}),(0,t.jsxs)(m.a.ButtonRow,{children:[(0,t.jsx)(u.$n,{variant:"secondary",onClick:A,fill:"outline",children:"Cancel"}),(0,t.jsx)(u.$n,{variant:"destructive",onClick:K,disabled:z,children:"Delete"})]})]}):null]})},b=()=>(0,t.jsx)("span",{children:"Loading library panel..."}),T=()=>{const j=(0,g.of)(p.o);return(0,t.jsx)("div",{className:j.modalText,children:"Do you want to delete this panel?"})},S=({dashboardTitles:j})=>{const A=(0,g.of)(p.o),K=j.length===1?"dashboard.":"dashboards.",W=`${j.length} ${K}`;return j.length===0?null:(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:A.textInfo,children:["This library panel can not be deleted because it is connected to ",(0,t.jsx)("strong",{children:W})," Remove the library panel from the dashboards listed below and retry."]}),(0,t.jsxs)("table",{className:A.myTable,children:[(0,t.jsx)("thead",{children:(0,t.jsx)("tr",{children:(0,t.jsx)("th",{children:"Dashboard name"})})}),(0,t.jsx)("tbody",{children:j.map((U,F)=>(0,t.jsx)("tr",{children:(0,t.jsx)("td",{children:U})},`dash-title-${F}`))})]})]})},O=({libraryPanel:j,onClick:A,onDelete:K,showSecondaryActions:W})=>{const[U,F]=(0,s.useState)(!1),V=()=>{K?.(j),F(!1)},w=r.$.panels[j.model.type]??(0,c.$)(j.model.type).meta;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.b,{isCurrent:!1,title:j.name,description:j.description,plugin:w,onClick:()=>A?.(j),onDelete:W?()=>F(!0):void 0,children:(0,t.jsx)(L,{libraryPanel:j})}),U&&(0,t.jsx)(C,{libraryPanel:j,onConfirm:V,onDismiss:()=>F(!1)})]})},M=({showSecondaryActions:j,rootProps:A})=>{const K=(0,g.of)(B);return(0,t.jsx)(h.b.Skeleton,{hasDelete:j,...A,children:(0,t.jsx)(a.A,{containerClassName:K.metaContainer,width:80})})},I=(0,d.j)(O,M);function L({libraryPanel:j}){const A=(0,g.of)(B);return!j.meta?.folderUid&&!j.meta?.folderName?null:j.meta.folderUid?(0,t.jsx)("span",{className:A.metaContainer,children:(0,t.jsxs)(l.N,{href:`/dashboards/f/${j.meta.folderUid}`,children:[(0,t.jsx)(i.I,{name:"folder-upload",size:"sm"}),(0,t.jsx)("span",{children:j.meta.folderName})]})}):(0,t.jsxs)("span",{className:A.metaContainer,children:[(0,t.jsx)(i.I,{name:"folder",size:"sm"}),(0,t.jsx)("span",{children:"Dashboards"})]})}function B(j){return{metaContainer:(0,n.css)({display:"flex",alignItems:"center",color:j.colors.text.secondary,fontSize:j.typography.bodySmall.fontSize,paddingTop:j.spacing(.5),svg:{marginRight:j.spacing(.5),marginBottom:3}})}}},16678:(G,R,e)=>{"use strict";e.d(R,{j:()=>b,s:()=>C});var t=e(74848),n=e(32196),s=e(96540),a=e(40996),r=e(40845),g=e(66864),i=e(67647),l=e(76459),d=e.n(l),c=e(55852),h=e(90182),o=e(14578),m=e(27677),u=e(64161),p=e(31678);function f({onChange:M,maxMenuHeight:I}){const L=(0,r.of)(x),[B,j]=(0,s.useState)(!1),A=(0,s.useCallback)(V=>y(V,j),[]),K=(0,s.useMemo)(()=>d()(A,300),[A]),[W,U]=(0,s.useState)([]),F=(0,s.useCallback)(V=>{const w=V.filter(z=>!!z.value).map(z=>z.value);M(w),U(V)},[M]);return(0,t.jsxs)("div",{className:L.container,children:[W.length>0&&(0,t.jsx)(c.$n,{size:"xs",icon:"trash-alt",fill:"text",className:L.clear,onClick:()=>M([]),"aria-label":"Clear folders",children:"Clear folders"}),(0,t.jsx)(h.Iv,{value:W,onChange:F,isLoading:B,loadOptions:K,maxMenuHeight:I,placeholder:"Filter by folder",noOptionsMessage:"No folders found",prefix:(0,t.jsx)(o.I,{name:"filter"}),"aria-label":"Folder filter",defaultOptions:!0})]})}async function y(M,I){I(!0);const L={query:M,type:u.G.DashFolder,permission:p.PermissionLevelString.View},j=(await(0,m.AI)().search(L)).map(A=>({label:A.title,value:{uid:A.uid,title:A.title}}));return(!M||"dashboards".includes(M.toLowerCase()))&&j.unshift({label:"Dashboards",value:{uid:"general",title:"Dashboards"}}),I(!1),j}function x(M){return{container:(0,n.css)({label:"container",position:"relative",minWidth:"180px",flexGrow:1}),clear:(0,n.css)({label:"clear",fontSize:M.spacing(1.5),position:"absolute",top:-M.spacing(4.5),right:0})}}var v=e(68313),P=e(73725),E=e(15054),D=e(83791),C=(M=>(M.Tight="tight",M.Spacious="spacious",M))(C||{});const b=({onClick:M,variant:I="spacious",currentPanelId:L,currentFolderUID:B,perPage:j=E.FG,showPanelFilter:A=!1,showFolderFilter:K=!1,showSort:W=!1,showSecondaryActions:U=!1})=>{const F=(0,r.of)(T,I),[V,w]=(0,s.useState)(""),[z,N]=(0,s.useState)("");(0,a.A)(()=>N(V),200,[V]);const[H,Q]=(0,s.useState)({}),[X,ee]=(0,s.useState)(B?[B]:[]),[Z,q]=(0,s.useState)([]),ae=W||A||K,k=I==="tight"?"lg":"xs";return(0,t.jsx)("div",{className:F.container,children:(0,t.jsxs)(g.gW,{spacing:k,children:[(0,t.jsxs)("div",{className:(0,n.cx)(F.gridContainer,{[F.tightLayout]:I==="tight"}),children:[(0,t.jsx)("div",{className:F.filterInputWrapper,children:(0,t.jsx)(i.Z,{value:V,onChange:w,placeholder:"Search by name or description",width:0,escapeRegex:!1})}),ae&&(0,t.jsx)(S,{showSort:W,showPanelFilter:A,showFolderFilter:K,onSortChange:Q,onFolderFilterChange:ee,onPanelFilterChange:q,sortDirection:H.value,variant:I})]}),(0,t.jsx)("div",{className:F.libraryPanelsView,children:(0,t.jsx)(D.y,{onClickCard:M,searchString:z,sortDirection:H.value,panelFilter:Z,folderFilter:X,currentPanelId:L,showSecondaryActions:U,perPage:j})})]})})};function T(M,I){return{filterInputWrapper:(0,n.css)({flexGrow:I==="tight"?1:"initial"}),container:(0,n.css)({width:"100%",overflowY:"auto",padding:M.spacing(1)}),libraryPanelsView:(0,n.css)({width:"100%"}),gridContainer:(0,n.css)({display:"flex",flexDirection:"column",width:"100%",columnGap:M.spacing(1),rowGap:M.spacing(1),paddingBottom:M.spacing(2)}),tightLayout:(0,n.css)({flexDirection:"row",rowGap:M.spacing(1)})}}const S=(0,s.memo)(({variant:M="spacious",showSort:I,showPanelFilter:L,showFolderFilter:B,sortDirection:j,onSortChange:A,onFolderFilterChange:K,onPanelFilterChange:W})=>{const U=(0,r.of)(O),F=(0,s.useCallback)(w=>W(w.map(z=>z.id)),[W]),V=(0,s.useCallback)(w=>K(w.map(z=>z.uid??"")),[K]);return(0,t.jsxs)("div",{className:(0,n.cx)(U.container,{[U.containerTight]:M==="tight"}),children:[I&&(0,t.jsx)(P.r,{value:j,onChange:A,filter:["alpha-asc","alpha-desc"]}),(B||L)&&(0,t.jsxs)("div",{className:(0,n.cx)(U.filterContainer,{[U.filterContainerTight]:M==="tight"}),children:[B&&(0,t.jsx)(f,{onChange:V}),L&&(0,t.jsx)(v.$,{onChange:F})]})]})});S.displayName="SearchControls";function O(M){return{container:(0,n.css)({display:"flex",gap:M.spacing(1),flexGrow:1,flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap"}),containerTight:(0,n.css)({flexGrow:"initial",flexDirection:"column",justifyContent:"normal"}),filterContainer:(0,n.css)({display:"flex",flexDirection:"row",gap:M.spacing(1)}),filterContainerTight:(0,n.css)({flexDirection:"column",marginLeft:"initial"})}}},83791:(G,R,e)=>{"use strict";e.d(R,{y:()=>p});var t=e(74848),n=e(32196),s=e(96540),a=e(40996),r=e(39070),g=e(40845),i=e(69529),l=e(72109),d=e(67061),c=e(19384),h=e(8484),o=e(86474),m=e(38928),u=e(8184);const p=({onClickCard:y,searchString:x,sortDirection:v,panelFilter:P,folderFilter:E,showSecondaryActions:D,currentPanelId:C,perPage:b=40,isWidget:T})=>{const S=(0,g.of)(f),[{libraryPanels:O,page:M,perPage:I,numberOfPages:L,loadingState:B,currentPanelId:j},A]=(0,s.useReducer)(u.w_,{...u.Xb,currentPanelId:C,perPage:b}),K=(0,s.useMemo)(()=>(0,m.QC)(A),[A]);(0,a.A)(()=>K((0,m.IF)({searchString:x,sortDirection:v,panelFilter:P,folderFilterUIDs:E,page:M,perPage:I,currentPanelId:j,isWidget:T})),300,[x,v,P,E,M,K]);const W=({uid:V})=>K((0,m.h4)(V,{searchString:x,sortDirection:v,panelFilter:P,folderFilterUIDs:E,page:M,perPage:I})),U=V=>K((0,u.yd)({page:V}));return!(x||P?.length||E?.length)&&B===r.Gu.Done&&O.length<1?(0,t.jsx)(i.p,{variant:"call-to-action",message:(0,h.t)("library-panel.empty-state.message","You haven't created any library panels yet"),children:(0,t.jsxs)(h.x6,{i18nKey:"library-panel.empty-state.more-info",children:["Create a library panel from any existing dashboard panel through the panel context menu."," ",(0,t.jsx)(l.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/manage-library-panels/#create-a-library-panel",children:"Learn more"})]})}):(0,t.jsxs)(d.B,{direction:"column",wrap:"nowrap",children:[B===r.Gu.Loading?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.E.Skeleton,{showSecondaryActions:D}),(0,t.jsx)(o.E.Skeleton,{showSecondaryActions:D}),(0,t.jsx)(o.E.Skeleton,{showSecondaryActions:D})]}):O.length<1?(0,t.jsx)(i.p,{variant:"not-found",message:(0,h.t)("library-panels.empty-state.message","No library panels found")}):O?.map((V,w)=>(0,t.jsx)(o.E,{libraryPanel:V,onDelete:W,onClick:y,showSecondaryActions:D},`library-panel=${w}`)),O.length?(0,t.jsx)("div",{className:S.pagination,children:(0,t.jsx)(c.d,{currentPage:M,numberOfPages:L,onNavigate:U,hideWhenSinglePage:!0})}):null]})},f=y=>({pagination:(0,n.css)({alignSelf:"center",marginTop:y.spacing(1)})})},38928:(G,R,e)=>{"use strict";e.d(R,{IF:()=>f,QC:()=>x,h4:()=>y});var t=e(64423),n=e(65474),s=e(62467),a=e(44240),r=e(39697),g=e(69862),i=e(66847),l=e(69850),d=e(1005),c=e(65961),h=e(67791),o=e(32264),m=e(17706),u=e(57767),p=e(8184);function f(v){const P=(D,C)=>D.id===C.type,E=(D,C)=>{const b=(0,m.A4)();return D.filter(T=>{const S=b.find(O=>P(O,T));return C?!!S?.skipDataQuery:!S?.skipDataQuery})};return function(D){const C=new t.yU,b=(0,n.H)((0,u.dq)({searchString:v.searchString,perPage:v.perPage,page:v.page,excludeUid:v.currentPanelId,sortDirection:v.sortDirection,typeFilter:v.panelFilter,folderFilterUIDs:v.folderFilterUIDs})).pipe((0,g.Z)(T=>{const{elements:S}=T;if(o.$.featureToggles.vizAndWidgetSplit&&v.isWidget!==void 0){const O=E(S,v.isWidget);return(0,s.of)({...T,elements:O})}return(0,s.of)({...T,elements:S})}),(0,g.Z)(({perPage:T,elements:S,page:O,totalCount:M})=>(0,s.of)((0,p.c4)({libraryPanels:S,page:O,perPage:T,totalCount:M}))),(0,i.W)(T=>(console.error(T),(0,s.of)((0,p.c4)({...p.Xb,page:v.page,perPage:v.perPage})))),(0,l.j)(()=>C.unsubscribe()),(0,d.u)());C.add((0,a.h)((0,r.O)(50).pipe((0,c.u)((0,p.d9)()),(0,h.Q)(b)),b).subscribe(D))}}function y(v,P){return async function(E){try{await(0,u.h4)(v),f(P)(E)}catch(D){console.error(D)}}}function x(v){return function(P){return P instanceof Function?P(v):v(P)}}},8184:(G,R,e)=>{"use strict";e.d(R,{Xb:()=>s,c4:()=>r,d9:()=>a,w_:()=>i,yd:()=>g});var t=e(65307),n=e(39070);const s={loadingState:n.Gu.Loading,libraryPanels:[],totalCount:0,perPage:40,page:1,numberOfPages:0,currentPanelId:void 0},a=(0,t.VP)("libraryPanels/view/initSearch"),r=(0,t.VP)("libraryPanels/view/searchCompleted"),g=(0,t.VP)("libraryPanels/view/changePage"),i=(l,d)=>{if(a.match(d))return{...l,loadingState:n.Gu.Loading};if(r.match(d)){const{libraryPanels:c,page:h,perPage:o,totalCount:m}=d.payload,u=Math.ceil(m/o);return{...l,libraryPanels:c,perPage:o,totalCount:m,loadingState:n.Gu.Done,numberOfPages:u,page:h>u?h-1:h}}return g.match(d)?{...l,page:d.payload.page}:l}},82792:(G,R,e)=>{"use strict";e.d(R,{X:()=>t});function t(n){return!!n.libraryPanel?.uid}},57767:(G,R,e)=>{"use strict";e.d(R,{DW:()=>v,GN:()=>p,Yr:()=>c,d7:()=>o,dq:()=>d,e9:()=>h,h4:()=>u,jc:()=>m,xV:()=>f});var t=e(75505),n=e(79422),s=e(34214),a=e(41507),r=e(20455),g=e(74730),i=e(27677),l=e(98796);async function d({searchString:P="",perPage:E=100,page:D=1,excludeUid:C="",sortDirection:b="",typeFilter:T=[],folderFilterUIDs:S=[]}={}){const O=new URLSearchParams;O.append("searchString",P),O.append("sortDirection",b),O.append("typeFilter",T.join(",")),O.append("folderFilterUIDs",S.join(",")),O.append("excludeUid",C),O.append("perPage",E.toString(10)),O.append("page",D.toString(10)),O.append("kind",l.i.Panel.toString(10));const{result:M}=await(0,i.AI)().get(`/api/library-elements?${O.toString()}`);return M}async function c(P,E=!1){const D=await(0,t.s)((0,i.AI)().fetch({method:"GET",url:`/api/library-elements/${P}`,showSuccessAlert:!E,showErrorAlert:!E})),{result:C}=D.data,b=new s.G({...n.Ye,schemaVersion:35,panels:[C.model]}),{scopedVars:T,...S}=b.panels[0].getSaveModel();return delete S.gridPos,delete S.id,delete S.libraryPanel,b.destroy(),{...C,model:S}}async function h(P){const{result:E}=await(0,i.AI)().get(`/api/library-elements/name/${P}`);return E}async function o(P,E){const{result:D}=await(0,i.AI)().post("/api/library-elements",{folderUid:E,name:P.libraryPanel.name,model:P,kind:l.i.Panel});return D}async function m(P){const{libraryPanel:E,...D}=P,{uid:C,name:b,version:T,folderUid:S}=E,O=l.i.Panel,{result:M}=await(0,i.AI)().patch(`/api/library-elements/${C}`,{folderUid:S,name:b,model:D,version:T,kind:O});return M}function u(P){return(0,i.AI)().delete(`/api/library-elements/${P}`)}async function p(P){const{result:E}=await(0,i.AI)().get(`/api/library-elements/${P}/connections`);return E}async function f(P){const E=await p(P);return E.length===0?[]:await(0,i.AI)().search({dashboardUIDs:E.map(C=>C.connectionUid)})}function y(P){const E=(0,g.iL)(P),{uid:D,name:C,_loadedPanel:b}=E.state;let T=P.parent;if(!T||!(T instanceof a.U))throw new Error("Trying to save a library panel that does not have a DashboardGridItem parent");return{...b,uid:D,name:C,type:P.state.pluginId,model:(0,r.Z6)(P.clone({$behaviors:void 0}),{x:T.state.x??0,y:T.state.y??0,w:T.state.width??0,h:T.state.height??0},!1,T),kind:l.i.Panel,version:b?.version||0}}async function x(P){const{uid:E,folderUid:D,name:C,model:b,version:T,kind:S}=y(P),{result:O}=await(0,i.AI)().patch(`/api/library-elements/${E}`,{folderUid:D,name:C,model:b,version:T,kind:S});return O}async function v(P){const E=await x(P),D=(0,g.iL)(P);if(!D)throw new Error("Could not find library panel behavior for panel");D.setPanelFromLibPanel(E)}},43535:(G,R,e)=>{"use strict";e.d(R,{o:()=>n});var t=e(32196);function n(s){return{myTable:(0,t.css)`
      max-height: 204px;
      overflow-y: auto;
      margin-top: 11px;
      margin-bottom: 28px;
      border-radius: ${s.shape.radius.default};
      border: 1px solid ${s.colors.action.hover};
      background: ${s.colors.background.primary};
      color: ${s.colors.text.secondary};
      font-size: ${s.typography.h6.fontSize};
      width: 100%;

      thead {
        color: #538ade;
        font-size: ${s.typography.bodySmall.fontSize};
      }

      th,
      td {
        padding: 6px 13px;
        height: ${s.spacing(4)};
      }

      tbody > tr:nth-child(odd) {
        background: ${s.colors.background.secondary};
      }
    `,noteTextbox:(0,t.css)`
      margin-bottom: ${s.spacing(4)};
    `,textInfo:(0,t.css)`
      color: ${s.colors.text.secondary};
      font-size: ${s.typography.size.sm};
    `,dashboardSearch:(0,t.css)`
      margin-top: ${s.spacing(2)};
    `,modal:(0,t.css)`
      width: 500px;
    `,modalText:(0,t.css)`
      font-size: ${s.typography.h4.fontSize};
      color: ${s.colors.text.primary};
      margin-bottom: ${s.spacing(4)};
      padding-top: ${s.spacing(2)};
    `}}},98796:(G,R,e)=>{"use strict";e.d(R,{i:()=>t});var t=(s=>(s[s.Panel=1]="Panel",s))(t||{}),n=(s=>(s[s.Dashboard=1]="Dashboard",s))(n||{})},88861:(G,R,e)=>{"use strict";e.d(R,{b:()=>c});var t=e(5805),n=e(17172),s=e(3169),a=e(8484),r=e(57767);async function g(h,o){const m=i(h),u=await d(m,o);return l(h,u),u}function i(h){let{scopedVars:o,...m}=h.getSaveModel();return m={libraryPanel:{name:h.title,uid:void 0},...m},m}function l(h,o){h.restoreModel({...o.model,configRev:0,libraryPanel:o,title:h.title}),h.hasSavedPanelEditChange=!0,h.refresh()}function d(h,o){return h.libraryPanel?h.libraryPanel&&h.libraryPanel.uid===""?(0,r.d7)(h,o):(0,r.jc)(h):Promise.reject()}const c=()=>{const h=(0,s._2)(),[o,m]=(0,t.default)(async(u,p)=>{try{const f=await g(u,p);return h.success((0,a.t)("library-panels.save.success","Library panel saved")),f}catch(f){throw(0,n.NF)(f)&&(f.isHandled=!0,h.error((0,a.t)("library-panels.save.error",'Error saving library panel: "{{errorMsg}}"',{errorMsg:f.message??f.data.message}))),f}},[]);return{state:o,saveLibraryPanel:m}}},6473:(G,R,e)=>{"use strict";e.d(R,{t:()=>v});var t=e(62938),n=e(55004),s=e(26272),a=e(78731),r=e(39601),g=e(10096),i=e(28444),l=e(14792),d=e(74848),c=e(32196),h=e(40845),o=e(37390),m=e(55852),u=(P=>(P.Saved="saved",P.EditingStarted="editing-started",P.EditingCanceled="editing-cancelled",P.Deleted="deleted",P))(u||{});function p({onDismiss:P,event:E}){const D=(0,h.of)(f),C=()=>{if(E?.action===u.Deleted){r.Ny.push("/");return}v.reloadPage(),P()};return(0,d.jsxs)(o.a,{isOpen:!0,title:"Dashboard changed",icon:"copy",onDismiss:P,onClickBackdrop:()=>{},className:D.modal,children:[(0,d.jsx)("div",{className:D.description,children:"The dashboad has been updated by another session. Do you want to continue editing or discard your local changes?"}),(0,d.jsxs)(o.a.ButtonRow,{children:[(0,d.jsx)(m.$n,{onClick:P,variant:"secondary",fill:"outline",children:"Continue editing"}),(0,d.jsx)(m.$n,{onClick:C,variant:"destructive",children:"Discard local changes"})]})]})}const f=P=>({modal:(0,c.css)({width:"600px"}),description:(0,c.css)({color:P.colors.text.secondary,paddingBottom:P.spacing(1)})}),y=(0,t.A)();class x{constructor(){this.editing=!1,this.observer={next:E=>{if((0,n.ew)(E)&&this.editing&&E.state===n.ZF.Connected&&this.sendEditingState(),(0,n.Z7)(E)){if(E.message.sessionId===y)return;const{action:D}=E.message;switch(D){case u.EditingStarted:case u.Saved:{if(this.ignoreSave){this.ignoreSave=!1;return}const C=(0,l.UA)().getCurrent();if(C?.uid!==E.message.uid){console.log("dashboard event for different dashboard?",E,C);return}const b=this.editing||C.hasUnsavedChanges();if(D===u.Saved)b?g.lE.publish(new i.S8({component:p,props:{event:E}})):(g.lE.emit(s.r1.alertSuccess,["Dashboard updated"]),this.reloadPage());else if(b&&D===u.EditingStarted&&!this.hasSeenNotice){const T=E.message,S=this.getRecentEditingEvent();(!S||S.message!==T.message)&&(this.hasSeenNotice=!0,g.lE.emit(s.r1.alertWarning,["Another session is editing this dashboard",T.message])),this.lastEditing=T}return}}}}}}setEditingState(E){const D=this.editing=E;this.editing=E,this.hasSeenNotice=!1,D&&g.TP.isEditor&&this.sendEditingState()}sendEditingState(){const{channel:E,uid:D}=this;E&&D&&(0,a.oF)().publish(E,{sessionId:y,uid:D,action:this.editing?u.EditingStarted:u.EditingCanceled,timestamp:Date.now()})}watch(E){const D=(0,a.oF)();D&&E!==this.uid&&(this.channel={scope:n.qD.Grafana,namespace:"dashboard",path:`uid/${E}`},this.leave(),E&&(this.subscription=D.getStream(this.channel).subscribe(this.observer)),this.uid=E)}leave(){this.subscription&&this.subscription.unsubscribe(),this.subscription=void 0,this.uid=void 0}ignoreNextSave(){this.ignoreSave=!0}getRecentEditingEvent(){return this.lastEditing&&this.lastEditing.timestamp&&Date.now()-this.lastEditing.timestamp>5e3&&(this.lastEditing=void 0),this.lastEditing}reloadPage(){r.Ny.reload()}}const v=new x},47118:(G,R,e)=>{"use strict";e.d(R,{_w:()=>n,o$:()=>g,ot:()=>s});var t=e(14236),n=(i=>(i.NewValuesSameSchema="NewValuesSameSchema",i.FullFrame="FullFrame",i))(n||{});const s=(i,l)=>"type"in i&&i.type===l,a=Object.values(n),r=i=>"type"in i&&a.includes(i.type),g=i=>(0,t.ci)(i)&&"packetInfo"in i},70377:(G,R,e)=>{"use strict";e.d(R,{FE:()=>i,jE:()=>r,qE:()=>g});var t=e(2543),n=e.n(t),s=e(87490),a=e(98101);const r=(h,o)=>i(h,o),g=h=>{let o=[];return h.forEach(m=>{m.links?.forEach(u=>{if("variables"in u&&u.variables.length>0){const p={href:u.href,title:u.title,origin:u.origin,onClick:u.onClick,target:u.target},f=u.variables.map(x=>{const v=x.variableName,P=x.fieldPath?`.${x.fieldPath}`:"";return`${v}${P}`}),y=u.variables.map(x=>x.found?x.value:"");o.push({keys:f,values:y,links:[p],fieldIndex:m.fieldIndex})}})}),o},i=(h,o)=>c(h).map(u=>{const p=o?o(u,h.rowIndex,h.dataFrame):[],f=u.values[h.rowIndex],y=typeof f=="string"||typeof f=="number"?f.toString():(0,s.MA)(f);return{keys:[u.name],values:[y],links:p,fieldIndex:u.index}});function l(h,o){const m=(0,a.O)(h);if(m===null)return new Set;const u=new Set(m.extraFields.map(p=>p.index));return m.severityField!==null&&u.add(m.severityField.index),o.keepBody&&u.add(m.bodyField.index),o.keepTimestamp&&u.add(m.timeField.index),u}function d(h,o){const m=h.fields.map((y,x)=>({...y,index:x})),u=l(h,o??{}),[p,f]=partition(m,y=>y.config.custom?.hidden?!1:(y.config.links??[]).length>0?!0:u.has(y.index));return{visible:p,hidden:f}}function c(h,o){const m=h.dataFrame,u=l(m,o??{}),p=[];for(let f=0;f<m.fields.length;f++){const y=m.fields[f];y.values[h.rowIndex]!=null&&(y.config.custom?.hidden||(y.config.links&&y.config.links.length>0||u.has(f))&&p.push({...y,index:f}))}return p}},98101:(G,R,e)=>{"use strict";e.d(R,{n:()=>m,O:()=>p});var t=e(85404),n=e(11261),s=e(41260);function a(f,y){const x=f.labels;if(x!==void 0){const v=new Array(y);return v.fill(x),v}else return null}function r(f,y,x){const v=f.getFieldByName("labels");if(v!==void 0&&v.type===n.PU.other){const P=v.values.map(m);return[v,()=>P]}else return[null,()=>a(y,x.length)]}function g(f){const y=new t.L(f),x=y.getFirstFieldOfType(n.PU.time),v=y.getFirstFieldOfType(n.PU.string);if(x===void 0||v===void 0)return null;const P=y.getFieldByName("tsNs")??null,E=y.getFieldByName("detected_level")??y.getFieldByName("level")??null,D=y.getFieldByName("id")??null,[C,b]=r(y,v,f),T=y.fields.filter((S,O)=>O!==x.index&&O!==v.index&&O!==P?.index&&O!==E?.index&&O!==D?.index&&O!==C?.index);return{timeField:x,bodyField:v,timeNanosecondField:P,severityField:E,idField:D,getLogFrameLabels:b,getLogFrameLabelsAsLabels:b,getLabelFieldName:()=>C?.name??null,extraFields:T}}function i(f,y,x){const v=f.getFieldByName(y);if(v!==void 0)return v.type===x?v:void 0}const l="timestamp",d="body",c="severity",h="id",o="labels";function m(f){const y={};return Object.entries(f).forEach(([x,v])=>{y[x]=typeof v=="string"?v:JSON.stringify(v)}),y}function u(f){const y=new t.L(f),x=i(y,l,n.PU.time),v=i(y,d,n.PU.string);if(x===void 0||v===void 0)return null;const P=i(y,c,n.PU.string)??null,E=i(y,h,n.PU.string)??null,D=i(y,o,n.PU.other)??null,C=D===null?null:D.values,b=y.fields.filter((T,S)=>S!==x.index&&S!==v.index&&S!==P?.index&&S!==E?.index&&S!==D?.index);return{timeField:x,bodyField:v,severityField:P,idField:E,getLogFrameLabels:()=>C,timeNanosecondField:null,getLogFrameLabelsAsLabels:()=>C!==null?C.map(m):null,getLabelFieldName:()=>D!==null?D.name:null,extraFields:b}}function p(f){return f.meta?.type===s.m.LogLines?u(f):g(f)}},69147:(G,R,e)=>{"use strict";e.d(R,{yR:()=>S,cZ:()=>O,HT:()=>w,M0:()=>W,ct:()=>U,f8:()=>ne,J9:()=>F,Wr:()=>se,sg:()=>k});var t=e(2543),n=e(88483),s=e(50832),a=e(65474),r=e(9557),g=e(52622),i=e(14236),l=e(85404),d=e(11261),c=e(24293),h=e(47232),o=e(8249),m=e(80997),u=e(72724),p=e(65879),f=e(39070),y=e(26517),x=e(32264),v=e(24284),P=e(88838),E=e(2913);function D(le,re){return E.Ay.bootData?.user?.lightTheme?re:le}var C=e(98101),b=e(91002);const T="Line limit",S="Common labels",O={[r.$b.critical]:v.Tj[7],[r.$b.error]:v.Tj[4],[r.$b.warning]:v.Tj[1],[r.$b.info]:v.Tj[0],[r.$b.debug]:v.Tj[5],[r.$b.trace]:v.Tj[2],[r.$b.unknown]:D("#8e8e8e","#bdc4cd")},M=1,I=1e3*M,L=60*I,B=60*L,j=24*B,A=/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-6]\d[,\.]\d+([+-][0-2]\d:[0-5]\d|Z)/g;function K(le,re,de){switch(de){case g.fY.exact:return le.entry.replace(A,"")===re.entry.replace(A,"");case g.fY.numbers:return le.entry.replace(/\d/g,"")===re.entry.replace(/\d/g,"");case g.fY.signature:return le.entry.replace(/\w/g,"")===re.entry.replace(/\w/g,"");default:return!1}}function W(le,re){return re===g.fY.none?le:le.reduce((de,oe,J)=>{const ce={...oe},pe=de[de.length-1];return J>0&&K(oe,pe,re)?pe.duplicates++:(ce.duplicates=0,de.push(ce)),de},[])}function U(le,re){return re.size===0?le:le.filter(de=>!re.has(de.logLevel))}function F(le,re){const de={},oe=[];for(const J of le){let ce=de[J.logLevel];ce||(de[J.logLevel]=ce={lastTs:null,datapoints:[],target:J.logLevel,color:O[J.logLevel]},oe.push(ce));const pe=Math.floor(J.timeEpochMs/re)*re;pe===ce.lastTs?ce.datapoints[ce.datapoints.length-1][0]++:(ce.datapoints.push([1,pe]),ce.lastTs=pe);for(const xe of oe)xe!==ce&&xe.lastTs!==pe&&(xe.datapoints.push([0,pe]),xe.lastTs=pe)}return oe.map((J,ce)=>{J.datapoints.sort((Ee,Se)=>Ee[1]-Se[1]);const pe=(0,i.Vc)(J),fe=new l.L(pe).getFirstFieldOfType(d.PU.number);return pe.fields[fe.index].config.min=0,pe.fields[fe.index].config.decimals=0,pe.fields[fe.index].config.color={mode:c.Y.Fixed,fixedColor:J.color},pe.fields[fe.index].config.custom={drawStyle:g.GR.Bars,barAlignment:g.Nj.Center,barWidthFactor:.9,barMaxWidth:5,lineColor:J.color,pointColor:J.color,fillColor:J.color,lineWidth:0,fillOpacity:100,stacking:{mode:g.gs.Normal,group:"A"}},pe})}function V(le){return le.fields.some(re=>re.type===d.PU.time)&&le.fields.some(re=>re.type===d.PU.string)}function w(le,re,de,oe,J){const{logSeries:ce}=N(le),pe=Q(ce,oe,!!J);if(pe){if(re&&pe.rows.length>0){const xe=pe.rows.sort(b.M1),{visibleRange:fe,bucketSize:Ee,visibleRangeMs:Se,requestedRangeMs:ye}=z(xe,re,de);pe.visibleRange=fe,pe.bucketSize=Ee,pe.series=F(xe,Ee),pe.meta&&(pe.meta=X(pe,Se,ye))}else pe.series=[];return pe.queries=oe,pe}return{hasUniqueLabels:!1,rows:[],meta:[],series:[],queries:oe}}function z(le,re,de,oe=20,J=1e3){let ce=de,pe=re,xe=Math.max(pe*oe,J),fe,Ee;if(de){const Se=le[0].timeEpochMs;if(Ee=de.to-de.from,fe=de.to-Se,fe>0){const ye=fe/Ee;pe*=ye,xe=Math.max(Math.ceil(pe*oe),J),ce={from:Math.floor(Se/xe)*xe,to:de.to}}else fe=1}return{bucketSize:xe,visibleRange:ce,visibleRangeMs:fe,requestedRangeMs:Ee}}function N(le){const re=[],de=[];for(const oe of le){if(V(oe)||!oe.fields.length){de.push(oe);continue}oe.length>0&&re.push(oe)}return{logSeries:de,metricSeries:re}}function H(le,re,de){const oe=le.values[de],ce=(0,h.yT)(oe).valueOf();if(re)return{ts:oe,timeEpochMs:ce,timeEpochNs:re.values[de]};if(le.nanos!==void 0){const pe=le.nanos[de].toString().padStart(6,"0"),xe=`${ce}${pe}`;return{ts:oe,timeEpochMs:ce,timeEpochNs:xe}}return{ts:oe,timeEpochMs:ce,timeEpochNs:ce+"000000"}}function Q(le,re=[],de=!1){if(le.length===0)return;const oe=[];let J=[];const ce=le.filter(We=>We.fields.length);ce.length&&ce.forEach(We=>{const _e=(0,C.O)(We);if(_e!=null){const at=_e.getLogFrameLabelsAsLabels()??void 0,ut={rawFrame:We,logsFrame:_e,frameLabels:at};J.push(ut),at&&at.length>0&&oe.push(at)}});const pe=oe.flat(),xe=pe.length>0?(0,o.yO)(pe):{};let fe=[],Ee=!1;const Se=(0,b.kA)();for(const We of J){const{logsFrame:_e,rawFrame:at,frameLabels:ut}=We,{timeField:Tt,timeNanosecondField:It,bodyField:ge,severityField:Ie,idField:ue}=_e;for(let me=0;me<at.length;me++){const{ts:Pe,timeEpochMs:Ne,timeEpochNs:Fe}=H(Tt,It??void 0,me),Be=ge.values[me]??"",he=typeof Be=="string"?Be:JSON.stringify(Be),be=m.sQ.hasAnsiCodes(he),Ke=!!he.match(/\\n|\\t|\\r/),ze=at.meta?.custom?.searchWords??at.meta?.searchWords??[],nt=be?P.DB.strip(he):he,tt=ut?.[me],ot=(0,o.s6)(tt,xe);Object.keys(ot).length>0&&(Ee=!0);let gt=r.$b.unknown;const He=Ie&&Ie.values[me]||(tt?.detected_level??tt?.level);typeof He=="number"||typeof He=="string"?gt=(0,b.EK)(He):gt=(0,b.XM)(nt);const et=re.find(ht=>ht.refId===at.refId)?.datasource?.type,rt={entryFieldIndex:ge.index,rowIndex:me,dataFrame:at,logLevel:gt,timeFromNow:(0,u.fq)(Pe),timeEpochMs:Ne,timeEpochNs:Fe,timeLocal:(0,u.LE)(Pe,{timeZone:"browser"}),timeUtc:(0,u.LE)(Pe,{timeZone:"utc"}),uniqueLabels:ot,hasAnsi:be,hasUnescapedContent:Ke,searchWords:ze,entry:nt,raw:he,labels:tt||{},uid:`${at.refId}_${ue?ue.values[me]:me.toString()}`,datasourceType:et};ue!==null&&(rt.rowId=ue.values[me]),!(de&&Se(rt))&&fe.push(rt)}}const ye=[];(0,t.size)(xe)>0&&ye.push({label:S,value:xe,kind:r.tG.LabelsMap});const Me=le.filter(We=>We?.meta?.custom?.limit??We?.meta?.limit).reduce((We,_e)=>(We[_e.refId??""]=_e.meta?.custom?.limit??_e.meta?.limit??0,We),{}),Ce=Object.values(Me).reduce((We,_e)=>We+=_e,0);Ce>0&&ye.push({label:T,value:Ce,kind:r.tG.Number});let Ue=0;const Ae={};let we=!1;for(const We of le){const _e=We.meta?.custom?.lokiQueryStatKey,{refId:at}=We;if(!we&&We.meta?.custom?.error&&(ye.push({label:"",value:We.meta?.custom.error,kind:r.tG.Error}),we=!0),at&&!Ae[at]){if(_e&&We.meta?.stats){const ut=We.meta.stats.find(Tt=>Tt.displayName===_e);ut&&(Ue+=ut.value)}Ae[at]=!0}}if(Ue>0){const{text:We,suffix:_e}=(0,y.rT)("B")(Ue);ye.push({label:"Total bytes processed",value:`${We} ${_e}`,kind:r.tG.String})}return{hasUniqueLabels:Ee,meta:ye,rows:fe}}function X(le,re,de){if(!le.meta)return[];let oe=[...le.meta];const J=oe.findIndex(pe=>pe.label===T),ce=J>=0&&oe[J]?.value;if(ce&&typeof ce=="number"&&ce>0){let pe;if(ce===le.rows.length&&re&&de){const xe=(re/de*100).toFixed(2);pe=`${ce} reached, received logs cover ${xe}% (${p.msRangeToTimeString(re)}) of your selected time range (${p.msRangeToTimeString(de)})`}else{const xe=x.$.featureToggles.logsInfiniteScrolling?"displayed":"returned";pe=`${ce} (${le.rows.length} ${xe})`}oe[J]={label:T,value:pe,kind:r.tG.String}}return oe}function ee(le,re){const de=re&&le===r.$b.unknown?"logs":le,oe=O[le];return{displayNameFromDS:de,color:{mode:c.Y.Fixed,fixedColor:oe},custom:{drawStyle:g.GR.Bars,barAlignment:g.Nj.Center,lineColor:oe,pointColor:oe,fillColor:oe,lineWidth:1,fillOpacity:100,stacking:{mode:g.gs.Normal,group:"A"}}}}const Z=(le,re,de)=>(le.fields=le.fields.map(oe=>(oe.type===d.PU.number&&(oe.config={...oe.config,...ee(re(le),de)}),oe)),le);function q(le){let re;try{re=new l.L(le).getFirstFieldOfType(d.PU.number)}catch{}return re?.labels?ae(re.labels):r.$b.unknown}function ae(le){const re=le.detected_level??le.level??le.lvl??le.loglevel??"";return re?(0,b.EK)(re):r.$b.unknown}function k(le,re,de){const oe=re.range,J=de.targets,ce=q,pe=oe.to.valueOf()-oe.from.valueOf(),xe=te(re.scopedVars,pe);return re.interval=xe.interval,re.scopedVars.__interval={value:xe.interval,text:xe.interval},xe.intervalMs!==void 0&&(re.intervalMs=xe.intervalMs,re.scopedVars.__interval_ms={value:xe.intervalMs,text:xe.intervalMs}),re.hideFromInspector=!0,new n.c(fe=>{let Ee=[];fe.next({state:f.Gu.Loading,error:void 0,data:[]});const Se=le.query(re),Ve=((0,s.A)(Se)?Se:(0,a.H)(Se)).subscribe({complete:()=>{fe.complete()},next:Me=>{const{error:Ce}=Me;if(Ce!==void 0)fe.next({state:f.Gu.Error,error:Ce,data:[]}),fe.error(Ce);else{const Ue=(0,t.groupBy)(Me.data,"refId");Ee=Me.data.map(Ae=>{if(Ae.meta?.dataTopic===g.QR.Annotations)return Ae;let we=Ae.refId||"";we.startsWith("log-volume-")&&(we=we.substr(11));const We={logsVolumeType:r.Aj.FullRange,absoluteRange:{from:oe.from.valueOf(),to:oe.to.valueOf()},datasourceName:le.name,sourceQuery:J.find(_e=>_e.refId===we)};return Ae.meta={...Ae.meta,custom:{...Ae.meta?.custom,...We}},Z(Ae,ce,Ue[Ae.refId].length===1)}),fe.next({state:Me.state,error:void 0,data:Ee})}},error:Me=>{fe.next({state:f.Gu.Error,error:Me,data:[]}),fe.error(Me)}});return()=>{Ve?.unsubscribe()}})}function se(le,re){return re.hideFromInspector=!0,new n.c(de=>{let oe=[];de.next({state:f.Gu.Loading,error:void 0,data:[]});const J=le.query(re),pe=((0,s.A)(J)?J:(0,a.H)(J)).subscribe({complete:()=>{de.next({state:f.Gu.Done,error:void 0,data:oe}),de.complete()},next:xe=>{const{error:fe}=xe;fe!==void 0?(de.next({state:f.Gu.Error,error:fe,data:[]}),de.error(fe)):oe=xe.data.map(Ee=>{const Se=(0,i.Vc)(Ee),{timeIndex:ye}=(0,i.KR)(Se);return(0,i.ES)(Se,ye)})},error:xe=>{de.next({state:f.Gu.Error,error:xe,data:[]}),de.error(xe)}});return()=>{pe?.unsubscribe()}})}function te(le,re){if(le.__interval_ms){let de=le.__interval_ms.value,oe="";return re<I*5?(de=M,oe="1ms"):de>B?(de=j,oe="1d"):de>L?(de=B,oe="1h"):de>I?(de=L,oe="1m"):(de=I,oe="1s"),{interval:oe,intervalMs:de}}else return{interval:"$__interval"}}function ne(le){const re=le.dataFrame;return re.length===0||re.length<=le.rowIndex?null:(0,i.EI)({fields:re.fields.map(oe=>({...oe,values:[oe.values[le.rowIndex]]})),refId:re.refId})}},91002:(G,R,e)=>{"use strict";e.d(R,{Dg:()=>E,Dk:()=>S,Dm:()=>b,Dx:()=>D,EK:()=>c,Ei:()=>x,Hw:()=>P,M1:()=>u,Tj:()=>h,XM:()=>d,a8:()=>M,e3:()=>T,kA:()=>I,oR:()=>y,oT:()=>C,qR:()=>v,s2:()=>o,tX:()=>O,zy:()=>f});var t=e(2543),n=e.n(t),s=e(9557),a=e(52622),r=e(37471),g=e(11261),i=e(85404),l=e(70377);function d(L){if(!L)return s.$b.unknown;let B=s.$b.unknown,j;for(const[A,K]of Object.entries(s.$b)){const U=new RegExp(`\\b${A}\\b`,"i").exec(L);U&&(j===void 0||U.index<j)&&(B=K,j=U.index)}return B}function c(L){const B=s.$b[L.toString().toLowerCase()];if(B)return B;if(typeof L=="string"){const j=parseInt(L,10);if(L.length===j.toString().length)return s.s5[L]||s.$b.unknown}else if(typeof L=="number")return s.s5[L]||s.$b.unknown;return s.$b.unknown}function h(L,B){const j=L.filter(W=>W.labels[B]!==void 0),A=j.length,K=(0,t.countBy)(j,W=>W.labels[B]);return m(K,A)}function o(L){const B=L.filter(A=>A!=null),j=(0,t.countBy)(B);return m(j,B.length)}const m=(L,B)=>(0,t.chain)(L).map((j,A)=>({count:j,value:A,proportion:j/B})).sortBy("count").reverse().value(),u=(L,B)=>L.timeEpochMs<B.timeEpochMs?-1:L.timeEpochMs>B.timeEpochMs?1:L.timeEpochNs<B.timeEpochNs?-1:L.timeEpochNs>B.timeEpochNs?1:0,p=(L,B)=>L.timeEpochMs>B.timeEpochMs?-1:L.timeEpochMs<B.timeEpochMs?1:L.timeEpochNs>B.timeEpochNs?-1:L.timeEpochNs<B.timeEpochNs?1:0,f=(L,B)=>{const j=L?y(L.rows,B):[];return L?{...L,rows:j}:{hasUniqueLabels:!1,rows:j}},y=(L,B)=>B===a.uH.Ascending?L.sort(u):L.sort(p),x=L=>L.labels.__error__?{hasError:!0,errorMessage:L.labels.__error__}:{hasError:!1},v=L=>L.labels.__adaptive_logs_sampled__?{isSampled:!0,sampleMessage:L.labels.__adaptive_logs_sampled__==="true"?"Logs like this one have been dropped by Adaptive Logs":`${L.labels.__adaptive_logs_sampled__}% of logs like this one have been dropped by Adaptive Logs`}:{isSampled:!1},P=L=>L.replace(/\\r\\n|\\n|\\t|\\r/g,B=>B.slice(1)==="t"?"	":`
`);function E(L){return L.map(B=>{const j=(0,l.FE)(B).reduce((A,K)=>{const W=K.keys[0];return A[W]=K.values[0],A},{});return{line:B.entry,timestamp:B.timeEpochNs,fields:{...j,...B.labels}}})}const D=L=>{let B={from:1/0,to:-1/0};return L.forEach(j=>{const A=j.meta?.custom||{};A.absoluteRange?.from&&A.absoluteRange?.to&&(B={from:Math.min(B.from,A.absoluteRange.from),to:Math.max(B.to,A.absoluteRange.to)})}),B},C=L=>{if(L.length===0)throw new Error("Cannot aggregate data frames: there must be at least one data frame to aggregate");const B={},j={};let A=-1/0;const K={};let W=[];return L.forEach(U=>{const{level:F,valueField:V,timeField:w,length:z}=O(U);K[F]={meta:U.meta,valueFieldConfig:V.config,timeFieldConfig:w.config};for(let N=0;N<z;N++){const H=w.values[N],Q=V.values[N];B[F]??={},B[F][H]=(B[F][H]||0)+Q,j[H]=(j[H]||0)+Q,A=Math.max(j[H],A)}}),Object.keys(B).forEach(U=>{const F=new r.k,{meta:V,timeFieldConfig:w,valueFieldConfig:z}=K[U];F.name=U,F.meta=V,F.addField({name:"Time",type:g.PU.time,config:w}),F.addField({name:"Value",type:g.PU.number,config:z}),Object.entries(B[U]).sort((N,H)=>Number(N[0])-Number(H[0])).forEach(([N,H])=>{F.add({Time:Number(N),Value:H})}),W.push(F)}),{dataFrames:W,maximum:A}},b=L=>{const B=L[0]?.meta?.custom;return B&&B.datasourceName?{name:B.datasourceName}:null},T=L=>L[0]?.meta?.custom?.logsVolumeType===s.Aj.Limited,S=async(L,B)=>{if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(L);{const j=document.createElement("textarea");B.current?.appendChild(j),j.value=L,j.focus(),j.select(),document.execCommand("copy"),j.remove()}};function O(L){const B=new i.L(L),j=B.getFirstFieldOfType(g.PU.time),A=B.getFirstFieldOfType(g.PU.number);if(!j)throw new Error("Missing time field");if(!A)throw new Error("Missing value field");const K=A.config.displayNameFromDS||L.name||"logs",W=A.values.length;return{level:K,valueField:A,timeField:j,length:W}}function M(L){return L instanceof Element}function I(){const L=new Set;return function(B){let j=`${B.dataFrame.refId}_${B.rowId?B.rowId:`${B.timeEpochNs}_${B.entry}`}`;return L.has(j)?!0:(L.add(j),!1)}}},90591:(G,R,e)=>{"use strict";e.d(R,{m:()=>l});var t=e(74848),n=e(32196),s=e(32264),a=e(40845),r=e(96374),g=e(8484);const i=()=>{const c=(0,a.of)(d);return(0,t.jsx)("p",{className:c.description,children:s.$.featureToggles.newDashboardSharingComponent?(0,g.t)("shared-dashboard.delete-modal.revoke-body-text","Are you sure you want to revoke this access? The dashboard can no longer be shared."):(0,g.t)("public-dashboard.delete-modal.revoke-body-text","Are you sure you want to revoke this URL? The dashboard will no longer be public.")})},l=({onConfirm:c,onDismiss:h})=>{const o=s.$.featureToggles.newDashboardSharingComponent?(0,g.t)("shared-dashboard.delete-modal.revoke-title","Revoke access"):(0,g.t)("public-dashboard.delete-modal.revoke-title","Revoke public URL");return(0,t.jsx)(r.u,{isOpen:!0,body:(0,t.jsx)(i,{}),onConfirm:c,onDismiss:h,title:o,icon:"trash-alt",confirmText:o})},d=c=>({title:(0,n.css)`
    margin-bottom: ${c.spacing(1)};
  `,description:(0,n.css)`
    font-size: ${c.typography.body.fontSize};
  `})},71500:(G,R,e)=>{"use strict";e.d(R,{P:()=>a});var t=e(65812);class n extends Error{constructor(g,i){super(i),this.type=g}}class s{constructor(){this.rootName="general"}validateNewDashboardName(g,i){return this.validate(g,i,"A dashboard or a folder with the same name already exists")}validateNewFolderName(g){return this.validate(this.rootName,g,"A folder or dashboard in the general folder with the same name already exists")}async validate(g,i,l){i=(i||"").trim();const d=i.toLowerCase();if(i.length===0)throw new n("REQUIRED","Name is required");if(d===this.rootName)throw new n("EXISTING","This is a reserved name and cannot be used for a folder.");const h=await(0,t.getGrafanaSearcher)().search({kind:["dashboard"],query:i,location:g||"general"});for(const o of h.view)if(d===o.name.toLowerCase())throw new n("EXISTING",l)}}const a=new s},11230:(G,R,e)=>{"use strict";e.d(R,{FG:()=>v,Q9:()=>P,Ql:()=>S,c0:()=>T,iP:()=>h,rw:()=>c,vV:()=>C});var t=e(17172),n=e(19347),s=e(82467),a=e(3169),r=e(55314),g=e(31678),i=e(57767),l=e(98796),d=e(88264);function c(M){return async I=>{try{I((0,d.f7)());const L=await(0,t.AI)().get(`/api/gnet/dashboards/${M}`);await I(y(L.json)),await I(u(L)),I(f())}catch(L){I((0,d.oQ)()),(0,t.NF)(L)&&I((0,s.dx)((0,a.gi)(L.data.message||L)))}}}function h(M){return async I=>{await I(y(M)),await I(p(M)),I(f())}}const o=(M,I)=>M?.usage?.libraryPanels?.filter(L=>I.inputs.libraryPanels.some(B=>B.state!==d.J7.Exists&&B.model.uid===L.uid));function m(M,I){let L=M.__inputs;if(I.inputs.libraryPanels?.length){const B=[];M.__inputs?.forEach(j=>{if(!j?.usage?.libraryPanels){B.push(j);return}const A=o(j,I);j.usage={libraryPanels:A},!!A?.length&&B.push(j)}),L=B}return{...M,__inputs:L}}function u(M){return(I,L)=>{const B=L().importDashboard,j=m(M.json,B);I((0,d.Rp)({...M,json:j}))}}function p(M){return(I,L)=>{const B=L().importDashboard,j=m(M,B);I((0,d.dd)(j))}}function f(){return(M,I)=>{const L=I().importDashboard.dashboard;if(L&&L.__inputs){const B=[];L.__inputs.forEach(j=>{const A={name:j.name,label:j.label,info:j.description,value:j.value,type:j.type,pluginId:j.pluginId,options:[]};A.description=D(j),j.type===d.NZ.DataSource?E(j,A):A.info||(A.info="Specify a string constant"),B.push(A)}),M((0,d.y3)(B))}}}function y(M){return async function(I){const L=await x(M);I((0,d.dW)(L))}}async function x(M){if(!M||!M.__elements)return[];const I=[];for(const L of Object.values(M.__elements)){if(L.kind!==l.i.Panel)continue;const B=L.model,{type:j,description:A}=B,{uid:K,name:W}=L,U={model:{model:B,uid:K,name:W,version:0,type:j,kind:l.i.Panel,description:A},state:d.J7.New};try{const F=await(0,i.Yr)(K,!0);U.state=d.J7.Exists,U.model=F}catch(F){if(F.status!==404)throw F}I.push(U)}return I}function v(){return M=>{M((0,d.SN)())}}function P(M){return async(I,L)=>{const B=L().importDashboard.dashboard,j=L().importDashboard.inputs,A=[];M.dataSources?.forEach((K,W)=>{const U=j.dataSources[W];A.push({name:U.name,type:U.type,pluginId:U.pluginId,value:K.uid})}),M.constants?.forEach((K,W)=>{const U=j.constants[W];A.push({value:K,name:U.name,type:U.type})}),I(r.cU.endpoints.importDashboard.initiate({dashboard:{...B,title:M.title,uid:M.uid||B.uid},overwrite:!0,inputs:A,folderUid:M.folder.uid}))}}const E=(M,I)=>{(0,n.l)().getList({pluginId:M.pluginId}).length===0?I.info="No data sources of type "+M.pluginName+" found":I.info||(I.info="Select a "+M.pluginName+" data source")},D=M=>{if(M.usage&&M.usage.libraryPanels)return`List of affected library panels: ${M.usage.libraryPanels.reduce((L,B,j)=>j===0?B.name:`${L}, ${B.name}`,"")}`};function C(M){return(0,t.AI)().post("/api/folders",M)}const b=1e3;function T(M,I,L=g.SearchQueryType.Folder){return(0,t.AI)().get("/api/search",{query:M,type:L,permission:I,limit:b})}function S(M){return(0,t.AI)().get(`/api/folders/${M}`)}function O(M){return getBackendSrv().get(`/api/folders/id/${M}`)}},88264:(G,R,e)=>{"use strict";e.d(R,{Ay:()=>f,J7:()=>r,NZ:()=>a,Rp:()=>c,SN:()=>l,V9:()=>g,dW:()=>o,dd:()=>h,f7:()=>u,oQ:()=>m,qx:()=>s,y3:()=>d});var t=e(65307),n=e(39070),s=(y=>(y[y.Gcom=0]="Gcom",y[y.Json=1]="Json",y))(s||{}),a=(y=>(y.DataSource="datasource",y.Constant="constant",y.LibraryPanel="libraryPanel",y))(a||{}),r=(y=>(y.New="new",y.Exists="exists",y.Different="different",y))(r||{});const g={meta:{updatedAt:"",orgName:""},dashboard:{},source:1,inputs:{},state:n.Gu.NotStarted},i=(0,t.Z0)({name:"manageDashboards",initialState:g,reducers:{setGcomDashboard:(y,x)=>{y.dashboard={...x.payload.json,id:null},y.meta={updatedAt:x.payload.updatedAt,orgName:x.payload.orgName},y.source=0,y.state=n.Gu.Done},setJsonDashboard:(y,x)=>{y.dashboard={...x.payload,id:null},y.meta=g.meta,y.source=1,y.state=n.Gu.Done},clearDashboard:y=>{y.dashboard={},y.state=n.Gu.NotStarted},setInputs:(y,x)=>{y.inputs={dataSources:x.payload.filter(v=>v.type==="datasource"),constants:x.payload.filter(v=>v.type==="constant"),libraryPanels:y.inputs.libraryPanels||[]}},setLibraryPanelInputs:(y,x)=>{y.inputs.libraryPanels=x.payload},fetchFailed:y=>{y.dashboard={},y.state=n.Gu.Error},fetchDashboard:y=>{y.state=n.Gu.Loading}}}),{clearDashboard:l,setInputs:d,setGcomDashboard:c,setJsonDashboard:h,setLibraryPanelInputs:o,fetchFailed:m,fetchDashboard:u}=i.actions,f={importDashboard:i.reducer}},59120:(G,R,e)=>{"use strict";e.d(R,{O5:()=>E,r3:()=>m,dX:()=>y,hZ:()=>l,ri:()=>h,WH:()=>x,AC:()=>d,YX:()=>f,bM:()=>v,A_:()=>P,SM:()=>i,M8:()=>p,YD:()=>o,aD:()=>u});var t=e(75816),n=e(75505),s=e(17172);function a({baseURL:C}){async function b(T){try{const{data:S,...O}=await(0,n.s)((0,s.AI)().fetch({...T,url:C+T.url,showErrorAlert:!1,data:T.body}));return{data:S,meta:O}}catch(S){return T.manageError?T.manageError(S):{error:S}}}return b}const g=(0,t.xP)({reducerPath:"migrateToCloudGeneratedAPI",baseQuery:a({baseURL:"/api"}),endpoints:()=>({})}).injectEndpoints({endpoints:C=>({getSessionList:C.query({query:()=>({url:"/cloudmigration/migration"})}),createSession:C.mutation({query:b=>({url:"/cloudmigration/migration",method:"POST",body:b.cloudMigrationSessionRequestDto})}),deleteSession:C.mutation({query:b=>({url:`/cloudmigration/migration/${b.uid}`,method:"DELETE"})}),getSession:C.query({query:b=>({url:`/cloudmigration/migration/${b.uid}`})}),createSnapshot:C.mutation({query:b=>({url:`/cloudmigration/migration/${b.uid}/snapshot`,method:"POST"})}),getSnapshot:C.query({query:b=>({url:`/cloudmigration/migration/${b.uid}/snapshot/${b.snapshotUid}`,params:{resultPage:b.resultPage,resultLimit:b.resultLimit}})}),cancelSnapshot:C.mutation({query:b=>({url:`/cloudmigration/migration/${b.uid}/snapshot/${b.snapshotUid}/cancel`,method:"POST"})}),uploadSnapshot:C.mutation({query:b=>({url:`/cloudmigration/migration/${b.uid}/snapshot/${b.snapshotUid}/upload`,method:"POST"})}),getShapshotList:C.query({query:b=>({url:`/cloudmigration/migration/${b.uid}/snapshots`,params:{page:b.page,limit:b.limit,sort:b.sort}})}),getCloudMigrationToken:C.query({query:()=>({url:"/cloudmigration/token"})}),createCloudMigrationToken:C.mutation({query:()=>({url:"/cloudmigration/token",method:"POST"})}),deleteCloudMigrationToken:C.mutation({query:b=>({url:`/cloudmigration/token/${b.uid}`,method:"DELETE"})}),getDashboardByUid:C.query({query:b=>({url:`/dashboards/uid/${b.uid}`})}),getLibraryElementByUid:C.query({query:b=>({url:`/library-elements/${b.libraryElementUid}`})})}),overrideExisting:!1}),{useGetSessionListQuery:i,useCreateSessionMutation:l,useDeleteSessionMutation:d,useGetSessionQuery:c,useCreateSnapshotMutation:h,useGetSnapshotQuery:o,useCancelSnapshotMutation:m,useUploadSnapshotMutation:u,useGetShapshotListQuery:p,useGetCloudMigrationTokenQuery:f,useCreateCloudMigrationTokenMutation:y,useDeleteCloudMigrationTokenMutation:x,useGetDashboardByUidQuery:v,useGetLibraryElementByUidQuery:P}=g,E=g.enhanceEndpoints({addTagTypes:["cloud-migration-token","cloud-migration-session","cloud-migration-snapshot"],endpoints:{getCloudMigrationToken:{providesTags:["cloud-migration-token"]},createCloudMigrationToken:{invalidatesTags:["cloud-migration-token"]},deleteCloudMigrationToken:{invalidatesTags:["cloud-migration-token"]},getSessionList:{providesTags:["cloud-migration-session"]},getSession:{providesTags:["cloud-migration-session"]},createSession:{invalidatesTags:["cloud-migration-session"]},deleteSession:{invalidatesTags:["cloud-migration-session","cloud-migration-snapshot"]},getShapshotList:{providesTags:["cloud-migration-snapshot"]},getSnapshot:{providesTags:["cloud-migration-snapshot"]},createSnapshot:{invalidatesTags:["cloud-migration-snapshot"]},uploadSnapshot:{invalidatesTags:["cloud-migration-snapshot"]},getDashboardByUid:D,getLibraryElementByUid:D}});function D(C){if(!C.query)return;const b=C.query;C.query=(...T)=>{const S=b(...T);return S.showErrorAlert=!1,S}}},32931:(G,R,e)=>{"use strict";e.d(R,{EC:()=>i,L_:()=>r,YS:()=>a,bA:()=>g,wV:()=>l});var t=e(17172),n=e(82467),s=e(10943);function a(d={getBackendSrv:t.AI}){return async c=>{const h=await d.getBackendSrv().get("/api/org");return c((0,s.bK)(h)),h}}function r(d={getBackendSrv:t.AI}){return async(c,h)=>{const o=h().organization.organization;await d.getBackendSrv().put("/api/org",{name:o.name}),c((0,n.YA)(o.name)),c(a(d))}}function g(d,c={getBackendSrv:t.AI}){return async h=>{const o=await c.getBackendSrv().post("/api/user/using/"+d);h((0,n.YA)(o.name))}}function i(d,c={getBackendSrv:t.AI}){return async h=>{const o=await c.getBackendSrv().post("/api/orgs/",d);h(g(o.orgId))}}function l(d={getBackendSrv:t.AI}){return async c=>{const h=await d.getBackendSrv().get("/api/user/orgs");return c((0,s.Bz)(h)),h}}},10943:(G,R,e)=>{"use strict";e.d(R,{Ay:()=>l,Bz:()=>g,bK:()=>r,n:()=>a});var t=e(65307);const n={organization:{},userOrgs:[]},s=(0,t.Z0)({name:"organization",initialState:n,reducers:{organizationLoaded:(d,c)=>({...d,organization:c.payload}),setOrganizationName:(d,c)=>({...d,organization:{...d.organization,name:c.payload}}),userOrganizationsLoaded:(d,c)=>({...d,userOrgs:c.payload})}}),{setOrganizationName:a,organizationLoaded:r,userOrganizationsLoaded:g}=s.actions,l={organization:s.reducer}},17888:(G,R,e)=>{"use strict";e.d(R,{a:()=>P});var t=e(74848),n=e(32196),s=e(47070),a=e(41987),r=e(13544),g=e(39601),i=e(40845),l=e(79041),d=e(96540),c=e(14578);const h=d.forwardRef(({icon:C,children:b,onClick:T,...S},O)=>{const M=(0,i.of)(o);return(0,t.jsxs)("button",{...S,className:M.action,onClick:T,children:[(0,t.jsx)(c.I,{name:C,size:"xl"}),b]})});h.displayName="CardButton";const o=C=>({action:(0,n.css)({display:"flex",flexDirection:"column",height:"100%",justifySelf:"center",cursor:"pointer",background:C.colors.background.secondary,borderRadius:C.shape.radius.default,color:C.colors.text.primary,border:"unset",width:"100%",justifyContent:"center",alignItems:"center",textAlign:"center","&:hover":{background:C.colors.emphasize(C.colors.background.secondary)}})});var m=e(15054),u=e(33390),p=e(53466),f=e(32696),y=e(14792),x=e(31678),v=e(79971);function P(C){const b=(0,i.of)(D),T=(0,l.d2)(),S=new s.v2(C.data),{dataSummary:O}=S,M=E(C,O),I=(0,x.useDispatch)(),L=(0,y.UA)().getCurrent()?.getPanelById(C.panelId),B=()=>{u.A.setObject(m.wV,f.__.Suggestions),I((0,p.eK)(!0))},j=()=>{L&&I((0,v.gW)({panel:L,pluginId:"table"}))},A=K=>{L&&(I((0,v.gW)({...K,panel:L})),K.transformations&&setTimeout(()=>{g.Ny.partial({tab:"transform"})},100))};return(0,t.jsxs)("div",{className:b.wrapper,children:[(0,t.jsx)("div",{className:b.message,"data-testid":r.Tp.components.Panels.Panel.PanelDataErrorMessage,children:M}),T.app===a.Jk.PanelEditor&&O.hasData&&L&&(0,t.jsxs)("div",{className:b.actions,children:[C.suggestions&&(0,t.jsx)(t.Fragment,{children:C.suggestions.map(K=>(0,t.jsx)(h,{icon:"process",onClick:()=>A(K),children:K.name},K.name))}),(0,t.jsx)(h,{icon:"table",onClick:j,children:"Switch to table"}),(0,t.jsx)(h,{icon:"chart-line",onClick:B,children:"Open visualization suggestions"})]})]})}function E({data:C,fieldConfig:b,message:T,needsNumberField:S,needsTimeField:O,needsStringField:M},I){return T||(!C.series||C.series.length===0||C.series.every(L=>L.length===0)?b?.defaults.noValue??"No data":M&&!I.hasStringField?"Data is missing a string field":S&&!I.hasNumberField?"Data is missing a number field":O&&!I.hasTimeField?"Data is missing a time field":"Cannot visualize data")}const D=C=>({wrapper:(0,n.css)({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%",width:"100%"}),message:(0,n.css)({textAlign:"center",color:C.colors.text.secondary,fontSize:C.typography.size.lg,width:"100%"}),actions:(0,n.css)({marginTop:C.spacing(2),display:"flex",height:"50%",maxHeight:"150px",columnGap:C.spacing(1),rowGap:C.spacing(1),width:"100%",maxWidth:"600px"})})},41394:(G,R,e)=>{"use strict";e.d(R,{$:()=>d,W:()=>l});var t=e(74848),n=e(96540),s=e(65158),a=e(43429),r=e(42418),g=e(31678);class i extends n.PureComponent{constructor(h){super(h)}render(){const h={display:"flex",alignItems:"center",justifyContent:"center",height:"100%"};return(0,t.jsx)("div",{style:h,children:(0,t.jsx)(r.F,{severity:g.AppNotificationSeverity.Error,...this.props})})}}function l(c,h){const o=class extends n.PureComponent{render(){const p=(0,t.jsxs)(t.Fragment,{children:["Check the server startup logs for more information. ",(0,t.jsx)("br",{}),"If this plugin was loaded from Git, then make sure it was compiled."]});return(0,t.jsx)(i,{title:`Error loading: ${c.id}`,text:p})}},m=new s.m(o);return m.meta=c,m.loadError=!0,m}function d(c,h){const o=class extends n.PureComponent{render(){return(0,t.jsx)(i,{title:`Panel plugin not found: ${c}`})}},m=new s.m(h?()=>null:o);return m.meta={id:c,name:c,sort:100,type:a.QE.panel,module:"",baseUrl:"",info:{author:{name:""},description:"",links:[],logos:{large:"",small:"public/img/grafana_icon.svg"},screenshots:[],updated:"",version:""}},m}},20726:(G,R,e)=>{"use strict";e.d(R,{m:()=>u});var t=e(74848),n=e(96540),s=e(1933),a=e(90708),r=e(13834),g=e(581),i=e(72574),l=e(40845),d=e(79041),c=e(66602),h=e(10096),o=e(15162);const m={defaults:{},overrides:[]};function u(f){const{pluginId:y,data:x,timeZone:v=(0,s.O)(),options:P={},width:E,height:D,title:C,onOptionsChange:b=()=>{},onChangeTimeRange:T=()=>{},onFieldConfigChange:S=()=>{},fieldConfig:O=m}=f,M=(0,l.$j)(),I=(0,i.w)(),L=(0,n.useMemo)(()=>I.replace.bind(I),[I]),[B,j]=(0,n.useState)((0,o.PY)(y)),[A,K]=(0,n.useState)(),W=p(B,P,O),{dataLinkPostProcessor:U}=(0,d.d2)(),F=(0,a.rJ)(B,W?.fieldConfig,x,v,M,L,U);if((0,n.useEffect)(()=>{B&&B.hasPluginId(y)||(0,o.TV)(y).then(w=>j(w)).catch(w=>{K(w.message)})},[y,B]),A)return(0,t.jsxs)("div",{children:["Failed to load plugin: ",A]});if(!B||!B.hasPluginId(y))return(0,t.jsx)("div",{children:"Loading plugin panel..."});if(!B.panel)return(0,t.jsx)("div",{children:"Seems like the plugin you are trying to load does not have a panel component."});if(!F)return(0,t.jsx)("div",{children:"No panel data"});const V=B.panel;return(0,t.jsx)(c.Xw,{dependencies:[B,x],children:(0,t.jsx)(r.a,{meta:B.meta,children:(0,t.jsx)(V,{id:1,data:F,title:C,timeRange:F.timeRange,timeZone:v,options:W.options,fieldConfig:O,transparent:!1,width:E,height:D,renderCounter:0,replaceVariables:w=>w,onOptionsChange:b,onFieldConfigChange:S,onChangeTimeRange:T,eventBus:h.lE})})})}function p(f,y,x){return(0,n.useMemo)(()=>{if(f)return(0,g.F)({plugin:f,currentOptions:y,currentFieldConfig:x,isAfterPluginChange:!1})},[f,x,y])}},25701:(G,R,e)=>{"use strict";e.d(R,{b:()=>p});var t=e(74848),n=e(32196),s=e(70255),a=e(43429),r=e(51527),g=e(13544),i=e(40845),l=e(29158),d=e(98624),c=e(72129),h=e(10803);const o=38,m=({isCurrent:v,title:P,plugin:E,onClick:D,onDelete:C,disabled:b,showBadge:T,description:S,children:O})=>{const M=(0,i.of)(y),I=b||E.state===a.pn.deprecated,L=(0,n.cx)({[M.item]:!0,[M.itemDisabled]:I,[M.current]:v});return(0,t.jsxs)("div",{className:L,"aria-label":g.Tp.components.PluginVisualization.item(E.name),"data-testid":g.Tp.components.PluginVisualization.item(E.name),onClick:I?void 0:D,title:v?"Click again to close this section":E.name,children:[(0,t.jsx)("img",{className:(0,n.cx)(M.img,{[M.disabled]:I}),src:E.info.logos.small,alt:""}),(0,t.jsxs)("div",{className:(0,n.cx)(M.itemContent,{[M.disabled]:I}),children:[(0,t.jsx)("div",{className:M.name,children:P}),S?(0,t.jsx)("span",{className:M.description,children:S}):null,O]}),T&&(0,t.jsx)("div",{className:(0,n.cx)(M.badge,{[M.disabled]:I}),children:(0,t.jsx)(x,{plugin:E})}),C&&(0,t.jsx)(l.K,{name:"trash-alt",onClick:B=>{B.stopPropagation(),C()},className:M.deleteButton,"aria-label":"Delete button on panel type card",tooltip:"Delete"})]})};m.displayName="PanelTypeCard";const u=({children:v,hasDescription:P,hasDelete:E,rootProps:D})=>{const C=(0,i.of)(y),b=(0,i.of)(f);return(0,t.jsxs)("div",{className:C.item,...D,children:[(0,t.jsx)(s.A,{className:(0,n.cx)(C.img,b.image),width:o,height:o}),(0,t.jsxs)("div",{className:C.itemContent,children:[(0,t.jsx)("div",{className:C.name,children:(0,t.jsx)(s.A,{width:160})}),P?(0,t.jsx)(s.A,{containerClassName:C.description,width:80}):null,v]}),E&&(0,t.jsx)(s.A,{containerClassName:(0,n.cx)(C.deleteButton,b.deleteButton),width:16,height:16})]})},p=(0,c.j)(m,u),f=()=>({deleteButton:(0,n.css)({lineHeight:1}),image:(0,n.css)({lineHeight:1})}),y=v=>({item:(0,n.css)({position:"relative",display:"flex",flexShrink:0,cursor:"pointer",background:v.colors.background.secondary,borderRadius:v.shape.radius.default,boxShadow:v.shadows.z1,border:`1px solid ${v.colors.background.secondary}`,alignItems:"center",padding:v.spacing(1),width:"100%",overflow:"hidden",[v.transitions.handleMotion("no-preference","reduce")]:{transition:v.transitions.create(["background"],{duration:v.transitions.duration.short})},"&:hover":{background:v.colors.emphasize(v.colors.background.secondary,.03)}}),itemContent:(0,n.css)({overflow:"hidden",position:"relative",padding:v.spacing(0,1)}),itemDisabled:(0,n.css)({cursor:"default","&, &:hover":{background:v.colors.action.disabledBackground}}),current:(0,n.css)({label:"currentVisualizationItem",border:`1px solid ${v.colors.primary.border}`,background:v.colors.action.selected}),disabled:(0,n.css)({opacity:.6,filter:"grayscale(1)",cursor:"default",pointerEvents:"none"}),name:(0,n.css)({textOverflow:"ellipsis",overflow:"hidden",fontSize:v.typography.size.sm,fontWeight:v.typography.fontWeightMedium,width:"100%"}),description:(0,n.css)({display:"block",textOverflow:"ellipsis",overflow:"hidden",color:v.colors.text.secondary,fontSize:v.typography.bodySmall.fontSize,fontWeight:v.typography.fontWeightLight,width:"100%",maxHeight:"4.5em"}),img:(0,n.css)({maxHeight:o,width:o,display:"flex",alignItems:"center"}),badge:(0,n.css)({background:v.colors.background.primary}),deleteButton:(0,n.css)({cursor:"pointer",marginLeft:"auto"})}),x=({plugin:v})=>(0,r.x)(v.signature)?(0,t.jsx)(d.B,{status:v.signature}):(0,t.jsx)(h.p,{state:v.state});x.displayName="PanelPluginBadge"},56707:(G,R,e)=>{"use strict";e.d(R,{a:()=>x});var t=e(74848),n=e(32196),s=e(16817),a=e(70713),r=e(40845),g=e(47070),i=e(32264),l=e(15162);const d=["timeseries","barchart","gauge","stat","piechart","bargauge","table","state-timeline","status-history","logs","candlestick","flamegraph","traces","nodeGraph"];async function c(E,D){const C=new g.v2(E,D);for(const T of d){const O=(await(0,l.TV)(T)).getSuggestionsSupplier();O&&O.getSuggestionsForData(C)}const b=C.getList();if(!i.$.featureToggles.vizAndWidgetSplit&&C.dataSummary.fieldCount===0)for(const T of Object.values(i.$.panels))!T.skipDataQuery||T.hideFromList||b.push({name:T.name,pluginId:T.id,description:T.info.description,cardOptions:{imgSrc:T.info.logos.small}});return b.sort((T,S)=>{if(C.dataSummary.preferredVisualisationType){if(T.pluginId===C.dataSummary.preferredVisualisationType)return-1;if(S.pluginId===C.dataSummary.preferredVisualisationType)return 1}return(S.score??g.nQ.OK)-(T.score??g.nQ.OK)})}var h=e(2543),o=e(13544),m=e(56034),u=e(20726);function p({data:E,suggestion:D,onChange:C,width:b}){const T=(0,r.of)(f),{innerStyles:S,outerStyles:O,renderWidth:M,renderHeight:I}=y(b),L=D.cardOptions??{},B={"aria-label":D.name,className:T.vizBox,"data-testid":o.Tp.components.VisualizationPreview.card(D.name),style:O,onClick:()=>{C({pluginId:D.pluginId,options:D.options,fieldConfig:D.fieldConfig})}};if(L.imgSrc)return(0,t.jsx)(m.m,{content:D.description??D.name,children:(0,t.jsxs)("button",{...B,className:(0,n.cx)(T.vizBox,T.imgBox),children:[(0,t.jsx)("div",{className:T.name,children:D.name}),(0,t.jsx)("img",{className:T.img,src:L.imgSrc,alt:D.name})]})});let j=D;return D.cardOptions?.previewModifier&&(j=(0,h.cloneDeep)(D),D.cardOptions.previewModifier(j)),(0,t.jsx)("button",{...B,children:(0,t.jsx)(m.m,{content:D.name,children:(0,t.jsxs)("div",{style:S,className:T.renderContainer,children:[(0,t.jsx)(u.m,{title:"",data:E,pluginId:D.pluginId,width:M,height:I,options:j.options,fieldConfig:j.fieldConfig}),(0,t.jsx)("div",{className:T.hoverPane})]})})})}const f=E=>({hoverPane:(0,n.css)({position:"absolute",top:0,right:0,left:0,borderRadius:E.spacing(2),bottom:0}),vizBox:(0,n.css)`
      position: relative;
      background: none;
      border-radius: ${E.shape.radius.default};
      cursor: pointer;
      border: 1px solid ${E.colors.border.medium};

      transition: ${E.transitions.create(["background"],{duration:E.transitions.duration.short})};

      &:hover {
        background: ${E.colors.background.secondary};
      }
    `,imgBox:(0,n.css)`
      display: flex;
      flex-direction: column;
      height: 100%;

      justify-self: center;
      color: ${E.colors.text.primary};
      width: 100%;
      display: flex;

      justify-content: center;
      align-items: center;
      text-align: center;
    `,name:(0,n.css)`
      padding-bottom: ${E.spacing(.5)};
      margin-top: ${E.spacing(-1)};
      font-size: ${E.typography.bodySmall.fontSize};
      white-space: nowrap;
      overflow: hidden;
      color: ${E.colors.text.secondary};
      font-weight: ${E.typography.fontWeightMedium};
      text-overflow: ellipsis;
    `,img:(0,n.css)`
      max-width: ${E.spacing(8)};
      max-height: ${E.spacing(8)};
    `,renderContainer:(0,n.css)`
      position: absolute;
      transform-origin: left top;
      top: 6px;
      left: 6px;
    `});function y(E){const C=E,b=E*(1/1.6),T=350,S=T*(1/1.6),O=6,M=(C-O*2)/T,I=(b-O*2)/S;return{renderHeight:S,renderWidth:T,outerStyles:{width:C,height:b},innerStyles:{width:T,height:S,transform:`scale(${M}, ${I})`}}}function x({searchQuery:E,onChange:D,data:C,panel:b}){const T=(0,r.of)(P),{value:S}=(0,s.A)(()=>c(C,b),[C,b]),O=v(E,S);return(0,t.jsx)("div",{children:(0,t.jsx)(a.Ay,{disableHeight:!0,style:{width:"100%",height:"100%"},children:({width:M})=>{if(!M)return null;M=M-1;const I=Math.floor(M/200),L=8*(I-1),B=Math.floor((M-L)/I);return(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:T.filterRow,children:(0,t.jsx)("div",{className:T.infoText,children:"Based on current data"})}),(0,t.jsxs)("div",{className:T.grid,style:{gridTemplateColumns:`repeat(auto-fill, ${B}px)`},children:[O.map((j,A)=>(0,t.jsx)(p,{data:C,suggestion:j,onChange:D,width:B-1},A)),E&&O.length===0&&(0,t.jsx)("div",{className:T.infoText,children:"No results matched your query"})]})]})}})})}function v(E,D){if(!E||!D)return D||[];const C=new RegExp(E,"i");return D.filter(b=>C.test(b.name)||C.test(b.pluginId))}const P=E=>({heading:(0,n.css)({...E.typography.h5,margin:E.spacing(0,.5,1)}),filterRow:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",paddingBottom:"8px"}),infoText:(0,n.css)({fontSize:E.typography.bodySmall.fontSize,color:E.colors.text.secondary,fontStyle:"italic"}),grid:(0,n.css)({display:"grid",gridGap:E.spacing(1),gridTemplateColumns:"repeat(auto-fill, 144px)",marginBottom:E.spacing(1),justifyContent:"space-evenly"})})},86292:(G,R,e)=>{"use strict";e.d(R,{G:()=>d});var t=e(74848),n=e(32196),s=e(96540),a=e(32264),r=e(40845),g=e(41670),i=e(17706),l=e(48889);function d({pluginId:h,searchQuery:o,onChange:m,isWidget:u=!1}){const p=(0,r.of)(c),f=(0,s.useMemo)(()=>a.$.featureToggles.vizAndWidgetSplit?u?(0,i.nr)():(0,i.if)():(0,i.A4)(),[u]),y=(0,s.useMemo)(()=>(0,i.CO)(f,o,h),[f,o,h]);return y.length===0?(0,t.jsx)(g.Z,{children:"Could not find anything matching your query"}):(0,t.jsx)("div",{className:p.grid,children:y.map(x=>(0,t.jsx)(l.f,{disabled:!1,isCurrent:x.id===h,plugin:x,onClick:v=>m({pluginId:x.id,withModKey:v.metaKey||v.ctrlKey||v.altKey})},x.id))})}const c=h=>({grid:(0,n.css)({maxWidth:"100%",display:"grid",gridGap:h.spacing(.5)}),heading:(0,n.css)({...h.typography.h5,margin:h.spacing(0,.5,1)})})},48889:(G,R,e)=>{"use strict";e.d(R,{f:()=>s});var t=e(74848),n=e(25701);const s=({isCurrent:a,plugin:r,onClick:g,disabled:i})=>(0,t.jsx)(n.b,{title:r.name,plugin:r,description:r.info.description,onClick:g,isCurrent:a,disabled:i,showBadge:!0});s.displayName="VizTypePickerPlugin"},32349:(G,R,e)=>{"use strict";e.d(R,{CH:()=>l,E7:()=>i,EO:()=>g});var t=e(14236),n=e(83195),s=e(92461),a=e(32023),r=e(29304);const g=d=>{const c=d.field.links;if(!(!c||c.length===0))return{getLinks:h=>{const o={};if(d.view){const{dataFrame:u}=d.view;o.__series={value:{name:u.name,refId:u.refId},text:"Series"};const p=d.colIndex!==void 0?u.fields[d.colIndex]:void 0;if(p){if(o.__field={value:{name:p.name,labels:p.labels},text:"Field"},d.rowIndex!==void 0&&d.rowIndex>=0){const{timeField:f}=(0,t.KR)(u);o.__value={value:{raw:p.values[d.rowIndex],numeric:d.display.numeric,text:(0,n.cN)(d.display),time:f?f.values[d.rowIndex]:void 0},text:"Value"}}d.view&&(o.__data={value:{name:u.name,refId:u.refId,fields:(0,s.F)({frame:u,rowIndex:d.rowIndex})},text:"Data"})}else o.__value={value:{raw:d.display.numeric,numeric:d.display.numeric,text:(0,n.cN)(d.display),calc:d.name},text:"Value"}}else console.log("VALUE",d);const m=(u,p,f)=>{const y={...o,...p};return h(u,y,f)};return c.map(u=>(0,r.mQ)().getDataLinkUIModel(u,m,d))}}},i=(d,c)=>{const h=d.links;if(!(!h||h.length===0))return{getLinks:()=>h.map(o=>(0,r.mQ)().getDataLinkUIModel(o,c||d.replaceVariables,d))}},l=(d,c)=>{const h=a.b4.getPanelLinks(d)?.state.rawLinks;if(!(!h||h.length===0))return{getLinks:()=>h.map(o=>(0,r.mQ)().getDataLinkUIModel(o,c,d))}}},29304:(G,R,e)=>{"use strict";e.d(R,{Fq:()=>x,Hf:()=>E,mQ:()=>S});var t=e(2543),n=e.n(t),s=e(6709),a=e(91890),r=e(28240),g=e(11261),i=e(71733),l=e(80997),d=e(76885),c=e(95344),h=e(72574),o=e(52622),m=e(2913);const u=[{value:`${s.c.keepTime}`,label:"Time range",documentation:"Adds current time range",origin:a.$0.BuiltIn},{value:`${s.c.timeRangeFrom}`,label:"Time range: from",documentation:"Adds current time range's from value",origin:a.$0.BuiltIn},{value:`${s.c.timeRangeTo}`,label:"Time range: to",documentation:"Adds current time range's to value",origin:a.$0.BuiltIn}],p=[{value:`${s.c.seriesName}`,label:"Name",documentation:"Name of the series",origin:a.$0.Series}],f=[{value:`${s.c.valueNumeric}`,label:"Numeric",documentation:"Numeric representation of selected value",origin:a.$0.Value},{value:`${s.c.valueText}`,label:"Text",documentation:"Text representation of selected value",origin:a.$0.Value},{value:`${s.c.valueRaw}`,label:"Raw",documentation:"Raw value",origin:a.$0.Value}],y=O=>O.includes(".")||O.trim().includes(" ")?`["${O}"]`:`.${O}`,x=()=>[...(0,h.w)().getVariables().map(O=>({value:O.name,label:O.name,origin:a.$0.Template})),{value:`${s.c.includeVars}`,label:"All variables",documentation:"Adds current variables",origin:a.$0.Template},...u],v=O=>{const M=[];for(const L of O)for(const B of L.fields)if(B.labels)for(const j of Object.keys(B.labels))M.push(j);const I=(0,t.chain)(M).flatten().uniq().value();return[{value:`${s.c.fieldName}`,label:"Name",documentation:"Field name of the clicked datapoint (in ms epoch)",origin:a.$0.Field},...I.map(L=>({value:`__field.labels${y(L)}`,label:`labels.${L}`,documentation:`${L} label value`,origin:a.$0.Field}))]},P=O=>{let M,I;const L=[],B={};if(O.length!==1)return[];const j=O[0];for(const A of j.fields){const K=(0,r.Ct)(A,j,O);B[K]||(L.push({value:`__data.fields${y(K)}`,label:`${K}`,documentation:`Formatted value for ${K} on the same row`,origin:a.$0.Fields}),B[K]=!0,!M&&A.type===g.PU.number&&(M={...A,name:K}),!I&&A.config.displayName&&A.config.displayName!==A.name&&(I={...A,name:K}))}return L.length&&L.push({value:"__data.fields[0]",label:"Select by index",documentation:"Enter the field order",origin:a.$0.Fields}),M&&(L.push({value:`__data.fields${y(M.name)}.numeric`,label:"Show numeric value",documentation:"the numeric field value",origin:a.$0.Fields}),L.push({value:`__data.fields${y(M.name)}.text`,label:"Show text value",documentation:"the text value",origin:a.$0.Fields})),I&&L.push({value:`__data.fields${y(I.name)}`,label:"Select by title",documentation:"Use the title to pick the field",origin:a.$0.Fields}),L},E=(O,M)=>{const I={value:`${s.c.valueTime}`,label:"Time",documentation:"Time value of the clicked datapoint (in ms epoch)",origin:a.$0.Value};return M===a.uP.Values?[...p,...v(O),...f,I,...P(O),...x()]:[...p,...v(O),...P(O),...x()]},D=O=>{const M=v(O),I={value:`${DataLinkBuiltInVars.valueCalc}`,label:"Calculation name",documentation:"Name of the calculation the value is a result of",origin:VariableOrigin.Value};return[...p,...M,...f,I,...x()]};class C{constructor(){this.getDataLinkUIModel=(M,I,L)=>{let B=M.url;M.onBuildUrl&&(B=M.onBuildUrl({origin:L,replaceVariables:I}));const j={href:i.I.assureBaseUrl(B.replace(/\n/g,"")),title:M.title??"",target:M.targetBlank?"_blank":void 0,origin:L};return I&&(j.href=I(j.href,void 0,o.$m.UriEncode),j.title=I(M.title)),M.onClick&&(j.onClick=A=>{M.onClick({origin:L,replaceVariables:I,e:A})}),j.href=(0,m.zj)().disableSanitizeHtml?j.href:l.sQ.sanitizeUrl(j.href),j}}getLinkUrl(M){let I={};M.keepTime&&(I[`$${s.c.keepTime}`]=!0),M.includeVars&&(I[`$${s.c.includeVars}`]=!0);let L=i.I.assureBaseUrl(d.kM.appendQueryToUrl(M.url||"",d.kM.toUrlParams(I)));return L=(0,h.w)().replace(L),(0,m.zj)().disableSanitizeHtml?L:l.sQ.sanitizeUrl(L)}getAnchorInfo(M){const I=(0,h.w)();return{href:this.getLinkUrl(M),title:I.replace(M.title||""),tooltip:I.replace(M.tooltip||"")}}getPanelLinkAnchorInfo(M,I){(0,c.l)("link_srv.ts","getPanelLinkAnchorInfo","getDataLinkUIModel");const L=(B,j,A)=>(0,h.w)().replace(B,{...I,...j},A);return this.getDataLinkUIModel(M,L,{})}}let b;function T(O){b=O}function S(){return b||(b=new C),b}},79971:(G,R,e)=>{"use strict";e.d(R,{Ap:()=>i,O6:()=>l,Xk:()=>c,gW:()=>d});var t=e(581),n=e(57767),s=e(41394),a=e(20701),r=e(28444),g=e(80095);function i(o){return async(m,u)=>{if(o.libraryPanel?.uid&&!("model"in o.libraryPanel)){m(h(o));return}o.maxDataPoints&&(o.maxDataPoints=Number(o.maxDataPoints));let p=o.type,f=u().plugins.panels[p];if(!f)try{f=await m((0,a.y7)(p))}catch{f=(0,s.$)(p,p==="row")}o.plugin||await o.pluginLoaded(f),m((0,g.XM)({key:o.key,plugin:f}))}}function l(o){return m=>{m((0,g.FC)({key:o}))}}function d({panel:o,pluginId:m,options:u,fieldConfig:p,transformations:f}){return async(y,x)=>{if(o.type===m&&!u&&!p&&!f)return;let P=x().plugins.panels[m];if(P||(P=await y((0,a.y7)(m))),o.type!==m&&o.changePlugin(P),u||p||f){const E=(0,t.F)({plugin:P,currentOptions:u||o.options,currentFieldConfig:p||o.fieldConfig,isAfterPluginChange:!1});o.options=E.options,o.fieldConfig=E.fieldConfig,o.transformations=f||o.transformations,o.configRev++}o.generateNewKey(),y((0,g.XM)({key:o.key,plugin:P}))}}function c(o,m){return async(u,p)=>{const f=m.model.type,y=o.type;if(o.restoreModel({...m.model,gridPos:o.gridPos,id:o.id,libraryPanel:m}),o.getQueryRunner().clearLastResult(),y!==f){let v=p().plugins.panels[f];v||(v=await u((0,a.y7)(f))),await o.pluginLoaded(v),o.generateNewKey(),await u((0,g.XM)({key:o.key,plugin:v}))}else{const x=o.key;o.generateNewKey(),u((0,g.io)({oldKey:x,newKey:o.key}))}o.configRev=0,o.hasSavedPanelEditChange=!0,o.refresh(),o.events.publish(r.zq),o.events.publish(r.PR)}}function h(o){return async(m,u)=>{const p=o.libraryPanel.uid;try{const f=await(0,n.Yr)(p,!0);o.initLibraryPanel(f);const y=u().dashboard.getModel();if(o.repeat&&y){const x=y.panels.findIndex(v=>v.id===o.id);y.repeatPanel(o,x),y.sortPanelsByGridPos(),y.events.publish(new r.Q$)}await m(i(o))}catch(f){console.log("ERROR: ",f),m((0,g.XM)({key:o.key,plugin:(0,s.$)("Unable to load library panel: "+p,!1)}))}}}},80095:(G,R,e)=>{"use strict";e.d(R,{Ay:()=>h,FC:()=>l,S3:()=>r,XM:()=>a,io:()=>i,nF:()=>g,rG:()=>d});var t=e(65307);const n={},s=(0,t.Z0)({name:"panels",initialState:n,reducers:{panelModelAndPluginReady:(o,m)=>{o[m.payload.key]={plugin:m.payload.plugin}},changePanelKey:(o,m)=>{o[m.payload.newKey]=o[m.payload.oldKey],delete o[m.payload.oldKey]},removePanel:(o,m)=>{delete o[m.payload.key]},removeAllPanels:o=>{Object.keys(o).forEach(m=>delete o[m])},setPanelInstanceState:(o,m)=>{o[m.payload.key].instanceState=m.payload.value},setPanelAngularComponent:(o,m)=>{const u=o[m.payload.key];u.angularComponent=m.payload.angularComponent}}}),{panelModelAndPluginReady:a,setPanelAngularComponent:r,setPanelInstanceState:g,changePanelKey:i,removePanel:l,removeAllPanels:d}=s.actions,h={panels:s.reducer}},40334:(G,R,e)=>{"use strict";e.d(R,{U:()=>t});function t(n,s){return n.panels[s.key]}},17706:(G,R,e)=>{"use strict";e.d(R,{A4:()=>a,CO:()=>i,if:()=>g,nr:()=>r});var t=e(43429),n=e(54479),s=e(2913);function a(){const l=s.$W.panels;return Object.keys(l).filter(d=>l[d].hideFromList===!1).map(d=>l[d]).sort((d,c)=>d.sort-c.sort)}function r(){return a().filter(l=>!!l.skipDataQuery)}function g(){return a().filter(l=>!l.skipDataQuery)}function i(l,d,c){if(!d.length)return l.filter(p=>p.state===t.pn.deprecated?c===p.id:!0);const h=(0,n.xb)(d).toLowerCase(),o=[],m=[],u="graph".startsWith(h);for(const p of l){if(p.state===t.pn.deprecated&&c!==p.id)continue;const y=p.name.toLowerCase().indexOf(h);y===0?o.push(p):y>0?m.push(p):u&&p.id==="timeseries"&&o.push(p)}return o.concat(m)}},2609:(G,R,e)=>{"use strict";e.d(R,{_o:()=>h});var t=e(2543),n=e.n(t),s=e(71733),a=e(76885),r=e(65879),g=e(39601),i=e(2619),l=e(86022);const d={kiosk:!0,autofitpanels:!0,orgId:!0,"_dash.hideTimePicker":!0,"_dash.hideVariables":!0,"_dash.hideLinks":!0};class c extends i.Q{constructor(){super({isPlaying:!1}),this.urls=[],this.index=0,this.numberOfLoops=0,this.locationUpdated=this.locationUpdated.bind(this),this.api=(0,l.NF)()}next(){if(clearTimeout(this.nextTimeoutId),this.index>this.urls.length-1){if(this.numberOfLoops++,this.numberOfLoops>=3){window.location.href=this.startUrl;return}this.index=0}const u=this.urls[this.index],p=g.Ny.getSearchObject(),f=(0,t.pickBy)(p,(x,v)=>d[v]),y=s.I.stripBaseFromUrl(u);this.index++,this.validPlaylistUrl=y,this.nextTimeoutId=setTimeout(()=>this.next(),this.interval),g.Ny.push(y+"?"+a.kM.toUrlParams(f))}prev(){this.index=Math.max(this.index-2,0),this.next()}locationUpdated(m){m.pathname!==this.validPlaylistUrl&&this.stop()}async start(m){this.stop(),this.startUrl=window.location.href,this.index=0,this.setState({isPlaying:!0}),this.locationListenerUnsub=g.Ny.getHistory().listen(this.locationUpdated);const u=[];let p=await this.api.getPlaylist(m);if(!p.items?.length)return;this.interval=r.intervalToMs(p.interval);const f=await(0,l.qY)(p.items);for(const y of f)if(y.dashboards)for(const x of y.dashboards)u.push(x.url);u.length&&(this.urls=u,this.setState({isPlaying:!0}),this.next())}stop(){this.state.isPlaying&&(this.index=0,this.setState({isPlaying:!1}),this.locationListenerUnsub&&this.locationListenerUnsub(),this.nextTimeoutId&&clearTimeout(this.nextTimeoutId),g.Ny.getSearchObject().kiosk&&g.Ny.partial({kiosk:null}))}}const h=new c},86022:(G,R,e)=>{"use strict";e.d(R,{GM:()=>v,NF:()=>P,aV:()=>x,qY:()=>y});var t=e(75505),n=e(78368),s=e(17172),a=e(32264),r=e(82467),g=e(3169),i=e(90183),l=e(68706),d=e(99140),c=e(2468),h=e(65812);class o{async getAllPlaylist(){return(0,s.AI)().get("/api/playlists/")}async getPlaylist(D){const C=await(0,s.AI)().get(`/api/playlists/${D}`);return await p(C),C}async createPlaylist(D){await f(()=>(0,s.AI)().post("/api/playlists",D))}async updatePlaylist(D){await f(()=>(0,s.AI)().put(`/api/playlists/${D.uid}`,D))}async deletePlaylist(D){await f(()=>(0,s.AI)().delete(`/api/playlists/${D}`),"Playlist deleted")}}class m{constructor(){this.playlistAsK8sResource=D=>({metadata:{name:D.uid},spec:{title:D.name,interval:D.interval,items:D.items??[]}}),this.server=new c.w({group:"playlist.grafana.app",version:"v0alpha1",resource:"playlists"})}async getAllPlaylist(){return(await this.server.list()).items.map(u)}async getPlaylist(D){const C=await this.server.get(D),b=u(C);return await p(b),b}async createPlaylist(D){const C=this.playlistAsK8sResource(D);await f(async()=>{await this.server.create(C)})}async updatePlaylist(D){const C=this.playlistAsK8sResource(D);await f(()=>this.server.update(C).then(()=>{}))}async deletePlaylist(D){await f(()=>this.server.delete(D).then(()=>{}),"Playlist deleted")}}function u(E){const{spec:D,metadata:C}=E;return{uid:C.name,name:D.title,interval:D.interval,items:D.items}}async function p(E){if(E?.items){for(const D of E.items)if(D.type==="dashboard_by_id"){D.type="dashboard_by_uid";const C=await(0,s.AI)().get(`/api/dashboards/ids/${D.value}`);C?.length&&(D.value=C[0])}}}async function f(E,D="Playlist saved"){try{await E(),(0,d.JD)((0,r.dx)((0,g.tZ)(D)))}catch(C){C instanceof Error&&(0,d.JD)((0,r.dx)((0,g.gi)("Unable to save playlist",C)))}}async function y(E){let D=0;if(!E?.length)return[];const C=[];for(const S of E){const O={query:"*",kind:["dashboard"],limit:1e3};switch(S.type){case"dashboard_by_id":throw new Error("invalid item (with id)");case"dashboard_by_uid":O.uid=[S.value];break;case"dashboard_by_tag":O.tags=[S.value];break}C.push({refId:`${D++}`,queryType:l.nj.Search,search:O})}if(!a.$.featureToggles.panelTitleSearch){const S=(0,h.getGrafanaSearcher)(),O=[];for(let M=0;M<C.length;M++){const I=(await S.search(C[M].search)).view;O.push({...E[M],dashboards:I.map(L=>({...L}))})}return O}const b=await(0,i.o)(),T=await(0,t.s)(b.query({targets:C}));if(T.data.length!==E.length)throw new Error("unexpected result size");return E.map((S,O)=>{const M=new n.R(T.data[O]);return{...S,dashboards:M.map(I=>({...I}))}})}function x(){return{items:[],interval:"5m",name:"",uid:""}}function v(E,D){return D?.length?(D=D.toLowerCase(),E.filter(C=>C.name.toLowerCase().includes(D))):E}function P(){return a.$.featureToggles.kubernetesPlaylists?new m:new o}},84684:(G,R,e)=>{"use strict";e.d(R,{Ap:()=>u,Bj:()=>l,CB:()=>g,Gd:()=>m,T_:()=>i,XP:()=>p,cu:()=>y,ij:()=>x,xZ:()=>f});var t=e(36663),n=e(17172),s=e(80714),a=e(6745),r=e(5129);async function g(P){const E=await d(P),D=!!E,[C,b,T,S]=await Promise.all([m(),c(P,D),h(P),o(P)]),O=C.find(I=>I.id===P),M=O?.dependencies||E?.json?.dependencies;return{grafanaDependency:M?.grafanaDependency??M?.grafanaVersion??"",pluginDependencies:M?.plugins||[],links:O?.info.links||E?.json?.info.links||[],readme:T||E?.readme,versions:b,statusContext:E?.statusContext??"",iam:E?.json?.iam,changelog:S||E?.changelog}}async function i(){try{const{items:P}=await(0,n.AI)().get(`${a.P5}/plugins`,{includeDeprecated:!0});return P.filter(r.hY)}catch(P){if((0,n.NF)(P))return P.isHandled=!0,console.error("Failed to fetch plugins from catalog (default https://grafana.com/api/plugins)"),[];throw P}}async function l(){try{return await(0,n.AI)().get(`${a.Sw}/errors`)}catch{return[]}}async function d(P){try{return await(0,n.AI)().get(`${a.P5}/plugins/${P}`,{})}catch(E){(0,n.NF)(E)&&(E.isHandled=!0);return}}async function c(P,E){try{return E?((await(0,n.AI)().get(`${a.P5}/plugins/${P}/versions`)).items||[]).map(C=>({version:C.version,createdAt:C.createdAt,isCompatible:C.isCompatible,grafanaDependency:C.grafanaDependency})):[]}catch(D){return(0,n.NF)(D)&&(D.isHandled=!0),[]}}async function h(P){try{const E=await(0,n.AI)().get(`${a.Sw}/${P}/markdown/README`);return E?(0,t.G)(E):""}catch(E){return(0,n.NF)(E)&&(E.isHandled=!0),""}}async function o(P){try{const E=await(0,n.AI)().get(`${a.Sw}/${P}/markdown/CHANGELOG`);return E?(0,t.G)(E):""}catch(E){return(0,n.NF)(E)&&(E.isHandled=!0),""}}async function m(){return(await(0,n.AI)().get(`${a.Sw}`,(0,s.F)({embedded:0}))).filter(r.Sq)}async function u(){const{items:P}=await(0,n.AI)().get(`${a.Mi}/plugins`);return P}async function p(){const{items:P}=await(0,n.AI)().get(`${a.Mi}/provisioned-plugins`);return P.map(E=>({slug:E.type}))}async function f(P){return await(0,n.AI)().post(`${a.Sw}/${P}/install`,void 0,{showErrorAlert:!1})}async function y(P){return await(0,n.AI)().post(`${a.Sw}/${P}/uninstall`)}async function x(P,E){return(await(0,n.AI)().datasourceRequest({url:`/api/plugins/${P}/settings`,method:"POST",data:E}))?.data}const v={getRemotePlugins:i,getInstalledPlugins:m,installPlugin:f,uninstallPlugin:y}},42930:(G,R,e)=>{"use strict";e.d(R,{G:()=>a});var t=e(74848),n=e(32196),s=e(40845);const a=({children:g,wrap:i,className:l})=>{const d=(0,s.$j)(),c=r(d,i);return(0,t.jsx)("div",{className:(0,n.cx)(c.container,l),children:g})},r=(g,i)=>({container:(0,n.css)`
    display: flex;
    flex-direction: row;
    flex-wrap: ${i?"wrap":"no-wrap"};
    & > * {
      margin-bottom: ${g.spacing()};
      margin-right: ${g.spacing()};
    }
    & > *:last-child {
      margin-right: 0;
    }
  `})},6745:(G,R,e)=>{"use strict";e.d(R,{Mi:()=>n,P5:()=>s,Sw:()=>t,fu:()=>a});const t="/api/plugins",n="/api/instance",s="/api/gnet",a="plugins"},5129:(G,R,e)=>{"use strict";e.d(R,{Gl:()=>D,H2:()=>f,N6:()=>b,R7:()=>W,Sq:()=>T,TD:()=>K,Xc:()=>x,by:()=>y,hY:()=>S,j_:()=>C,kH:()=>u,td:()=>h,tr:()=>E});var t=e(53076),n=e(43429),s=e(53531),a=e(32264),r=e(33378),g=e(2913),i=e(10096),l=e(27677),d=e(31678),c=e(66253);function h({local:U=[],remote:F=[],instance:V=[],provisioned:w=[],pluginErrors:z}){const N=[],H=v(z),Q=V.reduce((ee,Z)=>(ee.set(Z.pluginSlug,Z),ee),new Map),X=w.reduce((ee,Z)=>(ee.add(Z.slug),ee),new Set);return U.forEach(ee=>{const Z=F.find(ae=>ae.slug===ee.id),q=H[ee.id];Z||N.push(o(ee,void 0,q))}),F.forEach(ee=>{const Z=U.find(k=>k.id===ee.slug),q=H[ee.slug];if(!(ee.status===c.Uy.Deprecated&&!Z)){const k=o(Z,ee,q);if(g.Ay.featureToggles.managedPluginsInstall&&a.$.pluginAdminExternalManageEnabled){k.isFullyInstalled=k.isCore?!0:(Q.has(ee.slug)||X.has(ee.slug))&&k.isInstalled,k.isInstalled=Q.has(ee.slug)||k.isInstalled;const se=Q.get(ee.slug);k.isUpdatingFromInstance=Q.has(ee.slug)&&k.hasUpdate&&k.installedVersion!==se?.version,se?.version&&se?.version!==ee.version&&(k.hasUpdate=!0),k.isUninstallingFromInstance=!!Z&&!Q.has(ee.slug),k.isProvisioned=X.has(ee.slug)}N.push(k)}}),N}function o(U,F,V){return!U&&F?m(F,V):U&&!F?u(U,V):p(U,F,V)}function m(U,F){const{name:V,slug:w,description:z,version:N,orgName:H,popularity:Q,downloads:X,typeCode:ee,updatedAt:Z,createdAt:q,status:ae,angularDetected:k,keywords:se}=U,te=!!F||L(ee);return{description:z,downloads:X,id:w,info:{logos:{small:`${a.$.appSubUrl}/api/gnet/plugins/${w}/versions/${N}/logos/small`,large:`${a.$.appSubUrl}/api/gnet/plugins/${w}/versions/${N}/logos/large`},keywords:se},name:V,orgName:H,popularity:Q,publishedAt:q,signature:P({remote:U,error:F}),updatedAt:Z,hasUpdate:!1,isPublished:!0,isInstalled:te,isDisabled:te,isManaged:M(w),isPreinstalled:I(w),isDeprecated:ae===c.Uy.Deprecated,isCore:U.internal,isDev:!1,isEnterprise:ae===c.Uy.Enterprise,type:ee,error:F?.errorCode,angularDetected:k,isFullyInstalled:te,latestVersion:U.version}}function u(U,F){const{name:V,info:{description:w,version:z,logos:N,updated:H,author:Q,keywords:X},id:ee,dev:Z,type:q,signature:ae,signatureOrg:k,signatureType:se,hasUpdate:te,accessControl:ne,angularDetected:le}=U,re=!!F||L(q);return{description:w,downloads:0,id:ee,info:{logos:N,keywords:X},name:V,orgName:Q.name,popularity:0,publishedAt:"",signature:P({local:U,error:F}),signatureOrg:k,signatureType:se,updatedAt:H,installedVersion:z,hasUpdate:te,isInstalled:!0,isDisabled:re,isCore:ae==="internal",isPublished:!1,isDeprecated:!1,isDev:!!Z,isEnterprise:!1,isManaged:M(ee),isPreinstalled:I(ee),type:q,error:F?.errorCode,accessControl:ne,angularDetected:le,isFullyInstalled:!0,iam:U.iam,latestVersion:U.latestVersion}}function p(U,F,V){const w=U?.info.version,z=F?.slug||U?.id||"",N=U?.type||F?.typeCode,H=!!V||L(N),Q=F?.keywords||U?.info.keywords||[];let X={small:`/public/img/icn-${N}.svg`,large:`/public/img/icn-${N}.svg`};return F?X={small:`${a.$.appSubUrl}/api/gnet/plugins/${z}/versions/${F.version}/logos/small`,large:`${a.$.appSubUrl}/api/gnet/plugins/${z}/versions/${F.version}/logos/large`}:U&&U.info.logos&&(X=U.info.logos),{description:U?.info.description||F?.description||"",downloads:F?.downloads||0,hasUpdate:U?.hasUpdate||!1,id:z,info:{logos:X,keywords:Q},isCore:!!(F?.internal||U?.signature===n.Ac.internal),isDev:!!U?.dev,isEnterprise:F?.status===c.Uy.Enterprise,isInstalled:!!U||H,isDisabled:H,isDeprecated:F?.status===c.Uy.Deprecated,isPublished:!0,isManaged:M(z),isPreinstalled:I(z),name:F?.name||U?.name||"",orgName:F?.orgName||U?.info.author.name||"",popularity:F?.popularity||0,publishedAt:F?.createdAt||"",type:N,signature:P({local:U,remote:F,error:V}),signatureOrg:U?.signatureOrg||F?.versionSignedByOrgName,signatureType:U?.signatureType||F?.versionSignatureType||F?.signatureType||void 0,updatedAt:F?.updatedAt||U?.info.updated||"",installedVersion:w,error:V?.errorCode,accessControl:U?.accessControl,angularDetected:U?.angularDetected??F?.angularDetected,isFullyInstalled:!!U||H,iam:U?.iam,latestVersion:U?.latestVersion||F?.version||""}}const f=U=>`${a.$.pluginCatalogURL}${U}`;var y=(U=>(U.nameAsc="nameAsc",U.nameDesc="nameDesc",U.updated="updated",U.published="published",U.downloads="downloads",U))(y||{});const x=(U,F)=>{const V={nameAsc:(w,z)=>w.name.localeCompare(z.name),nameDesc:(w,z)=>z.name.localeCompare(w.name),updated:(w,z)=>(0,s.b)(z.updatedAt).valueOf()-(0,s.b)(w.updatedAt).valueOf(),published:(w,z)=>(0,s.b)(z.publishedAt).valueOf()-(0,s.b)(w.publishedAt).valueOf(),downloads:(w,z)=>z.downloads-w.downloads};return V[F]?U.sort(V[F]):U};function v(U=[]){return U.reduce((F,V)=>(F[V.pluginId]=V,F),{})}function P(U){const{error:F,local:V,remote:w}=U;if(F)switch(F.errorCode){case n.ZK.invalidSignature:return n.Ac.invalid;case n.ZK.missingSignature:return n.Ac.missing;case n.ZK.modifiedSignature:return n.Ac.modified}return V?.signature?V.signature:w?.signatureType&&w?.versionSignatureType?n.Ac.valid:n.Ac.missing}const E=()=>(0,l.AI)().get("/api/frontend/settings").then(U=>{a.$.panels=U.panels});function D(U){if(!U)return;const[F]=U.filter(V=>!!V.isCompatible);return F}const C=()=>a.$.pluginAdminEnabled,b=(U,F,V)=>{const w=a.$.pluginAdminExternalManageEnabled,z=i.TP.hasPermission(d.AccessControlAction.PluginsInstall),N=!!V;return U.type===n.QE.renderer||U.type===n.QE.secretsmanager||U.isEnterprise&&!(0,r.a)("enterprise.plugins")||U.isDev||!z&&!w||!U.isPublished||!N||!F},T=U=>O(U.id),S=U=>O(U.slug);function O(U){const{pluginCatalogHiddenPlugins:F}=a.$;return!F.includes(U)}function M(U){const{pluginCatalogManagedPlugins:F}=a.$;return F?.includes(U)}function I(U){const{pluginCatalogPreinstalledPlugins:F}=a.$,V=F?.find(w=>w.id===U);return{found:!!V?.id,withVersion:!!V?.version}}function L(U){return U===n.QE.secretsmanager&&!a.$.secretsManagerPluginEnabled}function B(U){return U?.signature==="internal"}function j(U){return U.split(" - ")[0]}function A(U){return U.reduce((F,{id:V,name:w,type:z,orgName:N,info:H})=>{const Q=H.keywords?.join(" ").toLowerCase(),X=`${V} - ${w} - ${z} - ${N} - ${Q}`;return F.push(X),F},[])}function K(U,F){const V=A(U);let z=new t.A({intraMode:1,intraSub:0}).filter(V,F);return z===null?null:z.map(N=>j(V[N]))}function W(U){return!(!U.hasUpdate||U.isProvisioned||U.isCore||U.type===n.QE.renderer||U.isPreinstalled.withVersion||U.isUpdatingFromInstance||U.isManaged)}},20701:(G,R,e)=>{"use strict";e.d(R,{JC:()=>S,JJ:()=>x,LR:()=>y,NJ:()=>M,aU:()=>P,ai:()=>b,h9:()=>O,mj:()=>f,nT:()=>T,t5:()=>v,y7:()=>I});var t=e(65307),n=e(65474),s=e(62467),a=e(66847),r=e(45650),g=e(90593),i=e(75505),l=e(32264),d=e(17172),c=e(2913),h=e(15162),o=e(81900),m=e(84684),u=e(6745),p=e(5129);const f=(0,t.zD)(`${u.fu}/fetchAll`,async(L,B)=>{try{B.dispatch({type:`${u.fu}/fetchLocal/pending`}),B.dispatch({type:`${u.fu}/fetchRemote/pending`});const j=l.$.pluginAdminExternalManageEnabled&&c.Ay.featureToggles.managedPluginsInstall?(0,n.H)((0,m.Ap)()):(0,s.of)(void 0),A=l.$.pluginAdminExternalManageEnabled&&c.Ay.featureToggles.managedPluginsInstall?(0,n.H)((0,m.XP)()):(0,s.of)(void 0),K=500,W=(0,n.H)((0,m.Bj)()),U=(0,n.H)((0,m.Gd)()),F=(0,n.H)((0,m.T_)()).pipe((0,a.W)(V=>(B.dispatch({type:`${u.fu}/fetchRemote/rejected`}),console.error(V),(0,s.of)([]))));return(0,r.p)({local:U,remote:F,instance:j,provisioned:A,pluginErrors:W}).pipe((0,g.w)({each:K,with:()=>(F.subscribe(async V=>{if(B.dispatch({type:`${u.fu}/fetchRemote/fulfilled`}),V.length>0){const w=await(0,i.s)(U),z=await(0,i.s)(j),N=await(0,i.s)(A),H=await(0,i.s)(W);B.dispatch(P((0,p.td)({local:w,remote:V,instance:z,provisioned:N,pluginErrors:H})))}}),(0,r.p)({local:U,instance:j,provisioned:A,pluginErrors:W}))})).subscribe(({local:V,remote:w,instance:z,provisioned:N,pluginErrors:H})=>{V&&w?(B.dispatch({type:`${u.fu}/fetchLocal/fulfilled`}),B.dispatch({type:`${u.fu}/fetchRemote/fulfilled`}),B.dispatch(P((0,p.td)({local:V,remote:w,instance:z,provisioned:N,pluginErrors:H})))):V&&(B.dispatch({type:`${u.fu}/fetchLocal/fulfilled`}),B.dispatch(P((0,p.td)({local:V,pluginErrors:H}))))},V=>(console.log(V),B.dispatch({type:`${u.fu}/fetchLocal/rejected`}),B.dispatch({type:`${u.fu}/fetchRemote/rejected`}),B.rejectWithValue("Unknown error."))),null}catch{return B.rejectWithValue("Unknown error.")}}),y=(0,t.zD)(`${u.fu}/fetchAllLocal`,async(L,B)=>{try{return(await(0,m.Gd)()).map(A=>(0,p.kH)(A))}catch{return B.rejectWithValue("Unknown error.")}}),x=(0,t.zD)(`${u.fu}/fetchRemotePlugins`,async(L,B)=>{try{return await(0,m.T_)()}catch(j){return(0,d.NF)(j)&&(j.isHandled=!0),B.rejectWithValue([])}}),v=(0,t.zD)(`${u.fu}/fetchDetails`,async(L,B)=>{try{const j=await(0,m.CB)(L);return{id:L,changes:{details:j}}}catch{return B.rejectWithValue("Unknown error.")}}),P=(0,t.VP)(`${u.fu}/addPlugins`),E=(0,t.VP)(`${u.fu}/addLocalPlugins`),D=(0,t.VP)(`${u.fu}/addLocalPlugins`),C=(0,t.VP)(`${u.fu}/addLocalPlugins`),b=(0,t.zD)(`${u.fu}/install`,async({id:L,version:B,isUpdating:j=!1},A)=>{const K=j?{isInstalled:!0,installedVersion:B,hasUpdate:!1}:{isInstalled:!0,installedVersion:B};try{return await(0,m.xZ)(L),await(0,p.tr)(),j&&(0,o.sk)(L),{id:L,changes:K}}catch(W){return console.error(W),(0,d.NF)(W)?(W.data.id=L,A.rejectWithValue(W.data)):A.rejectWithValue("Unknown error.")}}),T=(0,t.zD)(`${u.fu}/install`,async()=>({})),S=(0,t.zD)(`${u.fu}/uninstall`,async(L,B)=>{try{return await(0,m.cu)(L),await(0,p.tr)(),(0,o.sk)(L),{id:L,changes:{isInstalled:!1,installedVersion:void 0,isFullyInstalled:!1}}}catch(j){return console.error(j),B.rejectWithValue("Unknown error.")}}),O=(0,t.zD)(`${u.fu}/loadPluginDashboards`,async(L,B)=>{const K=`api/plugins/${B.getState().dataSources.dataSource.type}/dashboards`;return(0,d.AI)().get(K)}),M=(0,t.VP)(`${u.fu}/panelPluginLoaded`),I=L=>async(B,j)=>{let A=j().plugins.panels[L];return A||(A=await(0,h.TV)(L),j().plugins.panels[L]||B(M(A))),A}},31326:(G,R,e)=>{"use strict";e.d(R,{AI:()=>r,Ff:()=>o});var t=e(65307),n=e(6745),s=e(66253),a=e(20701);const r=(0,t.pU)(),g=m=>new RegExp(`${n.fu}/(.*)/pending`).test(m.type),i=m=>new RegExp(`${n.fu}/(.*)/fulfilled`).test(m.type),l=m=>new RegExp(`${n.fu}/(.*)/rejected`).test(m.type),d=m=>{const u=m.lastIndexOf("/");return m.substring(0,u)},c={items:r.getInitialState(),requests:{},plugins:[],errors:[],searchQuery:"",hasFetched:!1,dashboards:[],isLoadingPluginDashboards:!1,panels:{}},o=(0,t.Z0)({name:"plugins",initialState:c,reducers:{},extraReducers:m=>m.addCase(a.aU,(u,p)=>{r.upsertMany(u.items,p.payload)}).addCase(a.LR.fulfilled,(u,p)=>{r.upsertMany(u.items,p.payload)}).addCase(a.t5.fulfilled,(u,p)=>{r.updateOne(u.items,p.payload)}).addCase(a.ai.fulfilled,(u,p)=>{r.updateOne(u.items,p.payload)}).addCase(a.JC.fulfilled,(u,p)=>{r.updateOne(u.items,p.payload)}).addCase(a.NJ,(u,p)=>{u.panels[p.payload.meta.id]=p.payload}).addCase(a.h9.pending,(u,p)=>{u.isLoadingPluginDashboards=!0,u.dashboards=[]}).addCase(a.h9.fulfilled,(u,p)=>{u.isLoadingPluginDashboards=!1,u.dashboards=p.payload}).addMatcher(g,(u,p)=>{u.requests[d(p.type)]={status:s.IZ.Pending}}).addMatcher(i,(u,p)=>{u.requests[d(p.type)]={status:s.IZ.Fulfilled}}).addMatcher(l,(u,p)=>{u.requests[d(p.type)]={status:s.IZ.Rejected,error:p.payload}})}).reducer},66253:(G,R,e)=>{"use strict";e.d(R,{IZ:()=>i,Ip:()=>n,LZ:()=>g,Uy:()=>s,og:()=>r,u8:()=>a,vk:()=>t});var t=(l=>(l.Home="plugins-home",l.Browse="plugins-browse",l.Details="plugins-details",l))(t||{}),n=(l=>(l.app="apps",l.datasource="database",l.panel="credit-card",l.renderer="capture",l.secretsmanager="key-skeleton-alt",l))(n||{}),s=(l=>(l.Deleted="deleted",l.Active="active",l.Pending="pending",l.Deprecated="deprecated",l.Enterprise="enterprise",l))(s||{}),a=(l=>(l.INSTALL="INSTALL",l.UNINSTALL="UNINSTALL",l.UPDATE="UPDATE",l.REINSTALL="REINSTALL",l))(a||{}),r=(l=>(l.OVERVIEW="Overview",l.VERSIONS="Version history",l.CONFIG="Config",l.DASHBOARDS="Dashboards",l.USAGE="Usage",l.IAM="IAM",l.CHANGELOG="Changelog",l))(r||{}),g=(l=>(l.OVERVIEW="overview",l.VERSIONS="version-history",l.CONFIG="config",l.DASHBOARDS="dashboards",l.USAGE="usage",l.IAM="iam",l.CHANGELOG="changelog",l))(g||{}),i=(l=>(l.Pending="Pending",l.Fulfilled="Fulfilled",l.Rejected="Rejected",l))(i||{})},66827:(G,R,e)=>{"use strict";e.d(R,{j:()=>d});var t=e(74848),n=e(14110),s=e(42418),a=e(55852),r=e(61680);const g="grafana.angularDeprecation.dashboardNoticeAndMigration.isDismissed";function i(c){return g+"."+c}function l(){const c="__feature.autoMigrateOldPanels",h=new URL(window.location.toString());h.searchParams.has(c)||h.searchParams.append(c,"true"),window.open(h.toString(),"_self")}function d({dashboardUid:c,showAutoMigrateLink:h}){return(0,t.jsx)(r.b,{storageKey:i(c),defaultValue:!1,children:(o,m)=>o?null:(0,t.jsx)("div",{children:(0,t.jsx)(s.F,{severity:"warning",title:"This dashboard depends on Angular, which is deprecated and will stop working in future releases of Grafana.",onRemove:()=>{(0,n.rR)("angular_deprecation_notice_dismissed"),m(!0)},children:(0,t.jsxs)("div",{className:"markdown-html",children:[(0,t.jsx)("a",{href:"https://grafana.com/docs/grafana/latest/developers/angular_deprecation/",className:"external-link",target:"_blank",rel:"noreferrer",children:"Read our deprecation notice and migration advice."}),(0,t.jsx)("br",{}),h&&(0,t.jsx)(a.$n,{fill:"outline",size:"sm",onClick:l,style:{marginTop:10},children:"Try migration"})]})})})})}},74106:(G,R,e)=>{"use strict";e.d(R,{c:()=>i});var t=e(74848),n=e(96540),s=e(43429),a=e(14110),r=e(42418);function g(l,d){let c;switch(l){case s.QE.app:c="app plugin";break;case s.QE.panel:c="panel plugin";break;case s.QE.datasource:c="data source plugin";break;default:c="plugin"}let h=`This ${c} uses a deprecated, legacy platform based on AngularJS and `;return d===void 0?h+" may be incompatible depending on your Grafana configuration.":d?h+" will stop working in future releases of Grafana.":h+" is incompatible with your current Grafana configuration."}function i(l){const{className:d,angularSupportEnabled:c,pluginId:h,pluginType:o,showPluginDetailsLink:m,interactionElementId:u,children:p}=l,[f,y]=(0,n.useState)(!1),x={};return h&&(x.pluginId=h),u&&(x.elementId=u),f?null:(0,t.jsxs)(r.F,{severity:"warning",title:"Angular plugin",className:d,onRemove:()=>y(!0),children:[(0,t.jsx)("p",{children:g(o,c)}),(0,t.jsx)("div",{className:"markdown-html",children:(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:(0,t.jsx)("a",{href:"https://grafana.com/docs/grafana/latest/developers/angular_deprecation/",className:"external-link",target:"_blank",rel:"noreferrer",onClick:()=>{(0,a.rR)("angular_deprecation_docs_clicked",x)},children:"Read our deprecation notice and migration advice."})}),m&&h?(0,t.jsx)("li",{children:(0,t.jsx)("a",{href:`plugins/${encodeURIComponent(h)}`,className:"external-link",target:"_blank",rel:"noreferrer",children:"View plugin details"})}):null]})}),p&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("hr",{}),p]})]})}},8480:(G,R,e)=>{"use strict";e.d(R,{Hv:()=>a,mz:()=>r});var t=e(32264);function n(g){return Object.values(t.$.datasources).find(i=>i.uid===g)??null}function s(g){return n(g)?.meta.angular?.detected??!1}function a(g){const i=n(g);return(i?.meta.angular?.detected&&!i?.meta.angular.hideDeprecation)??!1}const r=new Set(["autoMigrateOldPanels","autoMigrateGraphPanel","autoMigrateTablePanel","autoMigratePiechartPanel","autoMigrateWorldmapPanel","autoMigrateStatPanel","disableAngular"])},96615:(G,R,e)=>{"use strict";e.d(R,{Ay:()=>j});var t=e(74848),n=e(65307),s=e(96540),a=e(24180),r=e(54148),g=e(13834),i=e(62625),l=e(26272),d=e(43429),c=e(32264),h=e(39601),o=e(42418),m=e(21780),u=e(39419),p=e(7392),f=e(76888),y=e(10096);function x(A){return console.error(A),P("Exception thrown","See console for details")}function v(){return P("Page not found","404 Error")}function P(A,K){const W={text:A,subTitle:K,icon:"exclamation-triangle"};return{node:W,main:W}}var E=e(94954),D=e(49658),C=e(27716),b=e(1682),T=e(60677),S=e(72798);const O={loading:!0,loadingError:!1,pluginNav:null,plugin:null};function M({pluginId:A,pluginNavSection:K}){const{pluginId:W=""}=(0,r.g)();A=A||W;const U=(0,D.OG)(),F=(0,D.TX)(),V=(0,D.ZV)(),w=(0,a.zy)(),[z,N]=(0,s.useReducer)(I.reducer,O),H=c.$.appSubUrl+w.pathname+w.search,{plugin:Q,loading:X,loadingError:ee,pluginNav:Z}=z,q=(0,T.Wy)(H,K),ae=(0,s.useMemo)(()=>(0,h.SE)(w.search),[w.search]),k=(0,s.useMemo)(()=>(0,S.S)(q),[q]),se=(0,f.Il)();(0,s.useEffect)(()=>{L(A,N)},[A]);const te=(0,s.useCallback)(de=>N(I.actions.changeNav(de)),[]);if(!Q||A!==Q.meta.id){const de=se.chrome.state.getValue().layout;return(0,t.jsxs)(m.YW,{navModel:q,pageNav:{text:""},layout:de,children:[X&&(0,t.jsx)(u.A,{}),!X&&ee&&(0,t.jsx)(p.L,{entity:"App"})]})}if(!Q.root)return(0,t.jsx)(m.YW,{navModel:q??P("Plugin load error"),children:(0,t.jsx)("div",{children:"No root app page component found"})});const ne=Q.root&&(0,t.jsx)(g.a,{meta:Q.meta,children:(0,t.jsx)(D.AZ,{registries:{addedLinksRegistry:U.readOnly(),addedComponentsRegistry:F.readOnly(),exposedComponentsRegistry:V.readOnly()},children:(0,t.jsx)(Q.root,{meta:Q.meta,basename:w.pathname,onNavChanged:te,query:ae,path:w.pathname})})}),le=()=>{if(!Q.meta?.includes)return!0;const de=Q.meta?.includes.find(J=>J.path===w.pathname);if(!de)return!0;if(de?.action&&c.$.featureToggles.accessControlOnCall)return y.TP.hasPermission(de.action);if(y.TP.isGrafanaAdmin||y.TP.user.orgRole===i.X.Admin)return!0;const oe=de?.role||"";return!oe||y.TP.isEditor&&oe===i.X.Viewer?!0:y.TP.hasRole(oe)},re=()=>(0,t.jsx)(o.F,{severity:"warning",title:"Access denied",children:"You do not have permission to see this page."});return le()?Z?(0,t.jsx)(t.Fragment,{children:q?(0,t.jsx)(m.YW,{navModel:q,pageNav:Z?.node,children:(0,t.jsx)(m.YW.Contents,{isLoading:X,children:ne})}):(0,t.jsx)(m.YW,{children:ne})}):(0,t.jsx)(S.A.Provider,{value:k,children:ne}):(0,t.jsx)(re,{})}const I=(0,n.Z0)({name:"prom-builder-container",initialState:O,reducers:{setState:(A,K)=>{Object.assign(A,K.payload)},changeNav:(A,K)=>{let W=K.payload;W&&W.node.children&&(W={...W,node:{...W.main,hideFromBreadcrumbs:!0}}),A.pluginNav=W}}});async function L(A,K){try{const W=await(0,C.x)(A).then(U=>{const F=B(U);return F?(y.lE.emit(l.r1.alertError,[F]),K(I.actions.setState({pluginNav:P(F)})),null):(0,b.ui)(U)});K(I.actions.setState({plugin:W,loading:!1,loadingError:!1,pluginNav:null}))}catch(W){K(I.actions.setState({plugin:null,loading:!1,loadingError:!0,pluginNav:v()}));const U=W instanceof Error?W:new Error((0,E.q)(W));T.z4.logError(U),console.error(U)}}function B(A){return A?A.type!==d.QE.app?"Plugin must be an app":A.enabled?null:"Application Not Enabled":"Unknown Plugin"}const j=M},72798:(G,R,e)=>{"use strict";e.d(R,{A:()=>n,S:()=>a});var t=e(96540);const n=(0,t.createContext)(s());n.displayName="PluginPageContext";function s(){return{sectionNav:{main:{text:"Plugin page"},node:{text:"Plugin page"}}}}function a(r){return{sectionNav:r??s().sectionNav}}},10803:(G,R,e)=>{"use strict";e.d(R,{p:()=>a});var t=e(74848),n=e(43429),s=e(39938);const a=g=>{const i=r(g.state);return i?(0,t.jsx)(s.E,{className:g.className,color:i.color,title:i.tooltip,text:i.text,icon:i.icon}):null};function r(g){switch(g){case n.pn.deprecated:return{text:"Deprecated",color:"red",tooltip:"This feature is deprecated and will be removed in a future release"};case n.pn.alpha:return{text:"Alpha",color:"blue",tooltip:"This feature is experimental and future updates might not be backward compatible"};case n.pn.beta:return{text:"Beta",color:"blue",tooltip:"This feature is close to complete but not fully tested"};default:return null}}},31193:(G,R,e)=>{"use strict";e.d(R,{tR:()=>y,xq:()=>u});var t=e(40187),n=e(26272),s=e(80147),a=e(72574),r=e(81634),g=e(17172),i=e(19347),l=e(26657),d=e(28138),c=e(2913),h=e(53478),o=e(66718),m=e(1682);class u{constructor(v=(0,a.w)()){this.templateSrv=v,this.datasources={},this.settingsMapByName={},this.settingsMapByUid={},this.settingsMapById={},this.defaultName=""}init(v,P){this.datasources={},this.settingsMapByUid={},this.settingsMapByName=v,this.defaultName=P;for(const E of Object.values(v))E.uid||(E.uid=E.name),this.settingsMapByUid[E.uid]=E,this.settingsMapById[E.id]=E;this.datasources[l.dR.type]=h.Ex,this.datasources[o.Uj]=h.Ex,this.settingsMapByUid[l.dR.uid]=h.$i,this.settingsMapByUid[o.Uj]=h.$i}getDataSourceSettingsByUid(v){return this.settingsMapByUid[v]}getInstanceSettings(v,P){let E=p(v);if((0,l.s9)(E))return h.$i;if(E==="default"||E==null)return this.settingsMapByUid[this.defaultName]??this.settingsMapByName[this.defaultName];if(E[0]==="$"){const D=this.templateSrv.replace(E,P,f);let C;return D==="default"?C=this.settingsMapByName[this.defaultName]:C=this.settingsMapByUid[D]??this.settingsMapByName[D],C?{...C,isDefault:!1,name:E,uid:E,rawRef:{type:C.type,uid:C.uid}}:void 0}return this.settingsMapByUid[E]??this.settingsMapByName[E]??this.settingsMapById[E]}get(v,P){let E=p(v);if(!E)return this.get(this.defaultName);if((0,l.s9)(v))return Promise.resolve(this.datasources[o.Uj]);const D=this.settingsMapByName[E];return D&&(E=D.uid),this.datasources[E]?Promise.resolve(this.datasources[E]):(E=this.templateSrv.replace(E,P,f),E==="default"&&this.defaultName!=="default"?this.get(this.defaultName):this.datasources[E]?Promise.resolve(this.datasources[E]):this.loadDatasource(E))}async loadDatasource(v){if(this.datasources[v])return Promise.resolve(this.datasources[v]);const P=this.getInstanceSettings(v);if(!P)return Promise.reject({message:`Datasource ${v} was not found`});try{const E=await(0,m.cS)(P.meta);if(this.datasources[v])return this.datasources[v];const D=E.DataSourceClass.length!==1;let C;if(D?C=(0,r.C)().instantiate(E.DataSourceClass,{instanceSettings:P}):C=new E.DataSourceClass(P),C.components=E.components,!(C instanceof t.mA)){const b=C;b.name=P.name,b.id=P.id,b.type=P.type,b.meta=P.meta,b.uid=P.uid,b.getRef=t.mA.prototype.getRef}return this.datasources[v]=C,this.datasources[C.uid]=C,C}catch(E){return E instanceof Error&&d.A.emit(n.r1.alertError,[P.name+" plugin failed",E.toString()]),Promise.reject({message:`Datasource: ${v} was not found`})}}getAll(){return Object.values(this.settingsMapByName)}getList(v={}){const P=Object.values(this.settingsMapByName).filter(D=>!(D.meta.id==="grafana"||D.meta.id==="mixed"||D.meta.id==="dashboard"||v.metrics&&!D.meta.metrics||v.tracing&&!D.meta.tracing||v.logs&&D.meta.category!=="logging"&&!D.meta.logs||v.annotations&&!D.meta.annotations||v.alerting&&!D.meta.alerting||v.pluginId&&!(0,s._)(v.pluginId,D.meta)||v.filter&&!v.filter(D)||v.type&&(Array.isArray(v.type)?!v.type.includes(D.type):v.type!==D.type)||!v.all&&D.meta.metrics!==!0&&D.meta.annotations!==!0&&D.meta.tracing!==!0&&D.meta.logs!==!0&&D.meta.alerting!==!0));if(v.variables)for(const D of this.templateSrv.getVariables()){if(D.type!=="datasource")continue;let C=D.current.value==="default"?this.defaultName:D.current.value;Array.isArray(C)&&(C=C[0]);const b=!Array.isArray(C)&&(this.settingsMapByName[C]||this.settingsMapByUid[C]);if(b){const T=`\${${D.name}}`;P.push({...b,isDefault:!1,name:T,uid:T})}}const E=P.sort((D,C)=>D.name.toLowerCase()>C.name.toLowerCase()?1:D.name.toLowerCase()<C.name.toLowerCase()?-1:0);if(!v.pluginId&&!v.alerting){if(v.mixed){const D=this.getInstanceSettings("-- Mixed --");D&&P.push(D)}if(v.dashboard){const D=this.getInstanceSettings("-- Dashboard --");D&&P.push(D)}if(!v.tracing){const D=this.getInstanceSettings("-- Grafana --");D&&v.filter?.(D)!==!1&&P.push(D)}}return E}getExternal(){return this.getList()}getAnnotationSources(){return this.getList({annotations:!0,variables:!0}).map(v=>({name:v.name,value:v.name,meta:v.meta}))}getMetricSources(v){return this.getList({metrics:!0,variables:!v?.skipVariables}).map(P=>({name:P.name,value:P.name,meta:P.meta}))}async reload(){const v=await(0,g.AI)().get("/api/frontend/settings");c.Ay.datasources=v.datasources,c.Ay.defaultDatasource=v.defaultDatasource,this.init(v.datasources,v.defaultDatasource)}}function p(x){return(0,l.s9)(x)?l.dR.uid:typeof x=="string"?x:x?.uid}function f(x){return Array.isArray(x)?x[0]:x}const y=()=>(0,i.l)()},49658:(G,R,e)=>{"use strict";e.d(R,{AZ:()=>d,OG:()=>g,TX:()=>i,ZV:()=>l});var t=e(74848),n=e(96540);const s=(0,n.createContext)(void 0),a=(0,n.createContext)(void 0),r=(0,n.createContext)(void 0);function g(){const c=(0,n.useContext)(s);if(!c)throw new Error("No `AddedLinksRegistryContext` found.");return c}function i(){const c=(0,n.useContext)(a);if(!c)throw new Error("No `AddedComponentsRegistryContext` found.");return c}function l(){const c=(0,n.useContext)(r);if(!c)throw new Error("No `ExposedComponentsRegistryContext` found.");return c}const d=({registries:c,children:h})=>(0,t.jsx)(s.Provider,{value:c.addedLinksRegistry,children:(0,t.jsx)(a.Provider,{value:c.addedComponentsRegistry,children:(0,t.jsx)(r.Provider,{value:c.exposedComponentsRegistry,children:h})})})},75462:(G,R,e)=>{"use strict";e.d(R,{$Y:()=>S,FF:()=>y,N9:()=>j,OO:()=>H,PW:()=>z,V2:()=>w,YS:()=>W,dt:()=>Q,dx:()=>K,hS:()=>A,nl:()=>X,nv:()=>E,ol:()=>C,pL:()=>B,xJ:()=>I,xM:()=>N,yt:()=>b});var t=e(74848),n=e(32196),s=e(2543),a=e.n(s),r=e(16817),g=e(13834),i=e(47232),l=e(76885),d=e(14110),c=e(32264),h=e(37390),o=e(28138),m=e(11848),u=e(27716),p=e(28444),f=e(87092);function y(ee){console.warn(`[Plugin Extensions] ${ee}`)}function x(ee){return typeof ee=="object"&&"type"in ee&&ee.type===PluginExtensionTypes.link}function v(ee,Z=""){return(...q)=>{try{return ee(...q)}catch(ae){ae instanceof Error&&console.warn(`${Z}${ae.message}`)}}}function P(ee){return async Z=>{const{title:q,body:ae,width:k,height:se}=Z;o.A.publish(new p.S8({component:E(ee,D({title:q,body:ae,width:k,height:se}))}))}}const E=(ee,Z)=>ae=>{const{error:k,loading:se,value:te}=(0,r.A)(()=>(0,u.x)(ee,{showErrorAlert:!1}));return se?null:k?(y(`Could not fetch plugin meta information for "${ee}", aborting. (${k.message})`),null):te?(0,t.jsx)(g.a,{meta:te,children:(0,t.jsx)(Z,{...ae})}):(y(`Fetched plugin meta information is empty for "${ee}", aborting.`),null)},D=({title:ee,body:Z,width:q,height:ae})=>{const k=(0,n.css)({width:q,height:ae});return({onDismiss:te})=>(0,t.jsx)(h.a,{title:ee,className:k,isOpen:!0,onDismiss:te,onClickBackdrop:te,children:(0,t.jsx)(Z,{onDismiss:te})})};function C(ee,Z=new Map){if(!ee||typeof ee!="object"||Object.isFrozen(ee))return ee;const q=Array.isArray(ee)?[...ee]:{...ee};if(Z.has(ee))return Z.get(ee);Z.set(ee,q);const ae=Reflect.ownKeys(q);for(const k of ae){const se=Array.isArray(q)?q[Number(k)]:q[k];se&&(typeof se=="object"||typeof se=="function")&&(Array.isArray(q)?q[Number(k)]=C(se,Z):q[k]=C(se,Z))}return Object.freeze(q)}function b(ee,Z,q){const ae=`${ee}${Z}${q}`;return Array.from(ae).reduce((k,se)=>Math.imul(31,k)+se.charCodeAt(0)|0,0).toString()}const T=Symbol("isReadOnlyProxy");function S(ee){if(!ee||typeof ee!="object"||M(ee))return ee;const Z=new WeakMap;return new Proxy(ee,{defineProperty:()=>!1,deleteProperty:()=>!1,isExtensible:()=>!1,set:()=>!1,get(q,ae,k){if(ae===T)return!0;const se=Reflect.get(q,ae,k);return(0,i.Ar)(se)?(0,i.KQ)(se):(0,s.isObject)(se)||(0,s.isArray)(se)?(Z.has(se)||Z.set(se,S(se)),Z.get(se)):se}})}function O(ee){return typeof ee=="object"&&ee!==null}function M(ee){return O(ee)&&ee[T]===!0}function I(ee){const Z={...ee};return Z}function L(ee){}function B(ee,Z){return ee.length<Z?ee:`${ee.slice(0,Z-3).trimEnd()}...`}function j(ee){const Z={},q=[];for(const k of ee){const se=k.category;if(!se){q.push({text:B(k.title,25),href:k.path,onClick:k.onClick});continue}Array.isArray(Z[se])||(Z[se]=[]),Z[se].push({text:B(k.title,25),href:k.path,onClick:k.onClick})}const ae=Object.keys(Z).reduce((k,se)=>(k.push({text:B(se,25),type:"group",subMenu:Z[se]}),k),[]);return q.length>0&&(ae.length>0&&ae.push({text:"divider",type:"divider"}),Array.prototype.push.apply(ae,q)),ae}function A(ee,Z,q){try{const ae=Z.configure?.(q,{isAppOpened:()=>V(ee)});if(ae===void 0)return;let{title:k=Z.title,description:se=Z.description,path:te=Z.path,icon:ne=Z.icon,category:le=Z.category,...re}=ae;return(0,f.lq)(ae,`The configure() function for "${Z.title}" returned a promise, skipping updates.`),te&&(0,f.wy)(ee,te),(0,f.aY)({title:k,description:se},["title","description"]),Object.keys(re).length>0&&y(`Extension "${Z.title}", is trying to override restricted properties: ${Object.keys(re).join(", ")} which will be ignored.`),{title:k,description:se,path:te,icon:ne,category:le}}catch(ae){ae instanceof Error&&y(ae.message);return}}function K(ee,Z,q,ae){const{onClick:k}=q;if(k)return function(te){try{(0,d.rR)("ui_extension_link_clicked",{pluginId:ee,extensionPointId:Z,title:q.title,category:q.category});const ne={context:ae,openModal:P(ee),isAppOpened:()=>V(ee),openAppInSideview:()=>U(ee),closeAppInSideview:()=>F(ee)},le=k(te,ne);(0,f.yL)(le)&&le.catch(re=>{re instanceof Error&&y(re.message)})}catch(ne){ne instanceof Error&&y(ne.message)}}}function W(ee,Z,q){return l.kM.appendQueryToUrl(Z,l.kM.toUrlParams({uel_pid:ee,uel_epid:q}))}const U=ee=>m.L.openApp(ee),F=ee=>m.L.closeApp(ee),V=ee=>m.L.isAppOpened(ee),w=()=>c.$.buildInfo.env==="development",z=(ee,Z)=>{const q=Z.meta?.id,ae=Z.meta?.extensions?.extensionPoints;return!ae||!ae.some(k=>k.id===ee)?(y(`Extension point "${ee}" - it's not recorded in the "plugin.json" for "${q}". Please add it under "extensions.extensionPoints[]".`),!0):!1},N=(ee,Z)=>{const q=Z.meta?.id,ae=Z.meta?.dependencies?.extensions?.exposedComponents;return!ae||!ae.includes(ee)?(y(`Using exposed component "${ee}" - it's not recorded in the "plugin.json" for "${q}". Please add it under "dependencies.extensions.exposedComponents[]".`),!0):!1},H=(ee,Z)=>{const q=c.$.apps[ee],ae=`Added-link "${Z.title}" from "${ee}" -`,k=q?q.extensions.addedLinks.find(({title:te})=>te===Z.title):null;return q?k?(Array.isArray(Z.targets)?Z.targets:[Z.targets]).every(te=>k.targets.includes(te))?k.description!==Z.description?(y(`${ae} the "description" doesn't match with one in the plugin.json under "extensions.addedLinks[]".`),!0):!1:(y(`${ae} the "targets" don't match with ones in the plugin.json under "extensions.addedLinks[]".`),!0):(y(`${ae} not registered in the plugin.json under "extensions.addedLinks[]".`),!0):(y(`${ae} couldn't find app plugin "${ee}"`),!0)},Q=(ee,Z)=>{const q=c.$.apps[ee],ae=`Added component "${Z.title}" -`,k=q?q.extensions.addedComponents.find(({title:te})=>te===Z.title):null;return q?k?(Array.isArray(Z.targets)?Z.targets:[Z.targets]).every(te=>k.targets.includes(te))?k.description!==Z.description?(y(`${ae} the "description" doesn't match with one in the plugin.json under "extensions.addedComponents[]".`),!0):!1:(y(`${ae} the "targets" don't match with ones in the plugin.json under "extensions.addedComponents[]".`),!0):(y(`${ae} not registered in the plugin.json under "extensions.addedComponents[]".`),!0):(y(`${ae} couldn't find app plugin "${ee}"`),!0)},X=(ee,Z)=>{const q=c.$.apps[ee],ae=`Exposed component "${Z.id}" -`,k=q?q.extensions.exposedComponents.find(({id:se})=>se===Z.id):null;return q?k?k.title!==Z.title?(y(`${ae} the "title" doesn't match with one in the plugin.json under "extensions.exposedComponents[]".`),!0):k.description!==Z.description?(y(`${ae} the "description" doesn't match with one in the plugin.json under "extensions.exposedComponents[]".`),!0):!1:(y(`${ae} not registered in the plugin.json under "extensions.exposedComponents[]".`),!0):(y(`${ae} couldn't find app plugin: "${ee}"`),!0)}},87092:(G,R,e)=>{"use strict";e.d(R,{Fe:()=>d,Fk:()=>h,aY:()=>g,jk:()=>o,kl:()=>l,lq:()=>i,lr:()=>p,w_:()=>c,wy:()=>s,yL:()=>u});var t=e(74135);function n(f,y="extension is not a link extension"){if(!isPluginExtensionLink(f))throw new Error(y)}function s(f,y){if(!l(f,y))throw new Error(`Invalid link extension. The "path" is required and should start with "/a/${f}/" (currently: "${y}"). Skipping the extension.`)}function a(f){if(!p(f))throw new Error('Invalid component extension, the "component" property needs to be a valid React component.')}function r(f){if(!o(f.configure))throw new Error(`Invalid extension "${f.title}". The "configure" property must be a function. Skipping the extension.`)}function g(f,y){for(const x of y)if(!m(f[x]))throw new Error(`Invalid extension "${f.title}". Property "${x}" must be a string and cannot be empty. Skipping the extension.`)}function i(f,y="The provided value is a Promise."){if(u(f))throw new Error(y)}function l(f,y){return!!(typeof y=="string"&&y.length>0&&y.startsWith(`/a/${f}/`))}function d({extensionPointId:f,pluginId:y}){return f.startsWith("grafana/")?!0:!!(f.startsWith(`plugins/${y}/`)||f.startsWith(`${y}/`))}function c(f){return f.match(/.*\/v\d+$/)}function h(f){return Object.values(t.S).map(y=>y.toString()).includes(f)}function o(f){return f?typeof f=="function":!0}function m(f){return typeof f=="string"&&f.length>0}function u(f){return f instanceof Promise||typeof f=="object"&&f!==null&&"then"in f&&"catch"in f}function p(f){const y=v=>typeof v=="object"&&v!==null&&"$$typeof"in v;return typeof f=="function"||(v=>y(v)&&v.$$typeof===Symbol.for("react.memo"))(f)}},15162:(G,R,e)=>{"use strict";e.d(R,{Kk:()=>h,PY:()=>o,TV:()=>l,d4:()=>c,f7:()=>p,oZ:()=>d});var t=e(43429),n=e(65158),s=e(2913),a=e(41394),r=e(1682);const g={},i={};function l(f){const y=g[f];if(y)return y;const x=c(f);if(!x)throw new Error(`Plugin ${f} not found`);return g[f]=m(x),f!==x.type&&(g[x.type]=g[f]),g[f]}function d(f){return!!c(f)}function c(f){const y=s.Ay.panels[f];if(!y){for(const x of Object.values(s.Ay.panels))if(x.aliasIDs?.includes(f))return x}return y}function h(f){return m(f)}function o(f){return i[f]}function m(f){const y=f.loadingStrategy??t.xf.fetch;return(0,r.j4)({path:f.module,version:f.info?.version,isAngular:f.angular?.detected,loadingStrategy:y,pluginId:f.id,moduleHash:f.moduleHash}).then(x=>{if(x.plugin)return x.plugin;if(x.PanelCtrl){const v=new n.m(null);return v.angularPanelCtrl=x.PanelCtrl,v}throw new Error("missing export: plugin or PanelCtrl")}).then(x=>(x.meta=f,i[f.id]=x,!x.panel&&x.angularPanelCtrl&&(x.panel=u(x)),x)).catch(x=>(console.warn("Error loading panel plugin: "+f.id,x),(0,a.W)(f,x)))}let u=f=>null;function p(f){u=f}},81900:(G,R,e)=>{"use strict";e.d(R,{GD:()=>a,QO:()=>i,ni:()=>g,sk:()=>r});var t=e(27716),n=e(45179);const s={};function a({path:c,version:h,loadingStrategy:o}){const m=l(c);m&&!s[m]&&(s[m]={version:encodeURI(h),loadingStrategy:o})}function r(c){const h=c;s[h]&&delete s[h],(0,t.o)(c)}function g(c,h=n.x8){const o=d(c);if(!o)return`${c}?_cache=${h}`;const u=s[o]?.version||h;return`${c}?_cache=${u}`}function i(c){const h=d(c);if(h)return s[h]}function l(c){const h=/\/?public\/plugins\/([^\/]+)\//,o=c.match(h);return o?o[1]:null}function d(c){const h=Object.keys(s).find(o=>c.includes(o));if(h)return h}},45179:(G,R,e)=>{"use strict";e.d(R,{$b:()=>n,Bu:()=>s,XV:()=>t,x8:()=>a});const t="package",n=/^plugins.+\.css$/i,s=/^(text|application)\/(x-)?javascript(;|$)/,a=Date.now()},63770:(G,R,e)=>{"use strict";e.d(R,{z:()=>d});var t=e(59511),n=e.n(t),s=e(65024),a=e.n(s),r=e(82093),g=e.n(r),i=e(57516),l=e.n(i);const d=window.System},87815:(G,R,e)=>{"use strict";e.d(R,{Av:()=>l,OD:()=>i,kB:()=>r});var t=e(32264),n=e(66161),s=e(45179),a=e(63770);function r(d){return Object.keys(d).reduce((c,h)=>{const o=`${s.XV}:${h}`;return g(o,d[h]),n.s.set(h,d[h]),c[h]=o,c},{})}function g(d,c){if(a.z.has(d))return;let h;try{h=a.z.resolve(d)}catch(m){console.log(m)}if(h&&a.z.has(h))return;const o=h||d;typeof c=="function"?a.z.register(d,[],m=>({execute:async function(){const u=await c();m(u)}})):a.z.set(o,c)}function i(d){return!!t.$.pluginsCDNBaseURL&&d.startsWith(t.$.pluginsCDNBaseURL)}function l(d){return d.startsWith("http")||d.startsWith("/")?d:`${t.$.appSubUrl??""}/${d}`}},27716:(G,R,e)=>{"use strict";e.d(R,{o:()=>a,x:()=>s});var t=e(17172);const n={};function s(r,g){const i=n[r];return i?Promise.resolve(i):(0,t.AI)().get(`/api/plugins/${r}/settings`,void 0,void 0,g).then(l=>(n[r]=l,l)).catch(l=>typeof l=="object"&&l!==null&&"status"in l&&l.status===403?(l.isHandled=!0,Promise.reject(l)):Promise.reject(new Error("Unknown Plugin")))}const a=r=>r?delete n[r]:Object.keys(n).forEach(g=>delete n[g])},1682:(G,R,e)=>{"use strict";e.d(R,{ui:()=>_a,cS:()=>Xa,j4:()=>$a});var t=e(43429),n=e(40187),s=e(41987),a=e(32264);const k={"core:plugin/graphite":async()=>await e.e(6134).then(e.bind(e,8652)),"core:plugin/cloudwatch":async()=>await Promise.all([e.e(3346),e.e(2651),e.e(3766)]).then(e.bind(e,92651)),"core:plugin/dashboard":async()=>await e.e(2058).then(e.bind(e,92058)),"core:plugin/elasticsearch":async()=>await Promise.all([e.e(3346),e.e(6144),e.e(8747),e.e(1717)]).then(e.bind(e,18747)),"core:plugin/opentsdb":async()=>await e.e(747).then(e.bind(e,24989)),"core:plugin/grafana":async()=>await e.e(3648).then(e.bind(e,62391)),"core:plugin/influxdb":async()=>await Promise.all([e.e(7445),e.e(9404)]).then(e.bind(e,20322)),"core:plugin/loki":async()=>await Promise.all([e.e(6144),e.e(7049),e.e(1477)]).then(e.bind(e,27049)),"core:plugin/mixed":async()=>await e.e(2513).then(e.bind(e,12870)),"core:plugin/prometheus":async()=>await Promise.all([e.e(3346),e.e(6144),e.e(8314),e.e(9546)]).then(e.bind(e,88314)),"core:plugin/alertmanager":async()=>await Promise.all([e.e(3346),e.e(4737)]).then(e.bind(e,27013)),"core:plugin/text":async()=>await e.e(404).then(e.bind(e,31984)),"core:plugin/timeseries":async()=>await Promise.all([e.e(4007),e.e(3397),e.e(94),e.e(6965),e.e(563)]).then(e.bind(e,32307)),"core:plugin/trend":async()=>await Promise.all([e.e(94),e.e(2666)]).then(e.bind(e,32475)),"core:plugin/state-timeline":async()=>await Promise.all([e.e(8895),e.e(3397),e.e(4606),e.e(6199)]).then(e.bind(e,17665)),"core:plugin/status-history":async()=>await Promise.all([e.e(8895),e.e(3397),e.e(4606),e.e(8259)]).then(e.bind(e,98337)),"core:plugin/candlestick":async()=>await Promise.all([e.e(4007),e.e(3397),e.e(94),e.e(6965),e.e(3090)]).then(e.bind(e,4782)),"core:plugin/graph":async()=>await Promise.all([e.e(407),e.e(5995),e.e(9362),e.e(8068)]).then(e.bind(e,229)),"core:plugin/xychart":async()=>a.$.featureToggles.autoMigrateXYChartPanel?await Promise.all([e.e(9739),e.e(8891),e.e(3772)]).then(e.bind(e,80983)):await Promise.all([e.e(707),e.e(9739),e.e(5594)]).then(e.bind(e,31552)),"core:plugin/geomap":async()=>await Promise.all([e.e(4007),e.e(8895),e.e(1698),e.e(707),e.e(9654),e.e(190)]).then(e.bind(e,7734)),"core:plugin/canvas":async()=>await Promise.all([e.e(707),e.e(7523)]).then(e.bind(e,30507)),"core:plugin/dashlist":async()=>await e.e(8995).then(e.bind(e,72739)),"core:plugin/alertlist":async()=>await e.e(3375).then(e.bind(e,73235)),"core:plugin/annolist":async()=>await e.e(4979).then(e.bind(e,3658)),"core:plugin/heatmap":async()=>await Promise.all([e.e(4007),e.e(407),e.e(5995),e.e(3397),e.e(8891),e.e(5857)]).then(e.bind(e,26235)),"core:plugin/table":async()=>await e.e(3525).then(e.bind(e,55312)),"core:plugin/table-old":async()=>await e.e(8777).then(e.bind(e,78491)),"core:plugin/news":async()=>await e.e(4940).then(e.bind(e,18918)),"core:plugin/live":async()=>await e.e(5413).then(e.bind(e,45850)),"core:plugin/stat":async()=>await Promise.resolve().then(e.bind(e,36373)),"core:plugin/datagrid":async()=>await Promise.all([e.e(7445),e.e(7229),e.e(5939)]).then(e.bind(e,97229)),"core:plugin/debug":async()=>await Promise.all([e.e(4007),e.e(2770)]).then(e.bind(e,73756)),"core:plugin/flamegraph":async()=>await Promise.all([e.e(407),e.e(5995),e.e(5194),e.e(5686)]).then(e.bind(e,41513)),"core:plugin/gettingstarted":async()=>await e.e(9142).then(e.bind(e,96485)),"core:plugin/gauge":async()=>await Promise.resolve().then(e.bind(e,14738)),"core:plugin/piechart":async()=>await e.e(6105).then(e.bind(e,82169)),"core:plugin/bargauge":async()=>await e.e(3851).then(e.bind(e,72738)),"core:plugin/barchart":async()=>await Promise.all([e.e(8895),e.e(3124)]).then(e.bind(e,82590)),"core:plugin/logs":async()=>await Promise.all([e.e(1166),e.e(7884)]).then(e.bind(e,66642)),"core:plugin/traces":async()=>await Promise.all([e.e(407),e.e(5995),e.e(5194),e.e(500),e.e(4301)]).then(e.bind(e,82892)),"core:plugin/welcome":async()=>await e.e(8463).then(e.bind(e,55005)),"core:plugin/nodeGraph":async()=>await Promise.all([e.e(1698),e.e(5511),e.e(7317)]).then(e.bind(e,68403)),"core:plugin/histogram":async()=>await e.e(323).then(e.bind(e,20634))};var se=e(81900),te=e(63770),ne=e(34796),le=e.n(ne),re=e(54087),de=e(80851),oe=e(32176),J=e(31221),ce=e(91520),pe=e(92275),xe=e(82013),fe=e(2341),Ee=e(19538),Se=e(65158),ye=e(33459),Ve=e(85858),Me=e(7117),Ce=e(8984),Ue=e(91950),Ae=e(2913),we=e(10096),We=e(27677),_e=e(62301),at=e(31140),ut=e(78827),Tt=e(68576),It=e(92247);const ge=Ce;ge.PanelPlugin=Se.m,ge.DataSourcePlugin=n.tD,ge.AppPlugin=s.hX,ge.DataSourceApi=n.mA;const Ie=["jquery.flot.crosshair","jquery.flot.events","jquery.flot.fillbelow","jquery.flot.gauge","jquery.flot.pie","jquery.flot.selection","jquery.flot.stack","jquery.flot.stackpercent","jquery.flot.time","jquery.flot"].reduce((vt,kt)=>({...vt,[kt]:{fakeDep:1}}),{}),ue={"@emotion/css":()=>Promise.resolve().then(e.bind(e,32196)),"@emotion/react":()=>Promise.resolve().then(e.bind(e,52762)),"@grafana/data":ye,"@grafana/runtime":Me,"@grafana/slate-react":()=>Promise.resolve().then(e.bind(e,29317)),"@grafana/ui":ge,"@kusto/monaco-kusto":()=>Promise.all([e.e(630),e.e(1460),e.e(6938)]).then(e.bind(e,20582)),"app/core/app_events":{default:we.lE,__useDefault:!0},"app/core/config":{default:Ae.Ay,__useDefault:!0},"app/core/core":{appEvents:we.lE,contextSrv:we.TP},"app/core/services/backend_srv":{BackendSrv:We.Mf,getBackendSrv:We.AI},"app/core/table_model":{default:Ue.A,__useDefault:!0},"app/core/time_series":{default:at.A,__useDefault:!0},"app/core/time_series2":{default:at.A,__useDefault:!0},"app/core/utils/datemath":Ve,"app/core/utils/flatten":ut,"app/core/utils/kbn":{default:Tt.A,__useDefault:!0},"app/core/utils/ticks":It,"app/features/dashboard/impression_store":{impressions:_e.A},d3:()=>Promise.all([e.e(407),e.e(5995)]).then(e.bind(e,55995)),emotion:()=>Promise.resolve().then(e.bind(e,32196)),i18next:()=>Promise.resolve().then(e.bind(e,72635)),jquery:{default:le(),__useDefault:!0},...Ie,lodash:()=>Promise.resolve().then(e.t.bind(e,2543,23)).then(vt=>({...vt,__useDefault:!0})),moment:()=>Promise.resolve().then(e.t.bind(e,95093,23)).then(vt=>({...vt,__useDefault:!0})),prismjs:()=>Promise.resolve().then(e.t.bind(e,28848,23)),react:()=>Promise.resolve().then(e.t.bind(e,96540,19)),"react-dom":()=>Promise.resolve().then(e.t.bind(e,40961,19)),"react-inlinesvg":()=>Promise.resolve().then(e.bind(e,8867)),"react-redux":()=>Promise.resolve().then(e.bind(e,71468)),"react-router-dom":()=>Promise.resolve().then(e.bind(e,54625)),"react-router":()=>Promise.resolve().then(e.bind(e,35557)),redux:()=>Promise.resolve().then(e.bind(e,14644)),rxjs:()=>Promise.all([e.e(7315),e.e(5091)]).then(e.bind(e,75091)),"rxjs/operators":()=>Promise.all([e.e(7315),e.e(2975)]).then(e.bind(e,32975)),slate:()=>Promise.resolve().then(e.bind(e,82611)),"slate-plain-serializer":()=>Promise.resolve().then(e.bind(e,52845)),"slate-react":()=>Promise.resolve().then(e.bind(e,29317))};function me({url:vt,source:kt,transformSourceMapURL:cn=!1,transformAssets:vn=!0}){const Pn=vt.split("/public/plugins/"),Kn=Pn[0],us=Pn[1].split("/")[0];let Gn=kt;return vn&&(Gn=Gn.replace(/(\/?)(public\/plugins)/g,`${Kn}/$2`),Gn=Gn.replace(/(["|'])(plugins\/.+?.css)(["|'])/g,`$1${Kn}/public/$2$3`)),cn&&(Gn=Gn.replace(/(\/\/#\ssourceMappingURL=)(.+)\.map/g,`$1${Kn}/public/plugins/${us}/$2.map`)),Gn}var Pe=e(45179),Ne=e(87815);async function Fe(vt,kt,cn){const vn=await vt(kt,cn),Pn=vn.headers.get("content-type")||"";if(Pe.Bu.test(Pn)){let us=await vn.text();if((0,Ne.OD)(vn.url)){const Gn=me({url:vn.url,source:us});return new Response(new Blob([Gn],{type:"text/javascript"}))}return new Response(new Blob([us],{type:"text/javascript"}))}return vn}function Be(vt,kt,cn){try{const vn=vt.apply(this,[kt,cn]),Pn=be(vn);return(Pn.endsWith(".js")||Pn.endsWith(".css"))&&!(0,Ne.OD)(Pn)?(0,se.ni)(Pn):Pn}catch{if(Pe.$b.test(kt)){const Pn=Ke(kt),Kn=vt.apply(this,[Pn,cn]);return(0,se.ni)(Kn)}return console.warn(`SystemJS: failed to resolve '${kt}'`),kt}}function he(vt,kt){if(new URL(kt,window.location.origin).pathname.endsWith(".css")&&!vt){const Pn=te.z.get(kt)?.default;Pn&&(document.adoptedStyleSheets=[...document.adoptedStyleSheets,Pn])}}function be(vt){return vt.startsWith(`${Pe.XV}:`)?vt:(vt.endsWith("!")&&(vt=vt.slice(0,-1)),["css","js","json","wasm"].some(vn=>vt.endsWith(vn))?vt:vt+".js")}function Ke(vt){const kt=vt.split("/")[1];let cn="";for(const[Kn]of te.z.entries())if(Kn.includes(kt)){cn=Kn;break}const vn=cn.lastIndexOf("/plugins");return vn===-1?`${a.$.appSubUrl??""}/public/${vt}`:`${cn.substring(0,vn)}/${vt}`}var ze=e(22055),nt=e(6262),tt=e(35853);function ot(vt){const kt=new URL(window.location.href),cn=new URL(vt);return kt.host===cn.host}async function gt(vt,kt){let cn="";if(ot(vt)?(cn=await(await fetch(vt)).text(),cn=me({url:vt,source:cn,transformSourceMapURL:!0,transformAssets:!1})):(0,Ne.OD)(vt)&&(cn=await(await fetch(vt)).text(),cn=me({url:vt,source:cn,transformSourceMapURL:!0,transformAssets:!0})),cn.length===0)throw new Error("Only same domain scripts are allowed in sandboxed plugins");cn=et(cn),kt.evaluate(cn)}async function He(vt){if((0,Ne.OD)(vt.module)){const kt=vt.module;let vn=await(await fetch(kt)).text();return vn=me({url:kt,source:vn,transformSourceMapURL:!0,transformAssets:!0}),vn}else{let kt=(0,Ne.Av)(vt.module);const cn=(0,se.ni)(kt);let Pn=await(await fetch(cn)).text();return Pn=me({url:cn,source:Pn,transformSourceMapURL:!0,transformAssets:!1}),Pn=et(Pn),Pn}}function et(vt){return vt.replace(/window\.location/gi,"window.locationSandbox")}function rt(vt){vt.evaluate(`${tt.V.toString()};${tt.V.name}()`)}function ht(vt){for(const kt of Object.values(a.$.datasources))if(kt.type===vt)return kt.meta;for(const kt of Object.values(a.$.panels))if(kt.id===vt)return kt;for(const kt of Object.values(a.$.apps))if(kt.id===vt)return{id:vt,type:t.QE.app,module:kt.path};throw new Error(`Could not find plugin ${vt}`)}var ft=e(2543);const De=["iframe"];var Te=e(7077),Oe=e(28848),Ye=e.n(Oe),Ge=e(29505),Je=e(96540),it=e(34867),St=e(27716);const zt=!!a.$.featureToggles.frontendSandboxMonitorOnly;function Kt(vt){return!!vt&&typeof vt=="object"&&vt?.hasOwnProperty("plugin")}function Qt(vt){throw new Error(`Unexpected object: ${vt}. This should never happen.`)}const an=(0,it.DW)("sandbox",{monitorOnly:String(zt)});function Nn(vt){return vt instanceof Je.Component}function zn(vt,kt){an.logWarning(vt,kt)}function Yn(vt,kt){an.logError(vt,kt)}function ss(vt,kt){an.logInfo(vt,kt)}async function ds({isAngular:vt,pluginId:kt}){if(!a.$.featureToggles.pluginsFrontendSandbox||vt||location.search.includes("nosandbox")&&a.$.buildInfo.env==="development"||a.$.disableFrontendSandboxForPlugins.includes(kt))return!1;const Pn=await(0,St.x)(kt);return!(Pn.type===t.QE.app&&Pn.signatureType===t.kv.grafana)}function Ms(vt){return vt?.constructor?.name==="RegExp"}function Bs(vt){return vt&&(Ms(vt)&&(0,Te.U)(vt)?new RegExp(vt):Array.isArray(vt)?vt.map(Bs):typeof vt=="object"?Object.keys(vt).reduce((kt,cn)=>(Reflect.set(kt,cn,Bs(Reflect.get(vt,cn))),kt),{}):vt)}function gs(vt){return vt&&((0,Te.U)(vt)?(0,ft.cloneDeep)(vt):Array.isArray(vt)?vt.map(gs):typeof vt=="object"?Object.keys(vt).reduce((kt,cn)=>(Reflect.set(kt,cn,gs(Reflect.get(vt,cn))),kt),{}):vt)}const Zn=Symbol.for("@@SANDBOX_LIVE_VALUE"),Ls=!!a.$.featureToggles.frontendSandboxMonitorOnly;function Ln(vt,kt){const cn=Reflect.get(vt,"nodeName");if(cn==="body"||vt===document.body)return document.body;if(cn==="head"||vt===document.head||vt===document.documentElement)return vt;if(De.includes(cn)&&(zn("<"+cn+"> is not allowed in sandboxed plugins",{pluginId:kt,param:cn}),!Ls))throw new Error("<"+cn+"> is not allowed in sandboxed plugins");if(fn(vt,kt)||vt.parentNode===document.body||vt.closest("#reactRoot")===null||Ls)return vt;{const vn=document.createElement(cn);return vn.dataset.grafanaPluginSandboxElement="true",vn}}function Hn(vt){if(typeof vt=="object"&&vt instanceof Element)try{return vt.nodeName!==void 0}catch{return!1}return!1}function Qn(vt){const kt=Reflect.get(vt,"style");Object.hasOwn(kt,Zn)||Reflect.defineProperty(kt,Zn,{})}function mt(vt){vt&&(Array.isArray(vt)?(vt.forEach(mt),Yt(vt)):typeof vt=="object"&&(Object.values(vt).forEach(mt),Yt(vt)))}function Yt(vt){if(vt)return Object.hasOwn(vt,Zn)||Reflect.defineProperty(vt,Zn,{}),vt}function on(vt){vt&&(Object.hasOwn(vt,Zn)||((0,Te.U)(vt)&&!(vt instanceof Function)&&(Nn(vt)||vt instanceof n.mA||vt instanceof Ge.f5)?Reflect.defineProperty(vt,Zn,{}):vt===Ye().languages&&Object.defineProperty(vt,Zn,{})))}function ln(vt){return Object.hasOwn(vt,Zn)}function fn(vt,kt){return!document.contains(vt)||vt.closest(`[data-plugin-sandbox=${kt}]`)!==null}let yn;function wn(){return yn||(yn=document.createElement("div"),yn.setAttribute("id","grafana-plugin-sandbox-body"),yn.setAttribute("data-plugin-sandbox","true"),yn.dataset.pluginSandbox="sandboxed-plugin",yn.style.width="100%",yn.style.height="0%",yn.style.overflow="hidden",yn.style.top="0",yn.style.left="0",document.body.appendChild(yn)),yn}let Xn=!1;function xn(){Xn||(Xn=!0,nn(),Ut())}function Ut(){const vt=Worker.prototype.postMessage;Object.defineProperty(Worker.prototype,"postMessage",{value:function(...kt){return vt.apply(this,gs(kt))}})}function nn(){const vt=window.history.replaceState;Object.defineProperty(window.history,"replaceState",{value:function(...kt){let cn=kt;try{cn=(0,ft.cloneDeep)(kt)}catch(vn){zn("Error cloning args in window.history.replaceState",{error:String(vn)})}return Reflect.apply(vt,this,cn)},writable:!0,configurable:!0,enumerable:!1})}const hn=new Map,dn=!!a.$.featureToggles.frontendSandboxMonitorOnly,Sn=Symbol.for("@SANDBOX_LIVE_API_PATCHED");function es(){return hn.size===0&&(Ze(hn),lt(hn),yt(hn),pn(hn),Zt(hn),Nt(hn),wt(hn),On(hn),An(hn),qn(hn),cs(hn),xs(hn)),hn}function Pt(vt,kt){return zn(`Plugin ${kt.id} tried to set a sandboxed property`,{pluginId:kt.id,attrOrMethod:String(vt),entity:"window"}),dn?vt:()=>{throw new Error("Plugins are not allowed to set sandboxed properties")}}function Ze(vt){const kt=["contentDocument","contentWindow","src","srcdoc","srcObject","srcset"];for(const vn of kt){const Pn=Object.getOwnPropertyDescriptor(HTMLIFrameElement.prototype,vn);if(Pn){let Kn=function(us,Gn){const ps=Gn.id;return zn(`Plugin ${ps} tried to access iframe.${vn}`,{pluginId:ps,attrOrMethod:vn,entity:"iframe"}),dn?us:()=>{throw new Error("iframe."+vn+" is not allowed in sandboxed plugins")}};var cn=Kn;Pn.value&&vt.set(Pn.value,Kn),Pn.set&&vt.set(Pn.set,Kn),Pn.get&&vt.set(Pn.get,Kn)}}}function lt(vt){const kt=Object.getOwnPropertyDescriptor(window,"console");if(kt?.value){let vn=function(Pn,Kn){const us=Kn.id;if(dn)return Pn;function Gn(...ps){console.log(`[plugin ${us}]`,...ps)}return{log:Gn,warn:Gn,error:Gn,info:Gn,debug:Gn,table:Gn}};var cn=vn;vt.set(kt.value,vn)}kt?.set&&vt.set(kt.set,Pt)}function yt(vt){function kt(vn,Pn){const Kn=Pn.id;return zn(`Plugin ${Kn} accessed window.alert`,{pluginId:Kn,attrOrMethod:"alert",entity:"window"}),dn?vn:function(...us){console.log(`[plugin ${Kn}]`,...us)}}const cn=Object.getOwnPropertyDescriptor(window,"alert");cn?.value&&vt.set(cn.value,kt),cn?.set&&vt.set(cn.set,Pt)}function Nt(vt){function kt(vn,Pn){const Kn=Pn.id;return function(...Gn){for(const ps of Gn){const Dt=String(ps||"").toLowerCase();for(const un of De)if(Dt.includes("<"+un)){if(zn(`Plugin ${Kn} tried to set ${un} in innerHTML`,{pluginId:Kn,attrOrMethod:"innerHTML",param:un,entity:"HTMLElement"}),dn)continue;throw new Error("<"+un+"> is not allowed in sandboxed plugins")}}if((0,ft.isFunction)(vn))return vn.apply(this,Gn)}}const cn=[Object.getOwnPropertyDescriptor(Element.prototype,"innerHTML"),Object.getOwnPropertyDescriptor(Element.prototype,"outerHTML"),Object.getOwnPropertyDescriptor(Element.prototype,"insertAdjacentHTML"),Object.getOwnPropertyDescriptor(DOMParser.prototype,"parseFromString")];for(const vn of cn)vn?.set&&vt.set(vn.set,kt),vn?.value&&vt.set(vn.value,kt)}function wt(vt){function kt(vn,Pn){const Kn=Pn.id;return function(Gn,ps){if(Gn&&De.includes(Gn)&&(zn(`Plugin ${Kn} tried to create ${Gn}`,{pluginId:Kn,attrOrMethod:"createElement",param:Gn,entity:"document"}),!dn))return document.createDocumentFragment();if((0,ft.isFunction)(vn))return vn.apply(this,[Gn,ps])}}const cn=Object.getOwnPropertyDescriptor(Document.prototype,"createElement");cn?.value&&vt.set(cn.value,kt)}function Zt(vt){function kt(Kn,us){const Gn=us.id;return function(Dt,un){const Bn=Dt?.nodeName?.toLowerCase()||"";if(Dt&&De.includes(Bn)&&(zn(`Plugin ${Gn} tried to insert ${Bn}`,{pluginId:Gn,attrOrMethod:"insertChild",param:Bn,entity:"HTMLElement"}),!dn))return document.createDocumentFragment();if((0,ft.isFunction)(Kn))return Kn.call(this,Dt,un)}}function cn(Kn,us){const Gn=us.id;return function(Dt,un){const Bn=un?.nodeName?.toLowerCase()||"";if(un&&De.includes(Bn)&&(zn(`Plugin ${Gn} tried to insert ${Bn}`,{pluginId:Gn,attrOrMethod:"insertAdjacentElement",param:Bn,entity:"HTMLElement"}),!dn))return document.createDocumentFragment();if((0,ft.isFunction)(Kn))return Kn.call(this,Dt,un)}}const vn=[Object.getOwnPropertyDescriptor(Node.prototype,"insertBefore"),Object.getOwnPropertyDescriptor(Node.prototype,"replaceChild")];for(const Kn of vn)Kn?.value&&vt.set(Kn.set,kt);const Pn=Object.getOwnPropertyDescriptor(Element.prototype,"insertAdjacentElement");Pn?.value&&vt.set(Pn.set,cn)}function pn(vt){function kt(Kn,us){const Gn=us.id;return function(...Dt){let un=Dt;const Bn=Dt?.filter(Jn=>!De.includes(Jn.nodeName.toLowerCase()));dn||(un=Bn),un.length!==Bn.length&&zn(`Plugin ${Gn} tried to append fobiddenElements`,{pluginId:Gn,attrOrMethod:"append",param:Dt?.filter(Jn=>De.includes(Jn.nodeName.toLowerCase()))?.join(",")||"",entity:"HTMLElement"}),(0,ft.isFunction)(Kn)&&Kn.apply(this,un)}}function cn(Kn,us,Gn){const ps=us.id;return function(un){const Bn=un?.nodeName?.toLowerCase()||"";if(un&&De.includes(Bn)&&(zn(`Plugin ${ps} tried to append ${Bn}`,{pluginId:ps,attrOrMethod:"appendChild",param:Bn,entity:"HTMLElement"}),!dn))return document.createDocumentFragment();if(Gn&&un&&Bn==="script"&&un instanceof HTMLScriptElement){gt(un.src,Gn).then(()=>{un.onload?.call(un,new Event("load"))}).catch(Jn=>{un.onerror?.call(un,new ErrorEvent("error",{error:Jn}))});return}if((0,ft.isFunction)(Kn))return Kn.call(this,un)}}const vn=[Object.getOwnPropertyDescriptor(Element.prototype,"append"),Object.getOwnPropertyDescriptor(Element.prototype,"prepend"),Object.getOwnPropertyDescriptor(Element.prototype,"after"),Object.getOwnPropertyDescriptor(Element.prototype,"before"),Object.getOwnPropertyDescriptor(Document.prototype,"append"),Object.getOwnPropertyDescriptor(Document.prototype,"prepend")];for(const Kn of vn)Kn?.value&&vt.set(Kn.value,kt);const Pn=Object.getOwnPropertyDescriptor(Node.prototype,"appendChild");Pn?.value&&vt.set(Pn.value,cn)}function On(vt){const kt=Object.getOwnPropertyDescriptor(Worker.prototype,"postMessage");function cn(vn){return function(...Kn){try{const us=(0,ft.cloneDeep)(Kn);(0,ft.isFunction)(vn)&&vn.apply(this,us)}catch{throw new Error("postMessage arguments are invalid objects")}}}kt?.value&&vt.set(kt.value,cn)}function An(vt){const kt=Object.getOwnPropertyDescriptor(Document.prototype,"defaultView");kt?.get&&vt.set(kt.get,()=>()=>window);const cn=["write"];for(const vn of cn){const Pn=Object.getOwnPropertyDescriptor(Document.prototype,vn);Pn?.set&&vt.set(Pn.set,Pt),Pn?.value&&vt.set(Pn.value,Pt)}}async function qn(vt){const kt=Reflect.get(window,"monaco");if(!kt||Object.hasOwn(kt,Sn))return;const cn=kt.languages.setMonarchTokensProvider;function vn(){return function(...Pn){return Pn.length!==2?cn.apply(kt,Pn):cn.call(kt,Pn[0],Bs(Pn[1]))}}vt.set(kt.languages.setMonarchTokensProvider,vn),Reflect.set(kt,Sn,{})}async function cs(vt){const kt=Object.getOwnPropertyDescriptor(window,"postMessage");function cn(vn){return function(...Kn){try{const us=(0,ft.cloneDeep)(Kn);(0,ft.isFunction)(vn)&&vn.apply(this,us)}catch{throw new Error("postMessage arguments are invalid objects")}}}kt?.value&&vt.set(kt.value,cn)}function Os(vt){qn(hn)}function xs(vt){function kt(cn){return(0,ft.isFunction)(cn)?function(...vn){const Pn=cn.apply(this,vn);return mt(Pn),Pn}:cn}vt.set(ft.cloneDeep,kt)}var zs=e(66161),Ks=e(74848);async function ma(vt,kt){if(!Kt(vt))return vt;const cn=await Promise.resolve(vt.plugin);if(Reflect.has(cn,"panel")&&Reflect.set(cn,"panel",la(Reflect.get(cn,"panel"),kt)),Reflect.has(cn,"components")){const vn=Reflect.get(cn,"components");Object.entries(vn).forEach(([Pn,Kn])=>{Reflect.set(vn,Pn,la(Kn,kt))}),Reflect.set(cn,"components",vn)}if(Reflect.has(cn,"root")&&Reflect.set(cn,"root",la(Reflect.get(cn,"root"),kt)),Reflect.has(cn,"extensionConfigs")){const vn=Reflect.get(cn,"extensionConfigs");for(const Pn of vn)Reflect.has(Pn,"component")&&Reflect.set(Pn,"component",la(Reflect.get(Pn,"component"),kt));Reflect.set(cn,"extensionConfigs",vn)}if(Reflect.has(cn,"configPages")){const vn=Reflect.get(cn,"configPages")??[];for(const[Pn,Kn]of Object.entries(vn))!Kn.body||!(0,ft.isFunction)(Kn.body)||Reflect.set(vn,Pn,{...Kn,body:la(Kn.body,kt)});Reflect.set(cn,"configPages",vn)}return vt}const la=(vt,kt)=>{const cn=Je.memo(vn=>(0,Ks.jsx)("div",{"data-plugin-sandbox":kt.id,style:{height:kt.type===t.QE.app||kt.type===t.QE.panel?"100%":"auto"},children:(0,Ks.jsx)(vt,{...vn})}));return cn.displayName=`GrafanaSandbox(${vt.displayName||vt.name||"Component"})`,cn},Ua=new Map,Ra={};async function Pa({pluginId:vt}){xn();try{const kt=ht(vt);return Ua.has(vt)||Ua.set(vt,wa(kt)),Ua.get(vt)}catch(kt){const cn=new Error(`Could not import plugin ${vt} inside sandbox: `+kt);throw Yn(cn,{pluginId:vt,error:String(kt)}),cn}}async function wa(vt){return ss("Loading with sandbox",{pluginId:vt.id}),new Promise(async(kt,cn)=>{const vn=es();let Pn;function Kn(Gn){if(Hn(Gn)){const un=Ln(Gn,vt.id);return Qn(un),un}else on(Gn);const ps=vn.get(Gn);if(ps)return ps(Gn,vt,Pn);const Dt=Os(Gn);return Dt||Gn}Pn=(0,ze.A)(window,{distortionCallback:Kn,defaultPolicy:nt.G,liveTargetCallback:ln,endowments:Object.getOwnPropertyDescriptors({locationSandbox:window.location,setImmediate:function(Gn,...ps){return setTimeout(Gn,0,...ps)},get monaco(){return Reflect.get(window,"monaco")},get Prism(){return Reflect.get(window,"Prism")},get jQuery(){return Reflect.get(window,"jQuery")},get $(){return Reflect.get(window,"jQuery")},get grafanaBootData(){if(Ra[vt.id+"-grafanaBootData"]||(Ra[vt.id+"-grafanaBootData"]=!0,ss("Plugin using window.grafanaBootData",{sandbox:"true",pluginId:vt.id,guessedPluginName:vt.id,parent:"window",packageName:"window",key:"grafanaBootData"})),a.$.buildInfo.env==="development")throw new Error(`Error in ${vt.id}: Plugins should not use window.grafanaBootData. Use "config" from "@grafana/runtime" instead.`);return console.error(`${vt.id.toUpperCase()}: Plugins should not use window.grafanaBootData. Use "config" from "@grafana/runtime" instead.`),a.$.bootData},async define(Gn,ps,Dt){let un,Bn;Array.isArray(Gn)?(un=Gn,Bn=ps):(un=ps,Bn=Dt);try{const Jn=await Ea(un,vt),In=Bn.apply(null,Jn),ms=await ma(In,vt);kt(ms)}catch(Jn){const In=new Error(`Could not execute plugin's define ${vt.id}: `+Jn);Yn(In,{pluginId:vt.id,error:String(Jn)}),cn(In)}}})}),rt(Pn);let us="";try{us=await He(vt)}catch(Gn){const ps=new Error(`Could not load plugin code ${vt.id}: `+Gn);Yn(ps,{pluginId:vt.id,error:String(Gn)}),cn(ps)}try{Pn.evaluate(us)}catch(Gn){const ps=new Error(`Could not run plugin ${vt.id} inside sandbox: `+Gn);Yn(ps,{pluginId:vt.id,error:String(Gn)}),cn(ps)}})}async function Ea(vt,kt){const cn={},vn={id:kt.id,uri:kt.module,exports:cn},Pn=[];for(const Kn of vt){let us=zs.s.get(Kn);if(typeof us=="function"&&(us=await us()),us?.__useDefault&&(us=us.default),Kn==="module"&&(us=vn),Kn==="exports"&&(us=cn),!us){const Gn=new Error(`[sandbox] Could not resolve dependency ${Kn}`);throw Yn(Gn,{pluginId:kt.id,dependency:Kn,error:String(Gn)}),Gn}Pn.push(us)}return Pn}const Za=(0,Ne.kB)(ue);te.z.addImportMap({imports:Za});const Na=te.z.constructor.prototype;Na.shouldFetch=function(vt){const kt=(0,se.QO)(vt);return/^[^#?]+\.(js)([?#].*)?$/.test(vt)?kt?.loadingStrategy!==t.xf.script:!0};const gr=Na.import;Na.import=function(...vt){return gr.apply(this,vt).then(kt=>kt&&kt.__useDefault?kt.default:kt)};const cr=Na.fetch;Na.fetch=function(vt,kt){return Fe(cr,vt,kt)};const Ha=Na.resolve;Na.resolve=Be.bind(Na,Ha),Na.onload=he;async function $a({path:vt,pluginId:kt,loadingStrategy:cn,version:vn,isAngular:Pn,moduleHash:Kn}){vn&&(0,se.GD)({path:vt,version:vn,loadingStrategy:cn});const us=k[vt];if(us)return typeof us=="function"?await us():us;const Gn=(0,Ne.Av)(vt);if(a.$.featureToggles.pluginsSriChecks){const ps=System.resolve(Gn),Dt=System.getImportMap().integrity;Kn&&Dt&&!Dt[ps]&&te.z.addImportMap({integrity:{[ps]:Kn}})}return await ds({isAngular:Pn,pluginId:kt})?Pa({pluginId:kt}):te.z.import(Gn)}function Xa(vt){const kt=vt.angular?.detected??vt.angularDetected,cn=vt.loadingStrategy??t.xf.fetch;return $a({path:vt.module,version:vt.info?.version,isAngular:kt,loadingStrategy:cn,pluginId:vt.id,moduleHash:vt.moduleHash}).then(vn=>{if(vn.plugin){const Pn=vn.plugin;return Pn.meta=vt,Pn}if(vn.Datasource){const Pn=new n.tD(vn.Datasource);return Pn.setComponentsFromLegacyExports(vn),Pn.meta=vt,Pn}throw new Error("Plugin module is missing DataSourcePlugin or Datasource constructor export")})}function _a(vt){const kt=vt.angular?.detected??vt.angularDetected,cn=vt.loadingStrategy??t.xf.fetch;return $a({path:vt.module,version:vt.info?.version,isAngular:kt,loadingStrategy:cn,pluginId:vt.id,moduleHash:vt.moduleHash}).then(vn=>{const Pn=vn.plugin?vn.plugin:new s.hX;return Pn.init(vt),Pn.meta=vt,Pn.setComponentsFromLegacyExports(vn),Pn})}},66161:(G,R,e)=>{"use strict";e.d(R,{s:()=>t});const t=new Map([])},60677:(G,R,e)=>{"use strict";e.d(R,{W3:()=>g,Wy:()=>i,z4:()=>l});var t=e(43429),n=e(34867),s=e(15162),a=e(27716),r=e(1682);async function g(d){const c=await(0,a.x)(d);let h;if(c.type===t.QE.app&&(h=await(0,r.ui)(c)),c.type===t.QE.datasource&&(h=await(0,r.cS)(c)),c.type===t.QE.panel&&(h=await(0,s.Kk)(c)),c.type===t.QE.renderer&&(h={meta:c}),!h)throw new Error("Unknown Plugin type: "+c.type);return h}function i(d,c){if(!c)return;const h=10;let o={...c},m;function u(f,y){return!y.startsWith(f.url??"")||m&&(m.url?.length??0)>(f.url?.length??0)?f:(m&&(m.active=!1),m={...f,active:!0},m)}function p(f,y=0){if(y>h)return f;if(f.children){const x=f.children.map(v=>p(v,y+1));return{...u(f,d),children:x}}return u(f,d)}return o.children=(o?.children??[]).map(p),{main:o,node:m??o}}const l=(0,n.DW)("features.plugins")},8856:(G,R,e)=>{"use strict";e.d(R,{Pj:()=>c,o:()=>h,Aj:()=>m});var t=e(75816),n=e(75505),s=e(17172);function a({baseURL:u}){async function p(f){try{const{data:y,...x}=await(0,n.s)((0,s.AI)().fetch({...f,url:u+f.url,showErrorAlert:f.showErrorAlert,data:f.body}));return{data:y,meta:x}}catch(y){return f.manageError?f.manageError(y):{error:y}}}return p}const g=(0,t.xP)({reducerPath:"userPreferencesAPI",baseQuery:a({baseURL:"/api"}),endpoints:()=>({})}).injectEndpoints({endpoints:u=>({getUserPreferences:u.query({query:()=>({url:"/user/preferences"})}),patchUserPreferences:u.mutation({query:p=>({url:"/user/preferences",method:"PATCH",body:p.patchPrefsCmd})}),updateUserPreferences:u.mutation({query:p=>({url:"/user/preferences",method:"PUT",body:p.updatePrefsCmd})})}),overrideExisting:!1}),{useGetUserPreferencesQuery:i,usePatchUserPreferencesMutation:l,useUpdateUserPreferencesMutation:d}=g,{useGetUserPreferencesQuery:c,usePatchUserPreferencesMutation:h,useUpdateUserPreferencesMutation:o}=g,m=g.enhanceEndpoints({addTagTypes:["UserPreferences"],endpoints:{getUserPreferences:{providesTags:["UserPreferences"]},updateUserPreferences:{invalidatesTags:["UserPreferences"]},patchUserPreferences:{invalidatesTags:["UserPreferences"]}}})},81862:(G,R,e)=>{"use strict";e.d(R,{Ay:()=>S,Cj:()=>h,HO:()=>x,Mj:()=>u,Nm:()=>m,Q9:()=>y,RS:()=>E,c1:()=>c,g$:()=>v,ny:()=>p,ri:()=>f,uh:()=>P,xu:()=>o});var t=e(65307),n=e(2543),s=e.n(n),a=e(72724),r=e(47232),g=e(2913),i=e(10096);const l={orgId:g.Ay.bootData.user.orgId,timeZone:g.Ay.bootData.user.timezone,weekStart:g.Ay.bootData.user.weekStart,fiscalYearStartMonth:0,orgsAreLoading:!1,sessionsAreLoading:!1,teamsAreLoading:!1,isUpdating:!1,orgs:[],sessions:[],teams:[],user:null},d=(0,t.Z0)({name:"user/profile",initialState:l,reducers:{updateTimeZone:(O,M)=>{O.timeZone=M.payload.timeZone},updateWeekStart:(O,M)=>{O.weekStart=M.payload.weekStart},updateFiscalYearStartMonth:(O,M)=>{O.fiscalYearStartMonth=M.payload.fiscalYearStartMonth},setUpdating:(O,M)=>{O.isUpdating=M.payload.updating},userLoaded:(O,M)=>{O.user=M.payload.user},initLoadTeams:(O,M)=>{O.teamsAreLoading=!0},teamsLoaded:(O,M)=>{O.teams=M.payload.teams,O.teamsAreLoading=!1},initLoadOrgs:(O,M)=>{O.orgsAreLoading=!0},orgsLoaded:(O,M)=>{O.orgs=M.payload.orgs,O.orgsAreLoading=!1},initLoadSessions:(O,M)=>{O.sessionsAreLoading=!0},sessionsLoaded:(O,M)=>{const I=M.payload.sessions.sort((L,B)=>Number(B.isActive)-Number(L.isActive));O.sessions=I.map(L=>({id:L.id,isActive:L.isActive,seenAt:(0,a.fq)(L.seenAt),createdAt:L.createdAt,clientIp:L.clientIp,browser:L.browser,browserVersion:L.browserVersion,os:L.os,osVersion:L.osVersion,device:L.device})),O.sessionsAreLoading=!1},userSessionRevoked:(O,M)=>{O.sessions=O.sessions.filter(I=>I.id!==M.payload.tokenId),O.isUpdating=!1}}}),c=O=>async M=>{(0,n.set)(i.TP,"user.fiscalYearStartMonth",O),M(b({fiscalYearStartMonth:O}))},h=O=>async M=>{(!(0,n.isString)(O)||(0,n.isEmpty)(O))&&(O=g.Ay?.bootData?.user?.timezone),(0,n.set)(i.TP,"user.timezone",O),M(D({timeZone:O}))},o=O=>async M=>{(!(0,n.isString)(O)||(0,n.isEmpty)(O))&&(O=g.Ay?.bootData?.user?.weekStart),(0,n.set)(i.TP,"user.weekStart",O),M(C({weekStart:O})),(0,r.$D)(O)},{setUpdating:m,initLoadOrgs:u,orgsLoaded:p,initLoadTeams:f,teamsLoaded:y,userLoaded:x,userSessionRevoked:v,initLoadSessions:P,sessionsLoaded:E,updateTimeZone:D,updateWeekStart:C,updateFiscalYearStartMonth:b}=d.actions,T=d.reducer,S={user:d.reducer}},32901:(G,R,e)=>{"use strict";e.d(R,{O:()=>t,q:()=>n});const t=s=>s.timeZone,n=s=>s.fiscalYearStartMonth},2858:(G,R,e)=>{"use strict";e.d(R,{g:()=>l});var t=e(75816),n=e(62938),s=e(56389);const a="grafana.app/createdBy",r=d=>d.items?d.items.map(c=>({uid:c.metadata.name||"",title:c.spec.title,targets:c.spec.targets.map(h=>h.properties),createdAtTimestamp:new Date(c.metadata.creationTimestamp||"").getTime(),user:{uid:c.metadata.annotations?.[a]||""}})):[],g=d=>{const{title:c,targets:h}=d;return{apiVersion:s.mG,kind:s.GY.QueryTemplate,metadata:{generateName:(0,n.A)()},spec:{title:c,vars:[],targets:h.map(o=>({variables:{},properties:o}))}}},i=1e3,l=(0,t.xP)({baseQuery:s.Su,tagTypes:["QueryTemplatesList"],endpoints:d=>({allQueryTemplates:d.query({query:()=>({url:`?limit=${i}`}),transformResponse:r,providesTags:["QueryTemplatesList"]}),addQueryTemplate:d.mutation({query:c=>({method:"POST",data:g(c)}),invalidatesTags:["QueryTemplatesList"]}),deleteQueryTemplate:d.mutation({query:({uid:c})=>({url:`/${c}`,method:"DELETE"}),invalidatesTags:["QueryTemplatesList"]}),editQueryTemplate:d.mutation({query:c=>({url:`/${c.uid}`,method:"PATCH",headers:{"Content-Type":"application/merge-patch+json"},data:{spec:c.partialSpec}}),invalidatesTags:["QueryTemplatesList"]})}),reducerPath:"queryLibrary"})},56389:(G,R,e)=>{"use strict";e.d(R,{C1:()=>g,GY:()=>r,Su:()=>i,mG:()=>a});var t=e(75505),n=e(32264),s=e(17172);const a="peakq.grafana.app/v0alpha1";var r=(l=>(l.QueryTemplate="QueryTemplate",l))(r||{});const g=`/apis/${a}/namespaces/${n.$.namespace}/querytemplates`,i=async l=>{try{const d=(0,s.AI)().fetch({url:`${g}${l.url??""}`,showErrorAlert:!0,method:l.method||"GET",data:l.data,headers:{...l.headers}});return await(0,t.s)(d)}catch(d){return(0,s.NF)(d)?{error:new Error(d.data.message)}:d instanceof Error?{error:d}:{error:new Error("Unknown error")}}}},64152:(G,R,e)=>{"use strict";e.d(R,{d:()=>s,m:()=>n});class t{constructor(){this.extraRenderActions=[],this.keyedScopedExtraRenderActions=new Map}addExtraRenderAction(r){this.extraRenderActions=this.extraRenderActions.concat(r)}addKeyedExtraRenderAction(r,g){this.keyedScopedExtraRenderActions.set(r,g)}getAllExtraRenderAction(){return this.extraRenderActions}getScopedExtraRenderAction(r){return Array.from(this.keyedScopedExtraRenderActions,i=>i[1]).filter(i=>i.scope===r).map(i=>i.queryActionComponent)}}const n=new t,s=new t},48514:(G,R,e)=>{"use strict";e.d(R,{c:()=>V,E:()=>z});var t=e(74848),n=e(46942),s=e.n(n),a=e(2543),r=e(55127),g=e.n(r),i=e(96540),l=e(41987),d=e(76287),c=e(22391),h=e(18226),o=e(39070),m=e(14236),u=e(26272),p=e(13544),f=e(19347),y=e(7376),x=e(14110),v=e(39938),P=e(66602),E=e(22214),D=e(10343),C=e(7788),b=e(8484),T=e(74856),S=e(84423),O=e(64152),M=e(32196),I=e(40845),L=e(14578),B=e(10354),j=e(72093),A=e(51612);const K=N=>{const{query:H,queries:Q,onChange:X,collapsedText:ee,renderExtras:Z,hidden:q,hideRefId:ae=!1}=N,k=(0,I.of)(U),[se,te]=(0,i.useState)(!1),[ne,le]=(0,i.useState)(null),re=xe=>{te(!0)},de=xe=>{if(te(!1),ne){le(null);return}H.refId!==xe&&X({...H,refId:xe})},oe=xe=>{const fe=xe.currentTarget.value.trim();if(fe.length===0){le("An empty query name is not allowed");return}for(const Ee of Q)if(Ee!==H&&fe===Ee.refId){le("Query name already exists");return}ne&&le(null)},J=xe=>{de(xe.currentTarget.value.trim())},ce=xe=>{xe.key==="Enter"&&de(xe.currentTarget.value)},pe=xe=>{xe.target.select()};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:k.wrapper,children:[!ae&&!se&&(0,t.jsxs)("button",{className:k.queryNameWrapper,"aria-label":p.Tp.components.QueryEditorRow.title(H.refId),title:"Edit query name",onClick:re,"data-testid":"query-name-div",type:"button",children:[(0,t.jsx)("span",{className:k.queryName,children:H.refId}),(0,t.jsx)(L.I,{name:"pen",className:k.queryEditIcon,size:"sm"})]}),!ae&&se&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(B.p,{type:"text",defaultValue:H.refId,onBlur:J,autoFocus:!0,onKeyDown:ce,onFocus:pe,invalid:ne!==null,onChange:oe,className:k.queryNameInput,"data-testid":"query-name-input"}),ne&&(0,t.jsx)(j.P,{horizontal:!0,children:ne})]}),W(N,k),Z&&(0,t.jsx)("div",{className:k.itemWrapper,children:Z()}),q&&(0,t.jsx)("em",{className:k.contextInfo,children:"Hidden"})]}),ee&&(0,t.jsx)("div",{className:k.collapsedText,children:ee})]})},W=(N,H)=>{const{alerting:Q,dataSource:X,onChangeDataSource:ee}=N;return ee?(0,t.jsx)("div",{className:H.itemWrapper,children:(0,t.jsx)(A.s,{variables:!0,alerting:Q,current:X.name,onChange:ee})}):(0,t.jsxs)("em",{className:H.contextInfo,children:["(",X.name,")"]})},U=N=>({wrapper:(0,M.css)`
      label: Wrapper;
      display: flex;
      align-items: center;
      margin-left: ${N.spacing(.5)};
      overflow: hidden;
    `,queryNameWrapper:(0,M.css)`
      display: flex;
      cursor: pointer;
      border: 1px solid transparent;
      border-radius: ${N.shape.borderRadius(2)};
      align-items: center;
      padding: 0 0 0 ${N.spacing(.5)};
      margin: 0;
      background: transparent;
      overflow: hidden;

      &:hover {
        background: ${N.colors.action.hover};
        border: 1px dashed ${N.colors.border.strong};
      }

      &:focus {
        border: 2px solid ${N.colors.primary.border};
      }

      &:hover,
      &:focus {
        .query-name-edit-icon {
          visibility: visible;
        }
      }
    `,queryName:(0,M.css)`
      font-weight: ${N.typography.fontWeightMedium};
      color: ${N.colors.primary.text};
      cursor: pointer;
      overflow: hidden;
      margin-left: ${N.spacing(.5)};
    `,queryEditIcon:(0,M.cx)((0,M.css)`
        margin-left: ${N.spacing(2)};
        visibility: hidden;
      `,"query-name-edit-icon"),queryNameInput:(0,M.css)`
      max-width: 300px;
      margin: -4px 0;
    `,collapsedText:(0,M.css)`
      font-weight: ${N.typography.fontWeightRegular};
      font-size: ${N.typography.bodySmall.fontSize};
      color: ${N.colors.text.secondary};
      padding-left: ${N.spacing(1)};
      align-items: center;
      overflow: hidden;
      font-style: italic;
      white-space: nowrap;
      text-overflow: ellipsis;
    `,contextInfo:(0,M.css)`
      font-size: ${N.typography.bodySmall.fontSize};
      font-style: italic;
      color: ${N.colors.text.secondary};
      padding-left: 10px;
      padding-right: 10px;
    `,itemWrapper:(0,M.css)`
      display: flex;
      margin-left: 4px;
    `});var F=e(84959);class V extends i.PureComponent{constructor(){super(...arguments),this.element=null,this.angularScope=null,this.angularQueryEditor=null,this.dataSourceSrv=(0,f.l)(),this.id="",this.state={datasource:null,hasTextEditMode:!1,data:void 0,isOpen:!0,showingHelp:!1},this.renderAngularQueryEditor=()=>{if(!this.element)return;this.angularQueryEditor&&(this.angularQueryEditor.destroy(),this.angularQueryEditor=null);const H=(0,y.E)(),Q='<plugin-component type="query-ctrl" />',X={ctrl:this.getAngularQueryComponentScope()};this.angularQueryEditor=H.load(this.element,X,Q),this.angularScope=X.ctrl},this.onOpen=()=>{this.renderAngularQueryEditor()},this.renderPluginEditor=()=>{const{query:H,onChange:Q,queries:X,onRunQuery:ee,onAddQuery:Z,app:q=l.Jk.PanelEditor,history:ae}=this.props,{datasource:k,data:se}=this.state;if(this.isWaitingForDatasourceToLoad())return null;if(k?.components?.QueryCtrl)return(0,t.jsx)("div",{ref:te=>this.element=te});if(k){let te=this.getReactQueryEditor(k);if(te)return(0,t.jsx)(d.p,{instanceSettings:this.props.dataSource,children:(0,t.jsx)(te,{query:H,datasource:k,onChange:Q,onRunQuery:ee,onAddQuery:Z,data:se,range:(0,T.jG)().timeRange(),queries:X,app:q,history:ae},k?.name)})}return(0,t.jsx)("div",{children:(0,t.jsx)(b.x6,{i18nKey:"query-operation.query-editor-not-exported",children:"Data source plugin does not export any Query Editor component"})})},this.onToggleEditMode=(H,Q)=>{H.stopPropagation(),this.angularScope&&this.angularScope.toggleEditorMode&&(this.angularScope.toggleEditorMode(),this.angularQueryEditor?.digest(),Q.isOpen||Q.onOpen())},this.onRemoveQuery=()=>{const{onRemoveQuery:H,query:Q,onQueryRemoved:X}=this.props;H(Q),X&&X()},this.onCopyQuery=()=>{const{query:H,onAddQuery:Q,onQueryCopied:X}=this.props,ee=(0,a.cloneDeep)(H);Q(ee),X&&X()},this.onHideQuery=()=>{const{query:H,onChange:Q,onRunQuery:X,onQueryToggled:ee}=this.props;Q({...H,hide:!H.hide}),X(),ee&&ee(H.hide),(0,x.rR)("query_editor_row_hide_query_clicked",{hide:!H.hide})},this.onToggleHelp=()=>{this.setState(H=>({showingHelp:!H.showingHelp}))},this.onClickExample=H=>{H.datasource===void 0&&(H.datasource=(0,c.p$)(this.props.dataSource)),this.props.onChange({...H,refId:this.props.query.refId}),this.onToggleHelp()},this.renderWarnings=()=>{const{data:H,query:Q}=this.props,ee=(z(H,Q.refId)?.series??[]).reduce((k,se)=>{if(!se.meta?.notices)return k;const te=(0,a.filter)(se.meta.notices,{severity:"warning"})??[];return k.concat(te)},[]),Z=(0,a.uniqBy)(ee,"text");if(!(Z.length>0))return null;const ae=Z.map(k=>k.text).join(`
`);return(0,t.jsx)(v.E,{color:"orange",icon:"exclamation-triangle",text:(0,t.jsxs)(t.Fragment,{children:[Z.length," ",g()("warning",Z.length)]}),tooltip:ae},"query-warning")},this.renderExtraActions=()=>{const{query:H,queries:Q,data:X,onAddQuery:ee,dataSource:Z,app:q}=this.props,ae=O.d.getAllExtraRenderAction();let k=[];q!==void 0&&(k=O.d.getScopedExtraRenderAction(q));const se=[...ae,...k].map((te,ne)=>te({query:H,queries:Q,timeRange:X.timeRange,onAddQuery:ee,dataSource:Z,key:ne})).filter(Boolean);return se.push(this.renderWarnings()),se},this.renderActions=H=>{const{query:Q,hideHideQueryButton:X=!1}=this.props,{hasTextEditMode:ee,datasource:Z,showingHelp:q}=this.state,ae=!!Q.hide,k=Z?.components?.QueryEditorHelp;return(0,t.jsxs)(t.Fragment,{children:[k&&(0,t.jsx)(D.A,{title:(0,b.t)("query-operation.header.datasource-help","Show data source help"),icon:"question-circle",onClick:this.onToggleHelp,active:q}),ee&&(0,t.jsx)(D.q,{title:(0,b.t)("query-operation.header.toggle-edit-mode","Toggle text edit mode"),icon:"pen",onClick:se=>{this.onToggleEditMode(se,H)}}),this.renderExtraActions(),(0,t.jsx)(D.q,{title:(0,b.t)("query-operation.header.duplicate-query","Duplicate query"),icon:"copy",onClick:this.onCopyQuery}),X?null:(0,t.jsx)(D.A,{dataTestId:p.Tp.components.QueryEditorRow.actionButton("Hide response"),title:Q.hide?(0,b.t)("query-operation.header.show-response","Show response"):(0,b.t)("query-operation.header.hide-response","Hide response"),icon:ae?"eye-slash":"eye",active:ae,onClick:this.onHideQuery}),(0,t.jsx)(D.q,{title:(0,b.t)("query-operation.header.remove-query","Remove query"),icon:"trash-alt",onClick:this.onRemoveQuery})]})},this.renderHeader=H=>{const{alerting:Q,query:X,dataSource:ee,onChangeDataSource:Z,onChange:q,queries:ae,renderHeaderExtras:k,hideRefId:se}=this.props;return(0,t.jsx)(K,{query:X,queries:ae,onChangeDataSource:Z,dataSource:ee,hidden:X.hide,onClick:te=>this.onToggleEditMode(te,H),onChange:q,collapsedText:H.isOpen?null:this.renderCollapsedText(),renderExtras:k,alerting:Q,hideRefId:se})}}componentDidMount(){const{data:H,query:Q,id:X}=this.props,ee=z(H,Q.refId);this.id=(0,a.uniqueId)(X+"_"),this.setState({data:ee}),this.loadDatasource()}componentWillUnmount(){this.angularQueryEditor&&this.angularQueryEditor.destroy()}getAngularQueryComponentScope(){const{query:H,queries:Q}=this.props,{datasource:X}=this.state,ee=new S.a9({targets:Q}),Z={},q=this;return{datasource:X,target:H,panel:ee,dashboard:Z,refresh:()=>{H.hide!==q.props.query.hide&&(H.hide=q.props.query.hide),this.props.onChange(H),this.props.onRunQuery()},render:()=>()=>console.log("legacy render function called, it does nothing"),events:this.props.eventBus||new h.o,range:(0,T.jG)().timeRange()}}getInterpolatedDataSourceUID(){if(this.props.query.datasource){const H=this.dataSourceSrv.getInstanceSettings(this.props.query.datasource);return H?.rawRef?.uid??H?.uid}return this.props.dataSource.rawRef?.uid??this.props.dataSource.uid}async loadDatasource(){let H;const Q=this.getInterpolatedDataSourceUID();try{H=await this.dataSourceSrv.get(Q)}catch{H=await this.dataSourceSrv.get()}typeof this.props.onDataSourceLoaded=="function"&&this.props.onDataSourceLoaded(H),this.setState({datasource:H,queriedDataSourceIdentifier:Q,hasTextEditMode:(0,a.has)(H,"components.QueryCtrl.prototype.toggleEditorMode")})}componentDidUpdate(H){const{datasource:Q,queriedDataSourceIdentifier:X}=this.state,{data:ee,query:Z}=this.props;if(H.id!==this.props.id&&(this.id=(0,a.uniqueId)(this.props.id+"_")),ee!==H.data){const q=z(ee,Z.refId);this.setState({data:q}),this.angularScope&&(this.angularScope.range=(0,T.jG)().timeRange()),this.angularQueryEditor&&q&&w(this.angularScope,q,this.angularQueryEditor)}if(Q&&X!==this.getInterpolatedDataSourceUID()){this.angularQueryEditor&&(this.angularQueryEditor.destroy(),this.angularQueryEditor=null),this.loadDatasource();return}!this.element||this.angularQueryEditor||this.renderAngularQueryEditor()}getReactQueryEditor(H){if(H)switch(this.props.app){case l.Jk.Explore:return H.components?.ExploreMetricsQueryField||H.components?.ExploreLogsQueryField||H.components?.ExploreQueryField||H.components?.QueryEditor;case l.Jk.PanelEditor:case l.Jk.Dashboard:default:return H.components?.QueryEditor}}isWaitingForDatasourceToLoad(){return this.getInterpolatedDataSourceUID()!==this.state.queriedDataSourceIdentifier}renderCollapsedText(){const{datasource:H}=this.state;return H?.getQueryDisplayText?H.getQueryDisplayText(this.props.query):this.angularScope&&this.angularScope.getCollapsedText?this.angularScope.getCollapsedText():null}render(){const{query:H,index:Q,visualization:X,collapsable:ee,hideActionButtons:Z}=this.props,{datasource:q,showingHelp:ae,data:k}=this.state,se=H.hide,te=k?.error&&k.error.refId===H.refId?k.error:k?.errors?.find(de=>de.refId===H.refId),ne=s()("query-editor-row",{"query-editor-row--disabled":se,"gf-form-disabled":se});if(!q)return null;const le=this.renderPluginEditor(),re=q.components?.QueryEditorHelp;return(0,t.jsx)("div",{"data-testid":"query-editor-row","aria-label":p.Tp.components.QueryEditorRows.rows,children:(0,t.jsx)(C.u,{id:this.id,draggable:!Z,collapsable:ee,index:Q,headerElement:this.renderHeader,actions:Z?void 0:this.renderActions,onOpen:this.onOpen,children:(0,t.jsxs)("div",{className:ne,id:this.id,children:[(0,t.jsxs)(P.Xw,{children:[ae&&re&&(0,t.jsx)(E.j,{children:(0,t.jsx)(re,{onClickExample:de=>this.onClickExample(de),query:this.props.query,datasource:q})}),le]}),te&&(0,t.jsx)(F.x,{error:te}),X]})})})}}function w(N,H,Q){if(H.state===o.Gu.Done){const X=H.series.map(ee=>(0,m.w3)(ee));N.events.emit(u.ee.dataReceived,X)}else H.state===o.Gu.Error&&N.events.emit(u.ee.dataError,H.error);setTimeout(Q.digest)}function z(N,H){const Q=N.series.filter(q=>q.refId===H);if(N.state!==o.Gu.Loading&&(N.error||N.errors?.length)&&!N.series.length)return{...N,state:o.Gu.Error};let X=N.state,ee=N.errors?.find(q=>q.refId===H);!ee&&N.error&&(ee=N.error.refId===H?N.error:void 0),X!==o.Gu.Loading&&(ee?X=o.Gu.Error:N.state===o.Gu.Error&&(X=o.Gu.Done));const Z=N.timeRange;return{...N,state:X,series:Q,error:ee,errors:ee?[ee]:void 0,timeRange:Z}}},44932:(G,R,e)=>{"use strict";e.d(R,{L:()=>l});var t=e(74848),n=e(91076),s=e(96540),a=e(22391),r=e(14110),g=e(19347),i=e(48514);class l extends s.PureComponent{constructor(){super(...arguments),this.onRemoveQuery=h=>{this.props.onQueriesChange(this.props.queries.filter(o=>o!==h))},this.onDragStart=h=>{const{queries:o,dsSettings:m}=this.props;(0,r.rR)("query_row_reorder_started",{startIndex:h.source.index,numberOfQueries:o.length,datasourceType:m.type})},this.onDragEnd=h=>{const{queries:o,onQueriesChange:m,dsSettings:u}=this.props;if(!h||!h.destination)return;const p=h.source.index,f=h.destination.index;if(p===f){(0,r.rR)("query_row_reorder_canceled",{startIndex:p,endIndex:f,numberOfQueries:o.length,datasourceType:u.type});return}const y=Array.from(o),[x]=y.splice(p,1);y.splice(f,0,x),m(y),(0,r.rR)("query_row_reorder_ended",{startIndex:p,endIndex:f,numberOfQueries:o.length,datasourceType:u.type})}}onChangeQuery(h,o){const{queries:m,onQueriesChange:u}=this.props;u(m.map((p,f)=>f===o?h:p))}onDataSourceChange(h,o){const{queries:m,onQueriesChange:u}=this.props;u(m.map((p,f)=>{if(f!==o)return p;const y=(0,a.p$)(h);return p.datasource&&(0,g.l)().getInstanceSettings(p.datasource)?.type===h.type?{...p,datasource:y}:{refId:p.refId,hide:p.hide,datasource:y}}))}render(){const{dsSettings:h,data:o,queries:m,app:u,history:p,eventBus:f,onAddQuery:y,onRunQueries:x,onQueryCopied:v,onQueryRemoved:P,onQueryToggled:E,queryRowWrapper:D}=this.props;return(0,t.jsx)(n.JY,{onDragStart:this.onDragStart,onDragEnd:this.onDragEnd,children:(0,t.jsx)(n.gL,{droppableId:"transformations-list",direction:"vertical",children:C=>(0,t.jsxs)("div",{"data-testid":"query-editor-rows",ref:C.innerRef,...C.droppableProps,children:[m.map((b,T)=>{const S=d(b,h),O=h.meta.mixed?I=>this.onDataSourceChange(I,T):void 0,M=(0,t.jsx)(i.c,{id:b.refId,index:T,data:o,query:b,dataSource:S,onChangeDataSource:O,onChange:I=>this.onChangeQuery(I,T),onRemoveQuery:this.onRemoveQuery,onAddQuery:y,onRunQuery:x,onQueryCopied:v,onQueryRemoved:P,onQueryToggled:E,queries:m,app:u,history:p,eventBus:f},b.refId);return D?D(M,b.refId):M}),C.placeholder]})})})}}const d=(c,h)=>c.datasource&&(0,g.l)().getInstanceSettings(c.datasource)||h},84959:(G,R,e)=>{"use strict";e.d(R,{x:()=>r});var t=e(74848),n=e(32196),s=e(40845),a=e(14578);function r({error:i}){const l=(0,s.of)(g),d=i?.message??i?.data?.message??"Query error";return(0,t.jsxs)("div",{className:l.wrapper,children:[(0,t.jsx)("div",{className:l.icon,children:(0,t.jsx)(a.I,{name:"exclamation-triangle"})}),(0,t.jsxs)("div",{className:l.message,children:[d,i.traceId!=null&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("br",{})," ",(0,t.jsxs)("span",{children:["(Trace ID: ",i.traceId,")"]})]})]})]})}const g=i=>({wrapper:(0,n.css)({marginTop:i.spacing(.5),background:i.colors.background.secondary,display:"flex"}),icon:(0,n.css)({background:i.colors.error.main,color:i.colors.error.contrastText,padding:i.spacing(1)}),message:(0,n.css)({fontSize:i.typography.bodySmall.fontSize,fontFamily:i.typography.fontFamilyMonospace,padding:i.spacing(1)})})},37464:(G,R,e)=>{"use strict";e.d(R,{g:()=>X,K:()=>Z});var t=e(74848),n=e(32196),s=e(96540),a=e(39070),r=e(43127),g=e(22391),i=e(41987),l=e(43429),d=e(13544),c=e(19347),h=e(39601),o=e(66864),m=e(55852),u=e(40276),p=e(37390),f=e(3911),y=e(38894),x=e(16817),v=e(36663),P=e(17172),E=e(39558);function D({pluginId:ae}){const{value:k,loading:se,error:te}=(0,x.A)(async()=>(0,P.AI)().get(`/api/plugins/${ae}/markdown/query_help`),[]),ne=(0,v.G)(k);return se?(0,t.jsx)(E._,{text:"Loading help..."}):te?(0,t.jsx)("h3",{children:"An error occurred when loading help."}):k===""?(0,t.jsx)("h3",{children:"No query help could be found."}):(0,t.jsx)("div",{className:"markdown-html",dangerouslySetInnerHTML:{__html:ne}})}var C=e(2913),b=e(27677),T=e(21969),S=e(50481),O=e(51612),M=e(53478),I=e(74106),L=e(14348),B=e(8480),j=e(93117),A=e(64152),K=e(44932),W=e(65879),U=e(10354),F=e(39268),V=e(15292),w=e(7788);class z extends s.PureComponent{constructor(k){super(k),this.onRelativeTimeChange=te=>{this.setState({timeRangeFrom:te.target.value})},this.onTimeShiftChange=te=>{this.setState({timeRangeShift:te.target.value})},this.onOverrideTime=te=>{const{options:ne,onChange:le}=this.props,re=H(te.target.value),de=N(re);de&&ne.timeRange?.from!==re&&le({...ne,timeRange:{...ne.timeRange??{},from:re}}),this.setState({relativeTimeIsValid:de})},this.onTimeShift=te=>{const{options:ne,onChange:le}=this.props,re=H(te.target.value),de=N(re);de&&ne.timeRange?.shift!==re&&le({...ne,timeRange:{...ne.timeRange??{},shift:re}}),this.setState({timeShiftIsValid:de})},this.onToggleTimeOverride=()=>{const{onChange:te,options:ne}=this.props;this.setState({timeRangeHide:!this.state.timeRangeHide},()=>{te({...ne,timeRange:{...ne.timeRange??{},hide:this.state.timeRangeHide}})})},this.onCacheTimeoutBlur=te=>{const{options:ne,onChange:le}=this.props;le({...ne,cacheTimeout:H(te.target.value)})},this.onQueryCachingTTLBlur=te=>{const{options:ne,onChange:le}=this.props;let re=parseInt(te.target.value,10);(isNaN(re)||re===0)&&(re=null),le({...ne,queryCachingTTL:re})},this.onMaxDataPointsBlur=te=>{const{options:ne,onChange:le}=this.props;let re=parseInt(te.currentTarget.value,10);(isNaN(re)||re===0)&&(re=null),re!==ne.maxDataPoints&&le({...ne,maxDataPoints:re})},this.onMinIntervalBlur=te=>{const{options:ne,onChange:le}=this.props,re=H(te.target.value);re!==ne.minInterval&&le({...ne,minInterval:re})},this.onOpenOptions=()=>{this.setState({isOpen:!0})},this.onCloseOptions=()=>{this.setState({isOpen:!1})};const{options:se}=k;this.state={timeRangeFrom:se.timeRange?.from||"",timeRangeShift:se.timeRange?.shift||"",timeRangeHide:se.timeRange?.hide??!1,isOpen:!1,relativeTimeIsValid:!0,timeShiftIsValid:!0}}renderCacheTimeoutOption(){const{dataSource:k,options:se}=this.props,te=`If your time series store has a query cache this option can override the default cache timeout. Specify a
    numeric value in seconds.`;return k.meta.queryOptions?.cacheTimeout?(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(y.I,{width:9,tooltip:te,children:"Cache timeout"}),(0,t.jsx)(U.p,{type:"text",className:"width-6",placeholder:"60",spellCheck:!1,onBlur:this.onCacheTimeoutBlur,defaultValue:se.cacheTimeout??""})]})}):null}renderQueryCachingTTLOption(){const{dataSource:k,options:se}=this.props,te="Cache time-to-live: How long results from this queries in this panel will be cached, in milliseconds. Defaults to the TTL in the caching configuration for this datasource.";return k.cachingConfig?.enabled?(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(y.I,{width:9,tooltip:te,children:"Cache TTL"}),(0,t.jsx)(U.p,{type:"number",className:"width-6",placeholder:`${k.cachingConfig.TTLMs}`,spellCheck:!1,onBlur:this.onQueryCachingTTLBlur,defaultValue:se.queryCachingTTL??void 0})]})}):null}renderMaxDataPointsOption(){const{data:k,options:se}=this.props,te=k.request?.maxDataPoints,ne=se.maxDataPoints??"",le=ne==="";return(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(y.I,{width:9,tooltip:(0,t.jsx)(t.Fragment,{children:"The maximum data points per series. Used directly by some data sources and used in calculation of auto interval. With streaming data this value is used for the rolling buffer."}),children:"Max data points"}),(0,t.jsx)(U.p,{type:"number",className:"width-6",placeholder:`${te}`,spellCheck:!1,onBlur:this.onMaxDataPointsBlur,defaultValue:ne}),le&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"gf-form-label query-segment-operator",children:"="}),(0,t.jsx)("div",{className:"gf-form-label",children:"Width of panel"})]})]})})}renderIntervalOption(){const{data:k,dataSource:se,options:te}=this.props,ne=k.request?.interval,le=se.interval??"No limit";return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(y.I,{width:9,tooltip:(0,t.jsxs)(t.Fragment,{children:["A lower limit for the interval. Recommended to be set to write frequency, for example ",(0,t.jsx)("code",{children:"1m"})," ","if your data is written every minute. Default value can be set in data source settings for most data sources."]}),children:"Min interval"}),(0,t.jsx)(U.p,{type:"text",className:"width-6",placeholder:`${le}`,spellCheck:!1,onBlur:this.onMinIntervalBlur,defaultValue:te.minInterval??""})]})}),(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(y.I,{width:9,tooltip:(0,t.jsxs)(t.Fragment,{children:["The evaluated interval that is sent to data source and is used in ",(0,t.jsx)("code",{children:"$__interval"})," and"," ",(0,t.jsx)("code",{children:"$__interval_ms"}),". This value is not exactly equal to"," ",(0,t.jsx)("code",{children:"Time range / max data points"}),", it will approximate a series of magic number."]}),children:"Interval"}),(0,t.jsx)(y.I,{width:6,children:ne}),(0,t.jsx)("div",{className:"gf-form-label query-segment-operator",children:"="}),(0,t.jsx)("div",{className:"gf-form-label",children:"Time range / max data points"})]})})]})}renderCollapsedText(k){const{data:se,options:te}=this.props,{isOpen:ne}=this.state;if(ne)return;let le=te.maxDataPoints??"";le===""&&se.request&&(le=`auto = ${se.request.maxDataPoints}`);let re=te.minInterval;return se.request&&(re=`${se.request.interval}`),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:k.collapsedText,children:["MD = ",le]}),(0,t.jsxs)("div",{className:k.collapsedText,children:["Interval = ",re]})]})}render(){const{timeRangeHide:k,relativeTimeIsValid:se,timeShiftIsValid:te}=this.state,{timeRangeFrom:ne,timeRangeShift:le,isOpen:re}=this.state,de=Q();return(0,t.jsxs)(w.u,{id:"Query options",index:0,title:"Query options",headerElement:this.renderCollapsedText(de),isOpen:re,onOpen:this.onOpenOptions,onClose:this.onCloseOptions,children:[this.renderMaxDataPointsOption(),this.renderIntervalOption(),this.renderCacheTimeoutOption(),this.renderQueryCachingTTLOption(),(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(y.I,{width:9,tooltip:(0,t.jsxs)(t.Fragment,{children:["Overrides the relative time range for individual panels, which causes them to be different than what is selected in the dashboard time picker in the top-right corner of the dashboard. For example to configure the Last 5 minutes the Relative time should be ",(0,t.jsx)("code",{children:"now-5m"})," and ",(0,t.jsx)("code",{children:"5m"}),", or variables like ",(0,t.jsx)("code",{children:"$_relativeTime"}),"."]}),children:"Relative time"}),(0,t.jsx)(U.p,{type:"text",className:"width-6",placeholder:"1h",onChange:this.onRelativeTimeChange,onBlur:this.onOverrideTime,invalid:!se,value:ne})]}),(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(y.I,{width:9,tooltip:(0,t.jsxs)(t.Fragment,{children:["Overrides the time range for individual panels by shifting its start and end relative to the time picker. For example to configure the Last 1h the Time shift should be ",(0,t.jsx)("code",{children:"now-1h"})," and"," ",(0,t.jsx)("code",{children:"1h"}),", or variables like ",(0,t.jsx)("code",{children:"$_timeShift"}),"."]}),children:"Time shift"}),(0,t.jsx)(U.p,{type:"text",className:"width-6",placeholder:"1h",onChange:this.onTimeShiftChange,onBlur:this.onTimeShift,invalid:!te,value:le})]}),(le||ne)&&(0,t.jsxs)(F.C,{children:[(0,t.jsx)(y.I,{width:9,children:"Hide time info"}),(0,t.jsx)(V.K,{value:k,onChange:this.onToggleTimeOverride})]})]})}}const N=ae=>ae?W.isValidTimeSpan(ae):!0,H=ae=>ae===""?null:ae,Q=(0,f.N)(()=>{const{theme:ae}=C.$W;return{collapsedText:(0,n.css)`
      margin-left: ${ae.spacing.md};
      font-size: ${ae.typography.size.sm};
      color: ${ae.colors.textWeak};
    `}});class X extends s.PureComponent{constructor(){super(...arguments),this.backendSrv=b.IB,this.dataSourceSrv=(0,c.l)(),this.querySubscription=null,this.state={isDataSourceModalOpen:!!h.Ny.getSearchObject().firstPanel,isLoadingHelp:!1,helpContent:null,isPickerOpen:!1,isHelpOpen:!1,queries:[],data:{state:a.Gu.NotStarted,series:[],timeRange:(0,r.E2)()}},this.onChangeDataSource=async(k,se)=>{const{dsSettings:te}=this.state,ne=te?await(0,c.l)().get(te.uid):void 0,le=await(0,c.l)().get(k.uid),re=se||await(0,j.y)(le,k.uid,this.state.queries,ne),de=await this.dataSourceSrv.get(k.name);this.onChange({queries:re,dataSource:{name:k.name,uid:k.uid,...(0,g.p$)(k)}}),this.setState({queries:re,dataSource:de,dsSettings:k}),se&&this.props.onRunQueries()},this.onAddQueryClick=()=>{const{queries:k}=this.state;this.onQueriesChange((0,T.U7)(k,this.newQuery())),this.onScrollBottom()},this.onAddExpressionClick=()=>{this.onQueriesChange((0,T.U7)(this.state.queries,M.Ex.newQuery())),this.onScrollBottom()},this.onScrollBottom=()=>{setTimeout(()=>{this.state.scrollElement&&this.state.scrollElement.scrollTo({top:1e4})},20)},this.onUpdateAndRun=k=>{this.props.onOptionsChange(k),this.props.onRunQueries()},this.onOpenHelp=()=>{this.setState({isHelpOpen:!0})},this.onCloseHelp=()=>{this.setState({isHelpOpen:!1})},this.onCloseDataSourceModal=()=>{this.setState({isDataSourceModalOpen:!1})},this.onAddQuery=k=>{const{dsSettings:se,queries:te}=this.state;this.onQueriesChange((0,T.U7)(te,k,se?(0,g.p$)(se):{type:void 0,uid:void 0})),this.onScrollBottom()},this.onQueriesChange=k=>{this.onChange({queries:k}),this.setState({queries:k})},this.setScrollRef=k=>{this.setState({scrollElement:k})}}async componentDidMount(){const{options:k,queryRunner:se}=this.props;this.querySubscription=se.getData({withTransforms:!1,withFieldConfig:!1}).subscribe({next:te=>this.onPanelDataUpdate(te)}),this.setNewQueriesAndDatasource(k)}componentWillUnmount(){this.querySubscription&&(this.querySubscription.unsubscribe(),this.querySubscription=null)}async componentDidUpdate(){const{options:k}=this.props,se=await(0,c.l)().get(k.dataSource);this.state.dataSource&&se.uid!==this.state.dataSource?.uid&&this.setNewQueriesAndDatasource(k)}async setNewQueriesAndDatasource(k){try{const se=await this.dataSourceSrv.get(k.dataSource),te=this.dataSourceSrv.getInstanceSettings(k.dataSource),ne=await this.dataSourceSrv.get(),le=se.getRef(),re=k.queries.map(de=>({...(0,T.Ih)(de)&&se?.getDefaultQuery?.(i.Jk.PanelEditor),datasource:le,...de}));this.setState({queries:re,dataSource:se,dsSettings:te,defaultDataSource:ne})}catch(se){console.error("failed to load data source",se)}}onPanelDataUpdate(k){this.setState({data:k})}newQuery(){const{dsSettings:k,defaultDataSource:se}=this.state,te=k&&!k.meta.mixed?(0,g.p$)(k):se?se.getRef():{type:void 0,uid:void 0};return{...this.state.dataSource?.getDefaultQuery?.(i.Jk.PanelEditor),datasource:te}}onChange(k){this.props.onOptionsChange({...this.props.options,...k})}renderTopSection(k){const{onOpenQueryInspector:se,options:te}=this.props,{dataSource:ne,data:le,dsSettings:re}=this.state;return!re||!ne?null:(0,t.jsx)(Z,{data:le,dataSource:ne,options:te,dsSettings:re,onOptionsChange:this.onUpdateAndRun,onDataSourceChange:this.onChangeDataSource,onOpenQueryInspector:se})}renderQueries(k){const{onRunQueries:se}=this.props,{data:te,queries:ne}=this.state;return(0,t.jsx)("div",{"aria-label":d.Tp.components.QueryTab.content,children:(0,t.jsx)(K.L,{queries:ne,dsSettings:k,onQueriesChange:this.onQueriesChange,onAddQuery:this.onAddQuery,onRunQueries:se,data:te})})}isExpressionsSupported(k){return(k.meta.alerting||k.meta.mixed)===!0}renderExtraActions(){return A.m.getAllExtraRenderAction().map((k,se)=>k({onAddQuery:this.onAddQuery,onChangeDataSource:this.onChangeDataSource,key:se})).filter(Boolean)}renderAddQueryRow(k,se){const te=!(0,L.kN)(k.name);return(0,t.jsxs)(o.Gy,{spacing:"md",align:"flex-start",children:[te&&(0,t.jsx)(m.$n,{icon:"plus",onClick:this.onAddQueryClick,variant:"secondary","data-testid":d.Tp.components.QueryTab.addQuery,children:"Add query"}),C.Ay.expressionsEnabled&&this.isExpressionsSupported(k)&&(0,t.jsx)(m.$n,{icon:"plus",onClick:this.onAddExpressionClick,variant:"secondary",className:se.expressionButton,"data-testid":"query-tab-add-expression",children:(0,t.jsx)("span",{children:"Expression\xA0"})}),this.renderExtraActions()]})}render(){const{isHelpOpen:k,dsSettings:se}=this.state,te=ee();return(0,t.jsx)(u.E,{autoHeightMin:"100%",scrollRefCallback:this.setScrollRef,children:(0,t.jsxs)("div",{className:te.innerWrapper,children:[this.renderTopSection(te),se&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:te.queriesWrapper,children:this.renderQueries(se)}),this.renderAddQueryRow(se,te),k&&(0,t.jsx)(p.a,{title:"Data source help",isOpen:!0,onDismiss:this.onCloseHelp,children:(0,t.jsx)(D,{pluginId:se.meta.id})})]})]})})}}const ee=(0,f.N)(()=>{const{theme:ae}=C.Ay;return{innerWrapper:(0,n.css)`
      display: flex;
      flex-direction: column;
      padding: ${ae.spacing.md};
    `,dataSourceRow:(0,n.css)`
      display: flex;
      margin-bottom: ${ae.spacing.md};
    `,dataSourceRowItem:(0,n.css)`
      margin-right: ${ae.spacing.inlineFormMargin};
    `,dataSourceRowItemOptions:(0,n.css)`
      flex-grow: 1;
      margin-right: ${ae.spacing.inlineFormMargin};
    `,queriesWrapper:(0,n.css)`
      padding-bottom: 16px;
    `,expressionWrapper:(0,n.css)``,expressionButton:(0,n.css)`
      margin-right: ${ae.spacing.sm};
    `}});function Z({dataSource:ae,options:k,data:se,dsSettings:te,onDataSourceChange:ne,onOptionsChange:le,onOpenQueryInspector:re}){const de=ee(),[oe,J]=(0,s.useState)(!1);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{"data-testid":d.Tp.components.QueryTab.queryGroupTopSection,children:[(0,t.jsxs)("div",{className:de.dataSourceRow,children:[(0,t.jsx)(y.I,{htmlFor:"data-source-picker",width:"auto",children:"Data source"}),(0,t.jsx)("div",{className:de.dataSourceRowItem,children:(0,t.jsx)(q,{options:k,onChange:async(ce,pe)=>await ne?.(ce,pe),isDataSourceModalOpen:!!h.Ny.getSearchObject().firstPanel})}),ae&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:de.dataSourceRowItem,children:(0,t.jsx)(m.$n,{variant:"secondary",icon:"question-circle",title:"Open data source help",onClick:()=>J(!0),"data-testid":"query-tab-help-button"})}),(0,t.jsx)("div",{className:de.dataSourceRowItemOptions,children:(0,t.jsx)(z,{options:k,dataSource:ae,data:se,onChange:ce=>{le?.(ce)}})}),re&&(0,t.jsx)("div",{className:de.dataSourceRowItem,children:(0,t.jsx)(m.$n,{variant:"secondary",onClick:re,"aria-label":d.Tp.components.QueryTab.queryInspectorButton,children:"Query inspector"})})]})]}),ae&&(0,B.Hv)(ae.uid)&&(0,t.jsx)(I.c,{pluginId:ae.type,pluginType:l.QE.datasource,angularSupportEnabled:C.Ay?.angularSupportEnabled,showPluginDetailsLink:!0,interactionElementId:"datasource-query"})]}),oe&&(0,t.jsx)(p.a,{title:"Data source help",isOpen:!0,onDismiss:()=>J(!1),children:(0,t.jsx)(D,{pluginId:te.meta.id})})]})}function q({options:ae,onChange:k,...se}){const[te,ne]=(0,s.useState)(!!se.isDataSourceModalOpen);(0,s.useEffect)(()=>{h.Ny.getSearchObject().firstPanel&&h.Ny.partial({firstPanel:null},!0)},[]);const le={metrics:!0,mixed:!0,dashboard:!0,variables:!0,current:ae.dataSource,uploadFile:!0,onChange:async(re,de)=>{await k(re,de),ne(!1)}};return(0,t.jsxs)(t.Fragment,{children:[te&&(0,t.jsx)(S.p,{...le,onDismiss:()=>ne(!1)}),(0,t.jsx)(O.s,{...le})]})}},42972:(G,R,e)=>{"use strict";e.d(R,{nm:()=>te,Dh:()=>ae});var t=e(39741),n=e(13752),s=e(64423),a=e(44240),r=e(39697),g=e(81160),i=e(67791),l=e(93031),d=e(71030),c=e(69850),h=e(1005),o=e(65961),m=e(3591),u=e(2543);function p(ne){let le=[];const re=(0,u.partition)(ne,"id"),de=(0,u.groupBy)(re[0],"id");return le=(0,u.map)(de,oe=>oe.length>1&&!(0,u.every)(oe,f)?(0,u.find)(oe,J=>J.eventType!=="panel-alert"):(0,u.head)(oe)),le=(0,u.concat)(le,re[1]),le}function f(ne){return ne.eventType==="panel-alert"}var y=e(74856),x=e(62467),v=e(65474),P=e(66847),E=e(69862),D=e(16126),C=e(32264),b=e(19347),T=e(90569),S=e(28444),O=e(27302),M=e(7436);class I{canRun(le){return le?!!(!le.annotationQuery||le.annotations):!1}run({annotation:le,datasource:re,dashboard:de,range:oe}){if(!this.canRun(re))return(0,x.of)([]);const J={};return(0,O.b)({dashboard:de,range:oe,panel:J},re,le).pipe((0,g.T)(ce=>ce.events??[]),(0,P.W)(M.SD))}}var L=e(42493);class B{canRun(le){return le?(0,L.E7)(le)?!0:!!(le.annotationQuery&&!le.annotations):!1}run({annotation:le,datasource:re,dashboard:de,range:oe}){return this.canRun(re)?(0,v.H)(re.annotationQuery({range:oe,rangeRaw:oe.raw,annotation:le,dashboard:de})).pipe((0,P.W)(M.SD)):(0,x.of)([])}}class j{constructor(le=[new B,new I]){this.runners=le}canWork({dashboard:le}){return!!le.annotations.list.find(j.getAnnotationsToProcessFilter)}work(le){if(!this.canWork(le))return(0,M.$)();const{dashboard:re,range:de}=le;let oe=re.annotations.list.filter(j.getAnnotationsToProcessFilter);C.$.publicDashboardAccessToken&&oe.length>0&&(oe=[oe[0]]);const J=oe.map(ce=>{let pe;if(C.$.publicDashboardAccessToken){const xe=new T.X;pe=(0,x.of)(xe).pipe((0,P.W)(M.H0))}else pe=(0,v.H)((0,b.l)().get(ce.datasource)).pipe((0,P.W)(M.H0));return pe.pipe((0,E.Z)(xe=>{const fe=this.runners.find(Ee=>Ee.canRun(xe));return fe?(re.events.publish(new S.xc(ce)),fe.run({annotation:ce,datasource:xe,dashboard:re,range:de}).pipe((0,i.Q)(ae().cancellations().pipe((0,D.p)(Ee=>Ee===ce))),(0,g.T)(Ee=>(re.snapshot&&(ce.snapshotData=(0,u.cloneDeep)(Ee)),C.$.publicDashboardAccessToken?Ee:(0,M.G9)(ce,Ee))),(0,c.j)(()=>{re.events.publish(new S.yj(ce))}))):(0,x.of)([])}))});return(0,a.h)(J).pipe((0,l.U)(),(0,d.T)((ce,pe)=>ce.concat(pe)),(0,g.T)(ce=>({annotations:ce,alertStates:[]})))}static getAnnotationsToProcessFilter(le){return le.enable&&!le.snapshotData}}var A=e(85595),K=e(43585),W=e(16233),U=e(79938),F=e(49498),V=e(55740),w=e(57220),z=e(23662),N=e(91309),H=e(99140),Q=e(31678);class X{constructor(){this.hasAlertRules={}}canWork({dashboard:le,range:re}){return!(!le.uid||C.$.publicDashboardAccessToken||re.raw.to!=="now"||this.hasAlertRules[le.uid]===!1||!(W.TP.hasPermission(Q.AccessControlAction.AlertingRuleRead)&&W.TP.hasPermission(Q.AccessControlAction.AlertingRuleExternalRead)))}work(le){if(!this.canWork(le))return(0,M.$)();const{dashboard:re}=le,de=async()=>(await(0,H.JD)(U.hK.endpoints.prometheusRuleNamespaces.initiate({ruleSourceName:w.hY,dashboardUid:re.uid}))).data;return(0,v.H)(de()).pipe((0,g.T)(J=>(0,F.Kw)(J))).pipe((0,g.T)(J=>{this.hasAlertRules[re.uid]=!1;const ce={};return J.forEach(pe=>pe.rules.forEach(xe=>{if((0,z.Z8)(xe)&&xe.annotations&&xe.annotations[V.YH.panelID]){this.hasAlertRules[re.uid]=!0;const fe=Number(xe.annotations[V.YH.panelID]),Ee=(0,N.S)(xe.state);ce[fe]?Ee===K.O.Alerting&&ce[fe].state!==K.O.Alerting?ce[fe].state=K.O.Alerting:Ee===K.O.Pending&&ce[fe].state!==K.O.Alerting&&ce[fe].state!==K.O.Pending&&(ce[fe].state=K.O.Pending):ce[fe]={state:Ee,id:Object.keys(ce).length,panelId:fe,dashboardId:re.id}}})),{alertStates:Object.values(ce),annotations:[]}}),(0,P.W)(M.Zr))}}class ee{constructor(le,re=(0,y.jG)(),de=[new X,new A.F,new j]){this.dashboard=le,this.timeSrv=re,this.workers=de,this.run=this.run.bind(this),this.getResult=this.getResult.bind(this),this.cancel=this.cancel.bind(this),this.destroy=this.destroy.bind(this),this.executeRun=this.executeRun.bind(this),this.results=new t.m(1),this.runs=new n.B,this.cancellationStream=new n.B,this.runsSubscription=this.runs.subscribe(oe=>this.executeRun(oe)),this.eventsSubscription=le.events.subscribe(m._,oe=>{this.run({dashboard:this.dashboard,range:this.timeSrv.timeRange()})})}run(le){this.runs.next(le)}getResult(le){return this.results.asObservable().pipe((0,g.T)(re=>{const de=(0,M.FK)(re.annotations,le),oe=re.alertStates.find(J=>!!le&&J.panelId===le);return{annotations:p(de),alertState:oe}}))}executeRun(le){const de=this.workers.filter(xe=>xe.canWork(le)).map(xe=>xe.work(le)),oe=new s.yU,J=(0,a.h)(de).pipe((0,i.Q)(this.runs.asObservable()),(0,l.U)(),(0,d.T)((xe,fe)=>(xe.annotations=xe.annotations.concat(fe.annotations),xe.alertStates=xe.alertStates.concat(fe.alertStates),xe)),(0,c.j)(()=>{oe.unsubscribe()}),(0,h.u)()),ce=new s.yU,pe=(0,r.O)(200).pipe((0,o.u)({annotations:[],alertStates:[]}),(0,i.Q)(J),(0,c.j)(()=>{ce.unsubscribe()}));ce.add(pe.subscribe(xe=>{this.results.next(xe)})),oe.add(J.subscribe(xe=>{this.results.next(xe)}))}cancel(le){this.cancellationStream.next(le)}cancellations(){return this.cancellationStream.asObservable().pipe((0,h.u)())}destroy(){this.results.complete(),this.runs.complete(),this.cancellationStream.complete(),this.runsSubscription.unsubscribe(),this.eventsSubscription.unsubscribe()}}let Z;function q(ne){Z&&Z.destroy(),Z=ne}function ae(){if(!Z)throw new Error("getDashboardQueryRunner can only be used after Grafana instance has started.");return Z}let k;function se(ne){k=ne}function te(ne){k||(k=({dashboard:re,timeSrv:de,workers:oe})=>new ee(re,de,oe));const le=k(ne);return q(le),le}},90569:(G,R,e)=>{"use strict";e.d(R,{X:()=>c});var t=e(62467),n=e(65474),s=e(40187),a=e(14236),r=e(17172),g=e(32264),i=e(57220),l=e(68706);const d="-- Public --";class c extends s.mA{constructor(){let o={};super({name:"public-ds",id:0,type:"public-ds",meta:o,uid:d,jsonData:{},access:"proxy",readOnly:!0}),this.annotations={prepareQuery(m){return{...m,queryType:l.nj.Annotations,refId:"anno"}}}}query(o){return o.targets.length?o.targets[0]?.datasource?.uid===i.vv?(0,n.H)(this.getAnnotations(o)):(0,t.of)({data:[]}):(0,t.of)({data:[]})}async getAnnotations(o){const{range:{to:m,from:u}}=o,p={from:u.valueOf(),to:m.valueOf()},f=await(0,r.AI)().get(`/api/public/dashboards/${g.$.publicDashboardAccessToken}/annotations`,p);return{data:[(0,a.Vc)(f)]}}testDatasource(){return Promise.resolve({message:"",status:""})}}},85595:(G,R,e)=>{"use strict";e.d(R,{F:()=>s});var t=e(62467),n=e(7436);class s{canWork({dashboard:r}){return r?.annotations?.list?.some(g=>g.enable&&!!g.snapshotData)}work(r){if(!this.canWork(r))return(0,n.$)();const g=this.getAnnotationsFromSnapshot(r.dashboard);return(0,t.of)({annotations:g,alertStates:[]})}getAnnotationsFromSnapshot(r){return(r?.annotations?.list?.filter(d=>d.enable)).filter(d=>!!d.snapshotData).reduce((d,c)=>d.concat((0,n.G9)(c,c.snapshotData)),[])}getAnnotationsInSnapshot(r,g){const i=this.getAnnotationsFromSnapshot(r);return(0,n.FK)(i,g)}}},7436:(G,R,e)=>{"use strict";e.d(R,{$:()=>o,FK:()=>p,G9:()=>f,H:()=>y,H0:()=>h,SD:()=>c,Zr:()=>m});var t=e(2543),n=e.n(t),s=e(62467),a=e(78368),r=e(12091),g=e(32264),i=e(99140),l=e(3169),d=e(16001);function c(x){return x.cancelled?(0,s.of)([]):(u("AnnotationQueryRunner failed",x),(0,s.of)([]))}function h(x){return u("Failed to retrieve datasource",x),(0,s.of)(void 0)}const o=()=>(0,s.of)({annotations:[],alertStates:[]});function m(x){return x.cancelled||u("DashboardQueryRunner failed",x),o()}function u(x,v){const P=(0,r.u)(v);console.error("handleAnnotationQueryRunnerError",P);const E=(0,l.gi)(x,P.message);(0,i.JD)((0,d.dx)(E))}function p(x,v){return v==null?x:x.filter(P=>{let E;if(E=P.source,!E)return!0;if(E.filter){const D=(E.filter.ids??[]).includes(v);if(E.filter.exclude){if(D)return!1}else if(!D)return!1}return P.panelId&&P.source.type==="dashboard"?P.panelId===v:!0})}function f(x,v){x.snapshotData&&(x=(0,t.cloneDeep)(x),delete x.snapshotData);for(const P of v)switch(P.source=x,P.color=g.$.theme2.visualization.getColorByName(x.iconColor),P.type=x.name,P.isRegion=!!(P.timeEnd&&P.time!==P.timeEnd),P.newState?.toLowerCase()){case"pending":P.color="yellow";break;case"alerting":P.color="red";break;case"ok":P.color="green";break;case"normal":P.color="green";break;case"no_data":P.color="gray";break;case"nodata":P.color="gray";break}return v}function y(x){if(!x||!x.length)return[];const v=[];for(const P of x){const E=new a.R(P);for(let D=0;D<P.length;D++){const C=(0,t.cloneDeep)(E.get(D));v.push(C)}}return v}},80924:(G,R,e)=>{"use strict";e.d(R,{Z:()=>L,S:()=>I});var t=e(2543),n=e(39741),s=e(62467),a=e(69862),r=e(81160),g=e(66847),i=e(39070),l=e(14236),d=e(43127),c=e(90708),h=e(21423),o=e(52622),m=e(2514),u=e(41987),p=e(65879),f=e(12091),y=e(26657),x=e(47118),v=e(31193),P=e(23989),E=e(14348),D=e(42972),C=e(49510),b=e(33948);function T(j=[]){j.forEach(A=>{A.meta={...A.meta,dataTopic:o.QR.Annotations}})}function S(j,A){return(0,C.z)([j,A]).pipe((0,a.Z)(K=>{const[W,U]=K;if(U.annotations?.length||U.alertState){W.annotations||(W.annotations=[]);const F=W.annotations.concat((0,b.I)(U.annotations));T(F);const V=U.alertState;return(0,s.of)({...W,annotations:F,alertState:V})}return T(W.annotations),(0,s.of)(W)}))}var O=e(39374);let M=100;function I(){return"Q"+M++}class L{constructor(A){this.templateSrv=(0,P.w)(),this.resendLastResult=()=>{this.lastResult&&this.subject.next(this.lastResult)},this.subject=new n.m(1),this.dataConfigSource=A}getData(A){const{withFieldConfig:K,withTransforms:W}=A;let U=1,F,V=[],w=[],z,N=!0,H=-1;if(this.dataConfigSource.snapshotData){const Q={state:i.Gu.Done,series:this.dataConfigSource.snapshotData.map(X=>(0,l.Vc)(X)),timeRange:(0,d.E2)(),structureRev:U};return(0,s.of)(Q)}return this.subject.pipe((0,a.Z)(Q=>{let X=this.dataConfigSource.getFieldOverrideOptions(),ee=this.dataConfigSource.getTransformations();if(Q.series===w&&F?.fieldConfig===X?.fieldConfig&&z===ee)return(0,s.of)({...Q,structureRev:U,series:V});F=X,z=ee,w=Q.series;let Z=(0,s.of)(Q);return W&&(Z=this.applyTransformations(Q)),Z.pipe((0,r.T)(q=>{let ae=q,k=!1;if(K&&q.series?.length){if(H===this.dataConfigSource.configRev){let se;for(const te of q.series)if((0,x.o$)(te)){se=te;break}se&&!se.packetInfo.schemaChanged&&V[0].fields.length===se.fields.length&&(ae={...ae,series:V.map((te,ne)=>({...te,length:q.series[ne].length,fields:te.fields.map((le,re)=>({...le,values:q.series[ne].fields[re].values,state:{...le.state,calcs:void 0,range:void 0}}))}))},k=!0)}X!=null&&(N||!k)&&(H=this.dataConfigSource.configRev,ae={...ae,series:(0,c.we)({timeZone:q.request?.timezone??"browser",data:ae.series,...X})},ae.annotations&&(ae.annotations=(0,c.we)({data:ae.annotations,...X,fieldConfig:{defaults:{},overrides:[]}})),N=!1)}return!k&&!(0,h.J3)(V,ae.series,h.bW)&&U++,V=ae.series,{...ae,structureRev:U}}))}))}applyTransformations(A){const K=this.dataConfigSource.getTransformations();if(K&&K.every(N=>N.disabled)||!K||K.length===0)return(0,s.of)(A);const U={interpolate:N=>this.templateSrv.replace(N,A?.request?.scopedVars)};let F=K.filter(N=>N.topic==null||N.topic===o.QR.Series),V=K.filter(N=>N.topic===o.QR.Annotations),w=(0,m.m)(F,A.series,U),z=(0,m.m)(V,A.annotations??[],U);return(0,t.merge)(w,z).pipe((0,r.T)(N=>{let Q=N.some(X=>X.meta?.dataTopic===o.QR.Annotations)?{annotations:N}:{series:N};return{...A,...Q}}),(0,g.W)(N=>(console.warn("Error running transformation:",N),(0,s.of)({...A,state:i.Gu.Error,errors:[(0,f.u)(N)]}))))}async run(A){const{queries:K,timezone:W,datasource:U,panelId:F,panelPluginId:V,dashboardUID:w,timeRange:z,timeInfo:N,cacheTimeout:H,queryCachingTTL:Q,maxDataPoints:X,scopedVars:ee,minInterval:Z,app:q}=A;if((0,E.kN)(U)){this.pipeToSubject((0,E.mw)(A,K[0]),F,!0);return}const ae=this.shouldAddErrorWhenDatasourceVariableIsMultiple(U,ee),k={app:q??u.Jk.Dashboard,requestId:I(),timezone:W,panelId:F,panelPluginId:V,dashboardUID:w,range:z,timeInfo:N,interval:"",intervalMs:0,targets:(0,t.cloneDeep)(K),maxDataPoints:X,scopedVars:ee||{},cacheTimeout:H,queryCachingTTL:Q,startTime:Date.now(),rangeRaw:z.raw};try{const se=await B(U,k.scopedVars),te=se.meta?.mixed;k.targets=k.targets.map(re=>{const de=re.datasource?.type===y.dR.type;return(!re.datasource||re.datasource.uid!==se.uid&&!te&&!de)&&(re.datasource=se.getRef()),re});const ne=Z?this.templateSrv.replace(Z,k.scopedVars):se.interval,le=p.calculateInterval(z,X,ne);k.scopedVars=Object.assign({},k.scopedVars,{__interval:{text:le.interval,value:le.interval},__interval_ms:{text:le.intervalMs.toString(),value:le.intervalMs}}),k.interval=le.interval,k.intervalMs=le.intervalMs,k.filters=this.templateSrv.getAdhocFilters(se.name,!0),this.lastRequest=k,this.pipeToSubject((0,O.BN)(se,k),F,!1,ae)}catch(se){this.pipeToSubject((0,s.of)({state:i.Gu.Error,error:(0,f.u)(se),series:[],timeRange:k.range}),F)}}pipeToSubject(A,K,W=!1,U=!1){this.subscription&&this.subscription.unsubscribe();let F=A;const V=this.dataConfigSource.getDataSupport();if(V.alertStates||V.annotations){const w=this.dataConfigSource;F=S(A,(0,D.Dh)().getResult(w.id))}this.subscription=F.subscribe({next:w=>{const z=this.lastResult,N=W?w:(0,l.N$)(w,z);if(z!=null&&N.state!==i.Gu.Streaming){let H=(0,h.J3)(z.series??[],N.series??[],(ee,Z)=>ee===Z),Q=(0,h.J3)(z.annotations??[],N.annotations??[],(ee,Z)=>ee===Z),X=z.state===N.state;if(H&&(N.series=z.series),Q&&(N.annotations=z.annotations),H&&Q&&X)return}this.lastResult=N,U&&(N.errors=[{message:"Panel is using a variable datasource with multiple values without repeat option. Please configure the panel to be repeated by the same datasource variable."}],N.state=i.Gu.Error),this.subject.next(N)}})}cancelQuery(){this.subscription&&(this.subscription.unsubscribe(),this.lastResult&&(this.lastResult.state===i.Gu.Loading||this.lastResult.state===i.Gu.Streaming)&&this.subject.next({...this.lastResult,state:i.Gu.Done}))}clearLastResult(){this.lastResult=void 0,this.subject=new n.m(1)}destroy(){this.subject&&this.subject.complete(),this.subscription&&this.subscription.unsubscribe()}useLastResultFrom(A){this.lastResult=A.getLastResult(),this.lastResult&&this.subject.next(this.lastResult)}setLastResult(A){this.lastResult=A}getLastResult(){return this.lastResult}getLastRequest(){return this.lastRequest}shouldAddErrorWhenDatasourceVariableIsMultiple(A,K){let W=!1;return A?.uid?.startsWith("${")&&this.templateSrv.replace(A.uid,K,U=>(Array.isArray(U)&&U.length>1&&(W=!0),"")),W}}async function B(j,A){return j&&typeof j=="object"&&"query"in j?j:await(0,v.tR)().get(j,A)}},81583:(G,R,e)=>{"use strict";e.d(R,{N:()=>n});var t=e(69850);function n(s,a){return(0,t.j)(()=>{a&&s.resolveCancelerIfExists(a)})}},72955:(G,R,e)=>{"use strict";e.d(R,{B:()=>n});var t=e(21423);const n=(s,a)=>{let r=1;return a?.structureRev&&a.series&&(r=a.structureRev,(0,t.J3)(s.series,a.series,t.bW)||r++),s.structureRev=r,s}},39374:(G,R,e)=>{"use strict";e.d(R,{BN:()=>A});var t=e(2543),n=e(62467),s=e(44240),a=e(39697),r=e(65474),g=e(81160),i=e(66847),l=e(59099),d=e(1005),c=e(65961),h=e(67791),o=e(39070),m=e(52622),u=e(85858),p=e(41987),f=e(12091),y=e(32264),x=e(26657),v=e(27677),P=e(21969),E=e(53478),D=e(34867);const C=(0,D.DW)("features.query");var b=e(81583),T=e(76885),S=e(61298),O=e(14110),M=e(14792);function I(W){let U=!1;return V=>{if(!V.request||U||T.kM.getUrlSearchParams().editPanel!=null||V.state!==o.Gu.Done&&V.state!==o.Gu.Error)return;const z={eventName:S.n_.DataRequest,source:V.request.app,datasourceName:W.name,datasourceId:W.id,datasourceUid:W.uid,datasourceType:W.type,dataSize:0,panelId:0,panelPluginId:V.request?.panelPluginId,duration:V.request.endTime-V.request.startTime};F(z,V),V.request.app!==p.Jk.Explore&&V.request.app!==p.Jk.Correlations&&L(z,V),V.series&&V.series.length>0&&(z.dataSize=V.series.length),(0,O.G$)(z),U=!0};function F(V,w){const z={};for(let H=0;H<w.series.length;H++){const Q=w.series[H].refId;Q&&!z[Q]&&(z[Q]=w.series[H].meta?.isCachedResponse??!1)}V.totalQueries=Object.keys(z).length,V.cachedQueries=Object.values(z).filter(H=>H===!0).length,w.request&&Number.isInteger(w.request.panelId)&&(V.panelId=w.request.panelId);const N=(0,M.UA)().getCurrent();N&&(V.dashboardId=N.id,V.dashboardName=N.title,V.dashboardUid=N.uid,V.folderName=N.meta.folderTitle)}}function L(W,U){U.errors?.length?W.error=U.errors.join(", "):U.error&&(W.error=U.error.message)}function B(W,U){const F=U.panelData.request,V={...U.packets},w=W.key??W.data?.[0]?.refId??"A";V[w]=W;let z=W.state||o.Gu.Done,N,H;const Q=[],X=[];for(const ae in V){const k=V[ae];if((k.error||k.errors?.length)&&(z=o.Gu.Error,N=k.error,H=k.errors),k.data&&k.data.length)for(const se of k.data){if(se.meta?.dataTopic===m.QR.Annotations){X.push(se);continue}Q.push(se)}}const ee=j(F,z),Z={state:z,series:Q,annotations:X,error:N,errors:H,request:F,timeRange:ee},q=new Set([...U.panelData.traceIds??[],...W.traceIds??[]]);return q.size>0&&(Z.traceIds=Array.from(q)),{packets:V,panelData:Z}}function j(W,U){const F=W.range;return!(0,t.isString)(F.raw.from)||U!==o.Gu.Streaming?F:{...F,from:u.parse(F.raw.from,!1),to:u.parse(F.raw.to,!0)}}function A(W,U,F){let V={panelData:{state:o.Gu.Loading,series:[],request:U,timeRange:U.range},packets:{}};if(!U.targets.length)return U.endTime=Date.now(),V.panelData.state=o.Gu.Done,(0,n.of)(V.panelData);const w=K(W,U,F).pipe((0,g.T)(z=>{if(!(0,t.map)(z.data))throw new Error(`Expected response data to be array, got ${typeof z.data}.`);const N=U.targets.filter(H=>H.hide);for(const H of N)z.data=z.data.filter(Q=>Q.refId!==H.refId);return U.endTime=Date.now(),V=B(z,V),V.panelData}),(0,i.W)(z=>(console.error("runRequest.catchError",z),C.logError(z),(0,n.of)({...V.panelData,state:o.Gu.Error,error:(0,f.u)(z)}))),(0,l.M)(I(W)),(0,b.N)(v.IB,U.requestId),(0,d.u)());return(0,s.h)((0,a.O)(200).pipe((0,c.u)(V.panelData),(0,h.Q)(w)),w)}function K(W,U,F){if(U.targets=U.targets.map(w=>(0,P.Ih)(w)?{...W?.getDefaultQuery?.(p.Jk.PanelEditor),...w}:w),y.$.publicDashboardAccessToken)return(0,r.H)(W.query(U));for(const w of U.targets)if((0,x.s9)(w.datasource))return E.Ex.query(U);if(F||(U.targets=U.targets.filter(w=>W.filterQuery?.(w)??!0)),U.targets.length===0)return(0,n.of)({data:[]});const V=F?F(U):W.query(U);return(0,r.H)(V)}},93117:(G,R,e)=>{"use strict";e.d(R,{y:()=>g});var t=e(41987),n=e(73372),s=e(77789),a=e(72574),r=e(26657);async function g(i,l,d,c){let h=d;const o={...i.getRef(),uid:l},m={...i?.getDefaultQuery?.(t.Jk.PanelEditor),datasource:o,refId:"A"};if(c?.meta.id!==i.meta.id){if(i.meta.mixed)return d;if((0,n.Ee)(c)&&(0,n.FL)(i)){const u=await c.exportToAbstractQueries(d);h=await i.importFromAbstractQueries(u)}else if(c&&i.importQueries)h=await i.importQueries(d,c);else{if(c){const u=(0,a.w)(),p=[];let f=i.uid;const y=u.containsTemplate(l);y&&(f=u.replace(i.uid));const x=d.reduce((v,P)=>{if(P.datasource){let E=P.datasource.uid;const D=u.containsTemplate(E);if(D&&(E=u.replace(P.datasource.uid)),E===f&&D===y)return P.refId=(0,s.M)(v),v.concat([P])}return v},p);if(x.length>0)return x}return[m]}}return h.length===0?[m]:h.map(u=>(!(0,r.s9)(u.datasource)&&!i.meta.mixed&&(u.datasource=o),u))}},53001:(G,R,e)=>{"use strict";e.d(R,{T3:()=>Ne,mN:()=>tt,Dh:()=>ot,DF:()=>nt,F_:()=>Be,sq:()=>Pe,fX:()=>gt});var t=e(32264),n=e(84537),s=e(74848),a=e(32196),r=e(2543),g=e(40845),i=e(39558),l=e(40276),d=e(55852),c=e(8484),h=e(54625),o=e(76885),m=e(14578),u=e(83277);function p({dashboard:He}){const et=(0,g.of)(f),[rt]=(0,u.s)();return(0,s.jsxs)(h.Link,{to:o.kM.renderUrl(`/d/${He.dashboard}/`,rt),className:et.container,"data-testid":`scopes-dashboards-${He.dashboard}`,role:"treeitem",children:[(0,s.jsx)(m.I,{name:"apps",className:et.icon})," ",He.dashboardTitle]},He.dashboard)}const f=He=>({container:(0,a.css)({display:"flex",alignItems:"flex-start",gap:He.spacing(1),padding:He.spacing(.5,0),textAlign:"left",wordBreak:"break-word","&:last-child":(0,a.css)({paddingBottom:0})}),icon:(0,a.css)({marginTop:He.spacing(.25)})});function y({folder:He,folderPath:et,folders:rt,onFolderUpdate:ht}){const ft=(0,g.of)(x);return(0,s.jsxs)("div",{className:ft.container,role:"treeitem","aria-selected":He.isExpanded,children:[(0,s.jsxs)("button",{className:ft.expand,"data-testid":`scopes-dashboards-${He.title}-expand`,"aria-label":He.isExpanded?(0,c.t)("scopes.dashboards.collapse","Collapse"):(0,c.t)("scopes.dashboards.expand","Expand"),onClick:()=>{ht(et,!He.isExpanded)},children:[(0,s.jsx)(m.I,{name:He.isExpanded?"angle-down":"angle-right",className:ft.icon}),He.title]}),He.isExpanded&&(0,s.jsx)("div",{className:ft.children,children:(0,s.jsx)(v,{folders:rt,folderPath:et,onFolderUpdate:ht})})]})}const x=He=>({container:(0,a.css)({display:"flex",flexDirection:"column",padding:He.spacing(.5,0)}),expand:(0,a.css)({alignItems:"flex-start",background:"none",border:0,display:"flex",gap:He.spacing(1),margin:0,padding:0,textAlign:"left",wordBreak:"break-word"}),icon:(0,a.css)({marginTop:He.spacing(.25)}),children:(0,a.css)({paddingLeft:He.spacing(4)})});function v({folders:He,folderPath:et,onFolderUpdate:rt}){const ht=et[et.length-1],ft=He[ht];return(0,s.jsxs)("div",{role:"tree",children:[Object.entries(ft.folders).map(([De,Te])=>(0,s.jsx)(y,{folder:Te,folders:ft.folders,folderPath:[...et,De],onFolderUpdate:rt},De)),Object.values(ft.dashboards).map(De=>(0,s.jsx)(p,{dashboard:De},De.dashboard))]})}var P=e(96540),E=e(40996),D=e(67647);function C({disabled:He,query:et,onChange:rt}){const ht=(0,g.of)(b),[ft,De]=(0,P.useState)({value:et,isDirty:!1}),[Te]=(0,E.A)(()=>{ft.isDirty&&rt(ft.value)},500,[ft.isDirty,ft.value]);return(0,P.useEffect)(()=>{(Te()||!ft.isDirty)&&ft.value!==et&&De({value:et,isDirty:!1})},[Te,ft,et]),(0,s.jsx)("div",{className:ht.container,children:(0,s.jsx)(D.Z,{disabled:He,placeholder:(0,c.t)("scopes.dashboards.search","Search"),value:ft.value,"data-testid":"scopes-dashboards-search",onChange:Oe=>De({value:Oe,isDirty:!0})})})}const b=He=>({container:(0,a.css)({flex:"0 1 auto"})});var T=e(17172),S=e(2468),O=(He=>(He[He.Persisted=0]="Persisted",He[He.Result=1]="Result",He))(O||{});function M(He){return{metadata:{name:He},spec:{filters:[],title:He,type:"",category:"",description:""}}}function I(He,et){return{...He,metadata:{...He.metadata,...et.metadata},spec:{...He.spec,...et.spec}}}function L(He){return He.map(({scope:et,path:rt})=>({scopeName:et.metadata.name,path:rt}))}function B(He){return He.map(({scope:et})=>et)}function j(He){return He.map(({scope:et})=>et.metadata.name)}function A(He){return He.reduce((et,rt)=>{const ht=et[""],ft=rt.status.groups??[];return ft.forEach(Te=>{Te&&!ht.folders[Te]&&(ht.folders[Te]={title:Te,isExpanded:!1,folders:{},dashboards:{}})}),(ft.length>0?ft.map(Te=>Te===""?ht.dashboards:ht.folders[Te].dashboards):[ht.dashboards]).forEach(Te=>{Te[rt.spec.dashboard]||(Te[rt.spec.dashboard]={dashboard:rt.spec.dashboard,dashboardTitle:rt.status.dashboardTitle,items:[]}),Te[rt.spec.dashboard].items.push(rt)}),et},{"":{title:"",isExpanded:!0,folders:{},dashboards:{}}})}function K(He,et){return et=(et??"").toLowerCase(),Object.entries(He).reduce((rt,[ht,ft])=>{if(ft.title.toLowerCase().includes(et))return rt[ht]={...ft,isExpanded:!0},rt;const De=K(ft.folders,et),Te=Object.entries(ft.dashboards).filter(([Oe,Ye])=>Ye.dashboardTitle.toLowerCase().includes(et));return(Object.keys(De).length>0||Te.length>0)&&(rt[ht]={...ft,isExpanded:!0,folders:De,dashboards:Object.fromEntries(Te)}),rt},{})}const W="scope.grafana.app",U="v0alpha1",F=t.$.namespace??"default",V=`/apis/${W}/${U}/namespaces/${F}/find/scope_node_children`,w=`/apis/${W}/${U}/namespaces/${F}/find/scope_dashboard_bindings`,z=new S.w({group:W,version:U,resource:"scopes"}),N=new Map;async function H(He,et){try{return(await(0,T.AI)().get(V,{parent:He,query:et}))?.items??[]}catch{return[]}}async function Q(He,et){return(await H(He,et)).reduce((rt,{metadata:{name:ht},spec:ft})=>(rt[ht]={name:ht,...ft,isExpandable:ft.nodeType==="container",isSelectable:ft.linkType==="scope",isExpanded:!1,query:"",reason:O.Result,nodes:{}},rt),{})}async function X(He){if(N.has(He))return N.get(He);const et=new Promise(async rt=>{const ht=M(He);try{const ft=await z.get(He),De=I(ht,ft);rt(De)}catch{N.delete(He),rt(ht)}});return N.set(He,et),et}async function ee(He){return await Promise.all(He.map(X))}async function Z(He){return(await ee(He.map(({scopeName:rt})=>rt))).reduce((rt,ht,ft)=>(rt.push({scope:ht,path:He[ft].path}),rt),[])}async function q(He){try{return(await(0,T.AI)().get(w,{scope:He}))?.items??[]}catch{return[]}}const ae="grafana.scopes.dashboards.opened",k=()=>({dashboards:[],folders:{},filteredFolders:{},forScopeNames:[],isLoading:!1,isPanelOpened:localStorage.getItem(ae)==="true",isEnabled:!1,scopesSelected:!1,searchQuery:""});class se extends n.Bs{static{this.Component=te}constructor(){super({selector:null,...k()}),this.addActivationHandler(()=>{this.state.isEnabled&&this.state.isPanelOpened&&this.fetchDashboards();const et=this.state.selector?.resolve();et&&this._subs.add(et.subscribeToState((rt,ht)=>{this.state.isEnabled&&this.state.isPanelOpened&&!rt.isLoadingScopes&&(ht.isLoadingScopes||rt.scopes!==ht.scopes)&&this.fetchDashboards()}))})}async fetchDashboards(){const et=j(this.state.selector?.resolve().state.scopes??[]);if((0,r.isEqual)(et,this.state.forScopeNames))return;if(et.length===0)return this.setState({dashboards:[],folders:{},filteredFolders:{},forScopeNames:[],isLoading:!1,scopesSelected:!1});this.setState({isLoading:!0});const rt=await q(et),ht=A(rt),ft=K(ht,this.state.searchQuery);this.setState({dashboards:rt,folders:ht,filteredFolders:ft,forScopeNames:et,isLoading:!1,scopesSelected:et.length>0})}changeSearchQuery(et){et=et??"",this.setState({filteredFolders:K(this.state.folders,et),searchQuery:et})}updateFolder(et,rt){let ht={...this.state.folders},ft={...this.state.filteredFolders},De=ht,Te=ft;for(let Je=0;Je<et.length-1;Je++)De=De[et[Je]].folders,Te=Te[et[Je]].folders;const Oe=et[et.length-1],Ye=De[Oe],Ge=Te[Oe];Ye.isExpanded=rt,Ge.isExpanded=rt,this.setState({folders:ht,filteredFolders:ft})}togglePanel(){this.state.isPanelOpened?this.closePanel():this.openPanel()}openPanel(){this.fetchDashboards(),this.setState({isPanelOpened:!0}),localStorage.setItem(ae,JSON.stringify(!0))}closePanel(){this.setState({isPanelOpened:!1}),localStorage.setItem(ae,JSON.stringify(!1))}enable(){this.setState({isEnabled:!0})}disable(){this.setState({isEnabled:!1})}}function te({model:He}){const{dashboards:et,filteredFolders:rt,isLoading:ht,isPanelOpened:ft,isEnabled:De,searchQuery:Te,scopesSelected:Oe}=He.useState(),Ye=(0,g.of)(ne);if(!De||!ft)return null;if(!ht)if(Oe){if(et.length===0)return(0,s.jsx)("div",{className:(0,a.cx)(Ye.container,Ye.noResultsContainer),"data-testid":"scopes-dashboards-notFoundForScope",children:(0,s.jsx)(c.x6,{i18nKey:"scopes.dashboards.noResultsForScopes",children:"No dashboards found for the selected scopes"})})}else return(0,s.jsx)("div",{className:(0,a.cx)(Ye.container,Ye.noResultsContainer),"data-testid":"scopes-dashboards-notFoundNoScopes",children:(0,s.jsx)(c.x6,{i18nKey:"scopes.dashboards.noResultsNoScopes",children:"No scopes selected"})});return(0,s.jsxs)("div",{className:Ye.container,"data-testid":"scopes-dashboards-container",children:[(0,s.jsx)(C,{disabled:ht,query:Te,onChange:Ge=>He.changeSearchQuery(Ge)}),ht?(0,s.jsx)(i._,{className:Ye.loadingIndicator,text:(0,c.t)("scopes.dashboards.loading","Loading dashboards"),"data-testid":"scopes-dashboards-loading"}):rt[""]?(0,s.jsx)(l.E,{children:(0,s.jsx)(v,{folders:rt,folderPath:[""],onFolderUpdate:(Ge,Je)=>He.updateFolder(Ge,Je)})}):(0,s.jsxs)("p",{className:Ye.noResultsContainer,"data-testid":"scopes-dashboards-notFoundForFilter",children:[(0,s.jsx)(c.x6,{i18nKey:"scopes.dashboards.noResultsForFilter",children:"No results found for your query"}),(0,s.jsx)(d.$n,{variant:"secondary",onClick:()=>He.changeSearchQuery(""),"data-testid":"scopes-dashboards-notFoundForFilter-clear",children:(0,s.jsx)(c.x6,{i18nKey:"scopes.dashboards.noResultsForFilterClear",children:"Clear search"})})]})]})}const ne=He=>({container:(0,a.css)({backgroundColor:He.colors.background.primary,borderRight:`1px solid ${He.colors.border.weak}`,display:"flex",flexDirection:"column",height:"100%",gap:He.spacing(1),padding:He.spacing(2),width:He.spacing(37.5)}),noResultsContainer:(0,a.css)({alignItems:"center",display:"flex",flexDirection:"column",gap:He.spacing(1),height:"100%",justifyContent:"center",margin:0,textAlign:"center"}),loadingIndicator:(0,a.css)({alignSelf:"center"})});var le=e(65474),re=e(69850),de=e(29158),oe=e(87978),J=e(62930),ce=e(76888),pe=e(10354),xe=e(56034);function fe({nodes:He,scopes:et,isDisabled:rt,isLoading:ht,onInputClick:ft,onRemoveAllClick:De}){const Te=(0,g.of)(Ee),[Oe,Ye]=(0,P.useState)(!1);(0,P.useEffect)(()=>{Ye(!1)},[et]);const Ge=(0,P.useMemo)(()=>{const St=et.map(({scope:Qt,path:an})=>{let Nn=He,zn;an.length>0?(zn=an.reduce((ss,ds)=>{const Ms=Nn[ds];if(!Ms)return ss;const{title:Bs,nodes:gs}=Ms;return Nn=gs,ss.push(Bs),ss},[]),zn[0]===""&&zn.splice(0,1)):zn=[Qt.spec.title];const Yn=zn.pop();return[zn.join(" > "),Yn]}),zt=(0,r.groupBy)(St,([Qt])=>Qt),Kt=Object.entries(zt).map(([Qt,an])=>{const Nn=an.map(([,zn])=>zn).join(", ");return(Qt?[Qt,Nn]:[Nn]).join(" > ")}).map(Qt=>(0,s.jsx)("p",{className:Te.scopePath,children:Qt},Qt));return(0,s.jsx)(s.Fragment,{children:Kt})},[He,et,Te]),Je=(0,P.useMemo)(()=>et.map(({scope:St})=>St.spec.title).join(", "),[et]),it=(0,P.useMemo)(()=>(0,s.jsx)(pe.p,{readOnly:!0,placeholder:(0,c.t)("scopes.selector.input.placeholder","Select scopes..."),disabled:rt,loading:ht,value:Je,"aria-label":(0,c.t)("scopes.selector.input.placeholder","Select scopes..."),"data-testid":"scopes-selector-input",suffix:et.length>0&&!rt?(0,s.jsx)(de.K,{"aria-label":(0,c.t)("scopes.selector.input.removeAll","Remove all scopes"),name:"times",onClick:()=>De()}):void 0,onMouseOver:()=>Ye(!0),onMouseOut:()=>Ye(!1),onClick:()=>{rt||ft()}}),[rt,ht,ft,De,et,Je]);return(0,s.jsx)(xe.m,{content:Ge,show:et.length===0?!1:Oe,children:it})}const Ee=He=>({scopePath:(0,a.css)({color:He.colors.text.primary,fontSize:He.typography.pxToRem(12),margin:He.spacing(0,0)})});function Se({anyChildExpanded:He,query:et,resultsNodes:rt}){const ht=(0,g.of)(ye);return He?null:(0,s.jsx)("h6",{className:ht.container,"data-testid":"scopes-tree-headline",children:et?rt.length===0?(0,s.jsx)(c.x6,{i18nKey:"scopes.tree.headline.noResults",children:"No results found for your query"}):(0,s.jsx)(c.x6,{i18nKey:"scopes.tree.headline.results",children:"Results"}):(0,s.jsx)(c.x6,{i18nKey:"scopes.tree.headline.recommended",children:"Recommended"})})}const ye=He=>({container:(0,a.css)({color:He.colors.text.secondary,margin:He.spacing(1,0)})});var Ve=e(79569),Me=e(10880);function Ce({anyChildExpanded:He,loadingNodeName:et,node:rt,nodePath:ht,nodes:ft,scopeNames:De,scopes:Te,type:Oe,onNodeSelectToggle:Ye,onNodeUpdate:Ge}){const Je=(0,g.of)(Ue);return(0,s.jsx)("div",{role:"tree",children:ft.map(it=>{const St=it.isSelectable&&De.includes(it.linkId);if(He&&!it.isExpanded)return null;const zt=[...ht,it.name],Kt=zt.join(".");return(0,s.jsxs)("div",{role:"treeitem","aria-selected":it.isExpanded,children:[(0,s.jsxs)("div",{className:Je.title,children:[it.isSelectable&&!it.isExpanded?rt.disableMultiSelect?(0,s.jsx)(Ve.J,{id:Kt,name:Kt,checked:St,label:"","data-testid":`scopes-tree-${Oe}-${it.name}-radio`,onClick:()=>{Ye(zt)}}):(0,s.jsx)(Me.S,{checked:St,"data-testid":`scopes-tree-${Oe}-${it.name}-checkbox`,onChange:()=>{Ye(zt)}}):null,it.isExpandable?(0,s.jsxs)("button",{className:Je.expand,"data-testid":`scopes-tree-${Oe}-${it.name}-expand`,"aria-label":it.isExpanded?(0,c.t)("scopes.tree.collapse","Collapse"):(0,c.t)("scopes.tree.expand","Expand"),onClick:()=>{Ge(zt,!it.isExpanded,it.query)},children:[(0,s.jsx)(m.I,{name:it.isExpanded?"angle-down":"angle-right"}),it.title]}):(0,s.jsx)("span",{"data-testid":`scopes-tree-${Oe}-${it.name}-title`,children:it.title})]}),(0,s.jsx)("div",{className:Je.children,children:it.isExpanded&&(0,s.jsx)(ut,{nodes:rt.nodes,nodePath:zt,loadingNodeName:et,scopes:Te,onNodeUpdate:Ge,onNodeSelectToggle:Ye})})]},it.name)})})}const Ue=He=>({title:(0,a.css)({alignItems:"center",display:"flex",gap:He.spacing(1),fontSize:He.typography.pxToRem(14),lineHeight:He.typography.pxToRem(22),padding:He.spacing(.5,0),"& > label":(0,a.css)({gap:0})}),expand:(0,a.css)({alignItems:"center",background:"none",border:0,display:"flex",gap:He.spacing(1),margin:0,padding:0}),children:(0,a.css)({paddingLeft:He.spacing(4)})});var Ae=e(70255);function we({children:He,isNodeLoading:et}){const rt=(0,g.of)(We);return et?(0,s.jsx)(Ae.A,{count:5,className:rt.loader}):He}const We=He=>({loader:(0,a.css)({margin:He.spacing(.5,0)})});function _e({anyChildExpanded:He,nodePath:et,query:rt,onNodeUpdate:ht}){const ft=(0,g.of)(at),[De,Te]=(0,P.useState)({value:rt,isDirty:!1});return(0,P.useEffect)(()=>{!De.isDirty&&De.value!==rt&&Te({value:rt,isDirty:!1})},[De,rt]),(0,E.A)(()=>{De.isDirty&&ht(et,!0,De.value)},500,[De.isDirty,De.value]),He?null:(0,s.jsx)(D.Z,{placeholder:(0,c.t)("scopes.tree.search","Search"),value:De.value,className:ft.input,"data-testid":"scopes-tree-search",onChange:Oe=>{Te({value:Oe,isDirty:!0})}})}const at=He=>({input:(0,a.css)({margin:He.spacing(1,0)})});function ut({nodes:He,nodePath:et,loadingNodeName:rt,scopes:ht,onNodeUpdate:ft,onNodeSelectToggle:De}){const Te=et[et.length-1],Oe=He[Te],Ye=Object.values(Oe.nodes),Ge=rt===Te,Je=ht.map(({scopeName:zt})=>zt),it=Ye.some(({isExpanded:zt})=>zt),St=(0,P.useMemo)(()=>(0,r.groupBy)(Ye,"reason"),[Ye]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(_e,{anyChildExpanded:it,nodePath:et,query:Oe.query,onNodeUpdate:ft}),(0,s.jsxs)(we,{isNodeLoading:Ge,children:[(0,s.jsx)(Ce,{anyChildExpanded:it,isNodeLoading:Ge,loadingNodeName:rt,node:Oe,nodePath:et,nodes:St[O.Persisted]??[],scopes:ht,scopeNames:Je,type:"persisted",onNodeSelectToggle:De,onNodeUpdate:ft}),(0,s.jsx)(Se,{anyChildExpanded:it,query:Oe.query,resultsNodes:St[O.Result]??[]}),(0,s.jsx)(Ce,{anyChildExpanded:it,isNodeLoading:Ge,loadingNodeName:rt,node:Oe,nodePath:et,nodes:St[O.Result]??[],scopes:ht,scopeNames:Je,type:"result",onNodeSelectToggle:De,onNodeUpdate:ft})]})]})}const Tt={nodes:{"":{name:"",reason:O.Result,nodeType:"container",title:"",isExpandable:!0,isSelectable:!1,isExpanded:!0,query:"",nodes:{}}},loadingNodeName:void 0,scopes:[],treeScopes:[],isReadOnly:!1,isLoadingScopes:!1,isPickerOpened:!1,isEnabled:!1};class It extends n.Bs{constructor(){super({dashboards:null,...Tt}),this._urlSync=new n.So(this,{keys:["scopes"]}),this.addActivationHandler(()=>(this.fetchBaseNodes(),()=>{this.nodesFetchingSub?.unsubscribe()}))}static{this.Component=ge}getUrlState(){return{scopes:this.state.isEnabled?j(this.state.scopes):[]}}updateFromUrl(et){let rt=et.scopes??[];rt=Array.isArray(rt)?rt:[rt],this.updateScopes(rt.map(ht=>({scopeName:ht,path:[]})))}fetchBaseNodes(){return this.updateNode([""],!0,"")}async updateNode(et,rt,ht){this.nodesFetchingSub?.unsubscribe();let ft={...this.state.nodes},De=ft;for(let Ge=0;Ge<et.length-1;Ge++)De=De[et[Ge]].nodes;const Te=et[et.length-1],Oe=De[Te],Ye=Oe.query!==ht;Oe.isExpanded=rt,Oe.query=ht,rt||Ye?(this.setState({nodes:ft,loadingNodeName:Te}),this.nodesFetchingSub=(0,le.H)(Q(Te,ht)).pipe((0,re.j)(()=>{this.setState({loadingNodeName:void 0})})).subscribe(Ge=>{const Je=this.state.treeScopes.map(({path:it})=>it[it.length-1]).filter(it=>it in Oe.nodes&&!(it in Ge)).reduce((it,St)=>(it[St]={...Oe.nodes[St],reason:O.Persisted},it),{});Oe.nodes={...Je,...Ge},this.setState({nodes:ft}),this.nodesFetchingSub?.unsubscribe()})):this.setState({nodes:ft,loadingNodeName:void 0})}toggleNodeSelect(et){let rt=[...this.state.treeScopes],ht=this.state.nodes[""];for(let Oe=1;Oe<et.length-1;Oe++)ht=ht.nodes[et[Oe]];const ft=et[et.length-1],{linkId:De}=ht.nodes[ft],Te=rt.findIndex(({scopeName:Oe})=>Oe===De);if(Te===-1){X(De);const Oe=rt.length===0||Object.values(ht.nodes).some(({linkId:Ge})=>Ge===rt[0].scopeName),Ye={scopeName:De,path:et};this.setState({treeScopes:ht?.disableMultiSelect||!Oe?[Ye]:[...rt,Ye]})}else rt.splice(Te,1),this.setState({treeScopes:rt})}openPicker(){if(!this.state.isReadOnly){let et={...this.state.nodes};et=this.closeNodes(et);let rt=[...this.state.scopes[0]?.path??["",""]];rt.splice(rt.length-1,1),et=this.expandNodes(et,rt),this.setState({isPickerOpened:!0,nodes:et})}}closePicker(){this.setState({isPickerOpened:!1})}async updateScopes(et=this.state.treeScopes){if((0,r.isEqual)(et,L(this.state.scopes)))return;this.setState({scopes:et.map(({scopeName:ht,path:ft})=>({scope:M(ht),path:ft})),treeScopes:et,isLoadingScopes:!0});const rt=await Z(et);this.setState({scopes:rt,isLoadingScopes:!1})}resetDirtyScopeNames(){this.setState({treeScopes:L(this.state.scopes)})}removeAllScopes(){this.setState({scopes:[],treeScopes:[],isLoadingScopes:!1})}enterReadOnly(){this.setState({isReadOnly:!0,isPickerOpened:!1})}exitReadOnly(){this.setState({isReadOnly:!1})}enable(){this.setState({isEnabled:!0})}disable(){this.setState({isEnabled:!1})}closeNodes(et){return Object.entries(et).reduce((rt,[ht,ft])=>(rt[ht]={...ft,isExpanded:!1,nodes:this.closeNodes(ft.nodes)},rt),{})}expandNodes(et,rt){et={...et};let ht=et;for(let ft=0;ft<rt.length;ft++){const De=rt[ft];ht[De]={...ht[De],isExpanded:!0},ht=ht[De].nodes}return et}}function ge({model:He}){const{chrome:et}=(0,ce.Il)(),rt=et.useState(),ht=!rt.chromeless&&rt.megaMenuDocked&&rt.megaMenuOpen,ft=(0,g.of)(Ie,ht),{dashboards:De,nodes:Te,loadingNodeName:Oe,scopes:Ye,treeScopes:Ge,isReadOnly:Je,isLoadingScopes:it,isPickerOpened:St,isEnabled:zt}=He.useState(),Kt=De?.resolve(),{isPanelOpened:Qt}=Kt?.useState()??{};if(!zt)return null;const an=Je?(0,c.t)("scopes.dashboards.toggle.disabled","Suggested dashboards list is disabled due to read only mode"):Qt?(0,c.t)("scopes.dashboards.toggle.collapse","Collapse suggested dashboards list"):(0,c.t)("scopes.dashboards.toggle..expand","Expand suggested dashboards list");return(0,s.jsxs)("div",{className:ft.container,children:[(0,s.jsx)(de.K,{name:"dashboard",className:ft.dashboards,"aria-label":an,tooltip:an,"data-testid":"scopes-dashboards-expand",disabled:Je,onClick:()=>Kt?.togglePanel()}),(0,s.jsx)(fe,{nodes:Te,scopes:Ye,isDisabled:Je,isLoading:it,onInputClick:()=>He.openPicker(),onRemoveAllClick:()=>He.removeAllScopes()}),St&&(0,s.jsxs)(oe._,{title:(0,c.t)("scopes.selector.title","Select scopes"),size:"sm",onClose:()=>{He.closePicker(),He.resetDirtyScopeNames()},children:[it?(0,s.jsx)(J.y,{"data-testid":"scopes-selector-loading"}):(0,s.jsx)(ut,{nodes:Te,nodePath:[""],loadingNodeName:Oe,scopes:Ge,onNodeUpdate:(Nn,zn,Yn)=>He.updateNode(Nn,zn,Yn),onNodeSelectToggle:Nn=>He.toggleNodeSelect(Nn)}),(0,s.jsxs)("div",{className:ft.buttonGroup,children:[(0,s.jsx)(d.$n,{variant:"primary","data-testid":"scopes-selector-apply",onClick:()=>{He.closePicker(),He.updateScopes()},children:(0,s.jsx)(c.x6,{i18nKey:"scopes.selector.apply",children:"Apply"})}),(0,s.jsx)(d.$n,{variant:"secondary","data-testid":"scopes-selector-cancel",onClick:()=>{He.closePicker(),He.resetDirtyScopeNames()},children:(0,s.jsx)(c.x6,{i18nKey:"scopes.selector.cancel",children:"Cancel"})})]})]})]})}const Ie=(He,et)=>({container:(0,a.css)({display:"flex",flexDirection:"row",paddingLeft:et?He.spacing(2):"unset",...!t.$.featureToggles.singleTopNav&&{paddingLeft:He.spacing(2),borderLeft:`1px solid ${He.colors.border.weak}`}}),dashboards:(0,a.css)({color:He.colors.text.secondary,marginRight:He.spacing(2),"&:hover":(0,a.css)({color:He.colors.text.primary})}),buttonGroup:(0,a.css)({display:"flex",gap:He.spacing(1),marginTop:He.spacing(8)})});let ue=null,me=null;function Pe(){t.$.featureToggles.scopeFilters&&(me=new It,ue=new se,me.setState({dashboards:ue.getRef()}),ue.setState({selector:me.getRef()}),new n.g5().initSync(me))}function Ne(){return ue?(0,s.jsx)(ue.Component,{model:ue}):null}function Fe(){return B(me?.state.scopes??[])}function Be(){return Fe().map(He=>He.metadata.name)}function he(){me?.enable(),ue?.enable()}function be(){me?.disable(),ue?.disable()}function Ke(){me?.exitReadOnly(),ue?.enable()}function ze(){me?.enterReadOnly(),ue?.disable()}function nt(He){return n.jh.findObject(He,et=>et instanceof tt)}class tt extends n.Bs{constructor(et){super(et),this._activationHandler=()=>(this.enable(),this._subs.add(me?.subscribeToState((rt,ht)=>{!rt.isLoadingScopes&&(ht.isLoadingScopes||!(0,r.isEqual)(rt.scopes,ht.scopes))&&this.state.handler?.(this)})),()=>{this.disable()}),this.addActivationHandler(this._activationHandler)}get value(){return Fe()}enable(){he()}disable(){be()}enterReadOnly(){ze()}exitReadOnly(){Ke()}}function ot(){return me?(0,s.jsx)(me.Component,{model:me}):null}const gt=()=>ue?.useState()},53477:(G,R,e)=>{"use strict";e.d(R,{G3:()=>g,TF:()=>d,XJ:()=>u,YU:()=>o,d7:()=>h,if:()=>p,r4:()=>r,w7:()=>m});var t=e(64161);const n=null,s=58,a=8,r={label:"A\u2013Z",value:"alpha-asc"},g="search.sections",i="grafana.search.expanded-folder",l=0,d="general",c="Dashboards",h="grafana.search.include.panels",o="grafana.search.layout",m="grafana.search.sort",u={dashboard:t.G.DashDB,folder:t.G.DashFolder,home:t.G.DashHome},p=1e3},97427:(G,R,e)=>{"use strict";e.d(R,{d:()=>r,n:()=>g});var t=e(96540),n=e(13752),s=e(71733),a=e(39601);function r(){const i=(0,t.useRef)(new n.B);return{keyboardEvents:i.current,onKeyDown:l=>{switch(l.code){case"ArrowDown":case"ArrowUp":case"ArrowLeft":case"ArrowRight":case"Enter":i.current.next(l);default:}}}}function g(i,l,d){const c=(0,t.useRef)({x:0,y:-1}),[h,o]=(0,t.useState)({x:0,y:-1}),m=(0,t.useRef)();return(0,t.useEffect)(()=>{m.current=d.view.fields.url,c.current.x=0,c.current.y=-1,o({...c.current})},[d]),(0,t.useEffect)(()=>{const u=i.subscribe({next:p=>{switch(p?.code){case"ArrowDown":{c.current.y++,o({...c.current});break}case"ArrowUp":c.current.y=Math.max(0,c.current.y-1),o({...c.current});break;case"ArrowRight":{l>0&&(c.current.x=Math.min(l,c.current.x+1),o({...c.current}));break}case"ArrowLeft":{l>0&&(c.current.x=Math.max(0,c.current.x-1),o({...c.current}));break}case"Enter":if(!m.current)break;const f=c.current.x*l+c.current.y;if(f<0){c.current.x=0,c.current.y=0,o({...c.current});break}const y=m.current.values?.[f];typeof y=="string"&&a.Ny.push(s.I.stripBaseFromUrl(y))}}});return()=>u.unsubscribe()},[i,l]),h}},6204:(G,R,e)=>{"use strict";e.d(R,{B9:()=>g,J$:()=>a,KZ:()=>r,MK:()=>s,Pf:()=>n});var t=e(14110);const n=(l,d)=>{(0,t.rR)(`${l}_viewed`,i(d))},s=(l,d)=>{(0,t.rR)(`${l}_result_clicked`,i(d))},a=(l,d)=>{(0,t.rR)(`${l}_query_submitted`,i(d))},r=(l,{error:d,...c})=>{(0,t.rR)(`${l}_query_failed`,{...i(c),error:d})},g=(l,d,c)=>{(0,t.rR)(`grafana_panel_inspect_${l}_${d}_clicked`,c)},i=l=>({layout:l.layout,starredFilter:l.starred??!1,sort:l.sortValue??"",tagCount:l.tagCount??0,queryLength:l.query?.length??0,includePanels:l.includePanels??!1,deleted:l.deleted??!1})},65812:(G,R,e)=>{"use strict";e.d(R,{getGrafanaSearcher:()=>W});var t=e(32264),n=e(78368),s=e(14236),a=e(57875),r=e(17172),g=e(40957);const i="Loading",l="api/search-v2",d="name_sort";class c{constructor(F){this.fallbackSearcher=F}async search(F){if(F.facet?.length)throw new Error("facets not supported!");return this.doSearchQuery(F)}async starred(F){if(F.facet?.length)throw new Error("facets not supported!");const V=await(0,r.AI)().get("api/user/stars");return V?.length?this.doSearchQuery({uid:V,query:F.query??"*"}):{view:new n.R({length:0,fields:[]}),totalRows:0,loadMoreItems:async(w,z)=>{},isItemLoaded:w=>!0}}async tags(F){const V={...F,query:F.query??"*",sort:void 0,facet:[{field:"tag"}],limit:1},z=(await(0,r.AI)().post(l,V)).frames.map(N=>(0,s.Vc)(N));if(z[0]?.name===i)return this.fallbackSearcher.tags(F);for(const N of z)if(N.fields[0].name==="tag")return m(N);return[]}getSortOptions(){const F=[{value:d,label:"Alphabetically (A-Z)"},{value:"-name_sort",label:"Alphabetically (Z-A)"}];if(t.$.licenseInfo.enabledFeatures.analytics){for(const V of u)F.push({value:`-${V.name}`,label:`${V.display} (most)`}),F.push({value:`${V.name}`,label:`${V.display} (least)`});for(const V of p)F.push({value:`-${V.name}`,label:`${V.display} (recent)`}),F.push({value:`${V.name}`,label:`${V.display} (oldest)`})}return Promise.resolve(F)}async doSearchQuery(F){F=await(0,g.u4)(F);const V={...F,query:F.query??"*",limit:F.limit??h},z=(await(0,r.AI)().post(l,V)).frames.map(q=>(0,s.Vc)(q)),N=z.length?(0,s.Vc)(z[0]):{fields:[],length:0};if(N.name===i)return this.fallbackSearcher.search(F);for(const q of N.fields)q.display=(0,a.J)({field:q,theme:t.$.theme2});N.meta?.custom||(N.meta={...N.meta,custom:{count:N.length,max_score:1}});const H=N.meta.custom;if(H.locationInfo||(H.locationInfo={}),H.sortBy?.length){const q=N.fields.find(ae=>ae.name===H.sortBy);if(q){const ae=f(q.name);H.sortBy=ae,q.name=ae}}let Q=0,X;const ee=async()=>{for(;Q>Z.dataFrame.length;){const q=Z.dataFrame.length;if(q>=H.count)return;const ae=await(0,r.AI)().post(l,{...V??{},from:q,limit:o}),k=(0,s.Vc)(ae.frames[0]);if(!k){console.log("no results",k);return}if(k.fields.length!==Z.dataFrame.fields.length){console.log("invalid shape",k,Z.dataFrame);return}const se=k.length+Z.dataFrame.length;for(let ne=0;ne<k.fields.length;ne++)Z.dataFrame.fields[ne].values.push(...k.fields[ne].values);Z.dataFrame.length=se;const te=k.meta?.custom;if(te?.locationInfo&&H)for(const[ne,le]of Object.entries(te.locationInfo))H.locationInfo[ne]=le}X=void 0},Z=new n.R(N);return{totalRows:H.count??N.length,view:Z,loadMoreItems:async(q,ae)=>(Q=Math.max(Q,ae),X||(X=ee()),X),isItemLoaded:q=>q<Z.dataFrame.length}}getFolderViewSort(){return"name_sort"}}const h=50,o=100;function m(U){const F=U.fields[0].values,V=U.fields[1].values,w=[];for(let z=0;z<U.length;z++)w.push({term:F[z],count:V[z]});return w}const u=[{name:"views_total",display:"Views total"},{name:"views_last_30_days",display:"Views 30 days"},{name:"errors_total",display:"Errors total"},{name:"errors_last_30_days",display:"Errors 30 days"}],p=[{name:"created_at",display:"Created time"},{name:"updated_at",display:"Updated time"}];function f(U){for(const F of u)if(F.name===U)return F.display;for(const F of p)if(F.name===U)return F.display;return U}var y=e(53076);class x{constructor(F){this.parent=F,this.cache=new Map,this.sortPlaceholder="Default (Relevance)"}async search(F){if(F.facet?.length)throw new Error("facets not supported!");if(F.sort!=null)throw new Error("custom sorting is not supported yet");if(F.tags?.length||F.ds_uid?.length)return this.parent.search(F);const w=(await this.getCache(F.kind)).search(F.query);return{isItemLoaded:()=>!0,loadMoreItems:async(z,N)=>{},totalRows:w.length,view:w}}async getCache(F){const V=F?F.sort().join(","):"*",w=this.cache.get(V);if(w)try{return await w}catch{return this.cache.delete(V),new v(new n.R({name:"error",fields:[],length:0}))}const z=this.parent.search({kind:F,limit:5e3}).then(N=>new v(N.view));return this.cache.set(V,z),z}async starred(F){return this.parent.starred(F)}async getSortOptions(){return this.parent.getSortOptions()}async tags(F){return this.parent.tags(F)}getFolderViewSort(){return this.parent.getFolderViewSort()}}class v{constructor(F){this.full=F,this.ufuzzy=new y.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1}),this.names=this.full.fields.name.values,this.empty=new n.R({...this.full.dataFrame,fields:this.full.dataFrame.fields.map(V=>({...V,values:[]})),length:0})}search(F){if(!F?.length||F==="*")return this.full;const V=this.full.dataFrame.fields,w=this.names,z=V.map(X=>[]);let[N,H,Q]=this.ufuzzy.search(w,F,5);for(let X=0;X<V.length;X++){let ee=V[X].values,Z=z[X];if(H&&Q)for(let q=0;q<Q.length;q++){let ae=H.idx[Q[q]];Z.push(ee[ae])}else if(N)for(let q=0;q<N.length;q++){let ae=N[q];Z.push(ee[ae])}}return this.empty.dataFrame.fields.forEach((X,ee)=>{X.values=z[ee]}),this.empty.dataFrame.length=this.empty.dataFrame.fields[0].values.length,this.empty}}var P=e(11261),E=e(27677),D=e(53477);class C{constructor(){this.locationInfo={general:{kind:"folder",name:"Dashboards",url:"/dashboards"}},this.getFolderViewSort=()=>""}async composeQuery(F,V){const w=await(0,g.u4)(V);return w.query?.length&&w.query!=="*"&&(F.query=w.query),w.kind?.length===1&&D.XJ[w.kind[0]]&&(F.type=D.XJ[w.kind[0]]),w.uid?F.dashboardUID=w.uid:w.location?.length&&(F.folderUIDs=[w.location]),F}async search(F){if(F.facet?.length)throw new Error("facets not supported!");if(F.from!==void 0){if(!F.limit)throw new Error("Must specify non-zero limit parameter when using from");if(F.from/F.limit%1!==0)throw new Error("From parameter must be a multiple of limit")}const V=F.limit??(F.from!==void 0?1:D.if),w=F.from!==void 0?F.from/V+1:void 0,z=await this.composeQuery({limit:V,tag:F.tags,sort:F.sort,permission:F.permission,page:w,deleted:F.deleted},F);return this.doAPIQuery(z)}async starred(F){if(F.facet?.length)throw new Error("facets not supported!");const V=await this.composeQuery({limit:F.limit??D.if,tag:F.tags,sort:F.sort,starred:F.starred},F);return this.doAPIQuery(V)}async getSortOptions(){return(await E.IB.get("/api/search/sorting")).sortOptions.map(V=>({value:V.name,label:V.displayName}))}async tags(F){return(await E.IB.get("/api/dashboards/tags")).sort((w,z)=>z.count-w.count)}async doAPIQuery(F){const V=await E.IB.get("/api/search",F),w=[],z=[],N=[],H=[],Q=[],X=[],ee=[],Z=[],q=[];let ae;for(let te of V){const ne=te.type==="dash-folder"?"folder":"dashboard";w.push(ne),z.push(te.title),N.push(te.uid),H.push(te.url),Q.push(te.tags),ee.push(te.sortMeta),Z.push(te.isDeleted??!1),q.push(te.permanentlyDeleteDate?new Date(te.permanentlyDeleteDate):void 0);let le=te.folderUid;!le&&ne==="dashboard"&&(le=D.TF),X.push(le),te.sortMetaName?.length&&(ae=te.sortMetaName),te.folderUid&&te.folderTitle?this.locationInfo[te.folderUid]={kind:"folder",name:te.folderTitle,url:te.folderUrl,folderUid:te.folderUid}:ne==="folder"&&(this.locationInfo[te.uid]={kind:ne,name:te.title,url:te.url,folderUid:te.folderUid})}const k={fields:[{name:"kind",type:P.PU.string,config:{},values:w},{name:"name",type:P.PU.string,config:{},values:z},{name:"uid",type:P.PU.string,config:{},values:N},{name:"url",type:P.PU.string,config:{},values:H},{name:"tags",type:P.PU.other,config:{},values:Q},{name:"location",type:P.PU.string,config:{},values:X},{name:"isDeleted",type:P.PU.boolean,config:{},values:Z},{name:"permanentlyDeleteDate",type:P.PU.time,config:{},values:q}],length:z.length,meta:{custom:{count:z.length,max_score:1,locationInfo:this.locationInfo}}};ae?.length&&ee.length&&(k.meta.custom.sortBy=ae,k.fields.push({name:ae,type:P.PU.number,config:{},values:ee}));for(const te of k.fields)te.display=(0,a.J)({field:te,theme:t.$.theme2});const se=new n.R(k);return{totalRows:k.length,view:se,loadMoreItems:async(te,ne)=>{},isItemLoaded:te=>!0}}}const b="Loading",T="api/unified-search",S="name_sort";class O{constructor(F){this.fallbackSearcher=F}async search(F){if(F.facet?.length)throw new Error("facets not supported!");return this.doSearchQuery(F)}async starred(F){if(F.facet?.length)throw new Error("facets not supported!");const V=await(0,r.AI)().get("api/user/stars");return V?.length?this.doSearchQuery({uid:V,query:F.query??"*"}):{view:new n.R({length:0,fields:[]}),totalRows:0,loadMoreItems:async(w,z)=>{},isItemLoaded:w=>!0}}async tags(F){const V={...F,query:F.query??"*",sort:void 0,facet:[{field:"tag"}],limit:1},z=(await(0,r.AI)().post(T,V)).frames.map(N=>(0,s.Vc)(N));if(z[0]?.name===b)return this.fallbackSearcher.tags(F);for(const N of z)if(N.fields[0].name==="tag")return L(N);return[]}getSortOptions(){const F=[{value:S,label:"Alphabetically (A-Z)"},{value:"-name_sort",label:"Alphabetically (Z-A)"}];if(t.$.licenseInfo.enabledFeatures.analytics){for(const V of B)F.push({value:`-${V.name}`,label:`${V.display} (most)`}),F.push({value:`${V.name}`,label:`${V.display} (least)`});for(const V of j)F.push({value:`-${V.name}`,label:`${V.display} (recent)`}),F.push({value:`${V.name}`,label:`${V.display} (oldest)`})}return Promise.resolve(F)}async doSearchQuery(F){F=await(0,g.u4)(F);const V={...F,query:F.query??"*",limit:F.limit??M},z=(await(0,r.AI)().post(T,V)).frames.map(q=>(0,s.Vc)(q)),N=z.length?(0,s.Vc)(z[0]):{fields:[],length:0};if(N.name===b)return this.fallbackSearcher.search(F);for(const q of N.fields)q.display=(0,a.J)({field:q,theme:t.$.theme2});N.meta?.custom||(N.meta={...N.meta,custom:{count:N.length,max_score:1}});const H=N.meta.custom||{};if(H.locationInfo||(H.locationInfo={}),H.sortBy?.length){const q=N.fields.find(ae=>ae.name===H.sortBy);if(q){const ae=A(q.name);H.sortBy=ae,q.name=ae}}let Q=0,X;const ee=async()=>{for(;Q>Z.dataFrame.length;){const q=Z.dataFrame.length;if(q>=H.count)return;const ae=await(0,r.AI)().post(T,{...V??{},from:q,limit:I}),k=(0,s.Vc)(ae.frames[0]);if(!k){console.log("no results",k);return}if(k.fields.length!==Z.dataFrame.fields.length){console.log("invalid shape",k,Z.dataFrame);return}const se=k.length+Z.dataFrame.length;for(let ne=0;ne<k.fields.length;ne++)Z.dataFrame.fields[ne].values.push(...k.fields[ne].values);Z.dataFrame.length=se;const te=k.meta?.custom;if(te?.locationInfo&&H)for(const[ne,le]of Object.entries(te.locationInfo))H.locationInfo[ne]=le}X=void 0},Z=new n.R(N);return{totalRows:H.count??N.length,view:Z,loadMoreItems:async(q,ae)=>(Q=Math.max(Q,ae),X||(X=ee()),X),isItemLoaded:q=>q<Z.dataFrame.length}}getFolderViewSort(){return"name_sort"}}const M=50,I=100;function L(U){const F=U.fields[0].values,V=U.fields[1].values,w=[];for(let z=0;z<U.length;z++)w.push({term:F[z],count:V[z]});return w}const B=[{name:"views_total",display:"Views total"},{name:"views_last_30_days",display:"Views 30 days"},{name:"errors_total",display:"Errors total"},{name:"errors_last_30_days",display:"Errors 30 days"}],j=[{name:"created_at",display:"Created time"},{name:"updated_at",display:"Updated time"}];function A(U){for(const F of B)if(F.name===U)return F.display;for(const F of j)if(F.name===U)return F.display;return U}let K;function W(){if(!K){const U=new C,F=t.$.featureToggles.panelTitleSearch;K=F?new c(U):U,t.$.featureToggles.unifiedStorageSearch&&(K=new O(U)),F&&location.search.includes("do-frontend-query")&&(K=new x(K))}return K}},40957:(G,R,e)=>{"use strict";e.d(R,{TM:()=>g,cu:()=>i,hI:()=>d,u4:()=>s});var t=e(49952),n=e(14792);async function s(c){return c.query&&c.query.indexOf("folder:current")>=0&&(c={...c,location:await a(),query:c.query.replace("folder:current","").trim()},c.query?.length||(c.query="*")),Promise.resolve(c)}async function a(){try{let c=(0,n.UA)().getCurrent();return c||(await r(500),c=(0,n.UA)().getCurrent()),Promise.resolve(c?.meta?.folderUid)}catch(c){console.error(c)}}function r(c){return new Promise(h=>setTimeout(h,c))}function g(c,h){return c==="dashboard"?"apps":c==="folder"?h?"folder-open":"folder":"question-circle"}function i(c,h){return c&&(0,t.I)(c.uid)?"users-alt":g(c.kind,h)}function l(c){switch(c){case"dashboard":case"folder":case"panel":return c;default:return"dashboard"}}function d(c,h){const o=h?.dataFrame.meta?.custom,m={kind:l(c.kind),uid:c.uid,title:c.name,url:c.url,tags:c.tags??[]},u=o?.sortBy;if(u){const p=c[u];(typeof p=="string"||typeof p=="number")&&(m.sortMetaName=u,m.sortMeta=p)}if(c.location){const p=c.location.split("/"),f=p[p.length-1],y=o?.locationInfo[f];y&&(m.parentTitle=y.name,m.parentKind=y.kind,m.parentUID=f)}return m}},64161:(G,R,e)=>{"use strict";e.d(R,{G:()=>t,P:()=>n});var t=(s=>(s.DashDB="dash-db",s.DashHome="dash-home",s.DashFolder="dash-folder",s))(t||{}),n=(s=>(s.List="list",s.Folders="folders",s))(n||{})},16757:(G,R,e)=>{"use strict";e.d(R,{N1:()=>r,W1:()=>s});var t=e(53477);const n=g=>g?!!(g.query||g.tag?.length>0||g.starred||g.sort):!1,s=()=>{const g=t.G3+".";for(let i=0;i<window.localStorage.length;i++){const l=window.localStorage.key(i);l?.startsWith(g)&&window.localStorage.removeItem(l)}},a=(g="General")=>`${SECTION_STORAGE_KEY}.${g.toLowerCase()}`,r=g=>{const i=Object.entries(g).reduce((l,[d,c])=>{if(c){if(d==="tag"&&!Array.isArray(c))return{...l,tag:[c]}}else return l;return{...l,[d]:c}},{});if(g.folder){const l=`folder:${g.folder}`;return{...i,query:`${l} ${(i.query??"").replace(l,"")}`}}return{...i}}},1936:(G,R,e)=>{"use strict";e.d(R,{Ay:()=>D,EC:()=>v,FW:()=>p,G3:()=>l,L5:()=>E,QM:()=>g,Yh:()=>f,aD:()=>d,c3:()=>P,ch:()=>i,dJ:()=>c,ew:()=>x,jE:()=>h,zh:()=>y});var t=e(65307),n=e(31678);const s={serviceAccount:{},isLoading:!0,tokens:[]},a=(0,t.Z0)({name:"serviceaccount",initialState:s,reducers:{serviceAccountFetchBegin:C=>({...C,isLoading:!0}),serviceAccountFetchEnd:C=>({...C,isLoading:!1}),serviceAccountLoaded:(C,b)=>({...C,serviceAccount:b.payload,isLoading:!1}),serviceAccountTokensLoaded:(C,b)=>({...C,tokens:b.payload,isLoading:!1}),rolesFetchBegin:C=>({...C,rolesLoading:!0}),rolesFetchEnd:C=>({...C,rolesLoading:!1})}}),r=a.reducer,{serviceAccountLoaded:g,serviceAccountTokensLoaded:i,serviceAccountFetchBegin:l,serviceAccountFetchEnd:d,rolesFetchBegin:c,rolesFetchEnd:h}=a.actions,o={serviceAccounts:[],isLoading:!0,roleOptions:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,serviceAccountStateFilter:n.ServiceAccountStateFilter.All},m=(0,t.Z0)({name:"serviceaccounts",initialState:o,reducers:{serviceAccountsFetched:(C,b)=>{const{totalCount:T,perPage:S,...O}=b.payload,M=Math.ceil(T/S);return{...C,...O,totalPages:M,perPage:S,showPaging:M>1,isLoading:!1}},serviceAccountsFetchBegin:C=>({...C,isLoading:!0}),serviceAccountsFetchEnd:C=>({...C,isLoading:!1}),acOptionsLoaded:(C,b)=>({...C,roleOptions:b.payload}),queryChanged:(C,b)=>({...C,query:b.payload,page:0}),pageChanged:(C,b)=>({...C,page:b.payload}),stateFilterChanged:(C,b)=>({...C,serviceAccountStateFilter:b.payload})}}),u=m.reducer,{serviceAccountsFetchBegin:p,serviceAccountsFetchEnd:f,serviceAccountsFetched:y,acOptionsLoaded:x,pageChanged:v,stateFilterChanged:P,queryChanged:E}=m.actions,D={serviceAccountProfile:r,serviceAccounts:u}},8212:(G,R,e)=>{"use strict";e.d(R,{Ay:()=>m,NV:()=>h,Y1:()=>l,j7:()=>i,kH:()=>g,pB:()=>c,s7:()=>d,sF:()=>r,sJ:()=>a});var t=e(65307);const n={supportBundles:[],isLoading:!1,supportBundleCollectors:[],createBundlePageLoading:!1,loadBundlesError:"",createBundleError:""},s=(0,t.Z0)({name:"supportBundles",initialState:n,reducers:{supportBundlesLoaded:(u,p)=>({...u,supportBundles:p.payload,isLoading:!1}),fetchBegin:u=>({...u,isLoading:!0}),fetchEnd:u=>({...u,isLoading:!1}),collectorsFetchBegin:u=>({...u,createBundlePageLoading:!0}),collectorsFetchEnd:u=>({...u,createBundlePageLoading:!1}),supportBundleCollectorsLoaded:(u,p)=>({...u,supportBundleCollectors:p.payload,createBundlePageLoading:!1}),setLoadBundleError:(u,p)=>({...u,loadBundlesError:p.payload,supportBundleCollectors:[]}),setCreateBundleError:(u,p)=>({...u,createBundleError:p.payload})}}),{supportBundlesLoaded:a,fetchBegin:r,fetchEnd:g,supportBundleCollectorsLoaded:i,collectorsFetchBegin:l,collectorsFetchEnd:d,setLoadBundleError:c,setCreateBundleError:h}=s.actions,m={supportBundles:s.reducer}},34655:(G,R,e)=>{"use strict";e.d(R,{$T:()=>m,$u:()=>i,Ay:()=>x,EC:()=>g,L5:()=>r,Q9:()=>a,dJ:()=>l,jE:()=>d,tC:()=>u});var t=e(65307);const n={teams:[],page:1,query:"",perPage:30,totalPages:0,noTeams:!1,hasFetched:!1},s=(0,t.Z0)({name:"teams",initialState:n,reducers:{teamsLoaded:(v,P)=>{const{totalCount:E,perPage:D,...C}=P.payload,b=Math.ceil(E/D);return{...v,...C,totalPages:b,perPage:D,hasFetched:!0}},queryChanged:(v,P)=>({...v,page:1,query:P.payload}),pageChanged:(v,P)=>({...v,page:P.payload}),sortChanged:(v,P)=>({...v,sort:P.payload,page:1}),rolesFetchBegin:v=>({...v,rolesLoading:!0}),rolesFetchEnd:v=>({...v,rolesLoading:!1})}}),{teamsLoaded:a,queryChanged:r,pageChanged:g,sortChanged:i,rolesFetchBegin:l,rolesFetchEnd:d}=s.actions,c=s.reducer,h={team:{},members:[],groups:[],searchMemberQuery:""},o=(0,t.Z0)({name:"team",initialState:h,reducers:{teamLoaded:(v,P)=>({...v,team:P.payload}),teamMembersLoaded:(v,P)=>({...v,members:P.payload}),setSearchMemberQuery:(v,P)=>({...v,searchMemberQuery:P.payload}),teamGroupsLoaded:(v,P)=>({...v,groups:P.payload})}}),{teamLoaded:m,teamGroupsLoaded:u,teamMembersLoaded:p,setSearchMemberQuery:f}=o.actions,y=o.reducer,x={teams:c,team:y}},23989:(G,R,e)=>{"use strict";e.d(R,{w:()=>q});var t=e(2543),n=e(95344),s=e(19347),a=e(72574),r=e(84537),g=e(52622),i=e(73788),l=e(20601),d=e(13344),c=e(24240),h=e(87421),o=e(75096);let m={};function u(ae){const k=m[ae];return k||(m[ae]=(0,t.property)(ae))}class p{constructor(k,se,te){this.state={name:k.name,value:se,text:te,type:k.type}}getValue(k){let{value:se}=this.state;return se==="string"||se==="number"||se==="boolean"?se:String(se)}getValueText(){const{value:k,text:se}=this.state;return typeof se=="string"?k===d.To?d.Zm:se:Array.isArray(se)?se.join(" + "):(console.log("value",se),String(se))}}let f;function y(ae,k,se){return f?(f.state.name=ae.name,f.state.type=ae.type,f.state.value=k,f.state.text=se):f=new p(ae,k,se),f}function x(ae,k,se,te){if(se=se||{},ae==null||(0,c.EW)(se)&&k!==g.$m.QueryParam)return"";if(!Array.isArray(ae)&&typeof ae=="object"&&(ae=`${ae}`),typeof k=="function")return k(ae,se,x);k||(k=g.$m.Glob);let ne=k.split(":");ne.length>1?(k=ne[0],ne=ne.slice(1)):ne=[];let le=r.vz.getIfExists(k);le||(console.error(`Variable format ${k} not found. Using glob format as fallback.`),le=r.vz.get(g.$m.Glob));const re=y(se,ae,te??ae);return le.formatter(ae,ne,re)}var v=e(84743),P=e.n(v),E=e(6709),D=e(76885),C=e(1933),b=e(74856),T=e(25304),S=e(83195),O=e(11261),M=e(92461),I=e(57875),L=e(28240),B=e(8249);function j(ae,k,se){return new Proxy({},{get:(te,ne)=>{if(ne==="name")return ae.name;if(ne==="displayName")return(0,L.Ct)(ae,k,se);if(ne==="labels"||ne==="formattedLabels")return ae.labels?{...ae.labels,__values:Object.values(ae.labels).sort().join(", "),toString:()=>(0,B.h6)(ae.labels,"",!0)}:""}})}function A(ae,k,se,te){const ne=K(ae,k,se);return x(ne,te)}function K(ae,k,se){const te=se?.__dataContext;if(!te)return ae;const{frame:ne,rowIndex:le,field:re,calculatedValue:de}=te.value;if(de)switch(k){case"numeric":return de.numeric.toString();case"raw":return de.numeric;case"time":return"";case"text":default:return(0,S.cN)(de)}if(le===void 0)return ae;if(k==="time"){const pe=ne.fields.find(xe=>xe.type===O.PU.time);return pe?pe.values[le]:void 0}const oe=re.values[le];if(k==="raw")return oe;const ce=(re.display??F())(oe);switch(k){case"numeric":return ce.numeric;case"text":return ce.text;default:return(0,S.cN)(ce)}}function W(ae,k,se,te){const ne=se?.__dataContext;if(!ne||!k)return ae;const{frame:le,rowIndex:re}=ne.value;if(re===void 0||k===void 0)return ae;const de={name:le.name,refId:le.refId,fields:(0,M.F)({frame:le,rowIndex:re})},oe=u(k)(de)??"";return x(oe,te)}let U;function F(){return U||(U=(0,I.J)()),U}function V(ae,k,se,te){const ne=se?.__dataContext;if(!ne||k!=="name")return ae;const{frame:le,frameIndex:re}=ne.value,de=(0,L.Ri)(le,re);return x(de,te)}function w(ae,k,se,te){const ne=se?.__dataContext;if(!ne||k===void 0||k==="")return ae;const{frame:le,field:re,data:de}=ne.value,oe=j(re,le,de),J=u(k)(oe)??"";return x(J,te)}const z={__value:A,__data:W,__series:V,__field:w,[E.c.includeVars]:N,[E.c.keepTime]:H,__timezone:Q};function N(ae,k,se){const te=(0,T.z)(se);return D.kM.toUrlParams(te)}function H(){return D.kM.toUrlParams((0,b.jG)().timeRangeForUrl())}function Q(){const ae=(0,C.O)({timeZone:(0,b.jG)().timeModel?.getTimezone()});return ae==="browser"?P().tz.guess():ae}const X={getFilteredVariables:h.bZ,getVariables:h.UN,getVariableWithName:h._2};class ee{constructor(k=X){this.dependencies=k,this.regex=o.SY,this.index={},this.grafanaVariables=new Map,this._timeRange=null,this._adhocFiltersDeprecationWarningLogged=new Map,this._variables=[]}init(k,se){this._variables=k,this._timeRange=se,this.updateIndex()}get variables(){return(0,n.l)("template_srv.ts","variables","getVariables"),this.getVariables()}getVariables(){return window.__grafanaSceneContext?(0,i.E)(window.__grafanaSceneContext):this.dependencies.getVariables()}get timeRange(){return window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive?r.jh.getTimeRange(window.__grafanaSceneContext).state.value:this._timeRange}updateIndex(){const k=se=>se||se==="";if(this.index=this._variables.reduce((se,te)=>(te.current&&(te.current.isNone||k(te.current.value))&&(se[te.name]=te),se),{}),this.timeRange){const se=this.timeRange.from.valueOf().toString(),te=this.timeRange.to.valueOf().toString();this.index={...this.index,__from:{current:{value:se,text:se}},__to:{current:{value:te,text:te}}}}}updateTimeRange(k){this._timeRange=k,this.updateIndex()}variableInitialized(k){this.index[k.name]=k}getAdhocFilters(k,se){let te=[],ne=(0,s.l)().getInstanceSettings(k);if(!ne)return[];!se&&!this._adhocFiltersDeprecationWarningLogged.get(ne.type)&&((0,n.l)(`DataSource ${ne.type}`,"templateSrv.getAdhocFilters","filters property on the request (DataQueryRequest). Or if this is called from interpolateVariablesInQueries or applyTemplateVariables it is passed as a new argument"),this._adhocFiltersDeprecationWarningLogged.set(ne.type,!0));for(const le of this.getAdHocVariables()){const re=le.datasource?.uid;(re===ne.uid||re?.indexOf("$")===0&&this.replace(re)===ne.uid)&&(te=te.concat(le.filters))}return te}setGrafanaVariable(k,se){this.grafanaVariables.set(k,se)}setGlobalVariable(k,se){(0,n.l)("template_srv.ts","setGlobalVariable",""),this.index={...this.index,[k]:{current:se}}}getVariableName(k){this.regex.lastIndex=0;const se=this.regex.exec(k);return se?se.slice(1).find(ne=>ne!==void 0):null}containsTemplate(k){if(!k)return!1;const se=this.getVariableName(k),te=se&&this.getVariableAtIndex(se);return te!=null}variableExists(k){return(0,n.l)("template_srv.ts","variableExists","containsTemplate"),this.containsTemplate(k)}highlightVariablesAsHtml(k){return!k||!(0,t.isString)(k)?k:(k=(0,t.escape)(k),this._replaceWithVariableRegex(k,void 0,(se,te)=>this.getVariableAtIndex(te)?'<span class="template-variable">'+se+"</span>":se))}getAllValue(k){if(k.allValue)return k.allValue;const se=[];for(let te=1;te<k.options.length;te++)se.push(k.options[te].value);return se}getVariableValue(k,se){return se?u(se)(k.value):k.value}getVariableText(k,se){return k.value===se||typeof se!="string"?k.text:se}replace(k,se,te,ne){if(se&&se.__sceneObject){const le=se.__sceneObject.value.valueOf();return r.jh.interpolate(le,k,se,te,ne)}return window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive?r.jh.interpolate(window.__grafanaSceneContext,k,se,te,ne):k?(this.regex.lastIndex=0,this._replaceWithVariableRegex(k,te,(le,re,de,oe)=>{const J=this._evaluateVariableExpression(le,re,de,oe,se);return ne&&ne.push({match:le,variableName:re,fieldPath:de,format:oe,value:J,found:J!==le}),J})):k??""}_evaluateVariableExpression(k,se,te,ne,le){const re=this.getVariableAtIndex(se),de=le?.[se];if(de){const pe=this.getVariableValue(de,te),xe=this.getVariableText(de,pe);if(pe!=null)return x(pe,ne,re,xe)}if(!re){const pe=z[se];return pe?pe(k,te,le,ne):k}if(ne===g.$m.QueryParam||(0,c.EW)(re)){const pe=l.B.get(re.type).getValueForUrl(re),xe=(0,c.EW)(re)?re.id:re.current.text;return x(pe,ne,re,xe)}const oe=this.grafanaVariables.get(re.current.value);if(oe)return x(oe,ne,re);let J=re.current.value,ce=re.current.text;if(this.isAllValue(J)&&(J=this.getAllValue(re),ce=d.Zm,re.allValue&&ne!==g.$m.Text&&ne!==g.$m.PercentEncode))return this.replace(J);if(te){const pe=this.getVariableValue({value:J,text:ce},te);if(pe!=null)return x(pe,ne,re,ce)}return x(J,ne,re,ce)}_replaceWithVariableRegex(k,se,te){return this.regex.lastIndex=0,k.replace(this.regex,(ne,le,re,de,oe,J,ce)=>te(ne,le||re||oe,J,de||ce||se))}isAllValue(k){return k===d.To||Array.isArray(k)&&k[0]===d.To}replaceWithText(k,se){return(0,n.l)("template_srv.ts","replaceWithText()","replace(), and specify the :text format"),this.replace(k,se,"text")}getVariableAtIndex(k){if(k)return this.index[k]?this.index[k]:this.dependencies.getVariableWithName(k)}getAdHocVariables(){return this.dependencies.getFilteredVariables(c.EW)}}const Z=new ee;(0,a.d)(Z);const q=()=>Z},47241:(G,R,e)=>{"use strict";e.d(R,{v:()=>O});var t=e(4200),n=e(8620);const s=`${t.Rp}${t.ui}`,a=`rate(${s}[$__rate_interval])`;function r(M){return M?`${a} ${t.tM}`:`${s} ${t.tM}`}var g=e(84537);function i({title:M,unit:I}){return g.d0.timeseries().setTitle(M).setUnit(I).setOption("legend",{showLegend:!1}).setCustomFieldConfig("fillOpacity",9)}function l({description:M,mainQueryExpr:I,breakdownQueryExpr:L,unit:B}){const j={title:`${t.Rp}`,unit:B},A={refId:"A",expr:I,legendFormat:M},K={...j,title:M,queries:[A],variant:"main",vizBuilder:()=>i({...K})},W={...K,title:`${t.Rp}`,queries:[{...A,legendFormat:M}],vizBuilder:()=>i(W),variant:"preview"},U={...j,queries:[{refId:"A",expr:L,legendFormat:`{{${t.aZ}}}`}],vizBuilder:()=>i(U),variant:"breakdown"};return{preview:W,main:K,breakdown:U,variants:[]}}const d=new Set(["count","total"]),c=new Set(["sum","bucket"]),h={count:"sum",total:"sum"};function o(M){return M==="total"}const m={avg:"average",sum:"overall"};function u(M){return m[M]||M}function p({agg:M,rate:I,unit:L}){const B=r(I),j=I?`${u(M)} per-second rate`:`${u(M)}`,A=`${t.Rp} (${j})`,K=`${M}(${B})`,W=`${M}(${B})by(${t.aZ})`;return l({description:A,mainQueryExpr:K,breakdownQueryExpr:W,unit:L})}function f(M){const I=M.at(-1);if(I==null||c.has(I))throw new Error(`This function does not support a metric suffix of "${I}"`);const L=d.has(I),B=h[I]||"avg",j=o(I)?M.at(-2):I,A=L?(0,n.MM)(j):(0,n.l_)(j);return p({agg:B,unit:A,rate:L})}var y=e(52995);function x({title:M,unit:I}){return g.d0.heatmap().setTitle(M).setUnit(I).setOption("calculate",!1).setOption("color",{mode:y.P7.Scheme,exponent:.5,scheme:"Spectral",steps:32,reverse:!1})}function v({title:M,unit:I}){return g.d0.timeseries().setTitle(M).setUnit(I).setCustomFieldConfig("fillOpacity",9)}function P(M){const I=`${t.Rp}`,L=M.at(-2),B=(0,n.l_)(L),j={title:I,unit:B},A={...j,variant:"p50",queries:[b(50)],vizBuilder:()=>i(A)},K={...j,variant:"p50",queries:[b(50,[t.aZ])],vizBuilder:()=>i(K)},W={...j,variant:"percentiles",queries:[99,90,50].map(F=>b(F)),vizBuilder:()=>v(W)},U={...j,variant:"heatmap",queries:[C()],vizBuilder:()=>x(U)};return{preview:U,main:U,variants:[W,U],breakdown:K}}const E=`rate(${t.Rp}${t.ui}[$__rate_interval])${t.tM}`;function D(M=[]){return`sum by(${["le",...M].join(", ")}) (${E})`}function C(M=[]){return{refId:"Heatmap",expr:D(M),format:"heatmap"}}function b(M,I=[]){const L=M/100;let B=`${M}th Percentile`;return I[0]&&(B=`{{${I[0]}}}`),{refId:`Percentile${M}`,expr:`histogram_quantile(${L}, ${D(I)})`,legendFormat:B}}function T(M){if(M.at(-1)!=="sum")throw new Error('createSummaryMetricQueryDefs is only to be used for metrics that end in "_sum"');const L=M.at(-2),B=(0,n.l_)(L),A=r(!0),K=M.slice(0,-1).join("_"),W=w(`sum(${A})`),U=w(`sum(${A})by(${t.aZ})`),V=`${K} (average)`;function w(z){const N=z.replace(t.Rp,`${K}_sum`),H=z.replace(t.Rp,`${K}_count`);return`${N}/${H}`}return l({description:V,mainQueryExpr:W,breakdownQueryExpr:U,unit:B})}function S(M){return M==="sum"?T:M==="bucket"?P:f}function O(M){const I=M.split("_"),L=I.at(-1),B=S(L);if(!B)throw new Error(`Unable to generate queries for metric "${M}" due to issues with derived suffix "${L}"`);return B(I)}},8620:(G,R,e)=>{"use strict";e.d(R,{MM:()=>l,l_:()=>s,vL:()=>n});const t="short";function n(d){const c=d.split("_"),h=c.at(-1)??"",o=c.at(-2)??"";return r.includes(h)?h:r.includes(o)?o:null}function s(d){return d&&a[d]||t}const a={bytes:"bytes",seconds:"s"},r=["bytes","seconds"],g={bytes:"Bps",seconds:"short"},i="cps";function l(d){return d&&g[d]||i}},73145:(G,R,e)=>{"use strict";e.d(R,{b:()=>W,B:()=>U});var t=e(74848),n=e(32196),s=e(96540),a=e(76885),r=e(12470),g=e(39601),i=e(23172),l=e(84537),d=e(40845),c=e(15292),h=e(83122),o=e(27746),m=e(76412),u=e(12518),p=e(21028),f=e(40588),y=e(51080);class x extends l.Bs{constructor(N){super({stickyMainGraph:N.stickyMainGraph??!0,isOpen:N.isOpen??!1}),this.onToggleStickyMainGraph=()=>{const H=!this.state.stickyMainGraph;(0,f.z)("settings_changed",{stickyMainGraph:H}),this.setState({stickyMainGraph:H})},this.onToggleOpen=H=>{this.setState({isOpen:H})},this.onTogglePreviews=()=>{const H=(0,y.kj)(this);H.setState({showPreviews:!H.state.showPreviews})}}static{this.Component=({model:N})=>{const{stickyMainGraph:H,isOpen:Q}=N.useState(),X=(0,d.of)(v),ee=(0,y.kj)(N),{showPreviews:Z,topScene:q}=ee.useState(),ae=()=>(0,t.jsxs)("div",{className:X.popover,onClick:k=>k.stopPropagation(),children:[(0,t.jsx)("div",{className:X.heading,children:"Settings"}),q instanceof u.R&&(0,t.jsxs)("div",{className:X.options,children:[(0,t.jsx)("div",{children:(0,t.jsx)(m.x,{i18nKey:"trails.settings.always-keep-selected-metric-graph-in-view",children:"Always keep selected metric graph in-view"})}),(0,t.jsx)(c.d,{value:H,onChange:N.onToggleStickyMainGraph})]}),q instanceof p.t&&(0,t.jsxs)("div",{className:X.options,children:[(0,t.jsx)("div",{children:(0,t.jsx)(m.x,{i18nKey:"trails.settings.show-previews-of-metric-graphs",children:"Show previews of metric graphs"})}),(0,t.jsx)(c.d,{value:Z,onChange:N.onTogglePreviews})]})]});return(0,t.jsx)(h.m,{overlay:ae,placement:"bottom",onVisibleChange:N.onToggleOpen,children:(0,t.jsx)(o.I,{icon:"cog",variant:"canvas",isOpen:Q})})}}}function v(z){return{popover:(0,n.css)({display:"flex",padding:z.spacing(2),flexDirection:"column",background:z.colors.background.primary,boxShadow:z.shadows.z3,borderRadius:z.shape.borderRadius(),border:`1px solid ${z.colors.border.weak}`,zIndex:1,marginRight:z.spacing(2)}),heading:(0,n.css)({fontWeight:z.typography.fontWeightMedium,paddingBottom:z.spacing(2)}),options:(0,n.css)({display:"grid",gridTemplateColumns:"1fr 50px",rowGap:z.spacing(1),columnGap:z.spacing(2)})}}var P=e(13054),E=e(90623),D=e(74764),C=e(88434),b=e(81996),T=e(17172);const S=null,O=z=>`count(target_info{${z??""}}) by (job, instance)`,M={key:"__name__",value:"target_info",operator:"="};async function I(z,N,H,Q){const X=(H??[]).concat(S),ee=getPrometheusTime(N.from,!1),Z=getPrometheusTime(N.to,!0),q=`/api/datasources/uid/${z}/resources/api/v1/labels`,ae={start:ee,end:Z,"match[]":`{__name__="target_info"${Q?`,${Q}`:""}}`};return(await getBackendSrv().get(q,ae,"explore-metrics-otel-resources")).data?.filter(te=>!X.includes(te)).map(te=>te)}async function L(z,N,H){const Q=(0,b.mv)(N.from,!1),X=(0,b.mv)(N.to,!0),ee=`/api/datasources/uid/${z}/resources/api/v1/query`,Z={start:Q,end:X,query:O(H)},q=await(0,T.AI)().get(ee,Z,"explore-metrics-otel-check-total");let ae=[],k=[];return q.data.result.forEach(te=>{te.metric.job&&te.metric.instance&&(ae.push(te.metric.job),k.push(te.metric.instance))}),{jobs:ae,instances:k}}async function B(z,N,H){const Q=`/api/datasources/uid/${z}/resources/api/v1/query`,X=getPrometheusTime(N.from,!1),ee=getPrometheusTime(N.to,!0),Z={start:X,end:ee,query:`${O()} > 1`};return!((await getBackendSrv().get(Q,Z,"explore-metrics-otel-check-standard")).data.result.length>0)}async function j(z,N){const H=(0,b.mv)(N.from,!1),Q=(0,b.mv)(N.to,!0),X=`/api/datasources/uid/${z}/resources/api/v1/label/deployment_environment/values`,ee={start:H,end:Q,"match[]":'{__name__="target_info"}'};return(await(0,T.AI)().get(X,ee,"explore-metrics-otel-resources-deployment-env")).data}var A=e(84086),K=e(4200);class W extends l.Bs{constructor(N){super({$timeRange:N.$timeRange??new l.JZ({}),$variables:N.$variables??F(N.initialDS,N.metric,N.initialFilters,N.otelJoinQuery),controls:N.controls??[new l.K8({layout:"vertical"}),new l.N0,new l.KE({}),new l.WM({})],history:N.history??new P.LR({}),settings:N.settings??new x({}),createdAt:N.createdAt??new Date().getTime(),useOtelExperience:N.useOtelExperience??!1,otelJoinQuery:N.otelJoinQuery??"",showPreviews:!0,...N}),this._urlSync=new l.So(this,{keys:["metric","metricSearch"]}),this._variableDependency=new l.Sh(this,{variableNames:[K.EY,K.DU,K.p4,K.Xt],onReferencedVariableValueChanged:async H=>{const{name:Q}=H.state;if(Q===K.EY){this.datasourceHelper.reset(),this.checkDataSourceForOTelResources();const X=l.jh.lookupVariable(K.Ao,this);X instanceof l.H9&&X.setState({filters:[]})}if(this.state.useOtelExperience&&(Q===K.p4||Q===K.DU)){const X=this.state.$timeRange?.state,ee=l.jh.interpolate(this,K.gR),Z=l.jh.lookupVariable(K.p4,this),q=l.jh.lookupVariable(K.DU,this),ae=l.jh.lookupVariable(K.Xt,this);X&&q instanceof l.H9&&ae instanceof l.x0&&Z instanceof l.yP&&this.updateOtelData(ee,X,Z,q,ae)}}}),this._addingFilterWithoutReportingInteraction=!1,this.datasourceHelper=new C.q(this),this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){this.state.topScene||this.setState({topScene:U(this.state.metric)}),this.subscribeToEvent(K.OO,this._handleMetricSelectedEvent.bind(this));const N=l.jh.lookupVariable(K.Ao,this);N instanceof l.H9&&this._subs.add(N?.subscribeToState((Q,X)=>{this._addingFilterWithoutReportingInteraction||(0,f.h)(Q.filters,X.filters)}));const H=()=>(0,D._r)().setRecentTrail(this);return window.addEventListener("unload",H),()=>{this.state.embedded||H(),window.removeEventListener("unload",H)}}addFilterWithoutReportingInteraction(N){const H=l.jh.lookupVariable("filters",this);H instanceof l.H9&&(this._addingFilterWithoutReportingInteraction=!0,H.setState({filters:[...H.state.filters,N]}),this._addingFilterWithoutReportingInteraction=!1)}getMetricMetadata(N){return this.datasourceHelper.getMetricMetadata(N)}getCurrentMetricMetadata(){return this.getMetricMetadata(this.state.metric)}restoreFromHistoryStep(N){!N.topScene&&!N.metric&&(N.topScene=new p.t({})),this.setState(l.Go.cloneSceneObjectState(N,{history:this.state.history,metric:N.metric?N.metric:void 0,metricSearch:N.metricSearch?N.metricSearch:void 0}));const H=new l.g5().getUrlState(this),Q=a.kM.renderUrl(g.Ny.getLocation().pathname,H);g.Ny.replace(Q)}_handleMetricSelectedEvent(N){this.setState(this.getSceneUpdatesForNewMetricValue(N.payload));const H=l.jh.lookupVariable(K.Ao,this);H instanceof l.H9&&H.setState({baseFilters:w(N.payload)})}getSceneUpdatesForNewMetricValue(N){const H={};return H.metric=N,H.topScene=U(N),H}getUrlState(){const{metric:N,metricSearch:H}=this.state;return{metric:N,metricSearch:H}}updateFromUrl(N){const H={};typeof N.metric=="string"?this.state.metric!==N.metric&&Object.assign(H,this.getSceneUpdatesForNewMetricValue(N.metric)):N.metric==null&&(H.metric=void 0,H.topScene=new p.t({})),typeof N.metricSearch=="string"?H.metricSearch=N.metricSearch:N.metric==null&&(H.metricSearch=void 0),this.setState(H)}async checkDataSourceForOTelResources(){const N=(0,y.kj)(this),H=N.state.$timeRange?.state;if(H){const Q=l.jh.lookupVariable(K.DU,this),X=l.jh.lookupVariable(K.p4,this),ee=l.jh.lookupVariable(K.Xt,this),Z=l.jh.lookupVariable(K.Ao,this),q=l.jh.interpolate(N,K.gR),ae=await L(q,H),k=await j(q,H),se=ae.jobs.length>0&&ae.instances.length>0;if(Q instanceof l.H9&&X instanceof l.yP&&ee instanceof l.x0&&Z instanceof l.H9)if(se&&k.length>0){Z.setState({addFilterButtonText:"Select metric attributes",label:"Select metric attribute"});let te="";const ne=k.map(J=>(te+=J+",",{value:J,label:J})),le=ne[0].value,re=X.state.text,oe=re!==""&&re.toLocaleString()!==""?re:le;X?.setState({value:oe,options:ne,hide:r.zL.dontHide}),this.updateOtelData(q,H,X,Q,ee,k,se)}else this.resetOtelExperience(Q,X,ee,Z,se,k)}}async updateOtelData(N,H,Q,X,ee,Z,q){let ae=[M];const k=""+Q?.getValue();if(k){const de=k.includes(",")?"=~":"=",oe={key:"deployment_environment",value:k.split(",").join("|"),operator:de};ae.push(oe)}X.getValue()&&X.state.filters.length>0&&(ae=ae.concat(X.state.filters));const te=this.datasourceHelper;X.setState({getTagKeysProvider:async(de,oe)=>{let J=await te.getTagKeys({filters:ae});return J=(0,A.ql)(J,ae.map(ce=>ce.key).concat(oe??"")),{replace:!0,values:J}},getTagValuesProvider:async(de,oe)=>(ae=ae.filter(ce=>ce.key!==oe.key),{replace:!0,values:await te.getTagValues({key:oe.key,filters:ae})}),hide:r.zL.hideLabel});const ne=(0,A.Dz)(this),le=(0,A.L4)(ne);ee.setState({value:le});const re=await L(N,H,ne.filters);q&&Z?this.setState({otelTargets:re,otelJoinQuery:le,hasOtelResources:q,isStandardOtel:Z.length>0,useOtelExperience:!0}):this.setState({otelTargets:re,otelJoinQuery:le})}resetOtelExperience(N,H,Q,X,ee,Z){X.setState({addFilterButtonText:"Add label",label:"Select label"}),N.setState({defaultKeys:[],hide:r.zL.hideVariable}),H.setState({value:"",hide:r.zL.hideVariable}),Q.setState({value:""}),ee&&Z?this.setState({hasOtelResources:ee,isStandardOtel:Z.length>0,useOtelExperience:!1,otelTargets:{jobs:[],instances:[]},otelJoinQuery:""}):this.setState({otelTargets:{jobs:[],instances:[]},otelJoinQuery:"",useOtelExperience:!1})}static{this.Component=({model:N})=>{const{controls:H,topScene:Q,history:X,settings:ee,useOtelExperience:Z,hasOtelResources:q}=N.useState(),ae=(0,i.k)(),k=(0,d.of)(V,ae??0),se=(0,D._r)().recent.length<2;return(0,s.useEffect)(()=>{if(Z)N.checkDataSourceForOTelResources();else{const te=l.jh.lookupVariable(K.DU,N),ne=l.jh.lookupVariable(K.p4,N),le=l.jh.lookupVariable(K.Xt,N),re=l.jh.lookupVariable(K.Ao,N);te instanceof l.H9&&ne instanceof l.yP&&le instanceof l.x0&&re instanceof l.H9&&N.resetOtelExperience(te,ne,le,re)}},[N,q,Z]),(0,s.useEffect)(()=>{const te=l.jh.lookupVariable(K.Ao,N),ne=N.datasourceHelper;(0,y.FG)(te,ne)},[N]),(0,t.jsxs)("div",{className:k.container,children:[se&&(0,t.jsx)(E.p,{}),(0,t.jsx)(X.Component,{model:X}),H&&(0,t.jsxs)("div",{className:k.controls,children:[H.map(te=>(0,t.jsx)(te.Component,{model:te},te.state.key)),(0,t.jsx)(ee.Component,{model:ee})]}),(0,t.jsx)("div",{className:k.body,children:Q&&(0,t.jsx)(Q.Component,{model:Q})})]})}}}function U(z){return z?new u.R({metric:z}):new p.t({})}function F(z,N,H,Q){return new l.Pj({variables:[new l.mI({name:K.EY,label:"Data source",description:"Only prometheus data sources are supported",value:z,pluginId:"prometheus"}),new l.yP({name:K.p4,label:"Deployment environment",hide:r.zL.hideVariable,value:void 0,placeholder:"Select",isMulti:!0}),new l.H9({name:K.DU,label:"Select resource attributes",addFilterButtonText:"Select resource attributes",datasource:K.GH,hide:r.zL.hideVariable,layout:"vertical",defaultKeys:[],applyMode:"manual"}),new l.H9({name:K.Ao,addFilterButtonText:"Add label",datasource:K.GH,hide:r.zL.hideLabel,layout:"vertical",filters:H??[],baseFilters:w(N),applyMode:"manual",supportsMultiValueOperators:!0}),...(0,K.Mi)(Q??"")]})}function V(z,N){return{container:(0,n.css)({flexGrow:1,display:"flex",gap:z.spacing(1),flexDirection:"column",background:z.isLight?z.colors.background.primary:z.colors.background.canvas,padding:z.spacing(2,3,2,3)}),body:(0,n.css)({flexGrow:1,display:"flex",flexDirection:"column"}),controls:(0,n.css)({display:"flex",gap:z.spacing(1),padding:z.spacing(1,0),alignItems:"flex-end",flexWrap:"wrap",position:"sticky",background:z.isDark?z.colors.background.canvas:z.colors.background.primary,zIndex:z.zIndex.navbarFixed,top:N})}}function w(z){return z?[{key:"__name__",operator:"=",value:z}]:[]}},13054:(G,R,e)=>{"use strict";e.d(R,{LR:()=>E,hi:()=>p});var t=e(74848),n=e(32196),s=e(96540),a=e(91410),r=e(43127),g=e(65879),i=e(84537),l=e(67061),d=e(40845),c=e(56034),h=e(73145),o=e(40588),m=e(4200),u=e(51080);function p(I){return"currentStep"in I&&"steps"in I}function f(I){return!!I}const y=I=>typeof I=="string",x=" $2 ",v=/(\|)(=|=~|!=|>|<|!~)(\|)/g,P={start:"Start of history",metric:"Metric selected:",metric_page:"Metric select page",filters:"Filter applied:",time:"Time range changed:",dep_env:"Deployment environment selected:",resource:"Resource attribute selected:"};class E extends i.Bs{constructor(L){super({steps:L.steps??[],currentStep:L.currentStep??0,filtersApplied:[],otelResources:[],otelDepEnvs:[]}),this.stepTransitionInProgress=!1,this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){const L=(0,u.kj)(this);if(this.state.steps.length===0)if(this.addTrailStep(L,"start"),L.state.metric){const{metric:B,...j}=L.state;j.topScene=(0,h.B)(void 0),this.state.steps[0].trailState=j,this.addTrailStep(L,"metric",L.state.metric)}else this.addTrailStep(L,"metric_page");L.subscribeToState((B,j)=>{B.metric!==j.metric&&(this.state.steps.length===1&&(this.state.steps[0].trailState=i.Go.cloneSceneObjectState(j,{history:this})),B.metric?this.addTrailStep(L,"metric",B.metric):this.addTrailStep(L,"metric_page"))}),L.subscribeToEvent(i.oh,B=>{if(B.payload.state.name===m.Ao){const j=this.state.filtersApplied,A=i.Go.getUrlState(L);this.addTrailStep(L,"filters",C(A,j)),this.setState({filtersApplied:j})}if(B.payload.state.name===m.p4){const j=this.state.otelDepEnvs,A=i.Go.getUrlState(L);this.addTrailStep(L,"dep_env",T(A,j)),this.setState({otelDepEnvs:j})}if(B.payload.state.name===m.DU){const j=this.state.otelResources,A=i.Go.getUrlState(L);this.addTrailStep(L,"resource",b(A,j)),this.setState({otelResources:j})}}),L.subscribeToEvent(i.bZ,B=>{if(B.payload.changedObject instanceof i.JZ){const{prevState:j,newState:A}=B.payload;if((0,u.iG)(j)&&(0,u.iG)(A)){if(j.from===A.from&&j.to===A.to)return;this.addTrailStep(L,"time",D({from:A.from,to:A.to,timeZone:A.timeZone}))}}})}addTrailStep(L,B,j=""){if(this.stepTransitionInProgress)return;const A=this.state.steps.length,K=B==="start"?-1:this.state.currentStep;this.setState({currentStep:A,steps:[...this.state.steps,{type:B,detail:j,description:P[B],trailState:i.Go.cloneSceneObjectState(L.state,{history:this}),parentIndex:K}]})}addTrailStepFromStorage(L,B){if(this.stepTransitionInProgress)return;const j=B.type,A=this.state.steps.length,K=j==="start"?-1:this.state.currentStep,W=this.state.filtersApplied,U=this.state.otelResources,F=this.state.otelDepEnvs;let V="";switch(B.type){case"metric":V=B.urlValues.metric?.toString()??"";break;case"filters":V=C(B.urlValues,W);break;case"time":V=D(B.urlValues);break;case"dep_env":V=T(B.urlValues,F);case"resource":V=b(B.urlValues,U)}this.setState({filtersApplied:W,otelDepEnvs:F,otelResources:U,currentStep:A,steps:[...this.state.steps,{type:j,detail:V,description:P[j],trailState:i.Go.cloneSceneObjectState(L.state,{history:this}),parentIndex:K}]})}goBackToStep(L){if(L===this.state.currentStep)return;const B=this.state.steps[L],j=B.type==="metric"&&B.trailState.metric===void 0?"metric-clear":B.type;(0,o.z)("history_step_clicked",{type:j,step:L,numberOfSteps:this.state.steps.length}),this.stepTransitionInProgress=!0,this.setState({currentStep:L}),(0,u.kj)(this).restoreFromHistoryStep(B.trailState),this.stepTransitionInProgress=!1}renderStepTooltip(L){return(0,t.jsxs)(l.B,{direction:"column",children:[(0,t.jsx)("div",{children:L.description}),L.detail!==""&&(0,t.jsx)("div",{children:L.detail})]})}static{this.Component=({model:L})=>{const{steps:B,currentStep:j}=L.useState(),A=(0,d.of)(S),{ancestry:K,alternatePredecessorStyle:W}=(0,s.useMemo)(()=>{const U=new Set;let F=j;for(;F>=0;){const w=B[F];if(!w)break;U.add(F),F=w.parentIndex}const V=new Map;return U.forEach(w=>{const z=B[w].parentIndex;z+1!==w&&V.set(w,M(w,z))}),{ancestry:U,alternatePredecessorStyle:V}},[j,B]);return(0,t.jsxs)("div",{className:A.container,children:[(0,t.jsx)("div",{className:A.heading,children:"History"}),B.map((U,F)=>{let V=U.type;return V==="metric"&&U.trailState.metric===void 0&&(V="start"),(0,t.jsx)(c.m,{content:()=>L.renderStepTooltip(U),children:(0,t.jsx)("button",{className:(0,n.cx)(A.step,A.stepTypes[V],j===F?A.stepSelected:"",W.get(F)??"",F!==U.parentIndex+1?A.stepOmitsDirectLeftLink:"",F===0?A.stepOmitsDirectLeftLink:"",K.has(F)?"":A.stepIsNotAncestorOfCurrent),onClick:()=>L.goBackToStep(F)})},F)})]})}}}function D(I){if(!(0,u.iG)(I))return"";const L=(0,g.convertRawToRange)({from:I.from,to:I.to}),B=y(I.timeZone)?I.timeZone:a.g$.localBrowserTime,j=(0,a.QZ)(B,Date.now()),A=L.from.subtract(j?.offsetInMins??0,"minute").format(r.G$),K=L.to.subtract(j?.offsetInMins??0,"minute").format(r.G$);return`${A} - ${K}`}function C(I,L){let B="";const j=I["var-filters"];return f(j)&&(B=j.filter(A=>A!==""&&!L.includes(A)?(L.push(A),!0):!1)[0]??""),B.replace(v,x)}function b(I,L){let B="";const j=I["var-otel_resources"];return f(j)&&(B=j.filter(A=>A!==""&&!L.includes(A)?(L.push(A),!0):!1)[0]??""),B.replace(v,x)}function T(I,L){let B="";const j=I["var-deployment_environment"];return typeof j=="string"?j:(f(j)&&(B=j?.filter(A=>A!==""&&!L.includes(A)?(L.push(A),!0):!1)[0]??""),B)}function S(I){const L=I.visualization;return{container:(0,n.css)({display:"flex",gap:10,alignItems:"center"}),heading:(0,n.css)({}),step:(0,n.css)({flexGrow:0,cursor:"pointer",border:"none",boxShadow:"none",padding:0,margin:0,width:8,height:8,opacity:.7,borderRadius:I.shape.radius.circle,background:I.colors.primary.main,position:"relative","&:hover":{opacity:1},"&:hover:before":{opacity:.7},"&:before":{content:'""',position:"absolute",width:10,height:2,left:-10,top:3,background:I.colors.primary.border,pointerEvents:"none"}}),stepSelected:(0,n.css)({"&:after":{content:'""',borderStyle:"solid",borderWidth:2,borderRadius:"50%",position:"absolute",width:16,height:16,left:-4,top:-4,boxShadow:`0px 0px 0px 2px inset ${I.colors.background.canvas}`}}),stepOmitsDirectLeftLink:(0,n.css)({"&:before":{background:"none"}}),stepIsNotAncestorOfCurrent:(0,n.css)({opacity:.2,"&:hover:before":{opacity:.2}}),stepTypes:{start:O(L.getColorByName("green")),filters:O(L.getColorByName("purple")),metric:O(L.getColorByName("orange")),metric_page:O(L.getColorByName("orange")),time:O(I.colors.primary.main),resource:O(L.getColorByName("purple")),dep_env:O(L.getColorByName("purple"))}}}function O(I){return(0,n.css)({background:I,"&:before":{background:I,borderColor:I},"&:after":{borderColor:I}})}function M(I,L){const A=(I-L)*18;return(0,n.css)({"&:before":{content:'""',width:A+2,height:10,borderStyle:"solid",borderWidth:2,borderBottom:"none",borderTopLeftRadius:8,borderTopRightRadius:8,top:-10,left:3-A,background:"none"}})}},12518:(G,R,e)=>{"use strict";e.d(R,{k:()=>rt,R:()=>He});var t=e(74848),n=e(32196),s=e(32264),a=e(84537),r=e(40845),g=e(90613),i=e(67061),l=e(27746),d=e(14578),c=e(55852),h=e(63021),o=e(40675),m=e(56034),u=e(87490),p=e(94753),f=e(72109),y=e(8484),x=e(8620),v=e(69096),P=e(40588),E=e(4200),D=e(51080);class C extends a.Bs{constructor(Te){super({...Te}),this._variableDependency=new a.Sh(this,{variableNames:[E.gR],onReferencedVariableValueChanged:this.onReferencedVariableValueChanged.bind(this)}),this.addActivationHandler(this._onActivate.bind(this))}getVariable(){const Te=a.jh.lookupVariable(E.yr,this);if(!(Te instanceof a.fS))throw new Error("Group by variable not found");return Te}_onActivate(){this.updateMetadata()}onReferencedVariableValueChanged(){this.updateMetadata()}async updateMetadata(){this.setState({metadataLoading:!0,metadata:void 0});const Oe=(0,D.aM)(this).state.metric,Ge=await(0,D.kj)(this).getMetricMetadata(Oe);this.setState({metadata:Ge,metadataLoading:!1})}static{this.Component=({model:Te})=>{const{metadata:Oe,metadataLoading:Ye}=Te.useState(),Ge=Te.getVariable(),{loading:Je,options:it}=Ge.useState(),{useOtelExperience:St}=(0,D.kj)(Te).useState(),Kt=(0,D.aM)(Te).state.metric;let Qt=(0,x.vL)(Kt)??"Unknown";return(0,t.jsx)(v.O,{isLoading:Je||Ye,children:(0,t.jsx)(i.B,{gap:6,children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.B,{direction:"column",gap:.5,children:[(0,t.jsx)(p.E,{weight:"medium",children:(0,t.jsx)(y.x6,{i18nKey:"trails.metric-overview.description-label",children:"Description"})}),(0,t.jsx)("div",{style:{maxWidth:360},children:Oe?.help?(0,t.jsx)("div",{children:Oe?.help}):(0,t.jsx)("i",{children:(0,t.jsx)(y.x6,{i18nKey:"trails.metric-overview.no-description",children:"No description available"})})})]}),(0,t.jsxs)(i.B,{direction:"column",gap:.5,children:[(0,t.jsx)(p.E,{weight:"medium",children:(0,t.jsx)(y.x6,{i18nKey:"trails.metric-overview.type-label",children:"Type"})}),Oe?.type?(0,t.jsx)("div",{children:Oe?.type}):(0,t.jsx)("i",{children:(0,t.jsx)(y.x6,{i18nKey:"trails.metric-overview.unknown-type",children:"Unknown"})})]}),(0,t.jsxs)(i.B,{direction:"column",gap:.5,children:[(0,t.jsx)(p.E,{weight:"medium",children:(0,t.jsx)(y.x6,{i18nKey:"trails.metric-overview.unit-label",children:"Unit"})}),Oe?.unit?(0,t.jsx)("div",{children:Oe?.unit}):(0,t.jsx)("i",{children:Qt})]}),(0,t.jsxs)(i.B,{direction:"column",gap:.5,children:[(0,t.jsx)(p.E,{weight:"medium",children:St?(0,t.jsx)(y.x6,{i18nKey:"trails.metric-overview.metric-attributes",children:"Metric attributes"}):(0,t.jsx)(y.x6,{i18nKey:"trails.metric-overview.labels",children:"Labels"})}),it.length===0&&"Unable to fetch labels.",it.map(an=>(0,t.jsx)(f.Y,{href:`#View breakdown for ${an.label}`,title:`View breakdown for ${an.label}`,onClick:Nn=>{Nn.preventDefault(),Nn.stopPropagation(),a.jh.getAncestor(Te,He).setActionView("breakdown");const zn=a.jh.lookupVariable(E.yr,Te);return zn instanceof a.fS&&an.label!=null&&((0,P.z)("label_selected",{label:an.label,cause:"overview_link"}),zn.setState({value:an.value})),!1},children:an.label},an.label))]})]})})})}}}function b(){return new C({})}var T=e(21028);function S(){return new T.t({})}var O=e(47241),M=e(2543),I=e(11261),L=e(88575),B=e(39558),j=e(90182);function A({options:De,value:Te,onChange:Oe}){const Ye=(0,r.of)(K);return(0,t.jsx)(j.l6,{options:De,value:Te,onChange:Ge=>Oe(Ge.value),className:Ye.select})}function K(De){return{select:(0,n.css)({maxWidth:De.spacing(16)})}}const W="$__all";class U extends a.Bs{constructor(){super(...arguments),this.onClick=()=>{if(!(a.jh.lookupVariable("filters",this)instanceof a.H9))return;const Oe=this.state.frame.fields[1]?.labels??{};if(Object.keys(Oe).length!==1)return;const Ye=Object.keys(Oe)[0];(0,P.z)("label_filter_changed",{label:Ye,action:"added",cause:"breakdown"});const Ge=(0,D.kj)(this),Je={key:Ye,operator:"=",value:Oe[Ye]};Ge.addFilterWithoutReportingInteraction(Je)}}static{this.Component=({model:Te})=>{const Ye=Te.useState().frame.fields[1]?.labels||{};return Object.keys(Ye).length!==0?(0,t.jsx)(c.$n,{variant:"secondary",size:"sm",fill:"solid",onClick:Te.onClick,children:"Add to filters"}):null}}}var F=e(65463),V=e(39070),w=e(42418);function z(De){const Te=De.fields[1]?.labels;if(!Te)return null;const Oe=Object.keys(Te);return Oe.length===0?null:Te[Oe[0]]}var N=e(53076);const H=new N.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1});function Q(De,Te,Oe){const[Ye,Ge,Je]=H.search(De,Te,0,1e5);let it=[],St=new Set;if(Ye&&Je){const zt=(Kt,Qt)=>{Qt&&St.add(Kt)};for(let Kt=0;Kt<Je.length;Kt++){let Qt=Je[Kt];N.A.highlight(De[Ge.idx[Qt]],Ge.ranges[Qt],zt),it.push(De[Ge.idx[Qt]])}Oe([it,[...St]])}else Te||Oe([])}const X=(0,M.debounce)(Q,300);function ee(De,Te){const Oe=a.jh.lookupVariable(E.Ao,De),Ye=[];if(!(Oe instanceof a.H9))return[];const Ge=Oe.state.filters;for(const Je of Te.getOptionsForSelect()){const it=Ge.find(St=>St.key===Je.value);Je.label!=="le"&&(it||Ye.push({label:Je.label,value:String(Je.value)}))}return Ye}function Z(De,Te){const Oe=sceneGraph.findObject(De,Ye=>Ye instanceof Te);return Oe instanceof Te?Oe:null}function q(De,Te){function Oe(Ge){return Ge instanceof Te}return a.jh.findAllObjects(De,Oe).filter(Oe)}class ae extends a.Bs{constructor({getFilter:Te,...Oe}){super(Oe),this.unfilteredChildren=[],this.series=[],this.filterByString=Ye=>{let Ge=[];this.iterateFrames((Je,it)=>{const St=te(Je[it]);Ge.push(St)}),Q(Ge,Ye,Je=>{Je&&Je[0]?this.filterFrames(it=>{const St=te(it);return Je[0].includes(St)}):this.filterFrames(()=>!0)})},this.iterateFrames=Ye=>{if(a.jh.getData(this).state.data)for(let Je=0;Je<this.series.length;Je++)Ye(this.series,Je)},this.filterFrames=Ye=>{const Ge=[];this.iterateFrames((Je,it)=>{Ye(Je[it])&&Ge.push(this.unfilteredChildren[it])}),Ge.length===0?this.state.body.setState({children:[k(this.getFilter(),this.clearFilter)]}):this.state.body.setState({children:Ge})},this.clearFilter=()=>{this.publishEvent(new de,!0)},this.getFilter=Te,this.addActivationHandler(()=>{const Ye=a.jh.getData(this);this._subs.add(Ye.subscribeToState((Ge,Je)=>{if(Ge.data===void 0)return;const it=Ge.data;Ge.data?.state!==Je.data?.state&&q(this,a.Zv).forEach(St=>{St.setState({data:{...St.state.data,state:it.state}})}),it.state===V.Gu.Done&&this.performRepeat(it)})),Ye.state.data&&this.performRepeat(Ye.state.data)})}performRepeat(Te){const Oe=[];this.series=Te.series;for(let Ye=0;Ye<this.series.length;Ye++){const Ge=this.state.getLayoutChild(Te,this.series[Ye],Ye);Oe.push(Ge)}this.unfilteredChildren=Oe,this.getFilter()?(this.state.body.setState({children:[]}),this.filterByString(this.getFilter())):this.state.body.setState({children:Oe})}static{this.Component=({model:Te})=>{const{body:Oe}=Te.useState();return(0,t.jsx)(Oe.Component,{model:Oe})}}}function k(De,Te){return new a.G1({direction:"row",children:[new a.vA({body:new a.dM({reactNode:(0,t.jsx)("div",{className:se.alertContainer,children:(0,t.jsxs)(w.F,{title:"",severity:"info",className:se.noResultsAlert,children:[(0,t.jsxs)(y.x6,{i18nKey:"explore-metrics.breakdown.noMatchingValue",children:["No values found matching; ",{filter:De}]}),(0,t.jsx)(c.$n,{className:se.clearButton,onClick:Te,children:(0,t.jsx)(y.x6,{i18nKey:"explore-metrics.breakdown.clearFilter",children:"Clear filter"})})]})})})})]})}const se={alertContainer:(0,n.css)({flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center"}),noResultsAlert:(0,n.css)({minWidth:"30vw",flexGrow:0}),clearButton:(0,n.css)({marginLeft:"1.5rem"})};function te(De){return z(De)??"No labels"}var ne=e(10354);const le=({value:De,onChange:Te,placeholder:Oe,onClear:Ye,...Ge})=>(0,t.jsx)(ne.p,{value:De,onChange:Te,suffix:De?(0,t.jsx)(d.I,{onClick:Ye,title:"Clear search",name:"times",className:re.clearIcon}):void 0,prefix:(0,t.jsx)(d.I,{name:"search"}),placeholder:Oe,...Ge}),re={clearIcon:(0,n.css)({cursor:"pointer"})};class de extends F.a{static{this.type="breakdown-search-reset"}}const oe={};class J extends a.Bs{constructor(Te){super({filter:oe[Te]??""}),this.onValueFilterChange=Oe=>{this.setState({filter:Oe.target.value}),this.filterValues(Oe.target.value)},this.clearValueFilter=()=>{this.setState({filter:""}),this.filterValues("")},this.reset=()=>{this.setState({filter:""}),oe[this.cacheKey]=""},this.cacheKey=Te}static{this.Component=({model:Te})=>{const{filter:Oe}=Te.useState();return(0,t.jsx)(le,{value:Oe,onChange:Te.onValueFilterChange,onClear:Te.clearValueFilter,placeholder:"Search for value"})}}filterValues(Te){this.parent instanceof Ae&&(oe[this.cacheKey]=Te,this.parent.state.body?.forEachChild(Ye=>{Ye instanceof ae&&Ye.state.body.isActive&&Ye.filterByString(Te)}))}}var ce=e(94354);function pe(){return localStorage.getItem(E.Pp)??"grid"}function xe(De){return localStorage.setItem(E.Pp,De??"grid")}const fe=["single","grid","rows"];function Ee(De){return fe.includes(De)}class Se extends a.Bs{constructor(Te){const Oe=pe();super({activeBreakdownLayout:Ee(Oe)?Oe:"grid",...Te}),this._urlSync=new a.So(this,{keys:["breakdownLayout"]}),this.onLayoutChange=Ye=>{this.state.activeBreakdownLayout!==Ye&&((0,P.z)("breakdown_layout_changed",{layout:Ye}),xe(Ye),this.setState({activeBreakdownLayout:Ye}),this.state.onBreakdownLayoutChange(Ye))}}getUrlState(){return{breakdownLayout:this.state.activeBreakdownLayout}}updateFromUrl(Te){const Oe=Te.breakdownLayout;Oe==="string"&&Ee(Oe)&&this.state.activeBreakdownLayout!==Oe&&this.setState({activeBreakdownLayout:Oe})}Selector({model:Te}){const{activeBreakdownLayout:Oe,breakdownLayoutOptions:Ye}=Te.useState();return(0,t.jsx)(ce.z,{options:Ye,value:Oe,onChange:Te.onLayoutChange})}static{this.Component=({model:Te})=>{const{breakdownLayouts:Oe,breakdownLayoutOptions:Ye,activeBreakdownLayout:Ge}=Te.useState(),Je=Ye.findIndex(St=>St.value===Ge);if(Je===-1)return null;const it=Oe[Je];return(0,t.jsx)(it.Component,{model:it})}}}var ye=e(52622);const Ve=a.zd.timeseries().setOption("tooltip",{mode:ye.$N.Multi,sort:ye.xB.Descending}).setOption("legend",{showLegend:!1}).build();class Me extends F.x{static{this.type="selected-metric-query-results-event"}}const Ce=De=>{const Te=a.jh.getAncestor(De,Ae);q(De,a.Eb).forEach(Ge=>{Ge.isActive?Oe(Ge.state.$data):Ge.addActivationHandler(()=>{Oe(Ge.state.$data)})}),q(De,a.Eb).forEach(Ge=>Oe(Ge.state.$data));function Oe(Ge){Ge&&(Ge.isActive||Ge.addActivationHandler(()=>{Oe(Ge)}),Ge.state.data&&Te.reportBreakdownPanelData(Ge.state.data),Ge.subscribeToState(({data:Je},it)=>{Te.reportBreakdownPanelData(Je)}))}const Ye=Te.subscribeToEvent(Me,Ge=>{if(!De.isActive){Ye.unsubscribe();return}const Je=a.No.timeseries().setCustomFieldConfig("axisSoftMin",Ge.payload.min).setCustomFieldConfig("axisSoftMax",Ge.payload.max).build();q(De,a.Eb).forEach(it=>{function St(){it.onFieldConfigChange(Je)}it.isActive?St():it.addActivationHandler(St)})})},Ue=60;class Ae extends a.Bs{constructor(Te){super({...Te,labels:Te.labels??[],search:new J("labels")}),this._variableDependency=new a.Sh(this,{variableNames:[E.Ao],onReferencedVariableValueChanged:this.onReferencedVariableValueChanged.bind(this)}),this._triggerAxisChangedEvent=(0,M.throttle)(()=>{const{breakdownPanelMinValue:Oe,breakdownPanelMaxValue:Ye}=this;Oe!==void 0&&Ye!==void 0&&this.publishEvent(new Me({min:Oe,max:Ye}))},1e3),this.onBreakdownLayoutChange=Oe=>{this.clearBreakdownPanelAxisValues()},this.onChange=Oe=>{if(!Oe)return;(0,P.z)("label_selected",{label:Oe,cause:"selector"}),this.getVariable().changeValueTo(Oe)},this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){const Te=this.getVariable();Te.subscribeToState((Je,it)=>{(Je.options!==it.options||Je.value!==it.value||Je.loading!==it.loading)&&this.updateBody(Te)}),this._subs.add(this.subscribeToEvent(de,()=>{this.state.search.clearValueFilter()}));const Ye=a.jh.getAncestor(this,He).state.metric;this._query=(0,O.v)(Ye).breakdown,(0,D.kj)(this).state.$timeRange?.subscribeToState(()=>{this.clearBreakdownPanelAxisValues()}),this.updateBody(Te)}reportBreakdownPanelData(Te){if(!Te)return;let Oe=this.breakdownPanelMinValue,Ye=this.breakdownPanelMaxValue;Te.series.forEach(Ge=>{Ge.fields.forEach(Je=>{if(Je.type!==I.PU.number)return;const it=Je.values.filter(M.isNumber),St=(0,M.max)(it),zt=(0,M.min)(it);Ye=(0,M.max)([Ye,St].filter(M.isNumber)),Oe=(0,M.min)([Oe,zt].filter(M.isNumber))})}),!(Ye===void 0||Oe===void 0||!Number.isFinite(Ye+Oe))&&(this.breakdownPanelMaxValue===Ye&&this.breakdownPanelMinValue===Oe||(this.breakdownPanelMaxValue=Ye,this.breakdownPanelMinValue=Oe,this._triggerAxisChangedEvent()))}clearBreakdownPanelAxisValues(){this.breakdownPanelMaxValue=void 0,this.breakdownPanelMinValue=void 0}getVariable(){const Te=a.jh.lookupVariable(E.yr,this);if(!(Te instanceof a.fS))throw new Error("Group by variable not found");return Te}onReferencedVariableValueChanged(){const Te=this.getVariable();Te.changeValueTo(W),this.updateBody(Te)}updateBody(Te){const Oe=ee(this,Te),Ye={loading:Te.state.loading,value:String(Te.state.value),labels:Oe,error:Te.state.error,blockingMessage:void 0};!Te.state.loading&&Te.state.options.length?Ye.body=Te.hasAllValue()?We(Oe,this._query,this.onBreakdownLayoutChange):at(this._query,this.onBreakdownLayoutChange,this.state.search):Te.state.loading||(Ye.body=void 0,Ye.blockingMessage="Unable to retrieve label options for currently selected metric."),this.clearBreakdownPanelAxisValues(),this.setState(Ye)}static{this.Component=({model:Te})=>{const{labels:Oe,body:Ye,search:Ge,loading:Je,value:it,blockingMessage:St}=Te.useState(),zt=(0,r.of)(we),{useOtelExperience:Kt}=(0,D.kj)(Te).useState();return(0,t.jsx)("div",{className:zt.container,children:(0,t.jsxs)(v.O,{isLoading:Je,blockingMessage:St,children:[(0,t.jsxs)("div",{className:zt.controls,children:[!Je&&!!Oe.length&&(0,t.jsx)(L.D,{label:Kt?"By metric attribute":"By label",children:(0,t.jsx)(A,{options:Oe,value:it,onChange:Te.onChange})}),it!==W&&(0,t.jsx)(L.D,{label:"Search",className:zt.searchField,children:(0,t.jsx)(Ge.Component,{model:Ge})}),Ye instanceof Se&&(0,t.jsx)(L.D,{label:"View",children:(0,t.jsx)(Ye.Selector,{model:Ye})})]}),(0,t.jsx)("div",{className:zt.content,children:Ye&&(0,t.jsx)(Ye.Component,{model:Ye})})]})})}}}function we(De){return{container:(0,n.css)({flexGrow:1,display:"flex",minHeight:"100%",flexDirection:"column",paddingTop:De.spacing(1)}),content:(0,n.css)({flexGrow:1,display:"flex",paddingTop:De.spacing(0)}),searchField:(0,n.css)({flexGrow:1}),controls:(0,n.css)({flexGrow:0,display:"flex",alignItems:"flex-end",gap:De.spacing(2),justifyContent:"space-between"})}}function We(De,Te,Oe){const Ye=[];for(const Ge of De){if(Ge.value===W)continue;if(Ye.length===Ue)break;const Je=Te.queries[0].expr.replaceAll(E.aZ,String(Ge.value)),it=Te.unit,St=a.d0.timeseries().setTitle(Ge.label).setData(new a.dt({maxDataPoints:E.up,datasource:E.GH,queries:[{refId:`A-${Ge.label}`,expr:Je,legendFormat:`{{${Ge.label}}}`}]})).setHeaderActions(new It({labelName:String(Ge.value)})).setUnit(it).setBehaviors([Ie]).build();St.addActivationHandler(()=>{St.onOptionsChange(Ve)}),Ye.push(new a.xK({$behaviors:[Ce],body:St}))}return new Se({breakdownLayoutOptions:[{value:"grid",label:"Grid"},{value:"rows",label:"Rows"}],onBreakdownLayoutChange:Oe,breakdownLayouts:[new a.gF({templateColumns:_e,autoRows:"200px",children:Ye,isLazy:!0}),new a.gF({templateColumns:"1fr",autoRows:"200px",children:Ye.map(Ge=>Ge.clone()),isLazy:!0})]})}const _e="repeat(auto-fit, minmax(400px, 1fr))";function at(De,Te,Oe){const Ye=De.unit;function Ge(it,St,zt){const Kt=De.vizBuilder().setTitle(ut(St)).setData(new a.Zv({data:{...it,series:[St]}})).setColor({mode:"fixed",fixedColor:(0,D.Vy)(zt)}).setHeaderActions(new U({frame:St})).setUnit(Ye).build(),Qt=St.length<=1,an=new a.xK({$behaviors:[Ce],body:Kt,isHidden:Qt});return Kt.addActivationHandler(()=>{Kt.onOptionsChange(Ve)}),an}const Je=()=>Oe.state.filter??"";return new Se({$data:new a.dt({datasource:E.GH,maxDataPoints:E.up,queries:De.queries}),breakdownLayoutOptions:[{value:"single",label:"Single"},{value:"grid",label:"Grid"},{value:"rows",label:"Rows"}],onBreakdownLayoutChange:Te,breakdownLayouts:[new a.G1({direction:"column",children:[new a.vA({minHeight:300,body:a.d0.timeseries().setTitle("$metric").build()})]}),new ae({body:new a.gF({templateColumns:_e,autoRows:"200px",children:[new a.vA({body:new a.dM({reactNode:(0,t.jsx)(B._,{text:"Loading..."})})})]}),getLayoutChild:Ge,getFilter:Je}),new ae({body:new a.gF({templateColumns:"1fr",autoRows:"200px",children:[]}),getLayoutChild:Ge,getFilter:Je})]})}function ut(De){const Te=De.fields[1]?.labels||{},Oe=Object.keys(Te);return Oe.length===0?"<unspecified>":Te[Oe[0]]}function Tt(){return new Ae({})}class It extends a.Bs{constructor(){super(...arguments),this.onClick=()=>{const Te=this.state.labelName;(0,P.z)("label_selected",{label:Te,cause:"breakdown_panel"}),ge(this).onChange(Te)}}static{this.Component=({model:Te})=>(0,t.jsx)(c.$n,{variant:"secondary",size:"sm",fill:"solid",onClick:Te.onClick,children:(0,t.jsx)(y.x6,{i18nKey:"explore-metrics.breakdown.labelSelect",children:"Select"})})}}function ge(De){if(De instanceof Ae)return De;if(De.parent)return ge(De.parent);throw new Error("Unable to find breakdown scene")}function Ie(De){De.state.$data?.subscribeToState((Te,Oe)=>{const Ye=Te.data?.request?.targets[0];if(ue(Ye)){const{legendFormat:Ge}=Ye,Je=Ge.slice(2,-2);Te.data?.series.forEach(it=>{if(!it.fields[1].labels?.[Je]){const St=it.fields[1].labels;St&&(St[Je]=`<unspecified ${Je}>`)}})}})}function ue(De){return De!==void 0&&"legendFormat"in De&&typeof De.legendFormat=="string"}var me=e(94624),Pe=e(23172);class Ne extends a.Bs{constructor(Te){super(Te),this.onChangeQuery=Oe=>{const Ye=(0,D.aM)(this),Ge=Ye.state.autoQuery.variants.find(Je=>Je.variant===Oe);this.setState({panel:this.getVizPanelFor(Ge)}),Ye.setState({queryDef:Ge})},this.addActivationHandler(this.onActivate.bind(this))}onActivate(){if(!this.state.panel){const{autoQuery:Te}=(0,D.aM)(this).state;this.setState({panel:this.getVizPanelFor(Te.main)})}}getQuerySelector(Te){const{autoQuery:Oe}=(0,D.aM)(this).state;if(Oe.variants.length===0)return;const Ye=Oe.variants.map(Ge=>({label:Ge.variant,value:Ge.variant}));return(0,t.jsx)(ce.z,{size:"sm",options:Ye,value:Te.variant,onChange:this.onChangeQuery})}getVizPanelFor(Te){return Te.vizBuilder().setData(new a.dt({datasource:E.GH,maxDataPoints:E.dc,queries:Te.queries})).setHeaderActions(this.getQuerySelector(Te)).build()}static{this.Component=({model:Te})=>{const{panel:Oe}=Te.useState();if(Oe)return(0,t.jsx)(Oe.Component,{model:Oe})}}}const Fe=280,Be="40%";class he extends a.Bs{constructor(Te){super({topView:Te.topView??Ke(),...Te})}static{this.Component=({model:Te})=>{const{topView:Oe,selectedTab:Ye}=Te.useState(),{stickyMainGraph:Ge}=(0,D.KE)(Te).useState(),Je=(0,Pe.k)(),it=(0,r.of)(be,Je??0);return(0,t.jsxs)("div",{className:it.container,children:[(0,t.jsx)("div",{className:Ge?it.sticky:it.nonSticky,children:(0,t.jsx)(Oe.Component,{model:Oe})}),Ye&&(0,t.jsx)(Ye.Component,{model:Ye})]})}}}function be(De,Te){return{container:(0,n.css)({display:"flex",flexDirection:"column",position:"relative"}),sticky:(0,n.css)({display:"flex",flexDirection:"row",background:De.isLight?De.colors.background.primary:De.colors.background.canvas,position:"sticky",top:`${Te+70}px`,zIndex:10}),nonSticky:(0,n.css)({display:"flex",flexDirection:"row"})}}function Ke(){return new a.G1({direction:"column",$behaviors:[new a.Gg.K2({key:"metricCrosshairSync",sync:me.y.Crosshair})],children:[new a.vA({minHeight:Fe,maxHeight:Be,body:new Ne({})}),new a.vA({ySizing:"content",body:new rt({})})]})}var ze=e(96540);const nt=({trail:De})=>{const[Te,Oe]=(0,ze.useState)("Copy url"),Ye=()=>{if(navigator.clipboard){(0,P.z)("selected_metric_action_clicked",{action:"share_url"});const Je=(s.$.appUrl.endsWith("/")?s.$.appUrl.slice(0,-1):s.$.appUrl)+(0,D.xi)(De);navigator.clipboard.writeText(Je),Oe("Copied!"),setTimeout(()=>{Oe("Copy url")},2e3)}};return(0,t.jsx)(l.I,{variant:"canvas",icon:"share-alt",tooltip:Te,onClick:Ye})};var tt=e(13054),ot=e(74764);function gt(De){const Te=()=>(0,ot._r)().getBookmarkIndex(De),Oe=Te(),[Ye,Ge]=(0,ze.useState)(Oe);(0,ze.useEffect)(()=>{const zt=De.subscribeToEvent(a.bZ,({payload:{prevState:Kt,newState:Qt}})=>{(0,tt.hi)(Kt)&&(0,tt.hi)(Qt)&&Qt.steps.length>Kt.steps.length&&Ge((0,ot._r)().getBookmarkIndex(De))});return()=>zt.unsubscribe()},[De]),Oe!==Ye&&Ge(Oe);const Je=Ye!=null;return[Je,()=>{if((0,P.z)("bookmark_changed",{action:Je?"toggled_off":"toggled_on"}),Je){let zt=Te();for(;zt!=null;)(0,ot._r)().removeBookmark(zt),zt=Te()}else(0,ot._r)().addBookmark(De);Ge(Te())}]}class He extends a.Bs{constructor(Te){const Oe=Te.autoQuery??(0,O.v)(Te.metric);super({$variables:Te.$variables??ft(Te.metric),body:Te.body??new he({}),autoQuery:Oe,queryDef:Te.queryDef??Oe.main,...Te}),this._urlSync=new a.So(this,{keys:["actionView"]}),this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){this.state.actionView===void 0&&this.setActionView("overview")}getUrlState(){return{actionView:this.state.actionView}}updateFromUrl(Te){if(typeof Te.actionView=="string"){if(this.state.actionView!==Te.actionView){const Oe=et.find(Ye=>Ye.value===Te.actionView);Oe&&this.setActionView(Oe.value)}}else Te.actionView===null&&this.setActionView(void 0)}setActionView(Te){const{body:Oe}=this.state,Ye=et.find(Ge=>Ge.value===Te);Ye&&Ye.value!==this.state.actionView?(Oe.state.topView.state.children[0].setState({maxHeight:Fe}),Oe.setState({selectedTab:Ye.getScene()}),this.setState({actionView:Ye.value})):(Oe.state.topView.state.children[0].setState({maxHeight:Be}),Oe.setState({selectedTab:void 0}),this.setState({actionView:void 0}))}static{this.Component=({model:Te})=>{const{body:Oe}=Te.useState();return(0,t.jsx)(Oe.Component,{model:Oe})}}}const et=[{displayName:"Overview",value:"overview",getScene:b},{displayName:"Breakdown",value:"breakdown",getScene:Tt},{displayName:"Related metrics",value:"related",getScene:S,description:"Relevant metrics based on current label filters"}];class rt extends a.Bs{constructor(){super(...arguments),this.getLinkToExplore=async()=>{const Te=a.jh.getAncestor(this,He),Oe=(0,D.kj)(this),Ye=(0,D.U4)(Oe),Ge=Te.state.queryDef?.queries||[],Je=a.jh.getTimeRange(this);return(0,u.Xe)({queries:Ge,dsRef:{uid:Ye},timeRange:Je.state.value,scopedVars:{__sceneObject:{value:Te}}})},this.openExploreLink=async()=>{(0,P.z)("selected_metric_action_clicked",{action:"open_in_explore"}),this.getLinkToExplore().then(Te=>{const Oe=`${s.$.appSubUrl}${Te}`;window.open(Oe,"_blank")})}}static{this.Component=({model:Te})=>{const Oe=a.jh.getAncestor(Te,He),Ye=(0,r.of)(ht),Ge=(0,D.kj)(Te),[Je,it]=gt(Ge),{actionView:St}=Oe.useState();return(0,t.jsxs)(g.a,{paddingY:1,children:[(0,t.jsx)("div",{className:Ye.actions,children:(0,t.jsxs)(i.B,{gap:1,children:[(0,t.jsx)(l.I,{variant:"canvas",tooltip:"Remove existing metric and choose a new metric",onClick:()=>{(0,P.z)("selected_metric_action_clicked",{action:"unselect"}),Ge.publishEvent(new E.OO(void 0))},children:"Select new metric"}),(0,t.jsx)(l.I,{variant:"canvas",icon:"compass",tooltip:"Open in explore",onClick:Te.openExploreLink}),(0,t.jsx)(nt,{trail:Ge}),(0,t.jsx)(l.I,{variant:"canvas",icon:Je?(0,t.jsx)(d.I,{name:"favorite",type:"mono",size:"lg"}):(0,t.jsx)(d.I,{name:"star",type:"default",size:"lg"}),tooltip:"Bookmark",onClick:it}),Ge.state.embedded&&(0,t.jsx)(c.z9,{href:(0,D.xi)(Ge),variant:"secondary",onClick:()=>(0,P.z)("selected_metric_action_clicked",{action:"open_from_embedded"}),children:"Open"})]})}),(0,t.jsx)(h.U,{children:et.map((zt,Kt)=>{const Qt=(0,t.jsx)(o.o,{label:zt.displayName,active:St===zt.value,onChangeTab:()=>{(0,P.z)("metric_action_view_changed",{view:zt.value}),Oe.setActionView(zt.value)}},Kt);return zt.description?(0,t.jsx)(m.m,{content:zt.description,placement:"bottom-start",theme:"info",children:Qt},Kt):Qt})})]})}}}function ht(De){return{actions:(0,n.css)({[De.breakpoints.up(De.breakpoints.values.md)]:{position:"absolute",right:0,top:16,zIndex:2}})}}function ft(De){return new a.Pj({variables:[...(0,E.ym)(De),new a.fS({name:E.yr,label:"Group by",datasource:E.GH,includeAll:!0,defaultToAll:!0,query:{query:`label_names(${E.Rp})`,refId:"A"},value:"",text:""})]})}},21028:(G,R,e)=>{"use strict";e.d(R,{t:()=>te});var t=e(74848),n=e(32196),s=e(2543),a=e(96540),r=e(17172),g=e(84537),i=e(40845),l=e(56034),d=e(14578),c=e(88575),h=e(10354),o=e(29158),m=e(90182),u=e(15292),p=e(42418),f=e(8484),y=e(12518),x=e(69096);class v{constructor(){this.config={minGroupSize:3,idealMaxGroupSize:30,maxDepth:100}}parse(oe){if(this.config.maxDepth<=0)throw new Error("Max depth must be greater than 0");if(this.config.minGroupSize<1)throw new Error("Min group size must be greater than 0");if(this.config.idealMaxGroupSize<this.config.minGroupSize)throw new Error("Max group size must be greater than min group size");if(this.config.miscGroupKey&&this.config.miscGroupKey==="")throw new Error("miscGroupKey cannot be empty");return{root:this.parseStrings(oe,0)}}parseStrings(oe,J){const ce={groups:new Map,values:[],descendants:0};for(const xe of oe){if(xe.trim()==="")continue;const fe=P(xe,J);let Ee=ce.groups.get(fe);Ee||(Ee={groups:new Map,values:[],descendants:0},ce.groups.set(fe,Ee)),Ee.values.push(xe),Ee.descendants++}const pe=[];for(let[xe,fe]of ce.groups.entries())fe.values.length<this.config.minGroupSize?(this.config.miscGroupKey?pe.push(...fe.values):ce.values.push(...fe.values),ce.descendants+=fe.values.length,ce.groups.delete(xe)):(fe.values.length>this.config.idealMaxGroupSize&&J<this.config.maxDepth-1&&(fe=this.parseStrings(fe.values,J+1),ce.groups.set(xe,fe)),ce.descendants+=fe.descendants);if(this.config.miscGroupKey&&pe.length>0){const xe={groups:new Map,values:pe,descendants:pe.length};ce.groups.set(this.config.miscGroupKey,xe)}return ce}}function P(de,oe){let J=0;for(let ce=0;ce<de.length;ce++){const pe=de.charCodeAt(ce);if(!(pe>=48&&pe<=57||pe>=65&&pe<=90||pe>=97&&pe<=122||pe>=192&&pe<=214||pe>=216&&pe<=246||pe>=248&&pe<=255||pe>=256&&pe<=383)&&(J++,J>oe))return de.slice(0,ce)}return de}var E=e(88434),D=e(40588),C=e(84086),b=e(4200),T=e(51080),S=e(55852);class O extends g.Bs{constructor(){super(...arguments),this.onClick=()=>{this.publishEvent(new b.OO(this.state.metric),!0)}}static{this.Component=({model:oe})=>{const{title:J}=oe.useState();return(0,t.jsx)(S.$n,{variant:"secondary",size:"sm",fill:"solid",onClick:oe.onClick,children:J})}}}var M=e(81996);const I="results truncated due to limit";async function L(de,oe,J,ce){const pe=`/api/datasources/uid/${de}/resources/api/v1/label/__name__/values`,xe={start:(0,M.mv)(oe.from,!1),end:(0,M.mv)(oe.to,!0),...J&&J!=="{}"?{"match[]":J}:{},...ce?{limit:ce}:{}},fe=await(0,r.AI)().get(pe,xe,"explore-metrics-names");return ce&&fe.warnings?.includes(I)?{...fe,limitReached:!0}:{...fe,limitReached:!1}}var B=e(47241),j=e(39070),A=e(11261);function K(de){return oe=>{const J=g.jh.getData(oe);J&&J.subscribeToState(ce=>{if(ce.data?.state===j.Gu.Loading||ce.data?.state===j.Gu.Error)return;const pe=g.jh.getAncestor(oe,te);if(!ce.data?.series.length){pe.updateMetricPanel(de,!0,!0);return}let xe=!1;for(const fe of ce.data.series){for(const Ee of fe.fields)if(Ee.type===A.PU.number&&(xe=Ee.values.some(Se=>Se!=null&&!isNaN(Se)&&Se!==0),xe))break;if(xe)break}pe.updateMetricPanel(de,!0,!xe)})}}function W(de,oe,J,ce){const pe=(0,B.v)(de),xe=pe.preview.vizBuilder().setColor({mode:"fixed",fixedColor:(0,T.Vy)(oe)}).setDescription(ce).setHeaderActions(new O({metric:de,title:"Select"})).build(),fe=pe.preview.queries.map(Ee=>U(Ee,J));return new g.xK({$variables:new g.Pj({variables:(0,b.ym)(de)}),$behaviors:[K(de)],$data:new g.dt({datasource:b.GH,maxDataPoints:b.up,queries:fe}),body:xe})}function U(de,oe){const J=oe>0?'${filters},__ignore_usage__=""':'__ignore_usage__=""',ce=de.expr?.replace("${filters}",J);return{...de,expr:ce}}var F=e(51088);function V(de,oe){return de.sort((J,ce)=>{const pe=z(J,oe),xe=z(ce,oe);return pe.halfLeven+pe.wholeLeven-(xe.halfLeven+xe.wholeLeven)})}const w=new Map;function z(de,oe){let J=w.get(de);J||(J=new Map,w.set(de,J));let ce=J.get(oe);if(!ce){const pe=de.split("_"),xe=pe.slice(0,pe.length/2).join("_"),fe=(0,F.A)(xe,oe)||0,Ee=(0,F.A)(de,oe)||0;ce={halfLeven:fe,wholeLeven:Ee},J.set(oe,ce)}return ce}const N=/[^a-z0-9_:]+/;function H(de){return de?.toLowerCase().split(N).filter(oe=>oe.length>0)||[]}function Q(de){const oe=H(de).map(ce=>`(?=(.*${ce.toLowerCase()}.*))`);if(oe.length===0)return null;const J=oe.join("");return new RegExp(J,"igy")}function X(de){const oe=ee(H(de)).filter(pe=>pe.length>0).map(pe=>`(.*${pe.toLowerCase()}.*)`),J=oe.length;return oe.length===0?null:`(?i:${oe.join("|")}){${J}}`}function ee(de=[]){const oe=new Set(de.map(J=>J.toLowerCase().trim()));return Array.from(oe)}const Z="175px",q="64px",ae="all",k=2e4,se="View by the metric prefix. A metric prefix is a single word at the beginning of the metric name, relevant to the domain the metric belongs to.";class te extends g.Bs{constructor(oe){super({$variables:oe.$variables,metricPrefix:oe.metricPrefix??ae,body:oe.body??new g.gF({children:[],templateColumns:"repeat(auto-fill, minmax(450px, 1fr))",autoRows:Z,isLazy:!0}),...oe}),this.previewCache={},this.ignoreNextUpdate=!1,this._debounceRefreshMetricNames=(0,s.debounce)(()=>this._refreshMetricNames(),1e3),this._urlSync=new g.So(this,{keys:["metricPrefix"]}),this._variableDependency=new g.Sh(this,{variableNames:[b.EY,b.Ao],onReferencedVariableValueChanged:J=>{this._debounceRefreshMetricNames()}}),this.updateMetricPanel=(J,ce,pe)=>{const xe=this.previewCache[J];xe&&(xe.isEmpty=pe,xe.loaded=ce,this.previewCache[J]=xe,this.state.metricPrefix==="All"&&this.buildLayout())},this.onSearchQueryChange=J=>{const ce=J.currentTarget.value;(0,T.kj)(this).setState({metricSearch:ce})},this.onPrefixFilterChange=J=>{this.setState({metricPrefix:J.value}),this._refreshMetricNames()},this.reportPrefixFilterInteraction=J=>{const ce=(0,T.kj)(this),{steps:pe,currentStep:xe}=ce.state.history.state,Ee=pe[xe]?.trailState.metric!==void 0;(0,D.z)("prefix_filter_clicked",{from:Ee?"related_metrics":"metric_list",action:J?"open":"close"})},this.onToggleOtelExperience=()=>{const J=(0,T.kj)(this),ce=J.state.useOtelExperience;J.setState({useOtelExperience:!ce})},this.addActivationHandler(this._onActivate.bind(this))}getUrlState(){return{metricPrefix:this.state.metricPrefix}}updateFromUrl(oe){typeof oe.metricPrefix=="string"&&this.state.metricPrefix!==oe.metricPrefix&&this.setState({metricPrefix:oe.metricPrefix})}_onActivate(){this.state.body.state.children.length===0?this.buildLayout():this.ignoreNextUpdate=!0;const oe=(0,T.kj)(this);this._subs.add(oe.subscribeToEvent(b.OO,J=>{const{steps:ce,currentStep:pe}=oe.state.history.state,xe=ce[pe].parentIndex,Ee=ce[xe].trailState.metric!==void 0;if(J.payload!==void 0){const Se=re(oe),ye=H(Se).length;(0,D.z)("metric_selected",{from:Ee?"related_metrics":"metric_list",searchTermCount:ye})}})),this._subs.add(oe.subscribeToEvent(g.bZ,J=>{if(J.payload.changedObject instanceof g.JZ){const{prevState:ce,newState:pe}=J.payload;if((0,T.iG)(ce)&&(0,T.iG)(pe)&&ce.from===pe.from&&ce.to===pe.to)return}})),this._subs.add(oe.subscribeToState(({metricSearch:J},ce)=>{const pe=H(ce.metricSearch),xe=H(J);(0,s.isEqual)(pe,xe)||this._debounceRefreshMetricNames()})),this.subscribeToState((J,ce)=>{J.metricNames!==ce.metricNames&&this.onMetricNamesChanged()}),this._subs.add(oe.subscribeToState(({otelTargets:J},ce)=>{J?.instances!==ce.otelTargets?.instances&&J?.jobs!==ce.otelTargets?.jobs&&this._debounceRefreshMetricNames()})),this._subs.add(oe.subscribeToState(({useOtelExperience:J},ce)=>{this._debounceRefreshMetricNames()})),this._subs.add(oe.subscribeToState(({showPreviews:J},ce)=>{this.buildLayout()})),this._debounceRefreshMetricNames()}async _refreshMetricNames(){const oe=(0,T.kj)(this),J=oe.state.$timeRange?.state;if(!J)return;const ce=[],pe=g.jh.lookupVariable(b.Ao,this);pe instanceof g.H9&&pe.getValue()?.valueOf()&&ce.push(g.jh.interpolate(oe,"${filters}"));const fe=X(oe.state.metricSearch);fe&&ce.push(`__name__=~"${fe}"`);let Ee=!1,Se=!1;if(oe.state.useOtelExperience){const Me=oe.state.otelTargets?.jobs,Ce=oe.state.otelTargets?.instances;if(Me&&Me.length>0&&Ce&&Ce.length>0){const Ue=(0,C.GX)(ce,Me,Ce,Se);Se=Ue.missingOtelTargets,ce.push(Ue.jobsRegex),ce.push(Ue.instancesRegex)}else Ee=!0}const ye=`{${ce.join(",")}}`,Ve=g.jh.interpolate(oe,b.gR);this.setState({metricNamesLoading:!0,metricNamesError:void 0,metricNamesWarning:void 0});try{const Me=await L(Ve,J,ye,k),Ce=Q(re(this));let Ue=Ce?Me.data.filter(ut=>!Ce||Ce.test(ut)):Me.data;const Ae=Ue,we=this.state.metricPrefix;if(we&&we!=="all"){const ut=new RegExp(`(^${we}.*)`,"igy");Ue=Ue.filter(Tt=>!ut||ut.test(Tt))}let We=Me.limitReached?`This feature will only return up to ${k} metric names for performance reasons. This limit is being exceeded for the current data source. Add search terms or label filters to narrow down the number of metric names returned.`:void 0;Ee&&(Ue=[],We=void 0),Se&&(We=`${We??""} The list of metrics is not complete. Select more OTel resource attributes to see a full list of metrics.`);let _e=this.state.body,at=this.state.rootGroup;at=await this.generateGroups(Ae),this.setState({metricNames:Ue,rootGroup:at,body:_e,metricNamesLoading:!1,metricNamesWarning:We,metricNamesError:Me.error})}catch(Me){let Ce="Unknown error";(0,r.NF)(Me)&&(Me.cancelled?Ce="Request cancelled":Me.statusText&&(Ce=Me.statusText)),this.setState({metricNames:void 0,metricNamesLoading:!1,metricNamesError:Ce})}}async generateGroups(oe=[]){const J=new v;J.config={...J.config,maxDepth:2,minGroupSize:2,miscGroupKey:"misc"};const{root:ce}=J.parse(oe);return ce}onMetricNamesChanged(){const oe=this.state.metricNames||[],J=new Set(oe);Object.values(this.previewCache).forEach(Ee=>{J.has(Ee.name)||(Ee.isEmpty=!0)});const ce=(0,T.kj)(this),pe=ce.state.metric!==void 0?V(oe,ce.state.metric):oe,xe={},fe=120;Object.keys(this.previewCache).forEach(Ee=>{J.has(Ee)||delete this.previewCache[Ee]});for(let Ee=0;Ee<pe.length;Ee++){const Se=pe[Ee];if(Object.keys(xe).length>fe)break;const Ve=this.previewCache[Se]||{name:Se,index:Ee,loaded:!1};xe[Se]=Ve}try{const Ee=g.jh.getAncestor(this,y.R).state.metric;delete xe[Ee]}catch{}this.previewCache=xe,this.buildLayout()}sortedPreviewMetrics(){return Object.values(this.previewCache).sort((oe,J)=>oe.isEmpty&&J.isEmpty?oe.index-J.index:oe.isEmpty?1:J.isEmpty?-1:oe.index-J.index)}async buildLayout(){const oe=(0,T.kj)(this),J=oe.state.showPreviews;if(this.ignoreNextUpdate){this.ignoreNextUpdate=!1;return}const ce=[],pe=this.sortedPreviewMetrics(),fe=(0,T.gA)(this)?.length||0;for(let Se=0;Se<pe.length;Se++){const ye=pe[Se],Ve=await oe.getMetricMetadata(ye.name),Me=(0,E.R)(Ve);if(J){if(ye.itemRef&&ye.isPanel){ce.push(ye.itemRef.resolve());continue}const Ce=W(ye.name,Se,fe,Me);ye.itemRef=Ce.getRef(),ye.isPanel=!0,ce.push(Ce)}else{const Ce=new g.xK({$variables:new g.Pj({variables:(0,b.ym)(ye.name)}),body:ne(ye.name,Me)});ye.itemRef=Ce.getRef(),ye.isPanel=!1,ce.push(Ce)}}const Ee=J?Z:q;this.state.body.setState({children:ce,autoRows:Ee})}static{this.Component=({model:oe})=>{const{body:J,metricNames:ce,metricNamesError:pe,metricNamesLoading:xe,metricNamesWarning:fe,rootGroup:Ee,metricPrefix:Se}=oe.useState(),{children:ye}=J.useState(),Ve=(0,T.kj)(oe),Me=(0,i.of)(le),[Ce,Ue]=(0,a.useReducer)(()=>!0,!1),{metricSearch:Ae,useOtelExperience:we,hasOtelResources:We,isStandardOtel:_e}=Ve.useState(),at=ye.length===0&&Ae,ut=!xe&&ce&&ce.length===0,Tt=xe&&ye.length===0,It=Tt?void 0:ut&&"There are no results found. Try a different time range or a different data source."||at&&"There are no results found. Try adjusting your search or filters."||void 0,ge=fe?(0,t.jsx)(l.m,{content:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h4",{children:"Unable to retrieve metric names"}),(0,t.jsx)("p",{children:fe})]}),children:(0,t.jsx)(d.I,{className:Me.warningIcon,name:"exclamation-triangle"})}):void 0;return(0,t.jsxs)("div",{className:Me.container,children:[(0,t.jsxs)("div",{className:Me.header,children:[(0,t.jsx)(c.D,{label:"Search metrics",className:Me.searchField,children:(0,t.jsx)(h.p,{placeholder:"Search metrics",prefix:(0,t.jsx)(d.I,{name:"search"}),value:Ae,onChange:oe.onSearchQueryChange,suffix:ge})}),(0,t.jsx)(c.D,{label:(0,t.jsxs)("div",{className:Me.displayOptionTooltip,children:[(0,t.jsx)(f.x6,{i18nKey:"explore-metrics.viewBy",children:"View by"}),(0,t.jsx)(o.K,{name:"info-circle",size:"sm",variant:"secondary",tooltip:se})]}),className:Me.displayOption,children:(0,t.jsx)(m.l6,{value:Se,onChange:oe.onPrefixFilterChange,onOpenMenu:()=>oe.reportPrefixFilterInteraction(!0),onCloseMenu:()=>oe.reportPrefixFilterInteraction(!1),options:[{label:"All metric names",value:ae},...Array.from(Ee?.groups.keys()??[]).map(Ie=>({label:`${Ie}_`,value:Ie}))]})}),We&&(0,t.jsx)(c.D,{label:(0,t.jsxs)("div",{className:Me.displayOptionTooltip,children:[(0,t.jsx)(f.x6,{i18nKey:"trails.metric-select.filter-by",children:"Filter by"}),(0,t.jsx)(o.K,{name:"info-circle",size:"sm",variant:"secondary",tooltip:(0,t.jsx)(f.x6,{i18nKey:"trails.metric-select.otel-switch",children:"This switch enables filtering by OTel resources for OTel native data sources."})})]}),className:Me.displayOption,children:(0,t.jsx)("div",{title:_e?"":"This setting is disabled because this is not an OTel native data source.",children:(0,t.jsx)(u.K,{disabled:!_e,showLabel:!0,label:"Otel experience",value:we,onChange:oe.onToggleOtelExperience})})})]}),pe&&(0,t.jsxs)(p.F,{title:"Unable to retrieve metric names",severity:"error",children:[(0,t.jsx)("div",{children:"We are unable to connect to your data source. Double check your data source URL and credentials."}),(0,t.jsxs)("div",{children:["(",pe,")"]})]}),fe&&!Ce&&(0,t.jsx)(p.F,{title:"Unable to retrieve all metric names",severity:"warning",onSubmit:Ue,onRemove:Ue,children:(0,t.jsx)("div",{children:fe})}),(0,t.jsxs)(x.O,{isLoading:Tt,blockingMessage:It,children:[J instanceof g.G1&&(0,t.jsx)(J.Component,{model:J}),J instanceof g.gF&&(0,t.jsx)(J.Component,{model:J})]})]})}}}function ne(de,oe){return g.d0.text().setTitle(de).setDescription(oe).setHeaderActions(new O({metric:de,title:"Select"})).setOption("content","").build()}function le(de){return{container:(0,n.css)({display:"flex",flexDirection:"column"}),headingWrapper:(0,n.css)({marginBottom:de.spacing(.5)}),header:(0,n.css)({flexGrow:0,display:"flex",gap:de.spacing(2),marginBottom:de.spacing(2),alignItems:"flex-end"}),searchField:(0,n.css)({flexGrow:1,marginBottom:0}),metricTabGroup:(0,n.css)({marginBottom:de.spacing(2)}),displayOption:(0,n.css)({flexGrow:0,marginBottom:0,minWidth:"184px"}),displayOptionTooltip:(0,n.css)({display:"flex",gap:de.spacing(1)}),warningIcon:(0,n.css)({color:de.colors.warning.main})}}function re(de){return(0,T.kj)(de).state.metricSearch||""}},90623:(G,R,e)=>{"use strict";e.d(R,{p:()=>a});var t=e(74848),n=e(67061),s=e(94753);const a=()=>(0,t.jsxs)(n.B,{direction:"column",gap:1,children:[(0,t.jsx)(s.E,{variant:"h1",children:"Metrics"}),(0,t.jsx)(s.E,{color:"secondary",children:"Explore your Prometheus-compatible metrics without writing a query"})]})},69096:(G,R,e)=>{"use strict";e.d(R,{O:()=>r});var t=e(74848),n=e(32196),s=e(40845),a=e(39558);function r({blockingMessage:i,isLoading:l,children:d}){const c=(0,s.of)(g);return l&&!i&&(i="Loading..."),l?(0,t.jsx)(a._,{className:c.statusMessage,text:i}):i?(0,t.jsx)("div",{className:c.statusMessage,children:i}):d}function g(i){return{statusMessage:(0,n.css)({fontStyle:"italic",marginTop:i.spacing(7),textAlign:"center",width:"100%"})}}},74764:(G,R,e)=>{"use strict";e.d(R,{yn:()=>x,_r:()=>P});var t=e(2543),n=e(76885),s=e(84537),a=e(99140),r=e(16001),g=e(73145),i=e(4200),l=e(51080),d=e(74848),c=e(67061),h=e(55852),o=e(3169);function m(){const D=(0,o.tZ)("Bookmark created");return D.component=(0,d.jsxs)(c.B,{gap:2,direction:"row",children:[(0,d.jsxs)("div",{children:["You can view bookmarks under ",(0,d.jsx)("i",{children:"Explore > Metrics"})]}),(0,d.jsx)(h.z9,{fill:"solid",variant:"secondary",href:i.QX,children:"View bookmarks"})]}),D}const u=20;class p{constructor(){this._recent=[],this._bookmarks=[],this._bookmarkIndexMap=new Map,this.load();const C=()=>{const b=this._recent.slice(0,u).map(T=>this._serializeTrail(T.resolve()));localStorage.setItem(i.sQ,JSON.stringify(b)),localStorage.setItem(i.jT,JSON.stringify(this._bookmarks))};this._save=(0,t.debounce)(C,1e3),window.addEventListener("beforeunload",b=>{this._save=C})}_loadRecentTrailsFromStorage(){const C=[],b=localStorage.getItem(i.sQ);if(b){const T=JSON.parse(b);for(const S of T){const O=this._deserializeTrail(S);C.push(O.getRef())}}return C}_loadBookmarksFromStorage(){const C=localStorage.getItem(i.jT);return(C?JSON.parse(C):[]).map(T=>{if(E(T)){const S=T.currentStep!=null?T.currentStep:T.history.length-1;return{urlValues:T.history[S].urlValues,createdAt:T.createdAt||Date.now()}}return T})}_deserializeTrail(C){const b=new g.b({createdAt:C.createdAt});C.history.map(S=>{this._loadFromUrl(b,S.urlValues);const O=S.parentIndex??b.state.history.state.steps.length-1;b.state.history.setState({currentStep:O}),b.state.history.addTrailStepFromStorage(b,S)});const T=C.currentStep??b.state.history.state.steps.length-1;return b.state.history.setState({currentStep:T}),b.setState(s.Go.cloneSceneObjectState(b.state.history.state.steps[T].trailState,{history:b.state.history})),b}_serializeTrail(C){return{history:C.state.history.state.steps.map(T=>{const S=new g.b(s.Go.cloneSceneObjectState(T.trailState));return{urlValues:s.Go.getUrlState(S),type:T.type,description:T.description,parentIndex:T.parentIndex}}),currentStep:C.state.history.state.currentStep,createdAt:C.state.createdAt}}getTrailForBookmarkIndex(C){const b=this._bookmarks[C];return b?this.getTrailForBookmark(b):(0,l.ef)()}getTrailForBookmark(C){const b=x(C);for(const S of this._recent){const O=S.resolve();if(x(O)===b)return O}const T=new g.b({});return this._loadFromUrl(T,C.urlValues),T}_loadFromUrl(C,b){const T=n.kM.renderUrl("",b);s.Go.syncStateFromSearchParams(C,new URLSearchParams(T))}get recent(){return this._recent}load(){this._recent=this._loadRecentTrailsFromStorage(),this._bookmarks=this._loadBookmarksFromStorage(),this._refreshBookmarkIndexMap()}setRecentTrail(C){const{steps:b}=C.state.history.state;if(b.length===0||b.length===1&&b[0].type==="start")return;this._recent=this._recent.filter(S=>S!==C.getRef());const T=f(C);this._recent=this._recent.filter(S=>{const O=f(S.resolve());return!(0,t.isEqual)(T,O)}),this._recent.unshift(C.getRef()),this._save()}get bookmarks(){return this._bookmarks}addBookmark(C){const T={urlValues:s.Go.getUrlState(C),createdAt:Date.now()};this._bookmarks.unshift(T),this._refreshBookmarkIndexMap(),this._save(),(0,a.JD)((0,r.dx)(m()))}removeBookmark(C){C<this._bookmarks.length&&(this._bookmarks.splice(C,1),this._refreshBookmarkIndexMap(),this._save())}getBookmarkIndex(C){const b=x(C);return this._bookmarkIndexMap.get(b)}_refreshBookmarkIndexMap(){this._bookmarkIndexMap.clear(),this._bookmarks.forEach((C,b)=>{const T=x(C);this._bookmarkIndexMap.set(T,b)})}}function f(D){const C=s.Go.getUrlState(D);return y(C),C}function y(D){return delete D.actionView,delete D.layout,delete D.metricSearch,delete D.refresh,(D["var-groupby"]===""||D["var-groupby"]===void 0)&&(D["var-groupby"]="$__all"),typeof D["var-filters"]!="string"&&(D["var-filters"]=D["var-filters"]?.filter(C=>C!=="")),D}function x(D){return D instanceof g.b?JSON.stringify(f(D)):JSON.stringify(y({...D.urlValues}))}let v;function P(){return v||(v=new p),v}function E(D){return D!=null&&typeof D=="object"&&"history"in D}},88434:(G,R,e)=>{"use strict";e.d(R,{R:()=>g,q:()=>r});var t=e(75212),n=e(50556),s=e(19347),a=e(4200);class r{constructor(l){this._trail=l}reset(){this._datasource=void 0,this._metricsMetadata=void 0}async getDatasource(){return this._datasource||(this._datasource=(0,s.l)().get(a.gR,{__sceneObject:{value:this._trail}})),await this._datasource}async _getMetricsMetadata(){const l=await this.getDatasource();if(l.languageProvider instanceof n.Ay)return l.languageProvider.metricsMetadata||await l.languageProvider.loadMetricsMetadata(),l.languageProvider.metricsMetadata}async getMetricMetadata(l){return l?(this._metricsMetadata||(this._metricsMetadata=this._getMetricsMetadata()),(await this._metricsMetadata)?.[l]):void 0}async getTagKeys(l){const d=await this.getDatasource();return d instanceof t.UD?await d.getTagKeys(l):[]}async getTagValues(l){const d=await this.getDatasource();return d instanceof t.UD?await d.getTagValues(l):[]}}function g(i){if(!i)return;const{type:l,help:d,unit:c}=i;return[d,l&&`**Type:** *${l}*`,c&&`**Unit:** ${c}`].join(`

`)}},40588:(G,R,e)=>{"use strict";e.d(R,{h:()=>a,z:()=>s});var t=e(14110);const n="grafana_explore_metrics_";function s(r,g){(0,t.rR)(`${n}${r}`,g)}function a(r,g){if(r.length===g.length)for(const i of g)for(const l of r)i.key===l.key&&i.value!==l.value&&s("label_filter_changed",{label:i.key,action:"changed",cause:"adhoc_filter"});else if(r.length<g.length)for(const i of g){let l=!1;for(const d of r)if(i.key===d.key){l=!0;break}l||s("label_filter_changed",{label:i.key,action:"removed",cause:"adhoc_filter"})}else for(const i of r){let l=!1;for(const d of g)if(d.key===i.key){l=!0;break}l||s("label_filter_changed",{label:i.key,action:"added",cause:"adhoc_filter"})}}},84086:(G,R,e)=>{"use strict";e.d(R,{Dz:()=>g,GX:()=>i,L4:()=>r,ql:()=>a});var t=e(84537),n=e(4200);const s=()=>({cloud_availability_zone:0,cloud_region:0,container_name:0,k8s_cluster_name:0,k8s_container_name:0,k8s_cronjob_name:0,k8s_daemonset_name:0,k8s_deployment_name:0,k8s_job_name:0,k8s_namespace_name:0,k8s_pod_name:0,k8s_replicaset_name:0,k8s_statefulset_name:0,service_instance_id:0,service_name:0,service_namespace:0});function a(l,d){const c=s(),h=Object.keys(c);return l=l.filter(m=>{const u=(m.value??"").toString();return h.includes(u)?(c[u]=1,!1):!0}),Object.keys(c).filter(m=>c[m]&&!d.includes(m)).map(m=>({text:m})).concat(l)}function r(l){let d="";return l.filters&&l.labels&&(d=`* on (job, instance) group_left(${l.labels}) topk by (job, instance) (1, target_info{${l.filters}})`),d}function g(l,d){const c=t.jh.lookupVariable(n.DU,l),h=t.jh.lookupVariable(n.p4,l);let o={labels:"",filters:""};if(c instanceof t.H9&&h instanceof t.yP){const m=c.state.filters;let u=String(h.getValue());const p=u.includes(",");let f="=",y=d||u;p&&(f="=~",y=y.split(",").join("|"));let x=`deployment_environment${f}"${y}"`,v="deployment_environment";for(let P=0;P<m?.length;P++){const E=m[P].key,D=m[P].operator,C=m[P].value;x+=`,${E}${D}"${C}"`,E!=="job"&&E!=="instance"&&(v+=`,${E}`)}return o.labels=v,o.filters=x,o}return o}function i(l,d,c,h){let m=l.join(",").length,u='job=~"',p='instance=~"';for(let f=0;f<d.length;f++){const y=f===0?0:2;if(m+u.length+d[f].length+p.length+c[f].length+y<=2e3)f===0?(u+=`${d[f]}`,p+=`${c[f]}`):(u+=`|${d[f]}`,p+=`|${c[f]}`);else{h=!0;break}}return u+='"',p+='"',{missingOtelTargets:h,jobsRegex:u,instancesRegex:p}}},4200:(G,R,e)=>{"use strict";e.d(R,{Ao:()=>g,DU:()=>f,EY:()=>o,GH:()=>b,Mi:()=>B,OO:()=>j,Pp:()=>O,QX:()=>r,Rp:()=>d,Xt:()=>P,aZ:()=>h,dc:()=>I,gR:()=>m,jT:()=>S,km:()=>a,p4:()=>x,sQ:()=>T,tM:()=>E,td:()=>D,ui:()=>i,up:()=>M,ym:()=>L,yr:()=>c});var t=e(65463),n=e(84537),s=e(79422);const a="/explore/metrics/trail",r="/explore/metrics",g="filters",i="{${filters}}",l="metric",d="${metric}",c="groupby",h="${groupby}",o="ds",m="${ds}",u="logsDs",p="${logsDs}",f="otel_resources",y="${otel_resources}",x="deployment_environment",v="${deployment_environment}",P="otel_join_query",E="${otel_join_query}",D="$__logs__",C="sqr-metric-viz-query",b={uid:m},T="grafana.trails.recent",S="grafana.trails.bookmarks",O="grafana.trails.breakdown.view",M=250,I=500;function L(A){return[new n.x0({name:l,value:A,hide:s.zL.hideVariable})]}function B(A){return[new n.x0({name:P,value:A,hide:s.zL.hideVariable})]}class j extends t.x{static{this.type="metric-selected-event"}}},51080:(G,R,e)=>{"use strict";e.d(R,{FG:()=>b,KE:()=>h,U4:()=>f,Vy:()=>P,aM:()=>p,aO:()=>x,ef:()=>o,gA:()=>D,hR:()=>v,iG:()=>E,kj:()=>c,nH:()=>y,xi:()=>m});var t=e(76885),n=e(19347),s=e(32264),a=e(84537),r=e(31193),g=e(73145),i=e(12518),l=e(74764),d=e(4200);function c(T){return a.jh.getAncestor(T,g.b)}function h(T){return a.jh.getAncestor(T,g.b).state.settings}function o(T){return new g.b({initialDS:T,$timeRange:new a.JZ({from:"now-1h",to:"now"}),embedded:!1})}function m(T){const S=a.Go.getUrlState(T);return u(S)}function u(T){return t.kM.renderUrl(d.km,T)}function p(T){if(T instanceof i.R)return T;if(T.parent)return p(T.parent);throw console.error("Unable to find graph view for",T),new Error("Unable to find trail")}function f(T){return a.jh.interpolate(T,d.gR)}function y(T){return(0,n.l)().getInstanceSettings(T)?.name||T}function x(T){return T?T===d.td?"Logs":T:"Select metric"}function v(){const T=(0,l._r)().recent[0];if(T){const O=a.jh.interpolate(T.resolve(),d.gR);if(typeof O=="string"&&O.length>0)return O}const S=(0,r.tR)().getList({type:"prometheus"});if(S.length>0)return S.find(O=>O.uid===s.$.defaultDatasource)?.uid??S[0].uid}function P(T){const S=s.$.theme2.visualization;return S.getColorByName(S.palette[T%8])}function E(T){const S=Object.keys(T);return S.includes("from")&&S.includes("to")}function D(T){const S=a.jh.lookupVariable("filters",T);return S instanceof a.H9?S.state.filters:null}const C=1e4;function b(T,S){T instanceof a.H9&&T.setState({getTagKeysProvider:async(O,M)=>{const I=T.state.filters;return{replace:!0,values:(await S.getTagKeys({filters:I})).slice(0,C)}},getTagValuesProvider:async(O,M)=>{const L=T.state.filters.filter(j=>j.key!==M.key);return{replace:!0,values:(await S.getTagValues({key:M.key,filters:L})).slice(0,C)}}})}},27825:(G,R,e)=>{"use strict";e.d(R,{J:()=>f});var t=e(52622),n=e(38248),s=e(74848),a=e(96540),r=e(91890),g=e(72574),i=e(32264),l=e(66864),d=e(94354),c=e(10354),h=e(88841),o=e(94397);const m=[{label:"Size",value:t.J1.Size,description:"Split the buckets based on size"},{label:"Count",value:t.J1.Count,description:"Split the buckets based on count"}],u=[{label:"Split",value:t.J1.Size,description:"Split the buckets based on size"}],p=({value:y,onChange:x,item:v})=>{const[P,E]=(0,a.useState)(!1),D=T=>{E(!(0,o.N_)(T)),x({...y,value:T})},b=(0,g.w)().getVariables().map(T=>({value:T.name,label:T.label||T.name,origin:r.$0.Template}));return(0,s.jsxs)(l.Gy,{children:[(0,s.jsx)(d.z,{value:y?.mode||t.J1.Size,options:y?.scale?.type===t.L4.Log?u:m,onChange:T=>{x({...y,mode:T})}}),i.$.featureToggles.transformationsVariableSupport?(0,s.jsx)(h.y,{invalid:P,error:"Value needs to be an integer or a variable",value:y?.value??"",placeholder:"Auto",onChange:D,suggestions:b}):(0,s.jsx)(c.p,{value:y?.value??"",placeholder:"Auto",onChange:T=>{x({...y,value:T.currentTarget.value})}})]})};function f(y,x,v,P){x.addCustomEditor({id:"xBuckets",path:`${y}xBuckets`,name:"X Bucket",editor:p,category:P,defaultValue:{mode:t.J1.Size}}),x.addCustomEditor({id:"yBuckets",path:`${y}yBuckets`,name:"Y Bucket",editor:p,category:P,defaultValue:{mode:t.J1.Size}}),x.addCustomEditor({id:"yBuckets-scale",path:`${y}yBuckets.scale`,name:"Y Bucket scale",category:P,editor:n.W,defaultValue:{type:t.L4.Linear}})}},80909:(G,R,e)=>{"use strict";e.d(R,{VQ:()=>V,wY:()=>B,Nb:()=>W,eE:()=>K,yJ:()=>U});var t=e(81160),n=e(18282),s=e(81010),a=e(11261),r=e(28240),g=e(83195),i=e(41260),l=e(70416),d=e(77678),c=e(73060),h=e(32264),o=e(52622),m=e(97706);const{abs:u,pow:p}=Math,f=new Map;function y(H,Q,X,ee){let Z=[],q=ee.map(m.E);for(let ae=Q;ae<X;ae++){let k=u(ae),se=(0,m.h)(p(H,ae),k);for(let te=0;te<ee.length;te++){let ne=ee[te]*se,le=(ne>=0&&ae>=0?0:k)+(ae>=q[te]?0:q[te]),re=(0,m.h)(ne,le);Z.push(re),f.set(re,le)}}return Z}const x=H=>H%1===0,v=[1,1.5,2,2.5,3,3.5,4,4.5,5,5.5,6,6.5,7,7.5,8,8.5,9,9.5],P=y(10,-16,0,v),E=y(10,0,16,v),D=E.filter(x),C=P.concat(E),b=P.concat(D),T=1*1e3,S=60*T,O=60*S,M=24*O,I=365*M,L=[1,2,4,5,10,20,25,40,50,100,200,250,400,500,T,2*T,4*T,5*T,10*T,15*T,20*T,30*T,S,2*S,4*S,5*S,10*S,15*S,20*S,30*S,O,2*O,4*O,6*O,8*O,12*O,18*O,M,2*M,3*M,4*M,5*M,6*M,7*M,10*M,15*M,30*M,45*M,60*M,90*M,180*M,I,2*I,3*I,4*I,5*I,6*I,7*I,8*I,9*I,10*I],B={id:n.F.heatmap,name:"Create heatmap",description:"Generate heatmap data from source data.",defaultOptions:{},isApplicable:H=>{const{xField:Q,yField:X,xs:ee,ys:Z}=w(H);return Q||X||!ee.length||!Z.length?s.M.NotPossible:s.M.Applicable},isApplicableDescription:"The Heatmap transformation requires fields with Heatmap compatible data. No fields with Heatmap data could be found.",operator:(H,Q)=>X=>X.pipe((0,t.T)(ee=>{if(h.$.featureToggles.transformationsVariableSupport){const Z={...H,xBuckets:{...H.xBuckets},yBuckets:{...H.yBuckets}};return Z.xBuckets?.value&&(Z.xBuckets.value=Q.interpolate(Z.xBuckets.value)),Z.yBuckets?.value&&(Z.yBuckets.value=Q.interpolate(Z.yBuckets.value)),B.transformer(Z,Q)(ee)}else return B.transformer(H,Q)(ee)})),transformer:H=>Q=>{const X=V(Q,H);return H.keepOriginalData?[X,...Q]:[X]}};function j(H){return H==="+Inf"?1/0:H==="-Inf"?-1/0:+(H??0)}function A(H,Q){return j(H)-j(Q)}function K(H){return H?.meta?.custom??{}}function W(H){let Q=!1;for(let X of H.fields)switch(X.name){case"y":case"yMin":case"yMax":if(Q)return!1;Q=!0}return Q}function U(H){const Q=H.frame.fields[0],X=Q.values,ee=H.frame.fields.filter((de,oe)=>de.type===a.PU.number&&oe>0),Z=X.length*ee.length,q=new Array(Z),ae=new Array(Z),k=new Array(Z),se=ee.map(de=>de.values.slice());se.forEach((de,oe)=>{for(let J=0;J<de.length;J++)k[se.length*J+oe]=de[J]});const te=Array.from({length:ee.length},(de,oe)=>oe);for(let de=0,oe=0,J=0;de<Z;oe=++de%te.length)ae[de]=te[oe],oe===0&&de>=te.length&&J++,q[de]=X[J];let ne=ee[0].labels?.le!=null?"yMax":"y";switch(H.layout){case o.D7.le:ne="yMax";break;case o.D7.ge:ne="yMin";break;case o.D7.unknown:ne="y";break}const le={yOrdinalDisplay:ee.map(de=>(0,r.Ct)(de,H.frame)),yMatchWithLabel:Object.keys(ee[0].labels??{})[0]};if(le.yMatchWithLabel&&(le.yOrdinalLabel=ee.map(de=>de.labels?.[le.yMatchWithLabel]??""),le.yMatchWithLabel==="le"&&(le.yMinDisplay="0.0")),H.unit?.length||H.decimals!=null){const de=(0,g.j_)(H.unit??"short");le.yMinDisplay&&(le.yMinDisplay=(0,g.cN)(de(0,H.decimals))),le.yOrdinalDisplay=le.yOrdinalDisplay.map(oe=>{let J=+oe;return Number.isNaN(J)?oe:(0,g.cN)(de(J,H.decimals))})}const re={...ee[0].config};return re.displayNameFromDS&&delete re.displayNameFromDS,{length:q.length,refId:H.frame.refId,meta:{type:i.m.HeatmapCells,custom:le},fields:[{name:Q.type===a.PU.time?"xMax":"x",type:Q.type,values:q,config:Q.config},{name:ne,type:a.PU.number,values:ae,config:{unit:"short"}},{name:H.value?.length?H.value:"Value",type:a.PU.number,values:k,config:re,display:ee[0].display}]}}function F(H){H=H.slice(),H.sort((X,ee)=>A(X.name,ee.name));const Q=H.map(X=>X.fields[1].values.slice());return Q.reverse(),Q.forEach((X,ee)=>{if(ee<Q.length-1)for(let Z=0;Z<X.length;Z++)X[Z]-=Q[ee+1][Z]}),Q.reverse(),H.map((X,ee)=>({...X,fields:[X.fields[0],{...X.fields[1],values:Q[ee]}]}))}function V(H,Q){const{xField:X,yField:ee,xs:Z,ys:q}=w(H);if(!X||!ee)throw"no heatmap fields found";if(!Z.length||!q.length)throw"no values found";const ae=Q.xBuckets??{},k=Q.yBuckets??{};if(ae.scale?.type===o.L4.Log)throw"X axis only supports linear buckets";const se=Q.yBuckets?.scale??{type:o.L4.Linear},te=z(Z,q,{xSorted:(0,c.g2)(Z),xTime:X.type===a.PU.time,xMode:ae.mode,xSize:ae.mode===o.J1.Size?(0,l.WT)((0,l.E9)(ae.value??"")):ae.value?+ae.value:void 0,yMode:k.mode,ySize:k.value?+k.value:void 0,yLog:se?.type===o.L4.Log?se?.log:void 0,xMin:Q.timeRange?.from.valueOf(),xMax:Q.timeRange?.to.valueOf()});return{length:te.x.length,name:(0,r.Ct)(ee),meta:{type:i.m.HeatmapCells},fields:[{name:"xMin",type:X.type,values:te.x,config:X.config},{name:"yMin",type:a.PU.number,values:te.y,config:{...ee.config,custom:{scaleDistribution:se}}},{name:"Count",type:a.PU.number,values:te.count,config:{unit:"short"}}]}}function w(H){let Q,X,ee=0;for(let k of H)k.fields.find(te=>te.type===a.PU.time)&&(ee+=k.length);let Z=Array(ee),q=Array(ee),ae=0;for(let k of H){const se=k.fields.find(ne=>ne.type===a.PU.time);if(!se)continue;Q||(Q=se);const te=se.values;for(let ne of k.fields)if(ne!==se&&ne.type===a.PU.number){const le=ne.values;for(let re=0;re<te.length;re++,ae++)Z[ae]=te[re],q[ae]=le[re];X||(X=ne)}}return{xField:Q,yField:X,xs:Z,ys:q}}function z(H,Q,X){let ee=H.length,Z=X?.xSorted??!1,q=X?.ySorted??!1,ae=X?.xMin??(Z?H[0]:1/0),k=q?Q[0]:1/0,se=X?.xMax??(Z?H[ee-1]:-1/0),te=q?Q[ee-1]:-1/0,ne=X?.yLog,le=X?.xMin!=null&&X?.xMax!=null,re=X?.yMin!=null&&X?.yMax!=null;for(let we=0;we<ee;we++)!Z&&!le&&(ae=Math.min(ae,H[we]),se=Math.max(se,H[we])),!q&&!re&&(!ne||Q[we]>0)&&(k=Math.min(k,Q[we]),te=Math.max(te,Q[we]));let de=X?.xSize??0,oe=X?.ySize??0,J=X?.xMode,ce=X?.yMode;if((!Number.isFinite(de)||de<=0)&&(J=o.J1.Count,de=20),(!Number.isFinite(oe)||oe<=0)&&(ce=o.J1.Count,oe=10),J===o.J1.Count){let we=(se-ae)/Math.max(de-1,1),We=X?.xTime?L:b,_e=We.findIndex(at=>at>we)-1;de=We[Math.max(_e,0)]}if(ce===o.J1.Count){let we=(te-k)/Math.max(oe-1,1),We=X?.yTime?L:b,_e=We.findIndex(at=>at>we)-1;oe=We[Math.max(_e,0)]}let pe=X?.xCeil?we=>(0,d.Uh)(we,de):we=>(0,d.rs)(we,de),xe=X?.yCeil?we=>(0,d.Uh)(we,oe):we=>(0,d.rs)(we,oe);if(ne){oe=1/(X?.ySize??1);let we=ne===2?Math.log2:Math.log10;xe=X?.yCeil?We=>(0,d.Uh)(we(We),oe):We=>(0,d.rs)(we(We),oe)}let fe=pe(ae),Ee=pe(se),Se=xe(k),ye=xe(te),Ve=Math.round((Ee-fe)/de)+1,Me=Math.round((ye-Se)/oe)+1,[Ce,Ue,Ae]=N(Ve,Me,fe,de,Se,oe,ne);for(let we=0;we<ee;we++){if(ne&&Q[we]<=0)continue;const We=(pe(H[we])-fe)/de,_e=(xe(Q[we])-Se)/oe,at=We*Me+_e;Ae[at]++}return{x:Ce,y:Ue,count:Ae}}function N(H,Q,X,ee,Z,q,ae){const k=H*Q,se=new Array(k),te=new Array(k),ne=new Array(k);for(let le=0,re=0,de=X;le<k;re=++le%Q)ne[le]=0,ae?te[le]=ae**(Z+re*q):te[le]=Z+re*q,re===0&&le>=Q&&(de+=ee),se[le]=de;return[se,te,ne]}},91847:(G,R,e)=>{"use strict";e.d(R,{$n:()=>s,g_:()=>t,uk:()=>n});var t=(r=>(r.ShortcodeFigure="shortcodeFigure",r.UIImage="uiImage",r))(t||{});const n={calculateField:{name:"Add field from calculation",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to add a new field calculated from two other fields. Each transformation allows you to add one new field.

- **Mode** - Select a mode:
  - **Reduce row** - Apply selected calculation on each row of selected fields independently.
  - **Binary operation** - Apply basic binary operations (for example, sum or multiply) on values in a single row from two selected fields.
  - **Unary operation** - Apply basic unary operations on values in a single row from a selected field. The available operations are:
    - **Absolute value (abs)** - Returns the absolute value of a given expression. It represents its distance from zero as a positive number.
    - **Natural exponential (exp)** - Returns _e_ raised to the power of a given expression.
    - **Natural logarithm (ln)** - Returns the natural logarithm of a given expression.
    - **Floor (floor)** - Returns the largest integer less than or equal to a given expression.
    - **Ceiling (ceil)** - Returns the smallest integer greater than or equal to a given expression.
  - **Cumulative functions** - Apply functions on the current row and all preceding rows.
    - **Total** - Calculates the cumulative total up to and including the current row.
    - **Mean** - Calculates the mean up to and including the current row.
  - **Window functions** - Apply window functions. The window can either be **trailing** or **centered**.
    With a trailing window the current row will be the last row in the window.
    With a centered window the window will be centered on the current row.
    For even window sizes, the window will be centered between the current row, and the previous row.
    - **Mean** - Calculates the moving mean or running average.
    - **Stddev** - Calculates the moving standard deviation.
    - **Variance** - Calculates the moving variance.
  - **Row index** - Insert a field with the row index.
- **Field name** - Select the names of fields you want to use in the calculation for the new field.
- **Calculation** - If you select **Reduce row** mode, then the **Calculation** field appears. Click in the field to see a list of calculation choices you can use to create the new field. For information about available calculations, refer to [Calculation types][].
- **Operation** - If you select **Binary operation** or **Unary operation** mode, then the **Operation** fields appear. These fields allow you to apply basic math operations on values in a single row from selected fields. You can also use numerical values for binary operations.
  - **All number fields** - Set the left side of a **Binary operation** to apply the calculation to all number fields.
- **As percentile** - If you select **Row index** mode, then the **As percentile** switch appears. This switch allows you to transform the row index as a percentage of the total number of rows.
- **Alias** - (Optional) Enter the name of your new field. If you leave this blank, then the field will be named to match the calculation.
- **Replace all fields** - (Optional) Select this option if you want to hide all other fields and display only your calculated field in the visualization.

In the example below, we added two fields together and named them Sum.

${a("/static/img/docs/transformations/add-field-from-calc-stat-example-7-0.png",r,"A stat visualization including one field called Sum")}
  `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},concatenate:{name:"Concatenate fields",getHelperDocs:function(){return`
Use this transformation to combine all fields from all frames into one result.

For example, if you have separate queries retrieving temperature and uptime data (Query A) and air quality index and error information (Query B), applying the concatenate transformation yields a consolidated data frame with all relevant information in one view.

Consider the following:

**Query A:**

| Temp  | Uptime  |
| ----- | ------- |
| 15.4  | 1230233 |

**Query B:**

| AQI   | Errors |
| ----- | ------ |
| 3.2   | 5      |

After you concatenate the fields, the data frame would be:

| Temp | Uptime  | AQI | Errors |
| ---- | ------- | --- | ------ |
| 15.4 | 1230233 | 3.2 | 5      |

This transformation simplifies the process of merging data from different sources, providing a comprehensive view for analysis and visualization.
  `}},configFromData:{name:"Config from query results",getHelperDocs:function(){return`
Use this transformation to select a query and extract standard options, such as **Min**, **Max**, **Unit**, and **Thresholds**, and apply them to other query results. This feature enables dynamic visualization configuration based on the data returned by a specific query.

#### Options

- **Config query** - Select the query that returns the data you want to use as configuration.
- **Apply to** - Select the fields or series to which the configuration should be applied.
- **Apply to options** - Specify a field type or use a field name regex, depending on your selection in **Apply to**.

#### Field mapping table

Below the configuration options, you'll find the field mapping table. This table lists all fields found in the data returned by the config query, along with **Use as** and **Select** options. It provides control over mapping fields to config properties, and for multiple rows, it allows you to choose which value to select.

#### Example

Input[0] (From query: A, name: ServerA)

| Time          | Value |
| ------------- | ----- |
| 1626178119127 | 10    |
| 1626178119129 | 30    |

Input[1] (From query: B)

| Time          | Value |
| ------------- | ----- |
| 1626178119127 | 100   |
| 1626178119129 | 100   |

Output (Same as Input[0] but now with config on the Value field)

| Time          | Value (config: Max=100) |
| ------------- | ----------------------- |
| 1626178119127 | 10                      |
| 1626178119129 | 30                      |

Each row in the source data becomes a separate field. Each field now has a maximum configuration option set. Options such as **Min**, **Max**, **Unit**, and **Thresholds** are part of the field configuration. If set, they are used by the visualization instead of any options manually configured in the panel editor options pane.

#### Value mappings

You can also transform a query result into value mappings. With this option, every row in the configuration query result defines a single value mapping row. See the following example.

Config query result:

| Value | Text   | Color |
| ----- | ------ | ----- |
| L     | Low    | blue  |
| M     | Medium | green |
| H     | High   | red   |

In the field mapping specify:

| Field | Use as                  | Select     |
| ----- | ----------------------- | ---------- |
| Value | Value mappings / Value  | All values |
| Text  | Value mappings / Text   | All values |
| Color | Value mappings / Color | All values |

Grafana builds value mappings from your query result and applies them to the real data query results. You should see values being mapped and colored according to the config query results.
  `}},convertFieldType:{name:"Convert field type",getHelperDocs:function(){return`
Use this transformation to modify the field type of a specified field.

This transformation has the following options:

- **Field** - Select from available fields
- **as** - Select the FieldType to convert to
  - **Numeric** - attempts to make the values numbers
  - **String** - will make the values strings
  - **Time** - attempts to parse the values as time
    - The input will be parsed according to the [Moment.js parsing format](https://momentjs.com/docs/#/parsing/)
    - It will parse the numeric input as a Unix epoch timestamp in milliseconds.
      You must multiply your input by 1000 if it's in seconds.
    - Will show an option to specify a DateFormat as input by a string like yyyy-mm-dd or DD MM YYYY hh:mm:ss
  - **Boolean** - will make the values booleans
  - **Enum** - will make the values enums
    - Will show a table to manage the enums
  - **Other** - attempts to parse the values as JSON

For example, consider the following query that could be modified by selecting the time field as Time and specifying Date Format as YYYY.

#### Sample Query

| Time       | Mark  | Value |
|------------|-------|-------|
| 2017-07-01 | above | 25    |
| 2018-08-02 | below | 22    |
| 2019-09-02 | below | 29    |
| 2020-10-04 | above | 22    |

The result:

#### Transformed Query

| Time                | Mark  | Value |
|---------------------|-------|-------|
| 2017-01-01 00:00:00 | above | 25    |
| 2018-01-01 00:00:00 | below | 22    |
| 2019-01-01 00:00:00 | below | 29    |
| 2020-01-01 00:00:00 | above | 22    |

This transformation allows you to flexibly adapt your data types, ensuring compatibility and consistency in your visualizations.
  `}},extractFields:{name:"Extract fields",getHelperDocs:function(){return`
Use this transformation to select a source of data and extract content from it in different formats. This transformation has the following fields:

- **Source** - Select the field for the source of data.
- **Format** - Choose one of the following:
  - **JSON** - Parse JSON content from the source.
  - **Key+value pairs** - Parse content in the format 'a=b' or 'c:d' from the source.
  - **Auto** - Discover fields automatically.
- **Replace All Fields** - (Optional) Select this option to hide all other fields and display only your calculated field in the visualization.
- **Keep Time** - (Optional) Available only if **Replace All Fields** is true. Keeps the time field in the output.

Consider the following dataset:

#### Dataset Example

| Timestamp           | json_data     |
|---------------------|---------------|
| 1636678740000000000 | {"value": 1}  |
| 1636678680000000000 | {"value": 5}  |
| 1636678620000000000 | {"value": 12} |

You could prepare the data to be used by a [Time series panel][] with this configuration:

- Source: json_data
- Format: JSON
  - Field: value
  - Alias: my_value
- Replace all fields: true
- Keep time: true

This will generate the following output:

#### Transformed Data

| Timestamp           | my_value |
|---------------------|----------|
| 1636678740000000000 | 1        |
| 1636678680000000000 | 5        |
| 1636678620000000000 | 12       |

This transformation allows you to extract and format data in various ways. You can customize the extraction format based on your specific data needs.
  `},links:[{title:"Time series panel",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/time-series/"}]},fieldLookup:{name:"Lookup fields from resource",getHelperDocs:function(){return`
Use this transformation to enrich a field value by looking up additional fields from an external source. 
  
This transformation has the following fields:

- **Field** - Select a text field from your dataset.
- **Lookup** - Choose from **Countries**, **USA States**, and **Airports**.

This transformation currently supports spatial data.

For example, if you have this data:

#### Dataset Example

| Location  | Values |
|-----------|--------|
| AL        | 0      |
| AK        | 10     |
| Arizona   | 5      |
| Arkansas  | 1      |
| Somewhere | 5      |

With this configuration:

- Field: location
- Lookup: USA States

You'll get the following output:

#### Transformed Data

| Location  | ID | Name     | Lng         | Lat       | Values |
|-----------|----|----------|-------------|-----------|--------|
| AL        | AL | Alabama  | -80.891064  | 12.448457 | 0      |
| AK        | AK | Arkansas | -100.891064 | 24.448457 | 10     |
| Arizona   |    |          |             |           | 5      |
| Arkansas  |    |          |             |           | 1      |
| Somewhere |    |          |             |           | 5      |

This transformation lets you augment your data by fetching additional information from external sources, providing a more comprehensive dataset for analysis and visualization.
  `}},filterByRefId:{name:"Filter data by query refId",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to hide one or more queries in panels that have multiple queries.

Grafana displays the query identification letters in dark gray text. Click a query identifier to toggle filtering. If the query letter is white, then the results are displayed. If the query letter is dark, then the results are hidden.

> **Note:** This transformation is not available for Graphite because this data source does not support correlating returned data with queries.

In the example below, the panel has three queries (A, B, C). We removed the B query from the visualization.

${a("/static/img/docs/transformations/filter-by-query-stat-example-7-0.png",r,"A stat visualization with results from two queries, A and C")}
  `}},filterByValue:{name:"Filter data by values",getHelperDocs:function(){return`
Use this transformation to selectively filter data points directly within your visualization. This transformation provides options to include or exclude data based on one or more conditions applied to a selected field.

This transformation is very useful if your data source does not natively filter by values. You might also use this to narrow values to display if you are using a shared query.

The available conditions for all fields are:

- **Regex** - Match a regex expression.
- **Is Null** - Match if the value is null.
- **Is Not Null** - Match if the value is not null.
- **Equal** - Match if the value is equal to the specified value.
- **Different** - Match if the value is different than the specified value.

The available conditions for string fields are:

- **Contains substring** - Match if the value contains the specified substring (case insensitive).
- **Does not contain substring** - Match if the value doesn't contain the specified substring (case insensitive).

The available conditions for number fields are:

- **Greater** - Match if the value is greater than the specified value.
- **Lower** - Match if the value is lower than the specified value.
- **Greater or equal** - Match if the value is greater or equal.
- **Lower or equal** - Match if the value is lower or equal.
- **Range** - Match a range between a specified minimum and maximum, min and max included.

Consider the following dataset:

#### Dataset Example

| Time                | Temperature | Altitude |
|---------------------|-------------|----------|
| 2020-07-07 11:34:23 | 32          | 101      |
| 2020-07-07 11:34:22 | 28          | 125      |
| 2020-07-07 11:34:21 | 26          | 110      |
| 2020-07-07 11:34:20 | 23          | 98       |
| 2020-07-07 10:32:24 | 31          | 95       |
| 2020-07-07 10:31:22 | 20          | 85       |
| 2020-07-07 09:30:57 | 19          | 101      |

If you **Include** the data points that have a temperature below 30\xB0C, the configuration will look as follows:

- Filter Type: 'Include'
- Condition: Rows where 'Temperature' matches 'Lower Than' '30'

And you will get the following result, where only the temperatures below 30\xB0C are included:

#### Transformed Data

| Time                | Temperature | Altitude |
|---------------------|-------------|----------|
| 2020-07-07 11:34:22 | 28          | 125      |
| 2020-07-07 11:34:21 | 26          | 110      |
| 2020-07-07 11:34:20 | 23          | 98       |
| 2020-07-07 10:31:22 | 20          | 85       |
| 2020-07-07 09:30:57 | 19          | 101      |

You can add more than one condition to the filter. For example, you might want to include the data only if the altitude is greater than 100. To do so, add that condition to the following configuration:

- Filter type: 'Include' rows that 'Match All' conditions
- Condition 1: Rows where 'Temperature' matches 'Lower' than '30'
- Condition 2: Rows where 'Altitude' matches 'Greater' than '100'

When you have more than one condition, you can choose if you want the action (include/exclude) to be applied on rows that **Match all** conditions or **Match any** of the conditions you added.

In the example above, we chose **Match all** because we wanted to include the rows that have a temperature lower than 30\xB0C *AND* an altitude higher than 100. If we wanted to include the rows that have a temperature lower than 30\xB0C *OR* an altitude higher than 100 instead, then we would select **Match any**. This would include the first row in the original data, which has a temperature of 32\xB0C (does not match the first condition) but an altitude of 101 (which matches the second condition), so it is included.

Conditions that are invalid or incompletely configured are ignored.

This versatile data filtering transformation lets you to selectively include or exclude data points based on specific conditions. Customize the criteria to tailor your data presentation to meet your unique analytical needs.
  `}},filterFieldsByName:{name:"Filter fields by name",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to selectively remove parts of your query results. There are three ways to filter field names:

- [Using a regular expression](#use-a-regular-expression)
- [Manually selecting included fields](#manually-select-included-fields)
- [Using a dashboard variable](#use-a-dashboard-variable)

#### Use a regular expression

When you filter using a regular expression, field names that match the regular expression are included. 

For example, from the input data:

| Time                | dev-eu-west | dev-eu-north | prod-eu-west | prod-eu-north |
| ------------------- | ----------- | ------------ | ------------ | ------------- |
| 2023-03-04 23:56:23 | 23.5        | 24.5         | 22.2         | 20.2          |
| 2023-03-04 23:56:23 | 23.6        | 24.4         | 22.1         | 20.1          |

The result from using the regular expression 'prod.*' would be:

| Time                | prod-eu-west | prod-eu-north |
| ------------------- | ------------ | ------------- |
| 2023-03-04 23:56:23 | 22.2         | 20.2          |
| 2023-03-04 23:56:23 | 22.1         | 20.1          |

The regular expression can include an interpolated dashboard variable by using the \${variableName} syntax.

#### Manually select included fields

Click and uncheck the field names to remove them from the result. Fields that are matched by the regular expression are still included, even if they're unchecked.

#### Use a dashboard variable

Enable 'From variable' to let you select a dashboard variable that's used to include fields. By setting up a [dashboard variable][] with multiple choices, the same fields can be displayed across multiple visualizations.

${a("/static/img/docs/transformations/filter-name-table-before-7-0.png",r,"A table visualization with time, value, Min, and Max columns")}

Here's the table after we applied the transformation to remove the Min field.

${a("/static/img/docs/transformations/filter-name-table-after-7-0.png",r,"A table visualization with time, value, and Max columns")}

Here is the same query using a Stat visualization.

${a("/static/img/docs/transformations/filter-name-stat-after-7-0.png",r,"A stat visualization with value and Max fields")}

This transformation provides flexibility in tailoring your query results to focus on the specific fields you need for effective analysis and visualization.
  `}},formatString:{name:"Format string",getHelperDocs:function(){return`
Use this transformation to customize the output of a string field. This transformation has the following fields:

- **Upper case** - Formats the entire string in uppercase characters.
- **Lower case** - Formats the entire string in lowercase characters.
- **Sentence case** - Formats the first character of the string in uppercase.
- **Title case** - Formats the first character of each word in the string in uppercase.
- **Pascal case** - Formats the first character of each word in the string in uppercase and doesn't include spaces between words.
- **Camel case** - Formats the first character of each word in the string in uppercase, except the first word, and doesn't include spaces between words.
- **Snake case** - Formats all characters in the string in lowercase and uses underscores instead of spaces between words.
- **Kebab case** - Formats all characters in the string in lowercase and uses dashes instead of spaces between words.
- **Trim** - Removes all leading and trailing spaces from the string.
- **Substring** - Returns a substring of the string, using the specified start and end positions.

This transformation provides a convenient way to standardize and tailor the presentation of string data for better visualization and analysis.`}},formatTime:{name:"Format time",getHelperDocs:function(){return`
Use this transformation to customize the output of a time field. Output can be formatted using [Moment.js format strings](https://momentjs.com/docs/#/displaying/). For example, if you want to display only the year of a time field, the format string 'YYYY' can be used to show the calendar year (for example, 1999 or 2012).

**Before Transformation:**

| Timestamp           | Event        |
| ------------------- | ------------ |
| 1636678740000000000 | System Start |
| 1636678680000000000 | User Login   |
| 1636678620000000000 | Data Updated |

**After applying 'YYYY-MM-DD HH:mm:ss':**

| Timestamp           | Event        |
| ------------------- | ------------ |
| 2021-11-12 14:25:40 | System Start |
| 2021-11-12 14:24:40 | User Login   |
| 2021-11-12 14:23:40 | Data Updated |

This transformation lets you tailor the time representation in your visualizations, providing flexibility and precision in displaying temporal data.

> **Note:** This transformation is available in Grafana 10.1+ as an alpha feature.
  `}},groupBy:{name:"Group by",getHelperDocs:function(){return`
Use this transformation to group the data by a specified field (column) value and process calculations on each group. Click to see a list of calculation choices. For information about available calculations, refer to [Calculation types][].

Here's an example of original data.

| Time                | Server ID | CPU Temperature | Server Status |
| ------------------- | --------- | --------------- | ------------- |
| 2020-07-07 11:34:20 | server 1  | 80              | Shutdown      |
| 2020-07-07 11:34:20 | server 3  | 62              | OK            |
| 2020-07-07 10:32:20 | server 2  | 90              | Overload      |
| 2020-07-07 10:31:22 | server 3  | 55              | OK            |
| 2020-07-07 09:30:57 | server 3  | 62              | Rebooting     |
| 2020-07-07 09:30:05 | server 2  | 88              | OK            |
| 2020-07-07 09:28:06 | server 1  | 80              | OK            |
| 2020-07-07 09:25:05 | server 2  | 88              | OK            |
| 2020-07-07 09:23:07 | server 1  | 86              | OK            |

This transformation goes in two steps. First you specify one or multiple fields to group the data by. This will group all the same values of those fields together, as if you sorted them. For instance if we group by the Server ID field, then it would group the data this way:

| Time                | Server ID      | CPU Temperature | Server Status |
| ------------------- | -------------- | --------------- | ------------- |
| 2020-07-07 11:34:20 | **server 1**   | 80              | Shutdown      |
| 2020-07-07 09:28:06 | **server 1**   | 80              | OK            |
| 2020-07-07 09:23:07 | **server 1**   | 86              | OK            |
| 2020-07-07 10:32:20 | server 2       | 90              | Overload      |
| 2020-07-07 09:30:05 | server 2       | 88              | OK            |
| 2020-07-07 09:25:05 | server 2       | 88              | OK            |
| 2020-07-07 11:34:20 | **_server 3_** | 62              | OK            |
| 2020-07-07 10:31:22 | **_server 3_** | 55              | OK            |
| 2020-07-07 09:30:57 | **_server 3_** | 62              | Rebooting     |

All rows with the same value of Server ID are grouped together.

After choosing which field you want to group your data by, you can add various calculations on the other fields, and apply the calculation to each group of rows. For instance, we could want to calculate the average CPU temperature for each of those servers. So we can add the _mean_ calculation applied on the CPU Temperature field to get the following:

| Server ID | CPU Temperature (mean) |
| --------- | ---------------------- |
| server 1  | 82                     |
| server 2  | 88.6                   |
| server 3  | 59.6                   |

And we can add more than one calculation. For instance:

- For field Time, we can calculate the _Last_ value, to know when the last data point was received for each server
- For field Server Status, we can calculate the _Last_ value to know what is the last state value for each server
- For field Temperature, we can also calculate the _Last_ value to know what is the latest monitored temperature for each server

We would then get:

| Server ID | CPU Temperature (mean) | CPU Temperature (last) | Time (last)         | Server Status (last) |
| --------- | ---------------------- | ---------------------- | ------------------- | -------------------- |
| server 1  | 82                     | 80                     | 2020-07-07 11:34:20 | Shutdown             |
| server 2  | 88.6                   | 90                     | 2020-07-07 10:32:20 | Overload             |
| server 3  | 59.6                   | 62                     | 2020-07-07 11:34:20 | OK                   |

This transformation allows you to extract essential information from your time series and present it conveniently.
  `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},groupingToMatrix:{name:"Grouping to matrix",getHelperDocs:function(){return`
Use this transformation to combine three fields\u2014which are used as input for the **Column**, **Row**, and **Cell value** fields from the query output\u2014and generate a matrix. The matrix is calculated as follows:

**Original data**

| Server ID | CPU Temperature | Server Status |
| --------- | --------------- | ------------- |
| server 1  | 82              | OK            |
| server 2  | 88.6            | OK            |
| server 3  | 59.6            | Shutdown      |

We can generate a matrix using the values of 'Server Status' as column names, the 'Server ID' values as row names, and the 'CPU Temperature' as content of each cell. The content of each cell will appear for the existing column ('Server Status') and row combination ('Server ID'). For the rest of the cells, you can select which value to display between: **Null**, **True**, **False**, or **Empty**.

**Output**

| Server IDServer Status | OK   | Shutdown |
| ----------------------- | ---- | -------- |
| server 1                | 82   |          |
| server 2                | 88.6 |          |
| server 3                |      | 59.6     |

Use this transformation to construct a matrix by specifying fields from your query results. The matrix output reflects the relationships between the unique values in these fields. This helps you present complex relationships in a clear and structured matrix format.
  `}},groupToNestedTable:{name:"Group to nested tables",getHelperDocs:function(r="shortcodeFigure"){return`
  Use this transformation to group the data by a specified field (column) value and process calculations on each group. Records are generated that share the same grouped field value, to be displayed in a nested table.
    
  To calculate a statistic for a field, click the selection box next to it and select the **Calculate** option:

  ${a("/static/img/docs/transformations/nested-table-select-calculation.png",r,"A select box showing the Group and Calculate options for the transformation.")}

  Once **Calculate** has been selected, another selection box will appear next to the respective field which will allow statistics to be selected:

  ${a("/static/img/docs/transformations/nested-table-select-stat.png",r,"A select box showing available statistic calculations once the calculate option for the field has been selected.")}

  For information about available calculations, refer to [Calculation types][].

  Here's an example of original data:

  | Time                | Server ID | CPU Temperature | Server Status |
  | ------------------- | --------- | --------------- | ------------- |
  | 2020-07-07 11:34:20 | server 1  | 80              | Shutdown      |
  | 2020-07-07 11:34:20 | server 3  | 62              | OK            |
  | 2020-07-07 10:32:20 | server 2  | 90              | Overload      |
  | 2020-07-07 10:31:22 | server 3  | 55              | OK            |
  | 2020-07-07 09:30:57 | server 3  | 62              | Rebooting     |
  | 2020-07-07 09:30:05 | server 2  | 88              | OK            |
  | 2020-07-07 09:28:06 | server 1  | 80              | OK            |
  | 2020-07-07 09:25:05 | server 2  | 88              | OK            |
  | 2020-07-07 09:23:07 | server 1  | 86              | OK            |

  This transformation has two steps. First, specify one or more fields by which to group the data. This groups all the same values of those fields together, as if you sorted them. For instance, if you group by the Server ID field, Grafana groups the data this way:

  | Server ID      |  |
  | -------------- | ------------- |
  | server 1 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>80</td><td>Shutdown</td></tr><tr><td>2020-07-07 09:28:06</td><td>80</td><td>OK</td></tr><tr><td>2020-07-07 09:23:07</td><td>86</td><td>OK</td></tr></tbody></table> |
  | server 2 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 10:32:20</td><td>90</td><td>Overload</td></tr><tr><td>2020-07-07 09:30:05</td><td>88</td><td>OK</td></tr><tr><td>2020-07-07 09:25:05</td><td>88</td><td>OK</td></tr></tbody></table> |
  | server 3 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>62</td><td>OK</td></tr><tr><td>2020-07-07 10:31:22</td><td>55</td><td>OK</td></tr><tr><td>2020-07-07 09:30:57</td><td>62</td><td>Rebooting</td></tr></tbody></table> |

  After choosing the field by which you want to group your data, you can add various calculations on the other fields and apply the calculation to each group of rows. For instance, you might want to calculate the average CPU temperature for each of those servers. To do so, add the **mean calculation** applied on the CPU Temperature field to get the following result:

  | Server ID      | CPU Temperatute (mean) | |
  | -------------- | ------------- | ------------- |
  | server 1 | 82 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>Shutdown</td></tr><tr><td>2020-07-07 09:28:06</td><td>OK</td></tr><tr><td>2020-07-07 09:23:07</td><td>OK</td></tr></tbody></table> |
  | server 2 | 88.6 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 10:32:20</td><td>Overload</td></tr><tr><td>2020-07-07 09:30:05</td><td>OK</td></tr><tr><td>2020-07-07 09:25:05</td><td>OK</td></tr></tbody></table> |
  | server 3 | 59.6 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>OK</td></tr><tr><td>2020-07-07 10:31:22</td><td>OK</td></tr><tr><td>2020-07-07 09:30:57</td><td>Rebooting</td></tr></tbody></table> |
      `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},heatmap:{name:"Create heatmap",getHelperDocs:function(){return`
Use this transformation to prepare histogram data for visualizing trends over time. Similar to the heatmap visualization, this transformation converts histogram metrics into temporal buckets.

#### X Bucket

This setting determines how the x-axis is split into buckets.

- **Size** - Specify a time interval in the input field. For example, a time range of '1h' creates cells one hour wide on the x-axis.
- **Count** - For non-time-related series, use this option to define the number of elements in a bucket.

#### Y Bucket

This setting determines how the y-axis is split into buckets.

- **Linear**
- **Logarithmic** - Choose between log base 2 or log base 10.
- **Symlog** - Uses a symmetrical logarithmic scale. Choose between log base 2 or log base 10, allowing for negative values.

Assume you have the following dataset:

| Timestamp           | Value |
|-------------------- |-------|
| 2023-01-01 12:00:00 | 5     |
| 2023-01-01 12:15:00 | 10    |
| 2023-01-01 12:30:00 | 15    |
| 2023-01-01 12:45:00 | 8     |

- With X Bucket set to 'Size: 15m' and Y Bucket as 'Linear', the histogram organizes values into time intervals of 15 minutes on the x-axis and linearly on the y-axis.
- For X Bucket as 'Count: 2' and Y Bucket as 'Logarithmic (base 10)', the histogram groups values into buckets of two on the x-axis and use a logarithmic scale on the y-axis.
  `}},histogram:{name:"Histogram",getHelperDocs:function(){return`
Use this transformation to generate a histogram based on input data, allowing you to visualize the distribution of values.

- **Bucket size** - The range between the lowest and highest items in a bucket (xMin to xMax).
- **Bucket offset** - The offset for non-zero-based buckets.
- **Combine series** - Create a unified histogram using all available series.

**Original data**

Series 1:

| A | B | C |
| - | - | - |
| 1 | 3 | 5 |
| 2 | 4 | 6 |
| 3 | 5 | 7 |
| 4 | 6 | 8 |
| 5 | 7 | 9 |

Series 2:

| C |
| - |
| 5 |
| 6 |
| 7 |
| 8 |
| 9 |

**Output**

| xMin | xMax | A | B | C | C |
| ---- | ---- | --| --| --| --|
| 1    | 2    | 1 | 0 | 0 | 0 |
| 2    | 3    | 1 | 0 | 0 | 0 |
| 3    | 4    | 1 | 1 | 0 | 0 |
| 4    | 5    | 1 | 1 | 0 | 0 |
| 5    | 6    | 1 | 1 | 1 | 1 |
| 6    | 7    | 0 | 1 | 1 | 1 |
| 7    | 8    | 0 | 1 | 1 | 1 |
| 8    | 9    | 0 | 0 | 1 | 1 |
| 9    | 10   | 0 | 0 | 1 | 1 |

Visualize the distribution of values using the generated histogram, providing insights into the data's spread and density.
  `}},joinByField:{name:"Join by field",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to merge multiple results into a single table, enabling the consolidation of data from different queries.

This is especially useful for converting multiple time series results into a single wide table with a shared time field.

#### Inner join (for Time Series or SQL-like data)

An inner join merges data from multiple tables where all tables share the same value from the selected field. This type of join excludes data where values do not match in every result.

Use this transformation to combine the results from multiple queries (combining on a passed join field or the first time column) into one result, and drop rows where a successful join cannot occur. This is not optimized for large Time Series datasets.

In the following example, two queries return Time Series data. It is visualized as two separate tables before applying the inner join transformation.

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |
| 2020-07-07 11:14:20 | postgre | 345001233 |

**Query B:**

| Time                | Server   | Errors |
| ------------------- | -------- | ------ |
| 2020-07-07 11:34:20 | server 1 | 15     |
| 2020-07-07 11:24:20 | server 2 | 5      |
| 2020-07-07 11:04:20 | server 3 | 10     |

The result after applying the inner join transformation looks like the following:

| Time                | Job     | Uptime    | Server   | Errors |
| ------------------- | ------- | --------- | -------- | ------ |
| 2020-07-07 11:34:20 | node    | 25260122  | server 1 | 15     |
| 2020-07-07 11:24:20 | postgre | 123001233 | server 2 | 5      |

This works in the same way for non-Time Series tabular data as well.

**Students**

| StudentID | Name     | Major            |
| --------- | -------- | ---------------- |
| 1         | John     | Computer Science |
| 2         | Emily    | Mathematics      |
| 3         | Michael  | Physics          |
| 4         | Jennifer | Chemistry        |

**Enrollments**

| StudentID | CourseID | Grade |
|-----------|----------|-------|
| 1         | CS101    | A     |
| 1         | CS102    | B     |
| 2         | MATH201  | A     |
| 3         | PHYS101  | B     |
| 5         | HIST101  | B     |

The result after applying the inner join transformation looks like the following:

| StudentID | Name    | Major            | CourseID | Grade |
| --------- | ------- | ---------------- | -------  | ----- |
| 1         | John    | Computer Science | CS101    | A     |
| 1         | John    | Computer Science | CS102    | B     |
| 2         | Emily   | Mathematics      | MATH201  | A     |
| 3         | Michael | Physics          | PHYS101  | B     |

The inner join only includes rows where there is a match between the "StudentID" in both tables. In this case, the result does not include "Jennifer" from the "Students" table because there are no matching enrollments for her in the "Enrollments" table.

#### Outer join (for Time Series data)

An outer join includes all data from an inner join and rows where values do not match in every input. While the inner join joins Query A and Query B on the time field, the outer join includes all rows that don't match on the time field.

In the following example, two queries return table data. It is visualized as two tables before applying the outer join transformation.

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |
| 2020-07-07 11:14:20 | postgre | 345001233 |

**Query B:**

| Time                | Server   | Errors |
| ------------------- | -------- | ------ |
| 2020-07-07 11:34:20 | server 1 | 15     |
| 2020-07-07 11:24:20 | server 2 | 5      |
| 2020-07-07 11:04:20 | server 3 | 10     |

The result after applying the outer join transformation looks like the following:

| Time                | Job     | Uptime    | Server   | Errors |
| ------------------- | ------- | --------- | -------- | ------ |
| 2020-07-07 11:04:20 |         |           | server 3 | 10     |
| 2020-07-07 11:14:20 | postgre | 345001233 |          |        |
| 2020-07-07 11:34:20 | node    | 25260122  | server 1 | 15     |
| 2020-07-07 11:24:20 | postgre | 123001233 | server 2 | 5      |

In the following example, a template query displays time series data from multiple servers in a table visualization. The results of only one query can be viewed at a time.

${a("/static/img/docs/transformations/join-fields-before-7-0.png",r,"A table visualization showing results for one server")}

I applied a transformation to join the query results using the time field. Now I can run calculations, combine, and organize the results in this new table.

${a("/static/img/docs/transformations/join-fields-after-7-0.png",r,"A table visualization showing results for multiple servers")}

#### Outer join (for SQL-like data)

A tabular outer join combining tables so that the result includes matched and unmatched rows from either or both tables.

| StudentID | Name      | Major            |
| --------- | --------- | ---------------- |
| 1         | John      | Computer Science |
| 2         | Emily     | Mathematics      |
| 3         | Michael   | Physics          |
| 4         | Jennifer  | Chemistry        |

Can now be joined with:

| StudentID | CourseID | Grade |
| --------- | -------- | ----- |
| 1         | CS101    | A     |
| 1         | CS102    | B     |
| 2         | MATH201  | A     |
| 3         | PHYS101  | B     |
| 5         | HIST101  | B     |

The result after applying the outer join transformation looks like the following:

| StudentID | Name     | Major            | CourseID | Grade |
| --------- | -------- | ---------------- | -------- | ----- |
| 1         | John     | Computer Science | CS101    | A     |
| 1         | John     | Computer Science | CS102    | B     |
| 2         | Emily    | Mathematics      | MATH201  | A     |
| 3         | Michael  | Physics          | PHYS101  | B     |
| 4         | Jennifer | Chemistry        | NULL     | NULL  |
| 5         | NULL     | NULL             | HIST101  | B     |

Combine and analyze data from various queries with table joining for a comprehensive view of your information.
  `}},joinByLabels:{name:"Join by labels",getHelperDocs:function(){return`
Use this transformation to join multiple results into a single table.

This is especially useful for converting multiple time series results into a single wide table with a shared **Label** field.

- **Join** - Select the label to join by between the labels available or common across all time series.
- **Value** - The name for the output result.

#### Example

##### Input

series1{what="Temp", cluster="A", job="J1"}

| Time | Value |
| ---- | ----- |
| 1    | 10    |
| 2    | 200   |

series2{what="Temp", cluster="B", job="J1"}

| Time | Value |
| ---- | ----- |
| 1    | 10    |
| 2    | 200   |

series3{what="Speed", cluster="B", job="J1"}

| Time | Value |
| ---- | ----- |
| 22   | 22    |
| 28   | 77    |

##### Config

value: "what"

##### Output

| cluster | job | Temp | Speed |
| ------- | --- | ---- | ----- |
| A       | J1  | 10   |       |
| A       | J1  | 200  |       |
| B       | J1  | 10   | 22    |
| B       | J1  | 200  | 77    |

Combine and organize time series data effectively with this transformation for comprehensive insights.
  `}},labelsToFields:{name:"Labels to fields",getHelperDocs:function(){return`
Use this transformation to convert time series results with labels or tags into a table, including each label's keys and values in the result. Display labels as either columns or row values for enhanced data visualization.

Given a query result of two time series:

- Series 1: labels Server=Server A, Datacenter=EU
- Series 2: labels Server=Server B, Datacenter=EU

In "Columns" mode, the result looks like this:

| Time                | Server   | Datacenter | Value |
| ------------------- | -------- | ---------- | ----- |
| 2020-07-07 11:34:20 | Server A | EU         | 1     |
| 2020-07-07 11:34:20 | Server B | EU         | 2     |

In "Rows" mode, the result has a table for each series and show each label value like this:

| label      | value    |
| ---------- | -------- |
| Server     | Server A |
| Datacenter | EU       |

| label      | value    |
| ---------- | -------- |
| Server     | Server B |
| Datacenter | EU       |

#### Value field name

If you selected Server as the **Value field name**, then you would get one field for every value of the Server label.

| Time                | Datacenter | Server A | Server B |
| ------------------- | ---------- | -------- | -------- |
| 2020-07-07 11:34:20 | EU         | 1        | 2        |

#### Merging behavior

The labels to fields transformer is internally two separate transformations. The first acts on single series and extracts labels to fields. The second is the [merge](#merge) transformation that joins all the results into a single table. The merge transformation tries to join on all matching fields. This merge step is required and cannot be turned off.

To illustrate this, here is an example where you have two queries that return time series with no overlapping labels.

- Series 1: labels Server=ServerA
- Series 2: labels Datacenter=EU

This will first result in these two tables:

| Time                | Server  | Value |
| ------------------- | ------- | ----- |
| 2020-07-07 11:34:20 | ServerA | 10    |

| Time                | Datacenter | Value |
| ------------------- | ---------- | ----- |
| 2020-07-07 11:34:20 | EU         | 20    |

After merge:

| Time                | Server  | Value | Datacenter |
| ------------------- | ------- | ----- | ---------- |
| 2020-07-07 11:34:20 | ServerA | 10    |            |
| 2020-07-07 11:34:20 |         | 20    | EU         |

Convert your time series data into a structured table format for a clearer and more organized representation.
  `}},limit:{name:"Limit",getHelperDocs:function(){return`
Use this transformation to restrict the number of rows displayed, providing a more focused view of your data. This is particularly useful when dealing with large datasets.

Below is an example illustrating the impact of the **Limit** transformation on a response from a data source:

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |
| 2020-07-07 10:31:22 | Temperature | 22    |
| 2020-07-07 09:30:57 | Humidity    | 33    |
| 2020-07-07 09:30:05 | Temperature | 19    |

Here is the result after adding a Limit transformation with a value of '3':

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |

This transformation helps you tailor the visual presentation of your data to focus on the most relevant information.
  `}},merge:{name:"Merge series/tables",getHelperDocs:function(){return`
Use this transformation to combine the results from multiple queries into a single result, which is particularly useful when using the table panel visualization. This transformation merges values into the same row if the shared fields contain the same data.

Here's an example illustrating the impact of the **Merge series/tables** transformation on two queries returning table data:

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |

**Query B:**

| Time                | Job     | Errors |
| ------------------- | ------- | ------ |
| 2020-07-07 11:34:20 | node    | 15     |
| 2020-07-07 11:24:20 | postgre | 5      |

Here is the result after applying the Merge transformation.

| Time                | Job     | Errors | Uptime    |
| ------------------- | ------- | ------ | --------- |
| 2020-07-07 11:34:20 | node    | 15     | 25260122  |
| 2020-07-07 11:24:20 | postgre | 5      | 123001233 |

This transformation combines values from Query A and Query B into a unified table, enhancing the presentation of data for better insights.
  `},links:[{title:"Table panel",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/table/"}]},organize:{name:"Organize fields by name",getHelperDocs:function(){return`
Use this transformation to provide the flexibility to rename, reorder, or hide fields returned by a single query in your panel. This transformation is applicable only to panels with a single query. If your panel has multiple queries, consider using an "Outer join" transformation or removing extra queries.

#### Transforming fields

Grafana displays a list of fields returned by the query, allowing you to perform the following actions:

- **Change field order** - Hover over a field, and when your cursor turns into a hand, drag the field to its new position.
- **Hide or show a field** - Use the eye icon next to the field name to toggle the visibility of a specific field.
- **Rename fields** - Type a new name in the "Rename <field>" box to customize field names.

#### Example:

##### Original Query Result

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |

##### After Applying Field Overrides

| Time                | Sensor      | Reading |
| ------------------- | ----------- | ------- |
| 2020-07-07 11:34:20 | Temperature | 25      |
| 2020-07-07 11:34:20 | Humidity    | 22      |
| 2020-07-07 10:32:20 | Humidity    | 29      |

This transformation lets you to tailor the display of query results, ensuring a clear and insightful representation of your data in Grafana.
  `}},partitionByValues:{name:"Partition by values",getHelperDocs:function(){return`
Use this transformation to streamline the process of graphing multiple series without the need for multiple queries with different 'WHERE' clauses.

This is particularly useful when dealing with a metrics SQL table, as illustrated below:

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | US     | 1520  |
| 2022-10-20 12:00:00 | EU     | 2936  |
| 2022-10-20 01:00:00 | US     | 1327  |
| 2022-10-20 01:00:00 | EU     | 912   |

With the **Partition by values** transformation, you can issue a single query and split the results by unique values in one or more columns (fields) of your choosing. The following example uses 'Region':

'SELECT Time, Region, Value FROM metrics WHERE Time > "2022-10-20"'

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | US     | 1520  |
| 2022-10-20 01:00:00 | US     | 1327  |

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | EU     | 2936  |
| 2022-10-20 01:00:00 | EU     | 912   |

This transformation simplifies the process and enhances the flexibility of visualizing multiple series within the same time series visualization.
  `}},prepareTimeSeries:{name:"Prepare time series",getHelperDocs:function(){return`
Use this transformation to address issues when a data source returns time series data in a format that isn't compatible with the desired visualization. This transformation allows you to convert time series data between wide and long formats, providing flexibility in data frame structures.

#### Available options

##### Multi-frame time series

Use this option to transform the time series data frame from the wide format to the long format. This is particularly helpful when your data source delivers time series information in a format that needs to be reshaped for optimal compatibility with your visualization.

**Example: Converting from wide to long format**

| Timestamp           | Value1 | Value2 |
|---------------------|--------|--------|
| 2023-01-01 00:00:00 | 10     | 20     |
| 2023-01-01 01:00:00 | 15     | 25     |

**Transformed to:**

| Timestamp           | Variable | Value |
|---------------------|----------|-------|
| 2023-01-01 00:00:00 | Value1   | 10    |
| 2023-01-01 00:00:00 | Value2   | 20    |
| 2023-01-01 01:00:00 | Value1   | 15    |
| 2023-01-01 01:00:00 | Value2   | 25    |


##### Wide time series

Select this option to transform the time series data frame from the long format to the wide format. If your data source returns time series data in a long format and your visualization requires a wide format, this transformation simplifies the process.

**Example: Converting from long to wide format**

| Timestamp           | Variable | Value |
|---------------------|----------|-------|
| 2023-01-01 00:00:00 | Value1   | 10    |
| 2023-01-01 00:00:00 | Value2   | 20    |
| 2023-01-01 01:00:00 | Value1   | 15    |
| 2023-01-01 01:00:00 | Value2   | 25    |

**Transformed to:**

| Timestamp           | Value1 | Value2 |
|---------------------|--------|--------|
| 2023-01-01 00:00:00 | 10     | 20     |
| 2023-01-01 01:00:00 | 15     | 25     |

> **Note:** This transformation is available in Grafana 7.5.10+ and Grafana 8.0.6+.
  `},links:[{title:"Data frames",url:"https://grafana.com/docs/grafana/latest/developers/plugins/introduction-to-plugin-development/data-frames/"}]},reduce:{name:"Reduce",getHelperDocs:function(){return`
Use this transformation to apply a calculation to each field in the data frame and return a single value. This transformation is particularly useful for consolidating multiple time series data into a more compact, summarized format. Time fields are removed when applying this transformation.

Consider the input:

**Query A:**

| Time                | Temp | Uptime  |
| ------------------- | ---- | ------- |
| 2020-07-07 11:34:20 | 12.3 | 256122  |
| 2020-07-07 11:24:20 | 15.4 | 1230233 |

**Query B:**

| Time                | AQI | Errors |
| ------------------- | --- | ------ |
| 2020-07-07 11:34:20 | 6.5 | 15     |
| 2020-07-07 11:24:20 | 3.2 | 5      |

The reduce transformer has two modes:

- **Series to rows** - Creates a row for each field and a column for each calculation.
- **Reduce fields** - Keeps the existing frame structure, but collapses each field into a single value.

For example, if you used the **First** and **Last** calculation with a **Series to rows** transformation, then
the result would be:

| Field  | First  | Last    |
| ------ | ------ | ------- |
| Temp   | 12.3   | 15.4    |
| Uptime | 256122 | 1230233 |
| AQI    | 6.5    | 3.2     |
| Errors | 15     | 5       |

The **Reduce fields** with the **Last** calculation,
results in two frames, each with one row:

**Query A:**

| Temp | Uptime  |
| ---- | ------- |
| 15.4 | 1230233 |

**Query B:**

| AQI | Errors |
| --- | ------ |
| 3.2 | 5      |

This flexible transformation simplifies the process of consolidating and summarizing data from multiple time series into a more manageable and organized format.
  `}},renameByRegex:{name:"Rename by regex",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to rename parts of the query results using a regular expression and replacement pattern.

You can specify a regular expression, which is only applied to matches, along with a replacement pattern that support back references. For example, let's imagine you're visualizing CPU usage per host and you want to remove the domain name. You could set the regex to '/^([^.]+).*/' and the replacement pattern to '$1', 'web-01.example.com' would become 'web-01'.

> **Note:** The Rename by regex transformation was improved in Grafana v9.0.0 to allow global patterns of the form '/<stringToReplace>/g'. Depending on the regex match used, this may cause some transformations to behave slightly differently. You can guarantee the same behavior as before by wrapping the match string in forward slashes '(/)', e.g. '(.*)' would become '/(.*)/'.

In the following example, we are stripping the 'A-' prefix from field names. In the before image, you can see everything is prefixed with 'A-':

${a("/media/docs/grafana/panels-visualizations/screenshot-rename-by-regex-before-v11.0.png",r,"A time series with full series names")}

With the transformation applied, you can see we are left with just the remainder of the string.

${a("/media/docs/grafana/panels-visualizations/screenshot-rename-by-regex-after-v11.0.png",r,"A time series with shortened series names")}

This transformation lets you to tailor your data to meet your visualization needs, making your dashboards more informative and user-friendly.
  `}},rowsToFields:{name:"Rows to fields",getHelperDocs:function(){return`
Use this transformation to convert rows into separate fields. This can be useful because fields can be styled and configured individually. It can also use additional fields as sources for dynamic field configuration or map them to field labels. The additional labels can then be used to define better display names for the resulting fields.

This transformation includes a field table which lists all fields in the data returned by the configuration query. This table gives you control over what field should be mapped to each configuration property (the **Use as** option). You can also choose which value to select if there are multiple rows in the returned data.

This transformation requires:

- One field to use as the source of field names.

  By default, the transform uses the first string field as the source. You can override this default setting by selecting **Field name** in the **Use as** column for the field you want to use instead.

- One field to use as the source of values.

  By default, the transform uses the first number field as the source. But you can override this default setting by selecting **Field value** in the **Use as** column for the field you want to use instead.

Useful when visualizing data in:

- Gauge
- Stat
- Pie chart

#### Map extra fields to labels

If a field does not map to config property Grafana will automatically use it as source for a label on the output field-

**Example:**

| Name    | DataCenter | Value |
| ------- | ---------- | ----- |
| ServerA | US         | 100   |
| ServerB | EU         | 200   |

**Output:**

| ServerA (labels: DataCenter: US) | ServerB (labels: DataCenter: EU) |
| -------------------------------- | -------------------------------- |
| 10                               | 20                               |

The extra labels can now be used in the field display name provide more complete field names.

If you want to extract config from one query and apply it to another you should use the config from query results transformation.

#### Example

**Input:**

| Name    | Value | Max |
| ------- | ----- | --- |
| ServerA | 10    | 100 |
| ServerB | 20    | 200 |
| ServerC | 30    | 300 |

**Output:**

| ServerA (config: max=100) | ServerB (config: max=200) | ServerC (config: max=300) |
| ------------------------- | ------------------------- | ------------------------- |
| 10                        | 20                        | 30                        |

As you can see each row in the source data becomes a separate field. Each field now also has a max config option set. Options like **Min**, **Max**, **Unit** and **Thresholds** are all part of field configuration and if set like this will be used by the visualization instead of any options manually configured in the panel editor options pane.

This transformation enables the conversion of rows into individual fields, facilitates dynamic field configuration, and maps additional fields to labels.
  `}},seriesToRows:{name:"Series to rows",getHelperDocs:function(){return`
Use this transformation to combine the result from multiple time series data queries into one single result. This is helpful when using the table panel visualization.

The result from this transformation will contain three columns: Time, Metric, and Value. The Metric column is added so you easily can see from which query the metric originates from. Customize this value by defining Label on the source query.

In the example below, we have two queries returning time series data. It is visualized as two separate tables before applying the transformation.

**Query A:**

| Time                | Temperature |
| ------------------- | ----------- |
| 2020-07-07 11:34:20 | 25          |
| 2020-07-07 10:31:22 | 22          |
| 2020-07-07 09:30:05 | 19          |

**Query B:**

| Time                | Humidity |
| ------------------- | -------- |
| 2020-07-07 11:34:20 | 24       |
| 2020-07-07 10:32:20 | 29       |
| 2020-07-07 09:30:57 | 33       |

Here is the result after applying the Series to rows transformation.

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |
| 2020-07-07 10:31:22 | Temperature | 22    |
| 2020-07-07 09:30:57 | Humidity    | 33    |
| 2020-07-07 09:30:05 | Temperature | 19    |

This transformation facilitates the consolidation of results from multiple time series queries, providing a streamlined and unified dataset for efficient analysis and visualization in a tabular format.

> **Note:** This transformation is available in Grafana 7.1+.
  `}},sortBy:{name:"Sort by",getHelperDocs:function(){return`
Use this transformation to sort each frame within a query result based on a specified field, making your data easier to understand and analyze. By configuring the desired field for sorting, you can control the order in which the data is presented in the table or visualization.

Use the **Reverse** switch to inversely order the values within the specified field. This functionality is particularly useful when you want to quickly toggle between ascending and descending order to suit your analytical needs.

For example, in a scenario where time-series data is retrieved from a data source, the **Sort by** transformation can be applied to arrange the data frames based on the timestamp, either in ascending or descending order, depending on the analytical requirements. This capability ensures that you can easily navigate and interpret time-series data, gaining valuable insights from the organized and visually coherent presentation.
  `}},spatial:{name:"Spatial",getHelperDocs:function(){return`
Use this transformation to apply spatial operations to query results.

- **Action** - Select an action:
  - **Prepare spatial field** - Set a geometry field based on the results of other fields.
    - **Location mode** - Select a location mode (these options are shared by the **Calculate value** and **Transform** modes):
      - **Auto** - Automatically identify location data based on default field names.
      - **Coords** - Specify latitude and longitude fields.
      - **Geohash** - Specify a geohash field.
      - **Lookup** - Specify Gazetteer location fields.
  - **Calculate value** - Use the geometry to define a new field (heading/distance/area).
    - **Function** - Choose a mathematical operation to apply to the geometry:
      - **Heading** - Calculate the heading (direction) between two points.
      - **Area** - Calculate the area enclosed by a polygon defined by the geometry.
      - **Distance** - Calculate the distance between two points.
  - **Transform** - Apply spatial operations to the geometry.
    - **Operation** - Choose an operation to apply to the geometry:
      - **As line** - Create a single line feature with a vertex at each row.
      - **Line builder** - Create a line between two points.

This transformation allows you to manipulate and analyze geospatial data, enabling operations such as creating lines between points, calculating spatial properties, and more.
  `}},timeSeriesTable:{name:"Time series to table transform",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to convert time series results into a table, transforming a time series data frame into a **Trend** field which can then be used with the [sparkline cell type][]. If there are multiple time series queries, each will result in a separate table data frame. These can be joined using join or merge transforms to produce a single table with multiple sparklines per row.

${a("/static/img/docs/transformations/table-sparklines.png",r,"A table panel showing multiple values and their corresponding sparklines.")}

For each generated **Trend** field value, a calculation function can be selected. This value is displayed next to the sparkline and will be used for sorting table rows.

${a("/static/img/docs/transformations/timeseries-table-select-stat.png",r,"A select box showing available statistics that can be calculated.")}


> **Note:** This transformation is available in Grafana 9.5+ as an opt-in beta feature. Modify the Grafana [configuration file][] to use it.
  `},links:[{title:"sparkline cell type",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/table/#sparkline"},{title:"configuration file",url:"https://grafana.com/docs/grafana/latest/setup-grafana/configure-grafana/"}]},transpose:{name:"Transpose",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to pivot the data frame, converting rows into columns and columns into rows. This transformation is particularly useful when you want to switch the orientation of your data to better suit your visualization needs.
If you have multiple types it will default to string type.

**Before Transformation:**

| env  | January   | February |
| ---- | --------- | -------- |
| prod | 1 | 2 |
| dev | 3 | 4 |

**After applying transpose transformation:**

| Field  | prod   | dev |
| ---- | --------- | -------- |
| January | 1 | 3 |
| February  | 2 | 4 |

${a("/media/docs/grafana/transformations/screenshot-grafana-11-2-transpose-transformation.png",r,"Before and after transpose transformation")}
  `}},regression:{name:"Regression analysis",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to create a new data frame containing values predicted by a statistical model. This is useful for finding a trend in chaotic data. It works by fitting a mathematical function to the data, using either linear or polynomial regression. The data frame can then be used in a visualization to display a trendline.

There are two different models:

- **Linear regression** - Fits a linear function to the data.
${a("/static/img/docs/transformations/linear-regression.png",r,"A time series visualization with a straight line representing the linear function")}
- **Polynomial regression** - Fits a polynomial function to the data.
${a("/static/img/docs/transformations/polynomial-regression.png",r,"A time series visualization with a curved line representing the polynomial function")}

> **Note:** This transformation is currently in public preview. Grafana Labs offers limited support, and breaking changes might occur prior to the feature being made generally available. Enable the \`regressionTransformation\` feature toggle in Grafana to use this feature. Contact Grafana Support to enable this feature in Grafana Cloud.
  `}}};function s(){return`
  Go to the <a href="https://grafana.com/docs/grafana/latest/panels/transformations/?utm_source=grafana" target="_blank" rel="noreferrer">
  transformation documentation
  </a> for more general documentation.
  `}function a(r,g,i){return g==="shortcodeFigure"?`{{< figure src="${r}" class="docs-image--no-shadow" max-width= "1100px" alt="${i}" >}}`:`![${i}](https://grafana.com${r})`}},9581:(G,R,e)=>{"use strict";e.d(R,{YD:()=>a,dy:()=>n,kD:()=>s});var t=e(52622),n=(g=>(g.Prepare="prepare",g.Calculate="calculate",g.Modify="modify",g))(n||{}),s=(g=>(g.Heading="heading",g.Distance="distance",g.Area="area",g))(s||{}),a=(g=>(g.AsLine="asLine",g.LineBuilder="lineBuilder",g))(a||{});const r={action:"prepare",source:{mode:t.aG.Auto}}},78134:(G,R,e)=>{"use strict";e.d(R,{EX:()=>c,pp:()=>o,tt:()=>l});var t=e(70915),n=e(11217),s=e(44294),a=e(22796),r=e(52490),g=e(11261),i=e(9581);function l(m){const u=[];for(const p of m.values)p&&u.push(c(p));return new n.A(u)}function d(m){const u=new Array(m.length);if(m.length>1){let p=h(m[0]);for(let f=1;f<m.length;f++){let y=h(m[f]);if(p&&y){let x=Math.atan2(y[0]-p[0],y[1]-p[1])*180/Math.PI;x<0&&(x+=360),u[f-1]=u[f]=x}}}else u.fill(0);return u}function c(m){return m instanceof s.A?m.getCoordinates():(0,t.q1)(m.getExtent())}function h(m){if(m)return(0,a.WP)(c(m))}function o(m,u){const p=m.values,f=new Array(m.values.length),y=u.calc??i.kD.Heading,x=u.field??y;switch(y){case i.kD.Area:{for(let v=0;v<p.length;v++){const P=p[v];P&&(f[v]=(0,r.UG)(P))}return{name:x,type:g.PU.number,config:{unit:"areaM2"},values:f}}case i.kD.Distance:{for(let v=0;v<p.length;v++){const P=p[v];P&&(f[v]=(0,r.R3)(P))}return{name:x,type:g.PU.number,config:{unit:"lengthm"},values:f}}case i.kD.Heading:default:return{name:x,type:g.PU.number,config:{unit:"degree"},values:d(p)}}}},88841:(G,R,e)=>{"use strict";e.d(R,{c:()=>f,y:()=>x});var t=e(74848),n=e(32196),s=e(34743),a=e(83505),r=e(46885),g=e(96540),i=e(40845),l=e(17464),d=e(40276),c=e(72093),h=e(21744),o=e(43538),m=e(10354);const u=(P,E)=>P-E*Math.floor(P/E),p=8;var f=(P=>(P.InputElement="input",P.TextAreaElement="textarea",P))(f||{});const y=(P,E)=>({suggestionsWrapper:(0,n.css)({boxShadow:P.shadows.z2}),errorTooltip:(0,n.css)({position:"absolute",top:E+p+"px",zIndex:P.zIndex.tooltip}),inputWrapper:(0,n.css)({position:"relative"})}),x=({value:P="",onChange:E,suggestions:D,placeholder:C,error:b,invalid:T,type:S="input",style:O,autoFocus:M=!1})=>{const[I,L]=(0,g.useState)(!1),[B,j]=(0,g.useState)(0),[A,K]=(0,g.useState)(P.toString()),[W,U]=(0,g.useState)(0),[F,V]=(0,g.useState)(0),[w,z]=(0,g.useState)(0),N=(0,i.$j)(),H=y(N,F),Q=(0,g.useRef)(),X=[(0,s.UU)({fallbackAxisSideDirection:"start",crossAxis:!1,boundary:document.body}),(0,s.BN)()],{refs:ee,floatingStyles:Z}=(0,a.we)({open:I,placement:"bottom-start",onOpenChange:L,middleware:X,whileElementsMounted:r.ll,strategy:"fixed"}),q=(0,g.useCallback)(re=>{ee.setReference(re),Q.current=re},[ee]),ae=(0,g.useRef)(null);(0,g.useEffect)(()=>{U(v(ae.current,B))},[B]);const k=g.useCallback((re,de=Q.current)=>{const oe=de.selectionStart,J=de.value;J[w-1]==="$"?de.value=J.slice(0,w)+re.value+J.slice(oe):de.value=J.slice(0,w)+`\${${re.value}}`+J.slice(oe),K(de.value),L(!1),j(0),E(de.value)},[E,w]),se=g.useCallback(re=>{if(!I){if(re.key==="$"||re.key===" "&&re.ctrlKey){z(Q.current.selectionStart||0),L(!0);return}return}switch(re.key){case"Backspace":case"Escape":case"ArrowLeft":case"ArrowRight":return L(!1),j(0);case"Enter":return re.preventDefault(),k(D[B]);case"ArrowDown":case"ArrowUp":re.preventDefault();const de=re.key==="ArrowDown"?1:-1;return j(oe=>u(oe+de,D.length));default:return}},[I,D,B,k]),te=g.useCallback(re=>{K(re.currentTarget.value)},[]),ne=g.useCallback(re=>{E(re.currentTarget.value)},[E]);(0,g.useEffect)(()=>{V(Q.current.clientHeight)},[]);const le={placeholder:C,invalid:T,value:A,onChange:te,onBlur:ne,onKeyDown:se};return(0,t.jsxs)("div",{className:H.inputWrapper,style:O??{},children:[I&&(0,t.jsx)(l.ZL,{children:(0,t.jsx)("div",{ref:ee.setFloating,style:Z,className:H.suggestionsWrapper,children:(0,t.jsx)(d.E,{scrollTop:W,autoHeightMax:"300px",setScrollTop:({scrollTop:re})=>U(re),children:(0,t.jsx)(o.k,{activeRef:ae,suggestions:D,onSuggestionSelect:k,onClose:()=>L(!1),activeIndex:B})})})}),T&&b&&(0,t.jsx)("div",{className:H.errorTooltip,children:(0,t.jsx)(c.P,{children:b})}),S==="input"?(0,t.jsx)(m.p,{...le,ref:q,autoFocus:M}):(0,t.jsx)(h.f,{...le,ref:q,autoFocus:M,rows:5})]})};x.displayName="SuggestionsInput";function v(P,E){return(P?.clientHeight??0)*E}},94397:(G,R,e)=>{"use strict";e.d(R,{N_:()=>l,ZI:()=>r,aG:()=>g,eJ:()=>i,qt:()=>d});var t=e(96540),n=e(28240),s=e(91410),a=e(32264);function r(c){return(0,t.useMemo)(()=>Array.isArray(c)?Object.keys(c.reduce((h,o)=>!o||!Array.isArray(o.fields)?h:o.fields.reduce((m,u)=>{const p=(0,n.Ct)(u,o,c);return m[p]=!0,m},h),{})):[],[c])}function g(c){const h=new Set;for(const o of c)for(const m of o.fields)if(m.labels)for(const u of Object.keys(m.labels))h.add(u);return h}const i={combine:"Combine",calculateNewFields:"Calculate new fields",createNewVisualization:"Create new visualization",filter:"Filter",performSpatialOperations:"Perform spatial operations",reformat:"Reformat",reorderAndRename:"Reorder and rename"},l=c=>!!(typeof c=="number"||!Number.isNaN(Number(c))||/^\$[A-Za-z0-9_]+$/.test(c)&&a.$.featureToggles.transformationsVariableSupport);function d(c){const h=[];c&&(h.push({label:"Browser",value:"browser"}),h.push({label:"UTC",value:"utc"}));const o=(0,s.P3)();for(const m of o)h.push({label:m,value:m});return h}},87617:(G,R,e)=>{"use strict";e.d(R,{$u:()=>h,Ay:()=>p,Cj:()=>l,EC:()=>c,Y_:()=>i,dJ:()=>o,g4:()=>d,jE:()=>m,t_:()=>r});var t=e(65307),n=e(2913);const s={users:[],searchQuery:"",page:0,perPage:30,totalPages:1,externalUserMngInfo:n.Ay.externalUserMngInfo,externalUserMngLinkName:n.Ay.externalUserMngLinkName,externalUserMngLinkUrl:n.Ay.externalUserMngLinkUrl,isLoading:!1,rolesLoading:!1},a=(0,t.Z0)({name:"users",initialState:s,reducers:{usersLoaded:(f,y)=>{const{totalCount:x,perPage:v,page:P,orgUsers:E}=y.payload,D=Math.ceil(x/v);return{...f,isLoading:!0,users:E,perPage:v,page:P,totalPages:D}},searchQueryChanged:(f,y)=>({...f,searchQuery:y.payload,page:s.page}),setUsersSearchPage:(f,y)=>({...f,page:y.payload}),pageChanged:(f,y)=>({...f,page:y.payload}),sortChanged:(f,y)=>({...f,sort:y.payload}),usersFetchBegin:f=>({...f,isLoading:!0}),usersFetchEnd:f=>({...f,isLoading:!1}),rolesFetchBegin:f=>({...f,rolesLoading:!0}),rolesFetchEnd:f=>({...f,rolesLoading:!1})}}),{searchQueryChanged:r,setUsersSearchPage:g,usersLoaded:i,usersFetchBegin:l,usersFetchEnd:d,pageChanged:c,sortChanged:h,rolesFetchBegin:o,rolesFetchEnd:m}=a.actions,p={users:a.reducer}},20601:(G,R,e)=>{"use strict";e.d(R,{B:()=>n});var t=e(83077);const n=new t.O},26260:(G,R,e)=>{"use strict";e.d(R,{$u:()=>u,D4:()=>y,Iv:()=>x,U2:()=>f,VT:()=>p,z_:()=>m});var t=e(2543),n=e.n(t),s=e(31193),a=e(3843),r=e(24240),g=e(72401),i=e(48594),l=e(87421),d=e(56968),c=e(75096),h=e(53699);const o="Filters",m=E=>async(D,C)=>{let b=P(E,C());if(!b&&(D(v(E)),b=P(E,C()),!b))return;const T=b.filters.findIndex(O=>O.key===E.key&&O.value===E.value);if(T===-1){const{value:O,key:M,operator:I}=E,L={value:O,key:M,operator:I};return await D(f((0,c.jX)(b),L))}const S={...b.filters[T],operator:E.operator};return await D(u((0,c.jX)(b),{index:T,filter:S}))},u=(E,D)=>async(C,b)=>{const T=(0,l.dn)(E,b());C((0,i.kb)(E.rootStateKey,(0,h.E2)((0,c.qD)(T,D)))),await C((0,g.us)((0,c.jX)(T),!0))},p=(E,D)=>async(C,b)=>{const T=(0,l.dn)(E,b());C((0,i.kb)(E.rootStateKey,(0,h.D$)((0,c.qD)(T,D)))),await C((0,g.us)((0,c.jX)(T),!0))},f=(E,D)=>async(C,b)=>{const T=(0,l.dn)(E,b());C((0,i.kb)(E.rootStateKey,(0,h.xt)((0,c.qD)(T,D)))),await C((0,g.us)((0,c.jX)(T),!0))},y=(E,D)=>async(C,b)=>{const T=(0,l.dn)(E,b());C((0,i.kb)(E.rootStateKey,(0,h.qZ)((0,c.qD)(T,D)))),await C((0,g.us)((0,c.jX)(T),!0))},x=(E,D)=>async(C,b)=>{const T=(0,l.dn)(E,b());C((0,i.kb)(E.rootStateKey,(0,d.QP)((0,c.qD)(T,{propName:"datasource",propValue:D}))));const O=(await(0,s.tR)().get(D))?.getTagKeys?"Ad hoc filters are applied automatically to all queries that target this data source":"This data source does not support ad hoc filters yet.";C((0,i.kb)(E.rootStateKey,(0,a.BC)({infoText:O})))},v=E=>(D,C)=>{const b=(0,l.y7)(C()),T={...(0,t.cloneDeep)(h.MK),datasource:E.datasource,name:o,id:o,rootStateKey:b},S=!1,O=(0,l.hk)(b,C()),M={type:"adhoc",id:T.id,rootStateKey:b};D((0,i.kb)(b,(0,d.QV)((0,c.qD)(M,{global:S,model:T,index:O}))))},P=(E,D)=>{const C=(0,l.y7)(D),b=(0,l.nx)(C,D);let T;for(const S of Object.values(b.variables))if((0,r.EW)(S)&&S.datasource?.uid===E.datasource.uid){T=S;break}return T}},53699:(G,R,e)=>{"use strict";e.d(R,{AA:()=>h,D$:()=>l,E2:()=>d,MK:()=>r,qZ:()=>c,xt:()=>i});var t=e(65307),n=e(80484),s=e(87421),a=e(83370);const r={...n.Vg,type:"adhoc",datasource:null,filters:[]},g=(0,t.Z0)({name:"templating/adhoc",initialState:a.j,reducers:{filterAdded:(o,m)=>{const u=(0,s.Fs)(o,m.payload.id);u.type==="adhoc"&&u.filters.push(m.payload.data)},filterRemoved:(o,m)=>{const u=(0,s.Fs)(o,m.payload.id);if(u.type!=="adhoc")return;const p=m.payload.data;u.filters.splice(p,1)},filterUpdated:(o,m)=>{const u=(0,s.Fs)(o,m.payload.id);if(u.type!=="adhoc")return;const{filter:p,index:f}=m.payload.data;u.filters[f]=p},filtersRestored:(o,m)=>{const u=(0,s.Fs)(o,m.payload.id);u.type==="adhoc"&&(u.filters=m.payload.data)}}}),{filterAdded:i,filterRemoved:l,filterUpdated:d,filtersRestored:c}=g.actions,h=g.reducer},13344:(G,R,e)=>{"use strict";e.d(R,{Ek:()=>r,To:()=>s,Zm:()=>n,ou:()=>a,qF:()=>t,qz:()=>g});const t="00000000-0000-0000-0000-000000000000",n="All",s="$__all",a="None",r="",g="var-"},35589:(G,R,e)=>{"use strict";e.d(R,{c:()=>l,z:()=>d});var t=e(74848),n=e(92145),s=e(96540),a=e(13544),r=e(40845),g=e(21744),i=e(85140);const l="Grafana-LegacyVariableQueryEditor",d=({onChange:c,query:h})=>{const o=(0,r.of)(i.$),[m,u]=(0,s.useState)(h),p=x=>{u(x.currentTarget.value)},f=(0,s.useCallback)(x=>{c(x.currentTarget.value,x.currentTarget.value)},[c]),y=(0,n.Bi)();return(0,t.jsx)(g.f,{id:y,rows:2,value:m,onChange:p,onBlur:f,placeholder:"Metric name or tags query",required:!0,"data-testid":a.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsQueryInput,cols:52,className:o.textarea})};d.displayName=l},70766:(G,R,e)=>{"use strict";e.d(R,{y:()=>i});var t=e(74848),n=e(96540),s=e(72574),a=e(1682),r=e(24240),g=e(35589);async function i(d,c=a.cS){if((0,r.zs)(d))return d.variables.editor;if((0,r.X3)(d)){const h=await c(d.meta);if(!h.components.QueryEditor)throw new Error("Missing QueryEditor in plugin definition.");return h.components.QueryEditor??null}return(0,r.Hf)(d)?l:(0,r.d5)(d)?(await c(d.meta)).components.VariableQueryEditor??g.z:null}function l({datasource:d,query:c,onChange:h}){const o=(0,n.useCallback)(m=>{h({refId:"StandardVariableQuery",query:m})},[h]);return(0,t.jsx)(g.z,{query:c.query,onChange:o,datasource:d,templateSrv:(0,s.w)()})}},3843:(G,R,e)=>{"use strict";e.d(R,{BC:()=>d,DW:()=>g,Eo:()=>h,FN:()=>r,NY:()=>c,T7:()=>l,nS:()=>n,sJ:()=>i,wf:()=>a,y8:()=>o});var t=e(65307);const n={id:"",isValid:!0,errors:{},name:"",extended:null},s=(0,t.Z0)({name:"templating/editor",initialState:n,reducers:{variableEditorMounted:(m,u)=>{m.name=u.payload.name,m.id=u.payload.id},variableEditorUnMounted:(m,u)=>n,changeVariableNameSucceeded:(m,u)=>{m.name=u.payload.data.newName,delete m.errors.name,m.isValid=Object.keys(m.errors).length===0},changeVariableNameFailed:(m,u)=>{m.name=u.payload.newName,m.errors.name=u.payload.errorText,m.isValid=Object.keys(m.errors).length===0},addVariableEditorError:(m,u)=>{m.errors[u.payload.errorProp]=u.payload.errorText,m.isValid=Object.keys(m.errors).length===0},removeVariableEditorError:(m,u)=>{delete m.errors[u.payload.errorProp],m.isValid=Object.keys(m.errors).length===0},changeVariableEditorExtended:(m,u)=>{m.extended={...m.extended,...u.payload}},cleanEditorState:()=>n}}),a=s.reducer,{changeVariableNameSucceeded:r,changeVariableNameFailed:g,variableEditorMounted:i,variableEditorUnMounted:l,changeVariableEditorExtended:d,addVariableEditorError:c,removeVariableEditorError:h,cleanEditorState:o}=s.actions},85830:(G,R,e)=>{"use strict";e.d(R,{M:()=>t});var t=(n=>(n[n.MaxSize=50]="MaxSize",n))(t||{})},25304:(G,R,e)=>{"use strict";e.d(R,{z:()=>a});var t=e(72574),n=e(20601),s=e(13344);function a(r){const g={},i=(0,t.w)().getVariables();for(let l=0;l<i.length;l++){const d=i[l],c=r&&r[d.name];d.skipUrlSync||(c?g[s.qz+d.name]=c.value:g[s.qz+d.name]=n.B.get(d.type).getValueForUrl(d))}return g}},24240:(G,R,e)=>{"use strict";e.d(R,{CH:()=>p,EW:()=>a,Hf:()=>h,P4:()=>s,SP:()=>i,VN:()=>u,VO:()=>r,X3:()=>m,d5:()=>c,iv:()=>g,m8:()=>l,zs:()=>o});var t=e(29505),n=e(35589);const s=f=>f.type==="query",a=f=>f.type==="adhoc",r=f=>f.type==="constant",g=f=>"multi"in f,i=f=>"options"in f,l=f=>"current"in f;function d(f){return f===null?!1:typeof f=="string"}const c=f=>!!f.metricFindQuery&&!f.variables,h=f=>{if(!f.variables||f.variables.getType()!==t.Qz.Standard)return!1;const y=f.variables;return"toDataQuery"in y&&!!y.toDataQuery},o=f=>{if(!f.variables||f.variables.getType()!==t.Qz.Custom)return!1;const y=f.variables;return"query"in y&&"editor"in y&&!!y.query&&!!y.editor},m=f=>f.variables?f.variables.getType()===t.Qz.Datasource:!1;function u(f,y){return f?f.displayName===n.c||c(y):!1}function p(f,y){return f?f.displayName!==n.c&&(m(y)||h(y)||o(y)):!1}},2223:(G,R,e)=>{"use strict";e.d(R,{i:()=>i});var t=e(74848),n=e(96540),s=e(37390);const a=({nodes:l,edges:d,direction:c,width:h,height:o,onDoubleClick:m})=>{const u=(0,n.useRef)(null),p=(0,n.useRef)(null),f=(0,n.useCallback)(y=>{m&&m(y.nodes[0])},[m]);return(0,n.useEffect)(()=>((async()=>{const x=await e.e(5083).then(e.t.bind(e,83416,23)),v={nodes:r(x,l),edges:g(x,d)},P={width:"100%",height:"100%",autoResize:!0,layout:{improvedLayout:!0,hierarchical:{enabled:!0,direction:c??"DU",sortMethod:"directed"}},interaction:{navigationButtons:!0,dragNodes:!1}};u.current=new x.Network(p.current,v,P),u.current?.on("doubleClick",f)})(),()=>{u.current&&u.current.off("doubleClick")}),[c,d,l,f]),(0,t.jsx)("div",{children:(0,t.jsx)("div",{ref:p,style:{width:h??"100%",height:o??"60vh"}})})};function r(l,d){const c=d.map(h=>({...h,shape:"box"}));return new l.DataSet(c)}function g(l,d){const c=d.map(h=>({...h,arrows:"to",dashes:!0}));return new l.DataSet(c)}function i({edges:l,nodes:d,show:c,title:h,children:o}){const[m,u]=(0,n.useState)(c),p=(0,n.useCallback)(()=>u(!0),[u]),f=(0,n.useCallback)(()=>u(!1),[u]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.a,{isOpen:m,title:h,icon:"info-circle",iconTooltip:"The graph can be moved, zoomed in, and zoomed out.",onClickBackdrop:f,onDismiss:f,children:(0,t.jsx)(a,{nodes:d,edges:l})}),o({showModal:p})]})}},27238:(G,R,e)=>{"use strict";e.d(R,{WT:()=>n,bX:()=>r,t4:()=>a});var t=e(65307);const n={usages:[],usagesNetwork:[]},s=(0,t.Z0)({name:"templating/inspect",initialState:n,reducers:{initInspect:(g,i)=>{const{usages:l,usagesNetwork:d}=i.payload;g.usages=l,g.usagesNetwork=d}}}),a=s.reducer,{initInspect:r}=s.actions},12846:(G,R,e)=>{"use strict";e.d(R,{qJ:()=>h,hI:()=>d,hM:()=>f,H7:()=>c,xU:()=>v,P5:()=>S,g0:()=>y,PK:()=>b,Ow:()=>D});var t=e(6709);function n(O,M){const I=new Set;for(const L of O)I.add(M(L));return I}var s=e(84423),a=e(87490),r=e(34214),g=e(20601),i=e(24240),l=e(75096);const d=O=>{const M=[];for(const I of O)M.push({id:I.id,label:`${I.id}`});return M},c=(O,M)=>O.filter(I=>M.some(L=>L.from===I.id||L.to===I.id)),h=O=>{const M=[];for(const I of O)for(const L of O){if(I===L)continue;g.B.get(I.type).dependsOn(I,L)&&M.push({from:I.id,to:L.id})}return M};function o(O){const M=(0,l.t4)(O);if(!M)return;const I=M.slice(1).find(L=>L!==void 0);if(!(I in{}))return I}const m=(O,M)=>{l.SY.lastIndex=0;const I=[],B=(0,a.MA)(M,2).match(l.SY);if(!B)return I;for(const j of B){if(!j||j.indexOf("$__")!==-1||j.indexOf("${__")!==-1||j.indexOf("$hashKey")!==-1)continue;const A=o(j);O.some(K=>K.id===A)||I.find(K=>K===A)||A&&I.push(A)}return I},u={alias:[/^m$/,/^measurement$/,/^col$/,/^tag_(\w+|\d+)$/],query:[/^timeFilter$/]},p=(O,M,I)=>{const L=Object.keys(M.value).reduce((j,A)=>{const K=M.value[A];if(!K||typeof K!="string")return j;const W=u[A]?u[A].find(F=>F.test(O)):void 0;let U=(0,l.wJ)(K,O);return A==="repeat"&&K===O&&(U=!0),!W&&U&&(j={...j,[A]:K}),j},{}),B=Object.keys(M.value).reduce((j,A)=>{const K=M.value[A];if(K&&typeof K=="object"&&Object.keys(K).length){let W=K.title||K.name||K.id||A;Array.isArray(M.value)&&M.key==="panels"&&(W=`${W}[${K.id}]`);const U=p(O,{key:A,value:K},{});Object.keys(U).length&&(j={...j,[W]:U})}return j},{});return(Object.keys(L).length||Object.keys(B).length)&&(I={...I,...L,...B}),I},f=(O,M)=>{if(!M)return{unUsed:[],usages:[]};const I=[];let L=[];const B=M.getSaveModelCloneOld();for(const j of O){const A=j.id,K=p(A,{key:"model",value:B},{});!Object.keys(K).length&&!(0,i.EW)(j)&&I.push(j),Object.keys(K).length&&L.push({variable:j,tree:K})}return{unUsed:I,usages:L}};async function y(O,M){return new Promise((I,L)=>{setTimeout(()=>{try{const B=x(O,M);I(D(B))}catch(B){L(B)}},200)})}function x(O,M){if(!M)return[];let I=[];const L=M.getSaveModelCloneOld(),B=m(O,L);for(const j of B){const A=p(j,{key:"model",value:L},{});if(Object.keys(A).length){const K={id:j,name:j};I.push({variable:K,tree:A})}}return I}function v(O,M,I){const L=n(M.descendants(O),j=>j.name);L.add(t.c.includeVars);for(const j of O)L.add(j);return P([...L],I)}function P(O,M){const I=[];for(const L of O)M[L]&&I.push(...M[L]);return new Set(I)}const E=(O,M)=>{const{id:I,value:L}=M,{nodes:B,edges:j}=O;if(L&&typeof L=="string"){const A=`${M.id}-${L}`;return B.push({id:A,label:L}),j.push({from:A,to:I}),O}if(L&&typeof L=="object"){const A=Object.keys(L);for(const K of A){const W=`${M.id}-${K}`;B.push({id:W,label:K}),j.push({from:W,to:I}),O=E(O,{id:W,value:L[K]})}return O}return O},D=O=>{const M=[];for(const I of O){const{variable:L,tree:B}=I,j={variable:L,nodes:[{id:"dashboard",label:"dashboard"}],edges:[],showGraph:!1};M.push(E(j,{id:"dashboard",value:B}))}return M},C=O=>Object.values(O).reduce((I,L)=>typeof L=="object"?I+C(L):I+1,0),b=(O,M)=>{const I=M.find(L=>L.variable.id===O);return I?C(I.tree):0};function T(O){const M=[];for(const I of O)M.push(I),I.panels?.length&&M.push(...T(I.panels.map(L=>new PanelModel(L))));return M}function S(O){const M={};for(const I of O){const L=(0,s.tw)(I),B=[...L.matchAll(/"repeat":"([^"]+)"/g)].map(K=>K[1]),j=L.match(l.SY)?.map(K=>o(K))??[],A=[...B,...j];for(const K of A)K in M?M[K].add(I.id):M[K]=new Set([I.id])}return M}},81515:(G,R,e)=>{"use strict";e.d(R,{E5:()=>c,Ez:()=>l,mn:()=>h});var t=e(65307),n=e(2543),s=e.n(n),a=e(12470),r=e(87421),g=e(83370),i=e(80484);const l={...i.Vg,type:"interval",auto_count:30,auto_min:"10s",options:[],auto:!1,query:"1m,10m,30m,1h,6h,12h,1d,7d,14d,30d",refresh:a.CO.onTimeRangeChanged,current:{}},d=(0,t.Z0)({name:"templating/interval",initialState:g.j,reducers:{createIntervalOptions:(o,m)=>{const u=(0,r.Fs)(o,m.payload.id);if(u.type!=="interval")return;const p=(0,n.map)(u.query.match(/(["'])(.*?)\1|\w+/g),f=>(f=f.replace(/["']+/g,""),{text:f.trim(),value:f.trim(),selected:!1}));u.auto&&p.length&&p[0].text!=="auto"&&p.unshift({text:"auto",value:"$__auto_interval_"+u.name,selected:!1}),u.options=p}}}),c=d.reducer,{createIntervalOptions:h}=d.actions},24300:(G,R,e)=>{"use strict";e.d(R,{jR:()=>O,Fu:()=>E,$z:()=>d,O$:()=>D,ho:()=>M,MO:()=>P,an:()=>C,U9:()=>v,fx:()=>T,qh:()=>S,S8:()=>b});var t=e(53076),n=e(65307),s=e(2543),a=e(92053);const r=(I,...L)=>L.reduce((B,j)=>j(B),I);var g=e(13344),i=e(24240);const l=/[^ -~]/gm,d={id:"",highlightIndex:-1,queryValue:"",selectedValues:[],options:[],multi:!1},c=1e3,h=new t.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1}),o=I=>Array.isArray(I)?I.reduce((L,B)=>((0,s.isString)(B.value)&&(L[B.value]=B),L),{}):{},m=I=>{if(!Array.isArray(I.options))return I.options=[],I;const L=o(I.selectedValues);return I.selectedValues=Object.values(L),I.options=I.options.map(B=>{if(!(0,s.isString)(B.value))return B;const j=!!L[B.value];return B.selected===j?B:{...B,selected:j}}),I.options=u(I.options),I},u=I=>Array.isArray(I)?I.length<=c?I:I.slice(0,c):[],p=I=>{const{options:L,selectedValues:B}=I;return L.length===0||B.length>0||!L[0]||L[0].value!==g.To||(I.selectedValues=[{...L[0],selected:!0}]),I},f=I=>{const{selectedValues:L}=I;return L.length>1&&(I.selectedValues=L.filter(B=>B.value!==g.To)),I},y=I=>I.filter(L=>L.value!==g.To).map(L=>({...L,selected:!0})),x=(0,n.Z0)({name:"templating/optionsPicker",initialState:d,reducers:{showOptions:(I,L)=>{const{query:B,options:j}=L.payload;if(I.highlightIndex=-1,I.options=(0,s.cloneDeep)(j),I.id=L.payload.id,I.queryValue="",I.multi=!1,(0,i.iv)(L.payload)&&(I.multi=L.payload.multi??!1),(0,i.P4)(L.payload)){const{queryValue:A}=L.payload,K=(0,a.E)(B);I.queryValue=K&&A?A:""}return I.selectedValues=I.options.filter(A=>A.selected),r(I,p,m)},hideOptions:(I,L)=>({...d}),toggleOption:(I,L)=>{const{option:B,clearOthers:j,forceSelect:A}=L.payload,{multi:K,selectedValues:W}=I;if(B){const U=!W.find(F=>F.value===B.value&&F.text===B.text);if(B.value===g.To||!K||j)return U||A?I.selectedValues=[{...B,selected:!0}]:I.selectedValues=[],r(I,p,f,m);if(A||U)return I.selectedValues.push({...B,selected:!0}),r(I,p,f,m);I.selectedValues=W.filter(F=>F.value!==B.value&&F.text!==B.text)}else I.selectedValues=[];return r(I,p,f,m)},moveOptionsHighlight:(I,L)=>{let B=I.highlightIndex+L.payload;return B<0?B=-1:B>=I.options.length&&(B=I.options.length-1),{...I,highlightIndex:B}},toggleAllOptions:(I,L)=>{const B=I.selectedValues.find(A=>A.value===g.To),j=I.options.find(A=>A.value===g.To);return I.selectedValues.length>0&&j&&!B?(I.selectedValues=[],I.selectedValues.push({text:j.text??"All",value:j.value,selected:!0}),r(I,m)):B&&I.selectedValues.length===1?(I.selectedValues=y(I.options),r(I,m)):I.selectedValues.length>0&&!j?(I.selectedValues=[],r(I,m)):(I.selectedValues=y(I.options),r(I,m))},updateSearchQuery:(I,L)=>(I.queryValue=L.payload,I),updateOptionsAndFilter:(I,L)=>{const B=I.queryValue.trim();let j=[];if(B==="")j=L.payload;else if(l.test(B))j=L.payload.filter(A=>A.text.includes(B));else{const A=L.payload.map(({text:F})=>Array.isArray(F)?F.toString():F),[K,W,U]=h.search(A,B,5);K?.length&&(W&&U?j=U.map(F=>L.payload[W.idx[F]]):j=K.map(F=>L.payload[F]),j.sort((F,V)=>(F.value===g.To?-1:0)-(V.value===g.To?-1:0)))}if(I.highlightIndex=0,B!==""){let A=j.findIndex(K=>K.value!==g.To);(A===-1||j[A].value!==B)&&(j.unshift({selected:!1,text:"> "+B,value:B}),I.highlightIndex=A===-1?0:A+1)}return I.options=j,r(I,p,m)},updateOptionsFromSearch:(I,L)=>(I.options=L.payload,I.highlightIndex=0,r(I,p,m)),cleanPickerState:()=>d}}),{toggleOption:v,showOptions:P,hideOptions:E,moveOptionsHighlight:D,toggleAllOptions:C,updateSearchQuery:b,updateOptionsAndFilter:T,updateOptionsFromSearch:S,cleanPickerState:O}=x.actions,M=x.reducer},86886:(G,R,e)=>{"use strict";e.d(R,{C:()=>t});const t=(a,r)=>a&&(r&&!Array.isArray(a.value)?{...a,value:s(a.value),text:s(a.text)}:!r&&Array.isArray(a.value)?{...a,value:n(a.value),text:n(a.text)}:a),n=a=>Array.isArray(a)?a.length>0?a[0]:"":a,s=a=>Array.isArray(a)?a:[a]},72401:(G,R,e)=>{"use strict";e.d(R,{Y7:()=>We,TI:()=>Z,_m:()=>we,_q:()=>Ue,RK:()=>Se,t9:()=>oe,x7:()=>le,Hn:()=>Ve,mZ:()=>_e,kl:()=>de,us:()=>ce});var t=e(2543),n=e(12470),s=e(92041),a=e(39070),r=e(22391),g=e(39601),i=e(34867),l=e(32264),d=e(82467),c=e(16233),h=e(74856),o=e(99140),m=e(3169),u=e(10096),p=e(27677),f=e(34525),y=e(31193),x=e(23989),v=e(20601),P=e(13344),E=e(3843),D=e(24240),C=e(12846),b=e(24300),T=e(86886),S=e(80484),O=e(75096),M=e(73134),I=e(28601),L=e(48594),B=e(84014);const j=(ge,Ie=-1,ue=!1,me=!1)=>{const Pe={};if(me){const Ne={...initialVariableModelState,id:"__dashboard",name:"__dashboard",type:"system",index:-3,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{name:"A dashboard title",uid:"An dashboard UID",toString:()=>"A dashboard title"}}},Fe={...initialVariableModelState,id:"__org",name:"__org",type:"system",index:-2,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{name:"An org name",id:1,toString:()=>"1"}}},Be={...initialVariableModelState,id:"__user",name:"__user",type:"system",index:-1,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{login:"admin",id:1,email:"admin@test",toString:()=>"1"}}};Pe[Ne.id]=Ne,Pe[Fe.id]=Fe,Pe[Be.id]=Be}for(let Ne=0;Ne<ge;Ne++)Pe[Ne]=createQueryVariable({id:Ne.toString(),name:`Name-${Ne}`,label:`Label-${Ne}`,index:Ne});return ue&&(Pe[NEW_VARIABLE_ID]=createQueryVariable({id:NEW_VARIABLE_ID,name:`Name-${NEW_VARIABLE_ID}`,label:`Label-${NEW_VARIABLE_ID}`,index:ge})),Pe},A=(ge,Ie={})=>{const ue={id:"0",rootStateKey:"key",index:0,name:"0"};return{initialState:{0:{...{...ge.initialState,...ue},...Ie}}}},K=()=>combineReducers({dashboard:dashboardReducer,templating:keyedVariablesReducer}),W=()=>combineReducers({templating:keyedVariablesReducer});function U(ge,Ie){return{templating:{lastKey:ge,keys:{[ge]:{...getInitialTemplatingState(),...Ie}}}}}function F(ge,Ie){return ge.find(me=>me.name===Ie)}function V(ge){return(ge.type==="query"||ge.type==="datasource"||ge.type==="interval")&&ge.refresh===M.CO.onTimeRangeChanged}var w=e(87421),z=e(56968),N=e(85675),H=e(15120);const Q=(ge,Ie)=>(ue,me)=>{let Pe=0;const Ne=Ie.templating.list;for(let Be=0;Be<Ne.length;Be++){const he=X(Ne[Be]);he.rootStateKey=ge,v.B.getIfExists(he.type)&&ue((0,L.kb)(ge,(0,z.QV)((0,O.qD)(he,{global:!1,index:Pe++,model:he}))))}(0,x.w)().updateTimeRange((0,h.jG)().timeRange());const Fe=(0,w.SS)(ge,me());for(const Be of Fe)ue((0,L.kb)(ge,(0,z.wB)((0,O.qD)(Be))))};function X(ge){if(!(0,D.SP)(ge))return ge;let Ie=!1;for(const ue of ge.options)if(ue.selected=!1,Array.isArray(ge.current.value))for(const me of ge.current.value)ue.value===me&&(ue.selected=Ie=!0);else ue.value===ge.current.value&&(ue.selected=Ie=!0);return!Ie&&ge.options.length&&(ge.options[0].selected=!0),ge}const ee=(ge,Ie)=>ue=>{const me={...S.Vg,id:"__dashboard",name:"__dashboard",type:"system",index:-3,skipUrlSync:!0,hide:n.zL.hideVariable,current:{value:{name:Ie.title,uid:Ie.uid,toString:()=>Ie.title}}};ue((0,L.kb)(ge,(0,z.QV)((0,O.qD)(me,{global:me.global,index:me.index,model:me}))));const Pe={...S.Vg,id:"__org",name:"__org",type:"system",index:-2,skipUrlSync:!0,hide:n.zL.hideVariable,current:{value:{name:c.TP.user.orgName,id:c.TP.user.orgId,toString:()=>c.TP.user.orgId.toString()}}};ue((0,L.kb)(ge,(0,z.QV)((0,O.qD)(Pe,{global:Pe.global,index:Pe.index,model:Pe}))));const Ne={...S.Vg,id:"__user",name:"__user",type:"system",index:-1,skipUrlSync:!0,hide:n.zL.hideVariable,current:{value:{login:c.TP.user.login,id:c.TP.user.id,email:c.TP.user.email,toString:()=>c.TP.user.id.toString()}}};ue((0,L.kb)(ge,(0,z.QV)((0,O.qD)(Ne,{global:Ne.global,index:Ne.index,model:Ne}))))},Z=(ge,Ie)=>(ue,me)=>{const{rootStateKey:Pe}=ge,Ne=(0,w.dn)(ge,me());if(!(0,D.iv)(Ne)||(0,s.R)(Ne.current))return;const Fe=(0,T.C)(Ne.current,Ie);ue((0,L.kb)(Pe,(0,z.QP)((0,O.qD)(ge,{propName:"multi",propValue:Ie})))),ue((0,L.kb)(Pe,(0,z.QP)((0,O.qD)(ge,{propName:"current",propValue:Fe}))))},q=async(ge,Ie)=>{if(!ge.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${ge.id}`);if(ae(ge,Ie))throw new Error("Circular dependency in dashboard variables detected. Dashboard may not work as expected.");const ue=k(ge,Ie);se(ge.rootStateKey,ue,Ie)&&await new Promise(me=>{const Pe=o.M_.subscribe(()=>{if(!ge.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${ge.id}`);se(ge.rootStateKey,ue,o.M_.getState())||(Pe(),me())})})},ae=(ge,Ie,ue=new Set)=>ue.has(ge.id)?!0:(ue=new Set([...ue,ge.id]),k(ge,Ie).some(me=>ae(me,Ie,ue))),k=(ge,Ie)=>{if(!ge.rootStateKey)return[];const ue=[];for(const me of(0,w.SS)(ge.rootStateKey,Ie))ge!==me&&v.B.getIfExists(ge.type)&&v.B.get(ge.type).dependsOn(ge,me)&&ue.push(me);return ue},se=(ge,Ie,ue)=>{if(Ie.length===0)return!1;const me=(0,w.SS)(ge,ue);return Ie.filter(Ne=>me.some(Fe=>Fe.id===Ne.id&&(Fe.state===a.Gu.NotStarted||Fe.state===a.Gu.Loading))).length>0},te=(ge,Ie)=>async(ue,me)=>{const Pe=(0,w.dn)(ge,me());await q(Pe,me());const Ne=Ie[P.qz+Pe.name];if(Ne!==void 0){const Fe=(0,O.QT)(Ne);await v.B.get(Pe.type).setValueFromUrl(Pe,Fe);return}if(Pe.hasOwnProperty("refresh")){const Fe=Pe;if(Fe.refresh===n.CO.onDashboardLoad||Fe.refresh===n.CO.onTimeRangeChanged){await ue(_e((0,O.jX)(Fe)));return}}if(Pe.type==="custom"){await ue(_e((0,O.jX)(Pe)));return}ue(ut(ge))},ne=ge=>async(Ie,ue)=>{const me=g.Ny.getSearchObject(),Pe=(0,w.SS)(ge,ue()).map(async Ne=>await Ie(te((0,O.jX)(Ne),me)));await Promise.all(Pe)},le=(ge,Ie)=>async(ue,me)=>{const Pe=(0,O.QT)(Ie),Ne=(0,w.dn)(ge,me());(0,O.q$)(Ne)!==n.CO.never&&await ue(_e((0,O.jX)(Ne)));const Fe=(0,w.dn)((0,O.jX)(Ne),me());if(!(0,D.SP)(Fe))return;if(!Fe)throw new Error(`Couldn't find variable with name: ${Ne.name}`);let Be=Fe.options.find(he=>he.text===Pe||he.value===Pe);if(!Be&&(0,D.iv)(Fe)&&Fe.allValue&&Pe===Fe.allValue&&(Be={text:P.Zm,value:P.To,selected:!1}),!Be){let he=Pe;const be=Pe;Array.isArray(Pe)&&(he=Pe.reduce((Ke,ze)=>{const nt=Fe.options.find(tt=>tt.value===ze);return nt?[].concat(Ke,[nt.text]):[].concat(Ke,[ze])},[])),Be={text:he,value:be,selected:!1}}(0,D.iv)(Fe)&&(Be=(0,T.C)({text:(0,t.castArray)(Be.text),value:(0,t.castArray)(Be.value),selected:!1},Fe.multi)),await v.B.get(Ne.type).setValue(Fe,Be)},re=ge=>{let Ie,ue,me,Pe;const Ne=[];for(Ie=0;Ie<ge.options.length;Ie++)if(Pe={...ge.options[Ie]},Pe.selected=!1,Array.isArray(ge.current.value))for(ue=0;ue<ge.current.value.length;ue++)me=ge.current.value[ue],Pe.value===me&&(Pe.selected=!0,Ne.push(Pe));else Pe.value===ge.current.value&&(Pe.selected=!0,Ne.push(Pe));return Ne},de=(ge,Ie)=>(ue,me)=>{const Pe=(0,w.dn)(ge,me());if(!(0,D.SP)(Pe))return Promise.resolve();const Ne=Pe.current||{},Fe=v.B.get(Pe.type).setValue;if(Array.isArray(Ne.value)){const Ke=re(Pe);if(Ke.length===0){const nt=Pe.options[0];return Fe(Pe,{value:typeof nt.value=="string"?[nt.value]:nt.value,text:typeof nt.text=="string"?[nt.text]:nt.text,selected:!0})}const ze={value:Ke.map(nt=>nt.value),text:Ke.map(nt=>nt.text),selected:!0};return Fe(Pe,ze)}let Be=null;const he=(0,O.Nz)(Pe),be=(0,O.Lz)(Pe);if(Be=Pe.options?.find(Ke=>Ke.text===he||Ke.value===be),Be||Ie&&(Be=Pe.options?.find(Ke=>Ke.text===Ie||Ke.value===Ie),Be))return Fe(Pe,Be);if(Pe.options){const Ke=Pe.options[0];if(Ke)return Fe(Pe,Ke)}return Promise.resolve()},oe=(ge,Ie,ue)=>async me=>{const{rootStateKey:Pe}=ge;return me((0,L.kb)(Pe,(0,z.dE)((0,O.qD)(ge,{option:Ie})))),await me(ce(ge,ue))},J=ge=>{const Ie=new f.TS;return ge.forEach(ue=>{Ie.createNode(ue.name)}),ge.forEach(ue=>{ge.forEach(me=>{if(ue!==me&&v.B.get(ue.type).dependsOn(ue,me))try{Ie.link(ue.name,me.name)}catch(Pe){const Ne=Pe instanceof Error?Pe.message:"Unknown error";(0,i.FF)("Error linking variables",{error:Ne})}})}),Ie},ce=(ge,Ie,ue=u.lE)=>async(me,Pe)=>{const Ne=Pe(),{rootStateKey:Fe}=ge,Be=(0,w.dn)(ge,Ne);if((0,w.nx)(Fe,Ne).transaction.status===S.x8.Fetching)return(0,O.q$)(Be)===n.CO.never&&(await me(Tt((0,O.jX)(Be))),me(ut(ge))),Promise.resolve();const he=(0,w.SS)(Fe,Ne),be=J(he),Ke=Ne.dashboard?.getModel()?.panels??[],ze=(0,C.P5)(Ke),nt=Be.type==="adhoc"?{refreshAll:!0,panelIds:[]}:{refreshAll:!1,panelIds:Array.from((0,C.xU)([Be.id],be,ze)),variable:(0,w.dn)(ge,Ne)},tt=be.getNode(Be.name);let ot=[];return tt&&(ot=tt.getOptimizedInputEdges().map(gt=>{const He=he.find(et=>et.name===gt.inputNode?.name);return He?me(_e((0,O.jX)(He))):Promise.resolve()})),Promise.all(ot).then(()=>{Ie&&(ue.publish(new S.og(nt)),g.Ny.partial(Ce(Fe,Pe)))})},pe=(ge,Ie,ue,me)=>(Ie.includes(ge.name)||Ie.push(ge.name),ge.outputEdges.forEach(Pe=>{const Ne=Pe.outputNode;if(Ne&&!Ie.includes(Ne.name)){const Fe=ue.find(Be=>Be.name===Ne.name);Fe&&Fe.refresh===n.CO.onTimeRangeChanged&&me.indexOf(Fe)===-1?(me.push(Fe),Ie.push(Ne.name)):pe(Ne,Ie,ue,me)}}),me),xe=(ge,Ie)=>ge.outputEdges.every(ue=>{const me=ue.outputNode;if(me){const Pe=F(Ie,me.name);if(Pe&&Pe.type==="query")return Pe.refresh!==n.CO.onTimeRangeChanged}return!0}),fe=(ge,Ie)=>{const ue=(0,w.SS)(ge,Ie),me=J(ue),Pe=[],Ne=[];return ue.forEach(Fe=>{const Be=me.getNode(Fe.name);if(!Pe.includes(Fe.name)&&Be){const he=F(ue,Be.name);if(!he)return;const be=V(he);be&&Be.outputEdges.length===0&&Ne.push(he),be&&Ne.includes(he)&&Be.outputEdges.length>0&&(Ne.push(he),pe(Be,Pe,ue,Ne)),be&&Be.outputEdges.length>0&&xe(Be,ue)&&(Ne.includes(he)||Ne.push(he)),!be&&Be.outputEdges.length>0&&pe(Be,Pe,ue,Ne)}}),Ne},Ee=(ge,Ie)=>(0,w.SS)(ge,Ie).filter(Pe=>"refresh"in Pe&&"options"in Pe?Pe.refresh===n.CO.onTimeRangeChanged:!1),Se=(ge,Ie,ue={templateSrv:(0,x.w)(),events:u.lE})=>async(me,Pe)=>{ue.templateSrv.updateTimeRange(Ie);let Ne=[];l.$.featureToggles.refactorVariablesTimeRange?Ne=fe(ge,Pe()):Ne=Ee(ge,Pe());const Fe=Ne.map(he=>he.id),Be=Ne.map(he=>me(ye((0,O.jX)(he))));try{await Promise.all(Be),ue.events.publish(new S.BS({variableIds:Fe}))}catch(he){console.error(he),me((0,d.dx)(at("Template variable service failed",he)))}},ye=ge=>async(Ie,ue)=>{const me=(0,w.dn)(ge,ue());if(!(0,D.SP)(me))return;const Pe=me.options.slice();await Ie(_e((0,O.jX)(me),!0));const Ne=(0,w.dn)(ge,ue());if(!(0,D.SP)(Ne))return;const Fe=Ne.options;JSON.stringify(Pe)!==JSON.stringify(Fe)&&ue().dashboard.getModel()?.templateVariableValueUpdated()},Ve=(ge,Ie,ue=u.lE)=>async(me,Pe)=>{const Ne=[],Fe=Pe().dashboard.getModel(),Be=(0,w.SS)(ge,Pe());for(const nt of Be){const tt=P.qz+nt.name;if(!Ie.hasOwnProperty(tt)||!Me(nt,Ie[tt].value))continue;let ot=Ie[tt].value;if(Ie[tt].removed){const He=Fe?.templating.list.find(et=>et.name===nt.name);He&&(0,D.m8)(He)&&(ot=He.current.value),He&&He.type==="constant"&&(ot=He.query)}const gt=v.B.get(nt.type).setValueFromUrl(nt,ot);Ne.push(gt)}const he=Be.filter(nt=>{const tt=P.qz+nt.name;return Ie.hasOwnProperty(tt)&&Me(nt,Ie[tt].value)&&nt.type!=="adhoc"}),be=J(Be),Ke=(0,C.P5)(Fe?.panels??[]),ze=(0,C.xU)(he.map(nt=>nt.id),be,Ke);Ne.length&&(await Promise.all(Ne),ue.publish(new S.eF({refreshAll:ze.size===0,panelIds:Array.from(ze)})))};function Me(ge,Ie){const ue=v.B.get(ge.type).getValueForUrl(ge);let me=(0,O.QT)(Ie);return Array.isArray(ue)&&!Array.isArray(me)&&(me=[me]),!(0,t.isEqual)(ue,me)}const Ce=(ge,Ie)=>{const ue=g.Ny.getSearchObject(),me=Object.keys(ue).filter(Pe=>Pe.indexOf(P.qz)===-1).reduce((Pe,Ne)=>(Pe[Ne]=ue[Ne],Pe),{});for(const Pe of(0,w.SS)(ge,Ie())){if(Pe.skipUrlSync)continue;const Ne=v.B.get(Pe.type);me[P.qz+Pe.name]=Ne.getValueForUrl(Pe)}return me},Ue=(ge,Ie)=>async(ue,me)=>{try{const Pe=(0,O.q4)(ge),Ne=me(),Fe=(0,w.Tk)(Ne);Fe&&(0,w.nx)(Fe,Ne).transaction.status===S.x8.Fetching&&ue(We(Fe)),ue((0,L.kb)(Pe,(0,N.kH)({uid:Pe}))),ue(ee(Pe,Ie)),ue(Q(Pe,Ie)),ue(Ae(Pe)),await ue(ne(Pe)),ue((0,L.kb)(Pe,(0,N.$O)({uid:Pe})))}catch(Pe){ue((0,d.dx)(at("Templating init failed",Pe))),console.error(Pe)}};function Ae(ge,Ie=y.tR){return(ue,me)=>{const Pe=(0,w.SS)(ge,me());for(const Ne of Pe){if(Ne.type!=="adhoc"&&Ne.type!=="query")continue;const{datasource:Fe}=Ne;if((0,r.fN)(Fe))continue;const Be=Ie().getInstanceSettings(Fe),he=Be?(0,r.p$)(Be):{uid:Fe};ue((0,L.kb)(ge,(0,z.QP)((0,O.qD)(Ne,{propName:"datasource",propValue:he}))))}}}const we=ge=>Ie=>{Ie((0,L.kb)(ge,(0,H.v)())),Ie((0,L.kb)(ge,(0,E.y8)())),Ie((0,L.kb)(ge,(0,b.jR)())),Ie((0,L.kb)(ge,(0,N.pu)()))},We=(ge,Ie={getBackendSrv:p.AI})=>ue=>{Ie.getBackendSrv().cancelAllInFlightRequests(),ue(we(ge))},_e=(ge,Ie=!1)=>async(ue,me)=>{const{rootStateKey:Pe}=ge;try{if(!(0,O.sN)(Pe,me()))return;const Ne=(0,w.dn)(ge,me());ue((0,L.kb)(Pe,(0,z.a7)((0,O.qD)(Ne)))),await ue(Tt((0,O.jX)(Ne))),await v.B.get(Ne.type).updateOptions(Ne),ue(ut(ge))}catch(Ne){if(ue((0,L.kb)(Pe,(0,z.Te)((0,O.qD)(ge,{error:Ne})))),Ie||(console.error(Ne),ue((0,d.dx)(at("Error updating options:",Ne,ge)))),Ie)throw Ne}},at=(ge,Ie,ue)=>(0,m.gi)(`${ue?`Templating [${ue.id}]`:"Templating"}`,Ie instanceof Error?`${ge} ${Ie.message}`:`${ge}`),ut=ge=>(Ie,ue)=>{const{rootStateKey:me}=ge;if(!(0,O.sN)(me,ue()))return;const Pe=(0,w.dn)(ge,ue());Pe.state!==a.Gu.Done&&Ie((0,L.kb)(ge.rootStateKey,(0,z.Pu)((0,O.qD)(Pe))))};function Tt(ge,Ie=y.tR){return async function(ue,me){const{id:Pe,rootStateKey:Ne}=ge;if(!(0,O.sN)(Ne,me()))return;const Fe=(0,w.dn)(ge,me());if(Fe.type==="query")try{const Be=await Ie().get(Fe.datasource??"");if((0,D.d5)(Be)||!(0,D.Hf)(Be)||It(Fe.query))return;const he={refId:`${Be.name}-${Pe}-Variable-Query`,query:Fe.query};ue((0,L.kb)(Ne,(0,z.QP)((0,O.qD)(ge,{propName:"query",propValue:he}))))}catch(Be){ue((0,d.dx)(at("Failed to upgrade legacy queries",Be))),console.error(Be)}}}function It(ge){return(0,a.Gv)(ge)&&"refId"in ge&&typeof ge.refId=="string"}},48594:(G,R,e)=>{"use strict";e.d(R,{Ay:()=>d,L1:()=>a,kb:()=>g});var t=e(75096),n=e(84014),s=e(85675);const a={keys:{}},r=c=>({type:`templating/keyed/${c.action.type.replace(/^templating\//,"")}`,payload:c});function g(c,h){const o=(0,t.q4)(c);return r({key:o,action:h})}const i=c=>typeof c.type=="string"&&c.type.startsWith("templating/keyed")&&"payload"in c&&typeof c.payload.key=="string";function l(c=a,h){if(i(h)){const{key:o,action:m}=h.payload,u=(0,t.q4)(o),p=s.kH.match(m)?u:c.lastKey,f=(0,n.H)(),y=c.keys[u],x=f(y,m);return{...c,lastKey:p,keys:{...c.keys,[u]:x}}}return c}const d={templating:l}},84014:(G,R,e)=>{"use strict";e.d(R,{H:()=>d,x:()=>c});var t=e(14644),n=e(3843),s=e(27238),a=e(24300),r=e(85675),g=e(83370),i=e(15120);let l;function d(){return l||(l=(0,t.combineReducers)({editor:n.wf,variables:i.Y,optionsPicker:a.ho,transaction:r.Dd,inspect:s.t4})),l}function c(){return{editor:n.nS,variables:g.j,optionsPicker:a.$z,transaction:r.i3,inspect:s.WT}}},87421:(G,R,e)=>{"use strict";e.d(R,{Fs:()=>P,SS:()=>l,Tk:()=>p,UN:()=>x,_2:()=>v,bZ:()=>y,dn:()=>r,hk:()=>o,nS:()=>h,nx:()=>i,pi:()=>c,wk:()=>m,y7:()=>f});var t=e(41811),n=e(99140),s=e(75096),a=e(84014);function r(E,D=(0,n.Gu)(),C=!0){const{id:b,rootStateKey:T}=E,O=i(T,D).variables[b];if(!O){if(C)throw new Error(`Couldn't find variable with id:${b}`);return}return O}function g(E,D,C=(0,n.Gu)()){return Object.values(i(D,C).variables).filter(E).sort((b,T)=>b.index-T.index)}function i(E,D=(0,n.Gu)()){return D.templating.keys[(0,s.q4)(E)]??(0,a.x)()}function l(E,D=(0,n.Gu)()){return g(d,E,D)}function d(E){return E.type!=="system"}const c=(0,t.A)((E,D)=>l(E,(0,n.Gu)())),h=(E,D)=>l(E,D);function o(E,D=(0,n.Gu)()){return m(Object.values(i(E,D).variables))}function m(E){const D=E.filter(d).sort((C,b)=>C.index-b.index);return D.length>0?D[D.length-1].index+1:0}function u(E,D=getState()){return i(E,D).transaction.isDirty}function p(E=(0,n.Gu)()){return E.templating?.lastKey}function f(E=(0,n.Gu)()){if(!E.templating?.lastKey)throw new Error("Accessing lastKey without initializing it variables");return E.templating.lastKey}function y(E,D=(0,n.Gu)()){const C=p(D);return C?g(E,C,D):[]}function x(E=(0,n.Gu)()){const D=p(E);return D?l(D,E):[]}function v(E,D=(0,n.Gu)()){const C=p(D);if(C)return r({id:E,rootStateKey:C,type:"query"},D,!1)}function P(E,D){return E[D]}},56968:(G,R,e)=>{"use strict";e.d(R,{Hr:()=>m,Pu:()=>D,QP:()=>p,QV:()=>u,Te:()=>C,a7:()=>E,dE:()=>x,hj:()=>f,l_:()=>v,qi:()=>o,ut:()=>y,wB:()=>P});var t=e(65307),n=e(2543),s=e.n(n),a=e(39070),r=e(20601),g=e(3843),i=e(24240),l=e(75096),d=e(87421),c=e(83370);const h=(0,t.Z0)({name:"templating/shared",initialState:c.j,reducers:{addVariable:(b,T)=>{const S=T.payload.id??T.payload.data.model.name,O=r.B.get(T.payload.type),M=(0,n.cloneDeep)(O.initialState),I=O.beforeAdding?O.beforeAdding(T.payload.data.model):(0,n.cloneDeep)(T.payload.data.model),L={...(0,n.defaults)({},I,M),id:S,index:T.payload.data.index,global:T.payload.data.global};b[S]=L},variableStateNotStarted:(b,T)=>{const S=(0,d.Fs)(b,T.payload.id);S.state=a.Gu.NotStarted,S.error=null},variableStateFetching:(b,T)=>{const S=(0,d.Fs)(b,T.payload.id);S.state=a.Gu.Loading,S.error=null},variableStateCompleted:(b,T)=>{const S=(0,d.Fs)(b,T.payload.id);S&&(S.state=a.Gu.Done,S.error=null)},variableStateFailed:(b,T)=>{const S=(0,d.Fs)(b,T.payload.id);S&&(S.state=a.Gu.Error,S.error=T.payload.data.error)},removeVariable:(b,T)=>{if(delete b[T.payload.id],!T.payload.data.reIndex)return;const S=Object.values(b).sort((O,M)=>O.index-M.index);for(let O=0;O<S.length;O++)S[O].index=O},duplicateVariable:(b,T)=>{function S(W){return W.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const O=(0,n.cloneDeep)(b[T.payload.id]),M=new RegExp(`^copy_of_${S(O.name)}(_(\\d+))?$`),I=Object.values(b).map(({name:W})=>W.match(M)).filter(W=>W!=null),L=I.map(W=>W[2]).filter(W=>W!=null),B=I.length===0?null:L.length===0?1:L.map(W=>+W).sort((W,U)=>U-W)[0]+1,j=`copy_of_${O.name}${B?`_${B}`:""}`,A=T.payload.data?.newId??j,K=(0,d.wk)(Object.values(b));b[A]={...(0,n.cloneDeep)(r.B.get(T.payload.type).initialState),...O,id:A,name:j,index:K}},changeVariableOrder:(b,T)=>{const{toIndex:S,fromIndex:O}=T.payload.data,M=Object.values(b);for(let I=0;I<M.length;I++){const L=M[I];L.index===O?L.index=S:L.index>O&&L.index<=S?L.index--:L.index<O&&L.index>=S&&L.index++}},changeVariableType:(b,T)=>{const{id:S}=T.payload,{label:O,name:M,index:I,description:L,rootStateKey:B}=b[S];b[S]={...(0,n.cloneDeep)(r.B.get(T.payload.data.newType).initialState),id:S,rootStateKey:B,label:O,name:M,index:I,description:L}},setCurrentVariableValue:(b,T)=>{if(!T.payload.data.option)return;const S=(0,d.Fs)(b,T.payload.id);if(!(0,i.SP)(S))return;const{option:O}=T.payload.data,M={...O,text:(0,l.QT)(O?.text),value:(0,l.QT)(O?.value)};S.current=M,S.options=S.options.map(I=>{I.value=(0,l.QT)(I.value),I.text=(0,l.QT)(I.text);let L=!1;if(Array.isArray(M.value))for(let B=0;B<M.value.length;B++){const j=M.value[B];if(I.value===j){L=!0;break}}else I.value===M.value&&(L=!0);return I.selected=L,I})},changeVariableProp:(b,T)=>{const S=(0,d.Fs)(b,T.payload.id);S[T.payload.data.propName]=T.payload.data.propValue}},extraReducers:b=>b.addCase(g.FN,(T,S)=>{const O=(0,d.Fs)(T,S.payload.id);O.name=S.payload.data.newName})}),o=h.reducer,{removeVariable:m,addVariable:u,changeVariableProp:p,changeVariableOrder:f,duplicateVariable:y,setCurrentVariableValue:x,changeVariableType:v,variableStateNotStarted:P,variableStateFetching:E,variableStateCompleted:D,variableStateFailed:C}=h.actions},85675:(G,R,e)=>{"use strict";e.d(R,{$O:()=>d,Dd:()=>c,i3:()=>a,kH:()=>i,pu:()=>l});var t=e(65307),n=e(80484),s=e(56968);const a={uid:null,status:n.x8.NotStarted,isDirty:!1},r=(0,t.Z0)({name:"templating/transaction",initialState:a,reducers:{variablesInitTransaction:(h,o)=>{h.uid=o.payload.uid,h.status=n.x8.Fetching},variablesCompleteTransaction:(h,o)=>{h.uid===o.payload.uid&&(h.status=n.x8.Completed)},variablesClearTransaction:(h,o)=>{h.uid=null,h.status=n.x8.NotStarted,h.isDirty=!1}},extraReducers:h=>h.addMatcher(g,(o,m)=>{o.status===n.x8.Completed&&(o.isDirty=!0)})});function g(h){return s.Hr.match(h)||s.QV.match(h)||s.QP.match(h)||s.hj.match(h)||s.ut.match(h)||s.l_.match(h)}const{variablesInitTransaction:i,variablesClearTransaction:l,variablesCompleteTransaction:d}=r.actions,c=r.reducer},83370:(G,R,e)=>{"use strict";e.d(R,{j:()=>t});const t={}},15120:(G,R,e)=>{"use strict";e.d(R,{Y:()=>g,v:()=>r});var t=e(65307),n=e(20601),s=e(56968),a=e(83370);const r=(0,t.VP)("templating/cleanVariables"),g=(i=a.j,l)=>{if(r.match(l)){const d=Object.values(i).filter(h=>h.global);return d?d.reduce((h,o)=>(h[o.id]=o,h),{}):a.j}return l?.payload?.type&&n.B.getIfExists(l?.payload?.type)?n.B.get(l.payload.type).reducer((0,s.qi)(i,l),l):i}},80484:(G,R,e)=>{"use strict";e.d(R,{BS:()=>l,Vg:()=>g,eF:()=>d,og:()=>i,x8:()=>r});var t=e(12470),n=e(39070),s=e(65463),a=e(13344),r=(c=>(c.NotStarted="Not started",c.Fetching="Fetching",c.Completed="Completed",c))(r||{});const g={id:a.qF,rootStateKey:null,name:"",type:"query",global:!1,index:-1,hide:t.zL.dontHide,skipUrlSync:!1,state:n.Gu.NotStarted,error:null,description:null};class i extends s.x{static{this.type="variables-changed"}}class l extends s.x{static{this.type="variables-time-range-process-done"}}class d extends s.x{static{this.type="variables-changed-in-url"}}},75096:(G,R,e)=>{"use strict";e.d(R,{AX:()=>E,Lz:()=>y,ML:()=>p,Nz:()=>f,QT:()=>b,SY:()=>o,Wz:()=>C,iP:()=>v,jX:()=>O,pY:()=>I,q$:()=>P,q4:()=>S,qD:()=>M,sN:()=>T,t4:()=>m,u7:()=>x,wJ:()=>u});var t=e(2543),n=e.n(t),s=e(12470),a=e(72574),r=e(39601),g=e(87490),i=e(99140),l=e(20601),d=e(13344),c=e(87421),h=e(80484);const o=/\$(\w+)|\[\[(\w+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g,m=L=>(o.lastIndex=0,o.exec(L));function u(...L){const B=L[L.length-1];L[0]=typeof L[0]=="string"?L[0]:(0,g.MA)(L[0]);const A=L.slice(0,-1).join(" ").match(o);return!!(A!==null?A.find(W=>{const U=m(W);return U!==null&&U.indexOf(B)>-1}):!1)}const p=L=>{if(!L||!L.current)return!1;if(L.current.value){const B=Array.isArray(L.current.value);if(B&&L.current.value.length&&L.current.value[0]===d.To||!B&&L.current.value===d.To)return!0}if(L.current.text){const B=Array.isArray(L.current.text);if(B&&L.current.text.length&&L.current.text[0]===d.Zm||!B&&L.current.text===d.Zm)return!0}return!1},f=L=>!L||!L.current||!L.current.text?"":Array.isArray(L.current.text)?L.current.text.toString():typeof L.current.text!="string"?"":L.current.text,y=L=>!L||!L.current||L.current.value===void 0||L.current.value===null?null:Array.isArray(L.current.value)?L.current.value.toString():typeof L.current.value!="string"?null:L.current.value;function x(L,B=(0,a.w)()){return!L||!L.regex?"":B.replace(L.regex,{},"regex")}function v(L,B,j,A){const K={range:void 0,variable:L,searchFilter:B,scopedVars:A};return(L.refresh===s.CO.onTimeRangeChanged||L.refresh===s.CO.onDashboardLoad)&&(K.range=j.timeRange()),K}function P(L){return L?.type==="custom"?s.CO.onDashboardLoad:!L||!("refresh"in L)||L.refresh!==s.CO.onTimeRangeChanged&&L.refresh!==s.CO.onDashboardLoad?s.CO.never:L.refresh}function E(){return l.B.list().filter(L=>L.id!=="system").map(({id:L,name:B,description:j})=>({label:B,value:L,description:j}))}function D(L){return(0,t.isArray)(L)&&(L.length===0?L=void 0:L.length===1&&(L=L[0])),L}function C(L,B){let j=0;const A={};for(const K in L){if(!K.startsWith(d.qz))continue;let W=D(B[K]),U=D(L[K]);(0,t.isEqual)(U,W)||(A[K]={value:L[K]},j++)}for(const K in B){if(!K.startsWith(d.qz))continue;const W=B[K];(0,t.isArray)(W)&&W.length===0||L.hasOwnProperty(K)||(A[K]={value:"",removed:!0},j++)}return j?A:void 0}function b(L){return Array.isArray(L)?L.map(String):L==null?"":typeof L=="number"?L.toString(10):typeof L=="string"?L:typeof L=="boolean"?L.toString():""}function T(L,B=(0,i.Gu)()){return(0,c.nx)(L,B).transaction.status!==h.x8.NotStarted}function S(L){return String(L)}const O=L=>{if(!L.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${L.id}`);return{type:L.type,id:L.id,rootStateKey:L.rootStateKey}};function M(L,B){return{type:L.type,id:L.id,data:B}}function I(){const L=(0,a.w)().getVariables(),B=r.Ny.getSearchObject();return Object.keys(B).filter(j=>j.indexOf(d.qz)!==-1&&L.some(A=>A.name===j.replace(d.qz,""))).reduce((j,A)=>{const K=A.replace(d.qz,"");return j[K]=B[A],j},{})}},28271:(G,R,e)=>{"use strict";var t=e(6262),n=e(9423),s=e(7452),a=e(78624),r=e(4213),g=e(34796),i=e(13609),l=e(2543),d=e.n(l),c=e(96540),h=e(5338),o=e(47232),m=e(1933),u=e(69550),p=e(97497),f=e(96915),y=e(71733),x=e(17172),v=e(23509),P=e(39601),E=e(96937),D=e(61706),C=e(3591),b=e(63639),T=e(89191),S=e(19347),O=e(4402),M=e(3197),I=e(71798),L=e(79396),B=e(7299),j=e(14778),A=e(23172),K=e(63415),W=e(97152),U=e(24308),F=e(46235),V=e(2913),w=e(94041),z=e(32264),N=e(74848),H=e(11261),Q=e(85200),X=e(1173),ee=e(28240),Z=e(18282),q=e(97522),ae=e(73376),k=e(14186),se=e(94354),te=e(90613),ne=e(55852),le=e(91847);function re(_){if(_ in le.uk){const{name:Y,getHelperDocs:ie,links:ve}=le.uk[_],Re=ie(le.g_.UIImage),Le=de(Re);if(ve?.length){const $e=ve.map(ke=>`
  Or visit <a href="${ke.url}" target="_blank">${ke.title}</a>

  `).join("");return{name:Y,helperDocs:`
        ${Le}
        ${(0,le.$n)()}
  ${$e}
        `}}return{name:Y,helperDocs:`
      ${Le}
      ${(0,le.$n)()}
      `}}return{name:"No documentation found",helperDocs:(0,le.$n)()}}const de=_=>_.replace(/\[(.*?)\]\(#.*?\)/g,"$1").replace(/\[[^\]]*\]\[\]/g,"");var oe=e(39268),J=e(90182),ce=e(83077),pe=e(91890),xe=e(72574),fe=e(10354),Ee=e(88841),Se=e(94397);function ye(_,Y){switch(Y.type){case H.PU.boolean:return(0,l.isUndefined)(_)?!1:Ve(_);case H.PU.number:return isNaN(_)?0:parseFloat(_);case H.PU.string:return _?String(_):"";default:return _}}const Ve=_=>(0,l.isString)(_)?!(_[0]==="F"||_[0]==="f"||_[0]==="0"):!!_;function Me(_){return function({options:ie,onChange:ve,field:Re}){const{validator:Le,converter:$e=ye}=_,{value:ke}=ie,[Xe,ct]=(0,c.useState)(!Le(ke)),Ct=(0,xe.w)().getVariables().map(Rt=>({value:Rt.name,label:Rt.label||Rt.name,origin:pe.$0.Template})),Ft=(0,c.useCallback)(Rt=>{ct(!Le(Rt.currentTarget.value))},[ct,Le]),Ot=(0,c.useCallback)(Rt=>{if(Xe)return;const{value:Mn}=Rt.currentTarget;ve({...ie,value:$e(Mn,Re)})},[ie,ve,Xe,Re,$e]),jt=(0,c.useCallback)(Rt=>{ct(!Le(Rt)),ve({...ie,value:Rt})},[ct,Le,ve,ie]);return z.$.featureToggles.transformationsVariableSupport?(0,N.jsx)(Ee.y,{invalid:Xe,value:ke,error:"Value needs to be an integer or a variable",onChange:jt,placeholder:"Value or variable",suggestions:Ct}):(0,N.jsx)(fe.p,{className:"flex-grow-1",invalid:Xe,defaultValue:String(ie.value),placeholder:"Value",onChange:Ft,onBlur:Ot})}}const Ce=()=>[{name:"Is greater",id:X.Js.greater,component:Me({validator:Se.N_})},{name:"Is greater or equal",id:X.Js.greaterOrEqual,component:Me({validator:Se.N_})},{name:"Is lower",id:X.Js.lower,component:Me({validator:Se.N_})},{name:"Is lower or equal",id:X.Js.lowerOrEqual,component:Me({validator:Se.N_})},{name:"Is equal",id:X.Js.equal,component:Me({validator:()=>!0})},{name:"Is not equal",id:X.Js.notEqual,component:Me({validator:()=>!0})},{name:"Is Substring",id:X.Js.substring,component:Me({validator:()=>!0})},{name:"Is not substring",id:X.Js.notSubstring,component:Me({validator:()=>!0})}],Ue=()=>null,Ae=()=>[{name:"Is null",id:X.Js.isNull,component:Ue},{name:"Is not null",id:X.Js.isNotNull,component:Ue}];var we=e(76892);function We(_){return function({options:ie,onChange:ve,field:Re}){const{validator:Le}=_,[$e,ke]=(0,c.useState)({from:!Le(ie.from),to:!Le(ie.to)}),ct=(0,xe.w)().getVariables().map(Ot=>({value:Ot.name,label:Ot.label||Ot.name,origin:pe.$0.Template})),pt=(0,c.useCallback)((Ot,jt)=>{ke({...$e,[jt]:!Le(Ot.currentTarget.value)})},[ke,Le,$e]),Ct=(0,c.useCallback)((Ot,jt)=>{if($e[jt])return;const{value:Rt}=Ot.currentTarget;ve({...ie,[jt]:ye(Rt,Re)})},[ie,ve,$e,Re]),Ft=(0,c.useCallback)((Ot,jt)=>{const Rt=!Le(Ot);ke({...$e,[jt]:Rt}),!Rt&&ve({...ie,[jt]:Ot})},[ie,ve,$e,ke,Le]);return z.$.featureToggles.transformationsVariableSupport?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(Ee.y,{value:String(ie.from),invalid:$e.from,error:"Value needs to be an integer or a variable",placeholder:"From",onChange:Ot=>Ft(Ot,"from"),suggestions:ct}),(0,N.jsx)(we.c,{children:"and"}),(0,N.jsx)(Ee.y,{invalid:$e.to,error:"Value needs to be an integer or a variable",value:String(ie.to),placeholder:"To",suggestions:ct,onChange:Ot=>Ft(Ot,"to")})]}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(fe.p,{invalid:$e.from,defaultValue:String(ie.from),placeholder:"From",onChange:Ot=>pt(Ot,"from"),onBlur:Ot=>Ct(Ot,"from")}),(0,N.jsx)(we.c,{children:"and"}),(0,N.jsx)(fe.p,{invalid:$e.to,defaultValue:String(ie.to),placeholder:"To",onChange:Ot=>pt(Ot,"to"),onBlur:Ot=>Ct(Ot,"to")})]})}}const _e=()=>[{name:"Is between",id:X.Js.between,component:We({validator:Se.N_})}];function at(_){return function({options:ie,onChange:ve,field:Re}){const{validator:Le,converter:$e=ye}=_,{value:ke}=ie,[Xe,ct]=(0,c.useState)(!Le(ke)),Ct=(0,xe.w)().getVariables().map(Rt=>({value:Rt.name,label:Rt.label||Rt.name,origin:pe.$0.Template})),Ft=(0,c.useCallback)(Rt=>{ct(!Le(Rt.currentTarget.value))},[ct,Le]),Ot=(0,c.useCallback)(Rt=>{ct(!Le(Rt)),ve({...ie,value:Rt})},[ct,Le,ve,ie]),jt=(0,c.useCallback)(Rt=>{if(Xe)return;const{value:Mn}=Rt.currentTarget;ve({...ie,value:$e(Mn,Re)})},[ie,ve,Xe,Re,$e]);return z.$.featureToggles.transformationsVariableSupport?(0,N.jsx)(Ee.y,{invalid:Xe,value:ke,onChange:Ot,placeholder:"Value or variable",suggestions:Ct}):(0,N.jsx)(fe.p,{className:"flex-grow-1",invalid:Xe,defaultValue:String(ie.value),placeholder:"Value",onChange:Ft,onBlur:jt})}}const ut=()=>[{name:"Regex",id:X.Js.regex,component:at({validator:()=>!0,converter:_=>String(_)})}],Tt=new ce.O(()=>[...Ce(),...Ae(),..._e(),...ut()]),It=_=>{const{onDelete:Y,onChange:ie,filter:ve,fieldsInfo:Re}=_,{fieldsAsOptions:Le,fieldByDisplayName:$e}=Re,ke=ue(ve,Le)??"",Xe=$e[ke],ct=Xe?ge(Xe):[],pt=Ie(ve,ct),Ct=Tt.getIfExists(pt),Ft=(0,c.useCallback)(Rt=>{Rt?.value&&ie({...ve,fieldName:Rt.value})},[ie,ve]),Ot=(0,c.useCallback)(Rt=>{if(!Rt?.value)return;const Mn=Rt.value,Ws=Q.hI.get(Mn).getDefaultOptions(Xe);ie({...ve,config:{id:Mn,options:Ws}})},[ie,ve,Xe]),jt=(0,c.useCallback)(Rt=>{ie({...ve,config:{...ve.config,options:Rt}})},[ie,ve]);return!Xe||!Ct||!Ct.component?null:(0,N.jsxs)(oe.C,{children:[(0,N.jsx)(k.I,{label:"Field",labelWidth:14,children:(0,N.jsx)(J.l6,{className:"min-width-15 max-width-24",placeholder:"Field Name",options:Le,value:ve.fieldName,onChange:Ft})}),(0,N.jsx)(k.I,{label:"Match",children:(0,N.jsx)(J.l6,{className:"width-12",placeholder:"Select test",options:ct,value:pt,onChange:Ot})}),(0,N.jsx)(k.I,{label:"Value",grow:!0,children:(0,N.jsx)(Ct.component,{field:Xe,options:ve.config.options??{},onChange:jt})}),(0,N.jsx)(te.a,{marginBottom:.5,children:(0,N.jsx)(ne.$n,{icon:"times",onClick:Y,variant:"secondary"})})]})},ge=_=>{const Y=[];for(const ie of Q.hI.list())!ie.isApplicable(_)||!Tt.getIfExists(ie.id)||Y.push({value:ie.id,label:ie.name,description:ie.description});return Y},Ie=(_,Y)=>{const ie=Y.find(ve=>ve.value===_.config.id);if(ie&&ie.value)return ie.value;if(Y[0]?.value)return Y[0]?.value},ue=(_,Y)=>{const ie=Y.find(ve=>ve.value===_.fieldName);if(ie&&ie.value)return ie.value;if(Y[0]?.value)return Y[0]?.value},me=[{label:"Include",value:ae.j4.include},{label:"Exclude",value:ae.j4.exclude}],Pe=[{label:"Match all",value:ae.Sm.all},{label:"Match any",value:ae.Sm.any}],Ne=_=>{const{input:Y,options:ie,onChange:ve}=_,Re=Be(Y),Le=(0,c.useCallback)(()=>{const pt=Y[0],Ct=pt.fields.find(jt=>jt.type!==H.PU.time);if(!Ct)return;const Ft=(0,l.cloneDeep)(ie.filters),Ot=Q.hI.get(X.Js.isNull);Ft.push({fieldName:(0,ee.Ct)(Ct,pt,Y),config:{id:Ot.id,options:Ot.getDefaultOptions(Ct)}}),ve({...ie,filters:Ft})},[ve,ie,Y]),$e=(0,c.useCallback)(pt=>{let Ct=(0,l.cloneDeep)(ie.filters);Ct.splice(pt,1),ve({...ie,filters:Ct})},[ie,ve]),ke=(0,c.useCallback)((pt,Ct)=>{let Ft=(0,l.cloneDeep)(ie.filters);Ft[Ct]=pt,ve({...ie,filters:Ft})},[ie,ve]),Xe=(0,c.useCallback)(pt=>{ve({...ie,type:pt??ae.j4.include})},[ie,ve]),ct=(0,c.useCallback)(pt=>{ve({...ie,match:pt??ae.Sm.all})},[ie,ve]);return(0,N.jsxs)("div",{children:[(0,N.jsx)(k.I,{label:"Filter type",labelWidth:16,children:(0,N.jsx)("div",{className:"width-15",children:(0,N.jsx)(se.z,{options:me,value:ie.type,onChange:Xe,fullWidth:!0})})}),(0,N.jsx)(k.I,{label:"Conditions",labelWidth:16,children:(0,N.jsx)("div",{className:"width-15",children:(0,N.jsx)(se.z,{options:Pe,value:ie.match,onChange:ct,fullWidth:!0})})}),(0,N.jsxs)(te.a,{paddingLeft:2,children:[ie.filters.map((pt,Ct)=>(0,N.jsx)(It,{filter:pt,fieldsInfo:Re,onChange:Ft=>ke(Ft,Ct),onDelete:()=>$e(Ct)},Ct)),(0,N.jsx)(ne.$n,{icon:"plus",size:"sm",onClick:Le,variant:"secondary",children:"Add condition"})]})]})},Fe={id:Z.F.filterByValue,editor:Ne,transformation:q.c.filterByValueTransformer,name:q.c.filterByValueTransformer.name,description:"Removes rows of the query results using user-defined filters. This is useful if you can not filter your data in the data source.",categories:new Set([p.m.Filter]),help:re(Z.F.filterByValue).helperDocs},Be=_=>(0,c.useMemo)(()=>{const Y={fieldsAsOptions:[],fieldByDisplayName:{}};return Array.isArray(_)?_.reduce((ie,ve)=>ve.fields.reduce((Re,Le)=>{const $e=(0,ee.Ct)(Le,ve,_);return Re.fieldByDisplayName[$e]||(Re.fieldsAsOptions.push({label:$e,value:$e,type:Le.type}),Re.fieldByDisplayName[$e]=Le),Re},ie),Y):Y},[_]);var he=e(43429),be=e(60264),Ke=e(48192),ze=e(66211),nt=e(54612);function tt(_,Y){const ie={data:_.input,options:_.options},ve=new Ke.C({id:"root",title:"root"}),Re=$e=>{if($e?.length){const ke=$e[0];let Xe=ve.categories.find(ct=>ct.props.id===ke);return Xe||(Xe=new Ke.C({id:ke,title:ke}),ve.categories.push(Xe)),Xe}return ve},Le={getValue:$e=>(0,l.get)(_.options,$e),onChange:($e,ke)=>{_.onChange((0,nt.Sf)(_.options,$e,ke))}};return(0,ze.g5)(Y,Le,Re,ie),ve}function ot(_){const Y={data:[],options:{}},ie={},ve=new be.pv;_(ve,Y);for(const Re of ve.getItems())Re.defaultValue!=null&&(0,l.set)(ie,Re.path,Re.defaultValue);return ie}var gt=e(27825),He=e(80909);const et=(_,Y)=>{const ie=Y.options??{};(0,gt.J)("",_,ie)},rt=_=>{(0,c.useEffect)(()=>{if(!_.options.xBuckets?.mode){const ie=ot(et);_.onChange({...ie,..._.options})}});const Y=tt(_,et);return(0,N.jsx)("div",{children:(0,N.jsx)("div",{children:Y.items.map(ie=>ie.render())})})},ht={id:He.wY.id,editor:rt,transformation:He.wY,name:He.wY.name,description:He.wY.description,state:he.pn.alpha,categories:new Set([p.m.CreateNewVisualization]),help:re(He.wY.id).helperDocs};var ft=e(32196),De=e(40845),Te=e(84349),Oe=e(75059),Ye=e(42734),Ge=e(24293),Je=e(28802),it=e(50082),St=e(25019);function zt(_,Y,ie){const ve={},Re={};for(const Le of _.fields){const $e=(0,ee.Ct)(Le,_),ke=ie.index[$e],Xe=ke.handler;if(!Xe)continue;const ct=Le.values[Y];if(ct==null)continue;const pt=Xe.processor(ct,ve,Re,ke.handlerArguments);pt!=null&&(ve[Xe.targetProperty??Xe.key]=pt)}return Re.mappingValues&&(ve.mappings=an(Re)),ve}var Kt=(_=>(_.Name="field.name",_.Value="field.value",_.Label="field.label",_.Ignore="__ignore",_))(Kt||{});const Qt=[{key:"field.name",name:"Field name",processor:()=>{}},{key:"field.value",name:"Field value",processor:()=>{}},{key:"field.label",name:"Field label",processor:()=>{}},{key:"__ignore",name:"Ignore",processor:()=>{}},{key:"max",processor:Yn},{key:"min",processor:Yn},{key:"unit",processor:_=>_.toString()},{key:"decimals",processor:Yn},{key:"displayName",name:"Display name",processor:_=>_.toString()},{key:"color",processor:_=>({fixedColor:_,mode:Ge.Y.Fixed})},{key:"threshold1",name:"Threshold",targetProperty:"thresholds",processor:(_,Y,ie,ve)=>{const Re=(0,Je.t)(_);if(!isNaN(Re))return Y.thresholds||(Y.thresholds={mode:it.O.Absolute,steps:[{value:-1/0,color:"green"}]}),Y.thresholds.steps.push({value:Re,color:ve.threshold?.color??"red"}),Y.thresholds}},{key:"mappings.value",name:"Value mappings / Value",targetProperty:"mappings",defaultReducer:Oe.gy.allValues,processor:(_,Y,ie)=>{if((0,l.isArray)(_))return ie.mappingValues=_,Y.mappings}},{key:"mappings.color",name:"Value mappings / Color",targetProperty:"mappings",defaultReducer:Oe.gy.allValues,processor:(_,Y,ie)=>{if((0,l.isArray)(_))return ie.mappingColors=_,Y.mappings}},{key:"mappings.text",name:"Value mappings / Display text",targetProperty:"mappings",defaultReducer:Oe.gy.allValues,processor:(_,Y,ie)=>{if((0,l.isArray)(_))return ie.mappingTexts=_,Y.mappings}}];function an(_){const Y={type:St.d.ValueToText,options:{}};if(!_.mappingValues)return[];for(let ie=0;ie<_.mappingValues.length;ie++){const ve=_.mappingValues[ie];ve!=null&&(Y.options[ve.toString()]={color:_.mappingColors&&_.mappingColors[ie],text:_.mappingTexts&&_.mappingTexts[ie],index:ie})}return[Y]}let Nn=null;function zn(){if(Nn===null){Nn={};for(const _ of Qt)Nn[_.key]=_}return Nn}function Yn(_){const Y=(0,Je.t)(_);if(!isNaN(Y))return Y}function ss(_,Y){for(const ie of Y)if(_===ie.fieldName)return ie.handlerKey;return _.toLowerCase()}function ds(_){return _?zn()[_]:null}function Ms(_,Y,ie){const ve={index:{}};let Re=Y.find($e=>$e.handlerKey==="field.name"),Le=Y.find($e=>$e.handlerKey==="field.value");for(const $e of _.fields){const ke=(0,ee.Ct)($e,_),Xe=Y.find(Ct=>Ct.fieldName===ke),ct=Xe?Xe.handlerKey:ke.toLowerCase();let pt=ds(ct);ie&&(pt?(pt.key==="field.name"&&(ve.nameField=$e),pt.key==="field.value"&&(ve.valueField=$e)):Xe||(!ve.nameField&&!Re&&$e.type===H.PU.string&&(ve.nameField=$e,pt=ds("field.name")),!ve.valueField&&!Le&&$e.type===H.PU.number&&(ve.valueField=$e,pt=ds("field.value")))),!pt&&ie&&(pt=ds("field.label")),ve.index[ke]={automatic:!Xe,handler:pt,handlerArguments:Xe?.handlerArguments??{},reducerId:Xe?.reducerId??pt?.defaultReducer??Oe.gy.lastNotNull}}return ve}var Bs=e(83598);function gs(_){switch(_){case"threshold1":return!0;default:return!1}}function Zn({handlerArguments:_,handlerKey:Y,onChange:ie}){const ve=Re=>{ie(Re?{..._,threshold:{..._.threshold,color:Re}}:{..._,threshold:void 0})};return(0,N.jsx)(N.Fragment,{children:Y==="threshold1"&&(0,N.jsx)(fe.p,{type:"text",value:"Threshold color","aria-label":"Threshold color",disabled:!0,width:20,prefix:(0,N.jsx)(Bs.sk,{color:_.threshold?.color??"red",onChange:ve,enableNamedColors:!0})})})}function Ls({frame:_,mappings:Y,onChange:ie,withReducers:ve,withNameAndValue:Re}){const Le=(0,De.of)(Qn),$e=Ln(_,Y,Re),ke=Qt.map(Ft=>Hn(Ft,!1)),Xe=Y.reduce((Ft,Ot)=>Ft||gs(Ot.handlerKey),!1),ct=(Ft,Ot)=>{const jt=Y.findIndex(Rt=>Rt.fieldName===Ft.fieldName);if(Ot)if(jt!==-1){const Rt=[...Y];Rt.splice(jt,1,{...Y[jt],handlerKey:Ot.value}),ie(Rt)}else ie([...Y,{fieldName:Ft.fieldName,handlerKey:Ot.value}]);else ie(jt!==-1?Y.filter((Rt,Mn)=>Mn!==jt):[...Y,{fieldName:Ft.fieldName,handlerKey:"__ignore"}])},pt=(Ft,Ot)=>{const jt=Y.findIndex(Rt=>Rt.fieldName===Ft.fieldName);if(jt!==-1){const Rt=[...Y];Rt.splice(jt,1,{...Y[jt],reducerId:Ot}),ie(Rt)}else ie([...Y,{fieldName:Ft.fieldName,handlerKey:Ft.handlerKey,reducerId:Ot}])},Ct=(Ft,Ot)=>{const jt=Y.findIndex(Rt=>Rt.fieldName===Ft.fieldName);if(jt!==-1){const Rt=[...Y];Rt.splice(jt,1,{...Y[jt],handlerArguments:Ot}),ie(Rt)}else ie([...Y,{fieldName:Ft.fieldName,handlerKey:Ft.handlerKey,handlerArguments:Ot}])};return(0,N.jsxs)("table",{className:Le.table,children:[(0,N.jsx)("thead",{children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("th",{children:"Field"}),(0,N.jsx)("th",{children:"Use as"}),ve&&(0,N.jsx)("th",{children:"Select"}),Xe&&(0,N.jsx)("th",{children:"Additional settings"})]})}),(0,N.jsx)("tbody",{children:$e.map(Ft=>(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{className:Le.labelCell,children:Ft.fieldName}),(0,N.jsx)("td",{className:Le.selectCell,"data-testid":`${Ft.fieldName}-config-key`,children:(0,N.jsx)(J.l6,{options:ke,value:Ft.configOption,placeholder:Ft.placeholder,isClearable:!0,onChange:Ot=>ct(Ft,Ot)})}),ve&&(0,N.jsx)("td",{"data-testid":`${Ft.fieldName}-reducer`,className:Le.selectCell,children:(0,N.jsx)(Ye.S,{stats:[Ft.reducerId],defaultStat:Ft.reducerId,onChange:Ot=>pt(Ft,Ot[0])})}),Xe&&(0,N.jsx)("td",{"data-testid":`${Ft.fieldName}-handler-arg`,className:Le.selectCell,children:(0,N.jsx)(Zn,{handlerKey:Ft.handlerKey,handlerArguments:Ft.handlerArguments,onChange:Ot=>Ct(Ft,Ot)})})]},Ft.fieldName))})]})}function Ln(_,Y,ie){const ve=[],Re=Ms(_,Y??[],ie);for(const Le of _.fields){const $e=(0,ee.Ct)(Le,_),ke=Re.index[$e],Xe=Hn(ke.handler,ke.automatic);ve.push({fieldName:$e,configOption:ke.automatic?null:Xe,placeholder:ke.automatic?Xe?.label:"Choose",handlerKey:ke.handler?.key??null,reducerId:ke.reducerId,handlerArguments:ke.handlerArguments})}for(const Le of Y)if(!ve.find($e=>$e.fieldName===Le.fieldName)){const $e=ds(Le.handlerKey);ve.push({fieldName:Le.fieldName,handlerKey:Le.handlerKey,configOption:Hn($e,!1),missingInFrame:!0,reducerId:Le.reducerId??Oe.gy.lastNotNull,handlerArguments:{}})}return Object.values(ve)}function Hn(_,Y){if(!_)return null;let ie=_.name??(0,l.capitalize)(_.key);return Y&&(ie=`${ie} (auto)`),{label:ie,value:_.key}}const Qn=_=>({table:(0,ft.css)`
    margin-top: ${_.spacing(1)};

    td,
    th {
      border-right: 4px solid ${_.colors.background.primary};
      border-bottom: 4px solid ${_.colors.background.primary};
      white-space: nowrap;
    }
    th {
      font-size: ${_.typography.bodySmall.fontSize};
      line-height: ${_.spacing(4)};
      padding: ${_.spacing(0,1)};
    }
  `,labelCell:(0,ft.css)`
    font-size: ${_.typography.bodySmall.fontSize};
    background: ${_.colors.background.secondary};
    padding: ${_.spacing(0,1)};
    max-width: 400px;
    overflow: hidden;
    text-overflow: ellipsis;
    min-width: 140px;
  `,selectCell:(0,ft.css)`
    padding: 0;
    min-width: 161px;
  `});var mt=e(81160);function Yt(_,Y){let ie=null;for(const ke of Y)if(ke.refId===_.configRefId){ie=ke;break}if(!ie)return Y;const ve={fields:[],length:1},Re=Ms(ie,_.mappings??[],!1);for(const ke of ie.fields){const Xe={...ke},ct=(0,ee.Ct)(ke,ie),pt=Re.index[ct],Ct=(0,Oe.Nw)({field:ke,reducers:[pt.reducerId]});Xe.values=[Ct[pt.reducerId]],ve.fields.push(Xe)}const Le=[],$e=(0,Q.NS)(_.applyTo||{id:X.Ct.numeric});for(const ke of Y){if(ke===ie&&Y.length>1)continue;const Xe={fields:[],length:ke.length,refId:ke.refId};for(const ct of ke.fields)if($e(ct,ke,Y)){const pt=zt(ve,0,Re);Xe.fields.push({...ct,config:{...ct.config,...pt}})}else Xe.fields.push(ct);Le.push(Xe)}return Le}const on={id:Z.F.configFromData,name:"Config from query results",description:"Set unit, min, max and more from data.",defaultOptions:{configRefId:"config",mappings:[]},operator:_=>Y=>Y.pipe((0,mt.T)(ie=>Yt(_,ie)))};function ln({input:_,onChange:Y,options:ie}){const ve=(0,De.of)(yn),Re=_.map(Ot=>Ot.refId).filter(Ot=>Ot!=null).map(Ot=>({label:Ot,value:Ot})),Le=ie.configRefId||"config",$e=ie.applyTo??{id:X.Ct.byType,options:"number"},ke=Te.g.get($e.id),Xe=_.find(Ot=>Ot.refId===Le),ct=Ot=>{Y({...ie,configRefId:Ot.value||"config"})},pt=Ot=>{Y({...ie,applyTo:{id:Ot.value}})},Ct=Ot=>{Y({...ie,applyTo:{id:$e.id,options:Ot}})},Ft=Te.g.list().filter(Ot=>!Ot.excludeFromPicker).map(Ot=>({label:Ot.name,value:Ot.id,description:Ot.description}));return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{label:"Config query",labelWidth:20,children:(0,N.jsx)(J.l6,{onChange:ct,options:Re,value:Le,width:30})})}),(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{label:"Apply to",labelWidth:20,children:(0,N.jsx)(J.l6,{onChange:pt,options:Ft,value:$e.id,width:30})})}),(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{label:"Apply to options",labelWidth:20,className:ve.matcherOptions,children:(0,N.jsx)(ke.component,{matcher:ke.matcher,data:_,options:$e.options,onChange:Ct})})}),(0,N.jsx)(oe.C,{children:Xe&&(0,N.jsx)(Ls,{frame:Xe,mappings:ie.mappings,onChange:Ot=>Y({...ie,mappings:Ot}),withReducers:!0})})]})}const fn={id:on.id,editor:ln,transformation:on,name:on.name,description:on.description,state:he.pn.beta,categories:new Set([p.m.CalculateNewFields]),help:re(on.id).helperDocs},yn=_=>({matcherOptions:(0,ft.css)`
    min-width: 404px;
  `});var wn=e(62467),Xn=e(58307),xn=e(66350),Ut=e(15292),nn=e(11710),hn=e(4025);const dn=16,Sn=_=>{const{options:Y,onChange:ie}=_,ve=(0,xn.pR)(_.options.binary?.left??"",_.names),Re=(0,xn.pR)(_.options.binary?.right??"",_.names);(ve!==_.options.binary?.left||Re!==_.options.binary?.right)&&ie({...Y,mode:xn.UY.BinaryOperation,binary:{operator:Y.binary?.operator,left:ve,right:Re}});const{binary:Le}=Y;let $e=!Le?.left,ke=!Le?.right;const Xe=!Le?.left?.matcher,ct=!Le?.right?.matcher,pt=Le?.left?.matcher?.options,Ct=Le?.right?.matcher?.options,Ft=Le?.left?.matcher?.id===X.Ct.byName,Ot=Le?.right?.matcher?.id===X.Ct.byName,jt=_.names.map(Ia=>(Ft&&Ia===pt&&($e=!0),Ot&&Ia===Ct&&(ke=!0),{label:Ia,value:JSON.stringify({matcher:{id:X.Ct.byName,options:Ia}})})),Rt=$e?[...jt]:Ft?[...jt,{label:pt,value:JSON.stringify(Le.left),icon:""}]:[...jt],Mn=ke?[...jt]:Ot?[...jt,{label:Ct,value:JSON.stringify(Le.right),icon:""}]:[...jt];Rt.push({label:`All ${H.PU.number} fields`,value:JSON.stringify({matcher:{id:X.Ct.byType,options:H.PU.number}}),icon:(0,hn.lV)(H.PU.number)}),Xe&&Le?.left?.fixed&&Rt.push({label:Le.left.fixed,value:JSON.stringify(Le.left)??"",icon:""}),ct&&Le?.right?.fixed&&Mn.push({label:Le.right.fixed,value:JSON.stringify(Le.right)??"",icon:""});const Ws=nn.b.list().map(Ia=>({label:Ia.binaryOperationID,value:Ia.binaryOperationID})),Fs=Ia=>{ie({...Y,mode:xn.UY.BinaryOperation,binary:Ia})},ta=Ia=>{const Rr=JSON.parse(Ia.value??"");Rr.matcher?Fs({...Le,left:Rr}):Fs({...Le,left:{fixed:Rr.fixed??Ia.value?.toString()}})},Rs=Ia=>{const Rr=JSON.parse(Ia.value??"");Rr.matcher?Fs({...Le,right:Rr}):Fs({...Le,right:{fixed:Rr.fixed??Ia.value?.toString()}})},ar=Ia=>{Fs({...Le,operator:Ia.value})};return(0,N.jsx)(N.Fragment,{children:(0,N.jsxs)(oe.C,{children:[(0,N.jsx)(k.I,{label:"Operation",labelWidth:dn,children:(0,N.jsx)(J.l6,{allowCustomValue:!0,placeholder:"Field(s) or number",options:Rt,className:"min-width-18",value:JSON.stringify(Le?.left),onChange:ta})}),(0,N.jsx)(k.I,{children:(0,N.jsx)(J.l6,{className:"width-4",options:Ws,value:Le?.operator??Ws[0].value,onChange:ar})}),(0,N.jsx)(k.I,{children:(0,N.jsx)(J.l6,{allowCustomValue:!0,placeholder:"Field or number",className:"min-width-10",options:Mn,value:JSON.stringify(Le?.right),onChange:Rs})})]})})},es=_=>{const{names:Y,onChange:ie,options:ve}=_,{cumulative:Re}=ve,Le=Y.map(ct=>({label:ct,value:ct})),$e=ct=>{const pt=ct.length?ct[0]:Oe.gy.sum;ke({...Re,reducer:pt})},ke=ct=>{ie({...ve,mode:xn.UY.CumulativeFunctions,cumulative:ct})},Xe=ct=>{ke({...Re,field:ct.value})};return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(k.I,{label:"Field",labelWidth:dn,children:(0,N.jsx)(J.l6,{placeholder:"Field",options:Le,className:"min-width-18",value:Re?.field,onChange:Xe})}),(0,N.jsx)(k.I,{label:"Calculation",labelWidth:dn,children:(0,N.jsx)(Ye.S,{allowMultiple:!1,className:"width-18",stats:[Re?.reducer||Oe.gy.sum],onChange:$e,defaultStat:Oe.gy.sum,filterOptions:ct=>ct.id===Oe.gy.sum||ct.id===Oe.gy.mean})})]})},Pt=_=>{const{options:Y,onChange:ie}=_,{index:ve}=Y,Re=Le=>{ie({...Y,index:{asPercentile:Le.currentTarget.checked}})};return(0,N.jsx)(N.Fragment,{children:(0,N.jsx)(k.I,{labelWidth:dn,label:"As percentile",tooltip:"Transform the row index as a percentile.",children:(0,N.jsx)(Ut.K,{value:!!ve?.asPercentile,onChange:Re})})})};var Ze=e(66864),lt=e(92174);const yt=_=>{const{names:Y,selected:ie,onChange:ve,options:Re}=_,{reduce:Le}=Re,$e=pt=>{ve({...Re,reduce:pt})},ke=pt=>{ie.indexOf(pt)>-1?Xe(ie.filter(Ct=>Ct!==pt)):Xe([...ie,pt])},Xe=pt=>{$e({...Le,include:pt})},ct=pt=>{const Ct=pt.length?pt[0]:Oe.gy.sum,{reduce:Ft}=Re;$e({...Ft,reducer:Ct})};return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(k.I,{label:"Operation",labelWidth:dn,grow:!0,children:(0,N.jsx)(Ze.Gy,{spacing:"xs",align:"flex-start",wrap:!0,children:Y.map((pt,Ct)=>(0,N.jsx)(lt.m,{onClick:()=>{ke(pt)},label:pt,selected:ie.indexOf(pt)>-1},`${pt}/${Ct}`))})}),(0,N.jsx)(k.I,{label:"Calculation",labelWidth:dn,children:(0,N.jsx)(Ye.S,{allowMultiple:!1,className:"width-18",stats:[Le?.reducer||Oe.gy.sum],onChange:ct,defaultStat:Oe.gy.sum})})]})};var Nt=e(27618);const wt=_=>{const{options:Y,onChange:ie}=_,{unary:ve}=Y,Re=Ct=>{ie({...Y,mode:xn.UY.UnaryOperation,unary:Ct})},Le=Ct=>{Re({...ve,operator:Ct.value})},$e=Ct=>{Re({...ve,fieldName:Ct.value})};let ke=!ve?.fieldName;const Xe=_.names.map(Ct=>(Ct===ve?.fieldName&&(ke=!0),{label:Ct,value:Ct})),ct=Nt.j.list().map(Ct=>({label:Ct.unaryOperationID,value:Ct.unaryOperationID})),pt=ke?Xe:[...Xe,{label:ve?.fieldName,value:ve?.fieldName}];return(0,N.jsx)(N.Fragment,{children:(0,N.jsxs)(oe.C,{children:[(0,N.jsx)(k.I,{label:"Operation",labelWidth:dn,children:(0,N.jsx)(J.l6,{options:ct,value:ve?.operator??ct[0].value,onChange:Le})}),(0,N.jsx)(k.I,{label:"(",labelWidth:2,children:(0,N.jsx)(J.l6,{placeholder:"Field",className:"min-width-11",options:pt,value:ve?.fieldName,onChange:$e})}),(0,N.jsx)(we.c,{width:2,children:")"})]})})};var Zt=e(60188);const pn=_=>{const{options:Y,names:ie,onChange:ve}=_,{window:Re}=Y,Le=ie.map(jt=>({label:jt,value:jt})),$e=[{label:"Trailing",value:xn.ip.Trailing},{label:"Centered",value:xn.ip.Centered}],ke=[{label:"Percentage",value:xn.Bp.Percentage},{label:"Fixed",value:xn.Bp.Fixed}],Xe=jt=>{ve({...Y,mode:xn.UY.WindowFunctions,window:jt})},ct=jt=>{Xe({...Re,field:jt.value})},pt=jt=>{Xe({...Re,windowSize:jt&&Re?.windowSizeMode===xn.Bp.Percentage?jt/100:jt})},Ct=jt=>{Xe({...Re,windowSize:Re?.windowSize?jt===xn.Bp.Percentage?Re.windowSize/100:Re.windowSize*100:void 0,windowSizeMode:jt})},Ft=jt=>{const Rt=jt.length?jt[0]:Oe.gy.sum;Xe({...Re,reducer:Rt})},Ot=jt=>{Xe({...Re,windowAlignment:jt})};return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(k.I,{label:"Field",labelWidth:dn,children:(0,N.jsx)(J.l6,{placeholder:"Field",options:Le,className:"min-width-18",value:Re?.field,onChange:ct})}),(0,N.jsx)(k.I,{label:"Calculation",labelWidth:dn,children:(0,N.jsx)(Ye.S,{allowMultiple:!1,className:"width-18",stats:[Re?.reducer||Oe.gy.mean],onChange:Ft,defaultStat:Oe.gy.mean,filterOptions:jt=>jt.id===Oe.gy.mean||jt.id===Oe.gy.variance||jt.id===Oe.gy.stdDev})}),(0,N.jsx)(k.I,{label:"Type",labelWidth:dn,children:(0,N.jsx)(se.z,{value:Re?.windowAlignment??xn.ip.Trailing,options:$e,onChange:Ot})}),(0,N.jsx)(k.I,{label:"Window size mode",children:(0,N.jsx)(se.z,{value:Re?.windowSizeMode??xn.Bp.Percentage,options:ke,onChange:Ct})}),(0,N.jsx)(k.I,{label:Re?.windowSizeMode===xn.Bp.Percentage?"Window size %":"Window size",labelWidth:dn,tooltip:Re?.windowSizeMode===xn.Bp.Percentage?"Set the window size as a percentage of the total data":"Window size",children:(0,N.jsx)(Zt.Q,{placeholder:"Auto",min:.1,value:Re?.windowSize&&Re.windowSizeMode===xn.Bp.Percentage?Re.windowSize*100:Re?.windowSize,onChange:pt})})]})},On=[{value:xn.UY.BinaryOperation,label:"Binary operation"},{value:xn.UY.UnaryOperation,label:"Unary operation"},{value:xn.UY.ReduceRow,label:"Reduce row"},{value:xn.UY.Index,label:"Row index"}];z.$.featureToggles.addFieldFromCalculationStatFunctions&&On.push({value:xn.UY.CumulativeFunctions,label:"Cumulative functions"},{value:xn.UY.WindowFunctions,label:"Window functions"});const An=new Set([H.PU.time,H.PU.number,H.PU.string]),qn=_=>{const{options:Y,onChange:ie,input:ve}=_,Re=Y?.reduce?.include,[Le,$e]=(0,c.useState)({names:[],selected:[]});(0,c.useEffect)(()=>{const Rt={interpolate:Ws=>Ws},Mn=(0,wn.of)(ve).pipe(q.c.ensureColumnsTransformer.operator(null,Rt),Xe(),ke(),ct(Re||[])).subscribe(({selected:Ws,names:Fs})=>{$e({names:Fs,selected:Ws})});return()=>{Mn.unsubscribe()}},[ve,Re]);const ke=()=>{if(!z.$.featureToggles.transformationsVariableSupport)return Xn.D;const Rt=(0,xe.w)();return Mn=>Mn.pipe((0,mt.T)(Ws=>(Ws.push(...Rt.getVariables().map(Fs=>"$"+Fs.name)),Ws)))},Xe=()=>Rt=>Rt.pipe((0,mt.T)(Mn=>{const Ws=[],Fs={};for(const ta of Mn)for(const Rs of ta.fields){if(!An.has(Rs.type))continue;const ar=(0,ee.Ct)(Rs,ta,Mn);Fs[ar]||(Fs[ar]=!0,Ws.push(ar))}return Ws})),ct=Rt=>Mn=>Mn.pipe((0,mt.T)(Ws=>{if(!Rt.length)return{names:Ws,selected:[]};const Fs=[],ta=[];for(const Rs of Ws)Rt.includes(Rs)&&ta.push(Rs),Fs.push(Rs);return{names:Fs,selected:ta}})),pt=Rt=>{ie({...Y,replaceFields:Rt.currentTarget.checked})},Ct=Rt=>{const Mn=Rt.value??xn.UY.BinaryOperation;Mn===xn.UY.WindowFunctions&&(Y.window=Y.window??xn.Uj),ie({...Y,mode:Mn})},Ft=Rt=>{ie({...Y,alias:Rt.target.value})},Ot=Y.mode??xn.UY.BinaryOperation,jt=Ot===xn.UY.BinaryOperation&&Y.binary?.left.matcher?.id===X.Ct.byType;return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(k.I,{labelWidth:dn,label:"Mode",children:(0,N.jsx)(J.l6,{className:"width-18",options:On,value:On.find(Rt=>Rt.value===Ot),onChange:Ct})}),Ot===xn.UY.BinaryOperation&&(0,N.jsx)(Sn,{options:Y,names:Le.names,onChange:_.onChange}),Ot===xn.UY.UnaryOperation&&(0,N.jsx)(wt,{names:Le.names,options:Y,onChange:_.onChange}),Ot===xn.UY.ReduceRow&&(0,N.jsx)(yt,{names:Le.names,selected:Le.selected,options:Y,onChange:_.onChange}),Ot===xn.UY.CumulativeFunctions&&(0,N.jsx)(es,{names:Le.names,options:Y,onChange:_.onChange}),Ot===xn.UY.WindowFunctions&&(0,N.jsx)(pn,{names:Le.names,options:Y,onChange:_.onChange}),Ot===xn.UY.Index&&(0,N.jsx)(Pt,{options:Y,onChange:_.onChange}),(0,N.jsx)(k.I,{labelWidth:dn,label:"Alias",disabled:jt,children:(0,N.jsx)(fe.p,{className:"width-18",value:Y.alias??"",placeholder:(0,xn.sw)(Y),onChange:Ft})}),(0,N.jsx)(k.I,{labelWidth:dn,label:"Replace all fields",children:(0,N.jsx)(Ut.K,{value:!!Y.replaceFields,onChange:pt})})]})},cs={id:Z.F.calculateField,editor:qn,transformation:q.c.calculateFieldTransformer,name:q.c.calculateFieldTransformer.name,description:"Use the row values to calculate a new field.",categories:new Set([p.m.CalculateNewFields]),help:re(Z.F.calculateField).helperDocs};var Os=e(82150);const xs=[{value:Os.x1.FieldName,label:"Copy frame name to field name"},{value:Os.x1.Label,label:"Add a label with the frame name"},{value:Os.x1.Drop,label:"Ignore the frame name"}];class zs extends c.PureComponent{constructor(Y){super(Y),this.onModeChanged=ie=>{const{options:ve,onChange:Re}=this.props,Le=ie.value??Os.x1.FieldName;Re({...ve,frameNameMode:Le})},this.onLabelChanged=ie=>{const{options:ve}=this.props;this.props.onChange({...ve,frameNameLabel:ie.target.value})}}render(){const{options:Y}=this.props,ie=Y.frameNameMode??Os.x1.FieldName;return(0,N.jsxs)("div",{children:[(0,N.jsx)(k.I,{label:"Name",labelWidth:16,grow:!0,children:(0,N.jsx)(J.l6,{width:36,options:xs,value:xs.find(ve=>ve.value===ie),onChange:this.onModeChanged})}),ie===Os.x1.Label&&(0,N.jsx)(k.I,{label:"Label",labelWidth:16,grow:!0,children:(0,N.jsx)(fe.p,{width:36,value:Y.frameNameLabel??"",placeholder:"frame",onChange:this.onLabelChanged})})]})}}const Ks={id:Z.F.concatenate,editor:zs,transformation:q.c.concatenateTransformer,name:q.c.concatenateTransformer.name,description:"Combine all fields into a single frame.  Values will be appended with undefined values if not the same length.",categories:new Set([p.m.Combine]),help:re(Z.F.concatenate).helperDocs};var ma=e(91410),la=e(76218),Ua=e(9988),Ra=e(63577),Pa=e(91076),wa=e(14578),Ea=e(72093),Za=e(29158);const Na=({transformIndex:_,value:Y,index:ie,mappedIndex:ve,onChangeEnumValue:Re,onRemoveEnumRow:Le,checkIsEnumUniqueValue:$e})=>{const ke=(0,De.of)(gr),[Xe,ct]=(0,c.useState)(Y),[pt,Ct]=(0,c.useState)(Xe===""),[Ft,Ot]=(0,c.useState)(null),jt=(0,c.useRef)(null);(0,c.useEffect)(()=>{jt.current&&jt.current.focus()},[jt]);const Rt=Rs=>{Rs.currentTarget.value!==""&&$e(Rs.currentTarget.value)&&Rs.currentTarget.value!==Y?Ot("Enum value already exists"):Ot(null),ct(Rs.currentTarget.value)},Mn=()=>{if(Ct(!1),Ot(null),Xe===""||Ft!==null){Le(ve);return}Re(ve,Xe)},Ws=Rs=>{Rs.key==="Enter"&&(Rs.preventDefault(),Mn())},Fs=()=>{Ct(!0)},ta=()=>{Le(ve)};return(0,N.jsx)(Pa.sx,{draggableId:`${_}/${Y}`,index:ie,children:Rs=>(0,N.jsxs)("tr",{ref:Rs.innerRef,...Rs.draggableProps,children:[(0,N.jsx)("td",{children:(0,N.jsx)("div",{className:ke.dragHandle,...Rs.dragHandleProps,children:(0,N.jsx)(wa.I,{name:"draggabledots",size:"lg"})})}),pt?(0,N.jsxs)("td",{children:[(0,N.jsx)(fe.p,{ref:jt,type:"text",value:Xe,onChange:Rt,onBlur:Mn,onKeyDown:Ws}),Ft&&(0,N.jsx)(Ea.P,{children:Ft})]}):(0,N.jsx)("td",{onClick:Fs,className:ke.clickableTableCell,children:Y&&Y!==""?Y:"Click to edit"}),(0,N.jsx)("td",{className:ke.textAlignCenter,children:(0,N.jsx)(Ze.Gy,{spacing:"sm",children:(0,N.jsx)(Za.K,{name:"trash-alt",onClick:ta,"data-testid":"remove-enum-row","aria-label":"Delete enum row",tooltip:"Delete"})})})]},ie)},`${_}/${Y}`)},gr=_=>({dragHandle:(0,ft.css)({cursor:"grab"}),textAlignCenter:(0,ft.css)({textAlign:"center"}),clickableTableCell:(0,ft.css)({cursor:"pointer",width:"100px","&:hover":{color:_.colors.text.maxContrast}})}),cr=Na,Ha=({input:_,options:Y,transformIndex:ie,onChange:ve})=>{const Re=(0,De.of)($a),[Le,$e]=(0,c.useState)(Y.conversions[ie].enumConfig?.text??[]);(0,c.useEffect)(()=>{!Y.conversions[ie].enumConfig?.text?.length&&_.length&&ke()},[_]),(0,c.useEffect)(()=>{(()=>{const Rt=Le.map(Fs=>Fs),Mn=Y.conversions,Ws={text:Rt};Mn[ie]={...Mn[ie],enumConfig:Ws},ve({...Y,conversions:Mn})})()},[ie,Le]);const ke=()=>{const jt=_.flatMap(Mn=>Mn?.fields??[]).find(Mn=>Mn.name===Y.conversions[ie].targetField);if(!jt)return;const Rt=new Set(jt?.values);Le.length>0&&!(0,l.isEqual)(Le,Array.from(Rt))&&!window.confirm("This action will overwrite the existing configuration. Are you sure you want to continue?")||$e([...Rt])},Xe=(jt,Rt)=>{const Mn=[...Le];Mn.splice(jt,1,Rt),$e(Mn)},ct=jt=>{const Rt=[...Le];Rt.splice(jt,1),$e(Rt)},pt=()=>{$e(["",...Le])},Ct=(jt,Rt)=>{Le.includes(Rt)||Xe(jt,Rt)},Ft=jt=>Le.includes(jt),Ot=jt=>{if(!jt.destination)return;const Rt=Le.length-jt.source.index-1,Mn=Le.length-jt.destination.index-1,Ws=[...Le],Fs=Ws[Rt];Ws.splice(Rt,1),Ws.splice(Mn,0,Fs),$e(Ws)};return(0,N.jsxs)(oe.C,{children:[(0,N.jsxs)(Ze.Gy,{children:[(0,N.jsx)(ne.$n,{size:"sm",icon:"plus",onClick:()=>ke(),className:Re.button,children:"Generate enum values from data"}),(0,N.jsx)(ne.$n,{size:"sm",icon:"plus",onClick:()=>pt(),className:Re.button,children:"Add enum value"})]}),(0,N.jsx)(Ze.gW,{children:(0,N.jsx)("table",{className:Re.compactTable,children:(0,N.jsx)(Pa.JY,{onDragEnd:Ot,children:(0,N.jsx)(Pa.gL,{droppableId:"sortable-enum-config-mappings",direction:"vertical",children:jt=>(0,N.jsxs)("tbody",{ref:jt.innerRef,...jt.droppableProps,children:[[...Le].reverse().map((Rt,Mn)=>{const Ws=Le.length-Mn-1;return(0,N.jsx)(cr,{transformIndex:ie,value:Rt,index:Mn,mappedIndex:Ws,onChangeEnumValue:Ct,onRemoveEnumRow:ct,checkIsEnumUniqueValue:Ft},`${ie}/${Rt}`)}),jt.placeholder]})})})})})]})},$a=_=>({compactTable:(0,ft.css)({"tbody td":{padding:_.spacing(.5)},marginTop:_.spacing(1),marginBottom:_.spacing(2)}),button:(0,ft.css)({marginTop:_.spacing(1)})}),Xa={settings:{width:24,isClearable:!1}},_a=({input:_,options:Y,onChange:ie})=>{const ve=Ua.bx.filter(Ot=>Ot.value!==H.PU.trace),Re=(0,Se.qt)(!0),Le=(0,ma.P3)();Re.push({label:"Browser",value:"browser"}),Re.push({label:"UTC",value:"utc"});for(const Ot of Le)Re.push({label:Ot,value:Ot});const $e=(0,c.useCallback)(Ot=>jt=>{const Rt=Y.conversions;Rt[Ot]={...Rt[Ot],targetField:jt??"",dateFormat:void 0},ie({...Y,conversions:Rt})},[ie,Y]),ke=(0,c.useCallback)(Ot=>jt=>{const Rt=Y.conversions;Rt[Ot]={...Rt[Ot],destinationType:jt.value},ie({...Y,conversions:Rt})},[ie,Y]),Xe=(0,c.useCallback)(Ot=>jt=>{const Rt=Y.conversions;Rt[Ot]={...Rt[Ot],dateFormat:jt.currentTarget.value},ie({...Y,conversions:Rt})},[ie,Y]),ct=(0,c.useCallback)(Ot=>jt=>{const Rt=Y.conversions;Rt[Ot]={...Rt[Ot],joinWith:jt.currentTarget.value},ie({...Y,conversions:Rt})},[ie,Y]),pt=(0,c.useCallback)(()=>{ie({...Y,conversions:[...Y.conversions,{targetField:void 0,destinationType:void 0,dateFormat:void 0}]})},[ie,Y]),Ct=(0,c.useCallback)(Ot=>{const jt=Y.conversions;jt.splice(Ot,1),ie({...Y,conversions:jt})},[ie,Y]),Ft=(0,c.useCallback)(Ot=>jt=>{const Rt=Y.conversions;Rt[Ot]={...Rt[Ot],timezone:jt?.value},ie({...Y,conversions:Rt})},[ie,Y]);return(0,N.jsxs)(N.Fragment,{children:[Y.conversions.map((Ot,jt)=>{const Rt=(0,Ra.findField)(_?.[0],Ot.targetField);return(0,N.jsxs)("div",{children:[(0,N.jsxs)(oe.C,{children:[(0,N.jsx)(k.I,{label:"Field",children:(0,N.jsx)(la.O,{context:{data:_},value:Ot.targetField??"",onChange:$e(jt),item:Xa})}),(0,N.jsx)(k.I,{label:"as",children:(0,N.jsx)(J.l6,{options:ve,value:Ot.destinationType,placeholder:"Type",onChange:ke(jt),width:18})}),Ot.destinationType===H.PU.time&&(0,N.jsx)(k.I,{label:"Input format",tooltip:"Specify the format of the input field so Grafana can parse the date string correctly.",children:(0,N.jsx)(fe.p,{value:Ot.dateFormat,placeholder:"e.g. YYYY-MM-DD",onChange:Xe(jt),width:24})}),Ot.destinationType===H.PU.string&&(0,N.jsxs)(N.Fragment,{children:[(Ot.joinWith?.length||Rt?.type===H.PU.other)&&(0,N.jsx)(k.I,{label:"Join with",tooltip:"Use an explicit separator when joining array values",children:(0,N.jsx)(fe.p,{value:Ot.joinWith,placeholder:"JSON",onChange:ct(jt),width:9})}),Rt?.type===H.PU.time&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(k.I,{label:"Date format",tooltip:"Specify the output format.",children:(0,N.jsx)(fe.p,{value:Ot.dateFormat,placeholder:"e.g. YYYY-MM-DD",onChange:Xe(jt),width:24})}),(0,N.jsx)(k.I,{label:"Set timezone",tooltip:"Set the timezone of the date manually",children:(0,N.jsx)(J.l6,{options:Re,value:Ot.timezone,onChange:Ft(jt),isClearable:!0})})]})]}),(0,N.jsx)(ne.$n,{size:"md",icon:"trash-alt",variant:"secondary",onClick:()=>Ct(jt),"aria-label":"Remove convert field type transformer"})]}),Ot.destinationType===H.PU.enum&&(0,N.jsx)(Ha,{input:_,options:Y,transformIndex:jt,onChange:ie})]},`${Ot.targetField}-${jt}`)}),(0,N.jsx)(ne.$n,{size:"sm",icon:"plus",onClick:pt,variant:"secondary","aria-label":"Add a convert field type transformer",children:"Convert field type"})]})},vt={id:Z.F.convertFieldType,editor:_a,transformation:q.c.convertFieldTypeTransformer,name:q.c.convertFieldTypeTransformer.name,description:q.c.convertFieldTypeTransformer.description,categories:new Set([p.m.Reformat]),help:re(Z.F.convertFieldType).helperDocs};var kt=e(54479);class cn extends c.PureComponent{constructor(Y){super(Y),this.onFieldToggle=ie=>{const{selected:ve}=this.state;ve.indexOf(ie)>-1?this.onChange(ve.filter(Re=>Re!==ie)):this.onChange([...ve,ie])},this.onChange=ie=>{const{regex:ve,isRegexValid:Re}=this.state,Le={...this.props.options,include:{names:ie}};ve&&Re&&(Le.include=Le.include??{},Le.include.pattern=ve),this.setState({selected:ie},()=>{this.props.onChange(Le)})},this.onInputBlur=ie=>{const{selected:ve,regex:Re}=this.state;let Le=!0;try{Re&&(0,kt.dO)(Re)}catch{Le=!1}Le?this.props.onChange({...this.props.options,include:{pattern:Re}}):this.props.onChange({...this.props.options,include:{names:ve}}),this.setState({isRegexValid:Le})},this.onVariableChange=ie=>{this.props.onChange({...this.props.options,include:{variable:ie.value}}),this.setState({variable:ie.value})},this.onFromVariableChange=ie=>{const ve=ie.currentTarget.checked;this.props.onChange({...this.props.options,byVariable:ve}),this.setState({byVariable:ve})},this.state={include:Y.options.include?.names||[],regex:Y.options.include?.pattern,variable:Y.options.include?.variable,byVariable:Y.options.byVariable||!1,options:[],variables:[],selected:[],isRegexValid:!0}}componentDidMount(){this.initOptions()}componentDidUpdate(Y){this.props.input!==Y.input&&this.initOptions()}initOptions(){const{input:Y,options:ie}=this.props,ve=Array.from(ie.include?.names??[]),Re=(0,xe.w)().getVariables().map(ke=>({label:"$"+ke.name,value:"$"+ke.name})),Le=[],$e={};for(const ke of Y)for(const Xe of ke.fields){const ct=(0,ee.Ct)(Xe,ke,Y);let pt=$e[ct];pt||(pt=$e[ct]={name:ct,count:0},Le.push(pt)),pt.count++}if(ie.include?.pattern)try{const ke=(0,kt.dO)(ie.include.pattern);for(const Xe of Le)ke.test(Xe.name)&&ve.push(Xe.name)}catch(ke){console.error(ke)}if(ve.length){const ke=Le.filter(Xe=>ve.includes(Xe.name));this.setState({options:Le,selected:ke.map(Xe=>Xe.name),variables:Re,byVariable:ie.byVariable||!1,variable:ie.include?.variable,regex:ie.include?.pattern})}else this.setState({options:Le,selected:Le.map(ke=>ke.name),variables:Re,byVariable:ie.byVariable||!1,variable:ie.include?.variable,regex:ie.include?.pattern})}render(){const{options:Y,selected:ie,isRegexValid:ve}=this.state;return(0,N.jsxs)("div",{children:[(0,N.jsx)(oe.C,{label:"Use variable",children:(0,N.jsx)(k.I,{label:"From variable",children:(0,N.jsx)(Ut.K,{value:this.state.byVariable,onChange:this.onFromVariableChange})})}),this.state.byVariable?(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{label:"Variable",children:(0,N.jsx)(J.l6,{value:this.state.variable,onChange:this.onVariableChange,options:this.state.variables||[]})})}):(0,N.jsxs)(oe.C,{label:"Identifier",children:[(0,N.jsx)(k.I,{label:"Identifier",invalid:!ve,error:ve?void 0:"Invalid pattern",children:(0,N.jsx)(fe.p,{placeholder:"Regular expression pattern",value:this.state.regex||"",onChange:Re=>this.setState({regex:Re.currentTarget.value}),onBlur:this.onInputBlur,width:25})}),Y.map((Re,Le)=>{const $e=`${Re.name}${Re.count>1?" ("+Re.count+")":""}`,ke=ie.indexOf(Re.name)>-1;return(0,N.jsx)(lt.m,{onClick:()=>{this.onFieldToggle(Re.name)},label:$e,selected:ke},`${Re.name}/${Le}`)})]})]})}}const vn={id:Z.F.filterFieldsByName,editor:cn,transformation:q.c.filterFieldsByNameTransformer,name:q.c.filterFieldsByNameTransformer.name,description:"Removes part of the query results using a regex pattern. The pattern can be inclusive or exclusive.",categories:new Set([p.m.Filter]),help:re(Z.F.filterFieldsByName).helperDocs};class Pn extends c.PureComponent{constructor(Y){super(Y),this.onFieldToggle=ie=>{const{selected:ve}=this.state;ve.indexOf(ie)>-1?this.onChange(ve.filter(Re=>Re!==ie)):this.onChange([...ve,ie])},this.onChange=ie=>{this.setState({selected:ie}),this.props.onChange({...this.props.options,include:ie.join("|")})},this.state={include:Y.options.include||"",options:[],selected:[]}}componentDidMount(){this.initOptions()}componentDidUpdate(Y){this.props.input!==Y.input&&this.initOptions()}initOptions(){const{input:Y,options:ie}=this.props,ve=ie.include?ie.include.split("|"):[],Re=[],Le={};for(const $e of Y)if($e.refId){let ke=Le[$e.refId];ke||(ke=Le[$e.refId]={refId:$e.refId,count:0},Re.push(ke)),ke.count++}if(ve.length){const $e=[],ke=[];for(const Xe of Re)ve.includes(Xe.refId)&&ke.push(Xe),$e.push(Xe);this.setState({options:$e,selected:ke.map(Xe=>Xe.refId)})}else this.setState({options:Re,selected:[]})}render(){const{options:Y,selected:ie}=this.state,{input:ve}=this.props;return(0,N.jsxs)(N.Fragment,{children:[ve.length<=1&&(0,N.jsx)("div",{children:(0,N.jsx)(Ea.P,{children:"Filter data by query expects multiple queries in the input."})}),(0,N.jsx)(k.I,{label:"Series refId",labelWidth:16,shrink:!0,children:(0,N.jsx)(Ze.Gy,{spacing:"xs",align:"flex-start",wrap:!0,children:Y.map((Re,Le)=>{const $e=`${Re.refId}${Re.count>1?" ("+Re.count+")":""}`,ke=ie.indexOf(Re.refId)>-1;return(0,N.jsx)(lt.m,{onClick:()=>{this.onFieldToggle(Re.refId)},label:$e,selected:ke},`${Re.refId}/${Le}`)})})})]})}}const Kn={id:Z.F.filterByRefId,editor:Pn,transformation:q.c.filterFramesByRefIdTransformer,name:q.c.filterFramesByRefIdTransformer.name,description:"Filter data by query. This is useful if you are sharing the results from a different panel that has many queries and you want to only visualize a subset of that in this panel.",categories:new Set([p.m.Filter]),help:re(Z.F.filterByRefId).helperDocs};var us=e(15400);const Gn={settings:{width:30,filter:_=>_.type===H.PU.string,placeholderText:"Select text field",noFieldsMessage:"No text fields found"},name:"",id:"",editor:()=>null};function ps({input:_,options:Y,onChange:ie}){const ve=(0,c.useCallback)(Xe=>{ie({...Y,stringField:Xe??""})},[ie,Y]),Re=(0,c.useCallback)(Xe=>{const ct=Xe.value??us.gs.UpperCase;ie({...Y,outputFormat:ct})},[ie,Y]),Le=(0,c.useCallback)(Xe=>{ie({...Y,substringStart:Xe??0})},[ie,Y]),$e=(0,c.useCallback)(Xe=>{ie({...Y,substringEnd:Xe??0})},[ie,Y]),ke=Object.values(us.gs).map(Xe=>({label:Xe,value:Xe}));return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(oe.C,{children:[(0,N.jsx)(k.I,{label:"Field",labelWidth:10,children:(0,N.jsx)(la.O,{context:{data:_},value:Y.stringField??"",onChange:ve,item:Gn})}),(0,N.jsx)(k.I,{label:"Format",labelWidth:10,children:(0,N.jsx)(J.l6,{options:ke,value:Y.outputFormat,onChange:Re,width:20})})]}),Y.outputFormat===us.gs.Substring&&(0,N.jsxs)(oe.C,{children:[(0,N.jsx)(k.I,{label:"Substring range",labelWidth:15,children:(0,N.jsx)(Zt.Q,{min:0,value:Y.substringStart??0,onChange:Le,width:7})}),(0,N.jsx)(k.I,{children:(0,N.jsx)(Zt.Q,{min:0,value:Y.substringEnd??0,onChange:$e,width:7})})]})]})}const Dt={id:Z.F.formatString,editor:ps,transformation:q.c.formatStringTransformer,name:q.c.formatStringTransformer.name,state:he.pn.beta,description:q.c.formatStringTransformer.description,categories:new Set([p.m.Reformat])};function un({input:_,options:Y,onChange:ie}){const ve=[],Re=(0,Se.qt)(!0);for(const Xe of _)for(const ct of Xe.fields)if(ct.type==="time"){const pt=(0,ee.Ct)(ct,Xe,_);ve.push({label:pt,value:pt})}const Le=(0,c.useCallback)(Xe=>{const ct=Xe?.value!==void 0?Xe.value:"";ie({...Y,timeField:ct})},[ie,Y]),$e=(0,c.useCallback)(Xe=>{const ct=Xe.target.value;ie({...Y,outputFormat:ct})},[ie,Y]),ke=(0,c.useCallback)(Xe=>{const ct=Xe?.value!==void 0?Xe.value:"";ie({...Y,timezone:ct})},[ie,Y]);return(0,N.jsx)(N.Fragment,{children:(0,N.jsxs)(oe.C,{children:[(0,N.jsx)(k.I,{label:"Time Field",labelWidth:15,grow:!0,children:(0,N.jsx)(J.l6,{options:ve,value:Y.timeField,onChange:Le,placeholder:"time",isClearable:!0})}),(0,N.jsx)(k.I,{label:"Format",labelWidth:10,tooltip:(0,N.jsxs)(N.Fragment,{children:["The output format for the field specified as a"," ",(0,N.jsx)("a",{href:"https://momentjs.com/docs/#/displaying/",target:"_blank",rel:"noopener noreferrer",children:"Moment.js format string"}),"."]}),interactive:!0,children:(0,N.jsx)(fe.p,{onChange:$e,value:Y.outputFormat})}),(0,N.jsx)(k.I,{label:"Set Timezone",tooltip:"Set the timezone of the date manually",labelWidth:20,children:(0,N.jsx)(J.l6,{options:Re,value:Y.timezone,onChange:ke,isClearable:!0})})]})})}const Bn={id:Z.F.formatTime,editor:un,transformation:q.c.formatTimeTransformer,name:q.c.formatTimeTransformer.name,state:he.pn.alpha,description:q.c.formatTimeTransformer.description,help:re(Z.F.formatTime).helperDocs};var Jn=e(25094),In=e(67061),ms=e(42418);const Es=({input:_,options:Y,onChange:ie})=>{const ve=(0,Se.ZI)(_),Re=(0,c.useCallback)(Xe=>ct=>{ie({...Y,fields:{...Y.fields,[Xe]:ct}})},[ie]);let Le,$e=!1;for(const Xe of Object.values(Y.fields))Xe.aggregations.length>0&&Xe.operation!==null&&($e=!0),Xe.operation===Jn.R3.groupBy&&(Le=!0);const ke=$e&&!Le;return(0,N.jsxs)(In.B,{direction:"column",children:[ke&&(0,N.jsx)(ms.F,{title:"Calculations will not have an effect if no fields are being grouped on.",severity:"warning"}),ve.map(Xe=>(0,N.jsx)(hs,{onConfigChange:Re(Xe),fieldName:Xe,config:Y.fields[Xe]},Xe))]})},Cs=[{label:"Group by",value:Jn.R3.groupBy},{label:"Calculate",value:Jn.R3.aggregate}],hs=({fieldName:_,config:Y,onConfigChange:ie})=>{const ve=(0,De.$j)(),Re=fa(ve),Le=(0,c.useCallback)($e=>{ie({aggregations:Y?.aggregations??[],operation:$e?.value??null})},[Y,ie]);return(0,N.jsx)(k.I,{className:Re.label,label:_,grow:!0,shrink:!0,children:(0,N.jsxs)(In.B,{gap:.5,direction:"row",children:[(0,N.jsx)("div",{className:Re.operation,children:(0,N.jsx)(J.l6,{options:Cs,value:Y?.operation,placeholder:"Ignored",onChange:Le,isClearable:!0})}),Y?.operation===Jn.R3.aggregate&&(0,N.jsx)(Ye.S,{className:Re.aggregations,placeholder:"Select Stats",allowMultiple:!0,stats:Y.aggregations,onChange:$e=>{ie({...Y,aggregations:$e})}})]})})},fa=_=>({label:(0,ft.css)`
      label {
        min-width: ${_.spacing(32)};
      }
    `,operation:(0,ft.css)`
      flex-shrink: 0;
      height: 100%;
      width: ${_.spacing(24)};
    `,aggregations:(0,ft.css)`
      flex-grow: 1;
    `}),oa={id:Z.F.groupBy,editor:Es,transformation:q.c.groupByTransformer,name:q.c.groupByTransformer.name,description:q.c.groupByTransformer.description,categories:new Set([p.m.Combine,p.m.CalculateNewFields,p.m.Reformat]),help:re(Z.F.groupBy).helperDocs};var na=e(68133),Bt=e(88575);const Wt=({input:_,options:Y,onChange:ie})=>{const ve=(0,Se.ZI)(_),Re=Y.showSubframeHeaders===void 0?na.l:Y.showSubframeHeaders,Le=(0,c.useCallback)(pt=>Ct=>{ie({...Y,fields:{...Y.fields,[pt]:Ct}})},[ie]),$e=(0,c.useCallback)(()=>{const pt=Y.showSubframeHeaders===void 0?!na.l:!Y.showSubframeHeaders;ie({showSubframeHeaders:pt,fields:{...Y.fields}})},[ie]);let ke,Xe=!1;for(const pt of Object.values(Y.fields))pt.aggregations.length>0&&pt.operation!==null&&(Xe=!0),pt.operation===Jn.R3.groupBy&&(ke=!0);const ct=Xe&&!ke;return(0,N.jsxs)(In.B,{direction:"column",children:[ct&&(0,N.jsx)(ms.F,{title:"Calculations will not have an effect if no fields are being grouped on.",severity:"warning"}),(0,N.jsx)("div",{children:ve.map(pt=>(0,N.jsx)(sn,{onConfigChange:Le(pt),fieldName:pt,config:Y.fields[pt]},pt))}),(0,N.jsx)(Bt.D,{label:"Show field names in nested tables",description:"If enabled nested tables will show field names as a table header",children:(0,N.jsx)(Ut.d,{value:Re,onChange:$e})})]})},_t=[{label:"Group by",value:Jn.R3.groupBy},{label:"Calculate",value:Jn.R3.aggregate}],sn=({fieldName:_,config:Y,onConfigChange:ie})=>{const ve=(0,De.$j)(),Re=Cn(ve),Le=(0,c.useCallback)($e=>{ie({aggregations:Y?.aggregations??[],operation:$e?.value??null})},[Y,ie]);return(0,N.jsx)(k.I,{className:Re.label,label:_,grow:!0,shrink:!0,children:(0,N.jsxs)(In.B,{gap:.5,direction:"row",wrap:!1,children:[(0,N.jsx)("div",{className:Re.operation,children:(0,N.jsx)(J.l6,{options:_t,value:Y?.operation,placeholder:"Ignored",onChange:Le,isClearable:!0})}),Y?.operation===Jn.R3.aggregate&&(0,N.jsx)(Ye.S,{className:Re.aggregations,placeholder:"Select Stats",allowMultiple:!0,stats:Y.aggregations,onChange:$e=>{ie({...Y,aggregations:$e})}})]})})},Cn=_=>({label:(0,ft.css)({minWidth:_.spacing(32)}),operation:(0,ft.css)({flexShrink:0,height:"100%",width:_.spacing(24)}),aggregations:(0,ft.css)({flexGrow:1})}),Fn={id:Z.F.groupToNestedTable,editor:Wt,transformation:q.c.groupToNestedTable,name:q.c.groupToNestedTable.name,description:q.c.groupToNestedTable.description,categories:new Set([p.m.Combine,p.m.CalculateNewFields,p.m.Reformat]),state:he.pn.beta};var $n=e(81010);const ts=({input:_,options:Y,onChange:ie})=>{const ve=(0,Se.ZI)(_).map(pt=>({label:pt,value:pt})),Re=(0,xe.w)().getVariables().map(pt=>({value:"$"+pt.name,label:"$"+pt.name})),Le=(0,c.useCallback)(pt=>{ie({...Y,columnField:pt?.value})},[ie,Y]),$e=(0,c.useCallback)(pt=>{ie({...Y,rowField:pt?.value})},[ie,Y]),ke=(0,c.useCallback)(pt=>{ie({...Y,valueField:pt?.value})},[ie,Y]),Xe=[{label:"Null",value:$n.N.Null,description:"Null value"},{label:"True",value:$n.N.True,description:"Boolean true value"},{label:"False",value:$n.N.False,description:"Boolean false value"},{label:"Empty",value:$n.N.Empty,description:"Empty string"}],ct=(0,c.useCallback)(pt=>{ie({...Y,emptyValue:pt?.value})},[ie,Y]);return(0,N.jsx)(N.Fragment,{children:(0,N.jsxs)(oe.C,{children:[(0,N.jsx)(k.I,{label:"Column",labelWidth:8,children:(0,N.jsx)(J.l6,{options:[...ve,...Re],value:Y.columnField,onChange:Le,isClearable:!0})}),(0,N.jsx)(k.I,{label:"Row",labelWidth:8,children:(0,N.jsx)(J.l6,{options:[...ve,...Re],value:Y.rowField,onChange:$e,isClearable:!0})}),(0,N.jsx)(k.I,{label:"Cell Value",labelWidth:10,children:(0,N.jsx)(J.l6,{options:[...ve,...Re],value:Y.valueField,onChange:ke,isClearable:!0})}),(0,N.jsx)(k.I,{label:"Empty Value",children:(0,N.jsx)(J.l6,{options:Xe,value:Y.emptyValue,onChange:ct,isClearable:!0})})]})})},Vn={id:Z.F.groupingToMatrix,editor:ts,transformation:q.c.groupingToMatrixTransformer,name:q.c.groupingToMatrixTransformer.name,description:"Takes a three fields combination and produces a Matrix.",categories:new Set([p.m.Combine,p.m.Reformat]),help:re(Z.F.groupingToMatrix).helperDocs};var Un=e(77678);const ys=({input:_,options:Y,onChange:ie})=>{const[Re,Le]=(0,c.useState)({bucketCount:!(0,Se.N_)(Y.bucketCount||""),bucketSize:!(0,Se.N_)(Y.bucketSize||""),bucketOffset:!(0,Se.N_)(Y.bucketOffset||"")}),$e=(0,c.useCallback)(Rt=>{ie({...Y,bucketCount:Rt})},[ie,Y]),ke=(0,c.useCallback)(Rt=>{ie({...Y,bucketSize:Rt})},[ie,Y]),Xe=(0,c.useCallback)(Rt=>{ie({...Y,bucketOffset:Rt})},[ie,Y]),ct=(0,c.useCallback)(Rt=>{Le({...Re,bucketCount:!(0,Se.N_)(Rt)}),ie({...Y,bucketCount:Number(Rt)===0?void 0:Number(Rt)})},[ie,Y,Re]),pt=(0,c.useCallback)(Rt=>{Le({...Re,bucketSize:!(0,Se.N_)(Rt)}),ie({...Y,bucketSize:Rt})},[ie,Y,Re,Le]),Ct=(0,c.useCallback)(Rt=>{Le({...Re,bucketOffset:!(0,Se.N_)(Rt)}),ie({...Y,bucketOffset:Rt})},[ie,Y,Re,Le]),Ft=(0,c.useCallback)(()=>{ie({...Y,combine:!Y.combine})},[ie,Y]),jt=(0,xe.w)().getVariables().map(Rt=>({value:Rt.name,label:Rt.label||Rt.name,origin:pe.$0.Template}));if(!z.$.featureToggles.transformationsVariableSupport){let Rt;typeof Y.bucketSize=="string"?Rt=parseInt(Y.bucketSize,10):Rt=Y.bucketSize;let Mn;return typeof Y.bucketOffset=="string"?Mn=parseInt(Y.bucketOffset,10):Mn=Y.bucketOffset,(0,N.jsxs)("div",{children:[(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{labelWidth:18,label:Un.Rt.bucketCount.name,tooltip:Un.Rt.bucketCount.description,children:(0,N.jsx)(Zt.Q,{value:Y.bucketCount,placeholder:"Default: 30",onChange:$e,min:0})})}),(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{labelWidth:18,label:Un.Rt.bucketSize.name,tooltip:Un.Rt.bucketSize.description,children:(0,N.jsx)(Zt.Q,{value:Rt,placeholder:"auto",onChange:ke,min:0})})}),(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{labelWidth:18,label:Un.Rt.bucketOffset.name,tooltip:Un.Rt.bucketOffset.description,children:(0,N.jsx)(Zt.Q,{value:Mn,placeholder:"none",onChange:Xe,min:0})})}),(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{labelWidth:18,label:Un.Rt.combine.name,tooltip:Un.Rt.combine.description,children:(0,N.jsx)(Ut.K,{value:Y.combine??!1,onChange:Ft})})})]})}return(0,N.jsxs)("div",{children:[(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{invalid:Re.bucketCount,error:"Value needs to be an integer or a variable",labelWidth:18,label:Un.Rt.bucketCount.name,tooltip:Un.Rt.bucketCount.description,children:(0,N.jsx)(Ee.y,{suggestions:jt,value:Y.bucketCount,placeholder:"Default: 30",onChange:ct})})}),(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{invalid:Re.bucketSize,error:"Value needs to be an integer or a variable",labelWidth:18,label:Un.Rt.bucketSize.name,tooltip:Un.Rt.bucketSize.description,children:(0,N.jsx)(Ee.y,{suggestions:jt,value:Y.bucketSize,placeholder:"auto",onChange:pt})})}),(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{labelWidth:18,label:Un.Rt.bucketOffset.name,tooltip:Un.Rt.bucketOffset.description,invalid:Re.bucketOffset,error:"Value needs to be an integer or a variable",children:(0,N.jsx)(Ee.y,{suggestions:jt,value:Y.bucketOffset,placeholder:"none",onChange:Ct})})}),(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{labelWidth:18,label:Un.Rt.combine.name,tooltip:Un.Rt.combine.description,children:(0,N.jsx)(Ut.K,{value:Y.combine??!1,onChange:Ft})})})]})},ws={id:Z.F.histogram,editor:ys,transformation:q.c.histogramTransformer,name:q.c.histogramTransformer.name,description:q.c.histogramTransformer.description,categories:new Set([p.m.CreateNewVisualization]),help:re(Z.F.histogram).helperDocs};var As=e(41511),$s=e(64278);const Hs=[{value:As.W.outer,label:"OUTER (TIME SERIES)",description:"Keep all rows from any table with a value. Join on distinct field values. Performant and best used for time series."},{value:As.W.outerTabular,label:"OUTER (TABULAR)",description:"Join on a field value with duplicated values. Non performant outer join best used for tabular(SQL like) data."},{value:As.W.inner,label:"INNER",description:"Combine data from two tables whenever there are matching values in a fields common to both tables."}];function va({input:_,options:Y,onChange:ie}){const ve=(0,$s.sE)(_),Re=(0,$s.m3)(ve),Le=(0,xe.w)().getVariables().map(Xe=>({value:"$"+Xe.name,label:"$"+Xe.name})),$e=(0,c.useCallback)(Xe=>{ie({...Y,byField:Xe?.value})},[ie,Y]),ke=(0,c.useCallback)(Xe=>{ie({...Y,mode:Xe?.value})},[ie,Y]);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{label:"Mode",labelWidth:8,grow:!0,children:(0,N.jsx)(J.l6,{options:Hs,value:Y.mode??As.W.outer,onChange:ke})})}),(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{label:"Field",labelWidth:8,grow:!0,children:(0,N.jsx)(J.l6,{options:[...Re,...Le],value:Y.byField,onChange:$e,placeholder:"time",isClearable:!0})})})]})}const Qs={id:Z.F.joinByField,aliasIds:[Z.F.seriesToColumns],editor:va,transformation:q.c.joinByFieldTransformer,name:q.c.joinByFieldTransformer.name,description:q.c.joinByFieldTransformer.description,categories:new Set([p.m.Combine]),help:re(Z.F.joinByField).helperDocs};var Ps=e(6829);const Vs=[{value:Ps.n.Columns,label:"Columns"},{value:Ps.n.Rows,label:"Rows"}],Js=({input:_,options:Y,onChange:ie})=>{const{labelNames:Re,selected:Le}=(0,c.useMemo)(()=>{let Xe=[],ct={};for(const Ct of _)for(const Ft of Ct.fields)if(Ft.labels)for(const Ot of Object.keys(Ft.labels))ct[Ot]||(Xe.push({value:Ot,label:Ot}),ct[Ot]=!0);const pt=new Set(Y.keepLabels?.length?Y.keepLabels:Object.keys(ct));return{labelNames:Xe,selected:pt}},[Y.keepLabels,_]),$e=Xe=>{ie({...Y,valueLabel:Xe?.value})},ke=Xe=>{if(Le.has(Xe)?Le.delete(Xe):Le.add(Xe),Le.size===Re.length||!Le.size){const{keepLabels:ct,...pt}=Y;ie(pt)}else ie({...Y,keepLabels:[...Le]})};return(0,N.jsxs)("div",{children:[(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{label:"Mode",labelWidth:20,children:(0,N.jsx)(se.z,{options:Vs,value:Y.mode??Ps.n.Columns,onChange:Xe=>ie({...Y,mode:Xe})})})}),(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{label:"Labels",labelWidth:20,children:(0,N.jsx)(In.B,{gap:1,wrap:"wrap",children:Re.map((Xe,ct)=>{const pt=Xe.label;return(0,N.jsx)(lt.m,{onClick:()=>ke(pt),label:pt,selected:Le.has(pt)},`${pt}/${ct}`)})})})}),Y.mode!==Ps.n.Rows&&(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{label:"Value field name",labelWidth:20,tooltip:"Replace the value field name with a label",htmlFor:"labels-to-fields-as-name",children:(0,N.jsx)(J.l6,{inputId:"labels-to-fields-as-name",isClearable:!0,allowCustomValue:!1,placeholder:"(Optional) Select label",options:Re,value:Y?.valueLabel,onChange:$e,className:"min-width-16"})})})]})},Ca={id:Z.F.labelsToFields,editor:Js,transformation:q.c.labelsToFieldsTransformer,name:q.c.labelsToFieldsTransformer.name,description:`Groups series by time and return labels or tags as fields.
                Useful for showing time series with labels in a table where each label key becomes a separate column.`,categories:new Set([p.m.Reformat]),help:re(Z.F.labelsToFields).helperDocs},Fa=({options:_,onChange:Y})=>{const[ie,ve]=(0,c.useState)(!1),Re=(0,c.useCallback)(Xe=>{Y({..._,limitField:Number(Xe.currentTarget.value)})},[Y,_]),Le=(0,c.useCallback)(Xe=>{ve(!(0,Se.N_)(Xe)),Y({..._,limitField:Xe})},[Y,_]),ke=(0,xe.w)().getVariables().map(Xe=>({value:Xe.name,label:Xe.label||Xe.name,origin:pe.$0.Template}));return z.$.featureToggles.transformationsVariableSupport?(0,N.jsx)(N.Fragment,{children:(0,N.jsx)(oe.C,{children:(0,N.jsx)(Ee.y,{invalid:ie,error:"Value needs to be an integer or a variable",value:String(_.limitField),onChange:Le,placeholder:"Value or variable",suggestions:ke})})}):(0,N.jsx)(N.Fragment,{children:(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{label:"Limit",labelWidth:8,children:(0,N.jsx)(fe.p,{placeholder:"Limit count",pattern:"[0-9]*",value:_.limitField,onChange:Re,width:25})})})})},nr={id:Z.F.limit,editor:Fa,transformation:q.c.limitTransformer,name:q.c.limitTransformer.name,description:"Limit the number of items displayed.",categories:new Set([p.m.Filter]),help:re(Z.F.limit).helperDocs},ca=({input:_,options:Y,onChange:ie})=>_.length<=1?(0,N.jsx)(Ea.P,{children:"Merge has no effect when applied on a single frame."}):null,st={id:Z.F.merge,editor:ca,transformation:q.c.mergeTransformer,name:q.c.mergeTransformer.name,description:`Merge many series/tables and return a single table where mergeable values will be combined into the same row.
                Useful for showing multiple series, tables or a combination of both visualized in a table.`,categories:new Set([p.m.Combine]),help:re(Z.F.merge).helperDocs};var bt=e(82280),Mt=e(94753);const qt=({options:_,input:Y,onChange:ie})=>{const{indexByName:ve,excludeByName:Re,renameByName:Le,includeByName:$e}=_,ke=(0,Se.ZI)(Y),Xe=(0,c.useMemo)(()=>jn(ke,ve),[ke,ve]),ct=$e&&Object.keys($e).length>0?"include":"exclude",pt=(0,c.useCallback)((jt,Rt)=>{ie({..._,excludeByName:{...Re,[jt]:Rt}})},[ie,_,Re]),Ct=(0,c.useCallback)((jt,Rt)=>{const Mn={..._,includeByName:{...$e,[jt]:!Rt}};ie(Mn)},[ie,_,$e]),Ft=(0,c.useCallback)(jt=>{if(!jt||!jt.destination)return;const Rt=jt.source.index,Mn=jt.destination.index;Rt!==Mn&&ie({..._,indexByName:Rn(ke,Rt,Mn)})},[ie,_,ke]),Ot=(0,c.useCallback)((jt,Rt)=>{ie({..._,renameByName:{..._.renameByName,[jt]:Rt}})},[ie,_]);return Y.length>1?(0,N.jsx)(Ea.P,{children:"Organize fields only works with a single frame. Consider applying a join transformation or filtering the input first."}):(0,N.jsx)(Pa.JY,{onDragEnd:Ft,children:(0,N.jsx)(Pa.gL,{droppableId:"sortable-fields-transformer",direction:"vertical",children:jt=>(0,N.jsxs)("div",{ref:jt.innerRef,...jt.droppableProps,children:[Xe.map((Rt,Mn)=>{const Ws=$e&&Rt in $e?$e[Rt]:!1,Fs=ct==="include"?Ws:!Re[Rt],ta=ct==="include"?Ct:pt;return(0,N.jsx)(rn,{fieldName:Rt,renamedFieldName:Le[Rt],index:Mn,onToggleVisibility:ta,onRenameField:Ot,visible:Fs},Rt)}),jt.placeholder]})})})};qt.displayName="OrganizeFieldsTransformerEditor";const rn=({fieldName:_,renamedFieldName:Y,index:ie,visible:ve,onToggleVisibility:Re,onRenameField:Le})=>{const $e=(0,De.of)(tn);return(0,N.jsx)(Pa.sx,{draggableId:_,index:ie,children:ke=>(0,N.jsxs)(te.a,{marginBottom:.5,display:"flex",gap:0,ref:ke.innerRef,...ke.draggableProps,children:[(0,N.jsx)(we.c,{width:60,as:"div",children:(0,N.jsxs)(In.B,{gap:0,justifyContent:"flex-start",alignItems:"center",width:"100%",children:[(0,N.jsx)("span",{...ke.dragHandleProps,children:(0,N.jsx)(wa.I,{name:"draggabledots",title:"Drag and drop to reorder",size:"lg",className:$e.draggable})}),(0,N.jsx)(Za.K,{className:$e.toggle,size:"md",name:ve?"eye":"eye-slash",onClick:()=>Re(_,ve),tooltip:ve?"Disable":"Enable"}),(0,N.jsx)(Mt.E,{truncate:!0,element:"p",variant:"bodySmall",weight:"bold",children:_})]})}),(0,N.jsx)(fe.p,{defaultValue:Y||"",placeholder:`Rename ${_}`,onBlur:Xe=>Le(_,Xe.currentTarget.value)})]})})};rn.displayName="DraggableFieldName";const tn=_=>({toggle:(0,ft.css)({margin:_.spacing(0,1),color:_.colors.text.secondary}),draggable:(0,ft.css)({opacity:.4,"&:hover":{color:_.colors.text.maxContrast}})}),Rn=(_,Y,ie)=>{const ve=Array.from(_),[Re]=ve.splice(Y,1);return ve.splice(ie,0,Re),ve.reduce((Le,$e,ke)=>(Le[$e]=ke,Le),{})},jn=(_,Y={})=>{if(!Y||Object.keys(Y).length===0)return _;const ie=(0,bt.X)(Y);return _.sort(ie)},Wn={id:Z.F.organize,editor:qt,transformation:q.c.organizeFieldsTransformer,name:q.c.organizeFieldsTransformer.name,description:"Allows the user to re-order, hide, or rename fields / columns. Useful when data source doesn't allow overrides for visualizing data.",categories:new Set([p.m.ReorderAndRename]),help:re(Z.F.organize).helperDocs};var bs=e(21128),as=e(13544);const vs=({options:_,onChange:Y})=>{const ie=[{label:"Series to rows",value:bs.rV.SeriesToRows,description:"Create a table with one row for each series value"},{label:"Reduce fields",value:bs.rV.ReduceFields,description:"Collapse each field into a single value"}],ve=(0,c.useCallback)($e=>{const ke=$e.value;Y({..._,mode:ke,includeTimeField:ke===bs.rV.ReduceFields?!!_.includeTimeField:!1})},[Y,_]),Re=(0,c.useCallback)(()=>{Y({..._,includeTimeField:!_.includeTimeField})},[Y,_]),Le=(0,c.useCallback)(()=>{Y({..._,labelsToFields:!_.labelsToFields})},[Y,_]);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(k.I,{label:"Mode","data-testid":as.Tp.components.Transforms.Reduce.modeLabel,grow:!0,labelWidth:16,children:(0,N.jsx)(J.l6,{options:ie,value:ie.find($e=>$e.value===_.mode)||ie[0],onChange:ve})}),(0,N.jsx)(k.I,{label:"Calculations","data-testid":as.Tp.components.Transforms.Reduce.calculationsLabel,grow:!0,labelWidth:16,children:(0,N.jsx)(Ye.S,{placeholder:"Choose Stat",allowMultiple:!0,stats:_.reducers||[],onChange:$e=>{Y({..._,reducers:$e})}})}),_.mode===bs.rV.ReduceFields&&(0,N.jsx)(k.I,{htmlFor:"include-time-field",labelWidth:16,label:"Include time",children:(0,N.jsx)(Ut.K,{id:"include-time-field",value:!!_.includeTimeField,onChange:Re})}),_.mode!==bs.rV.ReduceFields&&(0,N.jsx)(k.I,{htmlFor:"labels-to-fields",labelWidth:16,label:"Labels to fields",children:(0,N.jsx)(Ut.K,{id:"labels-to-fields",value:!!_.labelsToFields,onChange:Le})})]})},Ts={id:Z.F.reduce,editor:vs,transformation:q.c.reduceTransformer,name:q.c.reduceTransformer.name,description:q.c.reduceTransformer.description,categories:new Set([p.m.CalculateNewFields]),help:re(Z.F.reduce).helperDocs};class is extends c.PureComponent{constructor(Y){super(Y),this.handleRegexChange=ie=>{const ve=ie.currentTarget.value;let Re=!0;if(ve)try{ve&&(0,kt.dO)(ve)}catch{Re=!1}this.setState(Le=>({...Le,regex:ve,isRegexValid:Re}))},this.handleRenameChange=ie=>{const ve=ie.currentTarget.value;this.setState(Re=>({...Re,renamePattern:ve}))},this.handleRegexBlur=ie=>{const ve=ie.currentTarget.value;let Re=!0;try{ve&&(0,kt.dO)(ve)}catch{Re=!1}this.setState({isRegexValid:Re},()=>{Re&&this.props.onChange({...this.props.options,regex:ve})})},this.handleRenameBlur=ie=>{const ve=ie.currentTarget.value;this.setState({renamePattern:ve},()=>this.props.onChange({...this.props.options,renamePattern:ve}))},this.state={regex:Y.options.regex,renamePattern:Y.options.renamePattern,isRegexValid:!0}}render(){const{regex:Y,renamePattern:ie,isRegexValid:ve}=this.state;return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(k.I,{label:"Match",labelWidth:16,invalid:!ve,error:ve?void 0:"Invalid pattern",children:(0,N.jsx)(fe.p,{placeholder:"Regular expression pattern",value:Y||"",onChange:this.handleRegexChange,onBlur:this.handleRegexBlur,width:25})}),(0,N.jsx)(k.I,{label:"Replace",labelWidth:16,children:(0,N.jsx)(fe.p,{placeholder:"Replacement pattern",value:ie||"",onChange:this.handleRenameChange,onBlur:this.handleRenameBlur,width:25})})]})}}const Ds={id:Z.F.renameByRegex,editor:is,transformation:q.c.renameByRegexTransformer,name:q.c.renameByRegexTransformer.name,description:"Renames part of the query result by using regular expression with placeholders.",categories:new Set([p.m.ReorderAndRename]),help:re(Z.F.renameByRegex).helperDocs},fs=({input:_,options:Y,onChange:ie})=>null,ks={id:Z.F.seriesToRows,editor:fs,transformation:q.c.seriesToRowsTransformer,name:q.c.seriesToRowsTransformer.name,description:`Merge many series and return a single series with time, metric and value as columns.
                Useful for showing multiple time series visualized in a table.`,categories:new Set([p.m.Combine,p.m.Reformat]),help:re(Z.F.seriesToRows).helperDocs},La=({input:_,options:Y,onChange:ie})=>{const ve=(0,Se.ZI)(_).map(Xe=>({label:Xe,value:Xe})),Le=(0,xe.w)().getVariables().map(Xe=>({label:"$"+Xe.name,value:"$"+Xe.name})),$e=(0,c.useCallback)((Xe,ct)=>{ie({...Y,sort:[ct]})},[ie,Y]),ke=Y.sort?.length?Y.sort:[{}];return(0,N.jsx)("div",{children:ke.map((Xe,ct)=>(0,N.jsxs)(oe.C,{children:[(0,N.jsx)(k.I,{label:"Field",labelWidth:10,grow:!0,children:(0,N.jsx)(J.l6,{options:z.$.featureToggles.transformationsVariableSupport?[...ve,...Le]:ve,value:Xe.field,placeholder:"Select field",onChange:pt=>{$e(ct,{...Xe,field:pt.value})}})}),(0,N.jsx)(k.I,{label:"Reverse",children:(0,N.jsx)(Ut.K,{value:!!Xe.desc,onChange:()=>{$e(ct,{...Xe,desc:!Xe.desc})}})})]},`${Xe.field}/${ct}`))})},ja={id:Z.F.sortBy,editor:La,transformation:q.c.sortByTransformer,name:q.c.sortByTransformer.name,description:q.c.sortByTransformer.description,categories:new Set([p.m.ReorderAndRename]),help:re(Z.F.sortBy).helperDocs},br=({options:_,onChange:Y})=>(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{label:"First field name",labelWidth:24,children:(0,N.jsx)(fe.p,{placeholder:"Field",value:_.firstFieldName,onChange:ie=>Y({..._,firstFieldName:ie.currentTarget.value}),width:25})})}),(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{label:"Remaining fields name",tooltip:"Name for value fields",labelWidth:24,children:(0,N.jsx)(fe.p,{placeholder:"Value",value:_.restFieldsName,onChange:ie=>Y({..._,restFieldsName:ie.currentTarget.value}),width:25})})})]}),Lr={id:Z.F.transpose,editor:br,transformation:q.c.transposeTransformer,name:q.c.transposeTransformer.name,description:q.c.transposeTransformer.description,categories:new Set([p.m.Reformat])};function Qr({options:_,onChange:Y}){const[ie,ve]=(0,c.useState)(_),Re=To(),Le=So(),$e=()=>{ie.push({path:""}),ve([...ie]),ct()},ke=pt=>{ie&&(ie.splice(pt,1),ve([...ie]),ct())},Xe=(pt,Ct,Ft)=>{ie&&(Ft==="alias"?ie[Ct].alias=pt.currentTarget.value??"":ie[Ct].path=pt.currentTarget.value??"",ve([...ie]))},ct=()=>{Y(ie)};return(0,N.jsxs)("ol",{className:(0,ft.cx)(Le.list),children:[ie&&ie.map((pt,Ct)=>(0,N.jsx)("li",{children:(0,N.jsxs)(oe.C,{children:[(0,N.jsx)(k.I,{label:"Field",tooltip:Re.field,grow:!0,children:(0,N.jsx)(fe.p,{onBlur:ct,onChange:Ft=>Xe(Ft,Ct,"path"),value:pt.path,placeholder:'A valid json path, e.g. "object.value1" or "object.value2[0]"'})}),(0,N.jsx)(k.I,{label:"Alias",tooltip:Re.alias,children:(0,N.jsx)(fe.p,{width:12,value:pt.alias,onBlur:ct,onChange:Ft=>Xe(Ft,Ct,"alias")})}),(0,N.jsx)(k.I,{className:(0,ft.cx)(Le.removeIcon),children:(0,N.jsx)(Za.K,{onClick:()=>ke(Ct),name:"trash-alt",tooltip:"Remove path"})})]})},Ct)),(0,N.jsx)(k.I,{children:(0,N.jsx)(ne.$n,{icon:"plus",onClick:()=>$e(),variant:"secondary",children:"Add path"})})]})}const To=()=>{const _=[{path:"object",description:"=> extract fields from object"},{path:"object.value1",description:"=> extract value1"},{path:"object.value2",description:"=> extract value2"},{path:"object.value2[0]",description:"=> extract value2 first element"},{path:"object.value2[1]",description:"=> extract value2 second element"}];return{field:(0,N.jsxs)("div",{children:["A valid path of an json object.",(0,N.jsx)("div",{children:(0,N.jsx)("strong",{children:"JSON Value:"})}),(0,N.jsx)("pre",{children:(0,N.jsx)("code",{children:["{",'  "object": {','    "value1": "hello world"','    "value2": [1, 2, 3, 4]',"  }","}"].join(`
`)})}),(0,N.jsx)("strong",{children:"Valid Paths:"}),_.map((Y,ie)=>(0,N.jsxs)("p",{children:[(0,N.jsx)("code",{children:Y.path}),(0,N.jsx)("i",{children:Y.description})]},ie))]}),alias:"An alias name for the variable in the dashboard. If left blank the given path will be used."}};function So(){return{list:(0,ft.css)`
      margin-left: 20px;
    `,removeIcon:(0,ft.css)`
      margin: 0 0 0 4px;
      align-items: center;
    `}}var jr=e(14236),Gs=(_=>(_.JSON="json",_.KeyValues="kvp",_.Auto="auto",_))(Gs||{});const io={id:Gs.JSON,name:"JSON",description:"Parse JSON string",parse:_=>JSON.parse(_)};function Mo(_){const Y=[];let ie="",ve="";const Re={};for(let Le=0;Le<_.length;Le++){let $e=_[Le];$e===ie&&(ie="",$e=_[++Le]);const ke=$e==="\\";if(ke&&($e=_[++Le]),ke||ie.length){Y.push($e);continue}switch(($e==='"'||$e==="'")&&(ie=$e),$e){case":":case"=":Y.length&&(ve&&(Re[ve]=""),ve=Y.join(""),Y.length=0);break;case'"':case"'":case" ":case`
`:case"	":case"\r":case`
`:Y.length&&ve===""&&(Re[Y.join("")]="",Y.length=0);case",":case";":case"&":case"{":case"}":if(Y.length){const Xe=Y.join("");ve.length?(Re[ve]=Xe,ve=""):ve=Xe,Y.length=0}break;default:Y.push($e),Le===_.length-1&&ve===""&&Y.length&&(Re[Y.join("")]="",Y.length=0)}}return ve.length&&(Re[ve]=Y.join("")),Re}const lo={id:Gs.KeyValues,name:"Key+value pairs",description:"Look for a=b, c: d values in the line",parse:Mo},Br=[io,lo],Oo={id:Gs.Auto,name:"Auto",description:"parse new fields automatically",parse:_=>{for(const Y of Br)try{const ie=Y.parse(_);if(ie!=null)return ie}catch{}}},co=new ce.O(()=>[...Br,Oo]),kr={id:Z.F.extractFields,name:"Extract fields",description:"Parse fields from the contends of another",defaultOptions:{},operator:(_,Y)=>ie=>ie.pipe((0,mt.T)(ve=>kr.transformer(_,Y)(ve))),transformer:_=>Y=>Y.map(ie=>Ao(ie,_))};function Ao(_,Y){if(!Y.source)return _;const ie=(0,Ra.findField)(_,Y.source);if(!ie)return _;const ve=co.getIfExists(Y.format??Gs.Auto);if(!ve)throw new Error("unkonwn extractor");const Re=_.length,Le=[],$e=new Map;for(let Xe=0;Xe<Re;Xe++){let ct=ie.values[Xe];if((0,l.isString)(ct))try{ct=ve.parse(ct)}catch{ct={}}if(ct!=null){if(Y.format===Gs.JSON&&Y.jsonPaths&&Y.jsonPaths?.length>0){const pt={},Ct=Y.jsonPaths.filter(Ft=>Ft.path);Ct.length>0&&(Ct.forEach(Ft=>{const Ot=Ft.alias&&Ft.alias.length>0?Ft.alias:Ft.path;pt[Ot]=(0,l.get)(ct,Ft.path)??"Not Found"}),ct=pt)}for(const[pt,Ct]of Object.entries(ct)){let Ft=$e.get(pt);Ft==null&&(Ft=new Array(Re).fill(void 0),$e.set(pt,Ft),Le.push(pt)),Ft[Xe]=Ct}}}const ke=Le.map(Xe=>{const ct=$e.get(Xe),pt={name:Xe,values:ct,type:ct?(0,jr.oE)(ct.find(Ct=>Ct!=null)):H.PU.other,config:{}};return z.$.featureToggles.extractFieldsNameDeduplication&&(pt.name=(0,ee.fk)(pt,_)),pt});if(Y.keepTime){const Xe=(0,Ra.findField)(_,"Time")||(0,Ra.findField)(_,"time");Xe&&ke.unshift(Xe)}return Y.replace||ke.unshift(..._.fields),{..._,fields:ke}}const Io={settings:{width:30,placeholderText:"Select field"},name:"",id:"",editor:()=>null},Ro=({input:_,options:Y,onChange:ie})=>{const ve=ct=>{ie({...Y,source:ct})},Re=ct=>{ie({...Y,format:ct?.value})},Le=ct=>{ie({...Y,jsonPaths:ct})},$e=()=>{Y.replace&&(Y.keepTime=!1),ie({...Y,replace:!Y.replace})},ke=()=>{ie({...Y,keepTime:!Y.keepTime})},Xe=co.selectOptions(Y.format?[Y.format]:void 0);return(0,N.jsxs)("div",{children:[(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{label:"Source",labelWidth:16,children:(0,N.jsx)(la.O,{context:{data:_},value:Y.source??"",onChange:ve,item:Io})})}),(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{label:"Format",labelWidth:16,children:(0,N.jsx)(J.l6,{value:Xe.current[0],options:Xe.options,onChange:Re,width:24,placeholder:"Auto"})})}),Y.format==="json"&&(0,N.jsx)(Qr,{options:Y.jsonPaths??[],onChange:Le}),(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{label:"Replace all fields",labelWidth:16,children:(0,N.jsx)(Ut.K,{value:Y.replace??!1,onChange:$e})})}),Y.replace&&(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{label:"Keep time",labelWidth:16,children:(0,N.jsx)(Ut.K,{value:Y.keepTime??!1,onChange:ke})})})]})},Ur={id:Z.F.extractFields,editor:Ro,transformation:kr,name:kr.name,description:"Parse fields from content (JSON, labels, etc).",categories:new Set([p.m.Reformat]),help:re(Z.F.extractFields).helperDocs};var Tr=e(51986);const Ar={id:Z.F.joinByLabels,name:"Join by labels",description:"Flatten labeled results into a table joined by labels.",defaultOptions:{},operator:(_,Y)=>ie=>ie.pipe((0,mt.T)(ve=>Ar.transformer(_,Y)(ve))),transformer:_=>Y=>!Y||!Y.length?Y:[Nr(_,Y)]};function Nr(_,Y){if(!_.value?.length)return Wr("No value labele configured");const ie=(0,Se.aG)(Y);if(ie.size<1)return Wr("No labels in result");if(!ie.has(_.value))return Wr("Value label not found");let ve=_.join?.length?_.join:Array.from(ie);ve=ve.filter(Ct=>Ct!==_.value);const Re=new Set,Le=new Map,$e={};for(const Ct of Y)for(const Ft of Ct.fields)if(Ft.labels&&Ft.type!==H.PU.time){const Ot=ve.map(ta=>Ft.labels[ta]),jt=Ot.join(",");let Rt=Le.get(jt);Rt||(Rt={keys:Ot,values:{}},Le.set(jt,Rt));const Mn=Ft.labels[_.value],Ws=Ft.values,Fs=Rt.values[Mn];Fs?Rt.values[Mn]=Fs.concat(Ws):Rt.values[Mn]=Ws,$e[Mn]||($e[Mn]=Ft),Re.add(Mn)}const ke=Array.from(Re),Xe=ve.map(()=>[]),ct=ke.map(()=>[]);for(const Ct of Le.values()){let Ft=-1,Ot=!1;for(;!Ot;){Ft++,Ot=!0;for(let jt=0;jt<ve.length;jt++)Xe[jt].push(Ct.keys[jt]);for(let jt=0;jt<ke.length;jt++){const Rt=ke[jt],Mn=Ct.values[Rt]??[];ct[jt].push(Mn[Ft]),Mn.length>Ft+1&&(Ot=!1)}}}const pt={fields:[],length:ct[0].length};for(let Ct=0;Ct<ve.length;Ct++)pt.fields.push({name:ve[Ct],config:{},type:H.PU.string,values:Xe[Ct]});for(let Ct=0;Ct<ke.length;Ct++){const Ft=$e[ke[Ct]];pt.fields.push({name:ke[Ct],config:{},type:Ft.type??H.PU.number,values:ct[Ct]})}return pt}function Wr(_){return{meta:{notices:[{severity:"error",text:_}]},fields:[{name:"Error",type:H.PU.string,config:{},values:[_]}],length:0}}function Yr({input:_,options:Y,onChange:ie}){const ve=(0,c.useMemo)(()=>{let Xe;const ct=(0,Se.aG)(_),pt=Array.from(ct).map(Mn=>({label:Mn,value:Mn}));let Ct=pt.find(Mn=>Mn.value===Y.value);!Ct&&Y.value&&(Ct={label:`${Y.value} (not found)`,value:Y.value},pt.push(Ct)),_.length?ct.size===0&&(Xe=(0,N.jsx)(ms.F,{title:"No labels found",children:"The input does not contain any labels"})):Xe=(0,N.jsx)(ms.F,{title:"No input found",children:"No input (or labels) found"}),ct.delete(Y.value);const Ft=Array.from(ct).map(Mn=>({label:Mn,value:Mn}));let Ot=Ft;const jt=!!Y.join?.length;let Rt="Join";return jt?Ot=Ft.filter(Mn=>!Y.join.includes(Mn.value)):Rt=Ft.map(Mn=>Mn.value).join(", "),{warn:Xe,valueOptions:pt,valueOption:Ct,joinOptions:Ft,addOptions:Ot,addText:Rt,hasJoin:jt,key:Date.now()}},[Y,_]),Re=(Xe,ct)=>{if(!Y.join)return;const pt=Y.join.slice();if(ct)pt[Xe]=ct;else if(pt.splice(Xe,1),!pt.length){ie({...Y,join:void 0});return}const Ct=new Set(pt);Y.value&&Ct.delete(Y.value),ie({...Y,join:Array.from(Ct)})},Le=Xe=>{const ct=Xe?.value;if(!ct)return;const pt=Y.join?Y.join.slice():[];pt.push(ct),ie({...Y,join:pt})},$e=10,ke="No labels found";return(0,N.jsxs)("div",{children:[ve.warn,(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{error:"required",invalid:!Y.value?.length,label:"Value",labelWidth:$e,tooltip:"Select the label indicating the values name",children:(0,N.jsx)(J.l6,{options:ve.valueOptions,value:ve.valueOption,onChange:Xe=>ie({...Y,value:Xe.value}),noOptionsMessage:ke})})}),ve.hasJoin?Y.join.map((Xe,ct)=>(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{label:"Join",labelWidth:$e,error:"Unable to join by the value label",invalid:Xe===Y.value,children:(0,N.jsxs)(Ze.Gy,{children:[(0,N.jsx)(J.l6,{options:ve.joinOptions,value:ve.joinOptions.find(pt=>pt.value===Xe),isClearable:!0,onChange:pt=>Re(ct,pt?.value),noOptionsMessage:ke}),!!(ve.addOptions.length&&ct===Y.join.length-1)&&(0,N.jsx)(Tr.i,{icon:"plus",label:"",options:ve.addOptions,onChange:Le,variant:"secondary"})]})})},Xe+ct)):(0,N.jsx)(N.Fragment,{children:!!ve.addOptions.length&&(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{label:"Join",labelWidth:$e,children:(0,N.jsx)(J.l6,{options:ve.addOptions,placeholder:ve.addText,onChange:Le,noOptionsMessage:ke})})})})]})}const pr={id:Ar.id,editor:Yr,transformation:Ar,name:Ar.name,description:Ar.description,state:he.pn.beta,categories:new Set([p.m.Combine]),help:re(Ar.id).helperDocs};var Jr=e(84350),qa=e(69862),Ga=e(65474),uo=e(67140);const dr={id:Z.F.fieldLookup,name:"Lookup fields from resource",description:"Retrieve matching data based on specified field",defaultOptions:{},operator:_=>Y=>Y.pipe((0,qa.Z)(ie=>(0,Ga.H)(Lo(ie,_))))};async function Lo(_,Y){const ie=Q.sJ.get(X.Ct.byName).get(Y?.lookupField),ve=await(0,uo.q3)(Y?.gazetteer??uo.fx);return ve.frame?Zr(_,ve,ie):Promise.reject("missing frame in gazetteer")}function Zr(_,Y,ie){const ve=Y.frame()?.fields;return ve?_.map(Re=>{const Le=Re.length,$e=[];for(const ke of Re.fields)if($e.push(ke),ie(ke,Re,_)){const Xe=ke.values,ct=[];for(const pt of ve){const Ct=new Array(Le);ct.push(Ct),$e.push({...pt,values:Ct})}for(let pt=0;pt<Y.count;pt++){const Ct=Y.find(Xe[pt]);if(Ct?.index!=null)for(let Ft=0;Ft<ve.length;Ft++)ct[Ft][pt]=ve[Ft].values[Ct.index]}}return{...Re,fields:$e}}):_}const Xr={settings:{width:30,filter:_=>_.type===H.PU.string,placeholderText:"Select text field",noFieldsMessage:"No text fields found"},name:"",id:"",editor:()=>null},ho={settings:{}},_r=({input:_,options:Y,onChange:ie})=>{const ve=(0,c.useCallback)(Le=>{ie({...Y,lookupField:Le})},[ie,Y]),Re=(0,c.useCallback)(Le=>{ie({...Y,gazetteer:Le})},[ie,Y]);return(0,N.jsxs)("div",{children:[(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{label:"Field",labelWidth:12,children:(0,N.jsx)(la.O,{context:{data:_},value:Y?.lookupField??"",onChange:ve,item:Xr})})}),(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{label:"Lookup",labelWidth:12,children:(0,N.jsx)(Jr.G,{value:Y?.gazetteer??"",context:{data:_},item:ho,onChange:Re})})})]})},qr={id:Z.F.fieldLookup,editor:_r,transformation:dr,name:dr.name,description:"Use a field value to lookup additional fields from an external source. This currently supports spatial data, but will eventually support more formats.",state:he.pn.alpha,categories:new Set([p.m.PerformSpatialOperations]),help:re(Z.F.fieldLookup).helperDocs};var fo=e(35602),eo=e(64586);const go=(_,Y,ie=[])=>(Y===0?ie.push(_):_.forEach(ve=>{go(ve,Y-1,ie)}),ie);function po(_){const Y=_[0].length,ie=_.length,ve=new Map;for(let Re=0;Re<Y;Re++){let Le=ve;for(let $e=0;$e<ie;$e++){let ke=_[$e][Re],Xe=Le.get(ke);Xe==null&&(Xe=$e===ie-1?[]:new Map,Le.set(ke,Xe)),Le=Xe}Le.push(Re)}return go(ve,ie)}const jo={asLabels:!0,append:!1,withNames:!1,separator1:"=",separator2:" "};function Qe(_,Y,ie){return Y.map((ve,Re)=>_.withNames?`${ve}${_.separator1}${ie[Re]}`:ie[Re]).join(_.separator2)}function je(_,Y){const ie={};return _.forEach((ve,Re)=>{ie[ve]=String(Y[Re])}),ie}const qe={id:Z.F.partitionByValues,name:"Partition by values",description:"Splits a one-frame dataset into multiple series discriminated by unique/enum values in one or more fields.",defaultOptions:{keepFields:!1},operator:(_,Y)=>ie=>ie.pipe((0,mt.T)(ve=>qe.transformer(_,Y)(ve))),transformer:(_,Y)=>{const ie=(0,fo.R)(Y,{names:_.fields});if(!ie)return eo.W.transformer({},Y);const ve=(0,Q.NS)(ie);return Re=>Re.length?dt(Re[0],ve,_):Re}};function dt(_,Y,ie){const ve=_.fields.filter(ke=>Y(ke,_,[_]));if(!ve.length)return[_];const Re=ve.map(ke=>ke.values),Le=ve.map(ke=>ke.name),$e={...jo,...ie?.naming};return po(Re).map(ke=>{let Xe=_.name,ct={};if($e.asLabels)ct=je(Le,ve.map((Ct,Ft)=>Re[Ft][ke[0]]));else{let Ct=Qe($e,Le,ve.map((Ft,Ot)=>Re[Ot][ke[0]]));$e?.append&&_.name&&(Ct=`${_.name} ${Ct}`),Xe=Ct}let pt=_.fields;if(!ie?.keepFields){const Ct=new Set(Le);pt=_.fields.filter(Ft=>!Ct.has(Ft.name))}return{name:Xe,meta:_.meta,length:ke.length,fields:pt.map(Ct=>{const Ft=Ct.values,Ot=Array(ke.length);for(let jt=0;jt<ke.length;jt++)Ot[jt]=Ft[ke[jt]];return{name:Ct.name,type:Ct.type,config:Ct.config,labels:{...Ct.labels,...ct},values:Ot}})}})}function Lt({input:_,options:Y,onChange:ie}){const ve=(0,$s.sE)(_),Re=(0,$s.m3)(ve),Le=(0,c.useMemo)(()=>{const Ft=new Set(Y.fields);return Ft.size<1?Re:Re.filter(Ot=>!Ft.has(Ot.value))},[Re,Y]),$e=(0,c.useCallback)(Ft=>{if(!Ft.value)return;const Ot=new Set(Y.fields);Ot.add(Ft.value),ie({...Y,fields:[...Ot]})},[ie,Y]);let ke;(Ft=>{Ft[Ft.asLabels=0]="asLabels",Ft[Ft.frameName=1]="frameName"})(ke||(ke={}));const Xe=[{label:"As label",value:0},{label:"As frame name",value:1}],ct=[{label:"Yes",value:!0},{label:"No",value:!1}],pt=(0,c.useCallback)(Ft=>{if(!Ft)return;const Ot=new Set(Y.fields);Ot.delete(Ft),ie({...Y,fields:[...Ot]})},[ie,Y]);if(_.length>1)return(0,N.jsx)(Ea.P,{children:"Partition by values only works with a single frame."});const Ct=[...new Set(Y.fields)];return(0,N.jsxs)("div",{children:[(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{label:"Field",labelWidth:10,grow:!0,children:(0,N.jsxs)(Ze.Gy,{children:[Ct.map(Ft=>(0,N.jsx)(ne.$n,{icon:"times",variant:"secondary",size:"md",onClick:()=>pt(Ft),children:Ft},Ft)),Le.length&&(0,N.jsx)(Tr.i,{variant:"secondary",size:"md",options:Le,onChange:$e,label:"Select field",icon:"plus"})]})})}),(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{tooltip:"Sets how the names of the selected fields are displayed. As frame name is usually better for tabular data",label:"Naming",labelWidth:10,children:(0,N.jsx)(se.z,{options:Xe,value:Y.naming?.asLabels===void 0||Y.naming.asLabels?0:1,onChange:Ft=>ie({...Y,naming:{...Y.naming,asLabels:Ft===0}})})})}),(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{tooltip:"Keeps the partition fields in the frames.",label:"Keep fields",labelWidth:16,children:(0,N.jsx)(se.z,{options:ct,value:Y.keepFields,onChange:Ft=>ie({...Y,keepFields:Ft})})})})]})}const Vt={id:Z.F.partitionByValues,editor:Lt,transformation:qe,name:qe.name,description:qe.description,state:he.pn.alpha,categories:new Set([p.m.Reformat]),help:re(Z.F.partitionByValues).helperDocs};var Gt=e(41260),en=e(37471),bn=e(73060),En=(_=>(_.TimeSeriesWide="wide",_.TimeSeriesLong="long",_.TimeSeriesMulti="multi",_.TimeSeriesMany="many",_))(En||{});function rs(_){if(!Array.isArray(_)||_.length===0)return _;const Y=[];for(const ie of js(_)){const ve=ie.fields[0];if(!ve||ve.type!==H.PU.time)continue;const Re=[],Le=[];for(const $e of ie.fields)switch($e.type){case H.PU.number:case H.PU.boolean:Re.push($e);break;case H.PU.string:Le.push($e);break}for(const $e of Re)if(Le.length){const ke=new Map;for(let Xe=0;Xe<ie.length;Xe++){const ct=ve.values[Xe],pt=$e.values[Xe];if(pt===void 0||ct==null)continue;const Ct=Le.map(Ot=>Ot.values[Xe]).join("/");let Ft=ke.get(Ct);if(!Ft){Ft={key:Ct,time:[],value:[],labels:{}};for(const Ot of Le)Ft.labels[Ot.name]=Ot.values[Xe];ke.set(Ct,Ft)}Ft.time.push(ct),Ft.value.push(pt)}for(const Xe of ke.values())Y.push({name:ie.name,refId:ie.refId,meta:{...ie.meta,type:Gt.m.TimeSeriesMulti},fields:[{...ve,values:Xe.time},{...$e,values:Xe.value,labels:Xe.labels}],length:Xe.time.length})}else Y.push({name:ie.name,refId:ie.refId,meta:{...ie.meta,type:Gt.m.TimeSeriesMulti},fields:[ve,$e],length:ie.length})}return Y}function js(_){if(!Array.isArray(_)||_.length===0)return _;const Y=[];for(const ie of _){let ve;const Re=[],Le={},$e={},ke={},Xe={};for(let jt=0;jt<ie.fields.length;jt++){const Rt=ie.fields[jt];switch(Rt.type){case H.PU.string:case H.PU.boolean:Rt.name in Xe||(Xe[Rt.name]=jt,$e[Rt.name]=!0);break;case H.PU.time:if(!ve){ve=Rt;break}default:if(Rt.name in Le){const Fs=Le[Rt.name];if(Rt.type!==Fs)continue}else Le[Rt.name]=Rt.type,Re.push(Rt.name);const Mn=JSON.stringify(Rt.labels),Ws=ke[Mn];if(Ws!==void 0?Ws.push(jt):ke[Mn]=[jt],Rt.labels!=null)for(const Fs in Rt.labels)$e[Fs]=!0}}if(!ve)continue;const ct=[],pt=[],Ct=[],Ft=[];for(let jt=0;jt<ie.length;jt++)ct.push({time:ve.values[jt],wideRowIndex:jt});for(const jt in ke)pt.push(jt);for(const jt in $e)Ct.push(jt);for(const jt in Xe)Ft.push(jt);ct.sort((jt,Rt)=>jt.time-Rt.time),pt.sort(),Ct.sort(),Re.sort();const Ot=new en.k({...ie,meta:{...ie.meta,type:Gt.m.TimeSeriesLong},fields:[{name:ve.name,type:ve.type}]});for(const jt of Re)Ot.addField({name:jt,type:Le[jt]});for(const jt of Ct)Ot.addField({name:jt,type:H.PU.string});for(const jt of ct){const{time:Rt,wideRowIndex:Mn}=jt;for(const Ws of pt){const Fs={};for(const Rs of Ft)Fs[Rs]=ie.fields[Xe[Rs]].values[Mn];let ta=0;for(const Rs of ke[Ws]){const ar=ie.fields[Rs];if(ta++===0&&ar.labels!=null)for(const Ia in ar.labels)Fs[Ia]=ar.labels[Ia];Fs[ar.name]=ar.values[Mn]}Fs[ve.name]=Rt,Ot.add(Fs)}}Y.push(Ot)}return Y}function Xs(_){return dt(_,ie=>ie.type===H.PU.string).map(ie=>(ie.meta||(ie.meta={}),ie.meta.type=Gt.m.TimeSeriesMulti,ie))}const Ss={id:Z.F.prepareTimeSeries,name:"Prepare time series",description:"Will stretch data frames from the wide format into the long format. This is really helpful to be able to keep backwards compatibility for panels not supporting the new wide format.",defaultOptions:{},operator:(_,Y)=>ie=>ie.pipe((0,mt.T)(ve=>Ss.transformer(_,Y)(ve))),transformer:_=>{const Y=_?.format??"wide";if(Y==="many"||Y==="multi")return rs;if(Y==="long")return js;const ie=Q.sJ.get(X.Ct.firstTimeField).get({});return ve=>{if(!ve.length)return[];const Re=[];for(const $e of ve)$e.meta?.type===Gt.m.TimeSeriesLong?Xs($e).forEach(ke=>Re.push(ke)):Re.push($e);const Le=(0,bn.Fd)({frames:Re,joinBy:ie,keepOriginIndices:!0});return Le?(Le.meta||(Le.meta={}),Le.meta.type=Gt.m.TimeSeriesWide,[Le]):[]}}},Ys={label:"Wide time series",value:En.TimeSeriesWide,description:"Creates a single frame joined by time",info:(0,N.jsxs)("ul",{children:[(0,N.jsx)("li",{children:"Single frame"}),(0,N.jsx)("li",{children:"1st field is shared time field"}),(0,N.jsx)("li",{children:"Time in ascending order"}),(0,N.jsx)("li",{children:"Multiple value fields of any type"})]})},ea={label:"Multi-frame time series",value:En.TimeSeriesMulti,description:"Creates a new frame for each time/number pair",info:(0,N.jsxs)("ul",{children:[(0,N.jsx)("li",{children:"Multiple frames"}),(0,N.jsx)("li",{children:"Each frame has two fields: time, value"}),(0,N.jsx)("li",{children:"Time in ascending order"}),(0,N.jsx)("li",{children:"String values are represented as labels"}),(0,N.jsx)("li",{children:"All values are numeric"})]})},_s={label:"Long time series",value:En.TimeSeriesLong,description:"Convert each frame to long format",info:(0,N.jsxs)("ul",{children:[(0,N.jsx)("li",{children:"Single frame"}),(0,N.jsx)("li",{children:"1st field is time field"}),(0,N.jsx)("li",{children:"Time in ascending order, but may have duplictes"}),(0,N.jsx)("li",{children:"String values are represented as separate fields rather than as labels"}),(0,N.jsx)("li",{children:"Multiple value fields may exist"})]})},qs=[Ys,ea,_s];function sa(_){const{options:Y,onChange:ie}=_,ve=(0,De.of)(Va),Re=(0,c.useCallback)(Le=>{ie({...Y,format:Le.value})},[ie,Y]);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{label:"Format",labelWidth:12,children:(0,N.jsx)(J.l6,{width:35,options:qs,value:qs.find(Le=>Le.value===En.TimeSeriesMulti&&Y.format===En.TimeSeriesMany?!0:Le.value===Y.format)||qs[0],onChange:Re,className:"flex-grow-1"})})}),(0,N.jsx)(oe.C,{children:(0,N.jsx)(k.I,{label:"Info",labelWidth:12,children:(0,N.jsx)("div",{className:ve.info,children:(qs.find(Le=>Le.value===Y.format)||qs[0]).info})})})]})}const Va=_=>({info:(0,ft.css)`
    margin-left: 20px;
  `}),Zs={id:Ss.id,editor:sa,transformation:Ss,name:Ss.name,description:Ss.description,categories:new Set([p.m.Reformat]),help:re(Ss.id).helperDocs};var ba=e(66648),ur=e(48817),Ma=(_=>(_.linear="linear",_.polynomial="polynomial",_))(Ma||{});const Ta={predictionCount:100,modelType:"linear",degree:2},ya={id:Z.F.regression,name:"Regression analysis",operator:(_,Y)=>ie=>ie.pipe((0,mt.T)(ve=>ya.transformer(_,Y)(ve))),transformer:(_,Y)=>ie=>{const{predictionCount:ve,modelType:Re,degree:Le}={...Ta,..._};if(ie.length===0)return ie;const $e=Q.sJ.get(X.Ct.byName).get(_.yFieldName),ke=Q.sJ.get(X.Ct.byName).get(_.xFieldName);let Xe,ct,pt;for(const Rs of ie){const ar=Rs.fields.find(Ia=>$e(Ia,Rs,ie));if(ar){ct=ar;const Ia=Rs.fields.find(Rr=>ke(Rr,Rs,ie));if(Ia){Xe=Ia,pt=Rs;break}else throw"X and Y fields must be part of the same frame"}}if(!Xe||!ct)return ie;let Ct=Xe.values[0],Ft=Xe.values[0];for(let Rs=1;Rs<Xe.values.length;Rs++)Xe.values[Rs]<Ct&&(Ct=Xe.values[Rs]),Xe.values[Rs]>Ft&&(Ft=Xe.values[Rs]);const Ot=(Ft-Ct)/(ve-1),jt=[...[...Array(ve-1).keys()].map((Rs,ar)=>ar*Ot+Ct),Ft],Rt=Xe.type===H.PU.time?Ct:0,Mn=[],Ws=[];for(let Rs=0;Rs<Xe.values.length;Rs++)ct.values[Rs]!==null&&!isNaN(ct.values[Rs])&&(Ws.push(Xe.values[Rs]-Rt),Mn.push(ct.values[Rs]));let Fs;switch(Re){case"linear":Fs=new ur.X(Ws,Mn);break;case"polynomial":Fs=new ba.Y(Ws,Mn,Le);break;default:return ie}const ta={name:`${Re} regression`,length:jt.length,fields:[{name:Xe.name,type:Xe.type,values:jt,config:{}},{name:`${(0,ee.Ct)(ct,pt,ie)} predicted`,type:ct.type,values:jt.map(Rs=>Fs.predict(Rs-Rt)),config:{}}]};return[...ie,ta]}},mr={editor:la.O,id:"",name:"",settings:{width:24,isClearable:!1}},to=20,di=({input:_,options:Y,onChange:ie})=>{const ve=[{label:"Linear",value:Ma.linear},{label:"Polynomial",value:Ma.polynomial}];return(0,c.useEffect)(()=>{let Re,Le;if(!Y.xFieldName){const $e=Q.sJ.get(X.Ct.firstTimeField).get({});for(const ke of _)if(Re=ke.fields.find(Xe=>$e(Xe,ke,_)),Re)break;if(!Re){const ke=Q.sJ.get(X.Ct.numeric).get({});for(const Xe of _)if(Re=Xe.fields.find(ct=>ke(ct,Xe,_)),Re)break}}if(!Y.yFieldName){const $e=Q.sJ.get(X.Ct.numeric).get({});for(const ke of _)if(Le=ke.fields.find(Xe=>$e(Xe,ke,_)&&Xe!==Re),Le)break}Re&&Le&&ie({...Y,xFieldName:Re.name,yFieldName:Le.name})}),(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(k.I,{labelWidth:to,label:"X field",children:(0,N.jsx)(la.O,{context:{data:_},value:Y.xFieldName??"",item:mr,onChange:Re=>{ie({...Y,xFieldName:Re})}})}),(0,N.jsx)(k.I,{labelWidth:to,label:"Y field",children:(0,N.jsx)(la.O,{context:{data:_},value:Y.yFieldName??"",item:mr,onChange:Re=>{ie({...Y,yFieldName:Re})}})}),(0,N.jsx)(k.I,{labelWidth:to,label:"Model type",children:(0,N.jsx)(J.l6,{value:Y.modelType??Ta.modelType,onChange:Re=>{ie({...Y,modelType:Re.value??Ta.modelType})},options:ve})}),(0,N.jsx)(k.I,{labelWidth:to,label:"Predicted points",tooltip:"Number of X,Y points to predict",children:(0,N.jsx)(Zt.Q,{value:Y.predictionCount??Ta.predictionCount,onChange:Re=>{ie({...Y,predictionCount:Re})}})}),Y.modelType===Ma.polynomial&&(0,N.jsx)(k.I,{labelWidth:to,label:"Degree",children:(0,N.jsx)(J.l6,{value:Y.degree??Ta.degree,options:[{label:"Quadratic",value:2},{label:"Cubic",value:3},{label:"Quartic",value:4},{label:"Quintic",value:5}],onChange:Re=>{ie({...Y,degree:Re.value})}})})]})},Bo={id:Z.F.regression,editor:di,transformation:ya,name:ya.name,description:ya.description,categories:new Set([p.m.CalculateNewFields]),help:re(Z.F.regression).helperDocs},no={id:Z.F.rowsToFields,name:"Rows to fields",description:"Convert each row into a field with dynamic config.",defaultOptions:{},operator:_=>Y=>Y.pipe((0,mt.T)(ie=>ie.map(ve=>ui(_,ve))))};function ui(_,Y){const ie=Ms(Y,_.mappings??[],!0),{nameField:ve,valueField:Re}=ie;if(!ve||!Re)return Y;const Le=[];for(let $e=0;$e<ve.values.length;$e++){const ke=ve.values[$e],Xe=Re.values[$e],ct=zt(Y,$e,ie),pt=hi(Y,$e,ie),Ct={name:`${ke}`,type:Re.type,values:[Xe],config:ct,labels:pt};Le.push(Ct)}return{fields:Le,length:1}}function hi(_,Y,ie){const ve={...ie.nameField.labels};for(let Re=0;Re<_.fields.length;Re++){const Le=_.fields[Re],$e=(0,ee.Ct)(Le,_),ke=ie.index[$e];if(ke.handler&&ke.handler.key!==Kt.Label)continue;const Xe=Le.values[Y];Xe!=null&&(ve[$e]=Xe)}return ve}function Jo({input:_,options:Y,onChange:ie}){return _.length===0?null:(0,N.jsx)("div",{children:(0,N.jsx)(Ls,{frame:_[0],mappings:Y.mappings??[],onChange:ve=>ie({...Y,mappings:ve}),withNameAndValue:!0})})}const fi={id:no.id,editor:Jo,transformation:no,name:no.name,description:no.description,state:he.pn.beta,categories:new Set([p.m.Reformat]),help:re(no.id).helperDocs};var Zo=e(52622),mo=e(61983),za=e(9581),Xo=e(96606),Fr=e(31484),vo=e(78134);const Uo={id:Z.F.spatial,name:"Spatial operations",description:"Apply spatial operations to query results.",defaultOptions:{},operator:_=>Y=>Y.pipe((0,qa.Z)(ie=>(0,Ga.H)(gi(ie,_))))};function _o(_){return _.action===za.dy.Modify&&_.modify?.op===za.YD.LineBuilder}async function gi(_,Y){const ie=await(0,Fr.nE)(Y.source);if(_o(Y)){const ve=await(0,Fr.nE)(Y.modify?.target);return _.map(Re=>{const Le=(0,Fr.FM)(Re,ie),$e=(0,Fr.FM)(Re,ve);if(Le.field&&$e.field){const ke=[...Re.fields],Xe=(0,Xo.XR)(Le.field,$e.field),ct=ke[0];return ct.type===H.PU.geo&&ct!==Le.field&&ct!==$e.field?ke[0]=(0,Xo.RA)(ct,Xe):ke.unshift(Xe),{...Re,fields:ke}}return Re})}return _.map(ve=>{let Re=(0,Fr.FM)(ve,ie);if(Re.field){if(Y.action===za.dy.Modify){switch(Y.modify?.op){case za.YD.AsLine:let $e=Re.field.name;return(!$e||$e==="Point")&&($e="Line"),{...ve,length:1,fields:[{...Re.field,name:$e,type:H.PU.geo,values:[(0,vo.tt)(Re.field)]}]}}return ve}const Le=Re.derived?[Re.field,...ve.fields]:ve.fields.slice(0);if(Y.action===za.dy.Calculate&&(Le.push((0,vo.pp)(Re.field,Y.calculate??{})),Re.derived=!0),Re.derived)return{...ve,fields:Le}}return ve})}const No=(_,Y)=>{const ie=Y.options??{};_.addSelect({path:"action",name:"Action",description:"",defaultValue:za.dy.Prepare,settings:{options:[{value:za.dy.Prepare,label:"Prepare spatial field",description:"Set a geometry field based on the results of other fields"},{value:za.dy.Calculate,label:"Calculate value",description:"Use the geometry to define a new field (heading/distance/area)"},{value:za.dy.Modify,label:"Transform",description:"Apply spatial operations to the geometry"}]}}),ie.action===za.dy.Calculate?_.addSelect({path:"calculate.calc",name:"Function",description:"",defaultValue:za.kD.Heading,settings:{options:[{value:za.kD.Heading,label:"Heading"},{value:za.kD.Area,label:"Area"},{value:za.kD.Distance,label:"Distance"}]}}):ie.action===za.dy.Modify&&_.addSelect({path:"modify.op",name:"Operation",description:"",defaultValue:za.YD.AsLine,settings:{options:[{value:za.YD.AsLine,label:"As line",description:"Create a single line feature with a vertex at each row"},{value:za.YD.LineBuilder,label:"Line builder",description:"Create a line between two points"}]}}),_o(ie)?(_.addNestedOptions({category:["Source"],path:"source",build:(ve,Re)=>{const Le=ie.source??{mode:Zo.aG.Auto};(0,mo.G)("Point","",ve,Le)}}),_.addNestedOptions({category:["Target"],path:"modify",build:(ve,Re)=>{const Le=ie.modify?.target??{mode:Zo.aG.Auto};(0,mo.G)("Point","target.",ve,Le)}})):(0,mo.G)("Location","source.",_,ie.source)},pi=_=>{(0,c.useEffect)(()=>{if(!_.options.source?.mode){const ve=ot(No);_.onChange({...ve,..._.options}),console.log("geometry useEffect",ve)}},[]);const Y=mi((0,De.$j)()),ie=tt(_,No);return(0,N.jsxs)("div",{children:[(0,N.jsx)("div",{children:ie.items.map(ve=>ve.render())}),(0,N.jsx)("div",{children:ie.categories.map(ve=>(0,N.jsxs)("div",{className:Y.wrap,children:[(0,N.jsx)("h5",{children:ve.props.title}),(0,N.jsx)("div",{className:Y.item,children:ve.items.map(Re=>Re.render())})]},ve.props.id))})]})},mi=_=>({wrap:(0,ft.css)`
      margin-bottom: 20px;
    `,item:(0,ft.css)`
      border-left: 4px solid ${_.colors.border.strong};
      padding-left: 10px;
    `}),vi={id:Z.F.spatial,editor:pi,transformation:Uo,name:Uo.name,description:Uo.description,state:he.pn.alpha,categories:new Set([p.m.PerformSpatialOperations]),help:re(Z.F.spatial).helperDocs};var yo=e(19845);const so={id:Z.F.timeSeriesTable,name:"Time series to table",description:"Convert time series data to table rows so that they can be viewed in tabular or sparkline format.",defaultOptions:{},isApplicable:_=>{for(const Y of _)if((0,yo.aH)(Y))return $n.M.Applicable;return $n.M.NotApplicable},isApplicableDescription:"The Time series to table transformation requires at least one time series frame to function. You currently have none.",operator:_=>Y=>Y.pipe((0,mt.T)(ie=>xt(_,ie)))};function xt(_,Y){const ie={},ve={},Re=[];let Le=At(Y);for(const $e of Object.keys(Le)){const ke=Y.filter(ct=>ct.refId===$e);ie[$e]={},ve[$e]={};const Xe=[];ke.forEach(ct=>{ct.fields.forEach(pt=>{pt.type===H.PU.number&&pt.labels&&Object.keys(pt.labels).forEach(Ct=>{Xe.includes(Ct)||(ve[$e][Ct]=Et(Ct,H.PU.string),Xe.push(Ct))})})});for(let ct=0;ct<ke.length;ct++){const pt=ke[ct];let Ct=null,Ft=_[$e]?.timeField;if(Ft&&Ft.length>0?Ct=pt.fields.find(Ot=>Ot.name===Ft):Ct=pt.fields.find(Ot=>(0,yo.hF)(Ot)),!(0,yo.aH)(pt)){Re.push(pt);continue}for(const Ot of pt.fields){if(Ot.type!==H.PU.number)continue;const jt=_[$e]?.stat??Oe.gy.lastNotNull,Rt=(0,Oe.Nw)({field:Ot,reducers:[jt]})[jt]??null,Mn=new en.k;Ct!==void 0&&(Mn.addField(Ct),Mn.addField(Ot),ie[$e][`Trend #${$e}`]===void 0&&(ie[$e][`Trend #${$e}`]=Et(`Trend #${$e}`,H.PU.frame)),ie[$e][`Trend #${$e}`].values.push({...Mn,value:Rt,length:Ot.values.length})),Xe.forEach(Ws=>{ve[$e][Ws].values.push(Ot.labels?.[Ws]??"")})}}}for(const $e of Object.keys(Le)){const ke={},Xe=new en.k;Xe.refId=$e;const ct=ve[$e];if(ct!==void 0)for(const[Ct,Ft]of Object.entries(ct))ke[Ct]===void 0&&(ke[Ct]=Ft);for(const Ct of Object.values(ke))Xe.addField(Ct);const pt=ie[$e];for(const Ct of Object.values(pt))Xe.addField(Ct);Xe.fields.length>0&&Re.push(Xe)}return Re}function Et(_,Y){return{name:_,type:Y,config:{},values:[]}}function At(_){let Y={};for(const ie of _)ie.refId!==void 0&&(Y[ie.refId]===void 0?Y[ie.refId]=1:Y[ie.refId]++);return Y}function Jt({input:_,options:Y,onChange:ie}){const ve=At(_),Re=(0,c.useCallback)((ke,Xe)=>{const ct=Xe?.value!==void 0?Xe.value:"";ie({...Y,[ke]:{...Y[ke],timeField:ct}})},[ie,Y]),Le=(0,c.useCallback)((ke,Xe)=>{const ct=Xe[0];ct&&(0,Oe.Em)(ct)&&ie({...Y,[ke]:{...Y[ke],stat:ct}})},[ie,Y]);let $e=[];for(const ke of Object.keys(ve)){const Xe={},ct=[];for(const pt of _)if(pt.refId===ke)for(const Ct of pt.fields)(0,yo.hF)(Ct)&&(Xe[Ct.name]=Ct);for(const pt of Object.values(Xe)){const{name:Ct}=pt;ct.push({label:Ct,value:Ct})}$e.push((0,N.jsxs)(oe.C,{children:[(0,N.jsx)(k.I,{children:(0,N.jsx)(we.c,{children:`Trend #${ke}`})}),(0,N.jsx)(k.I,{label:"Time field",tooltip:"The time field that will be used for the time series. If not selected the first found will be used.",children:(0,N.jsx)(J.l6,{onChange:Re.bind(null,ke),options:ct,value:Y[ke]?.timeField,isClearable:!0})}),(0,N.jsx)(k.I,{label:"Stat",tooltip:"The statistic that should be calculated for this time series.",children:(0,N.jsx)(Ye.S,{stats:[Y[ke]?.stat??Oe.gy.lastNotNull],onChange:Le.bind(null,ke),filterOptions:pt=>pt.id!==Oe.gy.allValues&&pt.id!==Oe.gy.uniqueValues})})]},ke))}return(0,N.jsx)(N.Fragment,{children:$e})}const Xt={id:so.id,editor:Jt,transformation:so,name:so.name,description:so.description,state:he.pn.beta,help:re(so.id).helperDocs},$t=()=>[Ts,vn,Ds,Kn,Fe,Wn,Qs,ks,Ks,cs,Ca,oa,ja,st,ws,fi,fn,Zs,vt,vi,qr,Ur,ht,Vn,nr,pr,Vt,...z.$.featureToggles.formatString?[Dt]:[],...z.$.featureToggles.regressionTransformation?[Bo]:[],...z.$.featureToggles.groupToNestedTableTransformation?[Fn]:[],Bn,Xt,Lr];var gn=e(22051),mn=e(85957),Tn=e(28138),Dn=e(70944),kn=e(79648),Us=e(72798),ls=e(21780);function Ns({actions:_,children:Y,info:ie,pageNav:ve,layout:Re,renderTitle:Le,subTitle:$e}){const ke=(0,c.useContext)(Us.A);return(0,N.jsx)(ls.YW,{navModel:ke.sectionNav,pageNav:ve,layout:Re,actions:_,renderTitle:Le,info:ie,subTitle:$e,children:(0,N.jsx)(ls.YW.Contents,{children:Y})})}var xa=e(76888),Oa=e(8867),ia=e(91324),rr=e(23227),Qa=e(83712),or=e(93455),Ya=e(99443),vr=e(70699),aa=e(63997),_n=e(5798),ra=e(61061),ns=e(85346),ga=e(41731),da=e(36294),pa=e(62575),ua=e(27798),Sa=e(53392),Ba=e(17694),hr=e(27743),sr=e(66509),Sr=e(98368),yr=e(67341),xo=e(51472),Wa=e(90517),xr=e(78412),fr=e(24548),ka=e(41366),ir=e(63892),lr=e(53927),Er=e(22965),Pr=e(19336),Eo=e(66163),Kr=e(30259),Wo=e(96725),ao=e(30283),wr=e(53141),qo=e(69382),ei=e(88790),$r=e(388),Vr=e(58689),Tl=e(29342),Sl=e(27583),Ml=e(34153),Ol=e(13852),Al=e(5614),Il=e(34715),Rl=e(25853),Ll=e(98020),jl=e(90088),Bl=e(79764),Ul=e(5422),Nl=e(61987),Wl=e(88225),Fl=e(13896),Kl=e(68018),wl=e(63023),$l=e(32437),Vl=e(99996),zl=e(99641),Hl=e(70649),Gl=e(98828),Ql=e(79151),kl=e(53663),Yl=e(27193),Jl=e(53123),Zl=e(4458),Xl=e(28643),_l=e(33311),ql=e(90841),ec=e(49018),tc=e(63738),nc=e(63263),sc=e(29340),ac=e(45937),rc=e(29339),oc=e(6820),ic=e(77444),lc=e(3327),cc=e(70794),dc=e(11273),uc=e(80641),hc=e(28867),fc=e(11220),gc=e(23544),pc=e(48339),mc=e(4240),vc=e(95224),yc=e(82382),xc=e(87048),Ec=e(53007),Pc=e(12179),Dc=e(17226),Cc=e(42982),bc=e(42806),Tc=e(50459),Sc=e(84879),Mc=e(52664),Oc=e(26868),Ac=e(72805),Ic=e(73575),Rc=e(56811),Lc=e(53896),jc=e(97918),Bc=e(81422),Uc=e(29130),Nc=e(45376),Wc=e(73642),Fc=e(83267),Kc=e(80021),wc=e(41684),$c=e(72215),Vc=e(81656),zc=e(29424),Hc=e(7682),Gc=e(51764),Qc=e(76151),kc=e(30781),Yc=e(65972),Jc=e(90756),Zc=e(24289),Xc=e(84472),_c=e(71533),qc=e(45298),ed=e(96906),td=e(95311),nd=e(82349),sd=e(21101),ad=e(72316),rd=e(48761),od=e(97231),id=e(13835),ld=e(91381),cd=e(52859),dd=e(25928),ud=e(36714),hd=e(30815),fd=e(3465),gd=e(39012),pd=e(94675),md=e(40051),vd=e(4543),yd=e(89579),xd=e(82524),Ed=e(31115),Pd=e(99003),Dd=e(95684),Cd=e(1624),bd=e(93644),Td=e(96619),Sd=e(61748),Md=e(57169),Od=e(11769),Ad=e(26551),Id=e(40295),Rd=e(38514),Ld=e(81312),jd=e(64298),Bd=e(70866),Ud=e(30587),Nd=e(44850),Wd=e(54556),Fd=e(81615),Kd=e(82798),wd=e(8687),$d=e(77270),Vd=e(10742),zd=e(41404),Hd=e(72579),Gd=e(39973),Qd=e(56963),kd=e(8807),Yd=e(24109),Jd=e(46255),Zd=e(68636),Xd=e(74305),_d=e(21391);let Wi=!1;function Ht(_,Y){Oa.cacheStore[Y]={content:_,status:"loaded"}}function qd(){let _="public/img/icons/";const Y=typeof window<"u"&&window.__grafana_public_path__;return Y&&(_=Y+"img/icons/"),ie=>_+ie}function eu(){if(Wi)return;Wi=!0;const _=qd();Ht(ia,_("unicons/at.svg")),Ht(rr,_("unicons/adjust-circle.svg")),Ht(Qa,_("unicons/align-left.svg")),Ht(or,_("unicons/align-right.svg")),Ht(Ya,_("unicons/angle-double-down.svg")),Ht(vr,_("unicons/angle-double-right.svg")),Ht(aa,_("unicons/angle-down.svg")),Ht(_n,_("unicons/angle-left.svg")),Ht(ra,_("unicons/angle-right.svg")),Ht(ns,_("unicons/angle-up.svg")),Ht(ga,_("unicons/apps.svg")),Ht(da,_("unicons/arrow.svg")),Ht(pa,_("unicons/arrow-down.svg")),Ht(ua,_("unicons/arrow-from-right.svg")),Ht(Sa,_("unicons/arrow-left.svg")),Ht(Ba,_("unicons/arrow-random.svg")),Ht(hr,_("unicons/arrow-right.svg")),Ht(sr,_("unicons/arrow-to-right.svg")),Ht(Sr,_("unicons/arrow-up.svg")),Ht(yr,_("unicons/arrows-h.svg")),Ht(xo,_("unicons/backward.svg")),Ht(Wa,_("unicons/bars.svg")),Ht(xr,_("unicons/bell.svg")),Ht(fr,_("unicons/bell-slash.svg")),Ht(ka,_("unicons/bolt.svg")),Ht(ir,_("unicons/book.svg")),Ht(lr,_("unicons/bookmark.svg")),Ht(Er,_("unicons/book-open.svg")),Ht(Pr,_("unicons/brackets-curly.svg")),Ht(Eo,_("unicons/bug.svg")),Ht(Kr,_("unicons/building.svg")),Ht(Wo,_("unicons/calculator-alt.svg")),Ht(ao,_("unicons/calendar-alt.svg")),Ht(wr,_("unicons/calendar-slash.svg")),Ht(qo,_("unicons/camera.svg")),Ht(ei,_("unicons/channel-add.svg")),Ht($r,_("unicons/chart-line.svg")),Ht(Vr,_("unicons/check.svg")),Ht(Tl,_("unicons/check-circle.svg")),Ht(Sl,_("unicons/circle.svg")),Ht(Ml,_("unicons/clipboard-alt.svg")),Ht(Ol,_("unicons/clock-nine.svg")),Ht(Al,_("unicons/cloud.svg")),Ht(Il,_("unicons/cloud-download.svg")),Ht(Rl,_("unicons/code-branch.svg")),Ht(Ll,_("unicons/cog.svg")),Ht(jl,_("unicons/columns.svg")),Ht(Bl,_("unicons/comment-alt.svg")),Ht(Ul,_("unicons/comment-alt-share.svg")),Ht(Nl,_("unicons/comments-alt.svg")),Ht(Wl,_("unicons/compass.svg")),Ht(Fl,_("unicons/copy.svg")),Ht(Kl,_("unicons/corner-down-right-alt.svg")),Ht(wl,_("unicons/cube.svg")),Ht($l,_("unicons/dashboard.svg")),Ht(Vl,_("unicons/database.svg")),Ht(zl,_("unicons/document-info.svg")),Ht(Hl,_("unicons/download-alt.svg")),Ht(Gl,_("unicons/draggabledots.svg")),Ht(Ql,_("unicons/edit.svg")),Ht(kl,_("unicons/ellipsis-v.svg")),Ht(Yl,_("unicons/ellipsis-h.svg")),Ht(Jl,_("unicons/envelope.svg")),Ht(Zl,_("unicons/exchange-alt.svg")),Ht(Xl,_("unicons/exclamation-circle.svg")),Ht(_l,_("unicons/exclamation-triangle.svg")),Ht(ql,_("unicons/external-link-alt.svg")),Ht(ec,_("unicons/eye.svg")),Ht(tc,_("unicons/eye-slash.svg")),Ht(nc,_("unicons/file-alt.svg")),Ht(sc,_("unicons/file-blank.svg")),Ht(ac,_("unicons/filter.svg")),Ht(rc,_("unicons/folder.svg")),Ht(oc,_("unicons/folder-open.svg")),Ht(ic,_("unicons/folder-plus.svg")),Ht(lc,_("unicons/folder-upload.svg")),Ht(cc,_("unicons/forward.svg")),Ht(dc,_("unicons/graph-bar.svg")),Ht(uc,_("unicons/history.svg")),Ht(hc,_("unicons/history-alt.svg")),Ht(fc,_("unicons/home-alt.svg")),Ht(gc,_("unicons/import.svg")),Ht(pc,_("unicons/info.svg")),Ht(mc,_("unicons/info-circle.svg")),Ht(vc,_("unicons/k6.svg")),Ht(yc,_("unicons/key-skeleton-alt.svg")),Ht(xc,_("unicons/keyboard.svg")),Ht(Ec,_("unicons/link.svg")),Ht(Pc,_("unicons/list-ul.svg")),Ht(Dc,_("unicons/lock.svg")),Ht(Cc,_("unicons/minus.svg")),Ht(bc,_("unicons/minus-circle.svg")),Ht(Tc,_("unicons/mobile-android.svg")),Ht(Sc,_("unicons/monitor.svg")),Ht(Mc,_("unicons/pause.svg")),Ht(Oc,_("unicons/pen.svg")),Ht(Ac,_("unicons/play.svg")),Ht(Ic,_("unicons/plug.svg")),Ht(Rc,_("unicons/plus.svg")),Ht(Lc,_("unicons/plus-circle.svg")),Ht(jc,_("unicons/power.svg")),Ht(Bc,_("unicons/presentation-play.svg")),Ht(Uc,_("unicons/process.svg")),Ht(Nc,_("unicons/question-circle.svg")),Ht(Wc,_("unicons/repeat.svg")),Ht(Fc,_("unicons/rocket.svg")),Ht(Kc,_("unicons/rss.svg")),Ht(wc,_("unicons/save.svg")),Ht($c,_("unicons/search.svg")),Ht(Vc,_("unicons/search-minus.svg")),Ht(zc,_("unicons/search-plus.svg")),Ht(Hc,_("unicons/share-alt.svg")),Ht(Gc,_("unicons/shield.svg")),Ht(Qc,_("unicons/signal.svg")),Ht(kc,_("unicons/signin.svg")),Ht(Yc,_("unicons/signout.svg")),Ht(Jc,_("unicons/sitemap.svg")),Ht(Zc,_("unicons/slack.svg")),Ht(Xc,_("unicons/sliders-v-alt.svg")),Ht(_c,_("unicons/sort-amount-down.svg")),Ht(qc,_("unicons/sort-amount-up.svg")),Ht(ed,_("unicons/square-shape.svg")),Ht(td,_("unicons/star.svg")),Ht(nd,_("unicons/step-backward.svg")),Ht(sd,_("unicons/sync.svg")),Ht(ad,_("unicons/stopwatch.svg")),Ht(rd,_("unicons/table.svg")),Ht(od,_("unicons/tag-alt.svg")),Ht(id,_("unicons/times.svg")),Ht(ld,_("unicons/trash-alt.svg")),Ht(cd,_("unicons/unlock.svg")),Ht(dd,_("unicons/upload.svg")),Ht(ud,_("unicons/user.svg")),Ht(hd,_("unicons/users-alt.svg")),Ht(fd,_("unicons/wrap-text.svg")),Ht(gd,_("unicons/cloud-upload.svg")),Ht(pd,_("unicons/credit-card.svg")),Ht(md,_("unicons/file-copy-alt.svg")),Ht(vd,_("unicons/fire.svg")),Ht(yd,_("unicons/hourglass.svg")),Ht(xd,_("unicons/layer-group.svg")),Ht(Ed,_("unicons/layers-alt.svg")),Ht(Pd,_("unicons/line-alt.svg")),Ht(Dd,_("unicons/list-ui-alt.svg")),Ht(Cd,_("unicons/message.svg")),Ht(bd,_("unicons/palette.svg")),Ht(Td,_("unicons/percentage.svg")),Ht(Sd,_("unicons/shield-exclamation.svg")),Ht(Md,_("unicons/plus-square.svg")),Ht(Od,_("unicons/x.svg")),Ht(Ad,_("unicons/capture.svg")),Ht(Id,_("custom/gf-grid.svg")),Ht(Rd,_("custom/gf-landscape.svg")),Ht(Ld,_("custom/gf-layout-simple.svg")),Ht(jd,_("custom/gf-portrait.svg")),Ht(Bd,_("custom/gf-show-context.svg")),Ht(Ud,_("custom/gf-bar-alignment-after.svg")),Ht(Nd,_("custom/gf-bar-alignment-before.svg")),Ht(Wd,_("custom/gf-bar-alignment-center.svg")),Ht(Fd,_("custom/gf-interpolation-linear.svg")),Ht(Kd,_("custom/gf-interpolation-smooth.svg")),Ht(wd,_("custom/gf-interpolation-step-after.svg")),Ht($d,_("custom/gf-interpolation-step-before.svg")),Ht(Vd,_("custom/gf-logs.svg")),Ht(zd,_("custom/gf-movepane-left.svg")),Ht(Hd,_("custom/gf-movepane-right.svg")),Ht(Gd,_("mono/favorite.svg")),Ht(Qd,_("mono/grafana.svg")),Ht(kd,_("mono/heart.svg")),Ht(Yd,_("mono/heart-break.svg")),Ht(Jd,_("mono/panel-add.svg")),Ht(Zd,_("mono/library-panel.svg")),Ht(Xd,_("unicons/record-audio.svg")),Ht(_d,_("solid/bookmark.svg"))}var zr=e(8484),tu=e(47129),nu=e(76885);function su(_){const Y=_.target instanceof Element&&au(_.target);if(!(_.ctrlKey||_.metaKey||_.defaultPrevented)&&Y){let ie=Y.getAttribute("href");const ve=Y.getAttribute("target");if(ie&&!ve){const Re=nu.kM.parseKeyValue(ie.split("?")[1]),Le=Re.orgId&&Number(Re.orgId)!==V.$W.bootData.user.orgId;if((0,P.Lc)("utils",!1,"intercepting link click",_),_.preventDefault(),ie=y.I.stripBaseFromUrl(ie),ie[0]!=="/"||Le)if(ie.indexOf("://")>0||ie.indexOf("mailto:")===0||Le){window.location.href=ie;return}else if(ie.indexOf("#")===0){window.location.hash=ie;return}else ie=`/${ie}`;P.Ny.push(ie)}}}function au(_){for(;_!==null&&_.tagName;){if(_.tagName.toUpperCase()==="A")return _;_=_.parentElement}return null}var Fi=e(78731),yi=e(14110),ru=e(2609);class ou{constructor(Y){this.hasUpdates=!1,this.checked=Date.now(),this.prevLocationPath="",this.interval=Y??1e3*60*5}start(){const Y=(0,Fi.oF)();Y&&Y.getConnectionState().subscribe(ie=>{ie&&this._checkForUpdates()}),P.Ny.getHistory().listen(this.locationUpdated.bind(this)),this.prevLocationPath=P.Ny.getLocation().pathname}locationUpdated(Y){if(this.prevLocationPath===Y.pathname)return;const ie=Y.pathname.split("/");ie[1]==="/"&&this.prevLocationPath!=="/"?this.reloadIfUpdateDetected():ie[1]==="d"&&!ru._o.state.isPlaying?this.reloadIfUpdateDetected():this.hasUpdates&&(0,yi.rR)("new_frontend_assets_reload_ignored",{newLocation:Y.pathname,prevLocation:this.prevLocationPath}),this.prevLocationPath=Y.pathname}async _checkForUpdates(){if(this.hasUpdates||Date.now()-this.checked<this.interval)return;this.checked=Date.now();const Y=this.previous,ie=await(0,x.AI)().get("/api/frontend/assets");Y&&!(0,l.isEqual)(Y,ie)&&(this.hasUpdates=!0,(0,yi.rR)("new_frontend_assets_detected",{assets:Y.assets!==ie.assets,plugins:Y.plugins!==ie.plugins,version:Y.version!==ie.version,flags:Y.flags!==ie.flags})),this.previous=ie}reloadIfUpdateDetected(){this.hasUpdates&&((0,yi.rR)("new_frontend_assets_reload",{}),window.location.reload()),this._checkForUpdates()}}var xi=e(27677),Dr=e(16233),iu=e(91040),lu=e(40621);function Ei(_,Y=!1){return new Promise(ie=>{const ve=document.createElement("script");ve.onload=ie,ve.src=_,ve.async=Y,document.head.appendChild(ve)})}const Ki=(0,iu.h)("EchoSrv"),wi=Ki.logger;(0,lu.h)("echo",void 0,Ki);class cu{constructor(Y){this.config={flushInterval:1e4,debug:!1},this.backends=[],this.flush=()=>{for(const ie of this.backends)ie.flush()},this.addBackend=ie=>{wi("Adding backend",!1,ie),this.backends.push(ie)},this.addEvent=(ie,ve)=>{const Re=this.getMeta(),Le={...ie,meta:{...Re,...ve}};for(const $e of this.backends)($e.supportedEvents.length===0||$e.supportedEvents.indexOf(Le.type)>-1)&&$e.addEvent(Le);wi(`${ie.type} event`,!1,{...ie.payload,meta:Le.meta})},this.getMeta=()=>({sessionId:"",userId:Dr.TP.user.id,userLogin:Dr.TP.user.login,userSignedIn:Dr.TP.user.isSignedIn,screenSize:{width:window.innerWidth,height:window.innerHeight},windowSize:{width:window.screen.width,height:window.screen.height},userAgent:window.navigator.userAgent,ts:new Date().getTime(),timeSinceNavigationStart:performance.now(),path:window.location.pathname,url:window.location.href}),this.config={...this.config,...Y},setInterval(this.flush,this.config.flushInterval)}}var du=e(42614);class uu{constructor(Y){this.options=Y,this.buffer=[],this.supportedEvents=[K.on.Performance],this.addEvent=ie=>{this.buffer.push(ie.payload)},this.flush=()=>{this.buffer.length!==0&&(xi.IB.post("/api/frontend-metrics",{events:this.buffer},{showErrorAlert:!1}).catch(()=>{}),this.buffer=[])}}}var Fo=e(61298);class hu{constructor(Y){this.options=Y,this.supportedEvents=[K.on.Pageview,K.on.Interaction],this.addEvent=Re=>{window.applicationInsights&&((0,Fo.nB)(Re)&&window.applicationInsights.trackPageView?.(),(0,Fo.fX)(Re)&&window.applicationInsights.trackEvent?.({name:Re.payload.interactionName,properties:Re.payload.properties}))},this.flush=()=>{};const ie={config:{connectionString:Y.connectionString,endpointUrl:Y.endpointUrl}};System.import("https://js.monitor.azure.com/scripts/b/ai.2.min.js").then(Re=>Re.default?Re.default:Re).then(({ApplicationInsights:Re})=>{const Le=new Re(ie);window.applicationInsights=Le.loadAppInsights()})}}class fu{constructor(Y){this.options=Y,this.supportedEvents=[K.on.Pageview],this.googleAnalytics4SendManualPageViews=!1,this.addEvent=Re=>{window.gtag&&this.googleAnalytics4SendManualPageViews&&window.gtag("event","page_view",{page_path:Re.payload.page})},this.flush=()=>{};const ie=`https://www.googletagmanager.com/gtag/js?id=${Y.googleAnalyticsId}`;Ei(ie,!0),window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},window.gtag("js",new Date);const ve={page_path:window.location.pathname};Y.user&&(ve.user_id=Y.user.analytics.identifier),this.googleAnalytics4SendManualPageViews=Y.googleAnalytics4SendManualPageViews,window.gtag("config",Y.googleAnalyticsId,ve)}}class gu{constructor(Y){this.options=Y,this.supportedEvents=[K.on.Pageview],this.trackedUserId=null,this.addEvent=Re=>{if(!window.ga)return;window.ga("set",{page:Re.payload.page}),window.ga("send","pageview");const{userSignedIn:Le,userId:$e}=Re.meta;Le&&$e!==this.trackedUserId&&(this.trackedUserId=$e,window.ga("set","userId",$e))},this.flush=()=>{};const ie=`https://www.google-analytics.com/analytics${Y.debug?"_debug":""}.js`;Ei(ie);const ve=window.ga=window.ga||function(){(ve.q=ve.q||[]).push(arguments)};ve.l=+new Date,ve("create",Y.googleAnalyticsId,"auto"),ve("set","anonymizeIp",!0)}}class pu{constructor(Y){this.options=Y,this.supportedEvents=[K.on.Pageview,K.on.Interaction,K.on.ExperimentView],this.addEvent=Le=>{window.rudderanalytics&&((0,Fo.nB)(Le)&&window.rudderanalytics.page?.(),(0,Fo.fX)(Le)&&window.rudderanalytics.track?.(Le.payload.interactionName,Le.payload.properties),(0,Fo.p6)(Le)&&window.rudderanalytics.track?.("experiment_viewed",{experiment_id:Le.payload.experimentId,experiment_group:Le.payload.experimentGroup,experiment_variant:Le.payload.experimentVariant}))},this.flush=()=>{};const ie=Y.sdkUrl||"https://cdn.rudderlabs.com/v1/rudder-analytics.min.js";Ei(ie);const ve=window.rudderanalytics=[],Re=["load","page","track","identify","alias","group","ready","reset","getAnonymousId","setAnonymousId"];for(let Le=0;Le<Re.length;Le++){const $e=Re[Le];ve[$e]=function(ke){return function(){ve.push([ke].concat(Array.prototype.slice.call(arguments)))}}($e)}if(window.rudderanalytics?.load?.(Y.writeKey,Y.dataPlaneUrl,{configUrl:Y.configUrl,destSDKBaseURL:Y.integrationsUrl}),Y.user){const{identifier:Le,intercomIdentifier:$e}=Y.user.analytics,ke={};$e&&(ke.Intercom={user_hash:$e}),window.rudderanalytics?.identify?.(Le,{email:Y.user.email,orgId:Y.user.orgId,language:Y.user.language,version:Y.buildInfo.version,edition:Y.buildInfo.edition},ke)}}}var mu=e(13515),vu=e(88285),yu=e(74940),xu=e(36043),Eu=e(19439),Pu=e(68738),Du=e(83946),Cu=e(83824),bu=e(20467);class Tu extends bu.j{constructor(){super(...arguments),this.name="EchoSrvTransport",this.version=z.$.buildInfo.version}send(Y){(0,K.x$)().addEvent({type:K.on.GrafanaJavascriptAgent,payload:Y})}isBatched(){return!0}getIgnoreUrls(){return[]}}class Su{constructor(Y){this.options=Y,this.supportedEvents=[K.on.GrafanaJavascriptAgent],this.addEvent=Le=>{},this.flush=()=>{};const ie=[],ve=[new Tu];Y.customEndpoint&&ve.push(new vu.m({url:Y.customEndpoint,apiKey:Y.apiKey})),Y.errorInstrumentalizationEnabled&&ie.push(new yu.W),Y.consoleInstrumentalizationEnabled&&ie.push(new xu._),Y.webVitalsInstrumentalizationEnabled&&ie.push(new Eu.I),Y.tracingInstrumentalizationEnabled&&ie.push(new Cu.v),ie.push(new Pu.D);const Re={globalObjectKey:Y.globalObjectKey||"faro",preventGlobalExposure:Y.preventGlobalExposure||!1,app:{name:"grafana-frontend",version:Y.buildInfo.version,environment:Y.buildInfo.env},instrumentations:ie,transports:ve,ignoreErrors:["ResizeObserver loop limit exceeded","ResizeObserver loop completed","Non-Error exception captured with keys"],ignoreUrls:[new RegExp(`/*${Y.customEndpoint}/`),/frontend-metrics/],sessionTracking:{persistent:!0},batching:{sendTimeout:1e3},internalLoggerLevel:Y.internalLoggerLevel||mu.vI};this.faroInstance=(0,Du.p)(Re),Y.user&&this.faroInstance.api.setUser({id:Y.user.id,attributes:{orgId:String(Y.user.orgId)||""}})}}var Mu=e(69129),Ou=e(26272),Au=e(87490),Iu=e(70497),Ru=e(1702),ro=e(74856),Cr=e(28444),Lu=e(93522),Pi=e(10096),ti=e(4898),$i=e(2769);class ju{constructor(Y,ie){this.locationService=Y,this.chromeService=ie,this.panelId=null,Tn.A.subscribe(Mu.Tp,ve=>{this.panelId=ve.payload.panelId})}clearAndInitGlobalBindings(Y){ti.R.reset(),Y.chromeless||(this.bind("?",this.showHelpModal),this.bind("g h",this.goToHome),this.bind("g d",this.goToDashboards),this.bind("g e",this.goToExplore),this.bind("g a",this.openAlerting),this.bind("g p",this.goToProfile),this.bind("esc",this.exit),this.bindGlobalEsc()),this.bind("c t",()=>(0,$i.O)(!1)),this.bind("c r",()=>(0,$i.O)(!0))}bindGlobalEsc(){this.bindGlobal("esc",this.globalEsc)}globalEsc(){const ie=document.activeElement;if(!(document.querySelectorAll(".slate-typeahead--open").length>0)){if(ie&&ie instanceof HTMLElement&&(ie.nodeName==="INPUT"||ie.nodeName==="TEXTAREA"||ie.hasAttribute("data-slate-editor"))){ie.blur();return}this.exit()}}closeSearch(){this.locationService.partial({search:null})}openAlerting(){this.locationService.push("/alerting")}goToDashboards(){this.locationService.push("/dashboards")}goToHome(){this.locationService.push("/")}goToProfile(){this.locationService.push("/profile")}goToExplore(){this.locationService.push("/explore")}showHelpModal(){Tn.A.publish(new Cr.S8({component:Lu.N}))}exit(){const Y=this.locationService.getSearchObject();if(Y.editview){this.locationService.partial({editview:null,editIndex:null});return}if(Y.inspect){this.locationService.partial({inspect:null,inspectTab:null});return}if(Y.editPanel){this.locationService.partial({editPanel:null,tab:null});return}if(Y.viewPanel){this.locationService.partial({viewPanel:null,tab:null});return}const{kioskMode:ie}=this.chromeService.state.getValue();ie&&this.chromeService.exitKioskMode(),Y.search&&this.closeSearch()}showDashEditView(){this.locationService.partial({editview:"settings"})}bind(Y,ie){ti.R.bind(Y,ve=>{ve.preventDefault(),ve.stopPropagation(),ve.returnValue=!1,ie.call(this)},"keydown")}bindGlobal(Y,ie){ti.R.bindGlobal(Y,ve=>{ve.preventDefault(),ve.stopPropagation(),ve.returnValue=!1,ie.call(this)},"keydown")}unbind(Y,ie){ti.R.unbind(Y,ie)}bindWithPanelId(Y,ie){this.bind(Y,this.withFocusedPanel(ie))}withFocusedPanel(Y){return()=>{if(typeof this.panelId=="number"){Y(this.panelId);return}}}setupTimeRangeBindings(Y=!0){this.bind("t a",()=>{Tn.A.publish(new Cr.Rh({updateUrl:Y}))}),this.bind("t z",()=>{Tn.A.publish(new Cr.U0({scale:2,updateUrl:Y}))}),this.bind("ctrl+z",()=>{Tn.A.publish(new Cr.U0({scale:2,updateUrl:Y}))}),this.bind("t left",()=>{Tn.A.publish(new Cr.Io({direction:Cr.xL.Left,updateUrl:Y}))}),this.bind("t right",()=>{Tn.A.publish(new Cr.Io({direction:Cr.xL.Right,updateUrl:Y}))}),this.bind("t c",()=>{Tn.A.publish(new Cr.Bt)}),this.bind("t v",()=>{Tn.A.publish(new Cr.VZ({updateUrl:Y}))})}setupDashboardBindings(Y){this.bind("mod+o",()=>{Y.graphTooltip=(Y.graphTooltip+1)%3,Y.events.publish(new Ou.Tq),Y.startRefresh()}),this.bind("mod+s",()=>{Y.meta.canSave&&Tn.A.publish(new Cr.S8({component:Iu.$,props:{dashboard:Y}}))}),this.setupTimeRangeBindings(),this.bindWithPanelId("e",ie=>{if(Y.canEditPanelById(ie)){const ve=this.locationService.getSearchObject().editPanel!==void 0;this.locationService.partial({editPanel:ve?null:ie})}}),this.bindWithPanelId("v",ie=>{const ve=this.locationService.getSearchObject().viewPanel!==void 0;this.locationService.partial({viewPanel:ve?null:ie})}),this.bindWithPanelId("p l",ie=>{const ve=Y.getPanelById(ie),Re={...ve.options};Re.legend.showLegend?Re.legend.showLegend=!1:Re.legend.showLegend=!0,ve.updateOptions(Re)}),this.bindWithPanelId("i",ie=>{this.locationService.partial({inspect:ie})}),Pi.TP.hasAccessToExplore()&&this.bindWithPanelId("p x",async ie=>{const ve=Y.getPanelById(ie),Re=await(0,Au.Xe)({queries:ve.targets,dsRef:ve.datasource,scopedVars:ve.scopedVars,timeRange:(0,ro.jG)().timeRange()});if(Re){const Le=y.I.stripBaseFromUrl(Re);Le&&this.locationService.push(Le)}}),this.bindWithPanelId("p r",ie=>{Y.canEditPanelById(ie)&&!(Y.panelInView||Y.panelInEdit)&&Tn.A.publish(new Cr.Vz(ie))}),this.bindWithPanelId("p d",ie=>{if(Y.canEditPanelById(ie)){const ve=Y.getPanelInfoById(ie).index;Y.duplicatePanel(Y.panels[ve])}}),this.bindWithPanelId("p s",ie=>{const ve=Y.getPanelInfoById(ie);Tn.A.publish(new Cr.S8({component:Ru.ShareModal,props:{dashboard:Y,panel:ve?.panel}}))}),this.bind("d l",()=>{Y.toggleLegendsForAll()}),this.bind("d x",()=>{Y.toggleExemplarsForAll()}),this.bind("d shift+c",()=>{Y.collapseRows()}),this.bind("d shift+e",()=>{Y.expandRows()}),this.bind("d n",()=>{this.locationService.push("/dashboard/new")}),this.bind("d r",()=>{Y.startRefresh()}),this.bind("d s",()=>{this.showDashEditView()}),this.bind("d k",()=>{this.chromeService.onToggleKioskMode()}),this.bind("d a",()=>{const ve=this.locationService.getSearchObject().autofitpanels?"":"&autofitpanels";window.location.href=window.location.href+ve})}}var Po=e(78160);async function mp(){if(window.location.search.indexOf("why-render")!==-1){const{default:_}=await e.e(3718).then(e.t.bind(e,13718,23));_(React,{trackAllPureComponents:!0})}}var Bu=e(20120),Uu=e(75471),Nu=e(57220);const Wu=(0,c.lazy)(()=>e.e(192).then(e.bind(e,57029)));function Fu(){const _=(0,Uu.Wd)(Nu.hY),Y=z.$.unifiedAlertingEnabled;Dr.TP.hasPermission(_.read)&&(0,Bu.fP)({show:()=>Y,component:({dashboard:ie})=>Y?(0,N.jsx)(c.Suspense,{fallback:null,children:ie&&(0,N.jsx)(Wu,{dashboardUid:ie.uid})},"alert-rules-button"):null,index:-2})}var Ku=e(73399);function wu(_){return(0,N.jsx)($u,{..._})}const $u=(0,c.lazy)(async()=>{const{EmbeddedDashboard:_}=await e.e(2859).then(e.bind(e,13251));return{default:_}});var Vu=e(61582),zu=e(67027),Hu=e(97527),vp=e(99355),Ko=e(14590),Gu=e(19895),Qu=e(44838),ku=e(67278);const Yu=()=>new ku.c(new URL(e.p+e.u(5358),e.b));var Ju=e(88483),Vi=e(63720);const Zu=_=>new Ju.c(Y=>{const ie=_.subscribe(Ko.BX(ve=>{Y.next(ve)}),Ko.BX(ve=>{Y.error(ve)}),Ko.BX(()=>{Y.complete()}));return{unsubscribe:()=>{ie.then(ve=>ve.unsubscribe())}}}),Di=_=>(0,Ga.H)(_).pipe((0,Vi.n)(Y=>Zu(Y)));class Xu{constructor(Y){this.getConnectionState=()=>Di(this.centrifugeWorker.getConnectionState()),this.getDataStream=ie=>Di(this.centrifugeWorker.getDataStream(ie)).pipe((0,Gu.Q)(Qu.E)),this.getQueryData=async ie=>{const ve=JSON.parse(JSON.stringify(ie));return this.centrifugeWorker.getQueryData(ve)},this.getPresence=ie=>this.centrifugeWorker.getPresence(ie),this.getStream=ie=>Di(this.centrifugeWorker.getStream(ie)),this.centrifugeWorker=Ko.LV(Yu()),this.centrifugeWorker.initialize(Y,Ko.BX(Y.dataStreamSubscriberReadiness))}}var zi=e(9631),_u=e(55004),qu=e(47773),Hi=e(26657),ni=e(47118);class eh{constructor(Y){this.deps=Y,this.getConnectionState=()=>this.deps.centrifugeSrv.getConnectionState(),this.getDataStream=ie=>{let ve;const Re=Le=>{const $e=Le.data[0];if(!ve&&!(0,ni.ot)($e,ni._w.FullFrame)){console.warn(`expected first packet to contain a full frame, received ${$e?.type}`);return}switch($e.type){case ni._w.FullFrame:{ve=zi.k9.deserialize($e.frame);return}case ni._w.NewValuesSameSchema:{ve.pushNewValues($e.values);return}}};return this.deps.centrifugeSrv.getDataStream(ie).pipe((0,mt.T)(Le=>(Re(Le),{...Le,data:[ve??zi.k9.empty()]})))},this.getStream=ie=>this.deps.centrifugeSrv.getStream(ie),this.getQueryData=ie=>(0,Ga.H)(this.deps.centrifugeSrv.getQueryData(ie)).pipe((0,Vi.n)(ve=>{const Re=(0,qu.bE)(ve,ie.request.targets);return Re.data?.length&&Re.data.find($e=>$e.meta?.channel)?(0,Hi.x7)(Re,ie.request,Hi.ph):(0,wn.of)(Re)})),this.publish=async(ie,ve)=>this.deps.backendSrv.post("api/live/publish",{channel:(0,_u.Qp)(ie),data:ve}),this.getPresence=ie=>this.deps.centrifugeSrv.getPresence(ie)}}function th(){const _={appUrl:`${window.location.origin}${z.$.appSubUrl}`,orgId:Dr.TP.user.orgId,orgRole:Dr.TP.user.orgRole,liveEnabled:z.$.liveEnabled,dataStreamSubscriberReadiness:Vu.a.ok.asObservable(),grafanaAuthToken:(0,zu.r)()},Y=z.$.featureToggles["live-service-web-worker"]?new Xu(_):new Hu.w(_);(0,Fi.S8)(new eh({centrifugeSrv:Y,backendSrv:(0,x.AI)()}))}function yp(){return getGrafanaLiveSrv()}var nh=e(17888),sh=e(20726),Do=e(31193),wo=e(74135),Is=e(75462);function ah(_){let Y,ie;return _.addedComponentsRegistry.asObservable().subscribe(ve=>{Y=ve}),_.addedLinksRegistry.asObservable().subscribe(ve=>{ie=ve}),ve=>Gi({...ve,addedComponentsRegistry:Y,addedLinksRegistry:ie})}const Gi=({context:_,extensionPointId:Y,limitPerPlugin:ie,addedLinksRegistry:ve,addedComponentsRegistry:Re})=>{const Le=_?(0,Is.$Y)(_):{},$e=[],ke={};for(const ct of ve?.[Y]??[])try{const{pluginId:pt}=ct;if(ie&&ke[pt]>=ie)continue;ke[pt]===void 0&&(ke[pt]=0);const Ct=(0,Is.hS)(pt,ct,Le);if(ct.configure&&Ct===void 0)continue;const Ft=Ct?.path||ct.path,Ot={id:(0,Is.yt)(pt,Y,ct.title),type:wo.u.link,pluginId:pt,onClick:(0,Is.dx)(pt,Y,ct,Le),icon:Ct?.icon||ct.icon,title:Ct?.title||ct.title,description:Ct?.description||ct.description,path:(0,l.isString)(Ft)?(0,Is.YS)(pt,Ft,Y):void 0,category:Ct?.category||ct.category};$e.push(Ot),ke[pt]+=1}catch(pt){pt instanceof Error&&(0,Is.FF)(pt.message)}const Xe=Re?.[Y]??[];for(const ct of Xe){if(ie&&ke[ct.pluginId]>=ie)continue;ke[ct.pluginId]===void 0&&(ke[ct.pluginId]=0);const pt={id:(0,Is.yt)(ct.pluginId,Y,ct.title),type:wo.u.component,pluginId:ct.pluginId,title:ct.title,description:ct.description,component:(0,Is.nv)(ct.pluginId,ct.component)};$e.push(pt),ke[ct.pluginId]+=1}return{extensions:$e}};var Aa=e(99140),Ci=e(31678),rh=e(29436),oh=e(23994),ih=e(11140),lh=e(12881);function ch(){try{return[(0,Is.xJ)({title:"Add to dashboard",description:"Use the query and panel from explore and create/add it to a dashboard",targets:[wo.S.ExploreToolbarAction],icon:"apps",category:"Dashboards",configure:()=>{if(Pi.TP.hasPermission(Ci.AccessControlAction.DashboardsCreate)||Pi.TP.hasPermission(Ci.AccessControlAction.DashboardsWrite))return{}},onClick:(_,{context:Y,openModal:ie})=>{ie({title:(0,lh.t)(),body:({onDismiss:ve})=>(0,N.jsx)(ih.v,{onClose:ve,exploreId:Y?.exploreId})})}}),(0,Is.xJ)({title:"Add correlation",description:"Create a correlation from this query",targets:[wo.S.ExploreToolbarAction],icon:"link",configure:_=>_?.shouldShowAddCorrelation?{}:void 0,onClick:(_,{context:Y})=>{(0,Aa.JD)((0,rh.am)({editorMode:!0})),(0,Aa.JD)((0,oh.Od)({exploreId:Y.exploreId}))}})]}catch(_){return(0,Is.FF)(`Could not configure extensions for Explore due to: "${_}"`),[]}}function dh(){return[...ch()]}var Mr=e(87092),si=e(13752),Qi=e(39741),uh=e(29405),hh=e(96222),fh=e(72985);const gh="Cannot register to a read-only registry";class bi{constructor(Y){if(this.resultSubject=new si.B,this.isReadOnly=!1,Y.registrySubject){this.registrySubject=Y.registrySubject,this.isReadOnly=!0;return}this.registrySubject=new Qi.m(1),this.resultSubject.pipe((0,uh.S)(this.mapToRegistry,Y.initialState??{}),(0,hh.Z)(Y.initialState??{}),(0,mt.T)(ie=>(0,Is.ol)(ie))).subscribe(this.registrySubject)}register(Y){if(this.isReadOnly)throw new Error(gh);this.resultSubject.next(Y)}asObservable(){return this.registrySubject.asObservable()}getState(){return(0,fh._)(this.asObservable())}}class Ti extends bi{constructor(Y={}){super(Y)}mapToRegistry(Y,ie){const{pluginId:ve,configs:Re}=ie;for(const Le of Re){if(!(0,Mr.lr)(Le.component)){(0,Is.FF)(`Could not register added component with title '${Le.title}'. Reason: The provided component is not a valid React component.`);continue}if(!Le.title){(0,Is.FF)(`Could not register added component with title '${Le.title}'. Reason: Title is missing.`);continue}if(!Le.description){(0,Is.FF)(`Could not register added component with title '${Le.title}'. Reason: Description is missing.`);continue}if(ve!=="grafana"&&(0,Is.V2)()&&(0,Is.dt)(ve,Le))continue;const $e=Array.isArray(Le.targets)?Le.targets:[Le.targets];for(const ke of $e){!(0,Mr.Fk)(ke)&&!(0,Mr.w_)(ke)&&(0,Is.FF)(`Added component "${Le.title}": it's recommended to suffix the extension point id ("${ke}") with a version, e.g 'myorg-basic-app/extension-point/v1'.`);const Xe={pluginId:ve,component:(0,Is.nv)(ve,Le.component),description:Le.description,title:Le.title};ke in Y?Y[ke].push(Xe):Y[ke]=[Xe]}}return Y}readOnly(){return new Ti({registrySubject:this.registrySubject})}}class Si extends bi{constructor(Y={}){super(Y)}mapToRegistry(Y,ie){const{pluginId:ve,configs:Re}=ie;for(const Le of Re){const{path:$e,title:ke,description:Xe,configure:ct,onClick:pt,targets:Ct}=Le;if(!ke){(0,Is.FF)(`Could not register added link with title '${ke}'. Reason: Title is missing.`);continue}if(!Xe){(0,Is.FF)(`Could not register added link with title '${ke}'. Reason: Description is missing.`);continue}if(!(0,Mr.jk)(ct)){(0,Is.FF)(`Could not register added link with title '${ke}'. Reason: configure is not a function.`);continue}if(!$e&&!pt){(0,Is.FF)(`Could not register added link with title '${ke}'. Reason: Either "path" or "onClick" is required.`);continue}if($e&&!(0,Mr.kl)(ve,$e)){(0,Is.FF)(`Could not register added link with title '${ke}'. Reason: The "path" is required and should start with "/a/${ve}/" (currently: "${$e}"). Skipping the extension.`);continue}if(ve!=="grafana"&&(0,Is.V2)()&&(0,Is.OO)(ve,Le))continue;const Ft=Array.isArray(Ct)?Ct:[Ct];for(const Ot of Ft){!(0,Mr.Fk)(Ot)&&!(0,Mr.w_)(Ot)&&(0,Is.FF)(`Added link "${Le.title}: it's recommended to suffix the extension point id ("${Ot}") with a version, e.g 'myorg-basic-app/extension-point/v1'.`);const{targets:jt,...Rt}=Le;Ot in Y||(Y[Ot]=[]),Y[Ot].push({...Rt,pluginId:ve,extensionPointId:Ot})}}return Y}readOnly(){return new Si({registrySubject:this.registrySubject})}}class Mi extends bi{constructor(Y={}){super(Y)}mapToRegistry(Y,{pluginId:ie,configs:ve}){if(!ve)return Y;for(const Re of ve){const{id:Le,description:$e,title:ke}=Re;if(!Le.startsWith(ie)){(0,Is.FF)(`Could not register exposed component with id '${Le}'. Reason: The component id does not match the id naming convention. Id should be prefixed with plugin id. e.g 'myorg-basic-app/my-component-id/v1'.`);continue}if((0,Mr.w_)(Le)||(0,Is.FF)(`Exposed component with id '${Le}' does not match the convention. It's recommended to suffix the id with the component version. e.g 'myorg-basic-app/my-component-id/v1'.`),Y[Le]){(0,Is.FF)(`Could not register exposed component with id '${Le}'. Reason: An exposed component with the same id already exists.`);continue}if(!ke){(0,Is.FF)(`Could not register exposed component with id '${Le}'. Reason: Title is missing.`);continue}if(!$e){(0,Is.FF)(`Could not register exposed component with id '${Le}'. Reason: Description is missing.`);continue}ie!=="grafana"&&(0,Is.V2)()&&(0,Is.nl)(ie,Re)||(Y[Le]={...Re,pluginId:ie})}return Y}readOnly(){return new Mi({registrySubject:this.registrySubject})}}function ph(){const _={addedComponentsRegistry:new Ti,exposedComponentsRegistry:new Mi,addedLinksRegistry:new Si};return _.addedLinksRegistry.register({pluginId:"grafana",configs:dh()}),_}var $o=e(24120),ai=e(92470),mh=e(34867),Oi=e(49658);function vh(_){const Y=(0,Oi.ZV)(),ie=(0,$o.A)(Y.asObservable()),ve=(0,ai.Q)();return(0,c.useMemo)(()=>{if((0,Is.V2)()&&ve&&(0,Is.xM)(_,ve))return(0,mh.FF)(`usePluginComponent("${_}") - The exposed component ("${_}") is missing from the dependencies[] in the "plugin.json" file.`),{isLoading:!1,component:null};if(!ie?.[_])return{isLoading:!1,component:null};const Le=ie[_];return{isLoading:!1,component:(0,Is.nv)(Le.pluginId,Le.component)}},[_,ve,ie])}function yh({limitPerPlugin:_,extensionPointId:Y}){const ie=(0,Oi.TX)(),ve=(0,$o.A)(ie.asObservable()),Re=(0,ai.Q)();return(0,c.useMemo)(()=>{const Le=(0,Is.V2)()&&Re,$e=[],ke={},Xe=Re?.meta.id??"";if(Le&&!(0,Mr.Fe)({extensionPointId:Y,pluginId:Xe}))return(0,Is.FF)(`Extension point usePluginComponents("${Y}") - the id should be prefixed with your plugin id ("${Xe}/").`),{isLoading:!1,components:[]};if(Le&&(0,Is.PW)(Y,Re))return(0,Is.FF)(`usePluginComponents("${Y}") - The extension point is missing from the "plugin.json" file.`),{isLoading:!1,components:[]};for(const ct of ve?.[Y]??[]){const{pluginId:pt}=ct;_&&ke[pt]>=_||(ke[pt]===void 0&&(ke[pt]=0),$e.push(ct.component),ke[pt]+=1)}return{isLoading:!1,components:$e}},[Y,_,Re,ve])}var xh=e(83733);function Eh(_){const Y=_.addedComponentsRegistry.asObservable(),ie=_.addedLinksRegistry.asObservable();return function(Re){const Le=(0,ai.Q)(),$e=(0,$o.A)(Y),ke=(0,$o.A)(ie),{activePluginId:Xe}=(0,xh.f)(),{extensionPointId:ct,context:pt,limitPerPlugin:Ct}=Re,{extensions:Ft}=(0,c.useMemo)(()=>{const Ot=(0,Is.V2)()&&Le!==null,jt=Le?.meta.id??"";return!ke&&!$e?{extensions:[],isLoading:!1}:Ot&&!(0,Mr.Fe)({extensionPointId:ct,pluginId:jt})?((0,Is.FF)(`Extension point usePluginExtensions("${ct}") - the id should be prefixed with your plugin id ("${jt}/").`),{isLoading:!1,extensions:[]}):Ot&&(0,Is.PW)(ct,Le)?((0,Is.FF)(`Invalid extension point. Reason: The extension point is not declared in the "plugin.json" file. ExtensionPointId: "${ct}"`),{isLoading:!1,extensions:[]}):Gi({extensionPointId:ct,context:pt,limitPerPlugin:Ct,addedComponentsRegistry:$e,addedLinksRegistry:ke})},[ke,$e,ct,pt,Ct,Xe,Le]);return{extensions:Ft,isLoading:!1}}}function Ph({limitPerPlugin:_,extensionPointId:Y,context:ie}){const ve=(0,Oi.OG)(),Re=(0,ai.Q)(),Le=(0,$o.A)(ve.asObservable());return(0,c.useMemo)(()=>{const $e=(0,Is.V2)()&&Re!==null,ke=Re?.meta.id??"";if($e&&!(0,Mr.Fe)({extensionPointId:Y,pluginId:ke}))return(0,Is.FF)(`Extension point usePluginLinks("${Y}") - the id should be prefixed with your plugin id ("${ke}/").`),{isLoading:!1,links:[]};if($e&&(0,Is.PW)(Y,Re))return(0,Is.FF)(`Invalid extension point. Reason: The extension point is not declared in the "plugin.json" file. ExtensionPointId: "${Y}"`),{isLoading:!1,links:[]};if(!Le||!Le[Y])return{isLoading:!1,links:[]};const Xe=ie?(0,Is.$Y)(ie):{},ct=[],pt={};for(const Ct of Le[Y]??[]){const{pluginId:Ft}=Ct;if(_&&pt[Ft]>=_)continue;pt[Ft]===void 0&&(pt[Ft]=0);const Ot=(0,Is.hS)(Ft,Ct,Xe);if(Ct.configure&&Ot===void 0)continue;const jt=Ot?.path||Ct.path,Rt={id:(0,Is.yt)(Ft,Y,Ct.title),type:wo.u.link,pluginId:Ft,onClick:(0,Is.dx)(Ft,Y,Ct,Xe),icon:Ot?.icon||Ct.icon,title:Ot?.title||Ct.title,description:Ot?.description||Ct.description,path:(0,l.isString)(jt)?(0,Is.YS)(Ft,jt,Y):void 0,category:Ot?.category||Ct.category};ct.push(Rt),pt[Ft]+=1}return{isLoading:!1,links:ct}},[ie,Y,_,Le,Re])}var ki=e(15162),Dh=e(27716),Ch=e(1682);async function Yi(_=[],Y,ie="frontend_plugins_preload"){(0,Po.j)(ie);const ve=_.filter(Le=>Le.preload).map(Le=>bh(Le)),Re=await Promise.all(ve);for(const Le of Re){if(Le.error){console.error(`[Plugins] Skip loading extensions for "${Le.pluginId}" due to an error.`);continue}Y.exposedComponentsRegistry.register({pluginId:Le.pluginId,configs:Le.exposedComponentConfigs}),Y.addedComponentsRegistry.register({pluginId:Le.pluginId,configs:Le.addedComponentConfigs||[]}),Y.addedLinksRegistry.register({pluginId:Le.pluginId,configs:Le.addedLinkConfigs||[]})}(0,Po.z)(ie)}async function bh(_){const{path:Y,version:ie,id:ve,loadingStrategy:Re}=_;try{(0,Po.j)(`frontend_plugin_preload_${ve}`);const{plugin:Le}=await(0,Ch.j4)({path:Y,version:ie,isAngular:_.angular.detected,pluginId:ve,loadingStrategy:Re,moduleHash:_.moduleHash}),{exposedComponentConfigs:$e=[],addedComponentConfigs:ke=[],addedLinkConfigs:Xe=[]}=Le;return(0,Dh.x)(ve),{pluginId:ve,exposedComponentConfigs:$e,addedComponentConfigs:ke,addedLinkConfigs:Xe}}catch(Le){return console.error(`[Plugins] Failed to preload plugin: ${Y} (version: ${ie})`,Le),{pluginId:ve,error:Le,exposedComponentConfigs:[],addedComponentConfigs:[],addedLinkConfigs:[]}}finally{(0,Po.z)(`frontend_plugin_preload_${ve}`)}}var Th=e(57532),Ji=e(41987),Zi=e(65879),er=e(39070),Sh=e(80924),Mh=e(72955),Ai=e(39374);class Oh{constructor(){this.subject=new Qi.m(1)}get(){return this.subject.asObservable()}run(Y){const{queries:ie,timezone:ve,datasource:Re,panelId:Le,app:$e,dashboardUID:ke,timeRange:Xe,timeInfo:ct,cacheTimeout:pt,queryCachingTTL:Ct,maxDataPoints:Ft,scopedVars:Ot,minInterval:jt}=Y;this.subscription&&this.subscription.unsubscribe();const Rt={app:$e??Ji.Jk.Unknown,requestId:(0,Sh.S)(),timezone:ve,panelId:Le,dashboardUID:ke,range:Xe,timeInfo:ct,interval:"",intervalMs:0,targets:(0,l.cloneDeep)(ie),maxDataPoints:Ft,scopedVars:Ot||{},cacheTimeout:pt,queryCachingTTL:Ct,startTime:Date.now()};Rt.rangeRaw=Xe.raw,(0,Ga.H)(Ah(Re,Rt.scopedVars)).pipe((0,Th.$)()).subscribe({next:Mn=>{Rt.targets=Rt.targets.map(ta=>(ta.datasource||(ta.datasource=Mn.getRef()),ta));const Ws=jt?(0,xe.w)().replace(jt,Rt.scopedVars):Mn.interval,Fs=Zi.calculateInterval(Xe,Ft,Ws);Rt.scopedVars=Object.assign({},Rt.scopedVars,{__interval:{text:Fs.interval,value:Fs.interval},__interval_ms:{text:Fs.intervalMs.toString(),value:Fs.intervalMs}}),Rt.interval=Fs.interval,Rt.intervalMs=Fs.intervalMs,this.subscription=(0,Ai.BN)(Mn,Rt).subscribe({next:ta=>{const Rs=(0,jr.N$)(ta,this.lastResult);this.lastResult=(0,Mh.B)(Rs,this.lastResult),this.subject.next(this.lastResult)}})},error:Mn=>console.error("PanelQueryRunner Error",Mn)})}cancel(){this.subscription&&(this.subscription.unsubscribe(),this.lastResult&&this.lastResult.state===er.Gu.Loading&&this.subject.next({...this.lastResult,state:er.Gu.Done}))}destroy(){this.subject&&this.subject.complete(),this.subscription&&this.subscription.unsubscribe()}}async function Ah(_,Y){return _&&"query"in _?_:(0,Do.tR)().get(_,Y)}var Xi=e(14792);function Ih(){window.grafanaRuntime={getDashboardSaveModel:()=>{const _=(0,Xi.UA)().getCurrent();if(_)return _.getSaveModelCloneOld()},getDashboardTimeRange:()=>{const _=(0,ro.jG)().timeRange();return{from:_.from.valueOf(),to:_.to.valueOf(),raw:_.raw}},getPanelData:()=>{const _=(0,Xi.UA)().getCurrent();if(_)return _.panels.reduce((Y,ie)=>(Y[ie.id]=ie.getQueryRunner().getLastResult(),Y),{})}}}var Rh=e(53001),Lh=e(16757),Vo=e(20601),os=e(75096),Co=e(71468),_i=e(22391),jh=e(27803),Ir=e(3843);function qi(_){return _.extended&&"infoText"in _.extended?_.extended:null}function el(_){return _.extended&&"dataSourceTypes"in _.extended?_.extended:null}function Ii(_){return _.extended&&"dataSource"in _.extended?_.extended:null}var ha=e(87421),zo=e(26260);const Bh=(_,Y)=>{const{rootStateKey:ie}=Y.variable;if(!ie)return console.error("AdHocVariableEditor: variable has no rootStateKey"),{extended:qi(Ir.nS)};const{editor:ve}=(0,ha.nx)(ie,_);return{extended:qi(ve)}},Uh={changeVariableDatasource:zo.Iv},Nh=(0,Co.connect)(Bh,Uh);class Wh extends c.PureComponent{constructor(){super(...arguments),this.onDatasourceChanged=Y=>{this.props.changeVariableDatasource((0,os.jX)(this.props.variable),(0,_i.p$)(Y))}}componentDidMount(){const{rootStateKey:Y}=this.props.variable;if(!Y){console.error("AdHocVariableEditor: variable has no rootStateKey");return}}render(){const{variable:Y,extended:ie}=this.props;return(0,N.jsx)(jh.Q,{datasource:Y.datasource??void 0,onDataSourceChange:this.onDatasourceChanged,infoText:ie?.infoText})}}const Fh=Nh(Wh);var tl=e(38401),Ri=e(83684);const nl=90,sl=({datasource:_,onChange:Y,disabled:ie,filterKey:ve,allFilters:Re})=>{const Le=()=>al(_,ve,Re),$e=()=>$h(_,ve,Re);return ve===null?(0,N.jsx)("div",{className:"gf-form","data-testid":"AdHocFilterKey-add-key-wrapper",children:(0,N.jsx)(Ri.s,{disabled:ie,className:"query-segment-key",Component:wh,value:ve,onChange:Y,loadOptions:Le,inputMinWidth:nl})}):(0,N.jsx)("div",{className:"gf-form","data-testid":"AdHocFilterKey-key-wrapper",children:(0,N.jsx)(Ri.s,{disabled:ie,className:"query-segment-key",value:ve,onChange:Y,loadOptions:$e,inputMinWidth:nl})})},ri="-- remove filter --",Kh={label:ri,value:ri},wh=(0,N.jsx)("span",{className:"gf-form-label query-part","aria-label":"Add Filter",children:(0,N.jsx)(wa.I,{name:"plus"})}),al=async(_,Y,ie)=>{const ve=await(0,Do.tR)().get(_);if(!ve||!ve.getTagKeys)return[];const Re=ie.filter(ke=>ke.key!==Y),Le=await ve.getTagKeys({filters:Re});return(Array.isArray(Le)?Le:Le.data).map(ke=>({label:ke.text,value:ke.text}))},$h=async(_,Y,ie)=>{const ve=await al(_,Y,ie);return[Kh,...ve]},Vh=({datasource:_,disabled:Y,onChange:ie,filterKey:ve,filterValue:Re,placeHolder:Le,allFilters:$e})=>{const ke=(0,De.of)(Hh),Xe=()=>zh(_,ve,$e);return(0,N.jsx)("div",{className:"gf-form","data-testid":"AdHocFilterValue-value-wrapper",children:(0,N.jsx)(Ri.s,{className:ke.segment,disabled:Y,placeholder:Le,value:Re,onChange:ie,loadOptions:Xe})})},zh=async(_,Y,ie)=>{const ve=await(0,Do.tR)().get(_);if(!ve||!ve.getTagValues)return[];const Re=(0,ro.jG)().timeRange(),Le=ie.filter(Xe=>Xe.key!==Y),$e=await ve.getTagValues({key:Y,filters:Le,timeRange:Re});return(Array.isArray($e)?$e:$e.data).map(Xe=>({label:Xe.text,value:Xe.text}))};function Hh(){return{segment:(0,ft.css)({display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"500px"})}}const Gh=["=","!=","<",">","=~","!~"].map(_=>({label:_,value:_})),Qh=({value:_,disabled:Y,onChange:ie})=>(0,N.jsx)(tl.Y,{className:"query-segment-operator",value:_,disabled:Y,options:Gh,onChange:ie}),rl=({datasource:_,filter:{key:Y,operator:ie,value:ve},onKeyChange:Re,onOperatorChange:Le,onValueChange:$e,placeHolder:ke,allFilters:Xe,disabled:ct})=>(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(sl,{disabled:ct,datasource:_,filterKey:Y,onChange:Re,allFilters:Xe}),(0,N.jsx)("div",{className:"gf-form",children:(0,N.jsx)(Qh,{disabled:ct,value:ie,onChange:Le})}),(0,N.jsx)(Vh,{disabled:ct,datasource:_,filterKey:Y,filterValue:ve,allFilters:Xe,onChange:$e,placeHolder:ke})]}),kh=({datasource:_,appendBefore:Y,onCompleted:ie,allFilters:ve})=>{const[Re,Le]=(0,c.useState)(null),[$e,ke]=(0,c.useState)("="),Xe=(0,c.useCallback)(Ct=>{if(Ct.value!==ri){Le(Ct.value??"");return}Le(null)},[Le]),ct=(0,c.useCallback)(Ct=>ke(Ct.value??""),[ke]),pt=(0,c.useCallback)(Ct=>{ie({value:Ct.value??"",operator:$e,key:Re}),Le(null),ke("=")},[ie,$e,Re]);return Re===null?(0,N.jsx)(sl,{datasource:_,filterKey:Re,onChange:Xe,allFilters:ve}):(0,N.jsxs)(c.Fragment,{children:[Y,(0,N.jsx)(rl,{datasource:_,filter:{key:Re,value:"",operator:$e},placeHolder:(0,zr.t)("variable.adhoc.placeholder","Select value"),onKeyChange:Xe,onOperatorChange:ct,onValueChange:pt,allFilters:ve})]},"filter-builder")},ol=({label:_})=>(0,N.jsx)("div",{className:"gf-form",children:(0,N.jsx)("span",{className:"gf-form-label query-keyword",children:_})});class Yh extends c.PureComponent{constructor(){super(...arguments),this.onChange=(Y,ie)=>ve=>{const{filters:Re}=this.props,{value:Le}=ve;return ve.value===ri?this.props.removeFilter(Y):this.props.changeFilter(Y,{...Re[Y],[ie]:Le})},this.appendFilterToVariable=Y=>{this.props.addFilter(Y)}}render(){const{filters:Y,disabled:ie}=this.props;return(0,N.jsxs)("div",{className:"gf-form-inline",children:[this.renderFilters(Y,ie),!ie&&(0,N.jsx)(kh,{datasource:this.props.datasource,appendBefore:Y.length>0?(0,N.jsx)(ol,{label:"AND"}):null,onCompleted:this.appendFilterToVariable,allFilters:this.getAllFilters()})]})}getAllFilters(){return this.props.baseFilters?this.props.baseFilters.concat(this.props.filters):this.props.filters}renderFilters(Y,ie){return Y.length===0&&ie?(0,N.jsx)(tl.Y,{disabled:ie,value:"No filters",options:[],onChange:()=>{}}):Y.reduce((ve,Re,Le)=>(ve.length>0&&ve.push((0,N.jsx)(ol,{label:"AND"},`condition-${Le}`)),ve.push(this.renderFilterSegments(Re,Le,ie)),ve),[])}renderFilterSegments(Y,ie,ve){return(0,N.jsx)(c.Fragment,{children:(0,N.jsx)(rl,{disabled:ve,datasource:this.props.datasource,filter:Y,onKeyChange:this.onChange(ie,"key"),onOperatorChange:this.onChange(ie,"operator"),onValueChange:this.onChange(ie,"value"),allFilters:this.getAllFilters()})},`filter-${ie}`)}}const Jh={addFilter:zo.U2,removeFilter:zo.VT,changeFilter:zo.$u},Zh=(0,Co.connect)(null,Jh);class Xh extends c.PureComponent{constructor(){super(...arguments),this.addFilter=Y=>{this.props.addFilter((0,os.jX)(this.props.variable),Y)},this.removeFilter=Y=>{this.props.removeFilter((0,os.jX)(this.props.variable),Y)},this.changeFilter=(Y,ie)=>{this.props.changeFilter((0,os.jX)(this.props.variable),{index:Y,filter:ie})}}render(){const{filters:Y,datasource:ie,baseFilters:ve}=this.props.variable;return(0,N.jsx)(Yh,{datasource:ie,filters:Y,baseFilters:ve,disabled:this.props.readOnly,addFilter:this.addFilter,removeFilter:this.removeFilter,changeFilter:this.changeFilter})}}const il=Zh(Xh);il.displayName="AdHocPicker";var ll=e(53699);const _h=_=>_.map(Y=>nf(Y).map(ef).join("|")),qh=_=>{if((0,l.isArray)(_))return _.map(cl).filter(sf);const Y=cl(_);return Y===null?[]:[Y]};function ef(_){return _==null?"":/\|/g[Symbol.replace](_,"__gfp__")}function tf(_){return _==null?"":/__gfp__/g[Symbol.replace](_,"|")}function nf(_){return[_.key,_.operator,_.value]}function cl(_){if(!(0,l.isString)(_)||_.length===0)return null;const Y=_.split("|").map(tf);return{key:Y[0],operator:Y[1],value:Y[2]}}function sf(_){return _!==null&&(0,l.isString)(_.value)}const dl=async()=>{},af=()=>({id:"adhoc",description:"Add key/value filters on the fly.",name:"Ad hoc filters",initialState:ll.MK,reducer:ll.AA,picker:il,editor:Fh,dependsOn:()=>!1,setValue:dl,setValueFromUrl:async(_,Y)=>{const ie=qh(Y);await(0,Aa.JD)((0,zo.D4)((0,os.jX)(_),ie))},updateOptions:dl,getSaveModel:_=>{const{index:Y,id:ie,state:ve,global:Re,rootStateKey:Le,...$e}=(0,l.cloneDeep)(_);return $e},getValueForUrl:_=>{const Y=_?.filters??[];return _h(Y)}});var rf=e(14644),of=e(8866),tr=e(13344),Ja=e(24240),ul=e(13288),lf=e(44240),oi=e(16126),cf=e(38975),df=e(67791),uf=e(66847),hf=e(69850),ff=e(62938),Ka=e(72401),Da=e(48594),Ho=e(65307),oo=e(12470),Go=e(83370),bo=e(80484);const gf={...bo.Vg,type:"query",datasource:null,query:"",regex:"",sort:oo.ZG.disabled,refresh:oo.CO.onDashboardLoad,multi:!1,includeAll:!1,allValue:null,options:[],current:{},definition:""},pf=(_,Y)=>{if(Y===oo.ZG.disabled)return _;const ie=Math.ceil(Y/2),ve=Y%2===0;return ie===1?_=(0,l.sortBy)(_,"text"):ie===2?_=(0,l.sortBy)(_,Re=>{if(!Re.text)return-1;const Le=Re.text.match(/.*?(\d+).*/);return!Le||Le.length<2?-1:parseInt(Le[1],10)}):ie===3?_=(0,l.sortBy)(_,Re=>(0,l.toLower)(Re.text)):ie===4&&_.sort((Re,Le)=>Re.text?Le.text?Re.text.localeCompare(Le.text,void 0,{numeric:!0}):1:-1),ve&&(_=_.reverse()),_},mf=(_,Y)=>{const ie=[];let ve=null;Y.lastIndex=0;do ve=Y.exec(_),ve&&ie.push(ve);while(Y.global&&ve&&ve[0]!==""&&ve[0]!==void 0);return ie},vf=(_,Y,ie)=>{let ve,Re=[];_&&(ve=(0,kt.dO)(_));for(let Le=0;Le<ie.length;Le++){const $e=ie[Le];let ke=$e.text===void 0||$e.text===null?$e.value:$e.text,Xe=$e.value===void 0||$e.value===null?$e.text:$e.value;if((0,l.isNumber)(Xe)&&(Xe=Xe.toString()),(0,l.isNumber)(ke)&&(ke=ke.toString()),ve){const ct=mf(Xe,ve);if(!ct.length)continue;const pt=ct.find(jt=>jt.groups&&jt.groups.value),Ct=ct.find(jt=>jt.groups&&jt.groups.text),Ft=ct.find(jt=>jt.length>1),Ot=ct.length>1&&Ft;if(pt||Ct)Xe=pt?.groups?.value??Ct?.groups?.text,ke=Ct?.groups?.text??pt?.groups?.value;else if(Ot){for(let jt=0;jt<ct.length;jt++){const Rt=ct[jt];Re.push({text:Rt[1],value:Rt[1],selected:!1})}continue}else Ft&&(ke=Ft[1],Xe=Ft[1])}Re.push({text:ke,value:Xe,selected:!1})}return Re=(0,l.uniqBy)(Re,"value"),pf(Re,Y)},hl=(0,Ho.Z0)({name:"templating/query",initialState:Go.j,reducers:{updateVariableOptions:(_,Y)=>{const{results:ie,templatedRegex:ve}=Y.payload.data,Re=(0,ha.Fs)(_,Y.payload.id);if(Re.type!=="query")return;const{includeAll:Le,sort:$e}=Re,ke=vf(ve,$e,ie);Le&&ke.unshift({text:tr.Zm,value:tr.To,selected:!1}),ke.length||ke.push({text:tr.ou,value:tr.Ek,isNone:!0,selected:!1}),Re.options=ke}}}),yf=hl.reducer,{updateVariableOptions:xf}=hl.actions;function Ef(){return _=>_.pipe((0,mt.T)(Pf))}function Pf(_){const Y=_.series;if(!Y||!Y.length)return[];if(bf(Y))return Y;const ie=(0,jr.Bt)(Y),ve=[];let Re=-1,Le=-1,$e=-1,ke=-1;for(const Xe of ie)for(let ct=0;ct<Xe.fields.length;ct++){const pt=Xe.fields[ct],Ct=(0,ee.Ct)(pt,Xe,Y).toLowerCase();pt.type===H.PU.string&&$e===-1&&($e=ct),Ct==="text"&&pt.type===H.PU.string&&Le===-1&&(Le=ct),Ct==="value"&&pt.type===H.PU.string&&Re===-1&&(Re=ct),Ct==="expandable"&&(pt.type===H.PU.boolean||pt.type===H.PU.number)&&ke===-1&&(ke=ct)}if($e===-1)throw new Error("Couldn't find any field of type string in the results.");for(const Xe of ie)for(let ct=0;ct<Xe.length;ct++){const pt=ke!==-1?Xe.fields[ke].values[ct]:void 0,Ct=Xe.fields[$e].values[ct],Ft=Le!==-1?Xe.fields[Le].values[ct]:null,Ot=Re!==-1?Xe.fields[Re].values[ct]:null;if(Re===-1&&Le===-1){ve.push({text:Ct,value:Ct,expandable:pt});continue}if(Re===-1&&Le!==-1){ve.push({text:Ft,value:Ft,expandable:pt});continue}if(Re!==-1&&Le===-1){ve.push({text:Ot,value:Ot,expandable:pt});continue}ve.push({text:Ft,value:Ot,expandable:pt})}return ve}function Df(_){return Y=>Y.pipe((0,mt.T)(ie=>{const{variable:ve,dispatch:Re,getTemplatedRegexFunc:Le}=_;if(!ve.rootStateKey){console.error("updateOptionsState: variable.rootStateKey is not defined");return}const $e=Le(ve),ke=(0,os.qD)(ve,{results:ie,templatedRegex:$e});Re((0,Da.kb)(ve.rootStateKey,xf(ke)))}))}function Cf(_){return Y=>Y.pipe((0,qa.Z)(()=>{const{dispatch:ie,variable:ve,searchFilter:Re}=_;return Re?(0,wn.of)():(0,Ga.H)(ie((0,Ka.kl)((0,os.jX)(ve))))}))}function bf(_){if(!_)return!1;if(!_.length)return!0;const Y=_[0];if((0,jr.ci)(Y))return!1;for(const ie in Y){if(!Y.hasOwnProperty(ie)||Y[ie]!==null&&typeof Y[ie]!="string"&&typeof Y[ie]!="number")continue;const ve=ie.toLowerCase();if(ve==="text"||ve==="value")return!0}return!1}var ii=e(29505),Tf=e(43127);class Sf{constructor(){this.runners=[new Mf,new Of,new Af,new Rf]}getRunnerForDatasource(Y){const ie=this.runners.find(ve=>ve.canRun(Y));if(ie)return ie;throw new Error("Couldn't find a query runner that matches supplied arguments.")}isQueryRunnerAvailableForDatasource(Y){return this.runners.some(ie=>ie.canRun(Y))}}class Mf{constructor(){this.type=ii.Qz.Legacy}canRun(Y){return(0,Ja.d5)(Y)}getTarget({datasource:Y,variable:ie}){if((0,Ja.d5)(Y))return ie.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:Y,variable:ie,searchFilter:ve,timeSrv:Re},Le){if(!(0,Ja.d5)(Y))return Qo();const $e=(0,os.iP)(ie,ve,Re,Le.scopedVars);return(0,Ga.H)(Y.metricFindQuery(ie.query,$e)).pipe((0,qa.Z)(ke=>{if(!ke||!ke.length)return Qo();const Xe=ke;return(0,wn.of)({series:Xe,state:er.Gu.Done,timeRange:$e.range})}))}}class Of{constructor(){this.type=ii.Qz.Standard}canRun(Y){return(0,Ja.Hf)(Y)}getTarget({datasource:Y,variable:ie}){if((0,Ja.Hf)(Y))return Y.variables.toDataQuery(ie.query);throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:Y,runRequest:ie},ve){return(0,Ja.Hf)(Y)?Y.variables.query?ie(Y,ve,Y.variables.query.bind(Y.variables)):ie(Y,ve):Qo()}}class Af{constructor(){this.type=ii.Qz.Custom}canRun(Y){return(0,Ja.zs)(Y)}getTarget({datasource:Y,variable:ie}){if((0,Ja.zs)(Y))return ie.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:Y,runRequest:ie},ve){return(0,Ja.zs)(Y)?ie(Y,ve,Y.variables.query.bind(Y.variables)):Qo()}}const If="variable-query";class Rf{constructor(){this.type=ii.Qz.Datasource}canRun(Y){return(0,Ja.X3)(Y)}getTarget({datasource:Y,variable:ie}){if((0,Ja.X3)(Y))return{...ie.query,refId:ie.query.refId??If};throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:Y,runRequest:ie},ve){return(0,Ja.X3)(Y)?ie(Y,ve):Qo()}}function Qo(){return(0,wn.of)({state:er.Gu.Done,series:[],timeRange:(0,Tf.E2)()})}class Lf{constructor(Y={dispatch:Aa.JD,getState:Aa.Gu,getVariable:ha.dn,getTemplatedRegex:os.u7,getTimeSrv:ro.jG,queryRunners:new Sf,runRequest:Ai.BN}){this.dependencies=Y,this.updateOptionsRequests=new si.B,this.updateOptionsResults=new si.B,this.cancelRequests=new si.B,this.onNewRequest=this.onNewRequest.bind(this),this.subscription=this.updateOptionsRequests.subscribe(this.onNewRequest)}queueRequest(Y){this.updateOptionsRequests.next(Y)}getResponse(Y){return this.updateOptionsResults.asObservable().pipe((0,oi.p)(ie=>ie.identifier===Y))}cancelRequest(Y){this.cancelRequests.next({identifier:Y})}destroy(){this.subscription.unsubscribe()}onNewRequest(Y){const{datasource:ie,identifier:ve,searchFilter:Re}=Y;try{const{dispatch:Le,runRequest:$e,getTemplatedRegex:ke,getVariable:Xe,queryRunners:ct,getTimeSrv:pt,getState:Ct}=this.dependencies,Ft=(0,ha.y7)(Ct());this.updateOptionsResults.next({identifier:ve,state:er.Gu.Loading});const Ot=Xe(ve,Ct());if(Ot.type!=="query")return;const jt=pt(),Rt={variable:Ot,datasource:ie,searchFilter:Re,timeSrv:jt,runRequest:$e};if(!ct.isQueryRunnerAvailableForDatasource(ie)){const ta=new Error("Query Runner is not available for datasource.");this.updateOptionsResults.next({identifier:ve,state:er.Gu.Error,error:ta});return}const Mn=ct.getRunnerForDatasource(ie),Ws=Mn.getTarget({datasource:ie,variable:Ot}),Fs=this.getRequest(Ot,Y,Ws);Mn.runRequest(Rt,Fs).pipe((0,oi.p)(()=>{const ta=(0,ha.y7)(Ct());return Ft===ta}),(0,oi.p)(ta=>ta.state===er.Gu.Done||ta.state===er.Gu.Error),(0,cf.s)(1),(0,qa.Z)(ta=>ta.state===er.Gu.Error?(0,ul.$)(()=>ta.error):(0,wn.of)(ta)),Ef(),Df({variable:Ot,dispatch:Le,getTemplatedRegexFunc:ke}),Cf({variable:Ot,dispatch:Le,searchFilter:Re}),(0,df.Q)((0,lf.h)(this.updateOptionsRequests,this.cancelRequests).pipe((0,oi.p)(ta=>{let Rs=!1;return ta.identifier.id===ve.id&&(Rs=!0,this.updateOptionsResults.next({identifier:ve,state:er.Gu.Loading,cancelled:Rs})),Rs}))),(0,uf.W)(ta=>ta.cancelled?(0,wn.of)({}):(this.updateOptionsResults.next({identifier:ve,state:er.Gu.Error,error:ta}),(0,ul.$)(()=>ta))),(0,hf.j)(()=>{this.updateOptionsResults.next({identifier:ve,state:er.Gu.Done})})).subscribe()}catch(Le){this.updateOptionsResults.next({identifier:ve,state:er.Gu.Error,error:Le})}}getRequest(Y,ie,ve){const{searchFilter:Re}=ie,Le={variable:{text:Y.current.text,value:Y.current.value}},Xe={...Re?{searchFilter:{text:Re,value:Re}}:{},...Le},ct=this.dependencies.getTimeSrv().timeRange();return{app:Ji.Jk.Dashboard,requestId:(0,ff.A)(),timezone:"",range:ct,interval:"",intervalMs:0,targets:[ve],scopedVars:Xe,startTime:Date.now()}}}let fl;function jf(_){fl=_}function Li(){return fl}const Bf=_=>{if(!Uf(_))return _.name;const{current:Y}=_;return Array.isArray(Y.text)?Y.text.join(" + "):Y.text},Uf=_=>Array.isArray(_?.options)||typeof _?.current=="object";var Hr=(_=>(_[_.moveUp=38]="moveUp",_[_.moveDown=40]="moveDown",_[_.select=32]="select",_[_.cancel=27]="cancel",_[_.selectAndClose=13]="selectAndClose",_))(Hr||{});class Nf extends c.PureComponent{constructor(){super(...arguments),this.onKeyDown=Y=>{if(Hr[Y.keyCode]&&Y.keyCode!==Hr.select){const ie=Y.ctrlKey||Y.metaKey||Y.shiftKey;this.props.onNavigate(Y.keyCode,ie),Y.preventDefault()}},this.onChange=Y=>{this.props.onChange(Y.target.value)}}render(){const{value:Y,id:ie,onNavigate:ve,...Re}=this.props;return(0,N.jsx)("input",{...Re,ref:Le=>{Le&&(Le.focus(),Le.setAttribute("style",`width:${Math.max(Le.width,150)}px`))},id:ie,type:"text",className:"gf-form-input",value:Y??"",onChange:this.onChange,onKeyDown:this.onKeyDown,placeholder:(0,zr.t)("variable.dropdown.placeholder","Enter variable value")})}}var Wf=e(89963),Ff=e(46334);const Kf=({loading:_,disabled:Y,onClick:ie,text:ve,onCancel:Re,id:Le})=>{const $e=(0,De.of)(pl),ke=(0,c.useCallback)(Xe=>{Xe.stopPropagation(),Xe.preventDefault(),ie()},[ie]);return _?(0,N.jsxs)("div",{className:$e.container,"data-testid":as.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${ve}`),title:ve,id:Le,children:[(0,N.jsx)(gl,{text:ve}),(0,N.jsx)(Wf.I,{loading:!0,onCancel:Re})]}):(0,N.jsxs)("button",{onClick:ke,className:$e.container,"data-testid":as.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${ve}`),"aria-expanded":!1,"aria-controls":`options-${Le}`,id:Le,title:ve,disabled:Y,children:[(0,N.jsx)(gl,{text:ve}),(0,N.jsx)(wa.I,{"aria-hidden":!0,name:"angle-down",size:"sm"})]})},gl=({text:_})=>{const Y=(0,De.of)(pl);return(0,N.jsx)("span",{className:Y.textAndTags,children:_===tr.Zm?(0,zr.t)("variable.picker.link-all","All"):_})},pl=_=>{const Y=(0,Ff.$)(_);return{container:(0,ft.css)({maxWidth:"500px",paddingRight:"10px",padding:_.spacing(0,1),backgroundColor:_.components.input.background,border:`1px solid ${_.components.input.borderColor}`,borderRadius:_.shape.radius.default,display:"flex",alignItems:"center",color:_.colors.text.primary,height:_.spacing(_.components.height.md),[`.${Y.badge}`]:{margin:"0 5px"},"&:disabled":{backgroundColor:_.colors.action.disabledBackground,color:_.colors.action.disabledText,border:`1px solid ${_.colors.action.disabledBackground}`}}),textAndTags:(0,ft.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginRight:_.spacing(.25),userSelect:"none"})}};var wf=e(56034),$f=e(3911);class Vf extends c.PureComponent{constructor(){super(...arguments),this.onToggle=Y=>ie=>{const ve=ie.shiftKey||ie.ctrlKey||ie.metaKey;this.handleEvent(ie),this.props.onToggle(Y,ve)},this.onToggleAll=Y=>{this.handleEvent(Y),this.props.onToggleAll()}}handleEvent(Y){Y.preventDefault(),Y.stopPropagation()}render(){const{multi:Y,values:ie,highlightIndex:ve,selectedValues:Re,onToggle:Le,onToggleAll:$e,theme:ke,...Xe}=this.props,ct=ji(ke);return(0,N.jsx)("div",{className:ct.variableValueDropdown,children:(0,N.jsx)("div",{className:ct.variableOptionsWrapper,children:(0,N.jsxs)("ul",{className:ct.variableOptionsColumn,"aria-label":as.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownDropDown,...Xe,children:[this.renderMultiToggle(),ie.map((pt,Ct)=>this.renderOption(pt,Ct))]})})})}renderOption(Y,ie){const{highlightIndex:ve,multi:Re,theme:Le}=this.props,$e=ji(Le),ke=Y.value===tr.To;return(0,N.jsx)("li",{children:(0,N.jsxs)("button",{"data-testid":as.Tp.components.Variables.variableOption,role:"checkbox",type:"button","aria-checked":Y.selected,className:(0,ft.cx)((0,ne.my)(Le),$e.variableOption,{[$e.highlighted]:ie===ve,[$e.variableAllOption]:ke},$e.noStyledButton),onClick:this.onToggle(Y),children:[(0,N.jsx)("span",{className:(0,ft.cx)($e.variableOptionIcon,{[$e.variableOptionIconSelected]:Y.selected,[$e.hideVariableOptionIcon]:!Re})}),(0,N.jsx)("span",{"data-testid":as.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownOptionTexts(`${Y.text}`),children:ke?(0,zr.t)("variable.picker.option-all","All"):Y.text})]})},`${Y.value}`)}renderMultiToggle(){const{multi:Y,selectedValues:ie,theme:ve,values:Re}=this.props,Le=ji(ve),$e=Re.some(Xe=>Xe.value===tr.To);if(!Y)return null;const ke=()=>(0,N.jsx)(zr.x6,{i18nKey:"variable.picker.option-tooltip",children:"Clear selections"});return(0,N.jsx)(wf.m,{content:ke,placement:"top",children:(0,N.jsxs)("button",{className:(0,ft.cx)((0,ne.my)(ve),Le.variableOption,Le.variableOptionColumnHeader,Le.noStyledButton,{[Le.noPaddingBotton]:$e}),role:"checkbox","aria-checked":ie.length>1?"mixed":"false",onClick:this.onToggleAll,"aria-label":"Toggle all values","data-placement":"top",children:[(0,N.jsx)("span",{className:(0,ft.cx)(Le.variableOptionIcon,{[Le.variableOptionIconManySelected]:ie.length>1})}),(0,N.jsx)(zr.x6,{i18nKey:"variable.picker.option-selected-values",children:"Selected"})," (",ie.length,")"]})})}}const ji=(0,$f.N)(_=>{const Y=_.isDark?"public/img/checkbox.png":"public/img/checkbox_white.png";return{hideVariableOptionIcon:(0,ft.css)({display:"none"}),highlighted:(0,ft.css)({backgroundColor:_.colors.action.hover}),noStyledButton:(0,ft.css)({width:"100%",textAlign:"left"}),variableOption:(0,ft.css)({display:"block",padding:"2px 27px 0 8px",position:"relative",whiteSpace:"nowrap",minWidth:"115px","&:hover":{backgroundColor:_.colors.action.hover}}),variableOptionColumnHeader:(0,ft.css)({paddingTop:"5px",paddingBottom:"5px",marginBottom:"5px"}),variableOptionIcon:(0,ft.css)({display:"inline-block",width:"24px",height:"18px",position:"relative",top:"4px",background:`url(${Y}) left top no-repeat`}),variableOptionIconManySelected:(0,ft.css)({background:`url(${Y}) 0px -36px no-repeat`}),variableOptionIconSelected:(0,ft.css)({background:`url(${Y}) 0px -18px no-repeat`}),variableValueDropdown:(0,ft.css)({backgroundColor:_.colors.background.primary,border:`1px solid ${_.colors.border.weak}`,borderRadius:_.shape.borderRadius(2),boxShadow:_.shadows.z2,position:"absolute",top:_.spacing(_.components.height.md),maxHeight:"400px",minHeight:"150px",minWidth:"150px",overflowY:"auto",overflowX:"hidden",zIndex:_.zIndex.typeahead}),variableOptionsColumn:(0,ft.css)({maxHeight:"350px",display:"table-cell",lineHeight:"26px",listStyleType:"none"}),variableOptionsWrapper:(0,ft.css)({display:"table",width:"100%"}),variableAllOption:(0,ft.css)({borderBottom:`1px solid ${_.colors.border.weak}`,paddingBottom:_.spacing(1)}),noPaddingBotton:(0,ft.css)({paddingBottom:0})}}),zf=(0,De.cV)(Vf);var Hf=e(92053),ml=e(92041),Gr=e(56968),Or=e(24300);const Gf=(_,Y,ie)=>async(ve,Re)=>{if(Y===Hr.cancel)return await ve(li(_));if(Y===Hr.select)return ve(Bi(_,ie));if(Y===Hr.selectAndClose)return(0,ha.nx)(_,Re()).optionsPicker.multi?ve(Bi(_,ie)):(ve(Bi(_,ie,!0)),ve(li(_)));if(Y===Hr.moveDown)return ve((0,Da.kb)(_,(0,Or.O$)(1)));if(Y===Hr.moveUp)return ve((0,Da.kb)(_,(0,Or.O$)(-1)))},Qf=(_,Y="")=>async(ie,ve)=>{const{rootStateKey:Re}=_,{id:Le,queryValue:$e}=(0,ha.nx)(Re,ve()).optionsPicker,ke={id:Le,rootStateKey:Re,type:"query"},Xe=(0,ha.dn)(ke,ve());if(!("options"in Xe)||(ie((0,Da.kb)(Re,(0,Or.S8)(Y))),(0,l.trim)($e)===(0,l.trim)(Y)))return;const{query:ct,options:pt}=Xe,Ct=typeof ct=="string"?ct:ct.target;return(0,Hf.E)(Ct)?Zf(ie,ve,Y,Re):ie((0,Da.kb)(Re,(0,Or.fx)(pt)))},kf=async _=>{if((0,ml.R)(_.current))return;await Vo.B.get(_.type).setValue(_,_.current,!0)},li=(_,Y)=>async(ie,ve)=>{const Re=(0,ha.nx)(_,ve()).optionsPicker,Le={id:Re.id,rootStateKey:_,type:"query"},$e=(0,ha.dn)(Le,ve());if(!(0,Ja.SP)($e))return;const ke={option:Xf(Re)},Xe={propName:"queryValue",propValue:Re.queryValue};ie((0,Da.kb)(_,(0,Gr.dE)((0,os.qD)($e,ke)))),ie((0,Da.kb)(_,(0,Gr.QP)((0,os.qD)($e,Xe))));const ct=(0,ha.dn)(Le,ve());if((0,Ja.SP)(ct)&&(ie((0,Da.kb)(_,(0,Or.Fu)())),(0,os.Lz)($e)!==(0,os.Lz)(ct)))return Y?Y(ct):await kf(ct)},Yf=(_,Y)=>async(ie,ve)=>{const{id:Re,rootStateKey:Le}=_,$e=(0,ha.nx)(Le,ve()).optionsPicker;$e.id&&$e.id!==Re&&await ie(li(Le,Y));const ke=(0,ha.dn)(_,ve());(0,Ja.SP)(ke)&&ie((0,Da.kb)(Le,(0,Or.MO)(ke)))},Bi=(_,Y,ie=!1)=>(ve,Re)=>{const{highlightIndex:Le,options:$e}=(0,ha.nx)(_,Re()).optionsPicker,ke=$e[Le];ve((0,Da.kb)(_,(0,Or.U9)({option:ke,forceSelect:ie,clearOthers:Y})))},Jf=async(_,Y,ie,ve)=>{try{const{id:Re}=(0,ha.nx)(ve,Y()).optionsPicker,Le={id:Re,rootStateKey:ve,type:"query"},$e=(0,ha.dn)(Le,Y());if(!(0,Ja.SP)($e))return;await Vo.B.get($e.type).updateOptions($e,ie);const Xe=(0,ha.dn)(Le,Y());if(!(0,Ja.SP)(Xe))return;_((0,Da.kb)(ve,(0,Or.qh)(Xe.options)))}catch(Re){console.error(Re)}},Zf=(0,l.debounce)(Jf,500);function Xf(_){const{options:Y,selectedValues:ie,queryValue:ve,multi:Re}=_;if(Y.length===0&&ve&&ve.length>0)return{text:ve,value:ve,selected:!1};if(!Re)return ie.find(ke=>ke.selected);const Le=[],$e=[];for(const ke of ie)ke.selected&&(Le.push(ke.text.toString()),$e.push(ke.value.toString()));return{value:$e,text:Le,selected:!0}}const ko=()=>{const _=Le=>({...(0,rf.bindActionCreators)({openOptions:Yf,commitChangesToVariable:li,navigateOptions:Gf},Le),filterOrSearchOptions:($e,ke="")=>{Le(Qf($e,ke))},toggleAllOptions:$e=>Le((0,Da.kb)($e.rootStateKey,(0,Or.an)())),toggleOption:($e,ke,Xe,ct)=>Le((0,Da.kb)($e.rootStateKey,(0,Or.U9)({option:ke,clearOthers:Xe,forceSelect:ct})))}),Y=(Le,$e)=>{const{rootStateKey:ke}=$e.variable;return ke?{picker:(0,ha.nx)(ke,Le).optionsPicker}:(console.error("OptionPickerFactory: variable has no rootStateKey"),{picker:Or.$z})},ie=(0,Co.connect)(Y,_);class ve extends c.PureComponent{constructor(){super(...arguments),this.onShowOptions=()=>this.props.openOptions((0,os.jX)(this.props.variable),this.props.onVariableChange),this.onHideOptions=()=>{if(!this.props.variable.rootStateKey){console.error("Variable has no rootStateKey");return}this.props.commitChangesToVariable(this.props.variable.rootStateKey,this.props.onVariableChange)},this.onToggleOption=($e,ke)=>{((0,Ja.iv)(this.props.variable)&&this.props.variable.multi?this.onToggleMultiValueVariable:this.onToggleSingleValueVariable)($e,ke)},this.onToggleSingleValueVariable=($e,ke)=>{this.props.toggleOption((0,os.jX)(this.props.variable),$e,ke,!1),this.onHideOptions()},this.onToggleMultiValueVariable=($e,ke)=>{this.props.toggleOption((0,os.jX)(this.props.variable),$e,ke,!1)},this.onToggleAllOptions=()=>{this.props.toggleAllOptions((0,os.jX)(this.props.variable))},this.onFilterOrSearchOptions=$e=>{this.props.filterOrSearchOptions((0,os.jX)(this.props.variable),$e)},this.onNavigate=($e,ke)=>{if(!this.props.variable.rootStateKey){console.error("Variable has no rootStateKey");return}this.props.navigateOptions(this.props.variable.rootStateKey,$e,ke)},this.onCancel=()=>{Li().cancelRequest((0,os.jX)(this.props.variable))}}render(){const{variable:$e,picker:ke}=this.props,Xe=ke.id===$e.id,ct=_f();return(0,N.jsx)("div",{className:ct.variableLinkWrapper,"data-testid":as.Tp.components.Variables.variableLinkWrapper,children:Xe?this.renderOptions(ke):this.renderLink($e)})}renderLink($e){const ke=Bf($e),Xe=$e.state===er.Gu.Loading;return(0,N.jsx)(Kf,{id:tr.qz+$e.id,text:ke,onClick:this.onShowOptions,loading:Xe,onCancel:this.onCancel,disabled:this.props.readOnly})}renderOptions($e){const{id:ke}=this.props.variable;return(0,N.jsxs)(of.N,{onClick:this.onHideOptions,children:[(0,N.jsx)(Nf,{id:tr.qz+ke,value:$e.queryValue,onChange:this.onFilterOrSearchOptions,onNavigate:this.onNavigate,"aria-expanded":!0,"aria-controls":`options-${ke}`}),(0,N.jsx)(zf,{values:$e.options,onToggle:this.onToggleOption,onToggleAll:this.onToggleAllOptions,highlightIndex:$e.highlightIndex,multi:$e.multi,selectedValues:$e.selectedValues,id:`options-${ke}`})]})}}const Re=ie(ve);return Re.displayName="OptionsPicker",Re},_f=()=>({variableLinkWrapper:(0,ft.css)({display:"inline-block",position:"relative"})});var qf=e(95802);class eg extends c.PureComponent{constructor(){super(...arguments),this.onChange=Y=>{this.props.onPropChange({propName:"query",propValue:Y.currentTarget.value,updateOptions:!0})}}render(){return(0,N.jsx)(qf.d,{constantValue:this.props.variable.query,onChange:this.onChange})}}const tg={...bo.Vg,type:"constant",hide:oo.zL.hideVariable,query:"",current:{},options:[]},vl=(0,Ho.Z0)({name:"templating/constant",initialState:Go.j,reducers:{createConstantOptionsFromQuery:(_,Y)=>{const ie=(0,ha.Fs)(_,Y.payload.id);ie.type==="constant"&&(ie.options=[{text:ie.query.trim(),value:ie.query.trim(),selected:!1}])}}}),ng=vl.reducer,{createConstantOptionsFromQuery:sg}=vl.actions,ag=_=>async Y=>{const{rootStateKey:ie}=_;await Y((0,Da.kb)(ie,sg((0,os.qD)(_)))),await Y((0,Ka.kl)(_))},rg=()=>({id:"constant",description:"Define a hidden constant variable, useful for metric prefixes in dashboards you want to share.",name:"Constant",initialState:tg,reducer:ng,picker:ko(),editor:eg,dependsOn:()=>!1,setValue:async(_,Y,ie=!1)=>{await(0,Aa.JD)((0,Ka.t9)((0,os.jX)(_),Y,ie))},setValueFromUrl:async(_,Y)=>{await(0,Aa.JD)((0,Ka.x7)((0,os.jX)(_),Y))},updateOptions:async _=>{await(0,Aa.JD)(ag((0,os.jX)(_)))},getSaveModel:_=>{const{index:Y,id:ie,state:ve,global:Re,current:Le,options:$e,rootStateKey:ke,...Xe}=(0,l.cloneDeep)(_);return Xe},getValueForUrl:_=>_.current.value,beforeAdding:_=>{const{current:Y,options:ie,query:ve,...Re}=(0,l.cloneDeep)(_),Le={selected:!0,text:ve,value:ve};return{...Re,current:Le,options:[Le],query:ve}}});function og(_,...Y){const ie=(0,Co.connect)(...Y)(_);return ve=>(0,N.jsx)(ie,{...ve,store:Aa.M_})}function xp(_,...Y){const ie=connect(...Y)(_);return ve=>jsx(Provider,{store,children:jsx(ie,{...ve,store})})}var ig=e(58711);class lg extends c.PureComponent{constructor(){super(...arguments),this.onSelectionOptionsChange=async({propName:Y,propValue:ie})=>{this.props.onPropChange({propName:Y,propValue:ie,updateOptions:!0})},this.onQueryChange=Y=>{this.props.onPropChange({propName:"query",propValue:Y.currentTarget.value,updateOptions:!0})}}render(){return(0,N.jsx)(ig.w,{query:this.props.variable.query,multi:this.props.variable.multi,allValue:this.props.variable.allValue,includeAll:this.props.variable.includeAll,onQueryChange:this.onQueryChange,onMultiChange:Y=>this.onSelectionOptionsChange({propName:"multi",propValue:Y.currentTarget.checked}),onIncludeAllChange:Y=>this.onSelectionOptionsChange({propName:"includeAll",propValue:Y.currentTarget.checked}),onAllValueChange:Y=>this.onSelectionOptionsChange({propName:"allValue",propValue:Y.currentTarget.value})})}}const cg=(_,Y)=>({}),dg={changeVariableMultiValue:Ka.TI},ug=og(lg,cg,dg),hg={...bo.Vg,type:"custom",multi:!1,includeAll:!1,allValue:null,query:"",options:[],current:{}},yl=(0,Ho.Z0)({name:"templating/custom",initialState:Go.j,reducers:{createCustomOptionsFromQuery:(_,Y)=>{const ie=(0,ha.Fs)(_,Y.payload.id);if(ie.type!=="custom")return;const{includeAll:ve}=ie,$e=(Y.payload.data.match(/(?:\\,|[^,])+/g)??[]).map(ke=>{ke=ke.replace(/\\,/g,",");const Xe=/^(.+)\s:\s(.+)$/g.exec(ke)??[];if(Xe.length===3){const[,ct,pt]=Xe;return{text:ct.trim(),value:pt.trim(),selected:!1}}else return{text:ke.trim(),value:ke.trim(),selected:!1}});ve&&$e.unshift({text:tr.Zm,value:tr.To,selected:!1}),ie.options=$e}}}),fg=yl.reducer,{createCustomOptionsFromQuery:gg}=yl.actions,pg=_=>async(Y,ie)=>{const{rootStateKey:ve}=_,Re=(0,ha.dn)(_,ie());if(Re.type!=="custom")return;const Le=(0,xe.w)().replace(Re.query);await Y((0,Da.kb)(ve,gg((0,os.qD)(_,Le)))),await Y((0,Ka.kl)(_))},mg=()=>({id:"custom",description:"Define variable values manually",name:"Custom",initialState:hg,reducer:fg,picker:ko(),editor:ug,dependsOn:(_,Y)=>(0,os.wJ)(_.query,Y.name),setValue:async(_,Y,ie=!1)=>{await(0,Aa.JD)((0,Ka.t9)((0,os.jX)(_),Y,ie))},setValueFromUrl:async(_,Y)=>{await(0,Aa.JD)((0,Ka.x7)((0,os.jX)(_),Y))},updateOptions:async _=>{await(0,Aa.JD)(pg((0,os.jX)(_)))},getSaveModel:_=>{const{index:Y,id:ie,state:ve,global:Re,rootStateKey:Le,...$e}=(0,l.cloneDeep)(_);return $e},getValueForUrl:_=>(0,os.ML)(_)?tr.Zm:_.current.value});var vg=e(98917),yg=e(80147);const xg={...bo.Vg,type:"datasource",current:{},regex:"",options:[],query:"",multi:!1,includeAll:!1,refresh:oo.CO.onDashboardLoad},xl=(0,Ho.Z0)({name:"templating/datasource",initialState:Go.j,reducers:{createDataSourceOptions:(_,Y)=>{const{sources:ie,regex:ve}=Y.payload.data,Re=[],Le=(0,ha.Fs)(_,Y.payload.id);if(Le.type==="datasource"){for(let $e=0;$e<ie.length;$e++){const ke=ie[$e];(0,yg._)(Le.query,ke.meta)&&(Eg(ke,ve)&&Re.push({text:ke.name,value:ke.uid,selected:!1}),Pg(ke,ve)&&Re.push({text:"default",value:"default",selected:!1}))}Re.length===0&&Re.push({text:"No data sources found",value:"",selected:!1}),Le.includeAll&&Re.unshift({text:tr.Zm,value:tr.To,selected:!1}),Le.options=Re}}}});function Eg(_,Y){return Y?Y.exec(_.name):!0}function Pg(_,Y){return _.isDefault?Y?Y.exec("default"):!0:!1}const Dg=xl.reducer,{createDataSourceOptions:Cg}=xl.actions,bg=(_,Y={getDatasourceSrv:Do.tR})=>async(ie,ve)=>{const{rootStateKey:Re}=_,Le=Y.getDatasourceSrv().getList({metrics:!0,variables:!1}),$e=(0,ha.dn)(_,ve());if($e.type!=="datasource")return;let ke;$e.regex&&(ke=(0,xe.w)().replace($e.regex,void 0,"regex"),ke=(0,kt.dO)(ke)),ie((0,Da.kb)(Re,Cg((0,os.qD)(_,{sources:Le,regex:ke})))),await ie((0,Ka.kl)(_))},Tg=(_,Y={getDatasourceSrv:Do.tR})=>ie=>{const ve=Y.getDatasourceSrv().getList({metrics:!0,variables:!0}),Re=(0,l.chain)(ve).uniqBy("meta.id").map(Le=>({text:Le.meta.name,value:Le.meta.id})).value();Re.unshift({text:"",value:""}),ie((0,Da.kb)(_,(0,Ir.BC)({dataSourceTypes:Re})))},Sg=(_,Y)=>{const{variable:{rootStateKey:ie}}=Y;if(!ie)return console.error("DataSourceVariableEditor: variable has no rootStateKey"),{extended:el(Ir.nS)};const{editor:ve}=(0,ha.nx)(ie,_);return{extended:el(ve)}},Mg={initDataSourceVariableEditor:Tg,changeVariableMultiValue:Ka.TI},Og=(0,Co.connect)(Sg,Mg);class Ag extends c.PureComponent{constructor(){super(...arguments),this.onRegExBlur=Y=>{this.props.onPropChange({propName:"regex",propValue:Y.currentTarget.value,updateOptions:!0})},this.onSelectionOptionsChange=async({propValue:Y,propName:ie})=>{this.props.onPropChange({propName:ie,propValue:Y,updateOptions:!0})},this.onMultiChanged=Y=>{this.props.changeVariableMultiValue((0,os.jX)(this.props.variable),Y.currentTarget.checked)},this.onIncludeAllChanged=Y=>{this.onSelectionOptionsChange({propName:"includeAll",propValue:Y.currentTarget.checked})},this.onAllValueChanged=Y=>{this.onSelectionOptionsChange({propName:"allValue",propValue:Y.currentTarget.value})},this.getSelectedDataSourceTypeValue=()=>{const{extended:Y}=this.props;if(!Y?.dataSourceTypes.length)return"";const ie=Y.dataSourceTypes.find(Re=>Re.value===this.props.variable.query);return(ie?ie.value:Y.dataSourceTypes[0].value)??""},this.onDataSourceTypeChanged=Y=>{this.props.onPropChange({propName:"query",propValue:Y.value,updateOptions:!0})}}componentDidMount(){const{rootStateKey:Y}=this.props.variable;if(!Y){console.error("DataSourceVariableEditor: variable has no rootStateKey");return}this.props.initDataSourceVariableEditor(Y)}render(){const{variable:Y,extended:ie}=this.props,ve=ie?.dataSourceTypes?.length?ie.dataSourceTypes?.map(Re=>({value:Re.value??"",label:Re.text})):[];return(0,N.jsx)(vg.y,{query:Y.query,regex:Y.regex,multi:Y.multi,includeAll:Y.includeAll,optionTypes:ve,onChange:this.onDataSourceTypeChanged,onRegExBlur:this.onRegExBlur,onMultiChange:this.onMultiChanged,onIncludeAllChange:this.onIncludeAllChanged,onAllValueChange:this.onAllValueChanged})}}const Ig=Og(Ag),Rg=()=>({id:"datasource",description:"Enables you to dynamically switch the data source for multiple panels.",name:"Data source",initialState:xg,reducer:Dg,picker:ko(),editor:Ig,dependsOn:(_,Y)=>_.regex?(0,os.wJ)(_.regex,Y.name):!1,setValue:async(_,Y,ie=!1)=>{await(0,Aa.JD)((0,Ka.t9)((0,os.jX)(_),Y,ie))},setValueFromUrl:async(_,Y)=>{await(0,Aa.JD)((0,Ka.x7)((0,os.jX)(_),Y))},updateOptions:async _=>{await(0,Aa.JD)(bg((0,os.jX)(_)))},getSaveModel:_=>{const{index:Y,id:ie,state:ve,global:Re,rootStateKey:Le,...$e}=(0,l.cloneDeep)(_);return{...$e,options:[]}},getValueForUrl:_=>(0,os.ML)(_)?tr.Zm:_.current.value});var Lg=e(25304),jg=e(49317);const El=(0,c.memo)(({onPropChange:_,variable:Y})=>{const ie=$e=>{_({propName:"auto",propValue:$e.target.checked,updateOptions:!0})},ve=$e=>{_({propName:"query",propValue:$e.currentTarget.value,updateOptions:!0})},Re=$e=>{_({propName:"auto_count",propValue:$e.value,updateOptions:!0})},Le=$e=>{_({propName:"auto_min",propValue:$e.currentTarget.value,updateOptions:!0})};return(0,N.jsx)(jg.s,{intervals:Y.query,autoStepCount:Y.auto_count,autoEnabled:Y.auto,onAutoCountChanged:Re,onIntervalsChange:ve,onAutoEnabledChange:ie,onAutoMinIntervalChanged:Le,autoMinInterval:Y.auto_min})});El.displayName="IntervalVariableEditor";var Bg=e(23989),Ui=e(81515);const Ug=_=>async Y=>{const{rootStateKey:ie}=_;await Y((0,Da.kb)(ie,(0,Ui.mn)((0,os.qD)(_)))),await Y(Ni(_)),await Y((0,Ka.kl)(_))},Ni=(_,Y={calculateInterval:Zi.calculateInterval,getTimeSrv:ro.jG,templateSrv:(0,Bg.w)()})=>(ie,ve)=>{const Re=(0,ha.dn)(_,ve());if(Re.type==="interval"&&Re.auto){const Le=Y.calculateInterval(Y.getTimeSrv().timeRange(),Re.auto_count,Re.auto_min);Y.templateSrv.setGrafanaVariable("$__auto_interval_"+Re.name,Le.interval),Y.templateSrv.setGrafanaVariable("$__auto_interval",Le.interval)}},Ng=()=>({id:"interval",description:"Define a timespan interval (ex 1m, 1h, 1d)",name:"Interval",initialState:Ui.Ez,reducer:Ui.E5,picker:ko(),editor:El,dependsOn:()=>!1,setValue:async(_,Y,ie=!1)=>{await(0,Aa.JD)(Ni((0,os.jX)(_))),await(0,Aa.JD)((0,Ka.t9)((0,os.jX)(_),Y,ie))},setValueFromUrl:async(_,Y)=>{await(0,Aa.JD)(Ni((0,os.jX)(_))),await(0,Aa.JD)((0,Ka.x7)((0,os.jX)(_),Y))},updateOptions:async _=>{await(0,Aa.JD)(Ug((0,os.jX)(_)))},getSaveModel:_=>{const{index:Y,id:ie,state:ve,global:Re,rootStateKey:Le,...$e}=(0,l.cloneDeep)(_);return $e},getValueForUrl:_=>_.current.value});var Wg=e(44890),Fg=e(64423),Kg=e(12091),wg=e(70766);function $g(_,Y,ie){return{next:Re=>{if(Re.state===er.Gu.Error){ie.unsubscribe(),Y(Re.error);return}if(Re.state===er.Gu.Done){ie.unsubscribe(),_();return}},error:Re=>{ie.unsubscribe(),Y(Re)},complete:()=>{ie.unsubscribe(),_()}}}const Vg=(_,Y)=>async(ie,ve)=>{try{const{rootStateKey:Re}=_;if(!(0,os.sN)(Re,ve()))return;const Le=(0,ha.dn)(_,ve());if(Le.type!=="query")return;(0,ha.nx)(Re,ve()).editor.id===Le.id&&ie((0,Da.kb)(Re,(0,Ir.Eo)({errorProp:"update"})));const $e=await(0,S.l)().get(Le.datasource??"");await new Promise((ke,Xe)=>{const ct=new Fg.yU,pt=$g(ke,Xe,ct),Ct=Li().getResponse(_).subscribe(pt);ct.add(Ct),Li().queueRequest({identifier:_,datasource:$e,searchFilter:Y})})}catch(Re){if(Re instanceof Error){const Le=(0,Kg.u)(Re),{rootStateKey:$e}=_;throw(0,ha.nx)($e,ve()).editor.id===_.id&&ie((0,Da.kb)($e,(0,Ir.NY)({errorProp:"update",errorText:Le.message}))),Le}}},zg=_=>async(Y,ie)=>{const ve=(0,ha.dn)(_,ie());ve.type==="query"&&await Y(Pl((0,os.jX)(ve),ve.datasource))},Pl=(_,Y)=>async(ie,ve)=>{try{const{rootStateKey:Re}=_,{editor:Le}=(0,ha.nx)(Re,ve()),ke=Ii(Le)?.dataSource,Xe=await(0,S.l)().get(Y??"");ke&&ke.type!==Xe?.type&&ie((0,Da.kb)(Re,(0,Gr.QP)((0,os.qD)(_,{propName:"query",propValue:""}))));const ct=await(0,wg.y)(Xe);ie((0,Da.kb)(Re,(0,Ir.BC)({dataSource:Xe,VariableQueryEditor:ct})))}catch(Re){console.error(Re)}},Hg=(_,Y,ie)=>async(ve,Re)=>{const{rootStateKey:Le}=_,$e=(0,ha.dn)(_,Re());if($e.type==="query"){if(Gg($e.name,Y)){const ke="Query cannot contain a reference to itself. Variable: $"+$e.name;ve((0,Da.kb)(Le,(0,Ir.NY)({errorProp:"query",errorText:ke})));return}ve((0,Da.kb)(Le,(0,Ir.Eo)({errorProp:"query"}))),ve((0,Da.kb)(Le,(0,Gr.QP)((0,os.qD)(_,{propName:"query",propValue:Y})))),ie!==void 0?ve((0,Da.kb)(Le,(0,Gr.QP)((0,os.qD)(_,{propName:"definition",propValue:ie})))):typeof Y=="string"&&ve((0,Da.kb)(Le,(0,Gr.QP)((0,os.qD)(_,{propName:"definition",propValue:Y})))),await ve((0,Ka.mZ)(_))}};function Gg(_,Y){if(typeof Y=="string"&&Y.match(new RegExp("\\$"+_+"(/| |$)")))return!0;const ie=Dl(Y);for(let ve in ie)if(ie.hasOwnProperty(ve)){const Re=ie[ve];if(typeof Re=="string"&&Re.match(new RegExp("\\$"+_+"(/| |$)")))return!0}return!1}function Dl(_){return typeof _!="object"||_===null?{query:_}:Object.keys(_).reduce((ve,Re)=>{const Le=_[Re];if(typeof Le!="object"||Le===null)return ve[Re]=Le,ve;const $e=Dl(Le);for(let ke in $e)$e.hasOwnProperty(ke)&&(ve[`${Re}_${ke}`]=$e[ke]);return ve},{})}const Qg=(_,Y)=>{const{rootStateKey:ie}=Y.variable;if(!ie)return console.error("QueryVariableEditor: variable has no rootStateKey"),{extended:Ii(Ir.nS)};const{editor:ve}=(0,ha.nx)(ie,_);return{extended:Ii(ve)}},kg={initQueryVariableEditor:zg,changeQueryVariableDataSource:Pl,changeQueryVariableQuery:Hg,changeVariableMultiValue:Ka.TI},Yg=(0,Co.connect)(Qg,kg);class Jg extends c.PureComponent{constructor(){super(...arguments),this.state={regex:null,tagsQuery:null,tagValuesQuery:null},this.onDataSourceChange=Y=>{this.props.onPropChange({propName:"datasource",propValue:Y.isDefault?null:(0,_i.p$)(Y)})},this.onLegacyQueryChange=async(Y,ie)=>{this.props.variable.query!==Y&&this.props.changeQueryVariableQuery((0,os.jX)(this.props.variable),Y,ie)},this.onQueryChange=async Y=>{if(this.props.variable.query!==Y){let ie="";Y&&Y.hasOwnProperty("query")&&typeof Y.query=="string"&&(ie=Y.query),this.props.changeQueryVariableQuery((0,os.jX)(this.props.variable),Y,ie)}},this.onRegExBlur=async Y=>{const ie=Y.currentTarget.value;this.props.variable.regex!==ie&&this.props.onPropChange({propName:"regex",propValue:ie,updateOptions:!0})},this.onRefreshChange=Y=>{this.props.onPropChange({propName:"refresh",propValue:Y})},this.onSortChange=async Y=>{this.props.onPropChange({propName:"sort",propValue:Y.value,updateOptions:!0})},this.onMultiChange=Y=>{this.props.onPropChange({propName:"multi",propValue:Y.currentTarget.checked})},this.onIncludeAllChange=Y=>{this.props.onPropChange({propName:"includeAll",propValue:Y.currentTarget.checked})},this.onAllValueChange=Y=>{this.props.onPropChange({propName:"allValue",propValue:Y.currentTarget.value})}}async componentDidMount(){await this.props.initQueryVariableEditor((0,os.jX)(this.props.variable))}componentDidUpdate(Y){Y.variable.datasource!==this.props.variable.datasource&&this.props.changeQueryVariableDataSource((0,os.jX)(this.props.variable),this.props.variable.datasource)}render(){const{extended:Y,variable:ie}=this.props;if(!Y||!Y.dataSource)return null;const ve=(0,ro.jG)().timeRange();return(0,N.jsx)(Wg.u,{datasource:ie.datasource??void 0,onDataSourceChange:this.onDataSourceChange,query:ie.query,onQueryChange:this.onQueryChange,onLegacyQueryChange:this.onLegacyQueryChange,timeRange:ve,regex:ie.regex,onRegExChange:this.onRegExBlur,sort:ie.sort,onSortChange:this.onSortChange,refresh:ie.refresh,onRefreshChange:this.onRefreshChange,isMulti:ie.multi,includeAll:ie.includeAll,allValue:ie.allValue??"",onMultiChange:this.onMultiChange,onIncludeAllChange:this.onIncludeAllChange,onAllValueChange:this.onAllValueChange})}}const Zg=Yg(Jg),Xg=()=>({id:"query",description:"Variable values are fetched from a datasource query",name:"Query",initialState:gf,reducer:yf,picker:ko(),editor:Zg,dependsOn:(_,Y)=>(0,os.wJ)(_.query,_.datasource?.uid,_.regex,Y.name),setValue:async(_,Y,ie=!1)=>{await(0,Aa.JD)((0,Ka.t9)((0,os.jX)(_),Y,ie))},setValueFromUrl:async(_,Y)=>{await(0,Aa.JD)((0,Ka.x7)((0,os.jX)(_),Y))},updateOptions:async(_,Y)=>{await(0,Aa.JD)(Vg((0,os.jX)(_),Y))},getSaveModel:_=>{const{index:Y,id:ie,state:ve,global:Re,queryValue:Le,rootStateKey:$e,...ke}=(0,l.cloneDeep)(_);return _.refresh!==oo.CO.never?{...ke,options:[]}:ke},getValueForUrl:_=>(0,os.ML)(_)?tr.Zm:_.current.value}),_g=()=>({id:"system",description:"",name:"system",initialState:{...bo.Vg,type:"system",hide:oo.zL.hideVariable,skipUrlSync:!0,current:{value:{toString:()=>""}},state:er.Gu.Done},reducer:_=>_,picker:null,editor:null,dependsOn:()=>!1,setValue:async(_,Y,ie=!1)=>{},setValueFromUrl:async(_,Y)=>{},updateOptions:async _=>{},getSaveModel:_=>({}),getValueForUrl:_=>""});var qg=e(58975),ep=e(14329);function tp({onPropChange:_,variable:{query:Y}}){const ie=(0,c.useCallback)((Le,$e)=>{Le.preventDefault(),_({propName:"originalQuery",propValue:Le.currentTarget.value,updateOptions:!1}),_({propName:"query",propValue:Le.currentTarget.value,updateOptions:$e})},[_]),ve=(0,c.useCallback)(Le=>ie(Le,!1),[ie]),Re=(0,c.useCallback)(Le=>ie(Le,!0),[ie]);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(qg.Y,{children:"Text options"}),(0,N.jsx)(ep._,{value:Y,name:"Default value",placeholder:"default value, if any",onChange:ve,onBlur:Re,width:30,testId:as.Tp.pages.Dashboard.Settings.Variables.Edit.TextBoxVariable.textBoxOptionsQueryInputV2})]})}function np({variable:_,onVariableChange:Y,readOnly:ie}){const ve=(0,Ci.useDispatch)(),[Re,Le]=(0,c.useState)(_.current.value);(0,c.useEffect)(()=>{Le(_.current.value)},[_]);const $e=(0,c.useCallback)(()=>{if(!_.rootStateKey){console.error("Cannot update variable without rootStateKey");return}if(_.current.value!==Re){if(ve((0,Da.kb)(_.rootStateKey,(0,Gr.QP)((0,os.qD)({id:_.id,type:_.type},{propName:"query",propValue:Re})))),Y){Y({..._,current:(0,ml.R)(_.current)?{}:{..._.current,value:Re}});return}Vo.B.get(_.type).updateOptions(_)}},[_,Re,ve,Y]),ke=(0,c.useCallback)(pt=>Le(pt.target.value),[Le]),Xe=pt=>$e(),ct=pt=>{pt.keyCode===13&&(pt.preventDefault(),$e())};return(0,N.jsx)(fe.p,{type:"text",value:Re,onChange:ke,onBlur:Xe,disabled:ie,onKeyDown:ct,placeholder:(0,zr.t)("variable.textbox.placeholder","Enter variable value"),id:tr.qz+_.id})}const sp={...bo.Vg,type:"textbox",query:"",current:{},options:[],originalQuery:null},Cl=(0,Ho.Z0)({name:"templating/textbox",initialState:Go.j,reducers:{createTextBoxOptions:(_,Y)=>{const ie=(0,ha.Fs)(_,Y.payload.id);if(ie.type!=="textbox")return;const ve={text:ie.query.trim(),value:ie.query.trim(),selected:!1};ie.options=[ve],ie.current=ve}}}),ap=Cl.reducer,{createTextBoxOptions:rp}=Cl.actions,op=_=>async(Y,ie)=>{const{rootStateKey:ve,type:Re}=_;Y((0,Da.kb)(ve,rp((0,os.qD)(_))));const Le=(0,ha.dn)(_,ie());Le.type==="textbox"&&await Vo.B.get(Re).setValue(Le,Le.options[0],!0)},ip=(_,Y)=>async(ie,ve)=>{const{rootStateKey:Re}=_,Le=(0,ha.dn)(_,ve());if(Le.type!=="textbox")return;const $e=(0,os.QT)(Y);ie((0,Da.kb)(Re,(0,Gr.QP)((0,os.qD)(Le,{propName:"query",propValue:$e})))),await ie((0,Ka.x7)((0,os.jX)(Le),$e))},lp=()=>({id:"textbox",description:"Define a textbox variable, where users can enter any arbitrary string",name:"Text box",initialState:sp,reducer:ap,picker:np,editor:tp,dependsOn:(_,Y)=>!1,setValue:async(_,Y,ie=!1)=>{await(0,Aa.JD)((0,Ka.t9)((0,os.jX)(_),Y,ie))},setValueFromUrl:async(_,Y)=>{await(0,Aa.JD)(ip((0,os.jX)(_),Y))},updateOptions:async _=>{await(0,Aa.JD)(op((0,os.jX)(_)))},getSaveModel:(_,Y)=>{const{index:ie,id:ve,state:Re,global:Le,originalQuery:$e,rootStateKey:ke,...Xe}=(0,l.cloneDeep)(_);if(_.query!==$e&&!Y){const ct=$e??"",pt={selected:!1,text:ct,value:ct};return{...Xe,query:ct,current:pt,options:[pt]}}return Xe},getValueForUrl:_=>_.current.value,beforeAdding:_=>({...(0,l.cloneDeep)(_),originalQuery:_.query})});var cp=e(2272);d().move=w.b;const bl=e(39572),ci=bl.keys().map(_=>bl(_));class dp{async init(){try{parent.postMessage("GrafanaAppInit","*");const Y=(0,zr.JL)(V.Ay.bootData.user.language);Y.then(({language:Xe})=>(0,V._R)({language:Xe})),(0,x.u5)(xi.IB),fp(),eu(),(0,Po.j)("frontend_app_init"),(0,o.xS)(V.Ay.bootData.user.locale),(0,o.$D)(V.Ay.bootData.user.weekStart),(0,U.Y)(sh.m),(0,F.l)(Ns),(0,W.e)(nh.a),(0,v.T)(P.Ny),(0,E.p)(wu),(0,m.G)(()=>V.Ay.bootData.user.timezone),th(),(0,D.l)(Dr.TP.user),(0,Ku.initAuthConfig)(),(0,C.H8)(Tn.A),await Y,up(),(0,cp.U1)(),hp(),Fu(),u.D.setInit(kn.H),u.G.setInit(kn.u),p.h.setInit($t),Vo.B.setInit(()=>[Xg(),mg(),lp(),rg(),Rg(),Ng(),af(),_g()]),f.l.setInit(gn.A),(0,tu.f)(),(0,b.HC)(()=>new Oh),jf(new Lf),(0,b.pC)(Ai.BN),(0,T.se)({importPanelPlugin:ki.TV,getPanelPluginFromCache:ki.PY}),V.Ay.featureToggles.useSessionStorageForRedirection&&gp(),y.I.initialize({config:V.Ay,getTimeRangeForUrl:(0,ro.jG)().timeRangeForUrl,getVariablesUrlParams:Lg.z}),document.addEventListener("click",su);const ie=new Do.xq;if(ie.init(V.Ay.datasources,V.Ay.defaultDatasource),(0,S.h)(ie),Ih(),this.pluginExtensionsRegistries=ph(),Dr.TP.user.orgRole!==""){const Xe=["cloud-home-app"],ct=Object.values(V.Ay.apps).filter(Ct=>Xe.includes(Ct.id)),pt=Object.values(V.Ay.apps).filter(Ct=>!Xe.includes(Ct.id));Yi(pt,this.pluginExtensionsRegistries),await Yi(ct,this.pluginExtensionsRegistries,"frontend_awaited_plugins_preload")}(0,O.cE)(ah(this.pluginExtensionsRegistries)),(0,M.Vu)(Eh(this.pluginExtensionsRegistries)),(0,I.q)(Ph),(0,L.A)(vh),(0,B.R)(yh);const ve=P.Ny.getSearchObject(),Re=new Dn.dk,Le=new ju(P.Ny,Re),$e=new ou;$e.start(),Re.setKioskModeFromUrl(ve.kiosk);try{(0,Lh.W1)()}catch(Xe){console.warn("Failed to clean up old expanded folders",Xe)}this.context={backend:xi.IB,location:P.Ny,chrome:Re,keybindings:Le,newAssetsChecker:$e,config:V.Ay},(0,j._)(xa.ni),(0,A._)(xa.k9),(0,Rh.sq)(),(0,h.H)(document.getElementById("reactRoot")).render((0,c.createElement)(mn.Nz,{app:this}))}catch(Y){console.error("Failed to start Grafana",Y),window.__grafana_load_failed()}finally{(0,Po.z)("frontend_app_init")}}}function up(){ci.length>0&&ci[0].addExtensionReducers()}function hp(){ci.length>0&&ci[0].init()}function fp(){(0,K.H2)(new cu({debug:!1})),window.addEventListener("load",_=>{const Y="frontend_boot_load_time_seconds";performance&&(performance.mark(Y),Yo("first-paint","frontend_boot_","_time_seconds"),Yo("first-contentful-paint","frontend_boot_","_time_seconds"),Yo(Y),Yo("frontend_boot_js_done_time_seconds"),Yo("frontend_boot_css_time_seconds"))}),Dr.TP.user.orgRole!==""&&(0,K.pl)(new uu({})),V.Ay.grafanaJavascriptAgent.enabled&&(0,K.pl)(new Su({...V.Ay.grafanaJavascriptAgent,app:{version:V.Ay.buildInfo.version,environment:V.Ay.buildInfo.env},buildInfo:V.Ay.buildInfo,user:{id:String(V.Ay.bootData.user?.id),email:V.Ay.bootData.user?.email}})),V.Ay.googleAnalyticsId&&(0,K.pl)(new gu({googleAnalyticsId:V.Ay.googleAnalyticsId})),V.Ay.googleAnalytics4Id&&(0,K.pl)(new fu({googleAnalyticsId:V.Ay.googleAnalytics4Id,googleAnalytics4SendManualPageViews:V.Ay.googleAnalytics4SendManualPageViews})),V.Ay.rudderstackWriteKey&&V.Ay.rudderstackDataPlaneUrl&&(0,K.pl)(new pu({writeKey:V.Ay.rudderstackWriteKey,dataPlaneUrl:V.Ay.rudderstackDataPlaneUrl,user:V.Ay.bootData.user,sdkUrl:V.Ay.rudderstackSdkUrl,configUrl:V.Ay.rudderstackConfigUrl,integrationsUrl:V.Ay.rudderstackIntegrationsUrl,buildInfo:V.Ay.buildInfo})),V.Ay.applicationInsightsConnectionString&&(0,K.pl)(new hu({connectionString:V.Ay.applicationInsightsConnectionString,endpointUrl:V.Ay.applicationInsightsEndpointUrl}))}function Yo(_,Y="",ie=""){const ve=d().first(performance.getEntriesByName(_));if(ve){const Re=ve.name.replace(/-/g,"_");(0,du.n)(`${Y}${Re}${ie}`,Math.round(ve.startTime)/1e3)}}function gp(){const _=P.Ny.getSearch(),Y="redirectTo";if(_.has(Y)&&window.location.pathname!=="/"){const Re=_.get(Y);window.sessionStorage.setItem(Dr.OG,encodeURIComponent(Re)),_.delete(Y),window.history.replaceState({},"",`${window.location.pathname}${_.size>0?`?${_}`:""}`);return}if(!Dr.TP.user.isSignedIn)return;const ie=window.sessionStorage.getItem(Dr.OG);if(!ie)return;window.sessionStorage.removeItem(Dr.OG);const ve=decodeURIComponent(ie);ve.startsWith("/goto/")?window.location.replace(ve):P.Ny.replace(ve)}const pp=new dp;window.public_cdn_path&&(e.p=window.public_cdn_path),window.__grafana_public_path__=e.p.substring(0,e.p.lastIndexOf("build/"))||e.p,window.nonce&&(e.nc=window.nonce),window.__grafana_app_bundle_loaded=!0,(async()=>Promise.resolve())().then(()=>{pp.init()})},60021:(G,R,e)=>{"use strict";e.d(R,{Or:()=>n,Oz:()=>r,RC:()=>t,ho:()=>s,nA:()=>a});var t=(g=>(g.Active="active",g.Expired="expired",g.Pending="pending",g))(t||{}),n=(g=>(g.Unprocessed="unprocessed",g.Active="active",g.Suppressed="suppressed",g))(n||{}),s=(g=>(g.equal="=",g.notEqual="!=",g.regex="=~",g.notRegex="!~",g))(s||{}),a=(g=>(g.Internal="internal",g.External="external",g.All="all",g))(a||{}),r=(g=>(g.cortex="cortex",g.mimir="mimir",g.prometheus="prometheus",g))(r||{})},91621:(G,R,e)=>{"use strict";e.d(R,{Dw:()=>g,Rx:()=>s,_W:()=>r,d$:()=>n});const t={statistics:[]};var n=(l=>(l[l.Insights=1]="Insights",l[l.Search=0]="Search",l))(n||{}),s=(l=>(l[l.Builder=0]="Builder",l[l.Code=1]="Code",l))(s||{});const a={parameters:[]};var r=(l=>(l.And="and",l.Function="function",l.FunctionParameter="functionParameter",l.GroupBy="groupBy",l.Operator="operator",l.Or="or",l.Property="property",l))(r||{}),g=(l=>(l.String="string",l))(g||{});const i={logGroupNames:[],logGroups:[],statsGroups:[]}},25640:(G,R,e)=>{"use strict";e.d(R,{Rx:()=>t.Rx,YZ:()=>n,b4:()=>s,d$:()=>t.d$});var t=e(91621),n=(a=>(a.Scheduled="Scheduled",a.Running="Running",a.Complete="Complete",a.Failed="Failed",a.Cancelled="Cancelled",a.Timeout="Timeout",a))(n||{}),s=(a=>(a.Regions="regions",a.Namespaces="namespaces",a.Metrics="metrics",a.DimensionKeys="dimensionKeys",a.DimensionValues="dimensionValues",a.EBSVolumeIDs="ebsVolumeIDs",a.EC2InstanceAttributes="ec2InstanceAttributes",a.ResourceArns="resourceARNs",a.Statistics="statistics",a.LogGroups="logGroups",a.Accounts="accounts",a))(s||{})},36666:(G,R,e)=>{"use strict";e.d(R,{A:()=>S});var t=e(74848),n=e(32196),s=e(92145),a=e(55127),r=e.n(a),g=e(96540),i=e(16817),l=e(52622),d=e(21103),c=e(40845),h=e(67061),o=e(88575),m=e(90182),u=e(94354),p=e(15292),f=e(62930),y=e(2913),x=e(14792),v=e(55600),P=e(31193),E=e(48514),D=e(45994);function C(M){return JSON.stringify(M)}function b(M,I){let L=I;return window.__grafanaSceneContext&&window.__grafanaSceneContext instanceof v.H$&&(L=window.__grafanaSceneContext.state.editPanel?.getPanelId()),M===L}const T=[{label:"All data",value:!1},{label:"Annotations",value:!0,description:"Include annotations as regular data"}];function S({data:M,query:I,onChange:L,onRunQuery:B}){const{value:j}=(0,i.A)(()=>(0,P.tR)().get()),A=(0,g.useMemo)(()=>(0,x.UA)().getCurrent()?.getPanelById(I.panelId??-124134),[I.panelId]),{value:K,loading:W}=(0,i.A)(async()=>{if(!A||!M)return[];const q=await(0,P.tR)().get(A.datasource);return Promise.all(A.targets.map(async ae=>{const k=ae.datasource?await(0,P.tR)().get(ae.datasource):q,se=k.getQueryDisplayText||C,te=(0,E.E)(M,ae.refId)??M;return{refId:ae.refId,query:se(ae),name:k.name,img:k.meta.info.logos.small,data:te.series,error:te.error}}))},[M,A]),U=(0,g.useCallback)(q=>{L(q),B()},[L,B]),F=(0,g.useCallback)(q=>{U({...I,panelId:q})},[I,U]),V=(0,g.useCallback)(()=>{U({...I,withTransforms:!I.withTransforms})},[I,U]),w=(0,g.useCallback)(q=>{U({...I,topic:q?l.QR.Annotations:void 0})},[I,U]),z=(0,g.useCallback)(q=>{const ae=q.datasource??j,k=(0,P.tR)().getInstanceSettings(ae)?.name,se=q.targets.length;return`${se} ${r()("query",se)} to ${k}`},[j]),N=(0,x.UA)().getCurrent(),H=!!(I.withTransforms||A?.transformations?.length),Q=(0,g.useMemo)(()=>N?.panels.filter(q=>y.Ay.panels[q.type]&&q.targets&&!b(q.id,N.panelInEdit?.id)&&q.datasource?.uid!==D.K).map(q=>({value:q.id,label:q.title??"Panel "+q.id,description:z(q),imgUrl:y.Ay.panels[q.type].info.logos.small}))??[],[N,z]),X=(0,c.of)(O),ee=(0,s.Bi)();if(!N)return null;if(Q.length<1)return(0,t.jsx)("p",{className:X.noQueriesText,children:"This dashboard does not have any other panels. Add queries to other panels and try again."});const Z=Q.find(q=>q.value===I.panelId);return(0,t.jsx)(d.i,{children:(0,t.jsxs)(h.B,{direction:"column",children:[(0,t.jsxs)(h.B,{gap:3,children:[(0,t.jsx)(o.D,{label:"Source panel",description:"Use query results from another panel",children:(0,t.jsx)(m.l6,{inputId:ee,placeholder:"Choose panel",isSearchable:!0,options:Q,value:Z,onChange:q=>F(q.value)})}),(0,t.jsx)(o.D,{label:"Data",description:"Use data or annotations from the panel",children:(0,t.jsx)(u.z,{options:T,value:I.topic===l.QR.Annotations,onChange:w})}),H&&(0,t.jsx)(o.D,{label:"Transform",description:"Apply transformations from the source panel",children:(0,t.jsx)(p.K,{value:!!I.withTransforms,onChange:V})})]}),W?(0,t.jsx)(f.y,{}):(0,t.jsx)(t.Fragment,{children:K&&!!K.length&&(0,t.jsx)(o.D,{label:"Queries from panel",children:(0,t.jsx)(h.B,{direction:"column",children:K.map((q,ae)=>(0,t.jsxs)(h.B,{alignItems:"center",gap:1,children:[(0,t.jsx)("div",{children:q.refId}),(0,t.jsx)("img",{src:q.img,alt:q.name,title:q.name,width:16}),(0,t.jsx)("div",{children:q.query})]},ae))})})})]})})}function O(M){return{noQueriesText:(0,n.css)({padding:M.spacing(1.25)})}}},14348:(G,R,e)=>{"use strict";e.d(R,{K:()=>i.K,kN:()=>l,mw:()=>d});var t=e(88483),n=e(52622),s=e(39070),a=e(43127),r=e(14792),g=e(34214),i=e(45994);function l(m){return m?typeof m=="string"?m===i.K:"meta"in m&&m.meta.name===i.K||m.uid===i.K:!1}function d(m,u){return new t.c(p=>{const f=(0,r.UA)().getCurrent(),y=c(m.queries);if(!y){p.next(h("Missing panel reference ID"));return}let x=f?.getPanelById(y,!0);if(x instanceof g.a||(x=new g.a(x)),!x){p.next(h("Unknown Panel: "+y));return}const v=x.getQueryRunner(),P=v.getData({withTransforms:!!u?.withTransforms,withFieldConfig:!1}).subscribe({next:E=>{u?.topic===n.QR.Annotations&&(E={...E,series:E.annotations??[],annotations:void 0}),p.next(E)}});if(!x.isInView&&x.refreshWhenInView||f?.otherPanelInFullscreen(x)){const{datasource:E,targets:D}=x,C={...m,datasource:E,panelId:y,queries:D};x.refreshWhenInView=!1,v.run(C)}return()=>{P.unsubscribe()}})}function c(m){if(!(!m||!m.length))return m[0].panelId}function h(m){return{state:s.Gu.Error,series:[],request:{},error:{message:m},timeRange:(0,a.E2)()}}var o=e(36666)},45994:(G,R,e)=>{"use strict";e.d(R,{K:()=>t});const t="-- Dashboard --",n="dashboard"},90183:(G,R,e)=>{"use strict";e.d(R,{i:()=>xe,o:()=>fe});var t=e(2543),n=e(65474),s=e(62467),a=e(44240),r=e(81160),g=e(89667),i=e(39070),l=e(55004),d=e(37471),c=e(78368),h=e(14236),o=e(26657),m=e(72574),u=e(78731),p=e(17172),f=e(19347),y=e(79056),x=e(14792),v=e(74848),P=e(32196),E=e(96540),D=e(40845),C=e(84167),b=e(88575),T=e(90182),S=e(15292),O=e(99818),M=e(10154),I=e(68706),L=e(95093),B=e.n(L),j=e(91410),A=e(20333),K=e(55852),W=e(67061),U=e(17624),F=e(67459),V=e(79770),w=e(14578),z=e(87266),N=e(16797);const H="time-of-day-picker-panel",Q=({minuteStep:Ee=1,showHour:Se=!0,showSeconds:ye=!1,onChange:Ve,value:Me,size:Ce="auto",disabled:Ue,disabledHours:Ae,disabledMinutes:we,disabledSeconds:We,placeholder:_e,format:at="HH:mm",defaultValue:ut=void 0,allowEmpty:Tt=!1,width:It})=>{const ge=(0,D.of)(ee),Ie=()=>It?(0,P.css)`
        width: ${It}px;
      `:(0,z.lH)()[Ce];return(0,v.jsx)(V.A,{value:Me,defaultValue:ut,onChange:ue=>Ve(ue),showHour:Se,showSecond:ye,format:at,allowEmpty:Tt,className:(0,P.cx)(Ie(),ge.input),popupClassName:(0,P.cx)(ge.picker,H),minuteStep:Ee,inputIcon:(0,v.jsx)(X,{wrapperStyle:ge.caretWrapper}),disabled:Ue,disabledHours:Ae,disabledMinutes:we,disabledSeconds:We,placeholder:_e})},X=({wrapperStyle:Ee=""})=>(0,v.jsx)("div",{className:Ee,children:(0,v.jsx)(w.I,{name:"angle-down"})}),ee=Ee=>{const Se=Ee.components.input.background,ye=Ee.v1.palette.black,Ve=Ee.colors.background.secondary,Me=Ee.shape.radius.default,Ce=Ee.components.input.borderColor;return{caretWrapper:(0,P.css)`
      position: absolute;
      right: 8px;
      top: 50%;
      transform: translateY(-50%);
      display: inline-block;
      text-align: right;
      color: ${Ee.colors.text.secondary};
    `,picker:(0,P.css)`
      .rc-time-picker-panel-select {
        font-size: 14px;
        background-color: ${Se};
        border-color: ${Ce};
        li {
          outline-width: 2px;
          &.rc-time-picker-panel-select-option-selected {
            background-color: inherit;
            border: 1px solid ${Ee.v1.palette.orange};
            border-radius: ${Me};
          }

          &:hover {
            background: ${Ve};
          }

          &.rc-time-picker-panel-select-option-disabled {
            color: ${Ee.colors.action.disabledText};
          }
        }
      }

      .rc-time-picker-panel-inner {
        box-shadow: 0px 4px 4px ${ye};
        background-color: ${Se};
        border-color: ${Ce};
        border-radius: ${Me};
        margin-top: 3px;

        .rc-time-picker-panel-input-wrap {
          margin-right: 2px;

          &,
          .rc-time-picker-panel-input {
            background-color: ${Se};
            padding-top: 2px;
          }
        }

        .rc-time-picker-panel-combobox {
          display: flex;
        }
      }
    `,input:(0,P.css)`
      .rc-time-picker-input {
        background-color: ${Se};
        border-radius: ${Me};
        border-color: ${Ce};
        height: ${Ee.spacing(4)};

        &:focus {
          ${(0,N.focusCss)(Ee)}
        }

        &:disabled {
          background-color: ${Ee.colors.action.disabledBackground};
          color: ${Ee.colors.action.disabledText};
          border: 1px solid ${Ee.colors.action.disabledBackground};
          &:focus {
            box-shadow: none;
          }
        }
      }

      .rc-time-picker-clear {
        position: absolute;
        right: 20px;
        top: 50%;
        cursor: pointer;
        overflow: hidden;
        transform: translateY(-50%);
        color: ${Ee.colors.text.secondary};
      }
    `}},Z=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].map((Ee,Se)=>({label:Ee,value:Se+1})),q=({value:Ee,onChange:Se})=>{const ye=(0,D.of)(ae),Ve=Date.now(),Me=(0,j.QZ)(Ee.timezone??"utc",Ve),Ce=(0,x.UA)().getCurrent()?.getTimezone()===Ee.timezone,[Ue,Ae]=(0,E.useState)(!1),we=()=>{Ae(!Ue)},We=ue=>{if(!ue)return;const me=B()();if(ue){const Pe=ue.split(":");me.set("hour",parseInt(Pe[0],10)),me.set("minute",parseInt(Pe[1],10))}return me},_e=()=>{let ue="Everyday";return Ee.fromDayOfWeek&&!Ee.toDayOfWeek&&(ue=Z[Ee.fromDayOfWeek-1].label),ue},at=()=>{const ue=(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(F.U,{title:Me?.name}),(0,v.jsx)(U.X,{timeZone:Ee.timezone,timestamp:Ve})]});return Ce?(0,v.jsxs)(v.Fragment,{children:["Dashboard timezone (",ue,")"]}):ue},ut=(ue,me)=>{const Pe=ue?ue.format("HH:mm"):void 0;Se(me==="from"?{...Ee,from:Pe}:{...Ee,to:Pe})},Tt=ue=>{Se({...Ee,timezone:ue})},It=ue=>{const me=ue?ue.value:void 0,Pe=ue?Ee.toDayOfWeek:void 0;Se({...Ee,fromDayOfWeek:me,toDayOfWeek:Pe})},ge=ue=>{Se({...Ee,toDayOfWeek:ue?ue.value:void 0})},Ie=()=>Ue?(0,v.jsx)(A.U,{value:Ee.timezone,includeInternal:!0,onChange:ue=>Tt(ue),onBlur:()=>Ae(!1),openMenuOnFocus:!1,width:100,autoFocus:!0}):(0,v.jsxs)("div",{className:ye.timezoneContainer,children:[(0,v.jsx)("div",{className:ye.timezone,children:at()}),(0,v.jsx)(K.$n,{variant:"secondary",onClick:we,size:"sm",children:"Change timezone"})]});return(0,v.jsxs)(C.n,{className:ye.wrapper,children:[(0,v.jsx)(b.D,{label:"From",children:(0,v.jsxs)(W.B,{gap:.5,children:[(0,v.jsx)(T.l6,{options:Z,isClearable:!0,placeholder:"Everyday",value:Ee.fromDayOfWeek??null,onChange:ue=>It(ue),width:20}),(0,v.jsx)(Q,{value:We(Ee.from),onChange:ue=>ut(ue,"from"),allowEmpty:!0,placeholder:"HH:mm",width:100})]})}),(0,v.jsx)(b.D,{label:"To",children:(0,v.jsxs)(W.B,{gap:.5,children:[(Ee.fromDayOfWeek||Ee.toDayOfWeek)&&(0,v.jsx)(T.l6,{options:Z,isClearable:!0,placeholder:_e(),value:Ee.toDayOfWeek??null,onChange:ue=>ge(ue),width:20}),(0,v.jsx)(Q,{value:We(Ee.to),onChange:ue=>ut(ue,"to"),allowEmpty:!0,placeholder:"HH:mm",width:100})]})}),(0,v.jsx)(b.D,{label:"Timezone",children:Ie()})]})},ae=Ee=>({wrapper:(0,P.css)({maxWidth:Ee.spacing(60),marginBottom:Ee.spacing(2)}),timezoneContainer:(0,P.css)`
      padding: 5px;
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
    `,timezone:(0,P.css)`
      margin-right: 5px;
    `}),k="Enabling this returns annotations that match any of the tags specified below",se=(0,v.jsx)("div",{children:"Specify a list of tags to match. To specify a key and value tag use `key:value` syntax."}),te=[{label:"Dashboard",value:I.St.Dashboard,description:"Query for events created on this dashboard and show them in the panels where they where created"},{label:"Tags",value:I.St.Tags,description:"This will fetch any annotation events that match the tags filter"}],ne=[{label:"Annotations & Alerts",value:I.nj.Annotations,description:"Show annotations or alerts managed by grafana"},{label:"Time regions",value:I.nj.TimeRegions,description:"Configure a repeating time region"}],le=[10,50,100,200,300,500,1e3,2e3].map(Ee=>({label:String(Ee),value:Ee}));function re({query:Ee,onChange:Se}){const ye=Ee,{limit:Ve,matchAny:Me,tags:Ce,type:Ue,queryType:Ae}=ye;let we=Ae??I.nj.Annotations;const We=(0,E.useMemo)(()=>(0,x.UA)().dashboard?.getTimezone(),[]),_e=(0,D.of)(de),at=ue=>Se({...ye,type:ue.value}),ut=ue=>Se({...ye,limit:ue.value}),Tt=ue=>Se({...ye,matchAny:ue.target.checked}),It=ue=>Se({...ye,tags:ue}),ge=ue=>{const me={...ye,queryType:ue.value};me.queryType===I.nj.TimeRegions?me.timeRegion||(me.timeRegion={timezone:We}):delete me.timeRegion,Se(me)},Ie=ue=>{Se({...ye,timeRegion:ue})};return(0,v.jsxs)(C.n,{className:_e.container,children:[(0,v.jsx)(b.D,{label:"Query type",children:(0,v.jsx)(T.l6,{inputId:"grafana-annotations__query-type",options:ne,value:we,onChange:ge})}),we===I.nj.Annotations&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(b.D,{label:"Filter by",children:(0,v.jsx)(T.l6,{inputId:"grafana-annotations__filter-by",options:te,value:Ue,onChange:at})}),(0,v.jsx)(b.D,{label:"Max limit",children:(0,v.jsx)(T.l6,{inputId:"grafana-annotations__limit",width:16,options:le,value:Ve,onChange:ut})}),Ue===I.St.Tags&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(b.D,{label:"Match any",description:k,children:(0,v.jsx)(S.d,{id:"grafana-annotations__match-any",value:Me,onChange:Tt})}),(0,v.jsx)(b.D,{label:"Tags",description:se,children:(0,v.jsx)(O.$,{allowCustomValue:!0,inputId:"grafana-annotations__tags",onChange:It,tagOptions:M.vy,tags:Ce??[]})})]})]}),we===I.nj.TimeRegions&&ye.timeRegion&&(0,v.jsx)(q,{value:ye.timeRegion,onChange:Ie})]})}const de=Ee=>({container:(0,P.css)({maxWidth:Ee.spacing(60),marginBottom:Ee.spacing(2)})});var oe=e(11261),J=e(94515);function ce(Ee,Se,ye,Ve){if(!Se)return;const Me=(0,J.iU)(Se,ye);if(!Me.length)return;const Ce=[],Ue=[],Ae=[],we=Se.timezone??Ve;for(const We of Me){let _e=We.from,at=We.to;const ut=(0,j.QZ)(we,_e);if(ut){const Tt=ut.offsetInMins*60*1e3;_e+=Tt,at+=Tt}Ce.push(_e),Ue.push(at),Ae.push(Ee)}return{fields:[{name:"time",type:oe.PU.time,values:Ce,config:{}},{name:"timeEnd",type:oe.PU.time,values:Ue,config:{}},{name:"text",type:oe.PU.string,values:Ae,config:{}}],length:Ce.length}}let pe=100;class xe extends o.iy{constructor(Se){super(Se),this.annotations={QueryEditor:re,prepareAnnotation(ye){return ye.target=ye.target??{type:ye.type??I.St.Dashboard,limit:ye.limit??100,tags:ye.tags??[],matchAny:ye.matchAny??!1},ye},prepareQuery(ye){let Ve;if((0,t.isString)(ye.datasource)){const Ue=(0,y.og)(ye.datasource,{returnDefaultAsNull:!1});Ue&&(Ve=Ue)}else Ve=ye.datasource;const{filter:Me,...Ce}=ye;return{...Ce,refId:ye.name,queryType:I.nj.Annotations,datasource:Ve}}}}getDefaultQuery(){return{queryType:I.nj.RandomWalk}}query(Se){const ye=[],Ve=[],Me=(0,m.w)();for(const Ce of Se.targets){if(Ce.queryType===I.nj.Annotations)return(0,n.H)(this.getAnnotations({range:Se.range,rangeRaw:Se.range.raw,annotation:Ce,dashboard:(0,x.UA)().getCurrent()}));if(!Ce.hide){if(Ce.queryType===I.nj.Snapshot){ye.push((0,s.of)({data:(Ce.snapshot??[]).map(Ue=>(0,g.or)(Ue)),state:i.Gu.Done}));continue}if(Ce.queryType===I.nj.TimeRegions){const Ue=ce("",Ce.timeRegion,Se.range,Se.timezone);ye.push((0,s.of)({data:Ue?[Ue]:[],state:i.Gu.Done}));continue}if(Ce.queryType===I.nj.LiveMeasurements){let Ue=Me.replace(Ce.channel,Se.scopedVars);const{filter:Ae}=Ce,we=(0,l.DG)(Ue);if(!(0,l.aj)(we))continue;const We={maxLength:Se.maxDataPoints??500};Ce.buffer?(We.maxDelta=Ce.buffer,We.maxLength=We.maxLength*2):Se.rangeRaw?.to==="now"&&(We.maxDelta=Se.range.to.valueOf()-Se.range.from.valueOf()),ye.push((0,u.oF)().getDataStream({key:`${Se.requestId}.${pe++}`,addr:we,filter:Ae,buffer:We}))}else Ce.queryType||(Ce.queryType=I.nj.RandomWalk),Ve.push(Ce)}}return Ve.length&&ye.push(super.query({...Se,targets:Ve})),ye.length?ye.length===1?ye[0]:(0,a.h)(...ye):(0,s.of)()}listFiles(Se,ye){return this.query({targets:[{refId:"A",queryType:I.nj.List,path:Se}],maxDataPoints:ye}).pipe((0,r.T)(Ve=>{const Me=Ve.data[0]??new d.k;return new c.R(Me)}))}metricFindQuery(){return Promise.resolve([])}async getAnnotations(Se){const ye=Se.annotation.target;if(ye?.queryType===I.nj.TimeRegions){const Ae=ce(Se.annotation.name,ye.timeRegion,Se.range,(0,x.UA)().getCurrent()?.timezone);return Promise.resolve({data:Ae?[Ae]:[]})}const Ve=Se.annotation,Me=Ve.target,Ce={from:Se.range.from.valueOf(),to:Se.range.to.valueOf(),limit:Me.limit,tags:Me.tags,matchAny:Me.matchAny};if(Me.type===I.St.Dashboard){if(!Se.dashboard?.uid)return Promise.resolve({data:[]});Ce.dashboardUID=Se.dashboard.uid,delete Ce.tags}else{if(!Array.isArray(Me.tags)||Me.tags.length===0)return Promise.resolve({data:[]});const Ae=(0,m.w)(),we="__delimiter__",We=[];for(const _e of Ce.tags){const at=Ae.replace(_e,{},ut=>typeof ut=="string"?ut:ut.join(we));for(const ut of at.split(we))We.push(ut)}Ce.tags=We}const Ue=await(0,p.AI)().get("/api/annotations",Ce,`grafana-data-source-annotations-${Ve.name}-${Se.dashboard?.uid}`);return{data:[(0,h.Vc)(Ue)]}}testDatasource(){return Promise.resolve({message:"",status:""})}}async function fe(){return await(0,f.l)().get("-- Grafana --")}},68706:(G,R,e)=>{"use strict";e.d(R,{St:()=>a,dx:()=>s,nj:()=>t,uJ:()=>n});var t=(r=>(r.LiveMeasurements="measurements",r.Annotations="annotations",r.Snapshot="snapshot",r.TimeRegions="timeRegions",r.RandomWalk="randomWalk",r.List="list",r.Read="read",r.Search="search",r.SearchNext="searchNext",r))(t||{});const n={refId:"A",queryType:"randomWalk"},s={refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:"snapshot",snapshot:[]};var a=(r=>(r.Dashboard="dashboard",r.Tags="tags",r))(a||{})},90478:(G,R,e)=>{"use strict";e.d(R,{H:()=>i,j:()=>d});var t=e(89667),n=e(28138),s=e(57220),a=e(40489),r=e(28444),g=e(68706);function i(c,h){return new Promise(o=>{if(c.datasource?.uid===s.vv){l(h,c),o(!0);return}n.A.publish(new r.bY({title:"Change to panel embedded data",text:"If you want to change the data shown in this panel Grafana will need to remove the panels current query and replace it with a snapshot of the current data. This enables you to edit the data.",yesText:"Continue",icon:"pen",onConfirm:()=>{l(h,c),o(!0)},onDismiss:()=>{o(!1)}}))})}function l(c,h){const o=c.map(u=>(0,t.Nw)(u)),m={refId:"A",queryType:g.nj.Snapshot,snapshot:o,datasource:{uid:s.vv}};h.updateQueries({dataSource:{uid:s.vv},queries:[m]}),h.refresh()}function d(c){return(h,o,m)=>{a.vI(h).subscribe(async u=>{const p=[];u.dataFrames.forEach(f=>{const y=(0,t.Nw)(f);p.push(y)}),c({...g.dx,snapshot:p,file:u.file},o)})}}},64100:(G,R,e)=>{"use strict";e.d(R,{Q$:()=>s,U3:()=>n,ti:()=>a});var t=(r=>(r.Builder="builder",r.Code="code",r))(t||{}),n=(r=>(r.Instant="instant",r.Range="range",r.Stream="stream",r))(n||{}),s=(r=>(r.DataSample="dataSample",r.InfiniteScroll="infiniteScroll",r.LogsSample="logsSample",r.LogsVolume="logsVolume",r))(s||{}),a=(r=>(r.Backward="backward",r.Forward="forward",r))(a||{})},71713:(G,R,e)=>{"use strict";e.d(R,{AW:()=>g,Ay:()=>l,RQ:()=>a,dZ:()=>t,fV:()=>r,vB:()=>i});const t=[{label:"avg",insertText:"avg",documentation:"Calculate the average over dimensions"},{label:"bottomk",insertText:"bottomk",documentation:"Smallest k elements by sample value"},{label:"count",insertText:"count",documentation:"Count number of elements in the vector"},{label:"max",insertText:"max",documentation:"Select maximum over dimensions"},{label:"min",insertText:"min",documentation:"Select minimum over dimensions"},{label:"stddev",insertText:"stddev",documentation:"Calculate population standard deviation over dimensions"},{label:"stdvar",insertText:"stdvar",documentation:"Calculate population standard variance over dimensions"},{label:"sum",insertText:"sum",documentation:"Calculate sum over dimensions"},{label:"topk",insertText:"topk",documentation:"Largest k elements by sample value"}],n=[{label:"json",insertText:"json",documentation:"Extracting labels from the log line using json parser."},{label:"regexp",insertText:'regexp ""',documentation:"Extracting labels from the log line using regexp parser.",move:-1},{label:"logfmt",insertText:"logfmt",documentation:"Extracting labels from the log line using logfmt parser."},{label:"pattern",insertText:"pattern",documentation:"Extracting labels from the log line using pattern parser. Only available in Loki 2.3+."},{label:"unpack",insertText:"unpack",detail:"unpack identifier",documentation:'Parses a JSON log line, unpacking all embedded labels in the pack stage. A special property "_entry" will also be used to replace the original log line. Only available in Loki 2.2+.'}],s=[{label:"unwrap",insertText:"unwrap",detail:"unwrap identifier",documentation:"Take labels and use the values as sample data for metric aggregations."},{label:"label_format",insertText:"label_format",documentation:"Use to rename, modify or add labels. For example, | label_format foo=bar ."},{label:"line_format",insertText:"line_format",documentation:'Rewrites log line content. For example, | line_format "{{.query}} {{.duration}}" .'}],a=[{insertText:"avg_over_time",label:"avg_over_time",detail:"avg_over_time(range-vector)",documentation:"The average of all values in the specified interval."},{insertText:"bytes_over_time",label:"bytes_over_time",detail:"bytes_over_time(range-vector)",documentation:"Counts the amount of bytes used by each log stream for a given range"},{insertText:"bytes_rate",label:"bytes_rate",detail:"bytes_rate(range-vector)",documentation:"Calculates the number of bytes per second for each stream."},{insertText:"first_over_time",label:"first_over_time",detail:"first_over_time(range-vector)",documentation:"The first of all values in the specified interval. Only available in Loki 2.3+."},{insertText:"last_over_time",label:"last_over_time",detail:"last_over_time(range-vector)",documentation:"The last of all values in the specified interval. Only available in Loki 2.3+."},{insertText:"sum_over_time",label:"sum_over_time",detail:"sum_over_time(range-vector)",documentation:"The sum of all values in the specified interval."},{insertText:"count_over_time",label:"count_over_time",detail:"count_over_time(range-vector)",documentation:"The count of all values in the specified interval."},{insertText:"max_over_time",label:"max_over_time",detail:"max_over_time(range-vector)",documentation:"The maximum of all values in the specified interval."},{insertText:"min_over_time",label:"min_over_time",detail:"min_over_time(range-vector)",documentation:"The minimum of all values in the specified interval."},{insertText:"quantile_over_time",label:"quantile_over_time",detail:"quantile_over_time(scalar, range-vector)",documentation:"The \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) of the values in the specified interval."},{insertText:"rate",label:"rate",detail:"rate(v range-vector)",documentation:"Calculates the number of entries per second."},{insertText:"stddev_over_time",label:"stddev_over_time",detail:"stddev_over_time(range-vector)",documentation:"The population standard deviation of the values in the specified interval."},{insertText:"stdvar_over_time",label:"stdvar_over_time",detail:"stdvar_over_time(range-vector)",documentation:"The population standard variance of the values in the specified interval."}],r=[{insertText:"vector",label:"vector",detail:"vector(scalar)",documentation:"Returns the scalar as a vector with no labels."}],g=[...t,...a,...r],i={comment:{pattern:/#.*/},"context-aggregation":{pattern:/((without|by)\s*)\([^)]*\)/,lookbehind:!0,inside:{"label-key":{pattern:/[^(),\s][^,)]*[^),\s]*/,alias:"attr-name"},punctuation:/[()]/}},"context-labels":{pattern:/\{[^}]*(?=}?)/,greedy:!0,inside:{comment:{pattern:/#.*/},"label-key":{pattern:/[a-zA-Z_]\w*(?=\s*(=|!=|=~|!~))/,alias:"attr-name",greedy:!0},"label-value":{pattern:/"(?:\\.|[^\\"])*"/,greedy:!0,alias:"attr-value"},punctuation:/[{]/}},"context-pipe":{pattern:/\s\|[^=~]\s?\w*/i,inside:{"pipe-operator":{pattern:/\|/i,alias:"operator"},"pipe-operations":{pattern:new RegExp(`${[...n,...s].map(d=>d.label).join("|")}`,"i"),alias:"keyword"}}},function:new RegExp(`\\b(?:${g.map(d=>d.label).join("|")})(?=\\s*\\()`,"i"),"context-range":[{pattern:/\[[^\]]*(?=\])/,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}},{pattern:/(offset\s+)\w+/,lookbehind:!0,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}}],quote:{pattern:/"(?:\\.|[^\\"])*"/,alias:"string",greedy:!0},backticks:{pattern:/`(?:\\.|[^\\`])*`/,alias:"string",greedy:!0},number:/\b-?\d+((\.\d*)?([eE][+-]?\d+)?)?\b/,operator:/\s?(\|[=~]?|!=?|<(?:=>?|<|>)?|>[>=]?)\s?/i,punctuation:/[{}(),.]/},l=i},13137:(G,R,e)=>{"use strict";e.d(R,{HD:()=>s,Q$:()=>t.Q$,U3:()=>t.U3,ie:()=>a,ti:()=>t.ti});var t=e(64100),n=(r=>(r.Stream="streams",r.Vector="vector",r.Matrix="matrix",r))(n||{}),s=(r=>(r.Indexed="I",r.StructuredMetadata="S",r.Parsed="P",r))(s||{}),a=(r=>(r[r.LabelNames=0]="LabelNames",r[r.LabelValues=1]="LabelValues",r))(a||{})},14678:(G,R,e)=>{"use strict";e.d(R,{N8:()=>v,qM:()=>x,uv:()=>y});var t=e(2543),n=e.n(t),s=e(62467),a=e(65474),r=e(45650),g=e(69862),i=e(81160),l=e(9084),d=e(66847),c=e(93031),h=e(71030),o=e(40187),m=e(39070),u=e(72574),p=e(19347),f=e(12091);const y="-- Mixed --",x=(E,D)=>`mixed-${E}-${D||""}`;class v extends o.mA{constructor(D){super(D)}query(D){const C=D.targets.filter(S=>S.datasource?.uid!==y);if(!C.length)return(0,s.of)({data:[]});const b=(0,t.groupBy)(C,"datasource.uid"),T=[];for(const S in b)T.push(...this.getBatchesForQueries(b[S],D));return T.length?this.batchQueries(T,D):(0,s.of)({data:[]})}getBatchesForQueries(D,C){const b=D[0].datasource,T=[],S=(0,u.w)().replace(b?.uid,C.scopedVars,(O,M)=>{if(!Array.isArray(O))return O;for(const I of O){if(I==="default")continue;const L=(0,p.l)().getInstanceSettings(I);T.push({datasource:(0,p.l)().get(I),queries:(0,t.cloneDeep)(D),scopedVars:{...C.scopedVars,[M.name]:{value:I,text:L?.name}}})}return""});return S!==""&&T.push({datasource:(0,p.l)().get(S),queries:(0,t.cloneDeep)(D),scopedVars:{...C.scopedVars}}),T}batchQueries(D,C){const b=D.filter(this.isQueryable).map((T,S)=>(0,a.H)(T.datasource).pipe((0,g.Z)(O=>{const M=(0,t.cloneDeep)(C);return M.requestId=x(S,M.requestId),M.targets=T.queries,M.scopedVars=T.scopedVars,(0,a.H)(O.query(M)).pipe((0,i.T)(I=>({...I,data:I.data||[],state:m.Gu.Loading,key:x(S,I.key)})),(0,l.$)(),(0,d.W)(I=>(I=(0,f.u)(I),I.message=`${O.name}: ${I.message}`,(0,s.of)([{data:[],state:m.Gu.Error,error:I,key:x(S,M.requestId)}]))))})));return(0,r.p)(b).pipe(P(),(0,i.T)(this.finalizeResponses),(0,c.U)())}testDatasource(){return Promise.resolve({message:"",status:""})}isQueryable(D){return D&&Array.isArray(D.queries)&&D.queries.length>0}finalizeResponses(D){const{length:C}=D;if(C===0)return D;const b=D.find(T=>T.state===m.Gu.Error);return b?D.push(b):D[C-1].state=m.Gu.Done,D}}function P(){return(0,h.T)((E,D)=>D.reduce((C,b)=>(C.push.apply(C,b),C),E),[])}},19071:(G,R,e)=>{"use strict";e.d(R,{cd:()=>w,xw:()=>j});var t=e(37471),n=e(11261);const s={filters:[],groupBy:[]};var a=(ne=>(ne.Done="done",ne.Error="error",ne.Pending="pending",ne.Streaming="streaming",ne))(a||{}),r=(ne=>(ne.Raw="raw",ne.Spans="spans",ne.Traces="traces",ne))(r||{}),g=(ne=>(ne.Intrinsic="intrinsic",ne.Resource="resource",ne.Span="span",ne.Unscoped="unscoped",ne))(g||{});function i(ne){const{nodes:le,edges:re}=l(ne),[de,oe]=makeFrames();for(const J of le)de.add(J);for(const J of re)oe.add(J);return[de,oe]}function l(ne){const le=[],re=[],de=new DataFrameView(ne),oe=d(de),J=makeSpanMap(ce=>{if(ce>=ne.length)return;const pe=de.get(ce);return{span:{...pe},id:pe.spanID,parentIds:pe.parentSpanID?[pe.parentSpanID]:[]}});for(let ce=0;ce<de.length;ce++){const pe=de.get(ce),xe=J[pe.spanID].children.map(ye=>{const Ve=J[ye].span;return[Ve.startTime,Ve.startTime+Ve.duration]}),fe=getNonOverlappingDuration(xe),Ee=pe.duration-fe,Se=getStats(pe.duration,oe,Ee);le.push({[Fields.id]:pe.spanID,[Fields.title]:pe.serviceName??"",[Fields.subTitle]:pe.operationName,[Fields.mainStat]:Se.main,[Fields.secondaryStat]:Se.secondary,[Fields.color]:Ee/oe}),pe.parentSpanID&&J[pe.parentSpanID].span&&re.push({[Fields.id]:pe.parentSpanID+"--"+pe.spanID,[Fields.target]:pe.spanID,[Fields.source]:pe.parentSpanID})}return{nodes:le,edges:re}}function d(ne){let le=0,re=1/0;for(let de=0;de<ne.length;de++){const oe=ne.get(de);oe.startTime<re&&(re=oe.startTime),oe.startTime+oe.duration>le&&(le=oe.startTime+oe.duration)}return le-re}const c="traces_service_graph_request_server_seconds_sum",h="traces_service_graph_request_total",o="traces_service_graph_request_failed_total",m="traces_service_graph_request_server_seconds_bucket",u={expr:"sum(rate(traces_spanmetrics_calls_total{}[$__range])) by (span_name)",topk:5,params:[]},p={expr:"sum(rate(traces_spanmetrics_calls_total{}[$__range])) by (span_name)",topk:5,params:['status_code="STATUS_CODE_ERROR"']},f={expr:"histogram_quantile(.9, sum(rate(traces_spanmetrics_latency_bucket{}[$__range])) by (le))",params:[]},y='span_kind="SPAN_KIND_SERVER"',x=[c,h,o,m];function v(ne,le){const re=E(ne),de={},oe={};return C(re[h],"total",h,de,oe),C(re[c],"seconds",c,de,oe),C(re[o],"failed",o,de,oe),b(de,oe,le)}function P(){function ne(de,oe){return new MutableDataFrame({name:de,fields:oe,meta:{preferredVisualisationType:"nodeGraph"}})}const le=ne("Nodes",[{name:Fields.id,type:FieldType.string,values:[]},{name:Fields.title,type:FieldType.string,config:{displayName:"Service name"},values:[]},{name:Fields.subTitle,type:FieldType.string,config:{displayName:"Service namespace"},values:[]},{name:Fields.mainStat,type:FieldType.number,config:{unit:"ms/r",displayName:"Average response time"},values:[]},{name:Fields.secondaryStat,type:FieldType.number,config:{unit:"r/sec",displayName:"Requests per second"},values:[]},{name:Fields.arc+"success",type:FieldType.number,config:{displayName:"Success",color:{fixedColor:"green",mode:FieldColorModeId.Fixed}},values:[]},{name:Fields.arc+"failed",type:FieldType.number,config:{displayName:"Failed",color:{fixedColor:"red",mode:FieldColorModeId.Fixed}},values:[]}]),re=ne("Edges",[{name:Fields.id,type:FieldType.string,values:[]},{name:Fields.source,type:FieldType.string,values:[]},{name:"sourceName",type:FieldType.string,values:[]},{name:"sourceNamespace",type:FieldType.string,values:[]},{name:Fields.target,type:FieldType.string,values:[]},{name:"targetName",type:FieldType.string,values:[]},{name:"targetNamespace",type:FieldType.string,values:[]},{name:Fields.mainStat,type:FieldType.number,config:{unit:"ms/r",displayName:"Average response time"},values:[]},{name:Fields.secondaryStat,type:FieldType.number,config:{unit:"r/sec",displayName:"Requests per second"},values:[]}]);return[le,re]}function E(ne){return(ne[0]?.data||[]).reduce((le,re)=>{const de=toDataFrame(re);return le[de.refId??"A"]=new DataFrameView(de),le},{})}var D=(ne=>(ne.sourceName="sourceName",ne.sourceNamespace="sourceNamespace",ne.targetName="targetName",ne.targetNamespace="targetNamespace",ne))(D||{});function C(ne,le,re,de,oe){if(!ne)return;const J=`Value #${re}`;for(let ce=0;ce<ne.length;ce++){const pe=ne.get(ce),xe=pe.server_service_namespace?`${pe.server_service_namespace}/${pe.server}`:pe.server,fe=pe.client_service_namespace?`${pe.client_service_namespace}/${pe.client}`:pe.client,Ee=`${fe}_${xe}`;oe[Ee]?oe[Ee][le]=(oe[Ee][le]||0)+pe[J]:oe[Ee]={target:xe,targetName:pe.server,targetNamespace:pe.server_service_namespace,source:fe,sourceName:pe.client,sourceNamespace:pe.client_service_namespace,[le]:pe[J]},de[xe]?de[xe][le]=(de[xe][le]||0)+pe[J]:de[xe]={name:pe.server,namespace:pe.server_service_namespace,[le]:pe[J]},de[fe]||(de[fe]={name:pe.client,namespace:pe.client_service_namespace,[le]:0})}}function b(ne,le,re){const[de,oe]=P();for(const J of Object.keys(ne)){const ce=ne[J];de.add({[Fields.id]:J,[Fields.title]:ce.name,[Fields.subTitle]:ce.namespace,[Fields.mainStat]:ce.total?ce.seconds/ce.total*1e3:Number.NaN,[Fields.secondaryStat]:ce.total?Math.round(ce.total*100)/100:Number.NaN,[Fields.arc+"success"]:ce.total?(ce.total-Math.min(ce.failed||0,ce.total))/ce.total:1,[Fields.arc+"failed"]:ce.total?Math.min(ce.failed||0,ce.total)/ce.total:0})}for(const J of Object.keys(le)){const ce=le[J];oe.add({[Fields.id]:J,[Fields.source]:ce.source,sourceName:ce.sourceName,sourceNamespace:ce.sourceNamespace,[Fields.target]:ce.target,targetName:ce.targetName,targetNamespace:ce.targetNamespace,[Fields.mainStat]:ce.total?ce.seconds/ce.total*1e3:Number.NaN,[Fields.secondaryStat]:ce.total?Math.round(ce.total*100)/100:Number.NaN})}return{nodes:de,edges:oe}}function T(ne){if(ne.stringValue)return ne.stringValue;if(ne.boolValue!==void 0)return!!ne.boolValue;if(ne.intValue!==void 0)return Number.parseInt(String(ne.intValue),10);if(ne.doubleValue)return Number.parseFloat(String(ne.doubleValue));if(ne.arrayValue){const le=[];for(const re of ne.arrayValue.values)le.push(T(re));return le}return""}function S(ne){const le=[];let re="OTLPResourceNoServiceName";if(!ne)return{serviceName:re,serviceTags:le};for(const de of ne.attributes)de.key===SemanticResourceAttributes.SERVICE_NAME&&(re=de.value.stringValue||re),le.push({key:de.key,value:T(de.value)});return{serviceName:re,serviceTags:le}}function O(ne){const le=[];if(ne.attributes)for(const re of ne.attributes)le.push({key:re.key,value:T(re.value)});return le}function M(ne){let le;if(ne.kind){const re=ne.kind.toString().toLowerCase().split("_");le=re.length?re[re.length-1]:ne.kind.toString()}return le}function I(ne){const le=[];if(ne.links)for(const re of ne.links){const{traceId:de,spanId:oe}=re,J=[];if(re.attributes)for(const ce of re.attributes)J.push({key:ce.key,value:T(ce.value)});le.push({traceID:de,spanID:oe,tags:J})}return le}function L(ne){const le=[];if(ne.events)for(const re of ne.events){const de=[];if(re.attributes)for(const oe of re.attributes)de.push({key:oe.key,value:T(oe.value)});le.push({fields:de,timestamp:re.timeUnixNano/1e6,name:re.name})}return le}function B(ne,le=!1){const re=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,values:[]},{name:"spanID",type:FieldType.string,values:[]},{name:"parentSpanID",type:FieldType.string,values:[]},{name:"operationName",type:FieldType.string,values:[]},{name:"serviceName",type:FieldType.string,values:[]},{name:"kind",type:FieldType.string,values:[]},{name:"statusCode",type:FieldType.number,values:[]},{name:"statusMessage",type:FieldType.string,values:[]},{name:"instrumentationLibraryName",type:FieldType.string,values:[]},{name:"instrumentationLibraryVersion",type:FieldType.string,values:[]},{name:"traceState",type:FieldType.string,values:[]},{name:"serviceTags",type:FieldType.other,values:[]},{name:"startTime",type:FieldType.number,values:[]},{name:"duration",type:FieldType.number,values:[]},{name:"logs",type:FieldType.other,values:[]},{name:"references",type:FieldType.other,values:[]},{name:"tags",type:FieldType.other,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"otlp"}}});try{for(const oe of ne){const{serviceName:J,serviceTags:ce}=S(oe.resource);for(const pe of oe.instrumentationLibrarySpans)for(const xe of pe.spans)re.add({traceID:xe.traceId.length>16?xe.traceId.slice(16):xe.traceId,spanID:xe.spanId,parentSpanID:xe.parentSpanId||"",operationName:xe.name||"",serviceName:J,kind:M(xe),statusCode:xe.status?.code,statusMessage:xe.status?.message,instrumentationLibraryName:pe.instrumentationLibrary?.name,instrumentationLibraryVersion:pe.instrumentationLibrary?.version,traceState:xe.traceState,serviceTags:ce,startTime:xe.startTimeUnixNano/1e6,duration:(xe.endTimeUnixNano-xe.startTimeUnixNano)/1e6,tags:O(xe),logs:L(xe),references:I(xe)})}}catch(oe){return console.error(oe),{error:{message:"JSON is not valid OpenTelemetry format: "+oe},data:[]}}let de=[re];return le&&de.push(...createGraphFrames(re)),{data:de}}function j(ne){let le={batches:[]},re={};for(let de=0;de<ne.length;de++){const oe=ne.get(de);re[oe.serviceName]||(re[oe.serviceName]=le.batches.length,le.batches.push({resource:{attributes:[],droppedAttributesCount:0},instrumentationLibrarySpans:[{spans:[]}]}));let J=re[oe.serviceName];le.batches[J].resource.attributes.length===0&&(le.batches[J].resource.attributes=K(oe.serviceTags)),le.batches[J].instrumentationLibrarySpans[0].instrumentationLibrary||oe.instrumentationLibraryName&&(le.batches[J].instrumentationLibrarySpans[0].instrumentationLibrary={name:oe.instrumentationLibraryName,version:oe.instrumentationLibraryVersion?oe.instrumentationLibraryVersion:""}),le.batches[J].instrumentationLibrarySpans[0].spans.push({traceId:oe.traceID.padStart(32,"0"),spanId:oe.spanID,parentSpanId:oe.parentSpanID||"",traceState:oe.traceState||"",name:oe.operationName,kind:A(oe.kind),startTimeUnixNano:oe.startTime*1e6,endTimeUnixNano:(oe.startTime+oe.duration)*1e6,attributes:oe.tags?K(oe.tags):[],droppedAttributesCount:0,droppedEventsCount:0,droppedLinksCount:0,status:U(oe),events:F(oe.logs),links:V(oe.references)})}return le}function A(ne){let le;if(ne)switch(ne){case"server":le="SPAN_KIND_SERVER";break;case"client":le="SPAN_KIND_CLIENT";break;case"producer":le="SPAN_KIND_PRODUCER";break;case"consumer":le="SPAN_KIND_CONSUMER";break;case"internal":le="SPAN_KIND_INTERNAL";break}return le}function K(ne){return ne.reduce((le,re)=>[...le,{key:re.key,value:W(re)}],[])}function W(ne){if(typeof ne.value=="string")return{stringValue:ne.value};if(typeof ne.value=="boolean")return{boolValue:ne.value};if(typeof ne.value=="number")return ne.value%1===0?{intValue:ne.value}:{doubleValue:ne.value};if(typeof ne.value=="object"&&Array.isArray(ne.value)){const le=[];for(const re of ne.value)le.push(W(re));return{arrayValue:{values:le}}}return{stringValue:ne.value}}function U(ne){let le;return ne.statusCode!==void 0&&(le={code:ne.statusCode,message:ne.statusMessage?ne.statusMessage:""}),le}function F(ne){if(!ne||!ne.length)return;let le=[];for(const re of ne){let de={timeUnixNano:re.timestamp*1e6,attributes:[],droppedAttributesCount:0,name:re.name||""};for(const oe of re.fields)de.attributes.push({key:oe.key,value:W(oe)});le.push(de)}return le}function V(ne){if(!ne||!ne.length)return;let le=[];for(const re of ne){let de={traceId:re.traceID,spanId:re.spanID,attributes:[],droppedAttributesCount:0};if(re.tags?.length)for(const oe of re.tags)de.attributes?.push({key:oe.key,value:W(oe)});le.push(de)}return le}const w="Related profiles";function z(ne,le,re=!1){const de=ne.data[0];if(!de)return te;const J=le?.jsonData?.tracesToProfiles;let ce;if(J?.datasourceUid&&(ce=getDataSourceSrv().getInstanceSettings(J.datasourceUid)),J&&ce){const xe=J.customQuery?J.query:void 0,fe={title:w,url:"",internal:{datasourceUid:ce.uid,datasourceName:ce.name,query:{labelSelector:xe||"{${__tags}}",groupBy:[],profileTypeId:J.profileTypeId??"",queryType:"profile",spanSelector:['${__span.tags["pyroscope.profile.id"]}'],refId:"profile"}},origin:DataLinkConfigOrigin.Datasource};de.fields.forEach(Ee=>{Ee.name==="tags"&&(Ee.config.links=[fe])})}let pe=[...ne.data];return re&&pe.push(...createGraphFrames(toDataFrame(de))),{...ne,data:pe}}function N(ne){return{traceID:ne.traceID,startTime:parseInt(ne.startTimeUnixNano,10)/1e6,traceDuration:ne.durationMs,traceService:ne.rootServiceName||"",traceName:ne.rootTraceName||""}}const H=ne=>ne.stringValue?`"${ne.stringValue}"`:""+(ne.intValue||ne.doubleValue||ne.boolValue||'""');function Q(ne,le){return le.series.map((de,oe)=>{const J={};de.labels?.forEach(pe=>{J[pe.key]=H(pe.value)});let ce=le.series.length===1?ne:"";return de.labels&&(de.labels.length===1?ce=H(de.labels[0].value):ce=`{${de.labels.map(pe=>`${pe.key}=${H(pe.value)}`).join(", ")}}`),createDataFrame({refId:ce||`A${oe}`,fields:[{name:"time",type:FieldType.time,values:de.samples.map(pe=>parseInt(pe.timestampMs,10))},{name:ce,labels:J,type:FieldType.number,values:de.samples.map(pe=>pe.value),config:{displayNameFromDS:ce}}],meta:{preferredVisualisationType:"graph"}})})}function X(ne,le,re){switch(re){case SearchTableType.Spans:return q(ne,le);case SearchTableType.Raw:return ee(ne);default:return Z(ne,le)}}function ee(ne){return[createDataFrame({name:"Raw response",refId:"raw",fields:[{name:"response",type:FieldType.string,values:[JSON.stringify(ne,null,2)]}]})]}function Z(ne,le){const re=createDataFrame({name:"Traces",refId:"traces",fields:[{name:"traceID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Trace ID",custom:{width:200},links:[{title:"Trace: ${__value.raw}",url:"",internal:{datasourceUid:le.uid,datasourceName:le.name,query:{query:"${__value.raw}",queryType:"traceql"}}}]}},{name:"startTime",type:FieldType.time,config:{displayNameFromDS:"Start time",custom:{width:200}}},{name:"traceService",type:FieldType.string,config:{displayNameFromDS:"Service"}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Name"}},{name:"traceDuration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"ms",custom:{width:120}}},{name:"nested",type:FieldType.nestedFrames}],meta:{preferredVisualisationType:"table",uniqueRowIdFields:[0]}});return ne?.length?(re.length=ne.length,ne.sort((de,oe)=>parseInt(oe?.startTimeUnixNano,10)/1e6-parseInt(de?.startTimeUnixNano,10)/1e6).forEach(de=>{const oe=N(de);re.fields[0].values.push(oe.traceID),re.fields[1].values.push(oe.startTime),re.fields[2].values.push(oe.traceService),re.fields[3].values.push(oe.traceName),re.fields[4].values.push(oe.traceDuration?oe.traceDuration:"<1ms"),de.spanSets?re.fields[5].values.push(de.spanSets.map(J=>k(de,J,le))):de.spanSet&&re.fields[5].values.push([k(de,de.spanSet,le)])}),[re]):[re]}function q(ne,le){const re={};let de=!1;ne?.forEach(J=>ae(J).forEach(ce=>{ce.attributes?.forEach(pe=>{re[pe.key]={name:pe.key,type:FieldType.string,config:{displayNameFromDS:pe.key}}}),ce.spans.forEach(pe=>{pe.name&&(de=!0),pe.attributes?.forEach(xe=>{re[xe.key]={name:xe.key,type:FieldType.string,config:{displayNameFromDS:xe.key}}})})}));const oe=new MutableDataFrame({name:"Spans",refId:"traces",fields:[{name:"traceIdHidden",type:FieldType.string,config:{custom:{hidden:!0}}},{name:"traceService",type:FieldType.string,config:{displayNameFromDS:"Trace Service",custom:{width:200}}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Trace Name",custom:{width:200}}},{name:"spanID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Span ID",custom:{width:200},links:[{title:"Span: ${__value.raw}",url:"",internal:{datasourceUid:le.uid,datasourceName:le.name,query:{query:"${__data.fields.traceIdHidden}",queryType:"traceql"},panelsState:{trace:{spanId:"${__value.raw}"}}}}]}},{name:"time",type:FieldType.time,config:{displayNameFromDS:"Start time"}},{name:"name",type:FieldType.string,config:{displayNameFromDS:"Name",custom:{hidden:!de}}},...Object.values(re).sort((J,ce)=>J.name.localeCompare(ce.name)),{name:"duration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"ns",custom:{width:120}}}],meta:{preferredVisualisationType:"table"}});return!ne||!ne.length?[oe]:(ne.sort((J,ce)=>parseInt(ce?.startTimeUnixNano,10)/1e6-parseInt(J?.startTimeUnixNano,10)/1e6).forEach(J=>{ae(J).forEach(ce=>{ce.spans.forEach(pe=>{oe.add(se(pe,ce,J))})})}),[oe])}const ae=ne=>ne.spanSets||(ne.spanSet?[ne.spanSet]:[]),k=(ne,le,re)=>{const de={};let oe=!1;le.attributes?.map(pe=>{de[pe.key]={name:pe.key,type:FieldType.string,config:{displayNameFromDS:pe.key},values:[]}}),le.spans.forEach(pe=>{pe.name&&(oe=!0),pe.attributes?.forEach(xe=>{de[xe.key]={name:xe.key,type:FieldType.string,config:{displayNameFromDS:xe.key},values:[]}})});const J=new MutableDataFrame({fields:[{name:"traceIdHidden",type:FieldType.string,config:{custom:{hidden:!0}},values:[]},{name:"spanID",type:FieldType.string,values:[],config:{unit:"string",displayNameFromDS:"Span ID",custom:{width:200},links:[{title:"Span: ${__value.raw}",url:"",internal:{datasourceUid:re.uid,datasourceName:re.name,query:{query:"${__data.fields.traceIdHidden}",queryType:"traceql"},panelsState:{trace:{spanId:"${__value.raw}"}}}}]}},{name:"time",type:FieldType.time,config:{displayNameFromDS:"Start time",custom:{width:200}}},{name:"name",type:FieldType.string,values:[],config:{displayNameFromDS:"Name",custom:{hidden:!oe}}},...Object.values(de).sort((pe,xe)=>pe.name.localeCompare(xe.name)),{name:"duration",type:FieldType.number,values:[],config:{displayNameFromDS:"Duration",unit:"ns",custom:{width:120}}}],meta:{preferredVisualisationType:"table"}}),ce=createTheme();for(const pe of J.fields)pe.display=getDisplayProcessor({field:pe,theme:ce});return le.spans.forEach(pe=>{J.add(se(pe,le,ne))}),J};function se(ne,le,re){const de=parseInt(ne.startTimeUnixNano,10)/1e6,oe={traceIdHidden:re.traceID,traceService:re.rootServiceName||"",traceName:re.rootTraceName||"",spanID:ne.spanID,time:de,duration:parseInt(ne.durationNanos,10),name:ne.name};let J=[];return le.attributes&&(J=J.concat(le.attributes)),ne.attributes&&(J=J.concat(ne.attributes)),J.forEach(ce=>{(ce.value.boolValue||ce.value.Value?.bool_value)&&(oe[ce.key]=ce.value.boolValue||ce.value.Value?.bool_value),(ce.value.doubleValue||ce.value.Value?.double_value)&&(oe[ce.key]=ce.value.doubleValue||ce.value.Value?.double_value),(ce.value.intValue||ce.value.Value?.int_value)&&(oe[ce.key]=ce.value.intValue||ce.value.Value?.int_value),(ce.value.stringValue||ce.value.Value?.string_value)&&(oe[ce.key]=ce.value.stringValue||ce.value.Value?.string_value)}),oe}const te={data:[new t.k({fields:[{name:"trace",type:n.PU.trace,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"otlp"}}})]}},64861:(G,R,e)=>{"use strict";e.d(R,{nE:()=>a,r6:()=>s,xB:()=>t});var t=(r=>(r[r.AlphaAsc=1]="AlphaAsc",r[r.AlphaDesc=2]="AlphaDesc",r[r.Importance=3]="Importance",r[r.TimeAsc=4]="TimeAsc",r[r.TimeDesc=5]="TimeDesc",r))(t||{}),n=(r=>(r.Current="current",r.RecentChanges="changes",r))(n||{}),s=(r=>(r.Default="default",r.Custom="custom",r))(s||{}),a=(r=>(r.List="list",r.Stat="stat",r))(a||{})},6781:(G,R,e)=>{"use strict";e.d(R,{d:()=>P,l:()=>E});var t=e(74848),n=e(2543),s=e(96540),a=e(47070),r=e(56323),g=e(52622),i=e(97696),l=e(59796),d=e(67266),c=e(12509),h=e(2913),o=e(28240),m=e(11261),u=e(8066),p=e(40845),f=e(96516),y=e(16895);const x=(0,s.memo)(({data:D,placement:C,calcs:b,displayMode:T,...S})=>{const O=(0,p.$j)();let M=[];return(0,o.Fm)(D),D.forEach((I,L)=>{I.fields.forEach((B,j)=>{const A=j+1;if(B.type===m.PU.time||B.config.custom?.hideFrom?.legend)return;const K=B.state?.displayName??B.name,W=(0,u.lz)(B,O).color,U={label:K.toString(),color:W,yAxis:B.config.custom?.axisPlacement===g.vM.Right?2:1,disabled:B.state?.hideFrom?.viz,getDisplayValues:()=>(0,y.UO)(b,B,O),getItemKey:()=>`${K}-${L}-${A}`};M.push(U)})}),(0,t.jsx)(d.KU.Legend,{placement:C,...S,children:(0,t.jsx)(f.t,{placement:C,items:M,displayMode:T,sortBy:S.sortBy,sortDesc:S.sortDesc,isSortable:!0})})});x.displayName="BarGaugeLegend";var v=e(17516);class P extends s.PureComponent{constructor(){super(...arguments),this.renderComponent=(C,b)=>{const{options:T,fieldConfig:S}=this.props,{value:O,alignmentFactors:M,orientation:I,width:L,height:B,count:j}=C,{field:A,display:K,view:W,colIndex:U}=O,{openMenu:F,targetClassName:V}=b;let w;return W&&(0,n.isNumber)(U)&&(w=W.getFieldDisplayProcessor(U)),(0,t.jsx)(i.xE,{value:E(j,S.defaults,K),width:L,height:B,orientation:I,field:A,text:T.text,display:w,theme:h.$W.theme2,itemSpacing:this.getItemSpacing(),displayMode:T.displayMode,onClick:F,className:V,alignmentFactors:j>1?M:void 0,showUnfilled:T.showUnfilled,valueDisplayMode:T.valueMode,namePlacement:T.namePlacement})},this.renderValue=C=>{const{value:b,orientation:T}=C,{hasLinks:S,getLinks:O}=b;return S&&O?(0,t.jsx)("div",{style:{width:"100%",display:T===a.wV.Vertical?"flex":"initial"},children:(0,t.jsx)(l.e,{style:{height:"100%"},links:O,children:M=>this.renderComponent(C,M)})}):this.renderComponent(C,{})},this.getValues=()=>{const{data:C,options:b,replaceVariables:T,fieldConfig:S,timeZone:O}=this.props;return(0,r.PI)({fieldConfig:S,reduceOptions:b.reduceOptions,replaceVariables:T,theme:h.$W.theme2,data:C.series,timeZone:O})}}getItemSpacing(){return this.props.options.displayMode==="lcd"?2:10}getOrientation(){const{options:C,width:b,height:T}=this.props,{orientation:S}=C;return S===a.wV.Auto?b>T?a.wV.Vertical:a.wV.Horizontal:S}calcBarSize(){const{options:C}=this.props,b=this.getOrientation(),T=C.sizing===g.T6.Manual,S=b===a.wV.Vertical,O=b===a.wV.Horizontal,M=T&&S?C.minVizWidth:v.K.minVizWidth,I=T&&O?C.minVizHeight:v.K.minVizHeight,L=T&&O?C.maxVizHeight:v.K.maxVizHeight;return{minVizWidth:M,minVizHeight:I,maxVizHeight:L}}getLegend(){const{options:C,data:b}=this.props,{legend:T}=C;return T.showLegend&&b&&b.series.length>0?(0,t.jsx)(x,{data:b.series,...T}):null}render(){const{height:C,width:b,options:T,data:S,renderCounter:O}=this.props,{minVizWidth:M,minVizHeight:I,maxVizHeight:L}=this.calcBarSize();return(0,t.jsx)(d.KU,{width:b,height:C,legend:this.getLegend(),children:(B,j)=>(0,t.jsx)(c.S,{source:S,getAlignmentFactors:r.XS,getValues:this.getValues,renderValue:this.renderValue,renderCounter:O,width:B,height:j,maxVizHeight:L,minVizWidth:M,minVizHeight:I,itemSpacing:this.getItemSpacing(),orientation:T.orientation})})}}function E(D,C,b){return D===1&&!C.displayName?{...b,title:void 0}:b}},17516:(G,R,e)=>{"use strict";e.d(R,{K:()=>n});var t=e(52622);const n={displayMode:t.eX.Gradient,maxVizHeight:300,minVizHeight:16,minVizWidth:8,namePlacement:t.TZ.Auto,showUnfilled:!0,sizing:t.T6.Auto,valueMode:t.$l.Color}},14738:(G,R,e)=>{"use strict";e.r(R),e.d(R,{plugin:()=>D});var t=e(65158),n=e(52622),s=e(71242),a=e(23799),r=e(63250);const g=C=>(0,r._$)(C),i=(C,b,T)=>{const S=(0,r.gl)(C,b,T);if(b==="singlestat"&&T.angular){const O=T.angular.gauge;O&&(S.showThresholdMarkers=O.thresholdMarkers,S.showThresholdLabels=O.thresholdLabels)}return S};var l=e(74848),d=e(96540),c=e(57875),h=e(56323),o=e(95164),m=e(59796),u=e(12509),p=e(2913),f=e(6781);const y={minVizHeight:75,minVizWidth:75,showThresholdLabels:!1,showThresholdMarkers:!0,sizing:n.T6.Auto};class x extends d.PureComponent{constructor(){super(...arguments),this.renderComponent=(b,T)=>{const{options:S,fieldConfig:O}=this.props,{width:M,height:I,count:L,value:B}=b,{field:j,display:A}=B,{openMenu:K,targetClassName:W}=T;return(0,l.jsx)(o._,{value:(0,f.l)(L,O.defaults,A),width:M,height:I,field:j,text:S.text,showThresholdLabels:S.showThresholdLabels,showThresholdMarkers:S.showThresholdMarkers,theme:p.$W.theme2,onClick:K,className:W,orientation:S.orientation})},this.renderValue=b=>{const{value:T}=b,{getLinks:S,hasLinks:O}=T;return O&&S?(0,l.jsx)(m.e,{links:S,style:{flexGrow:1},children:M=>this.renderComponent(b,M)}):this.renderComponent(b,{})},this.getValues=()=>{const{data:b,options:T,replaceVariables:S,fieldConfig:O,timeZone:M}=this.props;for(let I of b.series)for(let L of I.fields)if(L.config.unit==="percent"||L.config.unit==="percentunit"){const B=L.config.min??0,j=L.config.max??(L.config.unit==="percent"?100:1);L.state=L.state??{},L.state.range={min:B,max:j,delta:j-B},L.display=(0,c.J)({field:L,theme:p.$W.theme2})}return(0,h.PI)({fieldConfig:O,reduceOptions:T.reduceOptions,replaceVariables:S,theme:p.$W.theme2,data:b.series,timeZone:M})},this.calculateGaugeSize=()=>{const{options:b}=this.props,T=b.orientation,S=b.sizing===n.T6.Manual,O=T===n.wV.Vertical,M=T===n.wV.Horizontal,I=S&&O?b.minVizWidth:y.minVizWidth,L=S&&M?b.minVizHeight:y.minVizHeight;return{minVizWidth:I,minVizHeight:L}}}render(){const{height:b,width:T,data:S,renderCounter:O,options:M}=this.props,{minVizHeight:I,minVizWidth:L}=this.calculateGaugeSize();return(0,l.jsx)(u.S,{getValues:this.getValues,renderValue:this.renderValue,width:T,height:b,source:S,autoGrid:!0,renderCounter:O,orientation:M.orientation,minVizHeight:I,minVizWidth:L})}}var v=e(50082),P=e(38824);class E{getSuggestionsForData(b){const{dataSummary:T}=b;if(!T.hasData||!T.hasNumberField||T.numberFieldCount>=50)return;const S=b.getListAppender({name:P.m.Gauge,pluginId:"gauge",options:{},fieldConfig:{defaults:{thresholds:{steps:[{value:-1/0,color:"green"},{value:70,color:"orange"},{value:85,color:"red"}],mode:v.O.Percentage},custom:{}},overrides:[]},cardOptions:{previewModifier:O=>{O.options.reduceOptions.values&&(O.options.reduceOptions.limit=2)}}});T.hasStringField&&T.frameCount===1&&T.rowCountTotal<10?(S.append({name:P.m.Gauge,options:{reduceOptions:{values:!0,calcs:[]}}}),S.append({name:P.m.GaugeNoThresholds,options:{reduceOptions:{values:!0,calcs:[]},showThresholdMarkers:!1}})):(S.append({name:P.m.Gauge,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]}}}),S.append({name:P.m.GaugeNoThresholds,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]},showThresholdMarkers:!1}}))}}const D=new t.m(x).useFieldConfig({useCustomConfig:C=>{C.addNumberInput({path:"neutral",name:"Neutral",description:"Leave empty to use Min as neutral point",category:["Gauge"],settings:{placeholder:"auto"}})}}).setPanelOptions(C=>{(0,a.L)(C),(0,a.h)(C),C.addBooleanSwitch({path:"showThresholdLabels",name:"Show threshold labels",description:"Render the threshold values around the gauge bar",defaultValue:y.showThresholdLabels}).addBooleanSwitch({path:"showThresholdMarkers",name:"Show threshold markers",description:"Renders the thresholds as an outer bar",defaultValue:y.showThresholdMarkers}).addRadio({path:"sizing",name:"Gauge size",settings:{options:[{value:n.T6.Auto,label:"Auto"},{value:n.T6.Manual,label:"Manual"}]},defaultValue:y.sizing,showIf:b=>b.orientation!==n.wV.Auto}).addSliderInput({path:"minVizWidth",name:"Min width",description:"Minimum column width (vertical orientation)",defaultValue:y.minVizWidth,settings:{min:0,max:600,step:1},showIf:b=>b.sizing===n.T6.Manual&&b.orientation===n.wV.Vertical}).addSliderInput({path:"minVizHeight",name:"Min height",description:"Minimum row height (horizontal orientation)",defaultValue:y.minVizHeight,settings:{min:0,max:600,step:1},showIf:b=>b.sizing===n.T6.Manual&&b.orientation===n.wV.Horizontal}),s.I(C)}).setPanelChangeHandler(i).setSuggestionsSupplier(new E).setMigrationHandler(g)},19743:(G,R,e)=>{"use strict";e.d(R,{x:()=>r});var t=e(74848),n=e(96540),s=e(1173),a=e(74668);const r=({value:g,context:i,onChange:l})=>{const d=(0,n.useCallback)(c=>{l(c?.length?{id:s.jR.byRefId,options:c}:void 0)},[l]);return(0,t.jsx)(a.X,{value:g?.options,onChange:d,data:i.data,placeholder:"Change filter"})}},52995:(G,R,e)=>{"use strict";e.d(R,{P7:()=>n,uM:()=>s,iS:()=>a,KQ:()=>g});var t=e(52622),n=(i=>(i.Opacity="opacity",i.Scheme="scheme",i))(n||{}),s=(i=>(i.Exponential="exponential",i.Linear="linear",i))(s||{}),a=(i=>(i.X="x",i.Xy="xy",i.Y="y",i))(a||{});const r={calculate:!1,cellGap:1,cellValues:{},color:{scheme:"Oranges",fill:"dark-orange",reverse:!1,exponent:.5,steps:64},exemplars:{color:"rgba(255,0,255,0.7)"},filterValues:{le:1e-9},legend:{show:!0},selectionMode:"x",showValue:t.yL.Auto,tooltip:{mode:t.$N.Single,yHistogram:!1,showColorScale:!1}},g={...r,color:{...r.color,mode:n.Scheme,scale:s.Exponential},yAxis:{...r.yAxis,axisPlacement:t.vM.Left},rowsFrame:{...r.rowsFrame,layout:t.D7.auto}}},69386:(G,R,e)=>{"use strict";e.d(R,{K:()=>c});var t=e(74848),n=e(32196),s=e(70255),a=e(80997),r=e(72724),g=e(40845),i=e(72129);function l({width:o,showImage:m,data:u,index:p}){const f=(0,g.of)(h),y=o>600,x=u.get(p),v=encodeURI(x.title);return(0,t.jsxs)("article",{"aria-labelledby":v,className:(0,n.cx)(f.item,y&&f.itemWide),children:[m&&x.ogImage&&(0,t.jsx)("a",{tabIndex:-1,href:a.sQ.sanitizeUrl(x.link),target:"_blank",rel:"noopener noreferrer",className:(0,n.cx)(f.socialImage,y&&f.socialImageWide),"aria-hidden":!0,children:(0,t.jsx)("img",{src:x.ogImage,alt:x.title})}),(0,t.jsxs)("div",{className:f.body,children:[(0,t.jsxs)("time",{className:f.date,dateTime:(0,r.LE)(x.date,{format:"MMM DD"}),children:[(0,r.LE)(x.date,{format:"MMM DD"})," "]}),(0,t.jsx)("a",{className:f.link,href:a.sQ.sanitizeUrl(x.link),target:"_blank",rel:"noopener noreferrer",children:(0,t.jsx)("h3",{className:f.title,id:v,children:x.title})}),(0,t.jsx)("div",{className:f.content,dangerouslySetInnerHTML:{__html:a.sQ.sanitize(x.content)}})]})]})}const d=({width:o,showImage:m,rootProps:u})=>{const p=(0,g.of)(h),f=o>600;return(0,t.jsxs)("div",{className:(0,n.cx)(p.item,f&&p.itemWide),...u,children:[m&&(0,t.jsx)(s.A,{containerClassName:(0,n.cx)(p.socialImage,f&&p.socialImageWide),width:f?"250px":"100%",height:f?"150px":o*.5}),(0,t.jsxs)("div",{className:p.body,children:[(0,t.jsx)(s.A,{containerClassName:p.date,width:60}),(0,t.jsx)(s.A,{containerClassName:p.title,width:250}),(0,t.jsx)(s.A,{containerClassName:p.content,width:"100%",count:6})]})]})},c=(0,i.j)(l,d),h=o=>({container:(0,n.css)({height:"100%"}),item:(0,n.css)({display:"flex",padding:o.spacing(1),position:"relative",marginBottom:o.spacing(.5),marginRight:o.spacing(1),borderBottom:`2px solid ${o.colors.border.weak}`,background:o.colors.background.primary,flexDirection:"column",flexShrink:0}),itemWide:(0,n.css)({flexDirection:"row"}),body:(0,n.css)({display:"flex",flexDirection:"column",flex:1}),socialImage:(0,n.css)({display:"flex",alignItems:"center",marginBottom:o.spacing(1),"> img":{width:"100%",borderRadius:`${o.shape.radius.default} ${o.shape.radius.default} 0 0`}}),socialImageWide:(0,n.css)({marginRight:o.spacing(2),marginBottom:0,"> img":{width:"250px",borderRadius:o.shape.radius.default}}),link:(0,n.css)({color:o.colors.text.link,display:"inline-block","&:hover":{color:o.colors.text.link,textDecoration:"underline"}}),title:(0,n.css)({fontSize:"16px",marginBottom:o.spacing(.5)}),content:(0,n.css)({p:{marginBottom:o.spacing(.5),color:o.colors.text.primary}}),date:(0,n.css)({marginBottom:o.spacing(.5),fontWeight:500,borderRadius:`0 0 0 ${o.shape.radius.default}`,color:o.colors.text.secondary})})},62372:(G,R,e)=>{"use strict";e.d(R,{$:()=>t});const t="https://grafana.com/blog/news.xml"},4172:(G,R,e)=>{"use strict";e.d(R,{n:()=>o});var t=e(41053),n=e(78368);function s(m){const p=new DOMParser().parseFromString(m,"text/xml");return{items:Array.from(p.querySelectorAll("entry")).map(y=>({title:i(y,"title"),link:y.querySelector("link")?.getAttribute("href")??"",content:i(y,"content"),pubDate:i(y,"published"),ogImage:y.querySelector("meta[property='og:image']")?.getAttribute("content")}))}}function a(m){const p=new DOMParser().parseFromString(m,"text/xml");return{items:Array.from(p.querySelectorAll("item")).map(y=>({title:i(y,"title"),link:i(y,"link"),content:i(y,"description"),pubDate:i(y,"pubDate"),ogImage:y.querySelector("meta[property='og:image']")?.getAttribute("content")}))}}async function r(m){return await(await fetch(m)).text()}function g(m){return new DOMParser().parseFromString(m,"text/xml").querySelector("feed")!==null}function i(m,u){return m.querySelector(u)?.textContent??""}async function l(m){const u=await r(m);return g(u)?s(u):a(u)}var d=e(47232),c=e(11261);function h(m){const u=[],p=[],f=[],y=[],x=[];for(const v of m.items){const P=(0,d.KQ)(v.pubDate);try{if(u.push(P.valueOf()),p.push(v.title),f.push(v.link),x.push(v.ogImage),v.content){const E=v.content.replace(/<\/?[^>]+(>|$)/g,"");y.push(E)}}catch(E){console.warn("Error reading news item:",E,v)}}return{fields:[{name:"date",type:c.PU.time,config:{displayName:"Date"},values:u},{name:"title",type:c.PU.string,config:{},values:p},{name:"link",type:c.PU.string,config:{},values:f},{name:"content",type:c.PU.string,config:{},values:y},{name:"ogImage",type:c.PU.string,config:{},values:x}],length:u.length}}function o(m){const[u,p]=(0,t.A)(async()=>{const f=await l(m),y=h(f);return new n.R(y)},[m],{loading:!0});return{state:u,getNews:p}}},23799:(G,R,e)=>{"use strict";e.d(R,{L:()=>g,h:()=>i});var t=e(69550),n=e(75059),s=e(28240),a=e(54479),r=e(52622);function g(l,d=!0){const c=["Value options"];l.addRadio({path:"reduceOptions.values",name:"Show",description:"Calculate a single value per column or series or show each row",settings:{options:[{value:!1,label:"Calculate"},{value:!0,label:"All values"}]},category:c,defaultValue:!1}),l.addNumberInput({path:"reduceOptions.limit",name:"Limit",description:"Max number of rows to display",category:c,settings:{placeholder:"25",integer:!0,min:1,max:5e3},showIf:h=>h.reduceOptions.values===!0}),l.addCustomEditor({id:"reduceOptions.calcs",path:"reduceOptions.calcs",name:"Calculation",description:"Choose a reducer function / calculation",category:c,editor:t.D.get("stats-picker").editor,defaultValue:[n.gy.lastNotNull],showIf:h=>h.reduceOptions.values===!1}),d&&l.addSelect({path:"reduceOptions.fields",name:"Fields",description:"Select the fields that should be included in the panel",category:c,settings:{allowCustomValue:!0,options:[],getOptions:async h=>{const o=[{value:"",label:"Numeric Fields"},{value:"/.*/",label:"All Fields"}];if(h&&h.data)for(const m of h.data)for(const u of m.fields){const p=(0,s.Ct)(u,m,h.data),f=`/^${(0,a.jD)(p)}$/`;o.push({value:f,label:p})}return Promise.resolve(o)}},defaultValue:""})}function i(l,d){l.addRadio({path:"orientation",name:"Orientation",description:"Layout orientation",category:d,settings:{options:[{value:r.wV.Auto,label:"Auto"},{value:r.wV.Horizontal,label:"Horizontal"},{value:r.wV.Vertical,label:"Vertical"}]},defaultValue:r.wV.Auto})}},36373:(G,R,e)=>{"use strict";e.r(R),e.d(R,{plugin:()=>D});var t=e(65158),n=e(52622),s=e(71242),a=e(63250),r=e(24293);const g=(C,b,T)=>{const S=(0,a.gl)(C,b,T);if(T.angular&&(b==="singlestat"||b==="grafana-singlestat-panel")){const O=T.angular;if(S.graphMode=n.$p.None,O.sparkline&&O.sparkline.show&&(S.graphMode=n.$p.Area),O.colorBackground)S.colorMode=n.yp.Background;else if(O.colorValue)S.colorMode=n.yp.Value;else if(S.colorMode=n.yp.None,O.sparkline?.lineColor&&S.graphMode===n.$p.Area){const M=C.fieldConfig??{};M.defaults.color={mode:r.Y.Fixed,fixedColor:O.sparkline.lineColor},C.fieldConfig=M}O.valueName==="name"&&(S.textMode=n.SV.Name)}return S};var i=e(74848),l=e(2543),d=e(96540),c=e(11261),h=e(56323),o=e(90708),m=e(37494),u=e(59796),p=e(12509),f=e(2913);class y extends d.PureComponent{constructor(){super(...arguments),this.renderComponent=(b,T)=>{const{timeRange:S,options:O}=this.props,{value:M,alignmentFactors:I,width:L,height:B,count:j}=b,{openMenu:A,targetClassName:K}=T;let W=M.sparkline;return W&&(W.timeRange=S),(0,i.jsx)(m.yV,{value:M.display,count:j,sparkline:W,colorMode:O.colorMode,graphMode:O.graphMode,justifyMode:O.justifyMode,textMode:this.getTextMode(),alignmentFactors:I,text:O.text,width:L,height:B,theme:f.$W.theme2,onClick:A,className:K,disableWideLayout:!O.wideLayout,percentChangeColorMode:O.percentChangeColorMode})},this.renderValue=b=>{const{value:T}=b,{getLinks:S,hasLinks:O}=T;return O&&S?(0,i.jsx)(u.e,{links:S,children:M=>this.renderComponent(b,M)}):this.renderComponent(b,{})},this.getValues=()=>{const{data:b,options:T,replaceVariables:S,fieldConfig:O,timeZone:M}=this.props;let I;for(let L of b.series)for(let B of L.fields){let{config:j}=B;if(B.type===c.PU.number){if(B.state?.range)continue;!I&&(!(0,l.isNumber)(j.min)||!(0,l.isNumber)(j.max))&&(I=(0,o.nJ)(b.series));const A=j.min??I.min,K=j.max??I.max;B.state=B.state??{},B.state.range={min:A,max:K,delta:K-A}}}return(0,h.PI)({fieldConfig:O,reduceOptions:T.reduceOptions,replaceVariables:S,theme:f.$W.theme2,data:b.series,sparkline:T.graphMode!==n.$p.None,percentChange:T.showPercentChange,timeZone:M})}}getTextMode(){const{options:b,fieldConfig:T,title:S}=this.props;return b.textMode===n.SV.Auto&&(T.defaults.displayName||!S)?n.SV.ValueAndName:b.textMode}render(){const{height:b,options:T,width:S,data:O,renderCounter:M}=this.props;return(0,i.jsx)(p.S,{getValues:this.getValues,getAlignmentFactors:h.XS,renderValue:this.renderValue,width:S,height:b,source:O,itemSpacing:3,renderCounter:M,autoGrid:!0,orientation:T.orientation})}}var x=e(23799);const v={colorMode:n.yp.Value,graphMode:n.$p.Area,justifyMode:n.F8.Auto,percentChangeColorMode:n.CD.Standard,showPercentChange:!1,textMode:n.SV.Auto,wideLayout:!0};var P=e(38824);class E{getSuggestionsForData(b){const{dataSummary:T}=b;if(!T.hasData)return;const S=b.getListAppender({name:P.m.Stat,pluginId:"stat",options:{},fieldConfig:{defaults:{unit:"short",custom:{}},overrides:[]},cardOptions:{previewModifier:O=>{O.options.reduceOptions.values&&(O.options.reduceOptions.limit=1)}}});T.hasStringField&&T.hasNumberField&&T.frameCount===1&&T.rowCountTotal<10&&(S.append({name:P.m.Stat,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"}}}),S.append({name:P.m.StatColoredBackground,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"},colorMode:n.yp.Background}})),T.stringFieldCount===1&&T.frameCount===1&&T.rowCountTotal<10&&T.fieldCount===1&&S.append({name:P.m.Stat,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"},colorMode:n.yp.None}}),T.hasNumberField&&T.hasTimeField&&(S.append({options:{reduceOptions:{values:!1,calcs:["lastNotNull"]}}}),S.append({name:P.m.StatColoredBackground,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]},graphMode:n.$p.None,colorMode:n.yp.Background}}))}}const D=new t.m(y).useFieldConfig().setPanelOptions(C=>{const b=["Stat styles"];(0,x.L)(C),(0,x.h)(C,b),s.I(C),C.addSelect({path:"textMode",name:"Text mode",description:"Control if name and value is displayed or just name",category:b,settings:{options:[{value:n.SV.Auto,label:"Auto"},{value:n.SV.Value,label:"Value"},{value:n.SV.ValueAndName,label:"Value and name"},{value:n.SV.Name,label:"Name"},{value:n.SV.None,label:"None"}]},defaultValue:v.textMode}).addRadio({path:"wideLayout",name:"Wide layout",category:b,settings:{options:[{value:!0,label:"On"},{value:!1,label:"Off"}]},defaultValue:v.wideLayout,showIf:T=>T.textMode===n.SV.ValueAndName}),C.addSelect({path:"colorMode",name:"Color mode",defaultValue:n.yp.Value,category:b,settings:{options:[{value:n.yp.None,label:"None"},{value:n.yp.Value,label:"Value"},{value:n.yp.Background,label:"Background Gradient"},{value:n.yp.BackgroundSolid,label:"Background Solid"}]}}).addRadio({path:"graphMode",name:"Graph mode",description:"Stat panel graph / sparkline mode",category:b,defaultValue:v.graphMode,settings:{options:[{value:n.$p.None,label:"None"},{value:n.$p.Area,label:"Area"}]}}).addRadio({path:"justifyMode",name:"Text alignment",defaultValue:v.justifyMode,category:b,settings:{options:[{value:n.F8.Auto,label:"Auto"},{value:n.F8.Center,label:"Center"}]}}).addBooleanSwitch({path:"showPercentChange",name:"Show percent change",defaultValue:v.showPercentChange,category:b,showIf:T=>!T.reduceOptions.values}).addSelect({path:"percentChangeColorMode",name:"Percent change color mode",defaultValue:v.percentChangeColorMode,category:b,settings:{options:[{value:n.CD.Standard,label:"Standard"},{value:n.CD.Inverted,label:"Inverted"},{value:n.CD.SameAsValue,label:"Same as Value"}]},showIf:T=>T.showPercentChange})}).setNoPadding().setPanelChangeHandler(g).setSuggestionsSupplier(new E).setMigrationHandler(a._$)},11082:(G,R,e)=>{"use strict";e.d(R,{Z:()=>g});var t=e(74848),n=e(66864),s=e(94354),a=e(51275);const r=[{label:"Never",value:!1},{label:"Threshold",value:36e5}],g=({value:i,onChange:l,item:d})=>{const c=typeof i=="number";return r[1].value=c?i:36e5,(0,t.jsxs)(n.Gy,{children:[(0,t.jsx)(s.z,{value:i,options:r,onChange:l}),c&&(0,t.jsx)(a.g,{value:i,onChange:l,inputPrefix:a.F.GreaterThan,isTime:d.settings?.isTime??!1})]})}},43228:(G,R,e)=>{"use strict";e.d(R,{F:()=>c});var t=e(74848),n=e(96540),s=e(66864),a=e(94354),r=e(90182),g=e(29158);const i=[{label:"Solid",value:"solid"},{label:"Dash",value:"dash"},{label:"Dots",value:"dot"}],l=["10, 10","10, 15","10, 20","10, 25","10, 30","10, 40","15, 10","20, 10","25, 10","30, 10","40, 10","50, 10","5, 10","30, 3, 3"].map(o=>({label:o,value:o})),d=["0, 10","0, 20","0, 30","0, 40","0, 3, 3"].map(o=>({label:o,value:o})),c=({value:o,onChange:m})=>{const u=(0,n.useMemo)(()=>o?.fill==="dash"?l:d,[o]),p=(0,n.useMemo)(()=>{if(!o?.dash?.length)return u[0];const f=o.dash?.join(", "),y=u.find(x=>x.value===f);return y||{label:f,value:f}},[o,u]);return(0,t.jsxs)(s.Gy,{children:[(0,t.jsx)(a.z,{value:o?.fill||"solid",options:i,onChange:f=>{let y;f==="dot"?y=h(d[0].value):f==="dash"&&(y=h(l[0].value)),m({...o,fill:f,dash:y})}}),o?.fill&&o?.fill!=="solid"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.l6,{allowCustomValue:!0,options:u,value:p,width:20,onChange:f=>{m({...o,dash:h(f.value??"")})},formatCreateLabel:f=>`Segments: ${h(f).join(", ")}`}),(0,t.jsxs)("div",{children:["\xA0",(0,t.jsx)("a",{title:"The input expects a segment list",href:"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/setLineDash#Parameters",target:"_blank",rel:"noreferrer",children:(0,t.jsx)(g.K,{name:"question-circle",tooltip:"Help"})})]})]})]})};function h(o){const m=[];for(const u of o.split(/(?:,| )+/)){const p=Number.parseInt(u,10);isNaN(p)||m.push(p)}return m}},51275:(G,R,e)=>{"use strict";e.d(R,{F:()=>a,g:()=>r});var t=e(74848),n=e(65879),s=e(10354),a=(g=>(g.LessThan="lessthan",g.GreaterThan="greaterthan",g))(a||{});const r=({value:g,onChange:i,inputPrefix:l,isTime:d})=>{let c=n.secondsToHms(g/1e3);d||(c="10");const h=p=>{let f=!1;if(p)try{d&&n.isValidTimeSpan(p)?f=n.intervalToMs(p):f=Number(p)}catch(y){console.warn("ERROR",y)}i(f)},o=p=>{p.key==="Enter"&&h(p.currentTarget.value)},m=p=>{h(p.currentTarget.value)},u=l==="greaterthan"?(0,t.jsx)("div",{children:">"}):l==="lessthan"?(0,t.jsx)("div",{children:"<"}):null;return(0,t.jsx)(s.p,{autoFocus:!1,placeholder:"never",width:10,defaultValue:c,onKeyDown:o,onBlur:m,prefix:u,spellCheck:!1})}},34163:(G,R,e)=>{"use strict";e.d(R,{e:()=>g});var t=e(74848),n=e(66864),s=e(94354),a=e(51275);const r=[{label:"Never",value:!1},{label:"Always",value:!0},{label:"Threshold",value:36e5}],g=({value:i,onChange:l,item:d})=>{const c=typeof i=="number";return r[2].value=c?i:36e5,(0,t.jsxs)(n.Gy,{children:[(0,t.jsx)(s.z,{value:i,options:r,onChange:l}),c&&(0,t.jsx)(a.g,{value:i,onChange:l,inputPrefix:a.F.LessThan,isTime:d.settings?.isTime??!1})]})}},24882:(G,R,e)=>{"use strict";e.d(R,{D:()=>a});var t=e(74848),n=e(96540),s=e(90182);const a=({item:r,value:g,onChange:i,id:l})=>{const d=(0,n.useCallback)(c=>{i({mode:c.value})},[i]);return(0,t.jsx)(s.l6,{inputId:l,value:g.mode,options:r.settings?.options??[],onChange:d})}},41706:(G,R,e)=>{"use strict";e.d(R,{S:()=>u,V:()=>f});var t=e(37055),n=e(24293),s=e(11261),a=e(27310),r=e(52622),g=e(52198),i=e(56675),l=e(38248),d=e(11404),c=e(11082),h=e(43228),o=e(34163),m=e(24882);const u={drawStyle:r.GR.Line,lineInterpolation:r.dx.Linear,lineWidth:1,fillOpacity:0,gradientMode:r.on.None,barAlignment:r.Nj.Center,barWidthFactor:.6,stacking:{mode:r.gs.None,group:"A"},axisGridShow:!0,axisCenteredZero:!1,axisBorderShow:!1},p=["Graph styles"];function f(y,x=!0){return{standardOptions:{[t.uo.Color]:{settings:{byValueSupport:!0,bySeriesSupport:!0,preferThresholdsMode:!1},defaultValue:{mode:n.Y.PaletteClassic}}},useCustomConfig:v=>{v.addRadio({path:"drawStyle",name:"Style",category:p,defaultValue:y.drawStyle,settings:{options:g.t.drawStyle}}).addRadio({path:"lineInterpolation",name:"Line interpolation",category:p,defaultValue:y.lineInterpolation,settings:{options:g.t.lineInterpolation},showIf:P=>P.drawStyle===r.GR.Line}).addRadio({path:"barAlignment",name:"Bar alignment",category:p,defaultValue:y.barAlignment,settings:{options:g.t.barAlignment},showIf:P=>P.drawStyle===r.GR.Bars}).addSliderInput({path:"barWidthFactor",name:"Bar width factor",category:p,defaultValue:y.barWidthFactor,settings:{min:.1,max:1,step:.1,ariaLabelForHandle:"Bar width factor"},showIf:P=>P.drawStyle===r.GR.Bars}).addSliderInput({path:"lineWidth",name:"Line width",category:p,defaultValue:y.lineWidth,settings:{min:0,max:10,step:1,ariaLabelForHandle:"Line width"},showIf:P=>P.drawStyle!==r.GR.Points}).addSliderInput({path:"fillOpacity",name:"Fill opacity",category:p,defaultValue:y.fillOpacity,settings:{min:0,max:100,step:1,ariaLabelForHandle:"Fill opacity"},showIf:P=>P.drawStyle!==r.GR.Points}).addRadio({path:"gradientMode",name:"Gradient mode",category:p,defaultValue:g.t.fillGradient[0].value,settings:{options:g.t.fillGradient},showIf:P=>P.drawStyle!==r.GR.Points}).addFieldNamePicker({path:"fillBelowTo",name:"Fill below to",category:p,hideFromDefaults:!0,settings:{filter:P=>P.type===s.PU.number}}).addCustomEditor({id:"lineStyle",path:"lineStyle",name:"Line style",category:p,showIf:P=>P.drawStyle===r.GR.Line,editor:h.F,override:h.F,process:a.hS,shouldApply:P=>P.type===s.PU.number}).addCustomEditor({id:"spanNulls",path:"spanNulls",name:"Connect null values",category:p,defaultValue:!1,editor:o.e,override:o.e,showIf:P=>P.drawStyle===r.GR.Line,shouldApply:P=>P.type!==s.PU.time,process:a.hS,settings:{isTime:x}}).addCustomEditor({id:"insertNulls",path:"insertNulls",name:"Disconnect values",category:p,defaultValue:!1,editor:c.Z,override:c.Z,showIf:P=>P.drawStyle===r.GR.Line,shouldApply:P=>P.type!==s.PU.time,process:a.hS,settings:{isTime:x}}).addRadio({path:"showPoints",name:"Show points",category:p,defaultValue:g.t.showPoints[0].value,settings:{options:g.t.showPoints},showIf:P=>P.drawStyle!==r.GR.Points}).addSliderInput({path:"pointSize",name:"Point size",category:p,defaultValue:5,settings:{min:1,max:40,step:1,ariaLabelForHandle:"Point size"},showIf:P=>P.showPoints!==r.yL.Never||P.drawStyle===r.GR.Points}),i.I(v,y.stacking,p),v.addSelect({category:p,name:"Transform",path:"transform",settings:{options:[{label:"Constant",value:r.NU.Constant,description:"The first value will be shown as a constant line"},{label:"Negative Y",value:r.NU.NegativeY,description:"Flip the results to negative values on the y axis"}],isClearable:!0},hideFromDefaults:!0}),l.r(v,y),d.e(v),v.addCustomEditor({id:"thresholdsStyle",path:"thresholdsStyle",name:"Show thresholds",category:["Thresholds"],defaultValue:{mode:r.Ly.Off},settings:{options:g.t.thresholdsDisplayModes},editor:m.D,override:m.D,process:a.hS,shouldApply:()=>!0})}}}},37171:(G,R,e)=>{"use strict";e.d(R,{jK:()=>hn,kz:()=>dn});var t=e(74848),n=e(54148),s=e(39070),a=e(32196),r=e(40845),g=e(21780),i=e(25249),l=e(10860);function d({description:Ze,text:lt,url:yt}){const Nt=(0,r.of)(c);return(0,t.jsxs)(l.Z,{className:Nt.card,href:yt,children:[(0,t.jsx)(l.Z.Heading,{children:lt}),(0,t.jsx)(l.Z.Description,{className:Nt.description,children:Ze})]})}const c=Ze=>({card:(0,a.css)({marginBottom:0,gridTemplateRows:"1fr 0 2fr"}),description:(0,a.css)({WebkitLineClamp:3,WebkitBoxOrient:"vertical",display:"-webkit-box",overflow:"hidden"})});function h({navId:Ze,header:lt}){const{node:yt}=(0,i.C)(Ze),Nt=(0,r.of)(o),wt=yt.children?.filter(Zt=>!Zt.hideFromTabs);return(0,t.jsx)(g.YW,{navId:yt.id,children:(0,t.jsx)(g.YW.Contents,{children:(0,t.jsxs)("div",{className:Nt.content,children:[lt,wt&&wt.length>0&&(0,t.jsx)("section",{className:Nt.grid,children:wt?.map(Zt=>(0,t.jsx)(d,{description:Zt.subTitle,text:Zt.text,url:Zt.url??""},Zt.id))})]})})})}const o=Ze=>({content:(0,a.css)({display:"flex",flexDirection:"column",gap:Ze.spacing(2)}),grid:(0,a.css)({display:"grid",gap:Ze.spacing(3),gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gridAutoRows:"138px",padding:Ze.spacing(2,0)})});var m=e(64915),u=e(2913),p=e(16233),f=e(96540),y=e(49785),x=e(71468),v=e(33378),P=e(67061),E=e(42418),D=e(88575),C=e(10354),b=e(55852),T=e(10096),S=e(31678),O=e(57334),M=e(56034),I=e(14578),L=e(94753),B=e(48840);const j=({ldapConnectionInfo:Ze})=>{const lt=(0,f.useMemo)(()=>[{id:"host",header:"Host",disableGrow:!0},{id:"port",header:"Port",disableGrow:!0},{id:"available",cell:Nt=>Nt.cell.value?(0,t.jsx)(P.B,{justifyContent:"end",children:(0,t.jsx)(M.m,{content:"Connection is available",children:(0,t.jsx)(I.I,{name:"check"})})}):(0,t.jsx)(P.B,{justifyContent:"end",children:(0,t.jsx)(M.m,{content:"Connection is not available",children:(0,t.jsx)(I.I,{name:"exclamation-triangle"})})})}],[]),yt=(0,f.useMemo)(()=>Ze,[Ze]);return(0,t.jsx)("section",{children:(0,t.jsxs)(P.B,{direction:"column",gap:2,children:[(0,t.jsx)(L.E,{color:"primary",element:"h3",children:"LDAP Connection"}),(0,t.jsx)(B.j,{data:yt,columns:lt,getRowId:Nt=>Nt.host+Nt.port}),(0,t.jsx)(A,{ldapConnectionInfo:Ze})]})})},A=({ldapConnectionInfo:Ze})=>{if(!Ze.some(wt=>wt.error))return null;const yt=[];Ze.forEach(wt=>{wt.error&&yt.push(wt)});const Nt=yt.map((wt,Zt)=>(0,t.jsxs)("div",{children:[(0,t.jsxs)("span",{style:{fontWeight:500},children:[wt.host,":",wt.port,(0,t.jsx)("br",{})]}),(0,t.jsx)("span",{children:wt.error}),Zt!==yt.length-1&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("br",{}),(0,t.jsx)("br",{})]})]},Zt));return(0,t.jsx)(E.F,{title:"Connection error",severity:S.AppNotificationSeverity.Error,children:Nt})};var K=e(72724);const W="dddd YYYY-MM-DD HH:mm zz",U=({ldapSyncInfo:Ze})=>{const lt=(0,K.LE)(Ze.nextSync,{format:W}),yt=[{id:"syncAttribute"},{id:"syncValue"}],Nt=[{syncAttribute:"Active synchronization",syncValue:Ze.enabled?"Enabled":"Disabled"},{syncAttribute:"Scheduled",syncValue:Ze.schedule},{syncAttribute:"Next synchronization",syncValue:lt}];return(0,t.jsxs)("section",{children:[(0,t.jsx)(L.E,{element:"h3",children:"LDAP Synchronization"}),(0,t.jsx)(B.j,{data:Nt,columns:yt,getRowId:wt=>wt.syncAttribute})]})};var F=e(90613);const V=({groups:Ze})=>{const lt=(0,f.useMemo)(()=>Ze,[Ze]),yt=(0,f.useMemo)(()=>[{id:"groupDN",header:"LDAP Group"},{id:"orgName",header:"Organization",cell:Nt=>Nt.value&&Nt.row.original.orgRole?Nt.value:""},{id:"orgRole",header:"Role",cell:Nt=>Nt.value||(0,t.jsxs)(t.Fragment,{children:["No match"," ",(0,t.jsx)(M.m,{content:"No matching organizations found",children:(0,t.jsx)(I.I,{name:"info-circle"})})]})}],[]);return(0,t.jsx)(B.j,{headerTooltips:{orgName:{content:"Only the first match for an Organization will be used",iconName:"info-circle"}},columns:yt,data:lt,getRowId:Nt=>Nt.orgId+Nt.orgRole+Nt.groupDN})},w=({info:Ze})=>{const lt=(0,f.useMemo)(()=>[{id:"userInfo",header:"User Information",disableGrow:!0},{id:"ldapValue"},{id:"cfgAttrValue",header:"LDAP attribute"}],[]),yt=(0,f.useMemo)(()=>[{userInfo:"First name",ldapValue:Ze.name.ldapValue,cfgAttrValue:Ze.name.cfgAttrValue},{userInfo:"Surname",ldapValue:Ze.surname.ldapValue,cfgAttrValue:Ze.surname.cfgAttrValue},{userInfo:"Username",ldapValue:Ze.login.ldapValue,cfgAttrValue:Ze.login.cfgAttrValue},{userInfo:"Email",ldapValue:Ze.email.ldapValue,cfgAttrValue:Ze.email.cfgAttrValue}],[Ze]);return(0,t.jsx)(B.j,{columns:lt,data:yt,getRowId:Nt=>Nt.userInfo})},z=({permissions:Ze})=>{const lt=(0,f.useMemo)(()=>[{id:"permission",header:"Permissions",disableGrow:!0},{id:"value"}],[]),yt=(0,f.useMemo)(()=>[{permission:"Grafana admin",value:Ze.isGrafanaAdmin?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(I.I,{name:"shield"})," Yes"]}):"No"},{permission:"Status",value:Ze.isDisabled?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(I.I,{name:"times"})," Inactive"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(I.I,{name:"check"})," Active"]})}],[Ze]);return(0,t.jsx)(B.j,{data:yt,columns:lt,getRowId:Nt=>Nt.permission})},N=({teams:Ze})=>{const lt=(0,f.useMemo)(()=>[{id:"groupDN",header:"LDAP Group"},{id:"orgName",header:"Organization",cell:({row:{original:{orgName:yt}}})=>(0,t.jsx)(t.Fragment,{children:yt||"No matching teams found"})},{id:"teamName",header:"Team",cell:({row:{original:{teamName:yt,orgName:Nt}}})=>yt&&Nt?yt:""}],[]);return(0,t.jsx)(B.j,{data:Ze,columns:lt,getRowId:yt=>yt.teamName})},H=({ldapUser:Ze})=>(0,t.jsxs)(P.B,{direction:"column",gap:4,children:[(0,t.jsx)(w,{info:Ze.info}),(0,t.jsx)(z,{permissions:Ze.permissions}),Ze.roles&&Ze.roles.length>0&&(0,t.jsx)(V,{groups:Ze.roles}),Ze.teams&&Ze.teams.length>0?(0,t.jsx)(N,{teams:Ze.teams}):(0,t.jsx)(F.a,{children:(0,t.jsx)(L.E,{children:"No teams found via LDAP"})})]}),Q={text:"LDAP",subTitle:"Verify your LDAP and user mapping configuration.",icon:"book",id:"LDAP"},X=({clearUserMappingInfo:Ze,queryParams:lt,loadLdapState:yt,loadLdapSyncStatus:Nt,loadUserMapping:wt,clearUserError:Zt,ldapUser:pn,userError:On,ldapError:An,ldapSyncInfo:qn,ldapConnectionInfo:cs})=>{const[Os,xs]=(0,f.useState)(!0),{register:zs,handleSubmit:Ks}=(0,y.mN)(),ma=(0,f.useCallback)(async Pa=>wt(Pa),[wt]);(0,f.useEffect)(()=>{const Pa=async()=>Promise.all([yt(),Nt()]);async function wa(){await Ze(),await Pa(),lt.username&&await ma(lt.username),xs(!1)}wa()},[Ze,ma,yt,Nt,lt]);const la=({username:Pa})=>{Pa&&ma(Pa)},Ua=()=>{Zt()},Ra=T.TP.hasPermission(S.AccessControlAction.LDAPUsersRead);return(0,t.jsx)(g.YW,{navId:"authentication",pageNav:Q,children:(0,t.jsx)(g.YW.Contents,{isLoading:Os,children:(0,t.jsxs)(P.B,{direction:"column",gap:4,children:[An&&An.title&&(0,t.jsx)(E.F,{title:An.title,severity:S.AppNotificationSeverity.Error,children:An.body}),(0,t.jsx)(j,{ldapConnectionInfo:cs}),(0,v.a)("ldapsync")&&qn&&(0,t.jsx)(U,{ldapSyncInfo:qn}),Ra&&(0,t.jsxs)("section",{children:[(0,t.jsx)("h3",{children:"Test user mapping"}),(0,t.jsx)("form",{onSubmit:Ks(la),children:(0,t.jsx)(D.D,{label:"Username",children:(0,t.jsx)(C.p,{...zs("username",{required:!0}),width:34,id:"username",type:"text",defaultValue:lt.username,addonAfter:(0,t.jsx)(b.$n,{variant:"primary",type:"submit",children:"Run"})})})}),On&&On.title&&(0,t.jsx)(E.F,{title:On.title,severity:S.AppNotificationSeverity.Error,onRemove:Ua,children:On.body}),pn&&(0,t.jsx)(H,{ldapUser:pn})]})]})})})},ee=Ze=>({ldapConnectionInfo:Ze.ldap.connectionInfo,ldapUser:Ze.ldap.user,ldapSyncInfo:Ze.ldap.syncInfo,userError:Ze.ldap.userError,ldapError:Ze.ldap.ldapError}),Z={loadLdapState:O.JI,loadLdapSyncStatus:O.pm,loadUserMapping:O.Kg,clearUserError:O.DX,clearUserMappingInfo:O.Jc},ae=(0,x.connect)(ee,Z)(X);var k=e(27921),se=e(99085),te=e(75471);function ne(Ze=u.$W){return[{path:"/alerting",component:le(()=>e.e(3236).then(e.bind(e,86695)))},{path:"/alerting/home",exact:!1,component:le(()=>e.e(3236).then(e.bind(e,86695)))},{path:"/alerting/list",roles:(0,te.C0)([S.AccessControlAction.AlertingRuleRead,S.AccessControlAction.AlertingRuleExternalRead]),component:le(()=>Promise.all([e.e(5279),e.e(829),e.e(3511)]).then(e.bind(e,77253)))},{path:"/alerting/routes",roles:(0,te.C0)([S.AccessControlAction.AlertingNotificationsRead,S.AccessControlAction.AlertingNotificationsExternalRead]),component:le(()=>Promise.all([e.e(5279),e.e(2839),e.e(6719)]).then(e.bind(e,69510)))},{path:"/alerting/routes/mute-timing/new",roles:(0,te.C0)([S.AccessControlAction.AlertingNotificationsWrite,S.AccessControlAction.AlertingNotificationsExternalWrite]),component:le(()=>Promise.all([e.e(9241),e.e(8302)]).then(e.bind(e,66162)))},{path:"/alerting/routes/mute-timing/edit",roles:(0,te.C0)([S.AccessControlAction.AlertingNotificationsWrite,S.AccessControlAction.AlertingNotificationsExternalWrite]),component:le(()=>Promise.all([e.e(9241),e.e(558)]).then(e.bind(e,58125)))},{path:"/alerting/silences",roles:(0,te.C0)([S.AccessControlAction.AlertingInstanceRead,S.AccessControlAction.AlertingInstancesExternalRead,S.AccessControlAction.AlertingSilenceRead]),component:le(()=>e.e(9347).then(e.bind(e,69645)))},{path:"/alerting/silence/new",roles:(0,te.C0)([S.AccessControlAction.AlertingInstanceCreate,S.AccessControlAction.AlertingInstancesExternalWrite,S.AccessControlAction.AlertingSilenceCreate,S.AccessControlAction.AlertingSilenceUpdate]),component:le(()=>e.e(9347).then(e.bind(e,69645)))},{path:"/alerting/silence/:id/edit",component:le(()=>e.e(9347).then(e.bind(e,69645)))},{path:"/alerting/notifications",roles:(0,te.C0)([S.AccessControlAction.AlertingNotificationsRead,S.AccessControlAction.AlertingNotificationsExternalRead,...se.w]),component:le(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/templates/*",roles:(0,te.C0)([S.AccessControlAction.AlertingNotificationsRead,S.AccessControlAction.AlertingNotificationsExternalRead]),component:le(()=>e.e(9224).then(e.bind(e,35868)))},{path:"/alerting/notifications/:type/new",roles:(0,te.C0)([S.AccessControlAction.AlertingNotificationsWrite,S.AccessControlAction.AlertingNotificationsExternalWrite,...se.t]),component:le(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/receivers/:id/edit",roles:(0,te.C0)([S.AccessControlAction.AlertingNotificationsWrite,S.AccessControlAction.AlertingNotificationsExternalWrite,S.AccessControlAction.AlertingNotificationsRead,S.AccessControlAction.AlertingNotificationsExternalRead,...se.w]),component:le(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/:type/:id/edit",roles:(0,te.C0)([S.AccessControlAction.AlertingNotificationsWrite,S.AccessControlAction.AlertingNotificationsExternalWrite]),component:le(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/:type/:id/duplicate",roles:(0,te.C0)([S.AccessControlAction.AlertingNotificationsWrite,S.AccessControlAction.AlertingNotificationsExternalWrite]),component:le(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/:type",roles:(0,te.C0)([S.AccessControlAction.AlertingNotificationsWrite,S.AccessControlAction.AlertingNotificationsExternalWrite]),component:le(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/groups/",roles:(0,te.C0)([S.AccessControlAction.AlertingInstanceRead,S.AccessControlAction.AlertingInstancesExternalRead]),component:le(()=>e.e(8427).then(e.bind(e,12564)))},{path:"/alerting/history/",roles:(0,te.C0)([S.AccessControlAction.AlertingRuleRead]),component:le(()=>Promise.all([e.e(8895),e.e(285),e.e(44)]).then(e.bind(e,57362)))},{path:"/alerting/new/:type?",pageClass:"page-alerting",roles:(0,te.C0)([S.AccessControlAction.AlertingRuleCreate,S.AccessControlAction.AlertingRuleExternalWrite]),component:le(()=>Promise.all([e.e(5279),e.e(8373),e.e(829),e.e(2839),e.e(4009)]).then(e.bind(e,44848)))},{path:"/alerting/:id/edit",pageClass:"page-alerting",roles:(0,te.C0)([S.AccessControlAction.AlertingRuleUpdate,S.AccessControlAction.AlertingRuleExternalWrite]),component:le(()=>Promise.all([e.e(5279),e.e(8373),e.e(829),e.e(2839),e.e(4009)]).then(e.bind(e,44848)))},{path:"/alerting/:id/modify-export",pageClass:"page-alerting",roles:(0,te.C0)([S.AccessControlAction.AlertingRuleRead]),component:le(()=>Promise.all([e.e(5279),e.e(8373),e.e(829),e.e(2839),e.e(4009)]).then(e.bind(e,69179)))},{path:"/alerting/:sourceName/:id/view",pageClass:"page-alerting",roles:(0,te.C0)([S.AccessControlAction.AlertingRuleRead,S.AccessControlAction.AlertingRuleExternalRead]),component:le(()=>Promise.resolve().then(e.bind(e,79741)))},{path:"/alerting/:sourceName/:name/find",pageClass:"page-alerting",roles:(0,te.C0)([S.AccessControlAction.AlertingRuleRead,S.AccessControlAction.AlertingRuleExternalRead]),component:le(()=>e.e(5516).then(e.bind(e,6165)))},{path:"/alerting/admin",roles:()=>["Admin"],component:le(()=>e.e(9438).then(e.bind(e,53191)))}]}function le(Ze){const lt=()=>e.e(9029).then(e.bind(e,5961));return(0,k.A)(u.$W.unifiedAlertingEnabled?Ze:lt)}var re=e(78742),de=e(6320);const oe=Ze=>({alertContent:(0,a.css)`
    display: flex;
    flex-direction: row;
    padding: 0;
    justify-content: space-between;
    align-items: center;
  `,alertParagraph:(0,a.css)`
    margin: 0 ${Ze.spacing(1)} 0 0;
    line-height: ${Ze.spacing(Ze.components.height.sm)};
  `});function J(){const Ze=(0,r.of)(oe),lt=T.TP.hasPermission(S.AccessControlAction.DataSourcesCreate)||T.TP.hasPermission(S.AccessControlAction.DataSourcesWrite),[yt,Nt]=(0,f.useState)(lt);return yt?(0,t.jsx)(E.F,{severity:"info",title:"",onRemove:()=>Nt(!1),children:(0,t.jsxs)("div",{className:Ze.alertContent,children:[(0,t.jsx)("p",{className:Ze.alertParagraph,children:"Data sources have a new home! You can discover new data sources or manage existing ones in the Connections page, accessible from the main menu."}),(0,t.jsx)(b.z9,{"aria-label":"Link to Connections",icon:"arrow-right",href:de.b.DataSources,fill:"text",children:"Go to connections"})]})}):(0,t.jsx)(t.Fragment,{})}function ce(){return[{path:`/${de.q}`,exact:!1,component:(0,k.A)(()=>Promise.all([e.e(4258),e.e(4007),e.e(4753),e.e(6359),e.e(7743),e.e(2154)]).then(e.bind(e,34362)))}]}var pe=e(83883),xe=e(39964),fe=e(57220),Ee=e(14110),Se=(Ze=>(Ze.ViewIRMMainPage="grafana_irm_configuration_tracker_main_page_view",Ze.OpenEssentials="grafana_irm_configuration_tracker_essentials_open",Ze.CloseEssentials="grafana_irm_configuration_tracker_essentials_closed",Ze.ClickDataSources="grafana_irm_configuration_tracker_data_sources_clicked",Ze))(Se||{});function ye(Ze,lt){(0,Ee.rR)(Ze,{...lt})}var Ve=e(39601),Me=e(3704),Ce=e(79938),Ue=e(82843),Ae=e(37534),we=e(730);function We(){const[Ze,{data:lt,isLoading:yt}]=Ce.hK.endpoints.rulerRules.useLazyQuery({refetchOnFocus:!0,refetchOnReconnect:!0}),{dsFeatures:Nt,isLoadingDsFeatures:wt}=(0,we.O3)(fe.hY),Zt=Nt?.rulerConfig;return(0,f.useEffect)(()=>{Zt&&Ze({rulerConfig:Zt})},[Zt,Ze]),{isDone:(lt?Object.entries(lt).flatMap(([An,qn])=>qn.flatMap(cs=>cs.rules)):[]).length>0,isLoading:yt||wt}}function _e(Ze){return Ze.some(lt=>lt.grafana_managed_receiver_configs?.some(yt=>yt.type===Ae.J4.OnCall))}function at(){const Ze=Ue.m.endpoints.getAlertmanagerConfiguration.useQuery(fe.hY,{refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{contactPoints:Ze.data?.alertmanager_config?.receivers??[],isLoading:Ze.isLoading}}function ut(){const Ze=Ue.m.endpoints.getAlertmanagerConfiguration.useQuery(fe.hY,{refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{defaultContactpoint:Ze.data?.alertmanager_config?.route?.receiver??"",isLoading:Ze.isLoading}}const Tt="<example@email.com>";function It(Ze,lt){return lt.some(Nt=>Nt.name===Ze&&Nt.grafana_managed_receiver_configs?.some(wt=>wt.name===Ze&&wt.settings?.address!==Tt))}var ge=e(99494),Ie=e(49962);const ue=Ze=>`/api/plugins/${ge.W.Incident}/resources${Ze}`,me=Ie.H.injectEndpoints({endpoints:Ze=>({getIncidentsPluginConfig:Ze.query({query:()=>({url:ue("/api/ConfigurationTrackerService.GetConfigurationTracker"),data:{},method:"POST",showErrorAlert:!1})})})});var Pe=e(12210);function Ne(){const{installed:Ze,loading:lt}=(0,Pe._)(ge.W.Incident),{data:yt,isLoading:Nt}=me.endpoints.getIncidentsPluginConfig.useQuery();return{isInstalled:Ze??!1,isChatOpsInstalled:yt?.isChatOpsInstalled??!1,isIncidentCreated:yt?.isIncidentCreated??!1,isLoading:lt||Nt}}var Fe=e(26423);function Be(){const{installed:Ze}=(0,Pe._)(ge.W.OnCall),{data:lt}=Fe.WG.endpoints.grafanaOnCallIntegrations.useQuery(void 0,{skip:!Ze,refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return lt??[]}function he(){const{data:Ze,isLoading:lt}=Fe.WG.endpoints.onCallConfigChecks.useQuery(void 0,{refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{isLoading:lt,onCallConfigChecks:Ze??{is_chatops_connected:!1,is_integration_chatops_connected:!1}}}function be(){return Be().map(lt=>({label:lt.display_name,value:lt.value}))}function Ke(){const{onCallConfigChecks:{is_chatops_connected:Ze,is_integration_chatops_connected:lt},isLoading:yt}=he();return{is_chatops_connected:Ze,is_integration_chatops_connected:lt,isLoading:yt}}const ze=`/api/plugins/${ge.W.Slo}/resources/v1`,nt=Ie.H.injectEndpoints({endpoints:Ze=>({getSlos:Ze.query({query:()=>({url:`${ze}/slo`,showErrorAlert:!1}),providesTags:["GrafanaSlo"]})})});function tt(){const{installed:Ze}=(0,Pe._)(ge.W.Slo),{data:lt,isLoading:yt}=nt.endpoints.getSlos.useQuery(void 0,{skip:!Ze,refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{isLoading:yt,hasSlo:!!lt?.slos.length,hasSloWithAlert:!!lt?.slos?.some(Nt=>Nt.alerting)}}function ot(){const{contactPoints:Ze,isLoading:lt}=at(),{defaultContactpoint:yt,isLoading:Nt}=ut(),{isDone:wt,isLoading:Zt}=We(),{isChatOpsInstalled:pn,isInstalled:On,isLoading:An}=Ne(),qn=be(),{is_chatops_connected:cs,is_integration_chatops_connected:Os,isLoading:xs}=Ke(),{hasSlo:zs,hasSloWithAlert:Ks,isLoading:ma}=tt();return{alerting:{contactPoints:Ze,defaultContactpoint:yt,isCreateAlertRuleDone:wt},incidents:{isChatOpsInstalled:pn,isIncidentsInstalled:On},onCall:{onCallOptions:qn,is_chatops_connected:cs,is_integration_chatops_connected:Os},slo:{hasSlo:zs,hasSloWithAlert:Ks},isLoading:lt||Nt||Zt||An||xs||ma}}function gt(){const{alerting:{contactPoints:Ze,defaultContactpoint:lt,isCreateAlertRuleDone:yt},incidents:{isChatOpsInstalled:Nt,isIncidentsInstalled:wt},onCall:{onCallOptions:Zt,is_chatops_connected:pn,is_integration_chatops_connected:On},slo:{hasSlo:An,hasSloWithAlert:qn},isLoading:cs}=ot();function Os(ma,la){const Ua=(0,Me.G)(`${la} + ${ma}`,{returnTo:location.pathname+location.search});Ve.Ny.push(Ua)}const xs={sections:[{title:"Detect",description:"Configure Grafana Alerting",steps:[{title:"Update default email contact point",description:"Add a valid email to the default email contact point.",button:{type:"openLink",urlLink:{url:`/alerting/notifications/receivers/${lt}/edit`,queryParams:{alertmanager:"grafana"}},label:"Edit",labelOnDone:"View",urlLinkOnDone:{url:"/alerting/notifications"}},done:It(lt,Ze)},{title:"Connect alerting to OnCall",description:"Create an OnCall integration for an alerting contact point.",button:{type:"openLink",urlLink:{url:"/alerting/notifications/receivers/new"},label:"Connect",urlLinkOnDone:{url:"/alerting/notifications"},labelOnDone:"View"},done:_e(Ze)},{title:"Create alert rule",description:"Create an alert rule to monitor your system.",button:{type:"openLink",urlLink:{url:"/alerting/new"},label:"Create",urlLinkOnDone:{url:"/alerting/list"},labelOnDone:"View"},done:yt},{title:"Create your first SLO",description:"Create SLOs to monitor your service.",button:{type:"openLink",urlLink:{url:"/a/grafana-slo-app/wizard/new"},label:"Create",urlLinkOnDone:{url:"/a/grafana-slo-app/manage-slos"},labelOnDone:"View"},done:An},{title:"Enable SLO alerting",description:"Configure SLO alerting to receive notifications when your SLOs are breached.",button:{type:"openLink",urlLink:{queryParams:{alertsEnabled:"disabled"},url:"/a/grafana-slo-app/manage-slos"},label:"Enable",urlLinkOnDone:{queryParams:{alertsEnabled:"enabled"},url:"/a/grafana-slo-app/manage-slos"},labelOnDone:"View"},done:qn}]},{title:"Respond",description:"Configure OnCall and Incident",steps:[{title:"Initialize Incident plugin",description:"Initialize the Incident plugin to declare and manage incidents.",button:{type:"openLink",urlLink:{url:"/a/grafana-incident-app/walkthrough/generate-key"},label:"Initialize",urlLinkOnDone:{url:"/a/grafana-incident-app"},labelOnDone:"View"},done:wt},{title:"Connect your Messaging workspace to OnCall",description:"Receive alerts and oncall notifications within your chat environment.",button:{type:"openLink",urlLink:{url:"/a/grafana-oncall-app/settings",queryParams:{tab:"ChatOps",chatOpsTab:"Slack"}},label:"Connect",urlLinkOnDone:{url:"/a/grafana-oncall-app/settings",queryParams:{tab:"ChatOps"}},labelOnDone:"View"},done:pn},{title:"Connect your Messaging workspace to Incident",description:"Automatically create an incident channel and manage incidents directly within your chat environment.",button:{type:"openLink",urlLink:{url:"/a/grafana-incident-app/integrations/grate.slack"},label:"Connect",urlLinkOnDone:{url:"/a/grafana-incident-app/integrations"}},done:Nt},{title:"Add Messaging workspace channel to OnCall Integration",description:"Select ChatOps channels to route notifications",button:{type:"openLink",urlLink:{url:"/a/grafana-oncall-app/integrations/"},label:"Add",urlLinkOnDone:{url:"/a/grafana-oncall-app/integrations/"},labelOnDone:"View"},done:On}]},{title:"Test your configuration",description:"",steps:[{title:"Send OnCall demo alert via Alerting integration",description:"In the integration page, click Send demo alert, to review your notification",button:{type:"dropDown",label:"Select integration",options:Zt,onClickOption:ma=>Os(ma,"/a/grafana-oncall-app/integrations/"),stepNotAvailableText:"No integrations available"}},{title:"Create Incident drill",description:"Practice solving an Incident",button:{type:"openLink",urlLink:{url:"/a/grafana-incident-app",queryParams:{declare:"new",drill:"1"}},label:"Start drill"}}]}]},{stepsDone:zs,totalStepsToDo:Ks}=xs.sections.reduce((ma,la)=>{const Ua=la.steps.filter(Pa=>Pa.done).length,Ra=la.steps.reduce((Pa,wa)=>wa.done!==void 0?Pa+1:Pa,0);return{stepsDone:ma.stepsDone+Ua,totalStepsToDo:ma.totalStepsToDo+Ra}},{stepsDone:0,totalStepsToDo:0});return{essentialContent:xs,stepsDone:zs,totalStepsToDo:Ks,isLoading:cs}}const He=({dataSourceConfigurationData:{dataSourceCompatibleWithAlerting:Ze},essentialsConfigurationData:{stepsDone:lt,totalStepsToDo:yt}})=>(0,f.useMemo)(()=>{function Nt(){const wt=Ze?"You have connected a datasource.":"Connect at least one data source to start receiving data",Zt=Ze?"View":"Connect";return{id:ss.CONNECT_DATASOURCE,title:"Connect data source",description:wt,actionButtonTitle:Zt,isDone:Ze}}return[Nt(),{id:ss.ESSENTIALS,title:"Essentials",titleIcon:"star",description:"Set up the necessary features to start using Grafana IRM workflows",actionButtonTitle:lt===yt?"View":"Configure",stepsDone:lt,totalStepsToDo:yt}]},[Ze,lt,yt]);var et=e(39558),rt=e(8484);function ht({stepsDone:Ze,totalStepsToDo:lt}){const yt=(0,r.of)(De);return lt===0?null:(0,t.jsx)("div",{className:yt.containerStyles,role:"progressbar","aria-valuenow":Ze,"aria-valuemax":lt,children:(0,t.jsx)("div",{className:yt.fillerStyles(Ze/lt*100)})})}function ft({stepsDone:Ze,totalStepsToDo:lt}){return(0,t.jsxs)("span",{children:[(0,t.jsx)(L.E,{color:"success",children:Ze})," of ",lt]})}function De(Ze){return{containerStyles:(0,a.css)({height:Ze.spacing(2),borderRadius:Ze.shape.radius.pill,backgroundColor:Ze.colors.border.weak,flex:"auto"}),fillerStyles:lt=>(0,a.css)({height:"100%",width:`${lt}%`,backgroundColor:Ze.colors.success.main,borderRadius:Ze.shape.radius.pill,textAlign:"right"})}}function Te({config:Ze,handleActionClick:lt,isLoading:yt=!1}){const Nt=(0,r.of)(Oe);return(0,t.jsx)(P.B,{direction:"column",gap:1,justifyContent:"space-around",children:(0,t.jsxs)("div",{className:Nt.cardContent,children:[(0,t.jsxs)(P.B,{direction:"column",gap:1,children:[(0,t.jsxs)(P.B,{direction:"row",alignItems:"center",justifyContent:"space-between",gap:1,children:[(0,t.jsx)("div",{className:"fs-unmask",children:(0,t.jsxs)(P.B,{direction:"row",gap:1,alignItems:"center",children:[Ze.title,Ze.titleIcon&&(0,t.jsx)(I.I,{name:Ze.titleIcon}),Ze.isDone&&!yt&&(0,t.jsx)(I.I,{name:"check-circle",color:"green",size:"lg"})]})}),Ze.stepsDone&&Ze.totalStepsToDo&&!yt&&(0,t.jsx)("div",{className:"fs-unmask",children:(0,t.jsxs)(P.B,{direction:"row",gap:.5,children:[(0,t.jsx)(ft,{stepsDone:Ze.stepsDone,totalStepsToDo:Ze.totalStepsToDo}),(0,t.jsx)(rt.x6,{i18nKey:"configuration-tracker.config-card.complete",children:"complete"})]})})]}),(0,t.jsxs)(P.B,{direction:"column",children:[yt?(0,t.jsx)(et._,{text:"Loading configuration...."}):Ze.description,!yt&&Ze.stepsDone&&Ze.totalStepsToDo&&(0,t.jsx)(ht,{stepsDone:Ze.stepsDone,totalStepsToDo:Ze.totalStepsToDo})]})]}),(0,t.jsx)(P.B,{direction:"row",gap:1,justifyContent:"flex-start",alignItems:"flex-end",children:(0,t.jsx)(b.$n,{variant:"secondary",onClick:()=>lt(Ze.id,Ze.isDone),className:"fs-unmask",children:Ze.actionButtonTitle})})]})})}const Oe=Ze=>({cardTitle:(0,a.css)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"}),cardContent:(0,a.css)({background:Ze.colors.background.secondary,padding:Ze.spacing(2),borderRadius:Ze.shape.radius.default,height:"100%",gap:Ze.spacing(1),display:"flex",flexDirection:"column",justifyContent:"space-between"})});var Ye=e(87978),Ge=e(83122),Je=e(38138);function it({onClose:Ze,essentialsConfig:lt,stepsDone:yt,totalStepsToDo:Nt}){return(0,t.jsx)(Ye._,{title:"Essentials",subtitle:"Complete the following configuration tasks",onClose:Ze,children:(0,t.jsx)(St,{essentialContent:lt,stepsDone:yt,totalStepsToDo:Nt})})}function St({essentialContent:Ze,stepsDone:lt,totalStepsToDo:yt}){return(0,t.jsxs)(P.B,{direction:"column",gap:1,children:[(0,t.jsx)(zn,{stepsDone:lt,totalStepsToDo:yt}),Ze.sections.map(Nt=>(0,t.jsx)(zt,{section:Nt},Nt.title))]})}function zt({section:Ze}){const lt=(0,r.of)(Yn);return(0,t.jsxs)("div",{className:lt.wrapper,children:[(0,t.jsx)(L.E,{element:"h4",children:(0,t.jsx)("span",{className:"fs-unmask",children:Ze.title})}),(0,t.jsx)(L.E,{color:"secondary",children:(0,t.jsx)("span",{className:"fs-unmask",children:Ze.description})}),(0,t.jsx)(P.B,{direction:"column",gap:2,children:Ze.steps.map((yt,Nt)=>(0,t.jsx)(Qt,{step:yt},Nt))})]})}function Kt({done:Ze}){return Ze?(0,t.jsx)(I.I,{name:"check-circle",color:"green","data-testid":"checked-step",className:"fs-unmask"}):(0,t.jsx)(I.I,{name:"circle","data-testid":"unckecked-step",className:"fs-unmask"})}function Qt({step:Ze}){return(0,t.jsxs)(P.B,{direction:"row",justifyContent:"space-between","data-testid":"step",children:[(0,t.jsxs)(P.B,{direction:"row",alignItems:"center",children:[Ze.done!==void 0&&(0,t.jsx)(Kt,{done:Ze.done}),(0,t.jsx)(L.E,{variant:"body",children:(0,t.jsx)("span",{className:"fs-unmask",children:Ze.title})}),(0,t.jsx)(M.m,{content:Ze.description,placement:"right",children:(0,t.jsx)(I.I,{name:"question-circle"})})]}),(0,t.jsx)(Nn,{...Ze.button,done:Ze.done,"data-testid":"step-button"})]})}function an(Ze){const{urlLink:lt,label:yt,urlLinkOnDone:Nt,labelOnDone:wt,done:Zt}=Ze,pn=lt?.url?(0,Me.G)(lt.url,{returnTo:location.pathname+location.search,...lt.queryParams}):"",On=Nt?.url?(0,Me.G)(Nt.url,{returnTo:location.pathname+location.search,...Nt.queryParams}):"",An=Zt?On:pn;return(0,t.jsx)(b.z9,{href:An,variant:"secondary",className:"fs-unmask",children:Zt?wt??yt:yt})}function Nn({type:Ze,urlLink:lt,urlLinkOnDone:yt,label:Nt,labelOnDone:wt,options:Zt,onClickOption:pn,done:On,stepNotAvailableText:An}){switch(Ze){case"openLink":return(0,t.jsx)(an,{urlLink:lt,label:Nt,urlLinkOnDone:yt,labelOnDone:wt,done:On});case"dropDown":return Zt?.length?(0,t.jsx)(Ge.m,{overlay:(0,t.jsx)(Je.W,{className:"fs-unmask",children:Zt?.map(qn=>(0,t.jsx)(Je.W.Item,{label:qn.label,className:"fs-unmask",onClick:()=>{pn?.(qn.value)}},qn.value))}),children:(0,t.jsxs)(b.$n,{variant:"secondary",size:"md",className:"fs-unmask",children:[Nt,(0,t.jsx)(I.I,{name:"angle-down"})]})}):(0,t.jsxs)(L.E,{children:[An??"No options available"," "]})}}function zn({stepsDone:Ze,totalStepsToDo:lt}){return(0,t.jsxs)(P.B,{direction:"row",gap:1,alignItems:"center",children:["Your progress",(0,t.jsx)(ht,{stepsDone:Ze,totalStepsToDo:lt}),(0,t.jsx)(ft,{stepsDone:Ze,totalStepsToDo:lt})]})}const Yn=Ze=>({wrapper:(0,a.css)({margin:Ze.spacing(2,0),padding:Ze.spacing(2),border:`1px solid ${Ze.colors.border.medium}`,borderRadius:Ze.shape.radius.default,display:"flex",flexDirection:"column",gap:Ze.spacing(2)})});var ss=(Ze=>(Ze[Ze.CONNECT_DATASOURCE=0]="CONNECT_DATASOURCE",Ze[Ze.ESSENTIALS=1]="ESSENTIALS",Ze))(ss||{});function ds(){return{dataSourceCompatibleWithAlerting:!!(0,fe.k5)()}}function Ms(){const Ze=(0,r.of)(Bs),lt=(0,n.Zp)(),yt=ds(),Nt=gt(),wt=He({dataSourceConfigurationData:yt,essentialsConfigurationData:Nt});(0,f.useEffect)(()=>{ye(Se.ViewIRMMainPage,{essentialStepsDone:0,essentialStepsToDo:0,dataSourceCompatibleWithAlerting:yt.dataSourceCompatibleWithAlerting})},[yt.dataSourceCompatibleWithAlerting]);const[Zt,pn]=(0,xe.l)(),On=Zt.get("essentials")==="open",An=(cs,Os)=>{switch(ye(Se.ClickDataSources,{essentialStepsDone:Nt.stepsDone,essentialStepsToDo:Nt.totalStepsToDo,dataSourceCompatibleWithAlerting:yt.dataSourceCompatibleWithAlerting}),cs){case 0:lt(Os?pe.I.List:pe.I.New);break;case 1:pn({essentials:"open"}),ye(Se.OpenEssentials,{essentialStepsDone:Nt.stepsDone,essentialStepsToDo:Nt.totalStepsToDo,dataSourceCompatibleWithAlerting:yt.dataSourceCompatibleWithAlerting});break;default:return}};function qn(){pn({essentials:void 0}),ye(Se.CloseEssentials,{essentialStepsDone:Nt.stepsDone,essentialStepsToDo:Nt.totalStepsToDo,dataSourceCompatibleWithAlerting:yt.dataSourceCompatibleWithAlerting})}return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(L.E,{element:"h4",variant:"h4",children:"Configure"}),(0,t.jsxs)("section",{className:Ze.container,children:[wt.map(cs=>(0,t.jsx)(Te,{config:cs,handleActionClick:An,isLoading:Nt.isLoading},cs.id)),On&&(0,t.jsx)(it,{onClose:qn,essentialsConfig:Nt.essentialContent,stepsDone:Nt.stepsDone,totalStepsToDo:Nt.totalStepsToDo})]}),(0,t.jsx)(L.E,{element:"h4",variant:"h4",children:"IRM apps"})]})}const Bs=Ze=>({container:(0,a.css)({marginBottom:0,display:"grid",gap:Ze.spacing(3),gridTemplateColumns:" 1fr 1fr"})});var gs=e(66253);const Zn=[{path:"/plugins",navId:"plugins",roles:Ls([S.AccessControlAction.PluginsInstall,S.AccessControlAction.PluginsWrite],["Admin","ServerAdmin"]),routeName:gs.vk.Home,component:(0,k.A)(()=>e.e(4519).then(e.bind(e,77205)))},{path:"/plugins/browse",navId:"plugins",roles:Ls([S.AccessControlAction.PluginsInstall,S.AccessControlAction.PluginsWrite],["Admin","ServerAdmin"]),routeName:gs.vk.Browse,component:(0,k.A)(()=>e.e(4519).then(e.bind(e,77205)))},{path:"/plugins/:pluginId/",navId:"plugins",roles:Ls([S.AccessControlAction.PluginsInstall,S.AccessControlAction.PluginsWrite],["Admin","ServerAdmin"]),routeName:gs.vk.Details,component:(0,k.A)(()=>Promise.all([e.e(4258),e.e(4007),e.e(4753),e.e(6359),e.e(7743),e.e(7891)]).then(e.bind(e,86400)))}];function Ls(Ze,lt){return()=>Ze.some(yt=>T.TP.hasPermission(yt))?[]:lt}function Ln(){return Zn}var Hn=e(17422),Qn=e(96615),mt=e(99140);function Yt(){const Ze=(0,mt.Gu)(),{navIndex:lt}=Ze,yt=Zt=>Zt.startsWith("standalone-plugin-page-/"),Nt=Zt=>"pluginId"in Zt&&"id"in Zt;return[...Object.values(lt).filter(Nt).map(Zt=>{const pn=(0,Hn.rH)(Zt),On=`/a/${Zt.pluginId}`,An=yt(Zt.id)&&Zt.url||On,qn=yt(Zt.id)&&!Zt.url?.startsWith("/a/");return{path:An,exact:!1,sensitive:qn,component:()=>(0,t.jsx)(Qn.Ay,{pluginId:Zt.pluginId,pluginNavSection:pn})}}),{path:"/a/:pluginId",exact:!1,component:()=>(0,t.jsx)(Qn.Ay,{pluginNavSection:lt.home})}]}var on=e(2543);const ln=[{path:"/profile",component:(0,k.A)(()=>Promise.all([e.e(4753),e.e(2472)]).then(e.bind(e,48357)))},{path:"/profile/password",component:(0,k.A)(()=>e.e(8107).then(e.bind(e,28107)))},{path:"/profile/select-org",component:(0,k.A)(()=>e.e(7430).then(e.bind(e,44613)))},{path:"/profile/notifications",component:(0,k.A)(()=>e.e(4140).then(e.bind(e,78015)))}];function fn(Ze=u.$W){return Ze.profileEnabled?ln:(0,on.uniq)(ln.map(yt=>yt.path)).map(yt=>({path:yt,component:(0,k.A)(()=>e.e(5173).then(e.bind(e,35208)))}))}var yn=e(69529),wn=e(21286),Xn=e(29795);function xn(){const Ze=(0,r.of)(Ut),lt=(0,wn.s)(),yt=(0,S.useSelector)(wt=>wt.navBarTree),Nt=lt.reduce((wt,Zt)=>{const pn=(0,Xn.Wk)(yt,Zt);return pn&&wt.push(pn),wt},[]);return(0,t.jsx)(g.YW,{navId:"bookmarks",children:(0,t.jsx)(g.YW.Contents,{children:Nt.length===0?(0,t.jsx)(yn.p,{variant:"call-to-action",message:(0,rt.t)("bookmarks-page.empty.message","It looks like you haven\u2019t created any bookmarks yet"),children:(0,t.jsx)(rt.x6,{i18nKey:"bookmarks-page.empty.tip",children:"Hover over any item in the nav menu and click on the bookmark icon to add it here."})}):(0,t.jsx)("section",{className:Ze.grid,children:Nt.map(wt=>(0,t.jsx)(d,{description:wt.subTitle,text:wt.text,url:wt.url??""},wt.id||wt.url))})})})}const Ut=Ze=>({grid:(0,a.css)({display:"grid",gap:Ze.spacing(3),gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gridAutoRows:"138px",padding:Ze.spacing(2,0)})}),nn=()=>!u.$W.publicDashboardsEnabled||!u.$W.featureToggles.publicDashboards?[]:[{path:"/dashboard/public",pageClass:"page-dashboard",routeName:S.DashboardRoutes.Public,component:(0,k.A)(()=>e.e(5761).then(e.bind(e,53371)))},{path:"/public-dashboards/:accessToken",pageClass:"page-dashboard",routeName:S.DashboardRoutes.Public,chromeless:!0,component:(0,k.A)(()=>Promise.all([e.e(9569),e.e(6263),e.e(7197)]).then(e.bind(e,15663)))}],hn=[];function dn(){return[...Yt(),{path:"/",pageClass:"page-dashboard",routeName:S.DashboardRoutes.Home,component:(0,k.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(8779),e.e(9136)]).then(e.bind(e,80907)))},{path:"/d/:uid/:slug?",pageClass:"page-dashboard",routeName:S.DashboardRoutes.Normal,component:(0,k.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(8779),e.e(9136)]).then(e.bind(e,80907)))},{path:"/dashboard/new",roles:()=>p.TP.evaluatePermission([S.AccessControlAction.DashboardsCreate]),pageClass:"page-dashboard",routeName:S.DashboardRoutes.New,component:(0,k.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(8779),e.e(2976)]).then(e.bind(e,80907)))},{path:"/dashboard/new-with-ds/:datasourceUid",roles:()=>p.TP.evaluatePermission([S.AccessControlAction.DashboardsCreate]),component:(0,k.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(8779),e.e(2976)]).then(e.bind(e,30798)))},{path:"/dashboard/:type/:slug",pageClass:"page-dashboard",routeName:S.DashboardRoutes.Normal,component:(0,k.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(8779),e.e(2976)]).then(e.bind(e,80907)))},{path:"/dashboards/embedding-test",component:(0,k.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(8779),e.e(2976)]).then(e.bind(e,14962)))},{path:"/d-solo/:uid/:slug?",routeName:S.DashboardRoutes.Normal,chromeless:!0,component:(0,k.A)(()=>u.Ay.featureToggles.dashboardSceneSolo?Promise.all([e.e(9569),e.e(7849)]).then(e.bind(e,24880)):Promise.all([e.e(9569),e.e(4492)]).then(e.bind(e,55087)))},{path:"/dashboard-solo/:type/:slug",routeName:S.DashboardRoutes.Normal,chromeless:!0,component:(0,k.A)(()=>Promise.all([e.e(9569),e.e(7849)]).then(e.bind(e,55087)))},{path:"/dashboard/import",component:(0,k.A)(()=>e.e(2550).then(e.bind(e,23390)))},{path:pe.I.List,component:()=>(0,t.jsx)(n.C5,{replace:!0,to:de.b.DataSources})},{path:pe.I.Edit,component:Pt},{path:pe.I.Dashboards,component:es},{path:pe.I.New,component:()=>(0,t.jsx)(n.C5,{replace:!0,to:de.b.DataSourcesNew})},{path:"/datasources/correlations",component:(0,k.A)(()=>u.Ay.featureToggles.correlations?e.e(9981).then(e.bind(e,32429)):e.e(8014).then(e.bind(e,55244)))},{path:"/dashboards",component:(0,k.A)(()=>Promise.all([e.e(4007),e.e(4753),e.e(6359),e.e(152)]).then(e.bind(e,2471)))},{path:"/dashboards/f/:uid/:slug",component:(0,k.A)(()=>Promise.all([e.e(4007),e.e(4753),e.e(6359),e.e(152)]).then(e.bind(e,2471)))},{path:"/dashboards/f/:uid",component:(0,k.A)(()=>Promise.all([e.e(4007),e.e(4753),e.e(6359),e.e(152)]).then(e.bind(e,2471)))},{path:"/explore",pageClass:"page-explore",roles:()=>p.TP.evaluatePermission([S.AccessControlAction.DataSourcesExplore]),component:(0,k.A)(()=>u.Ay.exploreEnabled?Promise.all([e.e(407),e.e(5995),e.e(5194),e.e(660),e.e(1698),e.e(500),e.e(1166),e.e(5511),e.e(9604)]).then(e.bind(e,94767)):e.e(4422).then(e.bind(e,53518)))},{path:"/apps",component:()=>(0,t.jsx)(h,{navId:"apps"})},{path:"/alerts-and-incidents",component:()=>(0,t.jsx)(h,{navId:"alerts-and-incidents",header:!(0,re.y$)()&&(0,re.qc)()||(0,re.ES)()?(0,t.jsx)(Ms,{}):void 0})},{path:"/testing-and-synthetics",component:()=>(0,t.jsx)(h,{navId:"testing-and-synthetics"})},{path:"/monitoring",component:()=>(0,t.jsx)(h,{navId:"monitoring"})},{path:"/infrastructure",component:()=>(0,t.jsx)(h,{navId:"infrastructure"})},{path:"/frontend",component:()=>(0,t.jsx)(h,{navId:"frontend"})},{path:"/admin/general",component:()=>(0,t.jsx)(h,{navId:"cfg/general"})},{path:"/admin/plugins",component:()=>(0,t.jsx)(h,{navId:"cfg/plugins"})},{path:"/admin/access",component:()=>(0,t.jsx)(h,{navId:"cfg/access"})},{path:"/org",component:(0,k.A)(()=>e.e(1510).then(e.bind(e,69047)))},{path:"/org/new",component:(0,k.A)(()=>e.e(7930).then(e.bind(e,25913)))},{path:"/org/users",component:()=>(0,t.jsx)(n.C5,{replace:!0,to:"/admin/users"})},{path:"/org/users/invite",component:(0,k.A)(()=>e.e(7720).then(e.bind(e,91230)))},{path:"/org/apikeys",roles:()=>p.TP.evaluatePermission([S.AccessControlAction.ActionAPIKeysRead]),component:(0,k.A)(()=>e.e(4196).then(e.bind(e,9699)))},{path:"/org/serviceaccounts",roles:()=>p.TP.evaluatePermission([S.AccessControlAction.ServiceAccountsRead,S.AccessControlAction.ServiceAccountsCreate]),component:(0,k.A)(()=>Promise.all([e.e(1783),e.e(6777)]).then(e.bind(e,23645)))},{path:"/org/serviceaccounts/create",component:(0,k.A)(()=>Promise.all([e.e(1783),e.e(4176)]).then(e.bind(e,63606)))},{path:"/org/serviceaccounts/:id",component:(0,k.A)(()=>Promise.all([e.e(1783),e.e(6576)]).then(e.bind(e,82936)))},{path:"/org/teams",roles:()=>p.TP.evaluatePermission([S.AccessControlAction.ActionTeamsRead,S.AccessControlAction.ActionTeamsCreate]),component:(0,k.A)(()=>Promise.all([e.e(1783),e.e(1036)]).then(e.bind(e,52576)))},{path:"/org/teams/new",roles:()=>p.TP.evaluatePermission([S.AccessControlAction.ActionTeamsCreate]),component:(0,k.A)(()=>Promise.all([e.e(1783),e.e(5436)]).then(e.bind(e,80011)))},{path:"/org/teams/edit/:uid/:page?",roles:()=>p.TP.evaluatePermission([S.AccessControlAction.ActionTeamsRead,S.AccessControlAction.ActionTeamsCreate]),component:(0,k.A)(()=>Promise.all([e.e(1783),e.e(2212)]).then(e.bind(e,82508)))},{path:"/admin",component:()=>(0,t.jsx)(h,{navId:"cfg",header:(0,t.jsx)(J,{})})},{path:"/admin/authentication",roles:()=>p.TP.evaluatePermission([S.AccessControlAction.SettingsWrite]),component:u.Ay.licenseInfo.enabledFeatures?.saml||u.Ay.ldapEnabled||u.Ay.featureToggles.ssoSettingsApi?(0,k.A)(()=>e.e(5592).then(e.bind(e,51332))):()=>(0,t.jsx)(n.C5,{replace:!0,to:"/admin"})},{path:"/admin/authentication/ldap",component:u.Ay.featureToggles.ssoSettingsLDAP?(0,k.A)(()=>e.e(4582).then(e.bind(e,84647))):ae},{path:"/admin/authentication/:provider",roles:()=>p.TP.evaluatePermission([S.AccessControlAction.SettingsWrite]),component:u.Ay.featureToggles.ssoSettingsApi?(0,k.A)(()=>e.e(5592).then(e.bind(e,71703))):()=>(0,t.jsx)(n.C5,{replace:!0,to:"/admin"})},{path:"/admin/settings",component:(0,k.A)(()=>e.e(7659).then(e.bind(e,98493)))},{path:"/admin/upgrading",component:(0,k.A)(()=>e.e(5356).then(e.bind(e,55356)))},{path:"/admin/users",component:(0,k.A)(()=>Promise.all([e.e(1783),e.e(1743)]).then(e.bind(e,65551)))},{path:"/admin/users/create",component:(0,k.A)(()=>e.e(9239).then(e.bind(e,64665)))},{path:"/admin/users/edit/:id",component:(0,k.A)(()=>Promise.all([e.e(1783),e.e(4753),e.e(8054)]).then(e.bind(e,34562)))},{path:"/admin/orgs",component:(0,k.A)(()=>e.e(9736).then(e.bind(e,24870)))},{path:"/admin/orgs/edit/:id",component:(0,k.A)(()=>Promise.all([e.e(1783),e.e(9119)]).then(e.bind(e,57582)))},{path:"/admin/featuretoggles",component:u.Ay.featureToggles.featureToggleAdminPage?(0,k.A)(()=>e.e(7024).then(e.bind(e,47295))):()=>(0,t.jsx)(n.C5,{replace:!0,to:"/admin"})},{path:"/admin/storage/:path*",roles:()=>["Admin"],component:(0,k.A)(()=>e.e(1927).then(e.bind(e,68932)))},{path:"/admin/stats",component:(0,k.A)(()=>e.e(9299).then(e.bind(e,51372)))},u.Ay.featureToggles.onPremToCloudMigrations&&{path:"/admin/migrate-to-cloud",roles:()=>["Admin"],component:(0,k.A)(()=>Promise.all([e.e(4753),e.e(3704)]).then(e.bind(e,76491)))},{path:"/login",component:(0,k.A)(()=>e.e(3883).then(e.bind(e,57041))),pageClass:"login-page",chromeless:!0},{path:"/invite/:code",component:(0,k.A)(()=>e.e(8576).then(e.bind(e,14383))),chromeless:!0},{path:"/verify",component:u.Ay.verifyEmailEnabled?(0,k.A)(()=>e.e(8786).then(e.bind(e,78786))):()=>(0,t.jsx)(n.C5,{replace:!0,to:"/signup"}),pageClass:"login-page",chromeless:!0},{path:"/signup",component:u.Ay.disableUserSignUp?()=>(0,t.jsx)(n.C5,{replace:!0,to:"/login"}):(0,k.A)(()=>e.e(7914).then(e.bind(e,27914))),pageClass:"login-page",chromeless:!0},{path:"/user/password/send-reset-email",chromeless:!0,component:(0,k.A)(()=>e.e(3818).then(e.bind(e,2713)))},{path:"/user/password/reset",component:(0,k.A)(()=>e.e(641).then(e.bind(e,37344))),pageClass:"login-page",chromeless:!0},{path:"/dashboard/snapshots",component:(0,k.A)(()=>e.e(6590).then(e.bind(e,72602)))},u.Ay.featureToggles.dashboardRestoreUI&&{path:"/dashboard/recently-deleted",roles:()=>["Admin"],component:(0,k.A)(()=>Promise.all([e.e(4007),e.e(4753),e.e(6359),e.e(6299)]).then(e.bind(e,10421)))},{path:"/playlists",component:(0,k.A)(()=>e.e(1168).then(e.bind(e,44450)))},{path:"/playlists/play/:uid",component:(0,k.A)(()=>e.e(1374).then(e.bind(e,93129)))},{path:"/playlists/new",component:(0,k.A)(()=>e.e(7616).then(e.bind(e,62579)))},{path:"/playlists/edit/:uid",component:(0,k.A)(()=>e.e(7620).then(e.bind(e,84535)))},{path:"/sandbox/benchmarks",component:(0,k.A)(()=>e.e(9354).then(e.bind(e,98351)))},{path:"/sandbox/test",component:(0,k.A)(()=>e.e(5354).then(e.bind(e,65802)))},{path:"/dashboards/f/:uid/:slug/library-panels",component:(0,k.A)(()=>e.e(5804).then(e.bind(e,15111)))},{path:"/dashboards/f/:uid/:slug/alerting",roles:()=>p.TP.evaluatePermission([S.AccessControlAction.AlertingRuleRead]),component:(0,k.A)(()=>e.e(4333).then(e.bind(e,30027)))},{path:"/library-panels",component:(0,k.A)(()=>e.e(8516).then(e.bind(e,23053)))},{path:"/notifications",component:(0,k.A)(()=>e.e(4140).then(e.bind(e,78015)))},u.Ay.featureToggles.exploreMetrics&&{path:"/explore/metrics",chromeless:!1,exact:!1,roles:()=>p.TP.evaluatePermission([S.AccessControlAction.DataSourcesExplore]),component:(0,k.A)(()=>e.e(4785).then(e.bind(e,89858)))},{path:"/bookmarks",component:()=>(0,t.jsx)(xn,{})},...Ln(),...Sn(),...ne(),...fn(),...hn,...nn(),...ce(),{path:"/*",component:m.H}].filter(s.zz)}function Sn(Ze=u.Ay){return Ze.supportBundlesEnabled?[{path:"/support-bundles",component:(0,k.A)(()=>e.e(123).then(e.bind(e,21821)))},{path:"/support-bundles/create",component:(0,k.A)(()=>e.e(1515).then(e.bind(e,33809)))}]:[]}function es(){const{uid:Ze=""}=(0,n.g)();return(0,t.jsx)(n.C5,{replace:!0,to:de.b.DataSourcesDashboards.replace(":uid",Ze)})}function Pt(){const{uid:Ze=""}=(0,n.g)();return(0,t.jsx)(n.C5,{replace:!0,to:de.b.DataSourcesEdit.replace(":uid",Ze)})}},2272:(G,R,e)=>{"use strict";e.d(R,{C3:()=>Ve,Co:()=>Ee,U1:()=>Me});var t=e(65307),n=e(10378),s=e(55314),a=e(72686),r=e(59120),g=e(8856),i=e(28215),l=e(14644),d=e(16001),c=e(91219);const h={navBarTree:c.I_,navIndex:i._h,appNotifications:d.g5};var o=e(44672),m=e(47232),u=e(88467),p=e(26627);const y=(0,l.combineReducers)({dataSources:(0,u.Xw)("dataSources",p.DC,({rulesSourceName:Ce})=>Ce).reducer,promRules:(0,u.Xw)("promRules",p.mB,({rulesSourceName:Ce})=>Ce).reducer,rulerRules:(0,u.Xw)("rulerRules",p.eB,({rulesSourceName:Ce})=>Ce).reducer,saveAMConfig:(0,u.J7)("saveAMConfig",p.RW).reducer,deleteAMConfig:(0,u.J7)("deleteAMConfig",p.nO).reducer,folders:(0,u.Xw)("folders",p.Tp,Ce=>Ce).reducer,amAlertGroups:(0,u.Xw)("amAlertGroups",p.D3,Ce=>Ce).reducer,testReceivers:(0,u.J7)("testReceivers",p.bO).reducer,managedAlertStateHistory:(0,u.J7)("managedAlertStateHistory",p.JH).reducer});var x=e(55907);const v={items:[],searchQuery:"",isLoading:!1},P={notificationChannelTypes:[],notificationChannel:{},notifiers:[]};function E(Ce,Ue){const Ae=x.A.getStateDisplayModel(Ue),we={...Ce,stateText:Ae.text,stateIcon:Ae.iconClass,stateClass:Ae.stateClass,stateAge:(0,m.KQ)(Ce.newStateDate).fromNow(!0)};return we.state!=="paused"&&(we.executionError&&(we.info="Execution Error: "+we.executionError),we.evalData&&we.evalData.noData&&(we.info="Query returned no data")),we}const D=(0,t.Z0)({name:"alertRules",initialState:v,reducers:{loadAlertRules:Ce=>({...Ce,isLoading:!0}),loadedAlertRules:(Ce,Ue)=>{const we=Ue.payload.map(We=>E(We,We.state));return{...Ce,items:we,isLoading:!1}},setSearchQuery:(Ce,Ue)=>({...Ce,searchQuery:Ue.payload})}}),C=(0,t.Z0)({name:"notificationChannel",initialState:P,reducers:{setNotificationChannels:(Ce,Ue)=>({...Ce,notificationChannelTypes:K(Ue.payload),notifiers:Ue.payload}),notificationChannelLoaded:(Ce,Ue)=>{const Ae=Ue.payload,We=Ce.notifiers.find(_e=>_e.type===Ae.type).options.filter(_e=>_e.secure);return We.length>0&&We.some(_e=>Ae.settings[_e.propertyName]!=="")?A(Ce,Ue.payload,We):{...Ce,notificationChannel:Ae}},resetSecureField:(Ce,Ue)=>({...Ce,notificationChannel:{...Ce.notificationChannel,secureFields:{...Ce.notificationChannel.secureFields,[Ue.payload]:!1}}})}}),{loadAlertRules:b,loadedAlertRules:T,setSearchQuery:S}=D.actions,{setNotificationChannels:O,notificationChannelLoaded:M,resetSecureField:I}=C.actions,L=D.reducer,B=C.reducer,j={alertRules:L,notificationChannel:B,unifiedAlerting:y};function A(Ce,Ue,Ae){const we={},We={};return Ae.forEach(_e=>{We[_e.propertyName]=Ue.settings[_e.propertyName],we[_e.propertyName]=""}),{...Ce,notificationChannel:{...Ue,settings:{...Ue.settings,...we},secureSettings:{...We}}}}function K(Ce){return Ce.map(Ue=>({value:Ue.type,label:Ue.name,...Ue,typeName:Ue.type})).sort((Ue,Ae)=>Ue.name>Ae.name?1:-1)}var W=e(93584),U=e(20604),F=e(79763),V=e(53466),w=e(28601),z=e(36227),N=e(29436),H=e(54650),Q=e(40823),X=e(88264),ee=e(10943),Z=e(80095),q=e(31326),ae=e(81862),k=e(1936),se=e(8212),te=e(34655),ne=e(87617),le=e(48594),re=e(49962),de=e(2858),oe=e(97007);const J={...h,...j,...te.Ay,...W.Ay,...H.Ay,...w.Ay,...N.Ay,...z.Ay,...ne.Ay,...k.Ay,...ae.Ay,...Q.Ay,...ee.Ay,...F.Ay,...o.Ay,...X.Ay,...V.Ay,...Z.Ay,...le.Ay,...se.Ay,...U.Ay,plugins:q.Ff,[re.H.reducerPath]:re.H.reducer,[a.Sm.reducerPath]:a.Sm.reducer,[s.cU.reducerPath]:s.cU.reducer,[r.O5.reducerPath]:r.O5.reducer,[de.g.reducerPath]:de.g.reducer,[g.Aj.reducerPath]:g.Aj.reducer},ce={},pe=Ce=>{Object.assign(ce,Ce)},xe=()=>{const Ce=(0,l.combineReducers)({...J,...ce});return(Ue,Ae)=>{if(Ae.type!==oe.N.type)return Ce(Ue,Ae);const{cleanupAction:we}=Ae.payload;return we(Ue),Ce(Ue,Ae)}};var fe=e(99140);function Ee(Ce){pe(Ce)}const Se=(0,t.Nc)(),ye=[];function Ve(Ce){ye.push(Ce)}function Me(Ce){const Ue=(0,t.U1)({reducer:xe(),middleware:Ae=>Ae({thunk:!0,serializableCheck:!1,immutableCheck:!1}).concat(Se.middleware,re.H.middleware,a.Sm.middleware,s.cU.middleware,r.O5.middleware,de.g.middleware,g.Aj.middleware,...ye),devTools:!1,preloadedState:{navIndex:(0,i.s2)(),...Ce}});return(0,n.$k)(Ue.dispatch),(0,fe.k3)(Ue),Ue}},99140:(G,R,e)=>{"use strict";e.d(R,{Gu:()=>a,JD:()=>r,M_:()=>n,k3:()=>s});var t=e(48594);let n;function s(g){n=g}function a(){return!n||!n.getState?{templating:{...t.L1,lastKey:"key"}}:n.getState()}function r(g){if(!(!n||!n.getState))return n.dispatch(g)}},38824:(G,R,e)=>{"use strict";e.d(R,{m:()=>t});var t=(n=>(n.LineChart="Line chart",n.LineChartSmooth="Line chart smooth",n.LineChartGradientColorScheme="Line chart with gradient color scheme",n.AreaChart="Area chart",n.AreaChartStacked="Area chart stacked",n.AreaChartStackedPercent="Area chart 100% stacked",n.BarChart="Bar chart",n.BarChartGradientColorScheme="Bar chart with gradient color scheme",n.BarChartStacked="Bar chart stacked",n.BarChartStackedPercent="Bar chart 100% stacked",n.BarChartHorizontal="Bar chart horizontal",n.BarChartHorizontalStacked="Bar chart horizontal stacked",n.BarChartHorizontalStackedPercent="Bar chart horizontal 100% stacked",n.Candlestick="Candlestick",n.PieChart="Pie chart",n.PieChartDonut="Pie chart donut",n.Stat="Stat",n.StatColoredBackground="Stat colored background",n.Gauge="Gauge",n.GaugeNoThresholds="Gauge no thresholds",n.BarGaugeBasic="Bar gauge basic",n.BarGaugeLCD="Bar gauge LCD",n.Table="Table",n.StateTimeline="State timeline",n.StatusHistory="Status history",n.TextPanel="Text",n.DashboardList="Dashboard list",n.Logs="Logs",n.FlameGraph="Flame graph",n.Trace="Trace",n.NodeGraph="Node graph",n))(t||{})},94822:(G,R,e)=>{"use strict";e.d(R,{$k:()=>g,Gi:()=>n,JS:()=>l,N1:()=>d,Q8:()=>c,Si:()=>s,cF:()=>t,lh:()=>i,qr:()=>r,s1:()=>a});var t=(h=>(h.Firing="firing",h.Inactive="inactive",h.Pending="pending",h))(t||{}),n=(h=>(h.Normal="Normal",h.Alerting="Alerting",h.Pending="Pending",h.NoData="NoData",h.Error="Error",h))(n||{});function s(h){return Object.values(t).includes(h)}function a(h){return Object.values(n).some(o=>o===h)}function r(h){const o=Object.values(t);return h!=null&&!o.includes(h)}function g(h){const o=h.match(/\((.*?)\)/);return o?o[1]:""}function i(h){return r(h)?h.split(" ")[0]:h}var l=(h=>(h.Alerting="alerting",h.Recording="recording",h))(l||{}),d=(h=>(h.Cortex="Cortex",h.Mimir="Mimir",h.Prometheus="Prometheus",h.Thanos="Thanos",h))(d||{}),c=(h=>(h.Alerting="Alerting",h.NoData="NoData",h.KeepLast="KeepLast",h.OK="OK",h.Error="Error",h))(c||{})},21460:(G,R,e)=>{"use strict";e.d(R,{$:()=>a,S:()=>n});var t=e(94822);function n(r,g){return(0,t.lh)(r.state)===g}var s=(r=>(r.Firing="firing",r))(s||{}),a=(r=>(r.Alerting="alerting",r.Pending="pending",r.Normal="inactive",r.NoData="nodata",r.Error="error",r))(a||{})},13609:()=>{(function(G){"use strict";G(function(){G.support.transition=function(){var R=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},n;for(n in t)if(e.style[n]!==void 0)return t[n]}();return R&&{end:R}}()})})(window.jQuery),function(G){"use strict";var R="[data-toggle=dropdown]",e=function(a){var r=G(a).on("click.dropdown.data-api",this.toggle);G("html").on("click.dropdown.data-api",function(){r.parent().removeClass("open")})};e.prototype={constructor:e,toggle:function(a){var r=G(this),g,i;if(!r.is(".disabled, :disabled"))return g=n(r),i=g.hasClass("open"),t(),i||("ontouchstart"in document.documentElement&&G('<div class="dropdown-backdrop"/>').insertBefore(G(this)).on("click",t),g.toggleClass("open")),r.focus(),!1},keydown:function(a){var r,g,i,l,d,c;if(/(38|40|27)/.test(a.keyCode)&&(r=G(this),a.preventDefault(),a.stopPropagation(),!r.is(".disabled, :disabled"))){if(l=n(r),d=l.hasClass("open"),!d||d&&a.keyCode==27)return a.which==27&&l.find(R).focus(),r.click();g=G("[role=menu] li:not(.divider):visible a",l),g.length&&(c=g.index(g.filter(":focus")),a.keyCode==38&&c>0&&c--,a.keyCode==40&&c<g.length-1&&c++,~c||(c=0),g.eq(c).focus())}}};function t(){G(".dropdown-backdrop").remove(),G(R).each(function(){n(G(this)).removeClass("open")})}function n(a){var r=a.attr("data-target"),g;return r||(r=a.attr("href"),r=r&&/#[A-Za-z]/.test(r)&&r.replace(/.*(?=#[^\s]*$)/,"")),g=r&&G.find(r),(!g||!g.length)&&(g=a.parent()),g}var s=G.fn.dropdown;G.fn.dropdown=function(a){return this.each(function(){var r=G(this),g=r.data("dropdown");g||r.data("dropdown",g=new e(this)),typeof a=="string"&&g[a].call(r)})},G.fn.dropdown.Constructor=e,G.fn.dropdown.noConflict=function(){return G.fn.dropdown=s,this},G(document).on("click.dropdown.data-api",t).on("click.dropdown.data-api",".dropdown form",function(a){a.stopPropagation()}).on("click.dropdown.data-api",R,e.prototype.toggle).on("keydown.dropdown.data-api",R+", [role=menu]",e.prototype.keydown)}(window.jQuery),function(G){"use strict";var R=function(t,n){this.options=n,this.$element=G(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",G.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};R.prototype={constructor:R,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,n=G.Event("show");this.$element.trigger(n),!(this.isShown||n.isDefaultPrevented())&&(this.isShown=!0,this.escape(),this.backdrop(function(){var s=G.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(document.body),t.$element.show(),s&&t.$element[0].offsetWidth,t.$element.addClass("in").attr("aria-hidden",!1),t.enforceFocus(),s?t.$element.one(G.support.transition.end,function(){t.$element.focus().trigger("shown")}):t.$element.focus().trigger("shown")}))},hide:function(t){t&&t.preventDefault();var n=this;t=G.Event("hide"),this.$element.trigger(t),!(!this.isShown||t.isDefaultPrevented())&&(this.isShown=!1,this.escape(),G(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),G.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},enforceFocus:function(){var t=this;G(document).on("focusin.modal",function(n){t.$element[0]!==n.target&&!t.$element.has(n.target).length&&t.$element.focus()})},escape:function(){var t=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(n){n.which==27&&t.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var t=this,n=setTimeout(function(){t.$element.off(G.support.transition.end),t.hideModal()},500);this.$element.one(G.support.transition.end,function(){clearTimeout(n),t.hideModal()})},hideModal:function(){var t=this;this.$element.hide(),this.backdrop(function(){t.removeBackdrop(),t.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(t){var n=this,s=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var a=G.support.transition&&s;if(this.$backdrop=G('<div class="modal-backdrop '+s+'" />').appendTo(document.body),this.$backdrop.click(this.options.backdrop=="static"?G.proxy(this.$element[0].focus,this.$element[0]):G.proxy(this.hide,this)),a&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;a?this.$backdrop.one(G.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),G.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(G.support.transition.end,t):t()):t&&t()}};var e=G.fn.modal;G.fn.modal=function(t){return this.each(function(){var n=G(this),s=n.data("modal"),a=G.extend({},G.fn.modal.defaults,n.data(),typeof t=="object"&&t);s||n.data("modal",s=new R(this,a)),typeof t=="string"?s[t]():a.show&&s.show()})},G.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},G.fn.modal.Constructor=R,G.fn.modal.noConflict=function(){return G.fn.modal=e,this},G(document).on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=G(this),s=n.attr("href"),a=G.find(n.attr("data-target")||s&&s.replace(/.*(?=#[^\s]+$)/,"")),r=a.data("modal")?"toggle":G.extend({remote:!/#/.test(s)&&s},a.data(),n.data());t.preventDefault(),a.modal(r).one("hide",function(){n.focus()})})}(window.jQuery),function(G){"use strict";var R=function(t,n){this.init("tooltip",t,n)};R.prototype={constructor:R,init:function(t,n,s){var a,r,g,i,l;for(this.type=t,this.$element=G(n),this.options=this.getOptions(s),this.enabled=!0,g=this.options.trigger.split(" "),l=g.length;l--;)i=g[l],i=="click"?this.$element.on("click."+this.type,this.options.selector,G.proxy(this.toggle,this)):i!="manual"&&(a=i=="hover"?"mouseenter":"focus",r=i=="hover"?"mouseleave":"blur",this.$element.on(a+"."+this.type,this.options.selector,G.proxy(this.enter,this)),this.$element.on(r+"."+this.type,this.options.selector,G.proxy(this.leave,this)));this.options.selector?this._options=G.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=G.extend({},G.fn[this.type].defaults,this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var n=G.fn[this.type].defaults,s={},a;if(this._options&&G.each(this._options,function(r,g){n[r]!=g&&(s[r]=g)},this),a=G(t.currentTarget)[this.type](s).data(this.type),!a.options.delay||!a.options.delay.show)return a.show();clearTimeout(this.timeout),a.hoverState="in",this.timeout=setTimeout(function(){a.hoverState=="in"&&a.show()},a.options.delay.show)},leave:function(t){var n=G(t.currentTarget)[this.type](this._options).data(this.type);if(this.timeout&&clearTimeout(this.timeout),!n.options.delay||!n.options.delay.hide)return n.hide();n.hoverState="out",this.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},show:function(){var t,n,s,a,r,g,i=G.Event("show");if(this.hasContent()&&this.enabled){if(this.$element.trigger(i),i.isDefaultPrevented())return;switch(t=this.tip(),this.setContent(),this.options.animation&&t.addClass("fade"),r=typeof this.options.placement=="function"?this.options.placement.call(this,t[0],this.$element[0]):this.options.placement,t.detach().css({top:0,left:0,display:"block"}),this.options.container?t.appendTo(G.find(this.options.container)):t.insertAfter(this.$element),n=this.getPosition(),s=t[0].offsetWidth,a=t[0].offsetHeight,r){case"bottom":g={top:n.top+n.height,left:n.left+n.width/2-s/2};break;case"top":g={top:n.top-a,left:n.left+n.width/2-s/2};break;case"left":g={top:n.top+n.height/2-a/2,left:n.left-s};break;case"right":g={top:n.top+n.height/2-a/2,left:n.left+n.width};break;case"topLeft":g={top:n.top-a,left:n.left+n.width/2-s*.1};break;case"topRight":g={top:n.top-a,left:n.left+n.width/2-s*.9};break;case"rightTop":g={top:n.top+n.height/2-a*.1,left:n.left+n.width};break;case"rightBottom":g={top:n.top+n.height/2-a*.9,left:n.left+n.width};break;case"bottomLeft":g={top:n.top+n.height,left:n.left+n.width/2-s*.1};break;case"bottomRight":g={top:n.top+n.height,left:n.left+n.width/2-s*.9};break;case"leftTop":g={top:n.top+n.height/2-a*.1,left:n.left-s};break;case"leftBottom":g={top:n.top+n.height/2-a*.9,left:n.left-s};break}this.applyPlacement(g,r),this.$element.trigger("shown")}},applyPlacement:function(t,n){var s=this.tip(),a=s[0].offsetWidth,r=s[0].offsetHeight,g,i,l,d;s.offset(t).addClass(n).addClass("in"),g=s[0].offsetWidth,i=s[0].offsetHeight,n=="top"&&i!=r&&(t.top=t.top+r-i,d=!0),n=="bottom"||n=="top"?(l=0,t.left<0&&(l=t.left*-2,t.left=0,s.offset(t),g=s[0].offsetWidth,i=s[0].offsetHeight),this.replaceArrow(l-a+g,g,"left")):this.replaceArrow(i-r,i,"top"),d&&s.offset(t)},replaceArrow:function(t,n,s){this.arrow().css(s,t?50*(1-t/n)+"%":"")},setContent:function(){var t=this.tip(),n=this.getTitle();t.find(".tooltip-inner").text(n),t.removeClass("fade in top bottom left right")},hide:function(){var t=this,n=this.tip(),s=G.Event("hide");if(this.$element.trigger(s),s.isDefaultPrevented())return;n.removeClass("in");function a(){var r=setTimeout(function(){n.off(G.support.transition.end).detach()},500);n.one(G.support.transition.end,function(){clearTimeout(r),n.detach()})}return G.support.transition&&this.$tip.hasClass("fade")?a():n.detach(),this.$element.trigger("hidden"),this},fixTitle:function(){var t=this.$element;(t.attr("title")||typeof t.attr("data-original-title")!="string")&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},hasContent:function(){return this.getTitle()},getPosition:function(){var t=this.$element[0];return G.extend({},typeof t.getBoundingClientRect=="function"?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},getTitle:function(){var t,n=this.$element,s=this.options;return t=n.attr("data-original-title")||(typeof s.title=="function"?s.title.call(n[0]):s.title),t},tip:function(){return this.$tip=this.$tip||G(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(t){var n=t?G(t.currentTarget)[this.type](this._options).data(this.type):this;n.tip().hasClass("in")?n.hide():n.show()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};var e=G.fn.tooltip;G.fn.tooltip=function(t){return this.each(function(){var n=G(this),s=n.data("tooltip"),a=typeof t=="object"&&t;s||n.data("tooltip",s=new R(this,a)),typeof t=="string"&&s[t]()})},G.fn.tooltip.Constructor=R,G.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},G.fn.tooltip.noConflict=function(){return G.fn.tooltip=e,this}}(window.jQuery),function(G){"use strict";var R=function(t){this.element=G(t)};R.prototype={constructor:R,show:function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),s=t.attr("data-target"),a,r,g;s||(s=t.attr("href"),s=s&&s.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")&&(a=n.find(".active:last a")[0],g=G.Event("show",{relatedTarget:a}),t.trigger(g),!g.isDefaultPrevented()&&(r=G.find(s),this.activate(t.parent("li"),n),this.activate(r,r.parent(),function(){t.trigger({type:"shown",relatedTarget:a})})))},activate:function(t,n,s){var a=n.find("> .active"),r=s&&G.support.transition&&a.hasClass("fade");function g(){a.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),r?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),s&&s()}r?a.one(G.support.transition.end,g):g(),a.removeClass("in")}};var e=G.fn.tab;G.fn.tab=function(t){return this.each(function(){var n=G(this),s=n.data("tab");s||n.data("tab",s=new R(this)),typeof t=="string"&&s[t]()})},G.fn.tab.Constructor=R,G.fn.tab.noConflict=function(){return G.fn.tab=e,this},G(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),G(this).tab("show")})}(window.jQuery),function(G){"use strict";var R=function(t,n){this.$element=G(t),this.options=G.extend({},G.fn.typeahead.defaults,n),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.source=this.options.source,this.$menu=G(this.options.menu),this.shown=!1,this.listen()};R.prototype={constructor:R,select:function(){var t=this.$menu.find(".active").attr("data-value")||this.$element.val();return this.$element.val(this.updater(t)).change(),this.hide()},updater:function(t){return t},show:function(){var t=G.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.insertAfter(this.$element).css({top:t.top+t.height,left:t.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){var n;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(n=G.isFunction(this.source)?this.source(this.query,G.proxy(this.process,this)):this.source,n?this.process(n):this)},process:function(t){var n=this;return t=G.grep(t,function(s){return n.matcher(s)}),t=this.sorter(t),t.length?this.render(t.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(t){return~t.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(t){for(var n=[],s=[],a=[],r;r=t.shift();)r.toLowerCase().indexOf(this.query.toLowerCase())?~r.indexOf(this.query)?s.push(r):a.push(r):n.push(r);return n.concat(s,a)},highlighter:function(t){var n=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return n?t.replace(new RegExp("("+n+")","ig"),function(s,a){return"<strong>"+a+"</strong>"}):t},render:function(t){var n=this;return t=G(t).map(function(s,a){return s=G(n.options.item).attr("data-value",a),s.find("a").html(n.highlighter(a)),s[0]}),this.$menu.html(t),this},next:function(t){var n=this.$menu.find(".active").removeClass("active"),s=n.next();s.length||(s=G(this.$menu.find("li")[0])),s.addClass("active")},prev:function(t){var n=this.$menu.find(".active").removeClass("active"),s=n.prev();s.length||(s=this.$menu.find("li").last()),s.addClass("active")},listen:function(){this.$element.on("focus",G.proxy(this.focus,this)).on("blur",G.proxy(this.blur,this)).on("keypress",G.proxy(this.keypress,this)).on("keyup",G.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",G.proxy(this.keydown,this)),this.$menu.on("click",G.proxy(this.click,this)).on("mouseenter","li",G.proxy(this.mouseenter,this)).on("mouseleave","li",G.proxy(this.mouseleave,this))},destroy:function(){this.$element.off().removeData("typeahead"),this.$menu.off()},eventSupported:function(t){var n=t in this.$element;return n||(this.$element.setAttribute(t,"return;"),n=typeof this.$element[t]=="function"),n},move:function(t){if(this.shown&&!(t.shiftKey&&t.keyCode===40)){switch(t.keyCode){case 9:case 13:case 27:t.preventDefault();break;case 38:t.preventDefault(),this.prev();break;case 40:t.preventDefault(),this.next();break}t.stopPropagation()}},keydown:function(t){this.suppressKeyPressRepeat=~G.inArray(t.keyCode,[40,38,9,13,27,57]),this.move(t)},keypress:function(t){this.suppressKeyPressRepeat||this.move(t)},keyup:function(t){switch(t.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}t.keyCode===13&&typeof this.$menu.find(".active").attr("data-value")>"u"?this.$element.submit():(t.stopPropagation(),t.preventDefault())},focus:function(t){this.focused=!0},blur:function(t){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(t){t.stopPropagation(),t.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(t){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),G(t.currentTarget).addClass("active")},mouseleave:function(t){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var e=G.fn.typeahead;G.fn.typeahead=function(t){return this.each(function(){var n=G(this),s=n.data("typeahead"),a=typeof t=="object"&&t;s||n.data("typeahead",s=new R(this,a)),typeof t=="string"&&s[t]()})},G.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},G.fn.typeahead.Constructor=R,G.fn.typeahead.noConflict=function(){return G.fn.typeahead=e,this},G(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var n=G(this);n.data("typeahead")||n.typeahead(n.data())})}(window.jQuery),function(G){"use strict";var R=function(t,n){this.options=G.extend({},G.fn.affix.defaults,n),this.$window=G(window).on("scroll.affix.data-api",G.proxy(this.checkPosition,this)).on("click.affix.data-api",G.proxy(function(){setTimeout(G.proxy(this.checkPosition,this),1)},this)),this.$element=G(t),this.checkPosition()};R.prototype.checkPosition=function(){if(this.$element.is(":visible")){var t=G(document).height(),n=this.$window.scrollTop(),s=this.$element.offset(),a=this.options.offset,r=a.bottom,g=a.top,i="affix affix-top affix-bottom",l;typeof a!="object"&&(r=g=a),typeof g=="function"&&(g=a.top()),typeof r=="function"&&(r=a.bottom()),l=this.unpin!=null&&n+this.unpin<=s.top?!1:r!=null&&s.top+this.$element.height()>=t-r?"bottom":g!=null&&n<=g?"top":!1,this.affixed!==l&&(this.affixed=l,this.unpin=l=="bottom"?s.top-n:null,this.$element.removeClass(i).addClass("affix"+(l?"-"+l:"")))}};var e=G.fn.affix;G.fn.affix=function(t){return this.each(function(){var n=G(this),s=n.data("affix"),a=typeof t=="object"&&t;s||n.data("affix",s=new R(this,a)),typeof t=="string"&&s[t]()})},G.fn.affix.Constructor=R,G.fn.affix.defaults={offset:0},G.fn.affix.noConflict=function(){return G.fn.affix=e,this},G(window).on("load",function(){G('[data-spy="affix"]').each(function(){var t=G(this),n=t.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.affix(n)})})}(window.jQuery)},82013:()=>{(function(G){var R={crosshair:{mode:null,color:"rgba(170, 0, 0, 0.80)",lineWidth:1}};function e(t){var n={x:-1,y:-1,locked:!1};t.setCrosshair=function(g){if(!g)n.x=-1;else{var i=t.p2c(g);n.x=Math.max(0,Math.min(i.left,t.width())),n.y=Math.max(0,Math.min(i.top,t.height()))}t.triggerRedrawOverlay()},t.clearCrosshair=t.setCrosshair,t.lockCrosshair=function(g){g&&t.setCrosshair(g),n.locked=!0},t.unlockCrosshair=function(){n.locked=!1};function s(r){n.locked||n.x!=-1&&(n.x=-1,t.triggerRedrawOverlay())}function a(r){if(!n.locked){if(t.getSelection&&t.getSelection()){n.x=-1;return}var g=t.offset();n.x=Math.max(0,Math.min(r.pageX-g.left,t.width())),n.y=Math.max(0,Math.min(r.pageY-g.top,t.height())),t.triggerRedrawOverlay()}}t.hooks.bindEvents.push(function(r,g){r.getOptions().crosshair.mode&&(g.mouseout(s),g.mousemove(a))}),t.hooks.drawOverlay.push(function(r,g){var i=r.getOptions().crosshair;if(i.mode){var l=r.getPlotOffset();if(g.save(),g.translate(l.left,l.top),n.x!=-1){var d=r.getOptions().crosshair.lineWidth%2?.5:0;if(g.strokeStyle=i.color,g.lineWidth=i.lineWidth,g.lineJoin="round",g.beginPath(),i.mode.indexOf("x")!=-1){var c=Math.floor(n.x)+d;g.moveTo(c,0),g.lineTo(c,r.height())}if(i.mode.indexOf("y")!=-1){var h=Math.floor(n.y)+d;g.moveTo(0,h),g.lineTo(r.width(),h)}g.stroke()}g.restore()}}),t.hooks.shutdown.push(function(r,g){g.unbind("mouseout",s),g.unbind("mousemove",a)})}G.plot.plugins.push({init:e,options:R,name:"crosshair",version:"1.0"})})(jQuery)},2341:()=>{(function(G){function R(e){e.hooks.processDatapoints.push(function(t,n,s){n.dashes.show&&t.hooks.draw.push(function(a,r){var g=a.getPlotOffset(),i=n.xaxis,l=n.yaxis;function d(m,u){var p=s.points,f=s.pointsize,y=null,x=null,v=0,P=!0,E,D;n.dashes.dashLength[0]?(E=n.dashes.dashLength[0],n.dashes.dashLength[1]?D=n.dashes.dashLength[1]:D=E):D=E=n.dashes.dashLength,r.beginPath();for(var C=f;C<p.length;C+=f){let K=function(W){var U=Math.sqrt(Math.pow(L-M,2)+Math.pow(B-I,2));if(U<=W)return{deltaX:L-M,deltaY:B-I,distance:U,remainder:W-U};var F=L>M?1:-1,V=B>I?1:-1;return{deltaX:F*Math.sqrt(Math.pow(W,2)/(1+Math.pow((B-I)/(L-M),2))),deltaY:V*Math.sqrt(Math.pow(W,2)-Math.pow(W,2)/(1+Math.pow((B-I)/(L-M),2))),distance:W,remainder:0}};var A=K,b=p[C-f],T=p[C-f+1],S=p[C],O=p[C+1];if(!(b==null||S==null)){if(T<=O&&T<l.min){if(O<l.min)continue;b=(l.min-T)/(O-T)*(S-b)+b,T=l.min}else if(O<=T&&O<l.min){if(T<l.min)continue;S=(l.min-T)/(O-T)*(S-b)+b,O=l.min}if(T>=O&&T>l.max){if(O>l.max)continue;b=(l.max-T)/(O-T)*(S-b)+b,T=l.max}else if(O>=T&&O>l.max){if(T>l.max)continue;S=(l.max-T)/(O-T)*(S-b)+b,O=l.max}if(b<=S&&b<i.min){if(S<i.min)continue;T=(i.min-b)/(S-b)*(O-T)+T,b=i.min}else if(S<=b&&S<i.min){if(b<i.min)continue;O=(i.min-b)/(S-b)*(O-T)+T,S=i.min}if(b>=S&&b>i.max){if(S>i.max)continue;T=(i.max-b)/(S-b)*(O-T)+T,b=i.max}else if(S>=b&&S>i.max){if(b>i.max)continue;O=(i.max-b)/(S-b)*(O-T)+T,S=i.max}(b!=y||T!=x)&&r.moveTo(i.p2c(b)+m,l.p2c(T)+u);var M=i.p2c(b)+m,I=l.p2c(T)+u,L=i.p2c(S)+m,B=l.p2c(O)+u,j;do j=K(v>0?v:P?E:D),(j.deltaX!=0||j.deltaY!=0)&&(P?r.lineTo(M+j.deltaX,I+j.deltaY):r.moveTo(M+j.deltaX,I+j.deltaY)),P=!P,v=j.remainder,M+=j.deltaX,I+=j.deltaY;while(j.distance>0);y=S,x=O}}r.stroke()}r.save(),r.translate(g.left,g.top),r.lineJoin="round";var c=n.dashes.lineWidth,h=n.shadowSize;if(c>0&&h>0){r.lineWidth=h,r.strokeStyle="rgba(0,0,0,0.1)";var o=Math.PI/18;d(Math.sin(o)*(c/2+h/2),Math.cos(o)*(c/2+h/2)),r.lineWidth=h/2,d(Math.sin(o)*(c/2+h/4),Math.cos(o)*(c/2+h/4))}r.lineWidth=c,r.strokeStyle=n.color,c>0&&d(0,0),r.restore()})})}G.plot.plugins.push({init:R,options:{series:{dashes:{show:!1,lineWidth:2,dashLength:10}}},name:"dashes",version:"0.1"})})(jQuery)},92275:()=>{(function(G){"use strict";var R={series:{fillBelowTo:null}};function e(t){function n(r,g){var i;for(i=0;i<g.length;++i)if(g[i].id===r.fillBelowTo)return g[i];return null}function s(r,g,i,l,d,c,h,o){var m,u,p,f,y,x;return m=i-r,u=l-g,p=h-d,f=o-c,y=(-u*(r-d)+m*(g-c))/(-p*u+m*f),x=(p*(g-c)-f*(r-d))/(-p*u+m*f),y>=0&&y<=1&&x>=0&&x<=1?[r+x*m,g+x*u]:null}function a(r,g,i){if(i.fillBelowTo===null)return;var l,d,c,h,o,m,u;function p(D,C){g.beginPath(),g.moveTo(i.xaxis.p2c(D)+m.left,i.yaxis.p2c(C)+m.top)}function f(){g.closePath(),g.fill()}function y(){if(c.length/d!==o.length/h)return console.error("Refusing to graph inconsistent number of points"),!1;var D;for(D=0;D<c.length/d;D++)if(c[D*d]!==null&&o[D*h]!==null&&c[D*d]!==o[D*h])return console.error("Refusing to graph points without matching value"),!1;return!0}function x(D,C){console.assert(C>D,"expects the end index to be greater than the start index");var b=D===0||c[D-1]===null||o[D-1]===null,T=!1,S,O;for(S=D;S<C;S++)if(c[S*d+1]===null||o[S*d+1]===null)T=!1,b=!0;else if(c[S*d+1]===o[S*h+1])T=!0,b=!1;else if(c[S*d+1]>o[S*h+1]){b?p(c[S*d],c[S*d+1]):T?p(c[(S-1)*d],c[(S-1)*d+1]):(O=v(S),p(O[0],O[1])),E(S,C);return}else b=!1,T=!1}function v(D){console.assert(D>0,"expects the second point in the series line segment");var C,b;for(C=1;C<o.length/h;C++)if(b=s(c[(D-1)*d],c[(D-1)*d+1],c[D*d],c[D*d+1],o[(C-1)*h],o[(C-1)*h+1],o[C*h],o[C*h+1]),b!==null)return b;console.error("intersectionPoint() should only be called when an intersection happens")}function P(D,C){console.assert(D>=C,"the start should be the rightmost point, and the end should be the leftmost (excluding the equal or intersecting point)");var b;for(b=D;b>=C;b--)g.lineTo(l.xaxis.p2c(o[b*h])+m.left,l.yaxis.p2c(o[b*h+1])+m.top);f()}function E(D,C){console.assert(D<=C,"the start should be the rightmost point, and the end should be the leftmost (excluding the equal or intersecting point)");var b,T;for(b=D;b<C;b++)if(c[b*d+1]===null&&b>D){P(b-1,D),x(b,C);return}else if(c[b*d+1]===o[b*h+1]){P(b,D),x(b,C);return}else if(c[b*d+1]<o[b*h+1]){T=v(b),g.lineTo(i.xaxis.p2c(T[0])+m.left,i.yaxis.p2c(T[1])+m.top),P(b,D),x(b,C);return}else g.lineTo(i.xaxis.p2c(c[b*d])+m.left,i.yaxis.p2c(c[b*d+1])+m.top);P(C,D)}l=n(i,r.getData()),l&&(d=i.datapoints.pointsize,c=i.datapoints.points,h=l.datapoints.pointsize,o=l.datapoints.points,m=r.getPlotOffset(),y()&&(u=G.color.parse(i.color),u.a=.4,u.normalize(),g.fillStyle=u.toString(),x(0,c.length/d)))}t.hooks.drawSeries.push(a)}G.plot.plugins.push({init:e,options:R,name:"fillbelow",version:"0.1.0"})})(jQuery)},19538:()=>{/*!
 * jquery.flot.gauge v1.1.0 *
 *
 * Flot plugin for rendering gauge charts.
 *
 * Copyright (c) 2015 @toyoty99.
 * Licensed under the MIT license.
 */(function(G){var R=function(){var i,l,d,c,h,o,m=function(D,C){i=C,l=D.getPlaceholder(),d=D.getOptions(),c=d.series.gauges,h=D.getData(),o=e(c.debug)};m.prototype.calculateLayout=function(){var D=l.width(),C=l.height(),b=Math.min(h.length,c.layout.columns),T=Math.ceil(h.length/b),S=c.layout.margin,O=c.layout.hMargin,M=c.layout.vMargin,I=(D-S*2-O*(b-1))/b,L=(C-S*2-M*(T-1))/T;if(c.layout.square){var B=Math.min(I,L);I=B,L=B}u(c,I);var j=c.cell.margin,A=0,K=0;c.label.show&&(A=c.label.margin,K=c.label.font.size);var W=0,U=0;c.value.show&&(W=c.value.margin,U=c.value.font.size);var F=0;c.threshold.show&&(F=c.threshold.width);var V=0,w=0;c.threshold.label.show&&(V=c.threshold.label.margin,w=c.threshold.label.font.size);for(var z=I/2-j-F-V*2-w,N=c.gauge.startAngle,H=c.gauge.endAngle,Q=(H-N)/100,X=-1,ee=N;ee<H;ee+=Q)X=Math.max(X,Math.sin(s(ee)));X=Math.max(X,Math.sin(s(H)));var Z=(L-j*2-A*2-K)/(1+X);Z*X<W+U/2&&(Z=L-j*2-A*2-K-W-U/2);var q=Z-V*2-w-F,ae=Math.min(z,q),k=c.gauge.width;k>=ae&&(k=Math.max(3,ae/3));var se=V*2+w+F+ae,te=Math.max(se*(1+X),se+W+U/2);return{canvasWidth:D,canvasHeight:C,margin:S,hMargin:O,vMargin:M,columns:b,rows:T,cellWidth:I,cellHeight:L,cellMargin:j,labelMargin:A,labelFontSize:K,valueMargin:W,valueFontSize:U,width:k,radius:ae,thresholdWidth:F,thresholdLabelMargin:V,thresholdLabelFontSize:w,gaugeOuterHeight:te}};function u(D,C){D.gauge.width==="auto"&&(D.gauge.width=Math.max(5,C/8)),D.label.margin==="auto"&&(D.label.margin=Math.max(1,C/20)),D.label.font.size==="auto"&&(D.label.font.size=Math.max(5,C/8)),D.value.margin==="auto"&&(D.value.margin=Math.max(1,C/30)),D.value.font.size==="auto"&&(D.value.font.size=Math.max(5,C/9)),D.threshold.width==="auto"&&(D.threshold.width=Math.max(3,C/100)),D.threshold.label.margin==="auto"&&(D.threshold.label.margin=Math.max(3,C/40)),D.threshold.label.font.size==="auto"&&(D.threshold.label.font.size=Math.max(5,C/15))}m.prototype.calculateAutoValues=u,m.prototype.calculateCellLayout=function(D,C,b){var T=t(C.columns,b),S=n(C.columns,b),O=C.margin+(C.cellWidth+C.hMargin)*T,M=C.margin+(C.cellHeight+C.vMargin)*S,I=O+C.cellWidth/2,L=M+C.cellMargin+C.labelMargin*2+C.labelFontSize+C.thresholdWidth+C.thresholdLabelFontSize+C.thresholdLabelMargin*2+C.radius,B=C.cellHeight-C.cellMargin*2-C.labelMargin*2-C.labelFontSize-C.gaugeOuterHeight,j=0;return D.cell.vAlign==="middle"?j=B/2:D.cell.vAlign==="bottom"&&(j=B),L+=j,{col:T,row:S,x:O,y:M,offsetY:j,cellWidth:C.cellWidth,cellHeight:C.cellHeight,cellMargin:C.cellMargin,cx:I,cy:L}},m.prototype.drawBackground=function(D){c.frame.show&&(i.save(),i.strokeStyle=d.grid.borderColor,i.lineWidth=d.grid.borderWidth,i.strokeRect(0,0,D.canvasWidth,D.canvasHeight),d.grid.backgroundColor&&(i.fillStyle=d.grid.backgroundColor,i.fillRect(0,0,D.canvasWidth,D.canvasHeight)),i.restore())},m.prototype.drawCellBackground=function(D,C){i.save(),D.cell.border&&D.cell.border.show&&D.cell.border.color&&D.cell.border.width&&(i.strokeStyle=D.cell.border.color,i.lineWidth=D.cell.border.width,i.strokeRect(C.x,C.y,C.cellWidth,C.cellHeight)),D.cell.background&&D.cell.background.color&&(i.fillStyle=D.cell.background.color,i.fillRect(C.x,C.y,C.cellWidth,C.cellHeight)),i.restore()},m.prototype.drawGauge=function(D,C,b,T,S){var O=D.gauge.shadow.show?D.gauge.shadow.blur:0,M=y(D,S),I=p(D,C,S);v(b.cx,b.cy,C.radius,C.width,s(D.gauge.startAngle),s(D.gauge.endAngle),D.gauge.border.color,D.gauge.border.width,D.gauge.background.color,O),v(b.cx,b.cy,C.radius-1,C.width-2,s(I.a1),s(I.a2),M,1,M,O),D.gauge.neutralValue!=null&&f(D,C,b,M)};function p(D,C,b){let T={};var S=D.gauge.neutralValue;return S!=null?b<S?(T.a1=x(D,C,b),T.a2=x(D,C,S)):(T.a1=x(D,C,S),T.a2=x(D,C,b)):(T.a1=D.gauge.startAngle,T.a2=x(D,C,b)),T}function f(D,C,b,T){var S=(D.gauge.max-D.gauge.min)/600;a(i,b.cx,b.cy,C.radius-2,C.width-4,s(x(D,C,D.gauge.neutralValue-S)),s(x(D,C,D.gauge.neutralValue+S)),T,2,D.gauge.background.color)}function y(D,C){for(var b,T=0;T<D.threshold.values.length;T++){var S=D.threshold.values[T];if(b=S.color,C<S.value)break}return b}function x(D,C,b){var T=D.gauge.startAngle+(D.gauge.endAngle-D.gauge.startAngle)*((b-D.gauge.min)/(D.gauge.max-D.gauge.min));return T<D.gauge.startAngle?T=D.gauge.startAngle:T>D.gauge.endAngle&&(T=D.gauge.endAngle),T}m.prototype.drawThreshold=function(D,C,b){for(var T=D.gauge.startAngle,S=0;S<D.threshold.values.length;S++){var O=D.threshold.values[S];c1=O.color,a2=x(D,C,O.value),a(i,b.cx,b.cy,C.radius+C.thresholdWidth,C.thresholdWidth-2,s(T),s(a2),c1,1,c1),T=a2}};function v(D,C,b,T,S,O,M,I,L,B){S!==O&&(i.save(),a(i,D,C,b,T,S,O,M,I,L),B&&(a(i,D,C,b,T,S,O),i.clip(),i.shadowOffsetX=0,i.shadowOffsetY=0,i.shadowBlur=10,i.shadowColor="gray",a(i,D,C,b+1,T+2,S,O,M,1)),i.restore())}m.prototype.drawLable=function(D,C,b,T,S){E(b.cx,b.y+b.cellMargin+C.labelMargin+b.offsetY,"flotGaugeLabel"+T,D.label.formatter?D.label.formatter(S.label,S.data[0][1]):text,D.label)},m.prototype.drawValue=function(D,C,b,T,S){E(b.cx,b.cy-D.value.font.size/2,"flotGaugeValue"+T,D.value.formatter?D.value.formatter(S.label,S.data[0][1]):text,D.value)},m.prototype.drawThresholdValues=function(D,C,b,T){P(D,C,b,"Min"+T,D.gauge.min,D.gauge.startAngle),P(D,C,b,"Max"+T,D.gauge.max,D.gauge.endAngle);for(var S=0;S<D.threshold.values.length;S++){var O=D.threshold.values[S];if(O.value>D.gauge.min&&O.value<D.gauge.max){var M=x(D,C,O.value);P(D,C,b,T+"_"+S,O.value,M)}}var I=D.gauge.neutralValue;I!=null&&I>D.gauge.min&&I<D.gauge.max&&P(D,C,b,"Neutral"+T,I,x(D,C,I))};function P(D,C,b,T,S,O){E(b.cx+(C.thresholdLabelMargin+C.thresholdLabelFontSize/2+C.radius)*Math.cos(s(O)),b.cy+(C.thresholdLabelMargin+C.thresholdLabelFontSize/2+C.radius)*Math.sin(s(O)),"flotGaugeThresholdValue"+T,D.threshold.label.formatter?D.threshold.label.formatter(S):S,D.threshold.label,O)}function E(D,C,b,T,S,O){var M=G(l).find("#"+b),I=M.length;I||(M=G("<span></span>"),M.attr("id",b),M.attr("class","flot-temp-elem"),l.append(M)),M.css("position","absolute"),M.css("top",C+"px"),M.css("white-space","nowrap"),S.font.size&&M.css("font-size",S.font.size+"px"),S.font.family&&M.css("font-family",S.font.family),S.color&&M.css("color",S.color),S.background.color&&M.css("background-color",S.background.color),S.background.opacity&&M.css("opacity",S.background.opacity),M.text(T),M.css("left",D+"px"),M.css("left",parseInt(M.css("left"))-M.width()/2+"px"),!I&&O&&(M.css("top",parseInt(M.css("top"))-M.height()/2+"px"),M.css("transform","rotate("+(180*O+90)+"deg)"))}return m}();function e(i){return typeof Logger<"u"?new Logger(i):null}function t(i,l){return l%i}function n(i,l){return Math.floor(l/i)}function s(i){return i*Math.PI}function a(i,l,d,c,h,o,m,u,p,f){if(o!==m){var y=!1;i.save(),i.beginPath(),i.arc(l,d,c,o,m,y),i.lineTo(l+(c-h)*Math.cos(m),d+(c-h)*Math.sin(m)),i.arc(l,d,c-h,m,o,!y),i.closePath(),p&&(i.lineWidth=p),u&&(i.strokeStyle=u,i.stroke()),f&&(i.fillStyle=f,i.fill()),i.restore()}}function r(i){i.hooks.processOptions.push(function(l,d){var c=e(d.series.gauges.debug);d.series.gauges.show&&(d.grid.show=!1,d.legend.show=!1);var h=d.series.gauges.threshold.values;h.sort(function(o,m){return o.value<m.value?-1:o.value>m.value?1:0})}),i.hooks.draw.push(function(l,d){var c=l.getOptions(),h=c.series.gauges,o=e(h.debug);if(h.show){var m=l.getData();if(!(!m||!m.length)){var u=new R(l,d),p=u.calculateLayout();h.debug.layout,u.drawBackground(p);for(var f=0;f<m.length;f++){var y=m[f],x=G.extend({},h,y.gauges);y.gauges&&u.calculateAutoValues(x,p.cellWidth);var v=u.calculateCellLayout(x,p,f);u.drawCellBackground(x,v),x.debug.layout,x.label.show&&u.drawLable(x,p,v,f,y),u.drawGauge(x,p,v,y.label,y.data[0][1]),x.threshold.show&&u.drawThreshold(x,p,v),x.threshold.label.show&&u.drawThresholdValues(x,p,v,f),x.value.show&&u.drawValue(x,p,v,f,y)}}}})}var g={series:{gauges:{debug:{log:!1,layout:!1,alert:!1},show:!1,layout:{margin:5,columns:3,hMargin:5,vMargin:5,square:!1},frame:{show:!0},cell:{background:{color:null},border:{show:!0,color:"black",width:1},margin:5,vAlign:"middle"},gauge:{width:"auto",startAngle:.9,endAngle:2.1,min:0,max:100,background:{color:"white"},border:{color:"lightgray",width:2},shadow:{show:!0,blur:5}},label:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:"sans-serif"},color:null,formatter:function(i,l){return i}},value:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:"sans-serif"},color:null,formatter:function(i,l){return parseInt(l)}},threshold:{show:!0,width:"auto",label:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:",sans-serif"},color:null,formatter:function(i){return i}},values:[]}}}};G.plot.plugins.push({init:r,options:g,name:"gauge",version:"1.1.0"})})(jQuery)},54087:()=>{(function(G){G.color={},G.color.make=function(e,t,n,s){var a={};return a.r=e||0,a.g=t||0,a.b=n||0,a.a=s??1,a.add=function(r,g){for(var i=0;i<r.length;++i)a[r.charAt(i)]+=g;return a.normalize()},a.scale=function(r,g){for(var i=0;i<r.length;++i)a[r.charAt(i)]*=g;return a.normalize()},a.toString=function(){return a.a>=1?"rgb("+[a.r,a.g,a.b].join(",")+")":"rgba("+[a.r,a.g,a.b,a.a].join(",")+")"},a.normalize=function(){function r(g,i,l){return i<g?g:i>l?l:i}return a.r=r(0,parseInt(a.r),255),a.g=r(0,parseInt(a.g),255),a.b=r(0,parseInt(a.b),255),a.a=r(0,a.a,1),a},a.clone=function(){return G.color.make(a.r,a.b,a.g,a.a)},a.normalize()},G.color.extract=function(e,t){var n;do{if(n=e.css(t).toLowerCase(),n!=""&&n!="transparent")break;e=e.parent()}while(e.length&&!G.nodeName(e.get(0),"body"));return n=="rgba(0, 0, 0, 0)"&&(n="transparent"),G.color.parse(n)},G.color.parse=function(e){var t,n=G.color.make;if(t=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(e))return n(parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10));if(t=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(e))return n(parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10),parseFloat(t[4]));if(t=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(e))return n(parseFloat(t[1])*2.55,parseFloat(t[2])*2.55,parseFloat(t[3])*2.55);if(t=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(e))return n(parseFloat(t[1])*2.55,parseFloat(t[2])*2.55,parseFloat(t[3])*2.55,parseFloat(t[4]));if(t=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(e))return n(parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16));if(t=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(e))return n(parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16));var s=G.trim(e).toLowerCase();return s=="transparent"?n(255,255,255,0):(t=R[s]||[0,0,0],n(t[0],t[1],t[2]))};var R={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery),function(G){var R=Object.prototype.hasOwnProperty;G.fn.detach||(G.fn.detach=function(){return this.each(function(){this.parentNode&&this.parentNode.removeChild(this)})});function e(s,a){var r=a.children("."+s)[0];if(r==null&&(r=document.createElement("canvas"),r.className=s,G(r).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(a),!r.getContext))if(window.G_vmlCanvasManager)r=window.G_vmlCanvasManager.initElement(r);else throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");this.element=r;var g=this.context=r.getContext("2d"),i=window.devicePixelRatio||1,l=g.webkitBackingStorePixelRatio||g.mozBackingStorePixelRatio||g.msBackingStorePixelRatio||g.oBackingStorePixelRatio||g.backingStorePixelRatio||1;this.pixelRatio=i/l,this.resize(a.width(),a.height()),this.textContainer=null,this.text={},this._textCache={},this._textSizeCache=window.flotTextSizeCache=window.flotTextSizeCache||{}}e.prototype.resize=function(s,a){if(s<=0||a<=0)throw new Error("Invalid dimensions for plot, width = "+s+", height = "+a);var r=this.element,g=this.context,i=this.pixelRatio;this.width!=s&&(r.width=s*i,r.style.width=s+"px",this.width=s),this.height!=a&&(r.height=a*i,r.style.height=a+"px",this.height=a),g.restore(),g.save(),g.scale(i,i)},e.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},e.prototype.render=function(){var s=this._textCache;for(var a in s)if(R.call(s,a)){var r=this.getTextLayer(a),g=s[a];r.hide();for(var i in g)if(R.call(g,i)){var l=g[i];for(var d in l)if(R.call(l,d)){for(var c=l[d].positions,h=0,o;o=c[h];h++)o.active?o.rendered||(r.append(o.element),o.rendered=!0):(c.splice(h--,1),o.rendered&&o.element.detach());c.length==0&&delete l[d]}}r.show()}},e.prototype.getTextLayer=function(s){var a=this.text[s];return a==null&&(this.textContainer==null&&(this.textContainer=G("<div class='flot-text flot-temp-elem'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),a=this.text[s]=G("<div></div>").addClass(s).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)),a},e.prototype.getTextInfo=function(s,a,r,g,i){var l,d,c,h;if(a=""+a,typeof r=="object"?l=r.style+" "+r.variant+" "+r.weight+" "+r.size+"px/"+r.lineHeight+"px "+r.family:l=r,d=this._textCache[s],d==null&&(d=this._textCache[s]={}),c=d[l],c==null&&(c=d[l]={}),h=c[a],h==null){var o=G("<div></div>").html(a).css({position:"absolute","max-width":i,top:-9999}).appendTo(this.getTextLayer(s));typeof r=="object"?o.css({font:l,color:r.color}):typeof r=="string"&&o.addClass(r),h=c[a]={element:o,positions:[]};var m=this._textSizeCache[a];m?(h.width=m.width,h.height=m.height):(h.width=o.outerWidth(!0),h.height=o.outerHeight(!0),this._textSizeCache[a]={width:h.width,height:h.height}),o.detach()}return h},e.prototype.addText=function(s,a,r,g,i,l,d,c,h){var o=this.getTextInfo(s,g,i,l,d),m=o.positions;c=="center"?a-=o.width/2:c=="right"&&(a-=o.width),h=="middle"?r-=o.height/2:h=="bottom"&&(r-=o.height);for(var u=0,p;p=m[u];u++)if(p.x==a&&p.y==r){p.active=!0;return}p={active:!0,rendered:!1,element:m.length?o.element.clone():o.element,x:a,y:r},m.push(p),p.element.css({top:Math.round(r),left:Math.round(a),"text-align":c})},e.prototype.removeText=function(s,a,r,g,i,l){if(g==null){var d=this._textCache[s];if(d!=null){for(var c in d)if(R.call(d,c)){var h=d[c];for(var o in h)if(R.call(h,o))for(var m=h[o].positions,u=0,p;p=m[u];u++)p.active=!1}}}else for(var m=this.getTextInfo(s,g,i,l).positions,u=0,p;p=m[u];u++)p.x==a&&p.y==r&&(p.active=!1)};function t(s,a,r,g){var i=[],l={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,eventSectionHeight:0,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:16.666666666666668},hooks:{}},d=null,c=null,h=null,o=null,m=null,u=[],p=[],f={left:0,right:0,top:0,bottom:0},y=0,x=0,v={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],processRange:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},P=this;P.setData=b,P.setupGrid=N,P.draw=q,P.getPlaceholder=function(){return s},P.getCanvas=function(){return d.element},P.getPlotOffset=function(){return f},P.width=function(){return y},P.height=function(){return x},P.offset=function(){var ge=h.offset();return ge.left+=f.left,ge.top+=f.top,ge},P.getData=function(){return i},P.getAxes=function(){var ge={},Ie;return G.each(u.concat(p),function(ue,me){me&&(ge[me.direction+(me.n!=1?me.n:"")+"axis"]=me)}),ge},P.getXAxes=function(){return u},P.getYAxes=function(){return p},P.c2p=M,P.p2c=I,P.getOptions=function(){return l},P.highlight=We,P.unhighlight=_e,P.triggerRedrawOverlay=Ae,P.pointOffset=function(ge){return{left:parseInt(u[S(ge,"x")-1].p2c(+ge.x)+f.left,10),top:parseInt(p[S(ge,"y")-1].p2c(+ge.y)+f.top,10)}},P.shutdown=W,P.destroy=function(){W(),s.removeData("plot").empty(),i=[],l=null,d=null,c=null,h=null,o=null,m=null,u=[],p=[],v=null,xe=[],P=null},P.resize=function(){var ge=s.width(),Ie=s.height();d.resize(ge,Ie),c.resize(ge,Ie)},P.hooks=v,D(P),C(r),A(),b(a),N(),q(),K();function E(ge,Ie){Ie=[P].concat(Ie);for(var ue=0;ue<ge.length;++ue)ge[ue].apply(this,Ie)}function D(){for(var ge={Canvas:e},Ie=0;Ie<g.length;++Ie){var ue=g[Ie];ue.init(P,ge),ue.options&&G.extend(!0,l,ue.options)}}function C(ge){G.extend(!0,l,ge),ge&&ge.colors&&(l.colors=ge.colors),l.xaxis.color==null&&(l.xaxis.color=G.color.parse(l.grid.color).scale("a",.22).toString()),l.yaxis.color==null&&(l.yaxis.color=G.color.parse(l.grid.color).scale("a",.22).toString()),l.xaxis.tickColor==null&&(l.xaxis.tickColor=l.grid.tickColor||l.xaxis.color),l.yaxis.tickColor==null&&(l.yaxis.tickColor=l.grid.tickColor||l.yaxis.color),l.grid.borderColor==null&&(l.grid.borderColor=l.grid.color),l.grid.tickColor==null&&(l.grid.tickColor=G.color.parse(l.grid.color).scale("a",.22).toString());var Ie,ue,me,Pe=s.css("font-size"),Ne=Pe?+Pe.replace("px",""):13,Fe={style:s.css("font-style"),size:Math.round(.8*Ne),variant:s.css("font-variant"),weight:s.css("font-weight"),family:s.css("font-family")};for(me=l.xaxes.length||1,Ie=0;Ie<me;++Ie)ue=l.xaxes[Ie],ue&&!ue.tickColor&&(ue.tickColor=ue.color),ue=G.extend(!0,{},l.xaxis,ue),l.xaxes[Ie]=ue,ue.font&&(ue.font=G.extend({},Fe,ue.font),ue.font.color||(ue.font.color=ue.color),ue.font.lineHeight||(ue.font.lineHeight=Math.round(ue.font.size*1.15)));for(me=l.yaxes.length||1,Ie=0;Ie<me;++Ie)ue=l.yaxes[Ie],ue&&!ue.tickColor&&(ue.tickColor=ue.color),ue=G.extend(!0,{},l.yaxis,ue),l.yaxes[Ie]=ue,ue.font&&(ue.font=G.extend({},Fe,ue.font),ue.font.color||(ue.font.color=ue.color),ue.font.lineHeight||(ue.font.lineHeight=Math.round(ue.font.size*1.15)));for(l.xaxis.noTicks&&l.xaxis.ticks==null&&(l.xaxis.ticks=l.xaxis.noTicks),l.yaxis.noTicks&&l.yaxis.ticks==null&&(l.yaxis.ticks=l.yaxis.noTicks),l.x2axis&&(l.xaxes[1]=G.extend(!0,{},l.xaxis,l.x2axis),l.xaxes[1].position="top",l.x2axis.min==null&&(l.xaxes[1].min=null),l.x2axis.max==null&&(l.xaxes[1].max=null)),l.y2axis&&(l.yaxes[1]=G.extend(!0,{},l.yaxis,l.y2axis),l.yaxes[1].position="right",l.y2axis.min==null&&(l.yaxes[1].min=null),l.y2axis.max==null&&(l.yaxes[1].max=null)),l.grid.coloredAreas&&(l.grid.markings=l.grid.coloredAreas),l.grid.coloredAreasColor&&(l.grid.markingsColor=l.grid.coloredAreasColor),l.lines&&G.extend(!0,l.series.lines,l.lines),l.points&&G.extend(!0,l.series.points,l.points),l.bars&&G.extend(!0,l.series.bars,l.bars),l.shadowSize!=null&&(l.series.shadowSize=l.shadowSize),l.highlightColor!=null&&(l.series.highlightColor=l.highlightColor),Ie=0;Ie<l.xaxes.length;++Ie)L(u,Ie+1).options=l.xaxes[Ie];for(Ie=0;Ie<l.yaxes.length;++Ie)L(p,Ie+1).options=l.yaxes[Ie];for(var Be in v)l.hooks[Be]&&l.hooks[Be].length&&(v[Be]=v[Be].concat(l.hooks[Be]));E(v.processOptions,[l])}function b(ge){i=T(ge),B(),j()}function T(ge){for(var Ie=[],ue=0;ue<ge.length;++ue){var me=G.extend(!0,{},l.series);ge[ue].data!=null?(me.data=ge[ue].data,delete ge[ue].data,G.extend(!0,me,ge[ue]),ge[ue].data=me.data):me.data=ge[ue],Ie.push(me)}return Ie}function S(ge,Ie){var ue=ge[Ie+"axis"];return typeof ue=="object"&&(ue=ue.n),typeof ue!="number"&&(ue=1),ue}function O(){return G.grep(u.concat(p),function(ge){return ge})}function M(ge){var Ie={},ue,me;for(ue=0;ue<u.length;++ue)me=u[ue],me&&(Ie["x"+me.n]=me.c2p(ge.left));for(ue=0;ue<p.length;++ue)me=p[ue],me&&(Ie["y"+me.n]=me.c2p(ge.top));return Ie.x1!==void 0&&(Ie.x=Ie.x1),Ie.y1!==void 0&&(Ie.y=Ie.y1),Ie}function I(ge){var Ie={},ue,me,Pe;for(ue=0;ue<u.length;++ue)if(me=u[ue],me&&me.used&&(Pe="x"+me.n,ge[Pe]==null&&me.n==1&&(Pe="x"),ge[Pe]!=null)){Ie.left=me.p2c(ge[Pe]);break}for(ue=0;ue<p.length;++ue)if(me=p[ue],me&&me.used&&(Pe="y"+me.n,ge[Pe]==null&&me.n==1&&(Pe="y"),ge[Pe]!=null)){Ie.top=me.p2c(ge[Pe]);break}return Ie}function L(ge,Ie){return ge[Ie-1]||(ge[Ie-1]={n:Ie,direction:ge==u?"x":"y",options:G.extend(!0,{},ge==u?l.xaxis:l.yaxis)}),ge[Ie-1]}function B(){var ge=i.length,Ie=-1,ue;for(ue=0;ue<i.length;++ue){var me=i[ue].color;me!=null&&(ge--,typeof me=="number"&&me>Ie&&(Ie=me))}ge<=Ie&&(ge=Ie+1);var Pe,Ne=[],Fe=l.colors,Be=Fe.length,he=0;for(ue=0;ue<ge;ue++)Pe=G.color.parse(Fe[ue%Be]||"#666"),ue%Be==0&&ue&&(he>=0?he<.5?he=-he-.2:he=0:he=-he),Ne[ue]=Pe.scale("rgb",1+he);var be=0,Ke;for(ue=0;ue<i.length;++ue){if(Ke=i[ue],Ke.color==null?(Ke.color=Ne[be].toString(),++be):typeof Ke.color=="number"&&(Ke.color=Ne[Ke.color].toString()),Ke.lines.show==null){var ze,nt=!0;for(ze in Ke)if(Ke[ze]&&Ke[ze].show){nt=!1;break}nt&&(Ke.lines.show=!0)}Ke.lines.zero==null&&(Ke.lines.zero=!!Ke.lines.fill),Ke.xaxis=L(u,S(Ke,"x")),Ke.yaxis=L(p,S(Ke,"y"))}}function j(){var ge=Number.POSITIVE_INFINITY,Ie=Number.NEGATIVE_INFINITY,ue=Number.MAX_VALUE,me,Pe,Ne,Fe,Be,he,be,Ke,ze,nt,tt,ot,gt,He,et,rt;function ht(St,zt,Kt){zt<St.datamin&&zt!=-ue&&(St.datamin=zt),Kt>St.datamax&&Kt!=ue&&(St.datamax=Kt)}for(G.each(O(),function(St,zt){zt.datamin=ge,zt.datamax=Ie,zt.used=!1}),me=0;me<i.length;++me)he=i[me],he.datapoints={points:[]},E(v.processRawData,[he,he.data,he.datapoints]);for(me=0;me<i.length;++me){if(he=i[me],et=he.data,rt=he.datapoints.format,!rt){if(rt=[],rt.push({x:!0,number:!0,required:!0}),rt.push({y:!0,number:!0,required:!0}),he.stack||he.bars.show||he.lines.show&&he.lines.fill){var ft=!!(he.bars.show&&he.bars.zero||he.lines.show&&he.lines.zero);rt.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:ft}),he.bars.horizontal&&(delete rt[rt.length-1].y,rt[rt.length-1].x=!0)}he.datapoints.format=rt}if(he.datapoints.pointsize==null){he.datapoints.pointsize=rt.length,Ke=he.datapoints.pointsize,be=he.datapoints.points;var De=he.lines.show&&he.lines.steps;for(he.xaxis.used=he.yaxis.used=!0,Pe=Ne=0;Pe<et.length;++Pe,Ne+=Ke){He=et[Pe];var Te=He==null;if(!Te)for(Fe=0;Fe<Ke;++Fe)ot=He[Fe],gt=rt[Fe],gt&&(gt.number&&ot!=null&&(ot=+ot,isNaN(ot)?ot=null:ot==1/0?ot=ue:ot==-1/0&&(ot=-ue)),ot==null&&(gt.required&&(Te=!0),gt.defaultValue!=null&&(ot=gt.defaultValue))),be[Ne+Fe]=ot;if(Te)for(Fe=0;Fe<Ke;++Fe)ot=be[Ne+Fe],ot!=null&&(gt=rt[Fe],gt.autoscale!==!1&&(gt.x&&ht(he.xaxis,ot,ot),gt.y&&ht(he.yaxis,ot,ot))),be[Ne+Fe]=null;if(De&&Ne>0&&(!Te||be[Ne-Ke]!=null)){for(Fe=0;Fe<Ke;++Fe)be[Ne+Ke+Fe]=be[Ne+Fe];be[Ne+1]=be[Ne-Ke+1]||0,Te&&(be[Ne]=He[0]),Ne+=Ke}}}}for(me=0;me<i.length;++me){if(he=i[me],be=he.datapoints.points,Ke=he.datapoints.pointsize,he.transform==="negative-Y")for(Pe=0;Pe<be.length;Pe+=Ke)be[Pe]!=null&&(ot=be[Pe+1],be[Pe+1]=-ot);E(v.processDatapoints,[he,he.datapoints])}for(me=0;me<i.length;++me){he=i[me],be=he.datapoints.points,Ke=he.datapoints.pointsize,rt=he.datapoints.format;var Oe=ge,Ye=ge,Ge=Ie,Je=Ie;for(Pe=0;Pe<be.length;Pe+=Ke)if(be[Pe]!=null)for(Fe=0;Fe<Ke;++Fe)ot=be[Pe+Fe],gt=rt[Fe],!(!gt||gt.autoscale===!1||ot==ue||ot==-ue)&&(gt.x&&(ot<Oe&&(Oe=ot),ot>Ge&&(Ge=ot)),gt.y&&(ot<Ye&&(Ye=ot),ot>Je&&(Je=ot)));if(he.bars.show){var it;switch(he.bars.align){case"left":it=0;break;case"right":it=-he.bars.barWidth;break;default:it=-he.bars.barWidth/2}he.bars.horizontal?(Ye+=it,Je+=it+he.bars.barWidth):(Oe+=it,Ge+=it+he.bars.barWidth)}ht(he.xaxis,Oe,Ge),ht(he.yaxis,Ye,Je)}G.each(O(),function(St,zt){zt.datamin==ge&&(zt.datamin=null),zt.datamax==Ie&&(zt.datamax=null)})}function A(){s.find(".flot-temp-elem").remove(),s.css("position")=="static"&&s.css("position","relative"),d=new e("flot-base",s),c=new e("flot-overlay",s),o=d.context,m=c.context,h=G(c.element).unbind();var ge=s.data("plot");ge&&(ge.shutdown(),c.clear()),s.data("plot",P)}function K(){l.grid.hoverable&&(h.mousemove(Se),h.bind("mouseleave",ye),G(document).bind("touchend",Me)),l.grid.clickable&&h.click(Ve),E(v.bindEvents,[h])}function W(){fe&&clearTimeout(fe),h.unbind("mousemove",Se),h.unbind("mouseleave",ye),h.unbind("click",Ve),G(document).unbind("touchend",Me),E(v.shutdown,[h])}function U(ge){function Ie(Fe){return Fe}var ue,me,Pe=ge.options.transform||Ie,Ne=ge.options.inverseTransform;ge.direction=="x"?(ue=ge.scale=y/Math.abs(Pe(ge.max)-Pe(ge.min)),me=Math.min(Pe(ge.max),Pe(ge.min))):(ue=ge.scale=x/Math.abs(Pe(ge.max)-Pe(ge.min)),ue=-ue,me=Math.max(Pe(ge.max),Pe(ge.min))),Pe==Ie?ge.p2c=function(Fe){return(Fe-me)*ue}:ge.p2c=function(Fe){return(Pe(Fe)-me)*ue},Ne?ge.c2p=function(Fe){return Ne(me+Fe/ue)}:ge.c2p=function(Fe){return me+Fe/ue}}function F(ge){for(var Ie=ge.options,ue=ge.ticks||[],me=Ie.labelWidth||0,Pe=Ie.labelHeight||0,Ne=me||(ge.direction=="x"?Math.floor(d.width/(ue.length||1)):null),Fe=ge.direction+"Axis "+ge.direction+ge.n+"Axis",Be="flot-"+ge.direction+"-axis flot-"+ge.direction+ge.n+"-axis "+Fe,he=Ie.font||"flot-tick-label tickLabel",be=0;be<ue.length;++be){var Ke=ue[be];if(Ke.label){var ze=d.getTextInfo(Be,Ke.label,he,null,Ne);me=Math.max(me,ze.width+1),Pe=Math.max(Pe,ze.height)}}ge.labelWidth=Ie.labelWidth||me,ge.labelHeight=Ie.labelHeight||Pe}function V(ge){var Ie=ge.labelWidth,ue=ge.labelHeight,me=ge.options.position,Pe=ge.direction==="x",Ne=ge.options.tickLength,Fe=l.grid.axisMargin,Be=l.grid.labelMargin,he=l.grid.eventSectionHeight,be=!0,Ke=!0,ze=!0,nt=!1;G.each(Pe?u:p,function(tt,ot){ot&&(ot.show||ot.reserveSpace)&&(ot===ge?nt=!0:ot.options.position===me&&(nt?Ke=!1:be=!1),nt||(ze=!1))}),Ke&&(Fe=0),Ne==null&&(Ne=ze?"full":5),isNaN(+Ne)||(Be+=+Ne),Pe?(ue+=Be,ue+=he,me=="bottom"?(f.bottom+=ue+Fe,ge.box={top:d.height-f.bottom,height:ue}):(ge.box={top:f.top+Fe,height:ue},f.top+=ue+Fe)):(Ie+=Be,me=="left"?(ge.box={left:f.left+Fe,width:Ie},f.left+=Ie+Fe):(f.right+=Ie+Fe,ge.box={left:d.width-f.right,width:Ie})),ge.position=me,ge.tickLength=Ne,ge.box.padding=Be,ge.box.eventSectionPadding=he,ge.innermost=be}function w(ge){ge.direction=="x"?(ge.box.left=f.left-ge.labelWidth/2,ge.box.width=d.width-f.left-f.right+ge.labelWidth):(ge.box.top=f.top-ge.labelHeight/2,ge.box.height=d.height-f.bottom-f.top+ge.labelHeight)}function z(){var ge=l.grid.minBorderMargin,Ie,ue;if(ge==null)for(ge=0,ue=0;ue<i.length;++ue)ge=Math.max(ge,2*(i[ue].points.radius+i[ue].points.lineWidth/2));var me={left:ge,right:ge,top:ge,bottom:ge};G.each(O(),function(Pe,Ne){Ne.reserveSpace&&Ne.ticks&&Ne.ticks.length&&(Ne.direction==="x"?(me.left=Math.max(me.left,Ne.labelWidth/2),me.right=Math.max(me.right,Ne.labelWidth/2)):(me.bottom=Math.max(me.bottom,Ne.labelHeight/2),me.top=Math.max(me.top,Ne.labelHeight/2)))}),f.left=Math.ceil(Math.max(me.left,f.left)),f.right=Math.ceil(Math.max(me.right,f.right)),f.top=Math.ceil(Math.max(me.top,f.top)),f.bottom=Math.ceil(Math.max(me.bottom,f.bottom))}function N(){var ge,Ie=O(),ue=l.grid.show;for(var me in f){var Pe=l.grid.margin||0;f[me]=typeof Pe=="number"?Pe:Pe[me]||0}E(v.processOffset,[f]);for(var me in f)typeof l.grid.borderWidth=="object"?f[me]+=ue?l.grid.borderWidth[me]:0:f[me]+=ue?l.grid.borderWidth:0;if(G.each(Ie,function(Be,he){var be=he.options;he.show=be.show==null?he.used:be.show,he.reserveSpace=be.reserveSpace==null?he.show:be.reserveSpace,H(he)}),E(v.processRange,[]),ue){for(var Ne=G.grep(Ie,function(Be){return Be.show||Be.reserveSpace}),Fe=!1,ge=0;ge<2&&(G.each(Ne,function(he,be){X(be),ee(be),Fe=Z(be,be.ticks)||Fe,F(be)}),Fe&&v.processRange.length>0);ge++)E(v.processRange,[]),Fe=!1;for(ge=Ne.length-1;ge>=0;--ge)V(Ne[ge]);z(),G.each(Ne,function(Be,he){w(he)})}y=d.width-f.left-f.right,x=d.height-f.bottom-f.top,G.each(Ie,function(Be,he){U(he)}),ue&&te(),pe()}function H(ge){var Ie=ge.options,ue=+(Ie.min!=null?Ie.min:ge.datamin),me=+(Ie.max!=null?Ie.max:ge.datamax),Pe=me-ue;if(Pe==0){var Ne=.25,Fe=Math.abs(me==0?1:me*Ne);Ie.min==null&&(ue-=Fe),(Ie.max==null||Ie.min!=null)&&(me+=Fe)}else{var Be=Ie.autoscaleMargin;Be!=null&&(Ie.min==null&&(ue-=Pe*Be,ue<0&&ge.datamin!=null&&ge.datamin>=0&&(ue=0)),Ie.max==null&&(me+=Pe*Be,me>0&&ge.datamax!=null&&ge.datamax<=0&&(me=0)))}ge.min=ue,ge.max=me}function Q(ge){if(ge=Math.abs(String(ge).replace(".","")),ge==0)return 0;for(;ge!=0&&ge%10==0;)ge/=10;return Math.floor(Math.log(ge)/Math.LN10)+1}function X(ge){var Ie=ge.options,ue;typeof Ie.ticks=="number"&&Ie.ticks>0?ue=Ie.ticks:ue=.3*Math.sqrt(ge.direction=="x"?d.width:d.height);var me=(ge.max-ge.min)/ue,Pe=-Math.floor(Math.log(me)/Math.LN10),Ne=Ie.tickDecimals;Ne!=null&&Pe>Ne&&(Pe=Ne);var Fe=Math.pow(10,-Pe),Be=me/Fe,he;if(Be<1.5?he=1:Be<3?(he=2,Be>2.25&&(Ne==null||Pe+1<=Ne)&&(he=2.5,++Pe)):Be<7.5?he=5:he=10,he*=Fe,Ie.minTickSize!=null&&he<Ie.minTickSize&&(he=Ie.minTickSize),ge.delta=me,ge.tickDecimals=Math.max(0,Ne??Pe),ge.tickSize=Ie.tickSize||he,Ie.mode=="time"&&!ge.tickGenerator)throw new Error("Time mode requires the flot.time plugin.");if(ge.tickGenerator||(ge.tickGenerator=function(tt){var ot=[],gt=n(tt.min,tt.tickSize),He=0,et=Number.NaN,rt;do rt=et,et=gt+He*tt.tickSize,ot.push(et),++He;while(et<tt.max&&et!=rt);return ot},ge.tickFormatter=function(tt,ot){var gt=ot.tickDecimals?Math.pow(10,ot.tickDecimals):1,He=""+Math.round(tt*gt)/gt;if(ot.tickDecimals!=null){var et=He.indexOf("."),rt=et==-1?0:He.length-et-1;if(rt<ot.tickDecimals)return(rt?He:He+".")+(""+gt).substr(1,ot.tickDecimals-rt)}return He}),G.isFunction(Ie.tickFormatter)&&(ge.tickFormatter=function(tt,ot){return""+Ie.tickFormatter(tt,ot)}),Ie.alignTicksWithAxis!=null){var be=(ge.direction=="x"?u:p)[Ie.alignTicksWithAxis-1];if(be&&be.used&&be!=ge){var Ke=ge.tickGenerator(ge);if(Ke.length>0&&(Ie.min==null&&(ge.min=Math.min(ge.min,Ke[0])),Ie.max==null&&Ke.length>1&&(ge.max=Math.max(ge.max,Ke[Ke.length-1]))),ge.tickGenerator=function(tt){var ot=[],gt,He;for(He=0;He<be.ticks.length;++He)gt=(be.ticks[He].v-be.min)/(be.max-be.min),gt=tt.min+gt*(tt.max-tt.min),ot.push(gt);return ot},!ge.mode&&Ie.tickDecimals==null){var ze=Math.max(0,-Math.floor(Math.log(ge.delta)/Math.LN10)+1),nt=ge.tickGenerator(ge);nt.length>1&&/\..*0$/.test((nt[1]-nt[0]).toFixed(ze))||(ge.tickDecimals=ze)}}}}function ee(ge){var Ie=ge.options.ticks,ue=[];Ie==null||typeof Ie=="number"&&Ie>0?ue=ge.tickGenerator(ge):Ie&&(G.isFunction(Ie)?ue=Ie(ge):ue=Ie);var me,Pe;for(ge.ticks=[],me=0;me<ue.length;++me){var Ne=null,Fe=ue[me];typeof Fe=="object"?(Pe=+Fe[0],Fe.length>1&&(Ne=Fe[1])):Pe=+Fe,Ne==null&&(Ne=ge.tickFormatter(Pe,ge)),isNaN(Pe)||ge.ticks.push({v:Pe,label:Ne})}}function Z(ge,Ie){var ue=!1;return ge.options.autoscaleMargin&&Ie.length>0&&(ge.options.min==null&&(ge.min=Math.min(ge.min,Ie[0].v),ue=!0),ge.options.max==null&&Ie.length>1&&(ge.max=Math.max(ge.max,Ie[Ie.length-1].v),ue=!0)),ue}function q(){d.clear(),E(v.drawBackground,[o]);var ge=l.grid;ge.show&&ge.backgroundColor&&k(),ge.show&&!ge.aboveData&&se();for(var Ie=0;Ie<i.length;++Ie)E(v.drawSeries,[o,i[Ie]]),le(i[Ie]);E(v.draw,[o]),ge.show&&ge.aboveData&&se(),d.render(),Ae()}function ae(ge,Ie){for(var ue,me,Pe,Ne,Fe=O(),Be=0;Be<Fe.length;++Be)if(ue=Fe[Be],ue.direction==Ie&&(Ne=Ie+ue.n+"axis",!ge[Ne]&&ue.n==1&&(Ne=Ie+"axis"),ge[Ne])){me=ge[Ne].from,Pe=ge[Ne].to;break}if(ge[Ne]||(ue=Ie=="x"?u[0]:p[0],me=ge[Ie+"1"],Pe=ge[Ie+"2"]),me!=null&&Pe!=null&&me>Pe){var he=me;me=Pe,Pe=he}return{from:me,to:Pe,axis:ue}}function k(){o.save(),o.translate(f.left,f.top),o.fillStyle=It(l.grid.backgroundColor,x,0,"rgba(255, 255, 255, 0)"),o.fillRect(0,0,y,x),o.restore()}function se(){var ge,Ie,ue,me;o.save(),o.translate(f.left,f.top);var Pe=l.grid.markings;if(Pe)for(G.isFunction(Pe)&&(Ie=P.getAxes(),Ie.xmin=Ie.xaxis.min,Ie.xmax=Ie.xaxis.max,Ie.ymin=Ie.yaxis.min,Ie.ymax=Ie.yaxis.max,Pe=Pe(Ie)),ge=0;ge<Pe.length;++ge){var Ne=Pe[ge],Fe=ae(Ne,"x"),Be=ae(Ne,"y");if(Fe.from==null&&(Fe.from=Fe.axis.min),Fe.to==null&&(Fe.to=Fe.axis.max),Be.from==null&&(Be.from=Be.axis.min),Be.to==null&&(Be.to=Be.axis.max),!(Fe.to<Fe.axis.min||Fe.from>Fe.axis.max||Be.to<Be.axis.min||Be.from>Be.axis.max)){Fe.from=Math.max(Fe.from,Fe.axis.min),Fe.to=Math.min(Fe.to,Fe.axis.max),Be.from=Math.max(Be.from,Be.axis.min),Be.to=Math.min(Be.to,Be.axis.max);var he=Fe.from===Fe.to,be=Be.from===Be.to;if(!(he&&be))if(Fe.from=Math.floor(Fe.axis.p2c(Fe.from)),Fe.to=Math.floor(Fe.axis.p2c(Fe.to)),Be.from=Math.floor(Be.axis.p2c(Be.from)),Be.to=Math.floor(Be.axis.p2c(Be.to)),he||be){var Ke=Ne.lineWidth||l.grid.markingsLineWidth,ze=Ke%2?.5:0;o.beginPath(),o.strokeStyle=Ne.color||l.grid.markingsColor,o.lineWidth=Ke,he?(o.moveTo(Fe.to+ze,Be.from),o.lineTo(Fe.to+ze,Be.to)):(o.moveTo(Fe.from,Be.to+ze),o.lineTo(Fe.to,Be.to+ze)),o.stroke()}else o.fillStyle=Ne.color||l.grid.markingsColor,o.fillRect(Fe.from,Be.to,Fe.to-Fe.from,Be.from-Be.to)}}Ie=O(),ue=l.grid.borderWidth;for(var nt=0;nt<Ie.length;++nt){var tt=Ie[nt],ot=tt.box,gt=tt.tickLength,He,et,rt,ht;if(!(!tt.show||tt.ticks.length==0)){for(o.lineWidth=1,tt.direction=="x"?(He=0,gt=="full"?et=tt.position=="top"?0:x:et=ot.top-f.top+(tt.position=="top"?ot.height:0)):(et=0,gt=="full"?He=tt.position=="left"?0:y:He=ot.left-f.left+(tt.position=="left"?ot.width:0)),tt.innermost||(o.strokeStyle=tt.options.color,o.beginPath(),rt=ht=0,tt.direction=="x"?rt=y+1:ht=x+1,o.lineWidth==1&&(tt.direction=="x"?et=Math.floor(et)+.5:He=Math.floor(He)+.5),o.moveTo(He,et),o.lineTo(He+rt,et+ht),o.stroke()),o.strokeStyle=tt.options.tickColor,o.beginPath(),ge=0;ge<tt.ticks.length;++ge){var ft=tt.ticks[ge].v;rt=ht=0,!(isNaN(ft)||ft<tt.min||ft>tt.max||gt=="full"&&(typeof ue=="object"&&ue[tt.position]>0||ue>0)&&(ft==tt.min||ft==tt.max))&&(tt.direction=="x"?(He=tt.p2c(ft),ht=gt=="full"?-x:gt,tt.position=="top"&&(ht=-ht)):(et=tt.p2c(ft),rt=gt=="full"?-y:gt,tt.position=="left"&&(rt=-rt)),o.lineWidth==1&&(tt.direction=="x"?He=Math.floor(He)+.5:et=Math.floor(et)+.5),o.moveTo(He,et),o.lineTo(He+rt,et+ht))}o.stroke()}}ue&&(me=l.grid.borderColor,typeof ue=="object"||typeof me=="object"?(typeof ue!="object"&&(ue={top:ue,right:ue,bottom:ue,left:ue}),typeof me!="object"&&(me={top:me,right:me,bottom:me,left:me}),ue.top>0&&(o.strokeStyle=me.top,o.lineWidth=ue.top,o.beginPath(),o.moveTo(0-ue.left,0-ue.top/2),o.lineTo(y,0-ue.top/2),o.stroke()),ue.right>0&&(o.strokeStyle=me.right,o.lineWidth=ue.right,o.beginPath(),o.moveTo(y+ue.right/2,0-ue.top),o.lineTo(y+ue.right/2,x),o.stroke()),ue.bottom>0&&(o.strokeStyle=me.bottom,o.lineWidth=ue.bottom,o.beginPath(),o.moveTo(y+ue.right,x+ue.bottom/2),o.lineTo(0,x+ue.bottom/2),o.stroke()),ue.left>0&&(o.strokeStyle=me.left,o.lineWidth=ue.left,o.beginPath(),o.moveTo(0-ue.left/2,x+ue.bottom),o.lineTo(0-ue.left/2,0),o.stroke())):(o.lineWidth=ue,o.strokeStyle=l.grid.borderColor,o.strokeRect(-ue/2,-ue/2,y+ue,x+ue))),o.restore()}function te(){G.each(O(),function(ge,Ie){var ue=Ie.box,me=Ie.direction+"Axis "+Ie.direction+Ie.n+"Axis",Pe="flot-"+Ie.direction+"-axis flot-"+Ie.direction+Ie.n+"-axis "+me,Ne=Ie.options.font||"flot-tick-label tickLabel",Fe,Be,he,be,Ke;if(d.removeText(Pe),!(!Ie.show||Ie.ticks.length==0))for(var ze=0;ze<Ie.ticks.length;++ze)Fe=Ie.ticks[ze],!(!Fe.label||Fe.v<Ie.min||Fe.v>Ie.max)&&(Ie.direction=="x"?(be="center",Be=f.left+Ie.p2c(Fe.v),Ie.position=="bottom"?he=ue.top+ue.padding+ue.eventSectionPadding:(he=ue.top+ue.height-ue.padding,Ke="bottom")):(Ke="middle",he=f.top+Ie.p2c(Fe.v),Ie.position=="left"?(Be=ue.left+ue.width-ue.padding,be="right"):Be=ue.left+ue.padding),d.addText(Pe,Be,he,Fe.label,Ne,null,null,be,Ke))})}function ne(ge){for(var Ie=[],ue=null,me=null,Pe=ge.datapoints,Ne=[],Fe=0;Fe<Pe.pointsize-2;Fe++)Ne.push(0);for(var Be=0;Be<Pe.points.length;Be+=Pe.pointsize){var he=Pe.points[Be],be=Pe.points[Be+1];Be===Pe.points.length-Pe.pointsize?me=null:me=Pe.points[Be+Pe.pointsize],he!==null&&be!==null&&ue===null&&me===null&&(Ie.push(he),Ie.push(be),Ie.push.apply(Ie,Ne)),ue=he}var Ke=Pe.points;Pe.points=Ie,ge.points.radius=ge.lines.lineWidth/2,de(ge),Pe.points=Ke}function le(ge){ge.lines.show&&(re(ge),!ge.points.show&&!ge.bars.show&&ne(ge)),ge.bars.show&&J(ge),ge.points.show&&de(ge)}function re(ge){function Ie(Be,he,be,Ke,ze){var nt=Be.points,tt=Be.pointsize,ot=null,gt=null;o.beginPath();for(var He=tt;He<nt.length;He+=tt){var et=nt[He-tt],rt=nt[He-tt+1],ht=nt[He],ft=nt[He+1];if(!(et==null||ht==null)){if(rt<=ft&&rt<ze.min){if(ft<ze.min)continue;et=(ze.min-rt)/(ft-rt)*(ht-et)+et,rt=ze.min}else if(ft<=rt&&ft<ze.min){if(rt<ze.min)continue;ht=(ze.min-rt)/(ft-rt)*(ht-et)+et,ft=ze.min}if(rt>=ft&&rt>ze.max){if(ft>ze.max)continue;et=(ze.max-rt)/(ft-rt)*(ht-et)+et,rt=ze.max}else if(ft>=rt&&ft>ze.max){if(rt>ze.max)continue;ht=(ze.max-rt)/(ft-rt)*(ht-et)+et,ft=ze.max}if(et<=ht&&et<Ke.min){if(ht<Ke.min)continue;rt=(Ke.min-et)/(ht-et)*(ft-rt)+rt,et=Ke.min}else if(ht<=et&&ht<Ke.min){if(et<Ke.min)continue;ft=(Ke.min-et)/(ht-et)*(ft-rt)+rt,ht=Ke.min}if(et>=ht&&et>Ke.max){if(ht>Ke.max)continue;rt=(Ke.max-et)/(ht-et)*(ft-rt)+rt,et=Ke.max}else if(ht>=et&&ht>Ke.max){if(et>Ke.max)continue;ft=(Ke.max-et)/(ht-et)*(ft-rt)+rt,ht=Ke.max}(et!=ot||rt!=gt)&&o.moveTo(Ke.p2c(et)+he,ze.p2c(rt)+be),ot=ht,gt=ft,o.lineTo(Ke.p2c(ht)+he,ze.p2c(ft)+be)}}o.stroke()}function ue(Be,he,be){for(var Ke=Be.points,ze=Be.pointsize,nt=Math.min(Math.max(0,be.min),be.max),tt=0,ot,gt=!1,He=1,et=0,rt=0;!(ze>0&&tt>Ke.length+ze);){tt+=ze;var ht=Ke[tt-ze],ft=Ke[tt-ze+He],De=Ke[tt],Te=Ke[tt+He];if(gt){if(ze>0&&ht!=null&&De==null){rt=tt,ze=-ze,He=2;continue}if(ze<0&&tt==et+ze){o.fill(),gt=!1,ze=-ze,He=1,tt=et=rt+ze;continue}}if(!(ht==null||De==null)){if(ht<=De&&ht<he.min){if(De<he.min)continue;ft=(he.min-ht)/(De-ht)*(Te-ft)+ft,ht=he.min}else if(De<=ht&&De<he.min){if(ht<he.min)continue;Te=(he.min-ht)/(De-ht)*(Te-ft)+ft,De=he.min}if(ht>=De&&ht>he.max){if(De>he.max)continue;ft=(he.max-ht)/(De-ht)*(Te-ft)+ft,ht=he.max}else if(De>=ht&&De>he.max){if(ht>he.max)continue;Te=(he.max-ht)/(De-ht)*(Te-ft)+ft,De=he.max}if(gt||(o.beginPath(),o.moveTo(he.p2c(ht),be.p2c(nt)),gt=!0),ft>=be.max&&Te>=be.max){o.lineTo(he.p2c(ht),be.p2c(be.max)),o.lineTo(he.p2c(De),be.p2c(be.max));continue}else if(ft<=be.min&&Te<=be.min){o.lineTo(he.p2c(ht),be.p2c(be.min)),o.lineTo(he.p2c(De),be.p2c(be.min));continue}var Oe=ht,Ye=De;ft<=Te&&ft<be.min&&Te>=be.min?(ht=(be.min-ft)/(Te-ft)*(De-ht)+ht,ft=be.min):Te<=ft&&Te<be.min&&ft>=be.min&&(De=(be.min-ft)/(Te-ft)*(De-ht)+ht,Te=be.min),ft>=Te&&ft>be.max&&Te<=be.max?(ht=(be.max-ft)/(Te-ft)*(De-ht)+ht,ft=be.max):Te>=ft&&Te>be.max&&ft<=be.max&&(De=(be.max-ft)/(Te-ft)*(De-ht)+ht,Te=be.max),ht!=Oe&&o.lineTo(he.p2c(Oe),be.p2c(ft)),o.lineTo(he.p2c(ht),be.p2c(ft)),o.lineTo(he.p2c(De),be.p2c(Te)),De!=Ye&&(o.lineTo(he.p2c(De),be.p2c(Te)),o.lineTo(he.p2c(Ye),be.p2c(Te)))}}}o.save(),o.translate(f.left,f.top),o.lineJoin="round";var me=ge.lines.lineWidth,Pe=ge.shadowSize;if(me>0&&Pe>0){o.lineWidth=Pe,o.strokeStyle="rgba(0,0,0,0.1)";var Ne=Math.PI/18;Ie(ge.datapoints,Math.sin(Ne)*(me/2+Pe/2),Math.cos(Ne)*(me/2+Pe/2),ge.xaxis,ge.yaxis),o.lineWidth=Pe/2,Ie(ge.datapoints,Math.sin(Ne)*(me/2+Pe/4),Math.cos(Ne)*(me/2+Pe/4),ge.xaxis,ge.yaxis)}o.lineWidth=me,o.strokeStyle=ge.color;var Fe=ce(ge.lines,ge.color,0,x);Fe&&(o.fillStyle=Fe,ue(ge.datapoints,ge.xaxis,ge.yaxis)),me>0&&Ie(ge.datapoints,0,0,ge.xaxis,ge.yaxis),o.restore()}function de(ge){function Ie(Be,he,be,Ke,ze,nt,tt,ot){for(var gt=Be.points,He=Be.pointsize,et=0;et<gt.length;et+=He){var rt=gt[et],ht=gt[et+1];rt==null||rt<nt.min||rt>nt.max||ht<tt.min||ht>tt.max||(o.beginPath(),rt=nt.p2c(rt),ht=tt.p2c(ht)+Ke,ot=="circle"?o.arc(rt,ht,he,0,ze?Math.PI:Math.PI*2,!1):ot(o,rt,ht,he,ze),o.closePath(),be&&(o.fillStyle=be,o.fill()),o.stroke())}}o.save(),o.translate(f.left,f.top);var ue=ge.points.lineWidth,me=ge.shadowSize,Pe=ge.points.radius,Ne=ge.points.symbol;if(ue==0&&(ue=1e-4),ue>0&&me>0){var Fe=me/2;o.lineWidth=Fe,o.strokeStyle="rgba(0,0,0,0.1)",Ie(ge.datapoints,Pe,null,Fe+Fe/2,!0,ge.xaxis,ge.yaxis,Ne),o.strokeStyle="rgba(0,0,0,0.2)",Ie(ge.datapoints,Pe,null,Fe/2,!0,ge.xaxis,ge.yaxis,Ne)}o.lineWidth=ue,o.strokeStyle=ge.color,Ie(ge.datapoints,Pe,ce(ge.points,ge.color),0,!1,ge.xaxis,ge.yaxis,Ne),o.restore()}function oe(ge,Ie,ue,me,Pe,Ne,Fe,Be,he,be,Ke){var ze,nt,tt,ot,gt,He,et,rt,ht;be?(rt=He=et=!0,gt=!1,ze=ue,nt=ge,ot=Ie+me,tt=Ie+Pe,nt<ze&&(ht=nt,nt=ze,ze=ht,gt=!0,He=!1)):(gt=He=et=!0,rt=!1,ze=ge+me,nt=ge+Pe,tt=ue,ot=Ie,ot<tt&&(ht=ot,ot=tt,tt=ht,rt=!0,et=!1)),!(nt<Fe.min||ze>Fe.max||ot<Be.min||tt>Be.max)&&(ze<Fe.min&&(ze=Fe.min,gt=!1),nt>Fe.max&&(nt=Fe.max,He=!1),tt<Be.min&&(tt=Be.min,rt=!1),ot>Be.max&&(ot=Be.max,et=!1),ze=Fe.p2c(ze),tt=Be.p2c(tt),nt=Fe.p2c(nt),ot=Be.p2c(ot),Ne&&(he.fillStyle=Ne(tt,ot),he.fillRect(ze,ot,nt-ze,tt-ot)),Ke>0&&(gt||He||et||rt)&&(he.beginPath(),he.moveTo(ze,tt),gt?he.lineTo(ze,ot):he.moveTo(ze,ot),et?he.lineTo(nt,ot):he.moveTo(nt,ot),He?he.lineTo(nt,tt):he.moveTo(nt,tt),rt?he.lineTo(ze,tt):he.moveTo(ze,tt),he.stroke()))}function J(ge){function Ie(Pe,Ne,Fe,Be,he,be){for(var Ke=Pe.points,ze=Pe.pointsize,nt=0;nt<Ke.length;nt+=ze)Ke[nt]!=null&&oe(Ke[nt],Ke[nt+1],Ke[nt+2],Ne,Fe,Be,he,be,o,ge.bars.horizontal,ge.bars.lineWidth)}o.save(),o.translate(f.left,f.top),o.lineWidth=ge.bars.lineWidth,o.strokeStyle=ge.color;var ue;switch(ge.bars.align){case"left":ue=0;break;case"right":ue=-ge.bars.barWidth;break;default:ue=-ge.bars.barWidth/2}var me=ge.bars.fill?function(Pe,Ne){return ce(ge.bars,ge.color,Pe,Ne)}:null;Ie(ge.datapoints,ue,ue+ge.bars.barWidth,me,ge.xaxis,ge.yaxis),o.restore()}function ce(ge,Ie,ue,me){var Pe=ge.fill;if(!Pe)return null;if(ge.fillColor)return It(ge.fillColor,ue,me,Ie);var Ne=G.color.parse(Ie);return Ne.a=typeof Pe=="number"?Pe:.4,Ne.normalize(),Ne.toString()}function pe(){if(l.legend.container!=null?G.find(l.legend.container).html(""):s.find(".legend").remove(),!!l.legend.show){for(var ge=[],Ie=[],ue=!1,me=l.legend.labelFormatter,Pe,Ne,Fe=0;Fe<i.length;++Fe)Pe=i[Fe],Pe.label&&(Ne=me?me(Pe.label,Pe):Pe.label,Ne&&Ie.push({label:Ne,color:Pe.color}));if(l.legend.sorted)if(G.isFunction(l.legend.sorted))Ie.sort(l.legend.sorted);else if(l.legend.sorted=="reverse")Ie.reverse();else{var Be=l.legend.sorted!="descending";Ie.sort(function(He,et){return He.label==et.label?0:He.label<et.label!=Be?1:-1})}for(var Fe=0;Fe<Ie.length;++Fe){var he=Ie[Fe];Fe%l.legend.noColumns==0&&(ue&&ge.push("</tr>"),ge.push("<tr>"),ue=!0),ge.push('<td class="legendColorBox"><div style="border:1px solid '+l.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+he.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+he.label+"</td>")}if(ue&&ge.push("</tr>"),ge.length!=0){var be='<table style="font-size:smaller;color:'+l.grid.color+'">'+ge.join("")+"</table>";if(l.legend.container!=null)G(l.legend.container).html(be);else{var Ke="",ze=l.legend.position,nt=l.legend.margin;nt[0]==null&&(nt=[nt,nt]),ze.charAt(0)=="n"?Ke+="top:"+(nt[1]+f.top)+"px;":ze.charAt(0)=="s"&&(Ke+="bottom:"+(nt[1]+f.bottom)+"px;"),ze.charAt(1)=="e"?Ke+="right:"+(nt[0]+f.right)+"px;":ze.charAt(1)=="w"&&(Ke+="left:"+(nt[0]+f.left)+"px;");var tt=G('<div class="legend">'+be.replace('style="','style="position:absolute;'+Ke+";")+"</div>").appendTo(s);if(l.legend.backgroundOpacity!=0){var ot=l.legend.backgroundColor;ot==null&&(ot=l.grid.backgroundColor,ot&&typeof ot=="string"?ot=G.color.parse(ot):ot=G.color.extract(tt,"background-color"),ot.a=1,ot=ot.toString());var gt=tt.children();G('<div style="position:absolute;width:'+gt.width()+"px;height:"+gt.height()+"px;"+Ke+"background-color:"+ot+';"> </div>').prependTo(tt).css("opacity",l.legend.backgroundOpacity)}}}}}var xe=[],fe=null;function Ee(ge,Ie,ue){var me=l.grid.mouseActiveRadius,Pe=me*me+1,Ne=null,Fe=!1,Be,he,be;for(Be=i.length-1;Be>=0;--Be)if(ue(i[Be])){var Ke=i[Be],ze=Ke.xaxis,nt=Ke.yaxis,tt=Ke.datapoints.points,ot=ze.c2p(ge),gt=nt.c2p(Ie),He=me/ze.scale,et=me/nt.scale;if(be=Ke.datapoints.pointsize,ze.options.inverseTransform&&(He=Number.MAX_VALUE),nt.options.inverseTransform&&(et=Number.MAX_VALUE),Ke.lines.show||Ke.points.show)for(he=0;he<tt.length;he+=be){var rt=tt[he],ht=tt[he+1];if(rt!=null&&!(rt-ot>He||rt-ot<-He||ht-gt>et||ht-gt<-et)){var ft=Math.abs(ze.p2c(rt)-ge),De=Math.abs(nt.p2c(ht)-Ie),Te=ft*ft+De*De;Te<Pe&&(Pe=Te,Ne=[Be,he/be])}}if(Ke.bars.show&&!Ne){var Oe,Ye;switch(Ke.bars.align){case"left":Oe=0;break;case"right":Oe=-Ke.bars.barWidth;break;default:Oe=-Ke.bars.barWidth/2}for(Ye=Oe+Ke.bars.barWidth,he=0;he<tt.length;he+=be){var rt=tt[he],ht=tt[he+1],Ge=tt[he+2];rt!=null&&(i[Be].bars.horizontal?ot<=Math.max(Ge,rt)&&ot>=Math.min(Ge,rt)&&gt>=ht+Oe&&gt<=ht+Ye:ot>=rt+Oe&&ot<=rt+Ye&&gt>=Math.min(Ge,ht)&&gt<=Math.max(Ge,ht))&&(Ne=[Be,he/be])}}}return Ne?(Be=Ne[0],he=Ne[1],be=i[Be].datapoints.pointsize,{datapoint:i[Be].datapoints.points.slice(he*be,(he+1)*be),dataIndex:he,series:i[Be],seriesIndex:Be}):null}function Se(ge){l.grid.hoverable&&Ue("plothover",ge,function(Ie){return Ie.hoverable!=!1})}function ye(ge){l.grid.hoverable&&Ue("plothover",ge,function(Ie){return!1})}function Ve(ge){P.isSelecting||Ue("plotclick",ge,function(Ie){return Ie.clickable!=!1})}function Me(ge){if(ge.cancelable){if(!h.is(ge.target)&&h.has(ge.target).length===0){Ue("plotleave",ge,function(Ie){});return}Se(Ce(ge)),ge.preventDefault()}}function Ce(ge){if(!ge||!ge.originalEvent||ge.pageX&&ge.pageY)return ge;var Ie=ge.originalEvent;if(Ie.changedTouches.length===0)return ge;var ue=Ie.changedTouches[0];return ge.pageX=ue.pageX,ge.pageY=ue.pageY,ge}function Ue(ge,Ie,ue){var me=h.offset(),Pe=Ie.pageX-me.left-f.left,Ne=Ie.pageY-me.top-f.top,Fe=M({left:Pe,top:Ne});Fe.pageX=Ie.pageX,Fe.pageY=Ie.pageY,Fe.ctrlKey=Ie.ctrlKey,Fe.metaKey=Ie.metaKey;var Be=Ee(Pe,Ne,ue);if(Be&&(Be.pageX=parseInt(Be.series.xaxis.p2c(Be.datapoint[0])+me.left+f.left,10),Be.pageY=parseInt(Be.series.yaxis.p2c(Be.datapoint[1])+me.top+f.top,10)),l.grid.autoHighlight){for(var he=0;he<xe.length;++he){var be=xe[he];be.auto==ge&&!(Be&&be.series==Be.series&&be.point[0]==Be.datapoint[0]&&be.point[1]==Be.datapoint[1])&&_e(be.series,be.point)}Be&&We(Be.series,Be.datapoint,ge)}s.trigger(ge,[Fe,Be])}function Ae(){var ge=l.interaction.redrawOverlayInterval;if(ge==-1){we();return}fe||(fe=setTimeout(we,ge))}function we(){fe=null,m.save(),c.clear(),m.translate(f.left,f.top);var ge,Ie;for(ge=0;ge<xe.length;++ge)Ie=xe[ge],Ie.series.bars.show?Tt(Ie.series,Ie.point):ut(Ie.series,Ie.point);m.restore(),E(v.drawOverlay,[m])}function We(ge,Ie,ue){if(typeof ge=="number"&&(ge=i[ge]),typeof Ie=="number"){var me=ge.datapoints.pointsize;Ie=ge.datapoints.points.slice(me*Ie,me*(Ie+1))}var Pe=at(ge,Ie);Pe==-1?(xe.push({series:ge,point:Ie,auto:ue}),Ae()):ue||(xe[Pe].auto=!1)}function _e(ge,Ie){if(ge==null&&Ie==null){xe=[],Ae();return}if(typeof ge=="number"&&(ge=i[ge]),typeof Ie=="number"){var ue=ge.datapoints.pointsize;Ie=ge.datapoints.points.slice(ue*Ie,ue*(Ie+1))}var me=at(ge,Ie);me!=-1&&(xe.splice(me,1),Ae())}function at(ge,Ie){for(var ue=0;ue<xe.length;++ue){var me=xe[ue];if(me.series==ge&&me.point[0]==Ie[0]&&me.point[1]==Ie[1])return ue}return-1}function ut(ge,Ie){var ue=Ie[0],me=Ie[1],Pe=ge.xaxis,Ne=ge.yaxis,Fe=typeof ge.highlightColor=="string"?ge.highlightColor:G.color.parse(ge.color).scale("a",.5).toString();if(!(ue<Pe.min||ue>Pe.max||me<Ne.min||me>Ne.max)){var Be=ge.points.radius+ge.points.lineWidth/2;m.lineWidth=Be,m.strokeStyle=Fe;var he=1.5*Be;ue=Pe.p2c(ue),me=Ne.p2c(me),m.beginPath(),ge.points.symbol=="circle"?m.arc(ue,me,he,0,2*Math.PI,!1):ge.points.symbol(m,ue,me,he,!1),m.closePath(),m.stroke()}}function Tt(ge,Ie){var ue=typeof ge.highlightColor=="string"?ge.highlightColor:G.color.parse(ge.color).scale("a",.5).toString(),me=ue,Pe;switch(ge.bars.align){case"left":Pe=0;break;case"right":Pe=-ge.bars.barWidth;break;default:Pe=-ge.bars.barWidth/2}m.lineWidth=ge.bars.lineWidth,m.strokeStyle=ue,oe(Ie[0],Ie[1],Ie[2]||0,Pe,Pe+ge.bars.barWidth,function(){return me},ge.xaxis,ge.yaxis,m,ge.bars.horizontal,ge.bars.lineWidth)}function It(ge,Ie,ue,me){if(typeof ge=="string")return ge;for(var Pe=o.createLinearGradient(0,ue,0,Ie),Ne=0,Fe=ge.colors.length;Ne<Fe;++Ne){var Be=ge.colors[Ne];if(typeof Be!="string"){var he=G.color.parse(me);Be.brightness!=null&&(he=he.scale("rgb",Be.brightness)),Be.opacity!=null&&(he.a*=Be.opacity),Be=he.toString()}Pe.addColorStop(Ne/(Fe-1),Be)}return Pe}}G.plot=function(s,a,r){var g=new t(G(s),a,r,G.plot.plugins);return g},G.plot.version="0.8.3",G.plot.plugins=[],G.fn.plot=function(s,a){return this.each(function(){G.plot(this,s,a)})};function n(s,a){return a*Math.floor(s/a)}}(jQuery)},80851:()=>{(function(G){function R(e){var t={first:{x:-1,y:-1},second:{x:-1,y:-1},show:!1,active:!1},n={},s=null;function a(f){t.active&&(h(f),e.getPlaceholder().trigger("plotselecting",[i()]))}function r(f){f.which==1&&(document.body.focus(),document.onselectstart!==void 0&&n.onselectstart==null&&(n.onselectstart=document.onselectstart,document.onselectstart=function(){return!1}),document.ondrag!==void 0&&n.ondrag==null&&(n.ondrag=document.ondrag,document.ondrag=function(){return!1}),c(t.first,f),t.active=!0,s=function(y){g(y)},G(document).one("mouseup",s))}function g(f){return s=null,document.onselectstart!==void 0&&(document.onselectstart=n.onselectstart),document.ondrag!==void 0&&(document.ondrag=n.ondrag),t.active=!1,h(f),p()?l(f):(e.getPlaceholder().trigger("plotunselected",[]),e.getPlaceholder().trigger("plotselecting",[null])),setTimeout(function(){e.isSelecting=!1},10),!1}function i(){if(!p()||!t.show)return null;var f={},y=t.first,x=t.second,v=e.getAxes(),P=!0;return G.each(v,function(E,D){D.used&&(anyUsed=!1)}),G.each(v,function(E,D){if(D.used||P){var C=D.c2p(y[D.direction]),b=D.c2p(x[D.direction]);f[E]={from:Math.min(C,b),to:Math.max(C,b)}}}),f}function l(f){var y=i();y.ctrlKey=f.ctrlKey,y.metaKey=f.metaKey,e.getPlaceholder().trigger("plotselected",[y]),y.xaxis&&y.yaxis&&e.getPlaceholder().trigger("selected",[{x1:y.xaxis.from,y1:y.yaxis.from,x2:y.xaxis.to,y2:y.yaxis.to}])}function d(f,y,x){return y<f?f:y>x?x:y}function c(f,y){var x=e.getOptions(),v=e.getPlaceholder().offset(),P=e.getPlotOffset();f.x=d(0,y.pageX-v.left-P.left,e.width()),f.y=d(0,y.pageY-v.top-P.top,e.height()),x.selection.mode=="y"&&(f.x=f==t.first?0:e.width()),x.selection.mode=="x"&&(f.y=f==t.first?0:e.height())}function h(f){f.pageX!=null&&(c(t.second,f),p()?(e.isSelecting=!0,t.show=!0,e.triggerRedrawOverlay()):o(!0))}function o(f){t.show&&(t.show=!1,e.triggerRedrawOverlay(),f||e.getPlaceholder().trigger("plotunselected",[]))}function m(f,y){var x,v,P,E,D=e.getAxes();for(var C in D)if(x=D[C],x.direction==y&&(E=y+x.n+"axis",!f[E]&&x.n==1&&(E=y+"axis"),f[E])){v=f[E].from,P=f[E].to;break}if(f[E]||(x=y=="x"?e.getXAxes()[0]:e.getYAxes()[0],v=f[y+"1"],P=f[y+"2"]),v!=null&&P!=null&&v>P){var b=v;v=P,P=b}return{from:v,to:P,axis:x}}function u(f,y){var x,v,P=e.getOptions();P.selection.mode=="y"?(t.first.x=0,t.second.x=e.width()):(v=m(f,"x"),t.first.x=v.axis.p2c(v.from),t.second.x=v.axis.p2c(v.to)),P.selection.mode=="x"?(t.first.y=0,t.second.y=e.height()):(v=m(f,"y"),t.first.y=v.axis.p2c(v.from),t.second.y=v.axis.p2c(v.to)),t.show=!0,e.triggerRedrawOverlay(),!y&&p()&&l()}function p(){var f=e.getOptions().selection.minSize;return Math.abs(t.second.x-t.first.x)>=f&&Math.abs(t.second.y-t.first.y)>=f}e.clearSelection=o,e.setSelection=u,e.getSelection=i,e.hooks.bindEvents.push(function(f,y){var x=f.getOptions();x.selection.mode!=null&&(y.mousemove(a),y.mousedown(r))}),e.hooks.drawOverlay.push(function(f,y){if(t.show&&p()){var x=f.getPlotOffset(),v=f.getOptions();y.save(),y.translate(x.left,x.top);var P=G.color.parse(v.selection.color);y.strokeStyle=P.scale("a",.8).toString(),y.lineWidth=1,y.lineJoin=v.selection.shape,y.fillStyle=P.scale("a",.4).toString();var E=Math.min(t.first.x,t.second.x)+.5,D=Math.min(t.first.y,t.second.y)+.5,C=Math.abs(t.second.x-t.first.x)-1,b=Math.abs(t.second.y-t.first.y)-1;y.fillRect(E,D,C,b),y.strokeRect(E,D,C,b),y.restore()}}),e.hooks.shutdown.push(function(f,y){y.unbind("mousemove",a),y.unbind("mousedown",r),s&&(G(document).unbind("mouseup",s),document.onselectstart!==void 0&&(document.onselectstart=n.onselectstart),document.ondrag!==void 0&&(document.ondrag=n.ondrag))})}G.plot.plugins.push({init:R,options:{selection:{mode:null,color:"#e8cfac",shape:"round",minSize:5}},name:"selection",version:"1.1"})})(jQuery)},31221:()=>{(function(G){var R={series:{stack:null}};function e(t){function n(a,r){for(var g=null,i=0;i<r.length&&a!=r[i];++i)r[i].stack==a.stack&&(g=r[i]);return g}function s(a,r,g){if(!(r.stack==null||r.stack===!1)){var i=n(r,a.getData());if(i){for(var l=g.pointsize,d=g.points,c=i.datapoints.pointsize,h=i.datapoints.points,o=[],m,u,p,f,y,x,v=r.lines.show,P=r.bars.horizontal,E=l>2&&(P?g.format[2].x:g.format[2].y),D=v&&r.lines.steps,C=P?1:0,b=P?0:1,T=0,S=0,O,M;!(T>=d.length&&S>=h.length);){if(O=o.length,T<d.length&&d[T]==null){for(M=0;M<l;++M)o.push(d[T+M]);T+=l}else if(T>=d.length){for(M=0;M<l;++M)o.push(h[S+M]);E&&(o[O+2]=h[S+b]),S+=c}else if(S>=h.length){for(M=0;M<l;++M)o.push(d[T+M]);T+=l}else if(S<h.length&&h[S]==null)S+=c;else{if(m=d[T+C],u=d[T+b],f=h[S+C],y=h[S+b],x=0,m==f){for(M=0;M<l;++M)o.push(d[T+M]);o[O+b]+=y,x=y,T+=l,S+=c}else if(m>f){if(T==0){for(M=0;M<l;++M)o.push(h[S+M]);x=y}if(T>0&&d[T-l]!=null){for(p=0,o.push(f),o.push(p+y),M=2;M<l;++M)o.push(d[T+M]);x=y}S+=c}else{for(M=0;M<l;++M)o.push(d[T+M]);S>0&&h[S-c]!=null&&(x=0),o[O+b]+=x,T+=l}fromgap=!1,O!=o.length&&E&&(o[O+2]=x)}if(D&&O!=o.length&&O>0&&o[O]!=null&&o[O]!=o[O-l]&&o[O+1]!=o[O-l+1]){for(M=0;M<l;++M)o[O+l+M]=o[O+M];o[O+1]=o[O-l+1]}}g.points=o}}}t.hooks.processDatapoints.push(s)}G.plot.plugins.push({init:e,options:R,name:"stack",version:"1.2"})})(jQuery)},91520:()=>{(function(G){var R={series:{stackpercent:null}};function e(t){var n={},s=!1,a={};function r(l,d,c,h){if(s||(s=!0,a=g(l.getData())),d.stackpercent==!0){var o=c.length;d.percents=[];var m=0,u=1;d.bars&&d.bars.horizontal&&d.bars.horizontal===!0&&(m=1,u=0);for(var p=0;p<o;p++){var f=a[c[p][m]+""];f>0?d.percents.push(c[p][u]*100/f):d.percents.push(0)}}}function g(l){var d=l.length,c={};if(d>0){for(var h=0;h<d;h++)if(l[h].stackpercent){var o=0,m=1;l[h].bars&&l[h].bars.horizontal&&l[h].bars.horizontal===!0&&(o=1,m=0);for(var u=l[h].data.length,p=0;p<u;p++){var f=0;l[h].data[p][1]!=null&&(f=l[h].data[p][m]),c[l[h].data[p][o]+""]?c[l[h].data[p][o]+""]+=f:c[l[h].data[p][o]+""]=f}}}return c}function i(l,d,c){if(d.stackpercent){s||(a=g(l.getData()));var h=[],o=0,m=1;d.bars&&d.bars.horizontal&&d.bars.horizontal===!0&&(o=1,m=0);for(var u=0;u<c.points.length;u+=3)n[c.points[u+o]]||(n[c.points[u+o]]=0),h[u+o]=c.points[u+o],h[u+m]=c.points[u+m]+n[c.points[u+o]],h[u+2]=n[c.points[u+o]],n[c.points[u+o]]+=c.points[u+m],a[h[u+o]+""]>0?(h[u+m]=h[u+m]*100/a[h[u+o]+""],h[u+2]=h[u+2]*100/a[h[u+o]+""]):(h[u+m]=0,h[u+2]=0);c.points=h}}t.hooks.processRawData.push(r),t.hooks.processDatapoints.push(i)}G.plot.plugins.push({init:e,options:R,name:"stackpercent",version:"0.1"})})(jQuery)},32176:()=>{(function(G){var R={xaxis:{timezone:null,timeformat:null,twelveHourClock:!1,monthNames:null}};function e(d,c){return c*Math.floor(d/c)}function t(d,c,h,o){if(typeof d.strftime=="function")return d.strftime(c);var m=function(E,D){return E=""+E,D=""+(D??"0"),E.length==1?D+E:E},u=[],p=!1,f=d.getHours(),y=f<12;h==null&&(h=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),o==null&&(o=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]);var x;f>12?x=f-12:f==0?x=12:x=f;for(var v=0;v<c.length;++v){var P=c.charAt(v);if(p){switch(P){case"a":P=""+o[d.getDay()];break;case"b":P=""+h[d.getMonth()];break;case"d":P=m(d.getDate(),"");break;case"e":P=m(d.getDate()," ");break;case"h":case"H":P=m(f);break;case"I":P=m(x);break;case"l":P=m(x," ");break;case"m":P=m(d.getMonth()+1,"");break;case"M":P=m(d.getMinutes());break;case"q":P=""+(Math.floor(d.getMonth()/3)+1);break;case"S":P=m(d.getSeconds());break;case"y":P=m(d.getFullYear()%100);break;case"Y":P=""+d.getFullYear();break;case"p":P=y?"am":"pm";break;case"P":P=y?"AM":"PM";break;case"w":P=""+d.getDay();break}u.push(P),p=!1}else P=="%"?p=!0:u.push(P)}return u.join("")}function n(d){function c(u,p,f,y){u[p]=function(){return f[y].apply(f,arguments)}}var h={date:d};d.strftime!=null&&c(h,"strftime",d,"strftime"),c(h,"getTime",d,"getTime"),c(h,"setTime",d,"setTime");for(var o=["Date","Day","FullYear","Hours","Milliseconds","Minutes","Month","Seconds"],m=0;m<o.length;m++)c(h,"get"+o[m],d,"getUTC"+o[m]),c(h,"set"+o[m],d,"setUTC"+o[m]);return h}function s(d,c){if(c.timezone=="browser")return new Date(d);if(!c.timezone||c.timezone=="utc")return n(new Date(d));if(typeof timezoneJS<"u"&&typeof timezoneJS.Date<"u"){var h=new timezoneJS.Date;return h.setTimezone(c.timezone),h.setTime(d),h}else return n(new Date(d))}var a={second:1e3,minute:60*1e3,hour:60*60*1e3,day:24*60*60*1e3,month:30*24*60*60*1e3,quarter:3*30*24*60*60*1e3,year:365.2425*24*60*60*1e3},r=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[.25,"month"],[.5,"month"],[1,"month"],[2,"month"]],g=r.concat([[3,"month"],[6,"month"],[1,"year"]]),i=r.concat([[1,"quarter"],[2,"quarter"],[1,"year"]]);function l(d){d.hooks.processOptions.push(function(c,h){G.each(c.getAxes(),function(o,m){var u=m.options;u.mode=="time"&&(m.tickGenerator=function(p){var f=[],y=s(p.min,u),x=0,v=u.tickSize&&u.tickSize[1]==="quarter"||u.minTickSize&&u.minTickSize[1]==="quarter"?i:g;u.minTickSize!=null&&(typeof u.tickSize=="number"?x=u.tickSize:x=u.minTickSize[0]*a[u.minTickSize[1]]);for(var P=0;P<v.length-1&&!(p.delta<(v[P][0]*a[v[P][1]]+v[P+1][0]*a[v[P+1][1]])/2&&v[P][0]*a[v[P][1]]>=x);++P);var E=v[P][0],D=v[P][1];if(D=="year"){if(u.minTickSize!=null&&u.minTickSize[1]=="year")E=Math.floor(u.minTickSize[0]);else{var C=Math.pow(10,Math.floor(Math.log(p.delta/a.year)/Math.LN10)),b=p.delta/a.year/C;b<1.5?E=1:b<3?E=2:b<7.5?E=5:E=10,E*=C}E<1&&(E=1)}p.tickSize=u.tickSize||[E,D];var T=p.tickSize[0];D=p.tickSize[1];var S=T*a[D];D=="second"?y.setSeconds(e(y.getSeconds(),T)):D=="minute"?y.setMinutes(e(y.getMinutes(),T)):D=="hour"?y.setHours(e(y.getHours(),T)):D=="month"?y.setMonth(e(y.getMonth(),T)):D=="quarter"?y.setMonth(3*e(y.getMonth()/3,T)):D=="year"&&y.setFullYear(e(y.getFullYear(),T)),y.setMilliseconds(0),S>=a.minute&&y.setSeconds(0),S>=a.hour&&y.setMinutes(0),S>=a.day&&y.setHours(0),S>=a.day*4&&y.setDate(1),S>=a.month*2&&y.setMonth(e(y.getMonth(),3)),S>=a.quarter*2&&y.setMonth(e(y.getMonth(),6)),S>=a.year&&y.setMonth(0);var O=0,M=Number.NaN,I;do if(I=M,M=y.getTime(),f.push(M),D=="month"||D=="quarter")if(T<1){y.setDate(1);var L=y.getTime();y.setMonth(y.getMonth()+(D=="quarter"?3:1));var B=y.getTime();y.setTime(M+O*a.hour+(B-L)*T),O=y.getHours(),y.setHours(0)}else y.setMonth(y.getMonth()+T*(D=="quarter"?3:1));else D=="year"?y.setFullYear(y.getFullYear()+T):y.setTime(M+S);while(M<p.max&&M!=I);return f},m.tickFormatter=function(p,f){var y=s(p,f.options);if(u.timeformat!=null)return t(y,u.timeformat,u.monthNames,u.dayNames);var x=f.options.tickSize&&f.options.tickSize[1]=="quarter"||f.options.minTickSize&&f.options.minTickSize[1]=="quarter",v=f.tickSize[0]*a[f.tickSize[1]],P=f.max-f.min,E=u.twelveHourClock?" %p":"",D=u.twelveHourClock?"%I":"%H",C;v<a.minute?C=D+":%M:%S"+E:v<a.day?P<2*a.day?C=D+":%M"+E:C="%b %d "+D+":%M"+E:v<a.month?C="%b %d":x&&v<a.quarter||!x&&v<a.year?P<a.year?C="%b":C="%b %Y":x&&v<a.year?P<a.year?C="Q%q":C="Q%q %Y":C="%Y";var b=t(y,C,u.monthNames,u.dayNames);return b})})})}G.plot.plugins.push({init:l,options:R,name:"time",version:"1.0"}),G.plot.formatDate=t})(jQuery)}}]);

//# sourceMappingURL=7462.d83af2435fe93a4c1754.js.map