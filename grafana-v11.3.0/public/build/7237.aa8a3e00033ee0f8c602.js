(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[7237],{17237:(re,me,P)=>{"use strict";P.r(me),P.d(me,{SetupSAMLPage:()=>Ir,SetupSAMLPageUnconnected:()=>Ar,default:()=>Lr});var t=P(74848),e=P(2543),h=P(96540),s=P(71468),E=P(54148),T=P(21780),d=P(64915),p=P(31906),a=P(13680),o=P(32196),S=P(49785),U=P(40845),x=P(56034),y=P(14578),m=P(88575),c=P(15292),v=P(72109),R=P(10354),n=P(90182),f=P(10096),C=P(14186);const B=({value:F,label:Y,placeholder:le,width:ie,id:oe,onChange:ge})=>{const Te=(0,U.of)(V),we=Ne=>{const Qe=Ne.currentTarget.value;ge(Qe)};return(0,t.jsx)("div",{className:Te.assertionEditorRow,children:(0,t.jsx)(C.I,{label:Y,labelWidth:16,htmlFor:oe,children:(0,t.jsx)(R.p,{width:ie||30,id:oe,value:F||"",onChange:we,placeholder:le})})})},V=F=>({assertionEditorRow:(0,o.css)`
      display: flex;
      margin-bottom: ${F.spacing(1)};
    `,inputLabel:(0,o.css)`
      color: ${F.components.input.text};
      background: ${F.components.input.background};
    `});var u=P(55852);const g=({isConfigured:F,onReset:Y,label:le,...ie})=>{const oe=(0,U.of)(b);return(0,t.jsxs)("div",{className:oe.inputWithReset,children:[(0,t.jsx)(C.I,{label:le,labelWidth:16,htmlFor:ie.id,children:(0,t.jsx)(t.Fragment,{children:F?(0,t.jsx)(R.p,{...ie,value:"configured",disabled:!0}):(0,t.jsx)(R.p,{...ie})})}),F&&(0,t.jsx)(u.$n,{className:oe.resetButton,variant:"primary",size:"md",onClick:Y,children:"Reset"})]})},b=F=>({resetButton:(0,o.css)`
      border-top-left-radius: 0px;
      border-bottom-left-radius: 0px;
    `,inputWithReset:(0,o.css)`
      padding: 0;
      display: flex;
    `});var r=P(14110),D=P(84167),O=P(17408),w=P(39938),H=P(35339),j=P(42418),z=P(20604);function W(F){return{error:F.authConfig.updateError,warning:F.authConfig.warning}}const X={resetError:z.SH,resetWarning:z.yk},he=(0,s.connect)(W,X)(({error:F,warning:Y,resetError:le,resetWarning:ie})=>(0,t.jsxs)("div",{children:[F&&(0,t.jsx)(j.F,{title:F.message,onRemove:()=>le(),children:F.errors?.map((oe,ge)=>(0,t.jsx)("div",{children:oe},ge))}),Y&&(0,t.jsx)(j.F,{title:Y.message,onRemove:()=>ie(),severity:"warning",children:Y.errors?.map((oe,ge)=>(0,t.jsx)("div",{children:oe},ge))})]}));var xe=P(1009);const Se=({error:F,onReset:Y})=>(0,t.jsx)("div",{children:F&&(0,t.jsx)(j.F,{title:F.message,onRemove:Y,severity:"warning",children:F.errors?.map((le,ie)=>(0,t.jsx)("div",{children:le},ie))})});var ve=P(39601),ae=P(26224);const ue=F=>{if(!F)return Ye[0];const Y=Ye.findIndex(le=>le.id===F);return Y===Ye.length-1?Ye[Y]:Ye[Y+1]},be=F=>{if(!F||F===Ye[0].id)return;const Y=Ye.findIndex(le=>le.id===F);return Ye[Y-1]},We=F=>{const Y=be(F);Y&&Y.id!==F&&ve.Ny.push((0,ae.Do)(Y.id))},Ie=(0,h.forwardRef)(({activeStep:F,disabled:Y},le)=>{const ie=(0,U.of)(Q),oe=(0,h.useRef)(null),ge=be(F),Te=ue(F),we=Te.id===F;(0,h.useImperativeHandle)(le,()=>({click:()=>{oe.current?.click()}}));const Ne=()=>{oe.current?.click(),We(F)};return(0,t.jsx)("div",{className:ie.buttonRow,children:(0,t.jsx)("div",{className:ie.buttonRowInner,children:(0,t.jsxs)("div",{children:[ge&&(0,t.jsxs)(u.$n,{variant:"secondary",onClick:Ne,children:["Previous: ",ge.name]}),!we&&(0,t.jsxs)(u.$n,{ref:oe,disabled:Y,type:"submit",children:["Next: ",Te.name]})]})})})});Ie.displayName="ButtonRow";const Q=F=>({buttonRow:(0,o.css)`
      display: flex;
      padding: ${F.spacing(2,0,.5,0)};
      border-top: 1px solid ${F.colors.border.weak};
      width: 100%;
      background-color: ${F.colors.background.primary};
      button {
        &:first-of-type {
          margin-right: ${F.spacing(2)};
        }
        &:last-of-type {
          margin-right: 0;
        }
      }
    `,buttonRowInner:(0,o.css)`
      display: flex;
      justify-content: space-between;
      width: 100%;
    `});var l=P(38138),L=P(83122),i=P(29158),A=P(96374);const K=({enabled:F,isNewConfig:Y,onSave:le,onSaveAndEnable:ie,onDisable:oe,onRemove:ge})=>{const Te=(0,U.of)(G);let we={text:"Not enabled",color:"blue"};F?we={text:"Enabled",color:"green",icon:"check"}:Y||(we={text:"Not enabled",color:"blue"});const[Ne,Qe]=(0,h.useState)(!1),dt=()=>{ge(),Qe(!1),window.location.href="/admin/authentication"},Me=(0,t.jsx)(l.W,{children:(0,t.jsx)(l.W.Item,{label:"Delete",icon:"trash-alt",onClick:()=>{Qe(!0)}})});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:Te.actionBarContainer,children:[(0,t.jsxs)("div",{className:Te.protocolContainer,children:[(0,t.jsx)("span",{className:Te.protocolLabel,children:"Protocol"}),(0,t.jsx)("span",{children:"SAML 2.0"})]}),!Y&&(0,t.jsxs)("div",{className:Te.statusContainer,children:[(0,t.jsx)("span",{className:Te.statusLabel,children:"Status"}),(0,t.jsx)(w.E,{...we,className:Te.statusBadge})]}),!F&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.$n,{variant:"secondary",onClick:le,children:"Save"}),(0,t.jsx)(u.$n,{variant:"primary",onClick:ie,children:"Save and enable"})]}),F&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.$n,{variant:"primary",onClick:le,children:"Save and apply"}),(0,t.jsx)(x.m,{content:"Disable will disable Grafana to not use SAML auth.",placement:"top",children:(0,t.jsx)(u.$n,{variant:"secondary",fill:"outline",onClick:oe,children:"Disable"})})]}),!Y&&(0,t.jsx)(L.m,{overlay:Me,placement:"bottom-start",children:(0,t.jsx)(i.K,{tooltip:"More actions",tooltipPlacement:"top",variant:"secondary",name:"ellipsis-v"})})]}),(0,t.jsx)(A.u,{title:"Delete SAML configuration",body:"Are you sure you want to permanently delete this SAML configuration? All changes made in the UI will be removed.",confirmText:"Delete configuration",confirmationText:F?"delete":"",dismissText:"Back to editing",isOpen:Ne,onDismiss:()=>Qe(!1),onConfirm:dt})]})},G=F=>({actionBarContainer:(0,o.css)`
      display: flex;
      flexdirection: row;
      gap: ${F.spacing(1)};
      align-items: center;
      justify-content: flex-end;
    `,iniFileLabel:(0,o.css)`
      display: flex;
      color: ${F.colors.text.primary};
      justify-content: flex-end;
    `,tooltipContainer:(0,o.css)`
      padding: ${F.spacing(0,1)};
    `,statusContainer:(0,o.css)`
      display: flex;
      flex-direction: column;
      font-size: ${F.typography.bodySmall.fontSize};
      border-left: 1px solid ${F.colors.border.medium};
      padding: ${F.spacing(0,2)};
    `,statusBadge:(0,o.css)`
      span {
        font-size: ${F.typography.size.xs};
      }
    `,statusLabel:(0,o.css)`
      color: ${F.colors.text.secondary};
    `,protocolContainer:(0,o.css)`
      display: flex;
      flex-direction: column;
      font-size: ${F.typography.bodySmall.fontSize};
      padding-right: ${F.spacing(1)};
    `,protocolLabel:(0,o.css)`
      color: ${F.colors.text.secondary};
    `});var M=P(31678),Z=P(64920),pe=P(39547),ce=P.n(pe);function $(F,Y,le){Ke(le,F(Y))}function de(F){const Y={valid:!0,errors:[]};return $(Ce,F,Y),$(Ue,F,Y),$(Oe,F,Y),$(Pe,F,Y),Y}function ye(F,Y){switch(Y){case SAMLStepKey.General:return!Ce(F).valid;case SAMLStepKey.KeyCert:return!Ue(F).valid;case SAMLStepKey.ConnectToIdP:return!Oe(F).valid;case SAMLStepKey.AssertionMapping:return!Pe(F).valid;default:return!1}}function Be(F){const Y={};return Ye.forEach(({id:le})=>{switch(le){case a.SAMLStepKey.General:Y[le]=Ce(F);return;case a.SAMLStepKey.KeyCert:Y[le]=Ue(F);return;case a.SAMLStepKey.ConnectToIdP:Y[le]=Oe(F);return;case a.SAMLStepKey.AssertionMapping:Y[le]=Pe(F);return}}),Y}function Ce(F){const Y={valid:!0,errors:[]},{allowIdpInitiated:le,relayState:ie}=F;return le===!0&&!ie&&Re(Y,"Relay state should be configured"),ie&&ie.length>80&&Re(Y,"Relay state should be 80 characters or less"),Y}function Ue(F){const Y={valid:!0,errors:[]},{signRequests:le,privateKey:ie,privateKeyPath:oe,certificate:ge,certificatePath:Te}=F;return le&&!ie&&!oe&&Re(Y,"Private key should be configured if sign requests is enabled"),le&&!ge&&!Te&&Re(Y,"Certificate key should be configured if sign requests is enabled"),ie&&!ie.startsWith("***")&&!je(ie)&&Re(Y,"Not valid PEM private key"),ge&&!ge.startsWith("***")&&!lt(ge)&&Re(Y,"Not valid PEM certificate"),Y}function Oe(F){const Y={valid:!0,errors:[]},{idpMetadataUrl:le,idpMetadataPath:ie,idpMetadata:oe,metadataValueType:ge}=F;return(ge==="base64"&&!oe||ge==="url"&&!le||ge==="path"&&!ie||!le&&!ie&&!oe)&&Re(Y,"IdP metadata should be configured"),Y}function Pe(F){return{valid:!0,errors:[]}}function Ke(F,Y){Y.valid||(F.valid=!1,F.errors?.push(...Y.errors))}function Re(F,Y){F.valid=!1,F.errors?.push(Y)}function Xe(F){return/^([0-9]*(\.[0-9]*)?[smh]+)+$/.test(F)}function je(F){try{const Y=atob(F);return ut(Y)}catch{return!1}}function ut(F){try{const Y=pe.pem.decode(F);return!(Y.length>1||Y[0].type!=="PRIVATE KEY")}catch{return!1}}function lt(F){try{const Y=atob(F);return pt(Y)}catch{return!1}}function pt(F){try{const Y=pe.pki.certificateFromPem(F),le=new Date;return!(Y.validity.notBefore>le||Y.validity.notAfter<le)}catch{return!1}}var Ee=P(71315);const St=5e3;function ct(){return async F=>{if(f.TP.hasPermission(M.AccessControlAction.SettingsRead))try{F((0,Ee.tC)());const[Y,le]=await(0,Z.rC)();F((0,Ee.eO)(le)),F((0,Ee.cD)(!!Y.signatureAlgorithm||!!Y.privateKeyPath||!!Y.privateKey||!!Y.certificatePath||!!Y.certificate)),F((0,Ee.$$)(Y.privateKeyPath?"path":"base64")),F((0,Ee.w4)(!!Y.privateKeyPath||!!Y.privateKey)),F((0,Ee.XN)(!!Y.certificatePath||!!Y.certificate)),F((0,Ee.Zt)((0,ae.H)(Y))),F((0,Ee.Pr)(Y))}catch{F((0,Ee.ZC)())}}}function Tt(F,Y){return async le=>{le((0,Ee.SH)());const ie=de(F);if(!ie.valid){le((0,Ee.Nh)({message:"Cannot save settings",errors:ie.errors}));return}await le((0,Z.aG)(F,Y))&&(le(Pt()),le(ct()))}}function Ut(){return async F=>{await F((0,Z.Bw)())&&(F(Pt()),F(ct()))}}function Vt(F){return async Y=>{await Y((0,Z.iZ)(F))&&(Y(Pt()),Y(ct()))}}function Mt(F){return async Y=>{await Y((0,Z.DC)(F))&&(Y(Pt()),Y(ct()))}}function Pt(){return async F=>{F((0,Ee.mA)(!0)),setTimeout(()=>{F((0,Ee.mA)(!1))},St)}}const Yt=F=>{const{samlSettings:Y,storedSamlSettings:le,isUpdated:ie,visitedSteps:oe,keyCertValueType:ge,keyConfigured:Te,certConfigured:we,signRequests:Ne,metadataValueType:Qe,showSavedBadge:dt,error:Me}=F.samlConfig;return{isUpdated:ie,samlSettings:Y,storedSamlSettings:le,visitedSteps:oe,keyCertValueType:ge,keyConfigured:Te,certConfigured:we,signRequests:Ne,metadataValueType:Qe,showSavedBadge:dt,error:Me}},qt={addVisitedStep:Ee.wj,clearSAMLState:Ee.OG,saveSAMLSettings:Tt,enableSAML:Vt,disableSAML:Mt,resetSAMLSettings:Ut,setError:Ee.Nh,resetError:Ee.SH},$e=(0,s.connect)(Yt,qt),Ze=({samlSettings:F,storedSamlSettings:Y,keyCertValueType:le,metadataValueType:ie,signRequests:oe,activeStep:ge,addVisitedStep:Te,children:we,clearSAMLState:Ne,confirmRedirect:Qe,keyConfigured:dt,certConfigured:Me,isUpdated:yt,error:bt,resetError:mt,visitedSteps:ot,showSavedBadge:Nt,label:Ct,className:Kt,getFormData:Rt,onSubmit:ft,saveSAMLSettings:wt,enableSAML:xt,disableSAML:_t,resetSAMLSettings:Le})=>{const ht=(0,U.of)(qe),Lt=ue(ge),Ft=(0,h.useRef)(null),[Wt,jt]=(0,h.useState)(Qe||yt),er=(0,E.Zp)();(0,h.useEffect)(()=>{(Ae=>{(0,r.rR)("authentication_saml_step",{step:Ae}),Ae===Ye[Ye.length-1].id?Te(Ye.map(vt=>vt.id)):Te([Ae])})(ge)},[ge,Te]),(0,h.useEffect)(()=>{jt(Qe||yt)},[Qe,yt]);const nr=ne=>{ne.preventDefault();const Ae=(0,ae.Do)(Lt.id);ft(),er(Ae)},tr=()=>{let ne={...F,keyCertValueType:le,signRequests:oe,metadataValueType:ie,keyConfigured:dt,certConfigured:Me};if(Rt){const Ae=Rt();ne={...ne,...Ae}}return ne},Xt=async ne=>{const Ae=tr();ne&&(Ae.enabled=!0),wt(Ae,Y),(0,r.rR)("authentication_saml_saved",{enabled:Ae.enabled}),jt(!1),Ne()},ir=()=>{(0,r.rR)("authentication_saml_enabled"),xt(F)},rr=()=>{(0,r.rR)("authentication_saml_disabled"),_t(F)},zt=()=>{Ne(),(0,r.rR)("authentication_saml_abandoned")},Qt=()=>{(0,r.rR)("authentication_saml_removed"),Le()},$t=ne=>!Ye.map(vt=>(0,ae.Do)(vt.id)).includes(ne.pathname),sr=()=>{const ne=Ye[Ye.length-1].id;ge!==ne&&Ft.current?.click()},Ve=Be(tr());return(0,t.jsxs)("form",{onSubmit:nr,className:ht.container,children:[(0,t.jsx)(K,{enabled:F.enabled,isNewConfig:(0,ae.nj)(Y),onSave:()=>Xt(),onSaveAndEnable:()=>Xt(!0),onEnable:ir,onDisable:rr,onRemove:Qt}),(0,t.jsx)(H.F,{confirmRedirect:Wt,onDiscard:zt,onLocationChange:$t}),(0,t.jsxs)("div",{className:ht.inner,children:[(0,t.jsx)(xe.C,{steps:Ye,activeStep:ge,visitedSteps:ot,onStepChange:sr,getNextUrl:ae.Do,validationResults:Ve}),(0,t.jsx)(he,{}),(0,t.jsx)(Se,{error:bt,onReset:mt}),(0,t.jsxs)("div",{className:(0,o.cx)(ht.content,Kt),children:[(0,t.jsx)(D.n,{label:(0,t.jsxs)("div",{className:ht.header,children:[Ct&&(0,t.jsx)(O.s,{children:Ct}),(0,t.jsx)("div",{children:Nt&&(0,t.jsx)(w.E,{text:"Saved",color:"green",icon:"check"})})]}),children:we}),(0,t.jsx)(Ie,{ref:Ft,activeStep:ge})]})]})]})},qe=F=>({container:(0,o.css)`
      display: flex;
      flex-direction: column;
      height: 100%;
      align-content: center;
    `,header:(0,o.css)`
      display: flex;
      justify-content: space-between;
    `,inner:(0,o.css)`
      display: flex;
      justify-content: flex-start;
      flex-direction: column;
      flex: 1 0 auto;
    `,content:(0,o.css)`
      padding-bottom: ${F.spacing(3)};
    `}),Fe=$e(Ze),Je=[{label:"Default",value:""},{label:"Unspecified",value:"urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified"},{label:"Email address",value:"urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress"},{label:"Persistent",value:"urn:oasis:names:tc:SAML:2.0:nameid-format:persistent"},{label:"Transient",value:"urn:oasis:names:tc:SAML:2.0:nameid-format:transient"}];function et(F){return{samlSettings:F.samlConfig.samlSettings,clientSecretConfigured:!0}}const tt={settingsUpdated:Ee.jA},rt=(0,s.connect)(et,tt),at=({clientSecretConfigured:F,samlSettings:Y,settingsUpdated:le})=>{const ie=(0,U.of)(nt),{assertionAttributeName:oe,assertionAttributeLogin:ge,assertionAttributeEmail:Te,assertionAttributeRole:we,assertionAttributeGroups:Ne,assertionAttributeOrg:Qe,clientId:dt,clientSecret:Me,tokenUrl:yt,forceUseGraphApi:bt,roleValuesNone:mt,roleValuesViewer:ot,roleValuesEditor:Nt,roleValuesAdmin:Ct,roleValuesGrafanaAdmin:Kt,orgMapping:Rt,allowedOrganizations:ft,nameIdFormat:wt,skipOrgRoleSync:xt}=Y,{handleSubmit:_t,control:Le,register:ht,getValues:Lt,setValue:Ft,formState:{isDirty:Wt}}=(0,S.mN)({defaultValues:{assertionAttributeName:oe,assertionAttributeLogin:ge,assertionAttributeEmail:Te,assertionAttributeRole:we,assertionAttributeGroups:Ne,assertionAttributeOrg:Qe,clientId:dt,clientSecret:Me,tokenUrl:yt,forceUseGraphApi:bt,roleValuesNone:mt,roleValuesViewer:ot,roleValuesEditor:Nt,roleValuesAdmin:Ct,roleValuesGrafanaAdmin:Kt,orgMapping:Rt,allowedOrganizations:ft,nameIdFormat:wt||"",skipOrgRoleSync:xt}}),jt=({...Ve})=>{Wt&&le({...Y,...Ve})},er=Ve=>Lt(Ve)!=="",nr=Ve=>{Ft(Ve,"",{shouldDirty:!0}),Xt(!1)},[tr,Xt]=(0,h.useState)(F&&er("clientSecret")),ir=()=>{Xt(F&&er("clientSecret"))},{orgRole:rr,isGrafanaAdmin:zt}=f.TP.user,Qt=zt,$t=rr==="Admin"||Qt,sr=rr==="Editor"||$t;return(0,t.jsxs)(Fe,{activeStep:a.SAMLStepKey.AssertionMapping,onSubmit:_t(jt),confirmRedirect:Wt,getFormData:Lt,className:ie.wrapper,label:"User mapping",children:[(0,t.jsx)("div",{className:ie.description,children:"Map SAML assertion attributes to the Grafana user attributes. Assertion attributes support template mappings. Team sync is available if groups attribute is configured."}),(0,t.jsxs)("div",{className:ie.mappingContainer,children:[(0,t.jsxs)("div",{className:ie.mappingSection,children:[(0,t.jsxs)("div",{className:ie.mappingHeader,children:["Assertion attributes mappings",(0,t.jsx)(x.m,{content:"Assertion attributes mapping in Grafana takes user information from a SAML response and uses it to create or update a user in its database. It reads attributes\u2014key/value pairs\u2014within the assertion, such as Name, Login handle, and email. Configurations allow for key selection modification.",placement:"top",children:(0,t.jsx)(y.I,{name:"info-circle",className:ie.icon})})]}),(0,t.jsx)(S.xI,{name:"assertionAttributeName",control:Le,render:({field:{ref:Ve,...ne}})=>(0,t.jsx)(B,{...ne,label:"Name attribute",id:"assertionAttributeName",placeholder:"displayName"})}),(0,t.jsx)(S.xI,{name:"assertionAttributeLogin",control:Le,render:({field:{ref:Ve,...ne}})=>(0,t.jsx)(B,{...ne,label:"Login attribute",placeholder:"mail",id:"assertionAttributeLogin"})}),(0,t.jsx)(S.xI,{name:"assertionAttributeEmail",control:Le,render:({field:{ref:Ve,...ne}})=>(0,t.jsx)(B,{...ne,label:"Email attribute",placeholder:"mail",id:"assertionAttributeEmail"})}),(0,t.jsx)(S.xI,{name:"assertionAttributeGroups",control:Le,render:({field:{ref:Ve,...ne}})=>(0,t.jsx)(B,{...ne,label:"Groups attribute",id:"assertionAttributeGroups"})}),(0,t.jsx)(S.xI,{name:"assertionAttributeRole",control:Le,render:({field:{ref:Ve,...ne}})=>(0,t.jsx)(B,{...ne,label:"Role attribute",id:"assertionAttributeRole"})}),$t&&(0,t.jsx)(S.xI,{name:"assertionAttributeOrg",control:Le,render:({field:{ref:Ve,...ne}})=>(0,t.jsx)(B,{...ne,label:"Org attribute",id:"assertionAttributeOrg"})})]}),(0,t.jsxs)("div",{className:ie.mappingSection,children:[sr&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:ie.mappingHeader,children:["Role mapping",(0,t.jsx)(x.m,{content:"Role mapping syncs user roles from your identity provider to Grafana by configuring role attributes for None, Viewer, Editor, Admin, and Grafana Admin roles. In case there is no match, the default role in Grafana is Viewer.",placement:"top",children:(0,t.jsx)(y.I,{name:"info-circle",className:ie.icon})})]}),(0,t.jsx)(S.xI,{name:"roleValuesNone",control:Le,render:({field:{ref:Ve,...ne}})=>(0,t.jsx)(B,{...ne,label:"None",width:60,id:"roleValuesNone"})}),(0,t.jsx)(S.xI,{name:"roleValuesViewer",control:Le,render:({field:{ref:Ve,...ne}})=>(0,t.jsx)(B,{...ne,label:"Viewer",width:60,id:"roleValuesViewer"})}),(0,t.jsx)(S.xI,{name:"roleValuesEditor",control:Le,render:({field:{ref:Ve,...ne}})=>(0,t.jsx)(B,{...ne,label:"Editor",width:60,id:"roleValuesEditor"})})]}),$t&&(0,t.jsx)(S.xI,{name:"roleValuesAdmin",control:Le,render:({field:{ref:Ve,...ne}})=>(0,t.jsx)(B,{...ne,label:"Admin",width:60,id:"roleValuesAdmin"})}),Qt&&(0,t.jsx)(S.xI,{name:"roleValuesGrafanaAdmin",control:Le,render:({field:{ref:Ve,...ne}})=>(0,t.jsx)(B,{...ne,label:"Grafana Admin",width:60,id:"roleValuesGrafanaAdmin"})}),(0,t.jsx)(m.D,{label:"Skip organization role sync",description:"Prevent synchronizing for SAML users organization roles from your IdP.",children:(0,t.jsx)(c.d,{...ht("skipOrgRoleSync"),defaultChecked:xt,id:"skipOrgRoleSync"})})]}),Qt&&(0,t.jsxs)("div",{className:ie.mappingSection,children:[(0,t.jsxs)("div",{className:ie.mappingHeader,children:["Org mapping",(0,t.jsx)(x.m,{content:"Organization mapping allows you to assign users to particular organization in Grafana depending on attribute value obtained from identity provider. Use the configuration to assign users from your organization to the Grafana organization.",placement:"top",children:(0,t.jsx)(y.I,{name:"info-circle",className:ie.icon})})]}),(0,t.jsx)(S.xI,{name:"orgMapping",control:Le,render:({field:{ref:Ve,...ne}})=>(0,t.jsx)(B,{...ne,label:"Org mapping",width:60,id:"orgMapping"})})]})]}),(0,t.jsx)("div",{className:ie.mappingContainer,children:(0,t.jsxs)("div",{className:ie.mappingSection,children:[(0,t.jsx)("div",{className:ie.mappingHeader,children:"Azure AD Service Account Configuration"}),(0,t.jsxs)("div",{className:ie.description,children:["If you have users that belong to more than 150 groups in your Azure AD organization, you need to setup a service account in Azure AD to get all the groups via Graph API. This service account will be used to get all the groups for the user. Read more about Azure AD service account configuration in the\xA0",(0,t.jsx)(v.Y,{style:{fontSize:"inherit"},external:!0,href:"https://grafana.com/docs/grafana/latest/setup-grafana/configure-security/configure-authentication/saml/#configure-a-graph-api-application-in-azure-ad",children:"documentation"}),"."]}),(0,t.jsx)(S.xI,{name:"clientId",control:Le,render:({field:{ref:Ve,...ne}})=>(0,t.jsx)(B,{...ne,label:"Client ID",width:60,id:"clientId"})}),(0,t.jsx)(S.xI,{name:"clientSecret",control:Le,render:({field:{ref:Ve,...ne}})=>(0,t.jsx)(g,{...ne,className:ie.clientSecretInput,width:60,id:"clientSecret",isConfigured:tr,onReset:()=>nr("clientSecret"),onBlur:ir,label:"Client Secret"})}),(0,t.jsx)(S.xI,{name:"tokenUrl",control:Le,render:({field:{ref:Ve,...ne}})=>(0,t.jsx)(B,{...ne,label:"Access Token URL",width:60,id:"tokenUrl"})}),(0,t.jsx)(m.D,{label:"Force use Graph API",description:"Force the use of Graph API to get all the groups for the user.",children:(0,t.jsx)(c.d,{...ht("forceUseGraphApi"),defaultChecked:bt,id:"forceUseGraphApi"})})]})}),(0,t.jsx)(m.D,{label:"Allowed organizations",description:"List of comma- or space-separated SAML organization names. User should be a member of at least one organization to log in.",children:(0,t.jsx)(R.p,{...ht("allowedOrganizations"),id:"allowedOrganizations",width:60})}),(0,t.jsx)(m.D,{label:"Name identifier format",description:"Name identifier formats control how the users at identity provider are mapped to users in Grafana",children:(0,t.jsx)(S.xI,{name:"nameIdFormat",control:Le,render:({field:{ref:Ve,onChange:ne,...Ae}})=>(0,t.jsx)(n.l6,{...Ae,onChange:vt=>{ne(vt.value)},width:30,options:Je,"aria-label":"nameIdFormat"})})})]})},nt=F=>({wrapper:(0,o.css)`
      width: 100%;
    `,description:(0,o.css)`
      color: ${F.colors.text.secondary};
      font-size: ${F.typography.bodySmall.fontSize};
      margin-bottom: ${F.spacing(2)};
      text-align: justify;
      width: ${F.spacing(76.5)};
    `,mappingContainer:(0,o.css)`
      background: ${F.colors.background.secondary};
      padding: ${F.spacing(2)};
      margin-bottom: ${F.spacing(4)};
    `,mappingSection:(0,o.css)`
      margin-bottom: ${F.spacing(2)};
    `,mappingHeader:(0,o.css)`
      display: flex;
      margin-bottom: ${F.spacing(2)};
    `,assertionEditorRow:(0,o.css)`
      display: flex;
      margin-bottom: ${F.spacing(1)};
    `,icon:(0,o.css)`
      fill: ${F.colors.secondary.text};
      margin-top: ${F.spacing(.5)};
      margin-left: ${F.spacing(.5)};
    `,clientSecretInput:(0,o.css)`
      background: ${F.components.input.background};
      color: ${F.components.input.text};
      margin-bottom: ${F.spacing(1)};
      width: 480px;
    `}),it=rt(at);var Ge=P(10534),He=P(94354),ke=P(21744),_e=P(73546),st=P(8484),Gt=P(54587);function fr(F){return{samlSettings:F.samlConfig.samlSettings,metadataValueType:F.samlConfig.metadataValueType}}const cr={settingsUpdated:Ee.jA,setMetadataValueType:Ee.Zt},dr=(0,s.connect)(fr,cr),Ht=[{label:"URL for metadata",value:"url"},{label:"Base64-encoded content",value:"base64"},{label:"Path to file",value:"path"}],hr=({samlSettings:F,metadataValueType:Y,settingsUpdated:le,setMetadataValueType:ie})=>{const oe=(0,U.of)(pr),{idpMetadataUrl:ge,idpMetadataPath:Te,idpMetadata:we,singleLogout:Ne}=F,{handleSubmit:Qe,control:dt,register:Me,watch:yt,getValues:bt,setValue:mt,formState:{errors:ot,isDirty:Nt}}=(0,S.mN)({mode:"onBlur",defaultValues:{idpMetadataUrl:ge,idpMetadataPath:Te,idpMetadata:we,metadataValueType:Y||"url"}}),[Ct,Kt]=(0,h.useState)([ge,Te,we].filter(Boolean).length!==0),Rt=yt("metadataValueType"),ft=()=>["idpMetadataUrl","idpMetadataPath","idpMetadata"].map(yt).filter(Boolean).length===1?!0:(0,st.t)("saml-connect-to-idp.validate-idp-metadata.require-one","One metadata type should be defined"),wt=({currentTarget:{value:Le}})=>{Kt(!!Le)},xt=({metadataValueType:Le,...ht})=>{Nt&&(le({...F,...ht}),ie(Le))},_t=async Le=>{if(Le?.currentTarget?.files?.length){const Lt=await Le.currentTarget.files[0].text(),Ft=btoa(Lt);mt("idpMetadata",Ft,{shouldDirty:!0})}};return(0,t.jsx)(Fe,{activeStep:a.SAMLStepKey.ConnectToIdP,onSubmit:Qe(xt),confirmRedirect:Nt,getFormData:bt,className:oe.wrapper,label:"Connect Grafana with Identity Provider",children:(0,t.jsxs)("div",{className:oe.externalBorder,children:[(0,t.jsxs)("div",{className:oe.doubleSideContainer,children:[(0,t.jsxs)("div",{className:oe.internalContainer,children:[(0,t.jsxs)("div",{className:oe.internalContainerHeader,children:[(0,t.jsx)("div",{className:oe.stepNumber,children:"1"}),(0,t.jsx)("h4",{children:"Configure IdP using Grafana metadata"})]}),(0,t.jsxs)("div",{className:oe.internalContainerBody,children:[(0,t.jsx)("div",{className:oe.description,children:"To configure your identity provider (IdP) you will need the Grafana metadata URL. All below endpoints must be reachable by your Identity Provider (IdP)."}),(0,t.jsx)(m.D,{label:"Metadata URL",description:"SP metadata URL / SP Entity ID",children:(0,t.jsxs)("div",{className:oe.inputWithCopyToClipboard,children:[(0,t.jsx)(R.p,{width:50,id:"spMetadata",value:Gt.EA,disabled:!0}),(0,t.jsx)(Ge.b,{className:oe.copyToClipboardButton,variant:"primary",size:"md",icon:"copy",getText:()=>Gt.EA,children:"Copy"})]})}),(0,t.jsx)(m.D,{label:"Assertion Consumer Service URL",description:"Assertion consumer service POST binding URL",children:(0,t.jsxs)("div",{className:oe.inputWithCopyToClipboard,children:[(0,t.jsx)(R.p,{width:50,id:"spACS",value:Gt.QH,disabled:!0}),(0,t.jsx)(Ge.b,{className:oe.copyToClipboardButton,variant:"primary",size:"md",icon:"copy",getText:()=>Gt.QH,children:"Copy"})]})}),Ne&&(0,t.jsx)(m.D,{label:"SLO URL",description:"Logout service redirect binding URL / Logout service POST binding URL",children:(0,t.jsxs)("div",{className:oe.inputWithCopyToClipboard,children:[(0,t.jsx)(R.p,{width:50,id:"spSLO",value:Gt.Hp,disabled:!0}),(0,t.jsx)(Ge.b,{className:oe.copyToClipboardButton,variant:"primary",size:"md",icon:"copy",getText:()=>Gt.Hp,children:"Copy"})]})})]})]}),(0,t.jsxs)("div",{className:oe.internalContainer,children:[(0,t.jsxs)("div",{className:oe.internalContainerHeader,children:[(0,t.jsx)("div",{className:oe.stepNumber,children:"2"}),(0,t.jsx)("h4",{children:"Finish configuring Grafana using IdP data"})]}),(0,t.jsxs)("div",{className:oe.internalContainerBody,children:[(0,t.jsx)("div",{className:oe.description,children:"Visit your IdP's configuration panel, add new app and use metadata from step one to connect with Grafana. You will need to copy your IdP's metadata and provide it below. Test connection and copy assertion labels/values."}),(0,t.jsx)(m.D,{label:"IdP's metadata ",description:"Must be the same as set-up or required by IdP.",children:(0,t.jsx)(S.xI,{name:"metadataValueType",control:dt,render:({field:{ref:Le,...ht}})=>(0,t.jsx)(He.z,{...ht,options:Ht,disabled:Ct})})}),Rt==="url"&&(0,t.jsx)(m.D,{label:"Metadata URL",description:"URL for IdP metadata",invalid:!!ot.idpMetadataUrl,error:ot.idpMetadataUrl?.message,children:(0,t.jsx)(R.p,{...Me("idpMetadataUrl",{onChange:wt,validate:ft}),id:"metadataUrl",width:60})}),Rt==="base64"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.D,{label:"Base64-encoded IdP metadata",invalid:!!ot.idpMetadata,error:ot.idpMetadata?.message,children:(0,t.jsx)(S.xI,{name:"idpMetadata",control:dt,rules:{validate:ft},render:({field:{onChange:Le,...ht}})=>(0,t.jsx)(ke.f,{...ht,id:"metadataBase64",width:60,onChange:Lt=>{Le(Lt),wt(Lt)}})})}),(0,t.jsx)(_e.e,{showFileName:!1,onFileUpload:_t,className:oe.uploadButton})]}),Rt==="path"&&(0,t.jsx)(m.D,{label:"Path to IdP metadata file",invalid:!!ot.idpMetadataPath,error:ot.idpMetadataPath?.message,children:(0,t.jsx)(R.p,{...Me("idpMetadataPath",{onChange:wt,validate:ft}),id:"metadataPath",width:60})}),(0,t.jsx)("div",{className:oe.description,children:"If you want to test the connection from your IdP's panel make sure to allow IdP initiated login and provide the relay state information."})]})]})]}),(0,t.jsxs)("div",{className:oe.internalContainerHeader,children:[(0,t.jsx)("div",{className:oe.stepNumber,children:"3"}),(0,t.jsx)("h4",{children:"Configure assertions, group, group and org mappings in the next step."})]})]})})},pr=F=>({wrapper:(0,o.css)`
      width: 100%;
    `,description:(0,o.css)`
      color: ${F.colors.text.secondary};
      margin-bottom: ${F.spacing(2)};
      font-size: ${F.typography.bodySmall.fontSize};
    `,externalBorder:(0,o.css)`
      border-radius: ${F.shape.borderRadius(1)};
      border: 1px solid ${F.colors.border.medium};
    `,doubleSideContainer:(0,o.css)`
      display: flex;
      flex-direction: row;
      justify-content: space-around;
    `,internalContainer:(0,o.css)`
      flex: 1 1 0;
      border-bottom: 1px solid ${F.colors.border.medium};
      &:first-child {
        border-right: 1px solid ${F.colors.border.medium};
      }
    `,internalContainerHeader:(0,o.css)`
      display: flex;
      justify-content: center;
      border-bottom: 1px solid ${F.colors.border.medium};
      padding: ${F.spacing(2)};
      text-align: center;
      h4 {
        margin-bottom: 0;
      }
    `,internalContainerBody:(0,o.css)`
      padding: ${F.spacing(2)};
    `,stepNumber:(0,o.css)`
      border: 1px solid ${F.colors.background.secondary};
      border-radius: ${F.shape.borderRadius(4)};
      background: ${F.colors.background.secondary};
      color: ${F.colors.text.secondary};
      width: ${F.spacing(3)};
      height: ${F.spacing(3)};
      margin-right: ${F.spacing(1)};
      font-weight: ${F.typography.fontWeightBold};
    `,copyToClipboardButton:(0,o.css)`
      border-top-left-radius: 0px;
      border-bottom-left-radius: 0px;
    `,inputWithCopyToClipboard:(0,o.css)`
      padding: 0;
      display: flex;
    `,uploadButton:(0,o.css)`
      margin-bottom: ${F.spacing(2)};
    `}),vr=dr(hr);var lr=P(67061);const gr=F=>{const{samlSettings:Y}=F.samlConfig;return{samlSettings:Y}},yr={settingsUpdated:Ee.jA},mr=(0,s.connect)(gr,yr)(({samlSettings:F,settingsUpdated:Y})=>{const{allowSignUp:le,name:ie,autoLogin:oe,singleLogout:ge,allowIdpInitiated:Te,relayState:we,maxIssueDelay:Ne,metadataValidDuration:Qe}=F||{},{handleSubmit:dt,register:Me,watch:yt,getValues:bt,formState:{isDirty:mt,errors:ot}}=(0,S.mN)({mode:"onBlur",defaultValues:{allowSignUp:le,name:ie,autoLogin:oe,singleLogout:ge,allowIdpInitiated:Te,relayState:we,maxIssueDelay:Ne,metadataValidDuration:Qe}}),Nt=yt("allowIdpInitiated"),Ct=ft=>{mt&&Y({...F,...ft})},Kt=ft=>!ft||Xe(ft)?!0:"Not a valid duration",Rt=ft=>Nt&&ft?ft.length>80?"Relay state needs to be 80 characters or less":!0:"Relay state is required";return(0,t.jsxs)(Fe,{activeStep:a.SAMLStepKey.General,onSubmit:dt(Ct),confirmRedirect:mt,getFormData:bt,label:"General settings",children:[(0,t.jsx)(lr.B,{children:(0,t.jsx)(m.D,{label:"Display name for this SAML 2.0 integration",description:"Helpful if you use more than one SSO IdP provider or protocol.",children:(0,t.jsx)(R.p,{...Me("name"),id:"displayName",placeholder:"SAML"})})}),(0,t.jsx)(m.D,{label:"Allow signup",description:"Whether to allow new Grafana user creation through SAML login. If not enabled, then only existing Grafana users can log in with SAML.",children:(0,t.jsx)(c.d,{...Me("allowSignUp"),defaultChecked:le,id:"allowSignup"})}),(0,t.jsx)(m.D,{label:"Auto login",description:"Attempt to log in with SAML automatically, skipping the login screen.",children:(0,t.jsx)(c.d,{...Me("autoLogin"),defaultChecked:oe,id:"autoLogin"})}),(0,t.jsx)(m.D,{label:"Single logout",description:"Allows users to log out from IdP session and applications associated with the current IdP session established via SAML.",children:(0,t.jsx)(c.d,{...Me("singleLogout"),defaultChecked:ge,id:"singleLogout"})}),(0,t.jsx)(m.D,{label:"Identity provider initiated login",description:"Allows users to log in into Grafana directly from identity provider.",children:(0,t.jsx)(c.d,{...Me("allowIdpInitiated"),defaultChecked:Te,id:"allowIdpInitiated"})}),Nt&&(0,t.jsx)(m.D,{label:"Relay state",description:"Required. Should match relay state configured in IdP and trailing space is required.",required:Nt,invalid:Nt&&!!ot.relayState,error:ot.relayState?.message,children:(0,t.jsx)(R.p,{...Me("relayState",{validate:Rt}),width:60,id:"relayState",defaultValue:we})}),(0,t.jsx)(m.D,{label:"Max issue delay",description:"Duration, since the IdP issued a response and Grafana is allowed to process it.",invalid:!!ot.maxIssueDelay,error:ot.maxIssueDelay?.message,children:(0,t.jsx)(R.p,{...Me("maxIssueDelay",{validate:Kt}),width:24,id:"max_issue_delay",defaultValue:Ne,placeholder:"90s"})}),(0,t.jsx)(m.D,{label:"Metadata valid duration",description:"Duration, for how long Grafana metadata is valid.",invalid:!!ot.metadataValidDuration,error:ot.metadataValidDuration?.message,children:(0,t.jsx)(R.p,{...Me("metadataValidDuration",{validate:Kt}),defaultValue:Qe,width:24,id:"metadataValidDuration",placeholder:"48h"})})]})});var At=P(26272),Cr=P(3591);const ur=({isConfigured:F,onReset:Y,onFileUpload:le,...ie})=>{const oe=(0,U.of)(xr);return(0,t.jsxs)("div",{className:oe.inputWithReset,children:[(0,t.jsxs)("div",{className:oe.textAreaInput,children:[F&&(0,t.jsx)(ke.f,{...ie,value:"configured",disabled:!0}),!F&&(0,t.jsx)(ke.f,{...ie})]}),F&&(0,t.jsx)(u.$n,{className:oe.fileUploadButton,variant:"primary",size:"md",onClick:Y,children:"Reset"}),!F&&(0,t.jsx)(_e.e,{className:oe.fileUploadButton,showFileName:!1,onFileUpload:le})]})},xr=F=>({resetButton:(0,o.css)`
      border-top-left-radius: 0px;
      border-bottom-left-radius: 0px;
    `,fileUploadButton:(0,o.css)`
      margin-left: ${F.spacing(1)};
    `,inputWithReset:(0,o.css)`
      padding: 0;
      display: flex;
    `,textAreaInput:(0,o.css)`
      width: ${F.spacing(60)};
    `});var Er=P(87978),I=P(66864);const _=(0,s.connect)(void 0,{})(({onClose:F,onGenerateCert:Y})=>{const{handleSubmit:le,register:ie,formState:{errors:oe}}=(0,S.mN)({mode:"onBlur",defaultValues:{validityDays:365,organization:"",country:"",state:"",city:""}}),ge=Ne=>!Ne||Ne.length>=2&&Ne.length<=3?!0:"Country code must have a length of 2 or 3 characters.",Te=Ne=>Ne===void 0||isNaN(Number(Ne))||Ne<1||Ne>1e4?"Validity days must be a positive integer between 1 and 10000.":!0,we=Ne=>{Y(Ne)};return(0,t.jsx)(Er._,{title:"SAML key and certificate",subtitle:"The following data will be included in the generated certificate",size:"md",onClose:F,children:(0,t.jsxs)("form",{onSubmit:Ne=>(Ne.stopPropagation(),le(we)(Ne)),children:[(0,t.jsx)(m.D,{label:"Your organization",htmlFor:"organization",children:(0,t.jsx)(R.p,{...ie("organization"),width:48,id:"organization"})}),(0,t.jsx)(m.D,{label:"Country code",invalid:!!oe.country,error:oe.country?.message,htmlFor:"country",children:(0,t.jsx)(R.p,{...ie("country",{validate:ge}),width:48,id:"country"})}),(0,t.jsx)(m.D,{label:"State",htmlFor:"state",children:(0,t.jsx)(R.p,{...ie("state"),width:48,id:"state"})}),(0,t.jsx)(m.D,{label:"City",htmlFor:"city",children:(0,t.jsx)(R.p,{...ie("city"),width:48,id:"city"})}),(0,t.jsx)(m.D,{label:"Validity days",description:"Number of days the generated certificate is valid for.",invalid:!!oe.validityDays,error:oe.validityDays?.message,htmlFor:"validityDays",children:(0,t.jsx)(R.p,{...ie("validityDays",{validate:Te}),width:48,id:"validityDays"})}),(0,t.jsxs)(I.Gy,{children:[(0,t.jsx)(u.$n,{type:"submit",size:"md",variant:"primary",tooltip:"Generate the certificate and private key",children:"Generate"}),(0,t.jsx)(u.$n,{type:"button",size:"md",variant:"secondary",onClick:F,children:"Close"})]})]})})});function q(F){const{samlSettings:Y,storedSamlSettings:le,signRequests:ie,keyCertValueType:oe,keyConfigured:ge,certConfigured:Te}=F.samlConfig;return{samlSettings:Y,storedSettings:le,signRequests:ie,keyCertValueType:oe,keyConfigured:ge,certConfigured:Te}}const ee={settingsUpdated:Ee.jA,setSignRequests:Ee.cD,setKeyCertValueType:Ee.$$,setKeyConfigured:Ee.w4,setCertConfigured:Ee.XN},fe=(0,s.connect)(q,ee),se=[{label:"Base64-encoded content",value:"base64"},{label:"Path to file",value:"path"}],De=[{label:"RSA-SHA256",value:"rsa-sha256"},{label:"RSA-SHA512",value:"rsa-sha512"},{label:"RSA-SHA1",value:"rsa-sha1"}],ze={signRequests:!1,privateKey:"",privateKeyPath:"",certificate:"",certificatePath:"",signatureAlgorithm:"",keyConfigured:!1,certConfigured:!1,keyCertValueType:"base64"},gt=fe(({samlSettings:F,storedSettings:Y,signRequests:le,keyCertValueType:ie,keyConfigured:oe,certConfigured:ge,setKeyCertValueType:Te,setSignRequests:we,setKeyConfigured:Ne,setCertConfigured:Qe,settingsUpdated:dt})=>{const{privateKey:Me,privateKeyPath:yt,certificate:bt,certificatePath:mt,signatureAlgorithm:ot}=F||{},{handleSubmit:Nt,control:Ct,register:Kt,watch:Rt,getValues:ft,setValue:wt,formState:{errors:xt,isDirty:_t}}=(0,S.mN)({mode:"onBlur",defaultValues:{privateKey:Me||"",privateKeyPath:yt||"",certificate:bt||"",certificatePath:mt||"",signatureAlgorithm:ot||"rsa-sha256",keyCertValueType:ie,signRequests:le||!!Me||!!yt||!!bt||!!mt||!!ot,keyConfigured:!1,certConfigured:!1}}),Le=(0,Cr.J7)(),[ht,Lt]=(0,h.useState)(!1),Ft=Rt("signRequests"),Wt=Rt("keyCertValueType"),jt=ft(),er=oe&&(0,ae.A8)("privateKey",jt,Y),nr=oe&&(0,ae.A8)("privateKeyPath",jt,Y),tr=ge&&(0,ae.A8)("certificate",jt,Y),Xt=ge&&(0,ae.A8)("certificatePath",jt,Y),ir=ne=>{if(_t){const{signRequests:Ae,keyCertValueType:vt,certConfigured:Zt,keyConfigured:Et,...or}=ne;Ae?(dt({...F,...or}),Te(vt)):(dt({...F,...or,...ze}),Te(ze.keyCertValueType)),we(Ae)}},rr=()=>{let{...ne}=ft();return Ft||(ne={...ne,...ze}),{...ne,keyConfigured:oe,certConfigured:ge}},zt=ne=>()=>{wt(ne,"",{shouldDirty:!0}),["privateKey","privateKeyPath"].includes(ne)?Ne(!1):Qe(!1)},Qt=ne=>async Ae=>{if(Ae?.currentTarget?.files?.length){const Zt=await Ae.currentTarget.files[0].text(),Et=btoa(Zt);wt(ne,Et,{shouldDirty:!0})}};function $t(ne){const Ae="0123456789abcdef",vt=new Uint32Array(ne);crypto.getRandomValues(vt);let Zt="";for(let Et=0;Et<ne;Et++)Zt+=Ae[Math.floor(vt[Et]/2**32*Ae.length)];return Zt}const sr=ne=>{Lt(!1);const Ae=ce().pki.rsa.generateKeyPair(2048),vt=ce().pki.privateKeyToAsn1(Ae.privateKey),Zt=ce().pki.wrapRsaPrivateKey(vt),Et=ce().pki.createCertificate();Et.publicKey=Ae.publicKey,Et.serialNumber="01"+$t(16),Et.validity.notBefore=new Date,Et.validity.notAfter=new Date(new Date().getTime()+1e3*60*60*24*ne.validityDays);const or=[{name:"organizationName",value:ne.organization},{name:"countryName",value:ne.country},{shortName:"ST",value:ne.state},{name:"localityName",value:ne.city}];Et.setSubject(or),Et.setIssuer(or),Et.sign(Ae.privateKey);const Dr=ce().pki.certificateToPem(Et),wr=ce().pki.privateKeyInfoToPem(Zt);wt("privateKey",btoa(wr),{shouldDirty:!0}),wt("certificate",btoa(Dr),{shouldDirty:!0}),Le.publish({type:At.r1.alertSuccess.name,payload:["The SAML certificate and key have been successfully generated."]})},Ve=(ne,Ae,vt)=>Ae?!0:ie==="base64"&&vt==="privateKey"&&ne&&!je(ne)?"Not valid PEM key":ie==="base64"&&vt==="certificate"&&ne&&!lt(ne)?"Not valid PEM certificate":!0;return(0,t.jsxs)(Fe,{activeStep:a.SAMLStepKey.KeyCert,onSubmit:Nt(ir),confirmRedirect:_t,getFormData:rr,label:"Sign requests",children:[(0,t.jsx)(m.D,{label:"Sign requests",description:"Sign outgoing requests to IdP",children:(0,t.jsx)(c.d,{...Kt("signRequests"),id:"signRequests"})}),Ft&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.D,{label:"Signing and encryption key and certificate",htmlFor:"certOptions",description:`Certificate and private key for exchanging information between the Grafana and the IdP.
              The private key needs to be issued in a PKCS#8 format. Certificate should be valid X.509 certificate.`,children:(0,t.jsx)(S.xI,{name:"keyCertValueType",control:Ct,render:({field:{ref:ne,...Ae}})=>(0,t.jsx)(He.z,{...Ae,options:se,id:"certOptions"})})}),Wt==="base64"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.D,{label:"Private key",htmlFor:"privateKey",description:"Base64-encoded private key",invalid:!!xt.privateKey,error:xt.privateKey?.message,children:(0,t.jsx)(S.xI,{name:"privateKey",control:Ct,rules:{validate:ne=>Ve(ne,oe,"privateKey")},render:({field:{ref:ne,...Ae}})=>(0,t.jsx)(ur,{...Ae,id:"privateKey",required:!0,isConfigured:er,onReset:zt("privateKey"),onFileUpload:Qt("privateKey")})})}),(0,t.jsx)(m.D,{label:"Certificate",htmlFor:"certificate",description:"Base64-encoded Grafana X.509 certificate",invalid:!!xt.certificate,error:xt.certificate?.message,children:(0,t.jsx)(S.xI,{name:"certificate",control:Ct,rules:{validate:ne=>Ve(ne,ge,"certificate")},render:({field:{ref:ne,...Ae}})=>(0,t.jsx)(ur,{...Ae,id:"certificate",required:!0,isConfigured:tr,onReset:zt("certificate"),onFileUpload:Qt("certificate")})})}),(0,t.jsx)(m.D,{children:(0,t.jsx)(u.$n,{variant:"secondary",onClick:()=>Lt(!0),children:"Generate key and certificate"})}),ht&&(0,t.jsx)(_,{onClose:()=>Lt(!1),onGenerateCert:sr})]}),Wt==="path"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.D,{label:"Private key",description:"Path to the Grafana private key",invalid:!!xt.privateKey,error:xt.privateKey?.message,children:(0,t.jsx)(S.xI,{name:"privateKeyPath",control:Ct,render:({field:{ref:ne,...Ae}})=>(0,t.jsx)(g,{...Ae,width:60,id:"privateKeyPath",isConfigured:nr,onReset:zt("privateKeyPath")})})}),(0,t.jsx)(m.D,{label:"Certificate",description:"Path to the Grafana X.509 certificate",invalid:!!xt.certificate,error:xt.certificate?.message,children:(0,t.jsx)(S.xI,{name:"certificatePath",control:Ct,render:({field:{ref:ne,...Ae}})=>(0,t.jsx)(g,{...Ae,width:60,id:"certificatePath",isConfigured:Xt,onReset:zt("certificatePath")})})})]}),(0,t.jsx)(m.D,{label:"Signature algorithm",htmlFor:"signatureAlgorithm",description:"Signature algorithm used for signing requests to the IdP. Must be the same as set-up or required by IdP.",children:(0,t.jsx)(S.xI,{name:"signatureAlgorithm",control:Ct,render:({field:{ref:ne,...Ae}})=>(0,t.jsx)(He.z,{...Ae,options:De,id:"signatureAlgorithm"})})})]})]})});var kt=P(94753);function Jt(F){const{samlSettings:Y,storedSamlSettings:le,keyCertValueType:ie,metadataValueType:oe,signRequests:ge,keyConfigured:Te,certConfigured:we}=F.samlConfig;return{samlSettings:Y,storedSamlSettings:le,keyCertValueType:ie,metadataValueType:oe,signRequests:ge,keyConfigured:Te,certConfigured:we}}const Bt={settingsUpdated:Ee.jA,saveSAMLSettings:Tt},Ot=(0,s.connect)(Jt,Bt)(({samlSettings:F,storedSamlSettings:Y,keyCertValueType:le,metadataValueType:ie,signRequests:oe,keyConfigured:ge,certConfigured:Te,settingsUpdated:we,saveSAMLSettings:Ne})=>{const{handleSubmit:Qe,getValues:dt,formState:{isDirty:Me}}=(0,S.mN)(),yt=({enabled:mt})=>{Me&&we({...F,enabled:mt})},bt=async()=>{let mt={...F,keyCertValueType:le,keyConfigured:ge,certConfigured:Te,signRequests:oe,metadataValueType:ie,enabled:!0};Ne(mt,Y),(0,r.rR)("authentication_saml_saved"),(0,Ee.OG)()};return(0,t.jsx)(Fe,{activeStep:a.SAMLStepKey.SaveAndTest,onSubmit:Qe(yt),confirmRedirect:Me,getFormData:dt,label:"Test and enable",children:(0,t.jsxs)(lr.B,{direction:"column",alignItems:"flex-start",gap:2,children:[(0,t.jsx)(kt.E,{children:"If you are ready to apply your SAML configuration use the \u201CSave and enable\u201D button. You will be able to disable the configuration."}),(0,t.jsx)(u.$n,{variant:"primary",onClick:bt,children:"Save and enable"})]})})}),Ye=[{id:a.SAMLStepKey.General,name:"General settings",component:mr},{id:a.SAMLStepKey.KeyCert,name:"Sign requests",component:gt},{id:a.SAMLStepKey.ConnectToIdP,name:"Connect Grafana with Identity Provider",component:vr},{id:a.SAMLStepKey.AssertionMapping,name:"User mapping",component:it},{id:a.SAMLStepKey.SaveAndTest,name:"Test and enable",component:Ot}];function Br(F){const{isLoading:Y,samlSettings:le}=F.samlConfig;return{isLoading:Y,samlSettings:le}}const br={loadSAMLSettings:ct},Nr=(0,s.connect)(Br,br),Rr={text:"Setup SAML single sign on",subTitle:`This guided application will guide you through the configuration
  process of SAML. You will need to follow steps and visit your Identity
  Provider's application to connect it with Grafana (The Service provider).
  This guided application will help you keep track of your progress.`,icon:"shield",id:"SAML"},Ar=({loadSAMLSettings:F,isLoading:Y,samlSettings:le})=>{const{step:ie}=(0,E.g)();(0,h.useEffect)(()=>{F()},[F]);const ge=(0,h.useCallback)(()=>{const Te=Ye.find(({id:we})=>we===ie)?.component;return Te?(0,t.jsx)(Te,{}):null},[ie])();return ge?(0,t.jsx)(T.YW,{navId:"authentication",pageNav:Rr,children:(0,t.jsx)(T.YW.Contents,{children:Y||(0,e.isEmpty)(le)?(0,t.jsx)(p.a,{}):ge})}):(0,t.jsx)(d.H,{})},Ir=Nr(Ar),Lr=Ir},31906:(re,me,P)=>{"use strict";P.d(me,{a:()=>s});var t=P(74848),e=P(90613),h=P(39558);const s=({text:E="Loading..."})=>(0,t.jsx)(e.a,{display:"flex",alignItems:"center",direction:"column",justifyContent:"center",paddingTop:10,children:(0,t.jsx)(h._,{text:E})})},39504:(re,me,P)=>{var t=P(50276);P(93900),P(56370),P(7619),re.exports=t.aes=t.aes||{},t.aes.startEncrypting=function(y,m,c,v){var R=x({key:y,output:c,decrypt:!1,mode:v});return R.start(m),R},t.aes.createEncryptionCipher=function(y,m){return x({key:y,output:null,decrypt:!1,mode:m})},t.aes.startDecrypting=function(y,m,c,v){var R=x({key:y,output:c,decrypt:!0,mode:v});return R.start(m),R},t.aes.createDecryptionCipher=function(y,m){return x({key:y,output:null,decrypt:!0,mode:m})},t.aes.Algorithm=function(y,m){h||o();var c=this;c.name=y,c.mode=new m({blockSize:16,cipher:{encrypt:function(v,R){return U(c._w,v,R,!1)},decrypt:function(v,R){return U(c._w,v,R,!0)}}}),c._init=!1},t.aes.Algorithm.prototype.initialize=function(y){if(!this._init){var m=y.key,c;if(typeof m=="string"&&(m.length===16||m.length===24||m.length===32))m=t.util.createBuffer(m);else if(t.util.isArray(m)&&(m.length===16||m.length===24||m.length===32)){c=m,m=t.util.createBuffer();for(var v=0;v<c.length;++v)m.putByte(c[v])}if(!t.util.isArray(m)){c=m,m=[];var R=c.length();if(R===16||R===24||R===32){R=R>>>2;for(var v=0;v<R;++v)m.push(c.getInt32())}}if(!t.util.isArray(m)||!(m.length===4||m.length===6||m.length===8))throw new Error("Invalid key parameter.");var n=this.mode.name,f=["CFB","OFB","CTR","GCM"].indexOf(n)!==-1;this._w=S(m,y.decrypt&&!f),this._init=!0}},t.aes._expandKey=function(y,m){return h||o(),S(y,m)},t.aes._updateBlock=U,e("AES-ECB",t.cipher.modes.ecb),e("AES-CBC",t.cipher.modes.cbc),e("AES-CFB",t.cipher.modes.cfb),e("AES-OFB",t.cipher.modes.ofb),e("AES-CTR",t.cipher.modes.ctr),e("AES-GCM",t.cipher.modes.gcm);function e(y,m){var c=function(){return new t.aes.Algorithm(y,m)};t.cipher.registerAlgorithm(y,c)}var h=!1,s=4,E,T,d,p,a;function o(){h=!0,d=[0,1,2,4,8,16,32,64,128,27,54];for(var y=new Array(256),m=0;m<128;++m)y[m]=m<<1,y[m+128]=m+128<<1^283;E=new Array(256),T=new Array(256),p=new Array(4),a=new Array(4);for(var m=0;m<4;++m)p[m]=new Array(256),a[m]=new Array(256);for(var c=0,v=0,R,n,f,C,B,V,u,m=0;m<256;++m){C=v^v<<1^v<<2^v<<3^v<<4,C=C>>8^C&255^99,E[c]=C,T[C]=c,B=y[C],R=y[c],n=y[R],f=y[n],V=B<<24^C<<16^C<<8^(C^B),u=(R^n^f)<<24^(c^f)<<16^(c^n^f)<<8^(c^R^f);for(var g=0;g<4;++g)p[g][c]=V,a[g][C]=u,V=V<<24|V>>>8,u=u<<24|u>>>8;c===0?c=v=1:(c=R^y[y[y[R^f]]],v^=y[y[v]])}}function S(y,m){for(var c=y.slice(0),v,R=1,n=c.length,f=n+6+1,C=s*f,B=n;B<C;++B)v=c[B-1],B%n===0?(v=E[v>>>16&255]<<24^E[v>>>8&255]<<16^E[v&255]<<8^E[v>>>24]^d[R]<<24,R++):n>6&&B%n===4&&(v=E[v>>>24]<<24^E[v>>>16&255]<<16^E[v>>>8&255]<<8^E[v&255]),c[B]=c[B-n]^v;if(m){var V,u=a[0],g=a[1],b=a[2],r=a[3],D=c.slice(0);C=c.length;for(var B=0,O=C-s;B<C;B+=s,O-=s)if(B===0||B===C-s)D[B]=c[O],D[B+1]=c[O+3],D[B+2]=c[O+2],D[B+3]=c[O+1];else for(var w=0;w<s;++w)V=c[O+w],D[B+(3&-w)]=u[E[V>>>24]]^g[E[V>>>16&255]]^b[E[V>>>8&255]]^r[E[V&255]];c=D}return c}function U(y,m,c,v){var R=y.length/4-1,n,f,C,B,V;v?(n=a[0],f=a[1],C=a[2],B=a[3],V=T):(n=p[0],f=p[1],C=p[2],B=p[3],V=E);var u,g,b,r,D,O,w;u=m[0]^y[0],g=m[v?3:1]^y[1],b=m[2]^y[2],r=m[v?1:3]^y[3];for(var H=3,j=1;j<R;++j)D=n[u>>>24]^f[g>>>16&255]^C[b>>>8&255]^B[r&255]^y[++H],O=n[g>>>24]^f[b>>>16&255]^C[r>>>8&255]^B[u&255]^y[++H],w=n[b>>>24]^f[r>>>16&255]^C[u>>>8&255]^B[g&255]^y[++H],r=n[r>>>24]^f[u>>>16&255]^C[g>>>8&255]^B[b&255]^y[++H],u=D,g=O,b=w;c[0]=V[u>>>24]<<24^V[g>>>16&255]<<16^V[b>>>8&255]<<8^V[r&255]^y[++H],c[v?3:1]=V[g>>>24]<<24^V[b>>>16&255]<<16^V[r>>>8&255]<<8^V[u&255]^y[++H],c[2]=V[b>>>24]<<24^V[r>>>16&255]<<16^V[u>>>8&255]<<8^V[g&255]^y[++H],c[v?1:3]=V[r>>>24]<<24^V[u>>>16&255]<<16^V[g>>>8&255]<<8^V[b&255]^y[++H]}function x(y){y=y||{};var m=(y.mode||"CBC").toUpperCase(),c="AES-"+m,v;y.decrypt?v=t.cipher.createDecipher(c,y.key):v=t.cipher.createCipher(c,y.key);var R=v.start;return v.start=function(n,f){var C=null;f instanceof t.util.ByteBuffer&&(C=f,f={}),f=f||{},f.output=C,f.iv=n,R.call(v,f)},v}},38678:(re,me,P)=>{var t=P(50276);P(39504),P(43986);var e=re.exports=t.tls;e.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(a){a.bulk_cipher_algorithm=e.BulkCipherAlgorithm.aes,a.cipher_type=e.CipherType.block,a.enc_key_length=16,a.block_length=16,a.fixed_iv_length=16,a.record_iv_length=16,a.mac_algorithm=e.MACAlgorithm.hmac_sha1,a.mac_length=20,a.mac_key_length=20},initConnectionState:h},e.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(a){a.bulk_cipher_algorithm=e.BulkCipherAlgorithm.aes,a.cipher_type=e.CipherType.block,a.enc_key_length=32,a.block_length=16,a.fixed_iv_length=16,a.record_iv_length=16,a.mac_algorithm=e.MACAlgorithm.hmac_sha1,a.mac_length=20,a.mac_key_length=20},initConnectionState:h};function h(a,o,S){var U=o.entity===t.tls.ConnectionEnd.client;a.read.cipherState={init:!1,cipher:t.cipher.createDecipher("AES-CBC",U?S.keys.server_write_key:S.keys.client_write_key),iv:U?S.keys.server_write_IV:S.keys.client_write_IV},a.write.cipherState={init:!1,cipher:t.cipher.createCipher("AES-CBC",U?S.keys.client_write_key:S.keys.server_write_key),iv:U?S.keys.client_write_IV:S.keys.server_write_IV},a.read.cipherFunction=d,a.write.cipherFunction=s,a.read.macLength=a.write.macLength=S.mac_length,a.read.macFunction=a.write.macFunction=e.hmac_sha1}function s(a,o){var S=!1,U=o.macFunction(o.macKey,o.sequenceNumber,a);a.fragment.putBytes(U),o.updateSequenceNumber();var x;a.version.minor===e.Versions.TLS_1_0.minor?x=o.cipherState.init?null:o.cipherState.iv:x=t.random.getBytesSync(16),o.cipherState.init=!0;var y=o.cipherState.cipher;return y.start({iv:x}),a.version.minor>=e.Versions.TLS_1_1.minor&&y.output.putBytes(x),y.update(a.fragment),y.finish(E)&&(a.fragment=y.output,a.length=a.fragment.length(),S=!0),S}function E(a,o,S){if(!S){var U=a-o.length()%a;o.fillWithByte(U-1,U)}return!0}function T(a,o,S){var U=!0;if(S){for(var x=o.length(),y=o.last(),m=x-1-y;m<x-1;++m)U=U&&o.at(m)==y;U&&o.truncate(y+1)}return U}function d(a,o){var S=!1,U;a.version.minor===e.Versions.TLS_1_0.minor?U=o.cipherState.init?null:o.cipherState.iv:U=a.fragment.getBytes(16),o.cipherState.init=!0;var x=o.cipherState.cipher;x.start({iv:U}),x.update(a.fragment),S=x.finish(T);var y=o.macLength,m=t.random.getBytesSync(y),c=x.output.length();c>=y?(a.fragment=x.output.getBytes(c-y),m=x.output.getBytes(y)):a.fragment=x.output.getBytes(),a.fragment=t.util.createBuffer(a.fragment),a.length=a.fragment.length();var v=o.macFunction(o.macKey,o.sequenceNumber,a);return o.updateSequenceNumber(),S=p(o.macKey,m,v)&&S,S}function p(a,o,S){var U=t.hmac.create();return U.start("SHA1",a),U.update(o),o=U.digest().getBytes(),U.start(null,null),U.update(S),S=U.digest().getBytes(),o===S}},24309:(re,me,P)=>{var t=P(50276);P(12746);var e=t.asn1;me.privateKeyValidator={name:"PrivateKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},me.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}},12746:(re,me,P)=>{var t=P(50276);P(7619),P(94037);var e=re.exports=t.asn1=t.asn1||{};e.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},e.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},e.create=function(d,p,a,o,S){if(t.util.isArray(o)){for(var U=[],x=0;x<o.length;++x)o[x]!==void 0&&U.push(o[x]);o=U}var y={tagClass:d,type:p,constructed:a,composed:a||t.util.isArray(o),value:o};return S&&"bitStringContents"in S&&(y.bitStringContents=S.bitStringContents,y.original=e.copy(y)),y},e.copy=function(d,p){var a;if(t.util.isArray(d)){a=[];for(var o=0;o<d.length;++o)a.push(e.copy(d[o],p));return a}return typeof d=="string"?d:(a={tagClass:d.tagClass,type:d.type,constructed:d.constructed,composed:d.composed,value:e.copy(d.value,p)},p&&!p.excludeBitStringContents&&(a.bitStringContents=d.bitStringContents),a)},e.equals=function(d,p,a){if(t.util.isArray(d)){if(!t.util.isArray(p)||d.length!==p.length)return!1;for(var o=0;o<d.length;++o)if(!e.equals(d[o],p[o]))return!1;return!0}if(typeof d!=typeof p)return!1;if(typeof d=="string")return d===p;var S=d.tagClass===p.tagClass&&d.type===p.type&&d.constructed===p.constructed&&d.composed===p.composed&&e.equals(d.value,p.value);return a&&a.includeBitStringContents&&(S=S&&d.bitStringContents===p.bitStringContents),S},e.getBerValueLength=function(d){var p=d.getByte();if(p!==128){var a,o=p&128;return o?a=d.getInt((p&127)<<3):a=p,a}};function h(d,p,a){if(a>p){var o=new Error("Too few bytes to parse DER.");throw o.available=d.length(),o.remaining=p,o.requested=a,o}}var s=function(d,p){var a=d.getByte();if(p--,a!==128){var o,S=a&128;if(!S)o=a;else{var U=a&127;h(d,p,U),o=d.getInt(U<<3)}if(o<0)throw new Error("Negative length: "+o);return o}};e.fromDer=function(d,p){p===void 0&&(p={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof p=="boolean"&&(p={strict:p,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in p||(p.strict=!0),"parseAllBytes"in p||(p.parseAllBytes=!0),"decodeBitStrings"in p||(p.decodeBitStrings=!0),typeof d=="string"&&(d=t.util.createBuffer(d));var a=d.length(),o=E(d,d.length(),0,p);if(p.parseAllBytes&&d.length()!==0){var S=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw S.byteCount=a,S.remaining=d.length(),S}return o};function E(d,p,a,o){var S;h(d,p,2);var U=d.getByte();p--;var x=U&192,y=U&31;S=d.length();var m=s(d,p);if(p-=S-d.length(),m!==void 0&&m>p){if(o.strict){var c=new Error("Too few bytes to read ASN.1 value.");throw c.available=d.length(),c.remaining=p,c.requested=m,c}m=p}var v,R,n=(U&32)===32;if(n)if(v=[],m===void 0)for(;;){if(h(d,p,2),d.bytes(2)==="\0\0"){d.getBytes(2),p-=2;break}S=d.length(),v.push(E(d,p,a+1,o)),p-=S-d.length()}else for(;m>0;)S=d.length(),v.push(E(d,m,a+1,o)),p-=S-d.length(),m-=S-d.length();if(v===void 0&&x===e.Class.UNIVERSAL&&y===e.Type.BITSTRING&&(R=d.bytes(m)),v===void 0&&o.decodeBitStrings&&x===e.Class.UNIVERSAL&&y===e.Type.BITSTRING&&m>1){var f=d.read,C=p,B=0;if(y===e.Type.BITSTRING&&(h(d,p,1),B=d.getByte(),p--),B===0)try{S=d.length();var V={strict:!0,decodeBitStrings:!0},u=E(d,p,a+1,V),g=S-d.length();p-=g,y==e.Type.BITSTRING&&g++;var b=u.tagClass;g===m&&(b===e.Class.UNIVERSAL||b===e.Class.CONTEXT_SPECIFIC)&&(v=[u])}catch{}v===void 0&&(d.read=f,p=C)}if(v===void 0){if(m===void 0){if(o.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");m=p}if(y===e.Type.BMPSTRING)for(v="";m>0;m-=2)h(d,p,2),v+=String.fromCharCode(d.getInt16()),p-=2;else v=d.getBytes(m),p-=m}var r=R===void 0?null:{bitStringContents:R};return e.create(x,y,n,v,r)}e.toDer=function(d){var p=t.util.createBuffer(),a=d.tagClass|d.type,o=t.util.createBuffer(),S=!1;if("bitStringContents"in d&&(S=!0,d.original&&(S=e.equals(d,d.original))),S)o.putBytes(d.bitStringContents);else if(d.composed){d.constructed?a|=32:o.putByte(0);for(var U=0;U<d.value.length;++U)d.value[U]!==void 0&&o.putBuffer(e.toDer(d.value[U]))}else if(d.type===e.Type.BMPSTRING)for(var U=0;U<d.value.length;++U)o.putInt16(d.value.charCodeAt(U));else d.type===e.Type.INTEGER&&d.value.length>1&&(d.value.charCodeAt(0)===0&&!(d.value.charCodeAt(1)&128)||d.value.charCodeAt(0)===255&&(d.value.charCodeAt(1)&128)===128)?o.putBytes(d.value.substr(1)):o.putBytes(d.value);if(p.putByte(a),o.length()<=127)p.putByte(o.length()&127);else{var x=o.length(),y="";do y+=String.fromCharCode(x&255),x=x>>>8;while(x>0);p.putByte(y.length|128);for(var U=y.length-1;U>=0;--U)p.putByte(y.charCodeAt(U))}return p.putBuffer(o),p},e.oidToDer=function(d){var p=d.split("."),a=t.util.createBuffer();a.putByte(40*parseInt(p[0],10)+parseInt(p[1],10));for(var o,S,U,x,y=2;y<p.length;++y){o=!0,S=[],U=parseInt(p[y],10);do x=U&127,U=U>>>7,o||(x|=128),S.push(x),o=!1;while(U>0);for(var m=S.length-1;m>=0;--m)a.putByte(S[m])}return a},e.derToOid=function(d){var p;typeof d=="string"&&(d=t.util.createBuffer(d));var a=d.getByte();p=Math.floor(a/40)+"."+a%40;for(var o=0;d.length()>0;)a=d.getByte(),o=o<<7,a&128?o+=a&127:(p+="."+(o+a),o=0);return p},e.utcTimeToDate=function(d){var p=new Date,a=parseInt(d.substr(0,2),10);a=a>=50?1900+a:2e3+a;var o=parseInt(d.substr(2,2),10)-1,S=parseInt(d.substr(4,2),10),U=parseInt(d.substr(6,2),10),x=parseInt(d.substr(8,2),10),y=0;if(d.length>11){var m=d.charAt(10),c=10;m!=="+"&&m!=="-"&&(y=parseInt(d.substr(10,2),10),c+=2)}if(p.setUTCFullYear(a,o,S),p.setUTCHours(U,x,y,0),c&&(m=d.charAt(c),m==="+"||m==="-")){var v=parseInt(d.substr(c+1,2),10),R=parseInt(d.substr(c+4,2),10),n=v*60+R;n*=6e4,m==="+"?p.setTime(+p-n):p.setTime(+p+n)}return p},e.generalizedTimeToDate=function(d){var p=new Date,a=parseInt(d.substr(0,4),10),o=parseInt(d.substr(4,2),10)-1,S=parseInt(d.substr(6,2),10),U=parseInt(d.substr(8,2),10),x=parseInt(d.substr(10,2),10),y=parseInt(d.substr(12,2),10),m=0,c=0,v=!1;d.charAt(d.length-1)==="Z"&&(v=!0);var R=d.length-5,n=d.charAt(R);if(n==="+"||n==="-"){var f=parseInt(d.substr(R+1,2),10),C=parseInt(d.substr(R+4,2),10);c=f*60+C,c*=6e4,n==="+"&&(c*=-1),v=!0}return d.charAt(14)==="."&&(m=parseFloat(d.substr(14),10)*1e3),v?(p.setUTCFullYear(a,o,S),p.setUTCHours(U,x,y,m),p.setTime(+p+c)):(p.setFullYear(a,o,S),p.setHours(U,x,y,m)),p},e.dateToUtcTime=function(d){if(typeof d=="string")return d;var p="",a=[];a.push((""+d.getUTCFullYear()).substr(2)),a.push(""+(d.getUTCMonth()+1)),a.push(""+d.getUTCDate()),a.push(""+d.getUTCHours()),a.push(""+d.getUTCMinutes()),a.push(""+d.getUTCSeconds());for(var o=0;o<a.length;++o)a[o].length<2&&(p+="0"),p+=a[o];return p+="Z",p},e.dateToGeneralizedTime=function(d){if(typeof d=="string")return d;var p="",a=[];a.push(""+d.getUTCFullYear()),a.push(""+(d.getUTCMonth()+1)),a.push(""+d.getUTCDate()),a.push(""+d.getUTCHours()),a.push(""+d.getUTCMinutes()),a.push(""+d.getUTCSeconds());for(var o=0;o<a.length;++o)a[o].length<2&&(p+="0"),p+=a[o];return p+="Z",p},e.integerToDer=function(d){var p=t.util.createBuffer();if(d>=-128&&d<128)return p.putSignedInt(d,8);if(d>=-32768&&d<32768)return p.putSignedInt(d,16);if(d>=-8388608&&d<8388608)return p.putSignedInt(d,24);if(d>=-2147483648&&d<2147483648)return p.putSignedInt(d,32);var a=new Error("Integer too large; max is 32-bits.");throw a.integer=d,a},e.derToInteger=function(d){typeof d=="string"&&(d=t.util.createBuffer(d));var p=d.length()*8;if(p>32)throw new Error("Integer too large; max is 32-bits.");return d.getSignedInt(p)},e.validate=function(d,p,a,o){var S=!1;if((d.tagClass===p.tagClass||typeof p.tagClass>"u")&&(d.type===p.type||typeof p.type>"u"))if(d.constructed===p.constructed||typeof p.constructed>"u"){if(S=!0,p.value&&t.util.isArray(p.value))for(var U=0,x=0;S&&x<p.value.length;++x)S=p.value[x].optional||!1,d.value[U]&&(S=e.validate(d.value[U],p.value[x],a,o),S?++U:p.value[x].optional&&(S=!0)),!S&&o&&o.push("["+p.name+'] Tag class "'+p.tagClass+'", type "'+p.type+'" expected value length "'+p.value.length+'", got "'+d.value.length+'"');if(S&&a&&(p.capture&&(a[p.capture]=d.value),p.captureAsn1&&(a[p.captureAsn1]=d),p.captureBitStringContents&&"bitStringContents"in d&&(a[p.captureBitStringContents]=d.bitStringContents),p.captureBitStringValue&&"bitStringContents"in d)){var y;if(d.bitStringContents.length<2)a[p.captureBitStringValue]="";else{var m=d.bitStringContents.charCodeAt(0);if(m!==0)throw new Error("captureBitStringValue only supported for zero unused bits");a[p.captureBitStringValue]=d.bitStringContents.slice(1)}}}else o&&o.push("["+p.name+'] Expected constructed "'+p.constructed+'", got "'+d.constructed+'"');else o&&(d.tagClass!==p.tagClass&&o.push("["+p.name+'] Expected tag class "'+p.tagClass+'", got "'+d.tagClass+'"'),d.type!==p.type&&o.push("["+p.name+'] Expected type "'+p.type+'", got "'+d.type+'"'));return S};var T=/[^\\u0000-\\u00ff]/;e.prettyPrint=function(d,p,a){var o="";p=p||0,a=a||2,p>0&&(o+=`
`);for(var S="",U=0;U<p*a;++U)S+=" ";switch(o+=S+"Tag: ",d.tagClass){case e.Class.UNIVERSAL:o+="Universal:";break;case e.Class.APPLICATION:o+="Application:";break;case e.Class.CONTEXT_SPECIFIC:o+="Context-Specific:";break;case e.Class.PRIVATE:o+="Private:";break}if(d.tagClass===e.Class.UNIVERSAL)switch(o+=d.type,d.type){case e.Type.NONE:o+=" (None)";break;case e.Type.BOOLEAN:o+=" (Boolean)";break;case e.Type.INTEGER:o+=" (Integer)";break;case e.Type.BITSTRING:o+=" (Bit string)";break;case e.Type.OCTETSTRING:o+=" (Octet string)";break;case e.Type.NULL:o+=" (Null)";break;case e.Type.OID:o+=" (Object Identifier)";break;case e.Type.ODESC:o+=" (Object Descriptor)";break;case e.Type.EXTERNAL:o+=" (External or Instance of)";break;case e.Type.REAL:o+=" (Real)";break;case e.Type.ENUMERATED:o+=" (Enumerated)";break;case e.Type.EMBEDDED:o+=" (Embedded PDV)";break;case e.Type.UTF8:o+=" (UTF8)";break;case e.Type.ROID:o+=" (Relative Object Identifier)";break;case e.Type.SEQUENCE:o+=" (Sequence)";break;case e.Type.SET:o+=" (Set)";break;case e.Type.PRINTABLESTRING:o+=" (Printable String)";break;case e.Type.IA5String:o+=" (IA5String (ASCII))";break;case e.Type.UTCTIME:o+=" (UTC time)";break;case e.Type.GENERALIZEDTIME:o+=" (Generalized time)";break;case e.Type.BMPSTRING:o+=" (BMP String)";break}else o+=d.type;if(o+=`
`,o+=S+"Constructed: "+d.constructed+`
`,d.composed){for(var x=0,y="",U=0;U<d.value.length;++U)d.value[U]!==void 0&&(x+=1,y+=e.prettyPrint(d.value[U],p+1,a),U+1<d.value.length&&(y+=","));o+=S+"Sub values: "+x+y}else{if(o+=S+"Value: ",d.type===e.Type.OID){var m=e.derToOid(d.value);o+=m,t.pki&&t.pki.oids&&m in t.pki.oids&&(o+=" ("+t.pki.oids[m]+") ")}if(d.type===e.Type.INTEGER)try{o+=e.derToInteger(d.value)}catch{o+="0x"+t.util.bytesToHex(d.value)}else if(d.type===e.Type.BITSTRING){if(d.value.length>1?o+="0x"+t.util.bytesToHex(d.value.slice(1)):o+="(none)",d.value.length>0){var c=d.value.charCodeAt(0);c==1?o+=" (1 unused bit shown)":c>1&&(o+=" ("+c+" unused bits shown)")}}else if(d.type===e.Type.OCTETSTRING)T.test(d.value)||(o+="("+d.value+") "),o+="0x"+t.util.bytesToHex(d.value);else if(d.type===e.Type.UTF8)try{o+=t.util.decodeUtf8(d.value)}catch(v){if(v.message==="URI malformed")o+="0x"+t.util.bytesToHex(d.value)+" (malformed UTF8)";else throw v}else d.type===e.Type.PRINTABLESTRING||d.type===e.Type.IA5String?o+=d.value:T.test(d.value)?o+="0x"+t.util.bytesToHex(d.value):d.value.length===0?o+="[null]":o+=d.value}return o}},44058:(re,me,P)=>{var t=P(42363).Buffer,e={};re.exports=e;var h={};e.encode=function(E,T,d){if(typeof T!="string")throw new TypeError('"alphabet" must be a string.');if(d!==void 0&&typeof d!="number")throw new TypeError('"maxline" must be a number.');var p="";if(!(E instanceof Uint8Array))p=s(E,T);else{var a=0,o=T.length,S=T.charAt(0),U=[0];for(a=0;a<E.length;++a){for(var x=0,y=E[a];x<U.length;++x)y+=U[x]<<8,U[x]=y%o,y=y/o|0;for(;y>0;)U.push(y%o),y=y/o|0}for(a=0;E[a]===0&&a<E.length-1;++a)p+=S;for(a=U.length-1;a>=0;--a)p+=T[U[a]]}if(d){var m=new RegExp(".{1,"+d+"}","g");p=p.match(m).join(`\r
`)}return p},e.decode=function(E,T){if(typeof E!="string")throw new TypeError('"input" must be a string.');if(typeof T!="string")throw new TypeError('"alphabet" must be a string.');var d=h[T];if(!d){d=h[T]=[];for(var p=0;p<T.length;++p)d[T.charCodeAt(p)]=p}E=E.replace(/\s/g,"");for(var a=T.length,o=T.charAt(0),S=[0],p=0;p<E.length;p++){var U=d[E.charCodeAt(p)];if(U===void 0)return;for(var x=0,y=U;x<S.length;++x)y+=S[x]*a,S[x]=y&255,y>>=8;for(;y>0;)S.push(y&255),y>>=8}for(var m=0;E[m]===o&&m<E.length-1;++m)S.push(0);return typeof t<"u"?t.from(S.reverse()):new Uint8Array(S.reverse())};function s(E,T){var d=0,p=T.length,a=T.charAt(0),o=[0];for(d=0;d<E.length();++d){for(var S=0,U=E.at(d);S<o.length;++S)U+=o[S]<<8,o[S]=U%p,U=U/p|0;for(;U>0;)o.push(U%p),U=U/p|0}var x="";for(d=0;E.at(d)===0&&d<E.length()-1;++d)x+=a;for(d=o.length-1;d>=0;--d)x+=T[o[d]];return x}},93900:(re,me,P)=>{var t=P(50276);P(7619),re.exports=t.cipher=t.cipher||{},t.cipher.algorithms=t.cipher.algorithms||{},t.cipher.createCipher=function(h,s){var E=h;if(typeof E=="string"&&(E=t.cipher.getAlgorithm(E),E&&(E=E())),!E)throw new Error("Unsupported algorithm: "+h);return new t.cipher.BlockCipher({algorithm:E,key:s,decrypt:!1})},t.cipher.createDecipher=function(h,s){var E=h;if(typeof E=="string"&&(E=t.cipher.getAlgorithm(E),E&&(E=E())),!E)throw new Error("Unsupported algorithm: "+h);return new t.cipher.BlockCipher({algorithm:E,key:s,decrypt:!0})},t.cipher.registerAlgorithm=function(h,s){h=h.toUpperCase(),t.cipher.algorithms[h]=s},t.cipher.getAlgorithm=function(h){return h=h.toUpperCase(),h in t.cipher.algorithms?t.cipher.algorithms[h]:null};var e=t.cipher.BlockCipher=function(h){this.algorithm=h.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=h.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=h.decrypt,this.algorithm.initialize(h)};e.prototype.start=function(h){h=h||{};var s={};for(var E in h)s[E]=h[E];s.decrypt=this._decrypt,this._finish=!1,this._input=t.util.createBuffer(),this.output=h.output||t.util.createBuffer(),this.mode.start(s)},e.prototype.update=function(h){for(h&&this._input.putBuffer(h);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},e.prototype.finish=function(h){h&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(E){return h(this.blockSize,E,!1)},this.mode.unpad=function(E){return h(this.blockSize,E,!0)});var s={};return s.decrypt=this._decrypt,s.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,s)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,s))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,s))}},56370:(re,me,P)=>{var t=P(50276);P(7619),t.cipher=t.cipher||{};var e=re.exports=t.cipher.modes=t.cipher.modes||{};e.ecb=function(T){T=T||{},this.name="ECB",this.cipher=T.cipher,this.blockSize=T.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.ecb.prototype.start=function(T){},e.ecb.prototype.encrypt=function(T,d,p){if(T.length()<this.blockSize&&!(p&&T.length()>0))return!0;for(var a=0;a<this._ints;++a)this._inBlock[a]=T.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var a=0;a<this._ints;++a)d.putInt32(this._outBlock[a])},e.ecb.prototype.decrypt=function(T,d,p){if(T.length()<this.blockSize&&!(p&&T.length()>0))return!0;for(var a=0;a<this._ints;++a)this._inBlock[a]=T.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var a=0;a<this._ints;++a)d.putInt32(this._outBlock[a])},e.ecb.prototype.pad=function(T,d){var p=T.length()===this.blockSize?this.blockSize:this.blockSize-T.length();return T.fillWithByte(p,p),!0},e.ecb.prototype.unpad=function(T,d){if(d.overflow>0)return!1;var p=T.length(),a=T.at(p-1);return a>this.blockSize<<2?!1:(T.truncate(a),!0)},e.cbc=function(T){T=T||{},this.name="CBC",this.cipher=T.cipher,this.blockSize=T.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.cbc.prototype.start=function(T){if(T.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in T)this._iv=h(T.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")},e.cbc.prototype.encrypt=function(T,d,p){if(T.length()<this.blockSize&&!(p&&T.length()>0))return!0;for(var a=0;a<this._ints;++a)this._inBlock[a]=this._prev[a]^T.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var a=0;a<this._ints;++a)d.putInt32(this._outBlock[a]);this._prev=this._outBlock},e.cbc.prototype.decrypt=function(T,d,p){if(T.length()<this.blockSize&&!(p&&T.length()>0))return!0;for(var a=0;a<this._ints;++a)this._inBlock[a]=T.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var a=0;a<this._ints;++a)d.putInt32(this._prev[a]^this._outBlock[a]);this._prev=this._inBlock.slice(0)},e.cbc.prototype.pad=function(T,d){var p=T.length()===this.blockSize?this.blockSize:this.blockSize-T.length();return T.fillWithByte(p,p),!0},e.cbc.prototype.unpad=function(T,d){if(d.overflow>0)return!1;var p=T.length(),a=T.at(p-1);return a>this.blockSize<<2?!1:(T.truncate(a),!0)},e.cfb=function(T){T=T||{},this.name="CFB",this.cipher=T.cipher,this.blockSize=T.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},e.cfb.prototype.start=function(T){if(!("iv"in T))throw new Error("Invalid IV parameter.");this._iv=h(T.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.cfb.prototype.encrypt=function(T,d,p){var a=T.length();if(a===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&a>=this.blockSize){for(var o=0;o<this._ints;++o)this._inBlock[o]=T.getInt32()^this._outBlock[o],d.putInt32(this._inBlock[o]);return}var S=(this.blockSize-a)%this.blockSize;S>0&&(S=this.blockSize-S),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialBlock[o]=T.getInt32()^this._outBlock[o],this._partialOutput.putInt32(this._partialBlock[o]);if(S>0)T.read-=this.blockSize;else for(var o=0;o<this._ints;++o)this._inBlock[o]=this._partialBlock[o];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),S>0&&!p)return d.putBytes(this._partialOutput.getBytes(S-this._partialBytes)),this._partialBytes=S,!0;d.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=0},e.cfb.prototype.decrypt=function(T,d,p){var a=T.length();if(a===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&a>=this.blockSize){for(var o=0;o<this._ints;++o)this._inBlock[o]=T.getInt32(),d.putInt32(this._inBlock[o]^this._outBlock[o]);return}var S=(this.blockSize-a)%this.blockSize;S>0&&(S=this.blockSize-S),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialBlock[o]=T.getInt32(),this._partialOutput.putInt32(this._partialBlock[o]^this._outBlock[o]);if(S>0)T.read-=this.blockSize;else for(var o=0;o<this._ints;++o)this._inBlock[o]=this._partialBlock[o];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),S>0&&!p)return d.putBytes(this._partialOutput.getBytes(S-this._partialBytes)),this._partialBytes=S,!0;d.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=0},e.ofb=function(T){T=T||{},this.name="OFB",this.cipher=T.cipher,this.blockSize=T.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},e.ofb.prototype.start=function(T){if(!("iv"in T))throw new Error("Invalid IV parameter.");this._iv=h(T.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ofb.prototype.encrypt=function(T,d,p){var a=T.length();if(T.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&a>=this.blockSize){for(var o=0;o<this._ints;++o)d.putInt32(T.getInt32()^this._outBlock[o]),this._inBlock[o]=this._outBlock[o];return}var S=(this.blockSize-a)%this.blockSize;S>0&&(S=this.blockSize-S),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialOutput.putInt32(T.getInt32()^this._outBlock[o]);if(S>0)T.read-=this.blockSize;else for(var o=0;o<this._ints;++o)this._inBlock[o]=this._outBlock[o];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),S>0&&!p)return d.putBytes(this._partialOutput.getBytes(S-this._partialBytes)),this._partialBytes=S,!0;d.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=0},e.ofb.prototype.decrypt=e.ofb.prototype.encrypt,e.ctr=function(T){T=T||{},this.name="CTR",this.cipher=T.cipher,this.blockSize=T.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},e.ctr.prototype.start=function(T){if(!("iv"in T))throw new Error("Invalid IV parameter.");this._iv=h(T.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ctr.prototype.encrypt=function(T,d,p){var a=T.length();if(a===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&a>=this.blockSize)for(var o=0;o<this._ints;++o)d.putInt32(T.getInt32()^this._outBlock[o]);else{var S=(this.blockSize-a)%this.blockSize;S>0&&(S=this.blockSize-S),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialOutput.putInt32(T.getInt32()^this._outBlock[o]);if(S>0&&(T.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),S>0&&!p)return d.putBytes(this._partialOutput.getBytes(S-this._partialBytes)),this._partialBytes=S,!0;d.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=0}s(this._inBlock)},e.ctr.prototype.decrypt=e.ctr.prototype.encrypt,e.gcm=function(T){T=T||{},this.name="GCM",this.cipher=T.cipher,this.blockSize=T.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0,this._R=3774873600},e.gcm.prototype.start=function(T){if(!("iv"in T))throw new Error("Invalid IV parameter.");var d=t.util.createBuffer(T.iv);this._cipherLength=0;var p;if("additionalData"in T?p=t.util.createBuffer(T.additionalData):p=t.util.createBuffer(),"tagLength"in T?this._tagLength=T.tagLength:this._tagLength=128,this._tag=null,T.decrypt&&(this._tag=t.util.createBuffer(T.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var a=d.length();if(a===12)this._j0=[d.getInt32(),d.getInt32(),d.getInt32(),1];else{for(this._j0=[0,0,0,0];d.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[d.getInt32(),d.getInt32(),d.getInt32(),d.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(E(a*8)))}this._inBlock=this._j0.slice(0),s(this._inBlock),this._partialBytes=0,p=t.util.createBuffer(p),this._aDataLength=E(p.length()*8);var o=p.length()%this.blockSize;for(o&&p.fillWithByte(0,this.blockSize-o),this._s=[0,0,0,0];p.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[p.getInt32(),p.getInt32(),p.getInt32(),p.getInt32()])},e.gcm.prototype.encrypt=function(T,d,p){var a=T.length();if(a===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&a>=this.blockSize){for(var o=0;o<this._ints;++o)d.putInt32(this._outBlock[o]^=T.getInt32());this._cipherLength+=this.blockSize}else{var S=(this.blockSize-a)%this.blockSize;S>0&&(S=this.blockSize-S),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialOutput.putInt32(T.getInt32()^this._outBlock[o]);if(S<=0||p){if(p){var U=a%this.blockSize;this._cipherLength+=U,this._partialOutput.truncate(this.blockSize-U)}else this._cipherLength+=this.blockSize;for(var o=0;o<this._ints;++o)this._outBlock[o]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),S>0&&!p)return T.read-=this.blockSize,d.putBytes(this._partialOutput.getBytes(S-this._partialBytes)),this._partialBytes=S,!0;d.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),s(this._inBlock)},e.gcm.prototype.decrypt=function(T,d,p){var a=T.length();if(a<this.blockSize&&!(p&&a>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),s(this._inBlock),this._hashBlock[0]=T.getInt32(),this._hashBlock[1]=T.getInt32(),this._hashBlock[2]=T.getInt32(),this._hashBlock[3]=T.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var o=0;o<this._ints;++o)d.putInt32(this._outBlock[o]^this._hashBlock[o]);a<this.blockSize?this._cipherLength+=a%this.blockSize:this._cipherLength+=this.blockSize},e.gcm.prototype.afterFinish=function(T,d){var p=!0;d.decrypt&&d.overflow&&T.truncate(this.blockSize-d.overflow),this.tag=t.util.createBuffer();var a=this._aDataLength.concat(E(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,a);var o=[];this.cipher.encrypt(this._j0,o);for(var S=0;S<this._ints;++S)this.tag.putInt32(this._s[S]^o[S]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),d.decrypt&&this.tag.bytes()!==this._tag&&(p=!1),p},e.gcm.prototype.multiply=function(T,d){for(var p=[0,0,0,0],a=d.slice(0),o=0;o<128;++o){var S=T[o/32|0]&1<<31-o%32;S&&(p[0]^=a[0],p[1]^=a[1],p[2]^=a[2],p[3]^=a[3]),this.pow(a,a)}return p},e.gcm.prototype.pow=function(T,d){for(var p=T[3]&1,a=3;a>0;--a)d[a]=T[a]>>>1|(T[a-1]&1)<<31;d[0]=T[0]>>>1,p&&(d[0]^=this._R)},e.gcm.prototype.tableMultiply=function(T){for(var d=[0,0,0,0],p=0;p<32;++p){var a=p/8|0,o=T[a]>>>(7-p%8)*4&15,S=this._m[p][o];d[0]^=S[0],d[1]^=S[1],d[2]^=S[2],d[3]^=S[3]}return d},e.gcm.prototype.ghash=function(T,d,p){return d[0]^=p[0],d[1]^=p[1],d[2]^=p[2],d[3]^=p[3],this.tableMultiply(d)},e.gcm.prototype.generateHashTable=function(T,d){for(var p=8/d,a=4*p,o=16*p,S=new Array(o),U=0;U<o;++U){var x=[0,0,0,0],y=U/a|0,m=(a-1-U%a)*d;x[y]=1<<d-1<<m,S[U]=this.generateSubHashTable(this.multiply(x,T),d)}return S},e.gcm.prototype.generateSubHashTable=function(T,d){var p=1<<d,a=p>>>1,o=new Array(p);o[a]=T.slice(0);for(var S=a>>>1;S>0;)this.pow(o[2*S],o[S]=[]),S>>=1;for(S=2;S<a;){for(var U=1;U<S;++U){var x=o[S],y=o[U];o[S+U]=[x[0]^y[0],x[1]^y[1],x[2]^y[2],x[3]^y[3]]}S*=2}for(o[0]=[0,0,0,0],S=a+1;S<p;++S){var m=o[S^a];o[S]=[T[0]^m[0],T[1]^m[1],T[2]^m[2],T[3]^m[3]]}return o};function h(T,d){if(typeof T=="string"&&(T=t.util.createBuffer(T)),t.util.isArray(T)&&T.length>4){var p=T;T=t.util.createBuffer();for(var a=0;a<p.length;++a)T.putByte(p[a])}if(T.length()<d)throw new Error("Invalid IV length; got "+T.length()+" bytes and expected "+d+" bytes.");if(!t.util.isArray(T)){for(var o=[],S=d/4,a=0;a<S;++a)o.push(T.getInt32());T=o}return T}function s(T){T[T.length-1]=T[T.length-1]+1&4294967295}function E(T){return[T/4294967296|0,T&4294967295]}},19095:(re,me,P)=>{var t=P(50276);P(93900),P(56370),P(7619),re.exports=t.des=t.des||{},t.des.startEncrypting=function(y,m,c,v){var R=x({key:y,output:c,decrypt:!1,mode:v||(m===null?"ECB":"CBC")});return R.start(m),R},t.des.createEncryptionCipher=function(y,m){return x({key:y,output:null,decrypt:!1,mode:m})},t.des.startDecrypting=function(y,m,c,v){var R=x({key:y,output:c,decrypt:!0,mode:v||(m===null?"ECB":"CBC")});return R.start(m),R},t.des.createDecryptionCipher=function(y,m){return x({key:y,output:null,decrypt:!0,mode:m})},t.des.Algorithm=function(y,m){var c=this;c.name=y,c.mode=new m({blockSize:8,cipher:{encrypt:function(v,R){return U(c._keys,v,R,!1)},decrypt:function(v,R){return U(c._keys,v,R,!0)}}}),c._init=!1},t.des.Algorithm.prototype.initialize=function(y){if(!this._init){var m=t.util.createBuffer(y.key);if(this.name.indexOf("3DES")===0&&m.length()!==24)throw new Error("Invalid Triple-DES key size: "+m.length()*8);this._keys=S(m),this._init=!0}},e("DES-ECB",t.cipher.modes.ecb),e("DES-CBC",t.cipher.modes.cbc),e("DES-CFB",t.cipher.modes.cfb),e("DES-OFB",t.cipher.modes.ofb),e("DES-CTR",t.cipher.modes.ctr),e("3DES-ECB",t.cipher.modes.ecb),e("3DES-CBC",t.cipher.modes.cbc),e("3DES-CFB",t.cipher.modes.cfb),e("3DES-OFB",t.cipher.modes.ofb),e("3DES-CTR",t.cipher.modes.ctr);function e(y,m){var c=function(){return new t.des.Algorithm(y,m)};t.cipher.registerAlgorithm(y,c)}var h=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],s=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],E=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],T=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],d=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],p=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],a=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],o=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function S(y){for(var m=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],c=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],v=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],R=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],n=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],f=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],C=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],B=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],V=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],g=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],b=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],r=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],D=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],O=y.length()>8?3:1,w=[],H=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],j=0,z,W=0;W<O;W++){var X=y.getInt32(),J=y.getInt32();z=(X>>>4^J)&252645135,J^=z,X^=z<<4,z=(J>>>-16^X)&65535,X^=z,J^=z<<-16,z=(X>>>2^J)&858993459,J^=z,X^=z<<2,z=(J>>>-16^X)&65535,X^=z,J^=z<<-16,z=(X>>>1^J)&1431655765,J^=z,X^=z<<1,z=(J>>>8^X)&16711935,X^=z,J^=z<<8,z=(X>>>1^J)&1431655765,J^=z,X^=z<<1,z=X<<8|J>>>20&240,X=J<<24|J<<8&16711680|J>>>8&65280|J>>>24&240,J=z;for(var te=0;te<H.length;++te){H[te]?(X=X<<2|X>>>26,J=J<<2|J>>>26):(X=X<<1|X>>>27,J=J<<1|J>>>27),X&=-15,J&=-15;var he=m[X>>>28]|c[X>>>24&15]|v[X>>>20&15]|R[X>>>16&15]|n[X>>>12&15]|f[X>>>8&15]|C[X>>>4&15],xe=B[J>>>28]|V[J>>>24&15]|u[J>>>20&15]|g[J>>>16&15]|b[J>>>12&15]|r[J>>>8&15]|D[J>>>4&15];z=(xe>>>16^he)&65535,w[j++]=he^z,w[j++]=xe^z<<16}}return w}function U(y,m,c,v){var R=y.length===32?3:9,n;R===3?n=v?[30,-2,-2]:[0,32,2]:n=v?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var f,C=m[0],B=m[1];f=(C>>>4^B)&252645135,B^=f,C^=f<<4,f=(C>>>16^B)&65535,B^=f,C^=f<<16,f=(B>>>2^C)&858993459,C^=f,B^=f<<2,f=(B>>>8^C)&16711935,C^=f,B^=f<<8,f=(C>>>1^B)&1431655765,B^=f,C^=f<<1,C=C<<1|C>>>31,B=B<<1|B>>>31;for(var V=0;V<R;V+=3){for(var u=n[V+1],g=n[V+2],b=n[V];b!=u;b+=g){var r=B^y[b],D=(B>>>4|B<<28)^y[b+1];f=C,C=B,B=f^(s[r>>>24&63]|T[r>>>16&63]|p[r>>>8&63]|o[r&63]|h[D>>>24&63]|E[D>>>16&63]|d[D>>>8&63]|a[D&63])}f=C,C=B,B=f}C=C>>>1|C<<31,B=B>>>1|B<<31,f=(C>>>1^B)&1431655765,B^=f,C^=f<<1,f=(B>>>8^C)&16711935,C^=f,B^=f<<8,f=(B>>>2^C)&858993459,C^=f,B^=f<<2,f=(C>>>16^B)&65535,B^=f,C^=f<<16,f=(C>>>4^B)&252645135,B^=f,C^=f<<4,c[0]=C,c[1]=B}function x(y){y=y||{};var m=(y.mode||"CBC").toUpperCase(),c="DES-"+m,v;y.decrypt?v=t.cipher.createDecipher(c,y.key):v=t.cipher.createCipher(c,y.key);var R=v.start;return v.start=function(n,f){var C=null;f instanceof t.util.ByteBuffer&&(C=f,f={}),f=f||{},f.output=C,f.iv=n,R.call(v,f)},v}},62926:(re,me,P)=>{var t=P(42363).Buffer,e=P(50276);P(43736),P(89356),P(72313),P(7619);var h=P(24309),s=h.publicKeyValidator,E=h.privateKeyValidator;if(typeof T>"u")var T=e.jsbn.BigInteger;var d=e.util.ByteBuffer,p=typeof t>"u"?Uint8Array:t;e.pki=e.pki||{},re.exports=e.pki.ed25519=e.ed25519=e.ed25519||{};var a=e.ed25519;a.constants={},a.constants.PUBLIC_KEY_BYTE_LENGTH=32,a.constants.PRIVATE_KEY_BYTE_LENGTH=64,a.constants.SEED_BYTE_LENGTH=32,a.constants.SIGN_BYTE_LENGTH=64,a.constants.HASH_BYTE_LENGTH=64,a.generateKeyPair=function(Q){Q=Q||{};var l=Q.seed;if(l===void 0)l=e.random.getBytesSync(a.constants.SEED_BYTE_LENGTH);else if(typeof l=="string"){if(l.length!==a.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+a.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(l instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');l=o({message:l,encoding:"binary"});for(var L=new p(a.constants.PUBLIC_KEY_BYTE_LENGTH),i=new p(a.constants.PRIVATE_KEY_BYTE_LENGTH),A=0;A<32;++A)i[A]=l[A];return f(L,i),{publicKey:L,privateKey:i}},a.privateKeyFromAsn1=function(Q){var l={},L=[],i=e.asn1.validate(Q,E,l,L);if(!i){var A=new Error("Invalid Key.");throw A.errors=L,A}var K=e.asn1.derToOid(l.privateKeyOid),G=e.oids.EdDSA25519;if(K!==G)throw new Error('Invalid OID "'+K+'"; OID must be "'+G+'".');var M=l.privateKey,Z=o({message:e.asn1.fromDer(M).value,encoding:"binary"});return{privateKeyBytes:Z}},a.publicKeyFromAsn1=function(Q){var l={},L=[],i=e.asn1.validate(Q,s,l,L);if(!i){var A=new Error("Invalid Key.");throw A.errors=L,A}var K=e.asn1.derToOid(l.publicKeyOid),G=e.oids.EdDSA25519;if(K!==G)throw new Error('Invalid OID "'+K+'"; OID must be "'+G+'".');var M=l.ed25519PublicKey;if(M.length!==a.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return o({message:M,encoding:"binary"})},a.publicKeyFromPrivateKey=function(Q){Q=Q||{};var l=o({message:Q.privateKey,encoding:"binary"});if(l.length!==a.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+a.constants.PRIVATE_KEY_BYTE_LENGTH);for(var L=new p(a.constants.PUBLIC_KEY_BYTE_LENGTH),i=0;i<L.length;++i)L[i]=l[32+i];return L},a.sign=function(Q){Q=Q||{};var l=o(Q),L=o({message:Q.privateKey,encoding:"binary"});if(L.length===a.constants.SEED_BYTE_LENGTH){var i=a.generateKeyPair({seed:L});L=i.privateKey}else if(L.length!==a.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+a.constants.SEED_BYTE_LENGTH+" or "+a.constants.PRIVATE_KEY_BYTE_LENGTH);var A=new p(a.constants.SIGN_BYTE_LENGTH+l.length);C(A,l,l.length,L);for(var K=new p(a.constants.SIGN_BYTE_LENGTH),G=0;G<K.length;++G)K[G]=A[G];return K},a.verify=function(Q){Q=Q||{};var l=o(Q);if(Q.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var L=o({message:Q.signature,encoding:"binary"});if(L.length!==a.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+a.constants.SIGN_BYTE_LENGTH);var i=o({message:Q.publicKey,encoding:"binary"});if(i.length!==a.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+a.constants.PUBLIC_KEY_BYTE_LENGTH);var A=new p(a.constants.SIGN_BYTE_LENGTH+l.length),K=new p(a.constants.SIGN_BYTE_LENGTH+l.length),G;for(G=0;G<a.constants.SIGN_BYTE_LENGTH;++G)A[G]=L[G];for(G=0;G<l.length;++G)A[G+a.constants.SIGN_BYTE_LENGTH]=l[G];return B(K,A,A.length,i)>=0};function o(Q){var l=Q.message;if(l instanceof Uint8Array||l instanceof p)return l;var L=Q.encoding;if(l===void 0)if(Q.md)l=Q.md.digest().getBytes(),L="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof l=="string"&&!L)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof l=="string"){if(typeof t<"u")return t.from(l,L);l=new d(l,L)}else if(!(l instanceof d))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var i=new p(l.length()),A=0;A<i.length;++A)i[A]=l.at(A);return i}var S=ae(),U=ae([1]),x=ae([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),y=ae([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),m=ae([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),c=ae([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),v=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),R=ae([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function n(Q,l){var L=e.md.sha512.create(),i=new d(Q);L.update(i.getBytes(l),"binary");var A=L.digest().getBytes();if(typeof t<"u")return t.from(A,"binary");for(var K=new p(a.constants.HASH_BYTE_LENGTH),G=0;G<64;++G)K[G]=A.charCodeAt(G);return K}function f(Q,l){var L=[ae(),ae(),ae(),ae()],i,A=n(l,32);for(A[0]&=248,A[31]&=127,A[31]|=64,te(L,A),r(Q,L),i=0;i<32;++i)l[i+32]=Q[i];return 0}function C(Q,l,L,i){var A,K,G=new Float64Array(64),M=[ae(),ae(),ae(),ae()],Z=n(i,32);Z[0]&=248,Z[31]&=127,Z[31]|=64;var pe=L+64;for(A=0;A<L;++A)Q[64+A]=l[A];for(A=0;A<32;++A)Q[32+A]=Z[32+A];var ce=n(Q.subarray(32),L+32);for(u(ce),te(M,ce),r(Q,M),A=32;A<64;++A)Q[A]=i[A];var $=n(Q,L+64);for(u($),A=32;A<64;++A)G[A]=0;for(A=0;A<32;++A)G[A]=ce[A];for(A=0;A<32;++A)for(K=0;K<32;K++)G[A+K]+=$[A]*Z[K];return V(Q.subarray(32),G),pe}function B(Q,l,L,i){var A,K,G=new p(32),M=[ae(),ae(),ae(),ae()],Z=[ae(),ae(),ae(),ae()];if(K=-1,L<64||O(Z,i))return-1;for(A=0;A<L;++A)Q[A]=l[A];for(A=0;A<32;++A)Q[A+32]=i[A];var pe=n(Q,L);if(u(pe),J(M,Z,pe),te(Z,l.subarray(32)),g(M,Z),r(G,M),L-=64,z(l,0,G,0)){for(A=0;A<L;++A)Q[A]=0;return-1}for(A=0;A<L;++A)Q[A]=l[A+64];return K=L,K}function V(Q,l){var L,i,A,K;for(i=63;i>=32;--i){for(L=0,A=i-32,K=i-12;A<K;++A)l[A]+=L-16*l[i]*v[A-(i-32)],L=l[A]+128>>8,l[A]-=L*256;l[A]+=L,l[i]=0}for(L=0,A=0;A<32;++A)l[A]+=L-(l[31]>>4)*v[A],L=l[A]>>8,l[A]&=255;for(A=0;A<32;++A)l[A]-=L*v[A];for(i=0;i<32;++i)l[i+1]+=l[i]>>8,Q[i]=l[i]&255}function u(Q){for(var l=new Float64Array(64),L=0;L<64;++L)l[L]=Q[L],Q[L]=0;V(Q,l)}function g(Q,l){var L=ae(),i=ae(),A=ae(),K=ae(),G=ae(),M=ae(),Z=ae(),pe=ae(),ce=ae();be(L,Q[1],Q[0]),be(ce,l[1],l[0]),Ie(L,L,ce),ue(i,Q[0],Q[1]),ue(ce,l[0],l[1]),Ie(i,i,ce),Ie(A,Q[3],l[3]),Ie(A,A,y),Ie(K,Q[2],l[2]),ue(K,K,K),be(G,i,L),be(M,K,A),ue(Z,K,A),ue(pe,i,L),Ie(Q[0],G,M),Ie(Q[1],pe,Z),Ie(Q[2],Z,M),Ie(Q[3],G,pe)}function b(Q,l,L){for(var i=0;i<4;++i)ve(Q[i],l[i],L)}function r(Q,l){var L=ae(),i=ae(),A=ae();xe(A,l[2]),Ie(L,l[0],A),Ie(i,l[1],A),D(Q,i),Q[31]^=X(L)<<7}function D(Q,l){var L,i,A,K=ae(),G=ae();for(L=0;L<16;++L)G[L]=l[L];for(Se(G),Se(G),Se(G),i=0;i<2;++i){for(K[0]=G[0]-65517,L=1;L<15;++L)K[L]=G[L]-65535-(K[L-1]>>16&1),K[L-1]&=65535;K[15]=G[15]-32767-(K[14]>>16&1),A=K[15]>>16&1,K[14]&=65535,ve(G,K,1-A)}for(L=0;L<16;L++)Q[2*L]=G[L]&255,Q[2*L+1]=G[L]>>8}function O(Q,l){var L=ae(),i=ae(),A=ae(),K=ae(),G=ae(),M=ae(),Z=ae();return he(Q[2],U),w(Q[1],l),We(A,Q[1]),Ie(K,A,x),be(A,A,Q[2]),ue(K,Q[2],K),We(G,K),We(M,G),Ie(Z,M,G),Ie(L,Z,A),Ie(L,L,K),H(L,L),Ie(L,L,A),Ie(L,L,K),Ie(L,L,K),Ie(Q[0],L,K),We(i,Q[0]),Ie(i,i,K),j(i,A)&&Ie(Q[0],Q[0],R),We(i,Q[0]),Ie(i,i,K),j(i,A)?-1:(X(Q[0])===l[31]>>7&&be(Q[0],S,Q[0]),Ie(Q[3],Q[0],Q[1]),0)}function w(Q,l){var L;for(L=0;L<16;++L)Q[L]=l[2*L]+(l[2*L+1]<<8);Q[15]&=32767}function H(Q,l){var L=ae(),i;for(i=0;i<16;++i)L[i]=l[i];for(i=250;i>=0;--i)We(L,L),i!==1&&Ie(L,L,l);for(i=0;i<16;++i)Q[i]=L[i]}function j(Q,l){var L=new p(32),i=new p(32);return D(L,Q),D(i,l),z(L,0,i,0)}function z(Q,l,L,i){return W(Q,l,L,i,32)}function W(Q,l,L,i,A){var K,G=0;for(K=0;K<A;++K)G|=Q[l+K]^L[i+K];return(1&G-1>>>8)-1}function X(Q){var l=new p(32);return D(l,Q),l[0]&1}function J(Q,l,L){var i,A;for(he(Q[0],S),he(Q[1],U),he(Q[2],U),he(Q[3],S),A=255;A>=0;--A)i=L[A/8|0]>>(A&7)&1,b(Q,l,i),g(l,Q),g(Q,Q),b(Q,l,i)}function te(Q,l){var L=[ae(),ae(),ae(),ae()];he(L[0],m),he(L[1],c),he(L[2],U),Ie(L[3],m,c),J(Q,L,l)}function he(Q,l){var L;for(L=0;L<16;L++)Q[L]=l[L]|0}function xe(Q,l){var L=ae(),i;for(i=0;i<16;++i)L[i]=l[i];for(i=253;i>=0;--i)We(L,L),i!==2&&i!==4&&Ie(L,L,l);for(i=0;i<16;++i)Q[i]=L[i]}function Se(Q){var l,L,i=1;for(l=0;l<16;++l)L=Q[l]+i+65535,i=Math.floor(L/65536),Q[l]=L-i*65536;Q[0]+=i-1+37*(i-1)}function ve(Q,l,L){for(var i,A=~(L-1),K=0;K<16;++K)i=A&(Q[K]^l[K]),Q[K]^=i,l[K]^=i}function ae(Q){var l,L=new Float64Array(16);if(Q)for(l=0;l<Q.length;++l)L[l]=Q[l];return L}function ue(Q,l,L){for(var i=0;i<16;++i)Q[i]=l[i]+L[i]}function be(Q,l,L){for(var i=0;i<16;++i)Q[i]=l[i]-L[i]}function We(Q,l){Ie(Q,l,l)}function Ie(Q,l,L){var i,A,K=0,G=0,M=0,Z=0,pe=0,ce=0,$=0,de=0,ye=0,Be=0,Ce=0,Ue=0,Oe=0,Pe=0,Ke=0,Re=0,Xe=0,je=0,ut=0,lt=0,pt=0,Ee=0,St=0,ct=0,Tt=0,Ut=0,Vt=0,Mt=0,Pt=0,Yt=0,qt=0,$e=L[0],Ze=L[1],qe=L[2],Fe=L[3],Je=L[4],et=L[5],tt=L[6],rt=L[7],at=L[8],nt=L[9],it=L[10],Ge=L[11],He=L[12],ke=L[13],_e=L[14],st=L[15];i=l[0],K+=i*$e,G+=i*Ze,M+=i*qe,Z+=i*Fe,pe+=i*Je,ce+=i*et,$+=i*tt,de+=i*rt,ye+=i*at,Be+=i*nt,Ce+=i*it,Ue+=i*Ge,Oe+=i*He,Pe+=i*ke,Ke+=i*_e,Re+=i*st,i=l[1],G+=i*$e,M+=i*Ze,Z+=i*qe,pe+=i*Fe,ce+=i*Je,$+=i*et,de+=i*tt,ye+=i*rt,Be+=i*at,Ce+=i*nt,Ue+=i*it,Oe+=i*Ge,Pe+=i*He,Ke+=i*ke,Re+=i*_e,Xe+=i*st,i=l[2],M+=i*$e,Z+=i*Ze,pe+=i*qe,ce+=i*Fe,$+=i*Je,de+=i*et,ye+=i*tt,Be+=i*rt,Ce+=i*at,Ue+=i*nt,Oe+=i*it,Pe+=i*Ge,Ke+=i*He,Re+=i*ke,Xe+=i*_e,je+=i*st,i=l[3],Z+=i*$e,pe+=i*Ze,ce+=i*qe,$+=i*Fe,de+=i*Je,ye+=i*et,Be+=i*tt,Ce+=i*rt,Ue+=i*at,Oe+=i*nt,Pe+=i*it,Ke+=i*Ge,Re+=i*He,Xe+=i*ke,je+=i*_e,ut+=i*st,i=l[4],pe+=i*$e,ce+=i*Ze,$+=i*qe,de+=i*Fe,ye+=i*Je,Be+=i*et,Ce+=i*tt,Ue+=i*rt,Oe+=i*at,Pe+=i*nt,Ke+=i*it,Re+=i*Ge,Xe+=i*He,je+=i*ke,ut+=i*_e,lt+=i*st,i=l[5],ce+=i*$e,$+=i*Ze,de+=i*qe,ye+=i*Fe,Be+=i*Je,Ce+=i*et,Ue+=i*tt,Oe+=i*rt,Pe+=i*at,Ke+=i*nt,Re+=i*it,Xe+=i*Ge,je+=i*He,ut+=i*ke,lt+=i*_e,pt+=i*st,i=l[6],$+=i*$e,de+=i*Ze,ye+=i*qe,Be+=i*Fe,Ce+=i*Je,Ue+=i*et,Oe+=i*tt,Pe+=i*rt,Ke+=i*at,Re+=i*nt,Xe+=i*it,je+=i*Ge,ut+=i*He,lt+=i*ke,pt+=i*_e,Ee+=i*st,i=l[7],de+=i*$e,ye+=i*Ze,Be+=i*qe,Ce+=i*Fe,Ue+=i*Je,Oe+=i*et,Pe+=i*tt,Ke+=i*rt,Re+=i*at,Xe+=i*nt,je+=i*it,ut+=i*Ge,lt+=i*He,pt+=i*ke,Ee+=i*_e,St+=i*st,i=l[8],ye+=i*$e,Be+=i*Ze,Ce+=i*qe,Ue+=i*Fe,Oe+=i*Je,Pe+=i*et,Ke+=i*tt,Re+=i*rt,Xe+=i*at,je+=i*nt,ut+=i*it,lt+=i*Ge,pt+=i*He,Ee+=i*ke,St+=i*_e,ct+=i*st,i=l[9],Be+=i*$e,Ce+=i*Ze,Ue+=i*qe,Oe+=i*Fe,Pe+=i*Je,Ke+=i*et,Re+=i*tt,Xe+=i*rt,je+=i*at,ut+=i*nt,lt+=i*it,pt+=i*Ge,Ee+=i*He,St+=i*ke,ct+=i*_e,Tt+=i*st,i=l[10],Ce+=i*$e,Ue+=i*Ze,Oe+=i*qe,Pe+=i*Fe,Ke+=i*Je,Re+=i*et,Xe+=i*tt,je+=i*rt,ut+=i*at,lt+=i*nt,pt+=i*it,Ee+=i*Ge,St+=i*He,ct+=i*ke,Tt+=i*_e,Ut+=i*st,i=l[11],Ue+=i*$e,Oe+=i*Ze,Pe+=i*qe,Ke+=i*Fe,Re+=i*Je,Xe+=i*et,je+=i*tt,ut+=i*rt,lt+=i*at,pt+=i*nt,Ee+=i*it,St+=i*Ge,ct+=i*He,Tt+=i*ke,Ut+=i*_e,Vt+=i*st,i=l[12],Oe+=i*$e,Pe+=i*Ze,Ke+=i*qe,Re+=i*Fe,Xe+=i*Je,je+=i*et,ut+=i*tt,lt+=i*rt,pt+=i*at,Ee+=i*nt,St+=i*it,ct+=i*Ge,Tt+=i*He,Ut+=i*ke,Vt+=i*_e,Mt+=i*st,i=l[13],Pe+=i*$e,Ke+=i*Ze,Re+=i*qe,Xe+=i*Fe,je+=i*Je,ut+=i*et,lt+=i*tt,pt+=i*rt,Ee+=i*at,St+=i*nt,ct+=i*it,Tt+=i*Ge,Ut+=i*He,Vt+=i*ke,Mt+=i*_e,Pt+=i*st,i=l[14],Ke+=i*$e,Re+=i*Ze,Xe+=i*qe,je+=i*Fe,ut+=i*Je,lt+=i*et,pt+=i*tt,Ee+=i*rt,St+=i*at,ct+=i*nt,Tt+=i*it,Ut+=i*Ge,Vt+=i*He,Mt+=i*ke,Pt+=i*_e,Yt+=i*st,i=l[15],Re+=i*$e,Xe+=i*Ze,je+=i*qe,ut+=i*Fe,lt+=i*Je,pt+=i*et,Ee+=i*tt,St+=i*rt,ct+=i*at,Tt+=i*nt,Ut+=i*it,Vt+=i*Ge,Mt+=i*He,Pt+=i*ke,Yt+=i*_e,qt+=i*st,K+=38*Xe,G+=38*je,M+=38*ut,Z+=38*lt,pe+=38*pt,ce+=38*Ee,$+=38*St,de+=38*ct,ye+=38*Tt,Be+=38*Ut,Ce+=38*Vt,Ue+=38*Mt,Oe+=38*Pt,Pe+=38*Yt,Ke+=38*qt,A=1,i=K+A+65535,A=Math.floor(i/65536),K=i-A*65536,i=G+A+65535,A=Math.floor(i/65536),G=i-A*65536,i=M+A+65535,A=Math.floor(i/65536),M=i-A*65536,i=Z+A+65535,A=Math.floor(i/65536),Z=i-A*65536,i=pe+A+65535,A=Math.floor(i/65536),pe=i-A*65536,i=ce+A+65535,A=Math.floor(i/65536),ce=i-A*65536,i=$+A+65535,A=Math.floor(i/65536),$=i-A*65536,i=de+A+65535,A=Math.floor(i/65536),de=i-A*65536,i=ye+A+65535,A=Math.floor(i/65536),ye=i-A*65536,i=Be+A+65535,A=Math.floor(i/65536),Be=i-A*65536,i=Ce+A+65535,A=Math.floor(i/65536),Ce=i-A*65536,i=Ue+A+65535,A=Math.floor(i/65536),Ue=i-A*65536,i=Oe+A+65535,A=Math.floor(i/65536),Oe=i-A*65536,i=Pe+A+65535,A=Math.floor(i/65536),Pe=i-A*65536,i=Ke+A+65535,A=Math.floor(i/65536),Ke=i-A*65536,i=Re+A+65535,A=Math.floor(i/65536),Re=i-A*65536,K+=A-1+37*(A-1),A=1,i=K+A+65535,A=Math.floor(i/65536),K=i-A*65536,i=G+A+65535,A=Math.floor(i/65536),G=i-A*65536,i=M+A+65535,A=Math.floor(i/65536),M=i-A*65536,i=Z+A+65535,A=Math.floor(i/65536),Z=i-A*65536,i=pe+A+65535,A=Math.floor(i/65536),pe=i-A*65536,i=ce+A+65535,A=Math.floor(i/65536),ce=i-A*65536,i=$+A+65535,A=Math.floor(i/65536),$=i-A*65536,i=de+A+65535,A=Math.floor(i/65536),de=i-A*65536,i=ye+A+65535,A=Math.floor(i/65536),ye=i-A*65536,i=Be+A+65535,A=Math.floor(i/65536),Be=i-A*65536,i=Ce+A+65535,A=Math.floor(i/65536),Ce=i-A*65536,i=Ue+A+65535,A=Math.floor(i/65536),Ue=i-A*65536,i=Oe+A+65535,A=Math.floor(i/65536),Oe=i-A*65536,i=Pe+A+65535,A=Math.floor(i/65536),Pe=i-A*65536,i=Ke+A+65535,A=Math.floor(i/65536),Ke=i-A*65536,i=Re+A+65535,A=Math.floor(i/65536),Re=i-A*65536,K+=A-1+37*(A-1),Q[0]=K,Q[1]=G,Q[2]=M,Q[3]=Z,Q[4]=pe,Q[5]=ce,Q[6]=$,Q[7]=de,Q[8]=ye,Q[9]=Be,Q[10]=Ce,Q[11]=Ue,Q[12]=Oe,Q[13]=Pe,Q[14]=Ke,Q[15]=Re}},50276:re=>{re.exports={options:{usePureJavaScript:!1}}},71696:(re,me,P)=>{var t=P(50276);P(8106),P(7619);var e=re.exports=t.hmac=t.hmac||{};e.create=function(){var h=null,s=null,E=null,T=null,d={};return d.start=function(p,a){if(p!==null)if(typeof p=="string")if(p=p.toLowerCase(),p in t.md.algorithms)s=t.md.algorithms[p].create();else throw new Error('Unknown hash algorithm "'+p+'"');else s=p;if(a===null)a=h;else{if(typeof a=="string")a=t.util.createBuffer(a);else if(t.util.isArray(a)){var o=a;a=t.util.createBuffer();for(var S=0;S<o.length;++S)a.putByte(o[S])}var U=a.length();U>s.blockLength&&(s.start(),s.update(a.bytes()),a=s.digest()),E=t.util.createBuffer(),T=t.util.createBuffer(),U=a.length();for(var S=0;S<U;++S){var o=a.at(S);E.putByte(54^o),T.putByte(92^o)}if(U<s.blockLength)for(var o=s.blockLength-U,S=0;S<o;++S)E.putByte(54),T.putByte(92);h=a,E=E.bytes(),T=T.bytes()}s.start(),s.update(E)},d.update=function(p){s.update(p)},d.getMac=function(){var p=s.digest().bytes();return s.start(),s.update(T),s.update(p),s.digest()},d.digest=d.getMac,d}},39547:(re,me,P)=>{re.exports=P(50276),P(39504),P(38678),P(12746),P(93900),P(19095),P(62926),P(71696),P(83432),P(52045),P(61355),P(45250),P(3254),P(2385),P(47501),P(55071),P(59343),P(29255),P(10268),P(73878),P(51417),P(89356),P(55124),P(50149),P(43986),P(7619)},43736:(re,me,P)=>{var t=P(50276);re.exports=t.jsbn=t.jsbn||{};var e,h=0xdeadbeefcafe,s=(h&16777215)==15715070;function E(I,N,k){this.data=[],I!=null&&(typeof I=="number"?this.fromNumber(I,N,k):N==null&&typeof I!="string"?this.fromString(I,256):this.fromString(I,N))}t.jsbn.BigInteger=E;function T(){return new E(null)}function d(I,N,k,_,q,ee){for(;--ee>=0;){var fe=N*this.data[I++]+k.data[_]+q;q=Math.floor(fe/67108864),k.data[_++]=fe&67108863}return q}function p(I,N,k,_,q,ee){for(var fe=N&32767,se=N>>15;--ee>=0;){var De=this.data[I]&32767,ze=this.data[I++]>>15,It=se*De+ze*fe;De=fe*De+((It&32767)<<15)+k.data[_]+(q&1073741823),q=(De>>>30)+(It>>>15)+se*ze+(q>>>30),k.data[_++]=De&1073741823}return q}function a(I,N,k,_,q,ee){for(var fe=N&16383,se=N>>14;--ee>=0;){var De=this.data[I]&16383,ze=this.data[I++]>>14,It=se*De+ze*fe;De=fe*De+((It&16383)<<14)+k.data[_]+q,q=(De>>28)+(It>>14)+se*ze,k.data[_++]=De&268435455}return q}typeof navigator>"u"?(E.prototype.am=a,e=28):s&&navigator.appName=="Microsoft Internet Explorer"?(E.prototype.am=p,e=30):s&&navigator.appName!="Netscape"?(E.prototype.am=d,e=26):(E.prototype.am=a,e=28),E.prototype.DB=e,E.prototype.DM=(1<<e)-1,E.prototype.DV=1<<e;var o=52;E.prototype.FV=Math.pow(2,o),E.prototype.F1=o-e,E.prototype.F2=2*e-o;var S="0123456789abcdefghijklmnopqrstuvwxyz",U=new Array,x,y;for(x=48,y=0;y<=9;++y)U[x++]=y;for(x=97,y=10;y<36;++y)U[x++]=y;for(x=65,y=10;y<36;++y)U[x++]=y;function m(I){return S.charAt(I)}function c(I,N){var k=U[I.charCodeAt(N)];return k??-1}function v(I){for(var N=this.t-1;N>=0;--N)I.data[N]=this.data[N];I.t=this.t,I.s=this.s}function R(I){this.t=1,this.s=I<0?-1:0,I>0?this.data[0]=I:I<-1?this.data[0]=I+this.DV:this.t=0}function n(I){var N=T();return N.fromInt(I),N}function f(I,N){var k;if(N==16)k=4;else if(N==8)k=3;else if(N==256)k=8;else if(N==2)k=1;else if(N==32)k=5;else if(N==4)k=2;else{this.fromRadix(I,N);return}this.t=0,this.s=0;for(var _=I.length,q=!1,ee=0;--_>=0;){var fe=k==8?I[_]&255:c(I,_);if(fe<0){I.charAt(_)=="-"&&(q=!0);continue}q=!1,ee==0?this.data[this.t++]=fe:ee+k>this.DB?(this.data[this.t-1]|=(fe&(1<<this.DB-ee)-1)<<ee,this.data[this.t++]=fe>>this.DB-ee):this.data[this.t-1]|=fe<<ee,ee+=k,ee>=this.DB&&(ee-=this.DB)}k==8&&I[0]&128&&(this.s=-1,ee>0&&(this.data[this.t-1]|=(1<<this.DB-ee)-1<<ee)),this.clamp(),q&&E.ZERO.subTo(this,this)}function C(){for(var I=this.s&this.DM;this.t>0&&this.data[this.t-1]==I;)--this.t}function B(I){if(this.s<0)return"-"+this.negate().toString(I);var N;if(I==16)N=4;else if(I==8)N=3;else if(I==2)N=1;else if(I==32)N=5;else if(I==4)N=2;else return this.toRadix(I);var k=(1<<N)-1,_,q=!1,ee="",fe=this.t,se=this.DB-fe*this.DB%N;if(fe-- >0)for(se<this.DB&&(_=this.data[fe]>>se)>0&&(q=!0,ee=m(_));fe>=0;)se<N?(_=(this.data[fe]&(1<<se)-1)<<N-se,_|=this.data[--fe]>>(se+=this.DB-N)):(_=this.data[fe]>>(se-=N)&k,se<=0&&(se+=this.DB,--fe)),_>0&&(q=!0),q&&(ee+=m(_));return q?ee:"0"}function V(){var I=T();return E.ZERO.subTo(this,I),I}function u(){return this.s<0?this.negate():this}function g(I){var N=this.s-I.s;if(N!=0)return N;var k=this.t;if(N=k-I.t,N!=0)return this.s<0?-N:N;for(;--k>=0;)if((N=this.data[k]-I.data[k])!=0)return N;return 0}function b(I){var N=1,k;return(k=I>>>16)!=0&&(I=k,N+=16),(k=I>>8)!=0&&(I=k,N+=8),(k=I>>4)!=0&&(I=k,N+=4),(k=I>>2)!=0&&(I=k,N+=2),(k=I>>1)!=0&&(I=k,N+=1),N}function r(){return this.t<=0?0:this.DB*(this.t-1)+b(this.data[this.t-1]^this.s&this.DM)}function D(I,N){var k;for(k=this.t-1;k>=0;--k)N.data[k+I]=this.data[k];for(k=I-1;k>=0;--k)N.data[k]=0;N.t=this.t+I,N.s=this.s}function O(I,N){for(var k=I;k<this.t;++k)N.data[k-I]=this.data[k];N.t=Math.max(this.t-I,0),N.s=this.s}function w(I,N){var k=I%this.DB,_=this.DB-k,q=(1<<_)-1,ee=Math.floor(I/this.DB),fe=this.s<<k&this.DM,se;for(se=this.t-1;se>=0;--se)N.data[se+ee+1]=this.data[se]>>_|fe,fe=(this.data[se]&q)<<k;for(se=ee-1;se>=0;--se)N.data[se]=0;N.data[ee]=fe,N.t=this.t+ee+1,N.s=this.s,N.clamp()}function H(I,N){N.s=this.s;var k=Math.floor(I/this.DB);if(k>=this.t){N.t=0;return}var _=I%this.DB,q=this.DB-_,ee=(1<<_)-1;N.data[0]=this.data[k]>>_;for(var fe=k+1;fe<this.t;++fe)N.data[fe-k-1]|=(this.data[fe]&ee)<<q,N.data[fe-k]=this.data[fe]>>_;_>0&&(N.data[this.t-k-1]|=(this.s&ee)<<q),N.t=this.t-k,N.clamp()}function j(I,N){for(var k=0,_=0,q=Math.min(I.t,this.t);k<q;)_+=this.data[k]-I.data[k],N.data[k++]=_&this.DM,_>>=this.DB;if(I.t<this.t){for(_-=I.s;k<this.t;)_+=this.data[k],N.data[k++]=_&this.DM,_>>=this.DB;_+=this.s}else{for(_+=this.s;k<I.t;)_-=I.data[k],N.data[k++]=_&this.DM,_>>=this.DB;_-=I.s}N.s=_<0?-1:0,_<-1?N.data[k++]=this.DV+_:_>0&&(N.data[k++]=_),N.t=k,N.clamp()}function z(I,N){var k=this.abs(),_=I.abs(),q=k.t;for(N.t=q+_.t;--q>=0;)N.data[q]=0;for(q=0;q<_.t;++q)N.data[q+k.t]=k.am(0,_.data[q],N,q,0,k.t);N.s=0,N.clamp(),this.s!=I.s&&E.ZERO.subTo(N,N)}function W(I){for(var N=this.abs(),k=I.t=2*N.t;--k>=0;)I.data[k]=0;for(k=0;k<N.t-1;++k){var _=N.am(k,N.data[k],I,2*k,0,1);(I.data[k+N.t]+=N.am(k+1,2*N.data[k],I,2*k+1,_,N.t-k-1))>=N.DV&&(I.data[k+N.t]-=N.DV,I.data[k+N.t+1]=1)}I.t>0&&(I.data[I.t-1]+=N.am(k,N.data[k],I,2*k,0,1)),I.s=0,I.clamp()}function X(I,N,k){var _=I.abs();if(!(_.t<=0)){var q=this.abs();if(q.t<_.t){N?.fromInt(0),k!=null&&this.copyTo(k);return}k==null&&(k=T());var ee=T(),fe=this.s,se=I.s,De=this.DB-b(_.data[_.t-1]);De>0?(_.lShiftTo(De,ee),q.lShiftTo(De,k)):(_.copyTo(ee),q.copyTo(k));var ze=ee.t,It=ee.data[ze-1];if(It!=0){var gt=It*(1<<this.F1)+(ze>1?ee.data[ze-2]>>this.F2:0),kt=this.FV/gt,Jt=(1<<this.F1)/gt,Bt=1<<this.F2,Dt=k.t,ar=Dt-ze,Ot=N??T();for(ee.dlShiftTo(ar,Ot),k.compareTo(Ot)>=0&&(k.data[k.t++]=1,k.subTo(Ot,k)),E.ONE.dlShiftTo(ze,Ot),Ot.subTo(ee,ee);ee.t<ze;)ee.data[ee.t++]=0;for(;--ar>=0;){var Ye=k.data[--Dt]==It?this.DM:Math.floor(k.data[Dt]*kt+(k.data[Dt-1]+Bt)*Jt);if((k.data[Dt]+=ee.am(0,Ye,k,ar,0,ze))<Ye)for(ee.dlShiftTo(ar,Ot),k.subTo(Ot,k);k.data[Dt]<--Ye;)k.subTo(Ot,k)}N!=null&&(k.drShiftTo(ze,N),fe!=se&&E.ZERO.subTo(N,N)),k.t=ze,k.clamp(),De>0&&k.rShiftTo(De,k),fe<0&&E.ZERO.subTo(k,k)}}}function J(I){var N=T();return this.abs().divRemTo(I,null,N),this.s<0&&N.compareTo(E.ZERO)>0&&I.subTo(N,N),N}function te(I){this.m=I}function he(I){return I.s<0||I.compareTo(this.m)>=0?I.mod(this.m):I}function xe(I){return I}function Se(I){I.divRemTo(this.m,null,I)}function ve(I,N,k){I.multiplyTo(N,k),this.reduce(k)}function ae(I,N){I.squareTo(N),this.reduce(N)}te.prototype.convert=he,te.prototype.revert=xe,te.prototype.reduce=Se,te.prototype.mulTo=ve,te.prototype.sqrTo=ae;function ue(){if(this.t<1)return 0;var I=this.data[0];if(!(I&1))return 0;var N=I&3;return N=N*(2-(I&15)*N)&15,N=N*(2-(I&255)*N)&255,N=N*(2-((I&65535)*N&65535))&65535,N=N*(2-I*N%this.DV)%this.DV,N>0?this.DV-N:-N}function be(I){this.m=I,this.mp=I.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<I.DB-15)-1,this.mt2=2*I.t}function We(I){var N=T();return I.abs().dlShiftTo(this.m.t,N),N.divRemTo(this.m,null,N),I.s<0&&N.compareTo(E.ZERO)>0&&this.m.subTo(N,N),N}function Ie(I){var N=T();return I.copyTo(N),this.reduce(N),N}function Q(I){for(;I.t<=this.mt2;)I.data[I.t++]=0;for(var N=0;N<this.m.t;++N){var k=I.data[N]&32767,_=k*this.mpl+((k*this.mph+(I.data[N]>>15)*this.mpl&this.um)<<15)&I.DM;for(k=N+this.m.t,I.data[k]+=this.m.am(0,_,I,N,0,this.m.t);I.data[k]>=I.DV;)I.data[k]-=I.DV,I.data[++k]++}I.clamp(),I.drShiftTo(this.m.t,I),I.compareTo(this.m)>=0&&I.subTo(this.m,I)}function l(I,N){I.squareTo(N),this.reduce(N)}function L(I,N,k){I.multiplyTo(N,k),this.reduce(k)}be.prototype.convert=We,be.prototype.revert=Ie,be.prototype.reduce=Q,be.prototype.mulTo=L,be.prototype.sqrTo=l;function i(){return(this.t>0?this.data[0]&1:this.s)==0}function A(I,N){if(I>4294967295||I<1)return E.ONE;var k=T(),_=T(),q=N.convert(this),ee=b(I)-1;for(q.copyTo(k);--ee>=0;)if(N.sqrTo(k,_),(I&1<<ee)>0)N.mulTo(_,q,k);else{var fe=k;k=_,_=fe}return N.revert(k)}function K(I,N){var k;return I<256||N.isEven()?k=new te(N):k=new be(N),this.exp(I,k)}E.prototype.copyTo=v,E.prototype.fromInt=R,E.prototype.fromString=f,E.prototype.clamp=C,E.prototype.dlShiftTo=D,E.prototype.drShiftTo=O,E.prototype.lShiftTo=w,E.prototype.rShiftTo=H,E.prototype.subTo=j,E.prototype.multiplyTo=z,E.prototype.squareTo=W,E.prototype.divRemTo=X,E.prototype.invDigit=ue,E.prototype.isEven=i,E.prototype.exp=A,E.prototype.toString=B,E.prototype.negate=V,E.prototype.abs=u,E.prototype.compareTo=g,E.prototype.bitLength=r,E.prototype.mod=J,E.prototype.modPowInt=K,E.ZERO=n(0),E.ONE=n(1);function G(){var I=T();return this.copyTo(I),I}function M(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Z(){return this.t==0?this.s:this.data[0]<<24>>24}function pe(){return this.t==0?this.s:this.data[0]<<16>>16}function ce(I){return Math.floor(Math.LN2*this.DB/Math.log(I))}function $(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function de(I){if(I==null&&(I=10),this.signum()==0||I<2||I>36)return"0";var N=this.chunkSize(I),k=Math.pow(I,N),_=n(k),q=T(),ee=T(),fe="";for(this.divRemTo(_,q,ee);q.signum()>0;)fe=(k+ee.intValue()).toString(I).substr(1)+fe,q.divRemTo(_,q,ee);return ee.intValue().toString(I)+fe}function ye(I,N){this.fromInt(0),N==null&&(N=10);for(var k=this.chunkSize(N),_=Math.pow(N,k),q=!1,ee=0,fe=0,se=0;se<I.length;++se){var De=c(I,se);if(De<0){I.charAt(se)=="-"&&this.signum()==0&&(q=!0);continue}fe=N*fe+De,++ee>=k&&(this.dMultiply(_),this.dAddOffset(fe,0),ee=0,fe=0)}ee>0&&(this.dMultiply(Math.pow(N,ee)),this.dAddOffset(fe,0)),q&&E.ZERO.subTo(this,this)}function Be(I,N,k){if(typeof N=="number")if(I<2)this.fromInt(1);else for(this.fromNumber(I,k),this.testBit(I-1)||this.bitwiseTo(E.ONE.shiftLeft(I-1),je,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(N);)this.dAddOffset(2,0),this.bitLength()>I&&this.subTo(E.ONE.shiftLeft(I-1),this);else{var _=new Array,q=I&7;_.length=(I>>3)+1,N.nextBytes(_),q>0?_[0]&=(1<<q)-1:_[0]=0,this.fromString(_,256)}}function Ce(){var I=this.t,N=new Array;N[0]=this.s;var k=this.DB-I*this.DB%8,_,q=0;if(I-- >0)for(k<this.DB&&(_=this.data[I]>>k)!=(this.s&this.DM)>>k&&(N[q++]=_|this.s<<this.DB-k);I>=0;)k<8?(_=(this.data[I]&(1<<k)-1)<<8-k,_|=this.data[--I]>>(k+=this.DB-8)):(_=this.data[I]>>(k-=8)&255,k<=0&&(k+=this.DB,--I)),_&128&&(_|=-256),q==0&&(this.s&128)!=(_&128)&&++q,(q>0||_!=this.s)&&(N[q++]=_);return N}function Ue(I){return this.compareTo(I)==0}function Oe(I){return this.compareTo(I)<0?this:I}function Pe(I){return this.compareTo(I)>0?this:I}function Ke(I,N,k){var _,q,ee=Math.min(I.t,this.t);for(_=0;_<ee;++_)k.data[_]=N(this.data[_],I.data[_]);if(I.t<this.t){for(q=I.s&this.DM,_=ee;_<this.t;++_)k.data[_]=N(this.data[_],q);k.t=this.t}else{for(q=this.s&this.DM,_=ee;_<I.t;++_)k.data[_]=N(q,I.data[_]);k.t=I.t}k.s=N(this.s,I.s),k.clamp()}function Re(I,N){return I&N}function Xe(I){var N=T();return this.bitwiseTo(I,Re,N),N}function je(I,N){return I|N}function ut(I){var N=T();return this.bitwiseTo(I,je,N),N}function lt(I,N){return I^N}function pt(I){var N=T();return this.bitwiseTo(I,lt,N),N}function Ee(I,N){return I&~N}function St(I){var N=T();return this.bitwiseTo(I,Ee,N),N}function ct(){for(var I=T(),N=0;N<this.t;++N)I.data[N]=this.DM&~this.data[N];return I.t=this.t,I.s=~this.s,I}function Tt(I){var N=T();return I<0?this.rShiftTo(-I,N):this.lShiftTo(I,N),N}function Ut(I){var N=T();return I<0?this.lShiftTo(-I,N):this.rShiftTo(I,N),N}function Vt(I){if(I==0)return-1;var N=0;return I&65535||(I>>=16,N+=16),I&255||(I>>=8,N+=8),I&15||(I>>=4,N+=4),I&3||(I>>=2,N+=2),I&1||++N,N}function Mt(){for(var I=0;I<this.t;++I)if(this.data[I]!=0)return I*this.DB+Vt(this.data[I]);return this.s<0?this.t*this.DB:-1}function Pt(I){for(var N=0;I!=0;)I&=I-1,++N;return N}function Yt(){for(var I=0,N=this.s&this.DM,k=0;k<this.t;++k)I+=Pt(this.data[k]^N);return I}function qt(I){var N=Math.floor(I/this.DB);return N>=this.t?this.s!=0:(this.data[N]&1<<I%this.DB)!=0}function $e(I,N){var k=E.ONE.shiftLeft(I);return this.bitwiseTo(k,N,k),k}function Ze(I){return this.changeBit(I,je)}function qe(I){return this.changeBit(I,Ee)}function Fe(I){return this.changeBit(I,lt)}function Je(I,N){for(var k=0,_=0,q=Math.min(I.t,this.t);k<q;)_+=this.data[k]+I.data[k],N.data[k++]=_&this.DM,_>>=this.DB;if(I.t<this.t){for(_+=I.s;k<this.t;)_+=this.data[k],N.data[k++]=_&this.DM,_>>=this.DB;_+=this.s}else{for(_+=this.s;k<I.t;)_+=I.data[k],N.data[k++]=_&this.DM,_>>=this.DB;_+=I.s}N.s=_<0?-1:0,_>0?N.data[k++]=_:_<-1&&(N.data[k++]=this.DV+_),N.t=k,N.clamp()}function et(I){var N=T();return this.addTo(I,N),N}function tt(I){var N=T();return this.subTo(I,N),N}function rt(I){var N=T();return this.multiplyTo(I,N),N}function at(I){var N=T();return this.divRemTo(I,N,null),N}function nt(I){var N=T();return this.divRemTo(I,null,N),N}function it(I){var N=T(),k=T();return this.divRemTo(I,N,k),new Array(N,k)}function Ge(I){this.data[this.t]=this.am(0,I-1,this,0,0,this.t),++this.t,this.clamp()}function He(I,N){if(I!=0){for(;this.t<=N;)this.data[this.t++]=0;for(this.data[N]+=I;this.data[N]>=this.DV;)this.data[N]-=this.DV,++N>=this.t&&(this.data[this.t++]=0),++this.data[N]}}function ke(){}function _e(I){return I}function st(I,N,k){I.multiplyTo(N,k)}function Gt(I,N){I.squareTo(N)}ke.prototype.convert=_e,ke.prototype.revert=_e,ke.prototype.mulTo=st,ke.prototype.sqrTo=Gt;function fr(I){return this.exp(I,new ke)}function cr(I,N,k){var _=Math.min(this.t+I.t,N);for(k.s=0,k.t=_;_>0;)k.data[--_]=0;var q;for(q=k.t-this.t;_<q;++_)k.data[_+this.t]=this.am(0,I.data[_],k,_,0,this.t);for(q=Math.min(I.t,N);_<q;++_)this.am(0,I.data[_],k,_,0,N-_);k.clamp()}function dr(I,N,k){--N;var _=k.t=this.t+I.t-N;for(k.s=0;--_>=0;)k.data[_]=0;for(_=Math.max(N-this.t,0);_<I.t;++_)k.data[this.t+_-N]=this.am(N-_,I.data[_],k,0,0,this.t+_-N);k.clamp(),k.drShiftTo(1,k)}function Ht(I){this.r2=T(),this.q3=T(),E.ONE.dlShiftTo(2*I.t,this.r2),this.mu=this.r2.divide(I),this.m=I}function hr(I){if(I.s<0||I.t>2*this.m.t)return I.mod(this.m);if(I.compareTo(this.m)<0)return I;var N=T();return I.copyTo(N),this.reduce(N),N}function pr(I){return I}function vr(I){for(I.drShiftTo(this.m.t-1,this.r2),I.t>this.m.t+1&&(I.t=this.m.t+1,I.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);I.compareTo(this.r2)<0;)I.dAddOffset(1,this.m.t+1);for(I.subTo(this.r2,I);I.compareTo(this.m)>=0;)I.subTo(this.m,I)}function lr(I,N){I.squareTo(N),this.reduce(N)}function gr(I,N,k){I.multiplyTo(N,k),this.reduce(k)}Ht.prototype.convert=hr,Ht.prototype.revert=pr,Ht.prototype.reduce=vr,Ht.prototype.mulTo=gr,Ht.prototype.sqrTo=lr;function yr(I,N){var k=I.bitLength(),_,q=n(1),ee;if(k<=0)return q;k<18?_=1:k<48?_=3:k<144?_=4:k<768?_=5:_=6,k<8?ee=new te(N):N.isEven()?ee=new Ht(N):ee=new be(N);var fe=new Array,se=3,De=_-1,ze=(1<<_)-1;if(fe[1]=ee.convert(this),_>1){var It=T();for(ee.sqrTo(fe[1],It);se<=ze;)fe[se]=T(),ee.mulTo(It,fe[se-2],fe[se]),se+=2}var gt=I.t-1,kt,Jt=!0,Bt=T(),Dt;for(k=b(I.data[gt])-1;gt>=0;){for(k>=De?kt=I.data[gt]>>k-De&ze:(kt=(I.data[gt]&(1<<k+1)-1)<<De-k,gt>0&&(kt|=I.data[gt-1]>>this.DB+k-De)),se=_;!(kt&1);)kt>>=1,--se;if((k-=se)<0&&(k+=this.DB,--gt),Jt)fe[kt].copyTo(q),Jt=!1;else{for(;se>1;)ee.sqrTo(q,Bt),ee.sqrTo(Bt,q),se-=2;se>0?ee.sqrTo(q,Bt):(Dt=q,q=Bt,Bt=Dt),ee.mulTo(Bt,fe[kt],q)}for(;gt>=0&&!(I.data[gt]&1<<k);)ee.sqrTo(q,Bt),Dt=q,q=Bt,Bt=Dt,--k<0&&(k=this.DB-1,--gt)}return ee.revert(q)}function Sr(I){var N=this.s<0?this.negate():this.clone(),k=I.s<0?I.negate():I.clone();if(N.compareTo(k)<0){var _=N;N=k,k=_}var q=N.getLowestSetBit(),ee=k.getLowestSetBit();if(ee<0)return N;for(q<ee&&(ee=q),ee>0&&(N.rShiftTo(ee,N),k.rShiftTo(ee,k));N.signum()>0;)(q=N.getLowestSetBit())>0&&N.rShiftTo(q,N),(q=k.getLowestSetBit())>0&&k.rShiftTo(q,k),N.compareTo(k)>=0?(N.subTo(k,N),N.rShiftTo(1,N)):(k.subTo(N,k),k.rShiftTo(1,k));return ee>0&&k.lShiftTo(ee,k),k}function Tr(I){if(I<=0)return 0;var N=this.DV%I,k=this.s<0?I-1:0;if(this.t>0)if(N==0)k=this.data[0]%I;else for(var _=this.t-1;_>=0;--_)k=(N*k+this.data[_])%I;return k}function mr(I){var N=I.isEven();if(this.isEven()&&N||I.signum()==0)return E.ZERO;for(var k=I.clone(),_=this.clone(),q=n(1),ee=n(0),fe=n(0),se=n(1);k.signum()!=0;){for(;k.isEven();)k.rShiftTo(1,k),N?((!q.isEven()||!ee.isEven())&&(q.addTo(this,q),ee.subTo(I,ee)),q.rShiftTo(1,q)):ee.isEven()||ee.subTo(I,ee),ee.rShiftTo(1,ee);for(;_.isEven();)_.rShiftTo(1,_),N?((!fe.isEven()||!se.isEven())&&(fe.addTo(this,fe),se.subTo(I,se)),fe.rShiftTo(1,fe)):se.isEven()||se.subTo(I,se),se.rShiftTo(1,se);k.compareTo(_)>=0?(k.subTo(_,k),N&&q.subTo(fe,q),ee.subTo(se,ee)):(_.subTo(k,_),N&&fe.subTo(q,fe),se.subTo(ee,se))}if(_.compareTo(E.ONE)!=0)return E.ZERO;if(se.compareTo(I)>=0)return se.subtract(I);if(se.signum()<0)se.addTo(I,se);else return se;return se.signum()<0?se.add(I):se}var At=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Cr=(1<<26)/At[At.length-1];function ur(I){var N,k=this.abs();if(k.t==1&&k.data[0]<=At[At.length-1]){for(N=0;N<At.length;++N)if(k.data[0]==At[N])return!0;return!1}if(k.isEven())return!1;for(N=1;N<At.length;){for(var _=At[N],q=N+1;q<At.length&&_<Cr;)_*=At[q++];for(_=k.modInt(_);N<q;)if(_%At[N++]==0)return!1}return k.millerRabin(I)}function xr(I){var N=this.subtract(E.ONE),k=N.getLowestSetBit();if(k<=0)return!1;for(var _=N.shiftRight(k),q=Er(),ee,fe=0;fe<I;++fe){do ee=new E(this.bitLength(),q);while(ee.compareTo(E.ONE)<=0||ee.compareTo(N)>=0);var se=ee.modPow(_,this);if(se.compareTo(E.ONE)!=0&&se.compareTo(N)!=0){for(var De=1;De++<k&&se.compareTo(N)!=0;)if(se=se.modPowInt(2,this),se.compareTo(E.ONE)==0)return!1;if(se.compareTo(N)!=0)return!1}}return!0}function Er(){return{nextBytes:function(I){for(var N=0;N<I.length;++N)I[N]=Math.floor(Math.random()*256)}}}E.prototype.chunkSize=ce,E.prototype.toRadix=de,E.prototype.fromRadix=ye,E.prototype.fromNumber=Be,E.prototype.bitwiseTo=Ke,E.prototype.changeBit=$e,E.prototype.addTo=Je,E.prototype.dMultiply=Ge,E.prototype.dAddOffset=He,E.prototype.multiplyLowerTo=cr,E.prototype.multiplyUpperTo=dr,E.prototype.modInt=Tr,E.prototype.millerRabin=xr,E.prototype.clone=G,E.prototype.intValue=M,E.prototype.byteValue=Z,E.prototype.shortValue=pe,E.prototype.signum=$,E.prototype.toByteArray=Ce,E.prototype.equals=Ue,E.prototype.min=Oe,E.prototype.max=Pe,E.prototype.and=Xe,E.prototype.or=ut,E.prototype.xor=pt,E.prototype.andNot=St,E.prototype.not=ct,E.prototype.shiftLeft=Tt,E.prototype.shiftRight=Ut,E.prototype.getLowestSetBit=Mt,E.prototype.bitCount=Yt,E.prototype.testBit=qt,E.prototype.setBit=Ze,E.prototype.clearBit=qe,E.prototype.flipBit=Fe,E.prototype.add=et,E.prototype.subtract=tt,E.prototype.multiply=rt,E.prototype.divide=at,E.prototype.remainder=nt,E.prototype.divideAndRemainder=it,E.prototype.modPow=yr,E.prototype.modInverse=mr,E.prototype.pow=fr,E.prototype.gcd=Sr,E.prototype.isProbablePrime=ur},83432:(re,me,P)=>{var t=P(50276);P(7619),P(89356),P(43736),re.exports=t.kem=t.kem||{};var e=t.jsbn.BigInteger;t.kem.rsa={},t.kem.rsa.create=function(s,E){E=E||{};var T=E.prng||t.random,d={};return d.encrypt=function(p,a){var o=Math.ceil(p.n.bitLength()/8),S;do S=new e(t.util.bytesToHex(T.getBytesSync(o)),16).mod(p.n);while(S.compareTo(e.ONE)<=0);S=t.util.hexToBytes(S.toString(16));var U=o-S.length;U>0&&(S=t.util.fillString("\0",U)+S);var x=p.encrypt(S,"NONE"),y=s.generate(S,a);return{encapsulation:x,key:y}},d.decrypt=function(p,a,o){var S=p.decrypt(a,"NONE");return s.generate(S,o)},d},t.kem.kdf1=function(s,E){h(this,s,0,E||s.digestLength)},t.kem.kdf2=function(s,E){h(this,s,1,E||s.digestLength)};function h(s,E,T,d){s.generate=function(p,a){for(var o=new t.util.ByteBuffer,S=Math.ceil(a/d)+T,U=new t.util.ByteBuffer,x=T;x<S;++x){U.putInt32(x),E.start(),E.update(p+U.getBytes());var y=E.digest();o.putBytes(y.getBytes(d))}return o.truncate(o.length()-a),o.getBytes()}}},52045:(re,me,P)=>{var t=P(50276);P(7619),re.exports=t.log=t.log||{},t.log.levels=["none","error","warning","info","debug","verbose","max"];var e={},h=[],s=null;t.log.LEVEL_LOCKED=2,t.log.NO_LEVEL_CHECK=4,t.log.INTERPOLATE=8;for(var E=0;E<t.log.levels.length;++E){var T=t.log.levels[E];e[T]={index:E,name:T.toUpperCase()}}t.log.logMessage=function(x){for(var y=e[x.level].index,m=0;m<h.length;++m){var c=h[m];if(c.flags&t.log.NO_LEVEL_CHECK)c.f(x);else{var v=e[c.level].index;y<=v&&c.f(c,x)}}},t.log.prepareStandard=function(x){"standard"in x||(x.standard=e[x.level].name+" ["+x.category+"] "+x.message)},t.log.prepareFull=function(x){if(!("full"in x)){var y=[x.message];y=y.concat([]),x.full=t.util.format.apply(this,y)}},t.log.prepareStandardFull=function(x){"standardFull"in x||(t.log.prepareStandard(x),x.standardFull=x.standard)};for(var d=["error","warning","info","debug","verbose"],E=0;E<d.length;++E)(function(y){t.log[y]=function(m,c){var v=Array.prototype.slice.call(arguments).slice(2),R={timestamp:new Date,level:y,category:m,message:c,arguments:v};t.log.logMessage(R)}})(d[E]);if(t.log.makeLogger=function(x){var y={flags:0,f:x};return t.log.setLevel(y,"none"),y},t.log.setLevel=function(x,y){var m=!1;if(x&&!(x.flags&t.log.LEVEL_LOCKED))for(var c=0;c<t.log.levels.length;++c){var v=t.log.levels[c];if(y==v){x.level=y,m=!0;break}}return m},t.log.lock=function(x,y){typeof y>"u"||y?x.flags|=t.log.LEVEL_LOCKED:x.flags&=~t.log.LEVEL_LOCKED},t.log.addLogger=function(x){h.push(x)},typeof console<"u"&&"log"in console){var p;if(console.error&&console.warn&&console.info&&console.debug){var a={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},o=function(x,y){t.log.prepareStandard(y);var m=a[y.level],c=[y.standard];c=c.concat(y.arguments.slice()),m.apply(console,c)};p=t.log.makeLogger(o)}else{var o=function(y,m){t.log.prepareStandardFull(m),console.log(m.standardFull)};p=t.log.makeLogger(o)}t.log.setLevel(p,"debug"),t.log.addLogger(p),s=p}else console={log:function(){}};if(s!==null&&typeof window<"u"&&window.location){var S=new URL(window.location.href).searchParams;if(S.has("console.level")&&t.log.setLevel(s,S.get("console.level").slice(-1)[0]),S.has("console.lock")){var U=S.get("console.lock").slice(-1)[0];U=="true"&&t.log.lock(s)}}t.log.consoleLogger=s},61355:(re,me,P)=>{re.exports=P(8106),P(1267),P(21598),P(30172),P(72313)},8106:(re,me,P)=>{var t=P(50276);re.exports=t.md=t.md||{},t.md.algorithms=t.md.algorithms||{}},1267:(re,me,P)=>{var t=P(50276);P(8106),P(7619);var e=re.exports=t.md5=t.md5||{};t.md.md5=t.md.algorithms.md5=e,e.create=function(){d||p();var o=null,S=t.util.createBuffer(),U=new Array(16),x={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return x.start=function(){x.messageLength=0,x.fullMessageLength=x.messageLength64=[];for(var y=x.messageLengthSize/4,m=0;m<y;++m)x.fullMessageLength.push(0);return S=t.util.createBuffer(),o={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},x},x.start(),x.update=function(y,m){m==="utf8"&&(y=t.util.encodeUtf8(y));var c=y.length;x.messageLength+=c,c=[c/4294967296>>>0,c>>>0];for(var v=x.fullMessageLength.length-1;v>=0;--v)x.fullMessageLength[v]+=c[1],c[1]=c[0]+(x.fullMessageLength[v]/4294967296>>>0),x.fullMessageLength[v]=x.fullMessageLength[v]>>>0,c[0]=c[1]/4294967296>>>0;return S.putBytes(y),a(o,U,S),(S.read>2048||S.length()===0)&&S.compact(),x},x.digest=function(){var y=t.util.createBuffer();y.putBytes(S.bytes());var m=x.fullMessageLength[x.fullMessageLength.length-1]+x.messageLengthSize,c=m&x.blockLength-1;y.putBytes(h.substr(0,x.blockLength-c));for(var v,R=0,n=x.fullMessageLength.length-1;n>=0;--n)v=x.fullMessageLength[n]*8+R,R=v/4294967296>>>0,y.putInt32Le(v>>>0);var f={h0:o.h0,h1:o.h1,h2:o.h2,h3:o.h3};a(f,U,y);var C=t.util.createBuffer();return C.putInt32Le(f.h0),C.putInt32Le(f.h1),C.putInt32Le(f.h2),C.putInt32Le(f.h3),C},x};var h=null,s=null,E=null,T=null,d=!1;function p(){h="\x80",h+=t.util.fillString("\0",64),s=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],E=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],T=new Array(64);for(var o=0;o<64;++o)T[o]=Math.floor(Math.abs(Math.sin(o+1))*4294967296);d=!0}function a(o,S,U){for(var x,y,m,c,v,R,n,f,C=U.length();C>=64;){for(y=o.h0,m=o.h1,c=o.h2,v=o.h3,f=0;f<16;++f)S[f]=U.getInt32Le(),R=v^m&(c^v),x=y+R+T[f]+S[f],n=E[f],y=v,v=c,c=m,m+=x<<n|x>>>32-n;for(;f<32;++f)R=c^v&(m^c),x=y+R+T[f]+S[s[f]],n=E[f],y=v,v=c,c=m,m+=x<<n|x>>>32-n;for(;f<48;++f)R=m^c^v,x=y+R+T[f]+S[s[f]],n=E[f],y=v,v=c,c=m,m+=x<<n|x>>>32-n;for(;f<64;++f)R=c^(m|~v),x=y+R+T[f]+S[s[f]],n=E[f],y=v,v=c,c=m,m+=x<<n|x>>>32-n;o.h0=o.h0+y|0,o.h1=o.h1+m|0,o.h2=o.h2+c|0,o.h3=o.h3+v|0,C-=64}}},41373:(re,me,P)=>{var t=P(50276);P(45250),re.exports=t.mgf=t.mgf||{},t.mgf.mgf1=t.mgf1},45250:(re,me,P)=>{var t=P(50276);P(7619),t.mgf=t.mgf||{};var e=re.exports=t.mgf.mgf1=t.mgf1=t.mgf1||{};e.create=function(h){var s={generate:function(E,T){for(var d=new t.util.ByteBuffer,p=Math.ceil(T/h.digestLength),a=0;a<p;a++){var o=new t.util.ByteBuffer;o.putInt32(a),h.start(),h.update(E+o.getBytes()),d.putBuffer(h.digest())}return d.truncate(d.length()-T),d.getBytes()}};return s}},94037:(re,me,P)=>{var t=P(50276);t.pki=t.pki||{};var e=re.exports=t.pki.oids=t.oids=t.oids||{};function h(E,T){e[E]=T,e[T]=E}function s(E,T){e[E]=T}h("1.2.840.113549.1.1.1","rsaEncryption"),h("1.2.840.113549.1.1.4","md5WithRSAEncryption"),h("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),h("1.2.840.113549.1.1.7","RSAES-OAEP"),h("1.2.840.113549.1.1.8","mgf1"),h("1.2.840.113549.1.1.9","pSpecified"),h("1.2.840.113549.1.1.10","RSASSA-PSS"),h("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),h("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),h("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),h("1.3.101.112","EdDSA25519"),h("1.2.840.10040.4.3","dsa-with-sha1"),h("1.3.14.3.2.7","desCBC"),h("1.3.14.3.2.26","sha1"),h("1.3.14.3.2.29","sha1WithRSASignature"),h("2.16.840.1.101.3.4.2.1","sha256"),h("2.16.840.1.101.3.4.2.2","sha384"),h("2.16.840.1.101.3.4.2.3","sha512"),h("2.16.840.1.101.3.4.2.4","sha224"),h("2.16.840.1.101.3.4.2.5","sha512-224"),h("2.16.840.1.101.3.4.2.6","sha512-256"),h("1.2.840.113549.2.2","md2"),h("1.2.840.113549.2.5","md5"),h("1.2.840.113549.1.7.1","data"),h("1.2.840.113549.1.7.2","signedData"),h("1.2.840.113549.1.7.3","envelopedData"),h("1.2.840.113549.1.7.4","signedAndEnvelopedData"),h("1.2.840.113549.1.7.5","digestedData"),h("1.2.840.113549.1.7.6","encryptedData"),h("1.2.840.113549.1.9.1","emailAddress"),h("1.2.840.113549.1.9.2","unstructuredName"),h("1.2.840.113549.1.9.3","contentType"),h("1.2.840.113549.1.9.4","messageDigest"),h("1.2.840.113549.1.9.5","signingTime"),h("1.2.840.113549.1.9.6","counterSignature"),h("1.2.840.113549.1.9.7","challengePassword"),h("1.2.840.113549.1.9.8","unstructuredAddress"),h("1.2.840.113549.1.9.14","extensionRequest"),h("1.2.840.113549.1.9.20","friendlyName"),h("1.2.840.113549.1.9.21","localKeyId"),h("1.2.840.113549.1.9.22.1","x509Certificate"),h("1.2.840.113549.1.12.10.1.1","keyBag"),h("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),h("1.2.840.113549.1.12.10.1.3","certBag"),h("1.2.840.113549.1.12.10.1.4","crlBag"),h("1.2.840.113549.1.12.10.1.5","secretBag"),h("1.2.840.113549.1.12.10.1.6","safeContentsBag"),h("1.2.840.113549.1.5.13","pkcs5PBES2"),h("1.2.840.113549.1.5.12","pkcs5PBKDF2"),h("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),h("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),h("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),h("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),h("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),h("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),h("1.2.840.113549.2.7","hmacWithSHA1"),h("1.2.840.113549.2.8","hmacWithSHA224"),h("1.2.840.113549.2.9","hmacWithSHA256"),h("1.2.840.113549.2.10","hmacWithSHA384"),h("1.2.840.113549.2.11","hmacWithSHA512"),h("1.2.840.113549.3.7","des-EDE3-CBC"),h("2.16.840.1.101.3.4.1.2","aes128-CBC"),h("2.16.840.1.101.3.4.1.22","aes192-CBC"),h("2.16.840.1.101.3.4.1.42","aes256-CBC"),h("2.5.4.3","commonName"),h("2.5.4.4","surname"),h("2.5.4.5","serialNumber"),h("2.5.4.6","countryName"),h("2.5.4.7","localityName"),h("2.5.4.8","stateOrProvinceName"),h("2.5.4.9","streetAddress"),h("2.5.4.10","organizationName"),h("2.5.4.11","organizationalUnitName"),h("2.5.4.12","title"),h("2.5.4.13","description"),h("2.5.4.15","businessCategory"),h("2.5.4.17","postalCode"),h("2.5.4.42","givenName"),h("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),h("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),h("2.16.840.1.113730.1.1","nsCertType"),h("2.16.840.1.113730.1.13","nsComment"),s("2.5.29.1","authorityKeyIdentifier"),s("2.5.29.2","keyAttributes"),s("2.5.29.3","certificatePolicies"),s("2.5.29.4","keyUsageRestriction"),s("2.5.29.5","policyMapping"),s("2.5.29.6","subtreesConstraint"),s("2.5.29.7","subjectAltName"),s("2.5.29.8","issuerAltName"),s("2.5.29.9","subjectDirectoryAttributes"),s("2.5.29.10","basicConstraints"),s("2.5.29.11","nameConstraints"),s("2.5.29.12","policyConstraints"),s("2.5.29.13","basicConstraints"),h("2.5.29.14","subjectKeyIdentifier"),h("2.5.29.15","keyUsage"),s("2.5.29.16","privateKeyUsagePeriod"),h("2.5.29.17","subjectAltName"),h("2.5.29.18","issuerAltName"),h("2.5.29.19","basicConstraints"),s("2.5.29.20","cRLNumber"),s("2.5.29.21","cRLReason"),s("2.5.29.22","expirationDate"),s("2.5.29.23","instructionCode"),s("2.5.29.24","invalidityDate"),s("2.5.29.25","cRLDistributionPoints"),s("2.5.29.26","issuingDistributionPoint"),s("2.5.29.27","deltaCRLIndicator"),s("2.5.29.28","issuingDistributionPoint"),s("2.5.29.29","certificateIssuer"),s("2.5.29.30","nameConstraints"),h("2.5.29.31","cRLDistributionPoints"),h("2.5.29.32","certificatePolicies"),s("2.5.29.33","policyMappings"),s("2.5.29.34","policyConstraints"),h("2.5.29.35","authorityKeyIdentifier"),s("2.5.29.36","policyConstraints"),h("2.5.29.37","extKeyUsage"),s("2.5.29.46","freshestCRL"),s("2.5.29.54","inhibitAnyPolicy"),h("1.3.6.1.4.1.11129.2.4.2","timestampList"),h("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),h("1.3.6.1.5.5.7.3.1","serverAuth"),h("1.3.6.1.5.5.7.3.2","clientAuth"),h("1.3.6.1.5.5.7.3.3","codeSigning"),h("1.3.6.1.5.5.7.3.4","emailProtection"),h("1.3.6.1.5.5.7.3.8","timeStamping")},90317:(re,me,P)=>{var t=P(50276);if(P(39504),P(12746),P(19095),P(8106),P(94037),P(3254),P(2385),P(89356),P(55124),P(15805),P(7619),typeof e>"u")var e=t.jsbn.BigInteger;var h=t.asn1,s=t.pki=t.pki||{};re.exports=s.pbe=t.pbe=t.pbe||{};var E=s.oids,T={name:"EncryptedPrivateKeyInfo",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:h.Class.UNIVERSAL,type:h.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},d={name:"PBES2Algorithms",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:h.Class.UNIVERSAL,type:h.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:h.Class.UNIVERSAL,type:h.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},p={name:"pkcs-12PbeParams",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:h.Class.UNIVERSAL,type:h.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"iterations"}]};s.encryptPrivateKeyInfo=function(x,y,m){m=m||{},m.saltSize=m.saltSize||8,m.count=m.count||2048,m.algorithm=m.algorithm||"aes128",m.prfAlgorithm=m.prfAlgorithm||"sha1";var c=t.random.getBytesSync(m.saltSize),v=m.count,R=h.integerToDer(v),n,f,C;if(m.algorithm.indexOf("aes")===0||m.algorithm==="des"){var B,V,u;switch(m.algorithm){case"aes128":n=16,B=16,V=E["aes128-CBC"],u=t.aes.createEncryptionCipher;break;case"aes192":n=24,B=16,V=E["aes192-CBC"],u=t.aes.createEncryptionCipher;break;case"aes256":n=32,B=16,V=E["aes256-CBC"],u=t.aes.createEncryptionCipher;break;case"des":n=8,B=8,V=E.desCBC,u=t.des.createEncryptionCipher;break;default:var g=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw g.algorithm=m.algorithm,g}var b="hmacWith"+m.prfAlgorithm.toUpperCase(),r=S(b),D=t.pkcs5.pbkdf2(y,c,v,n,r),O=t.random.getBytesSync(B),w=u(D);w.start(O),w.update(h.toDer(x)),w.finish(),C=w.output.getBytes();var H=U(c,R,n,b);f=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(E.pkcs5PBES2).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(E.pkcs5PBKDF2).getBytes()),H]),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(V).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,O)])])])}else if(m.algorithm==="3des"){n=24;var j=new t.util.ByteBuffer(c),D=s.pbe.generatePkcs12Key(y,j,1,v,n),O=s.pbe.generatePkcs12Key(y,j,2,v,n),w=t.des.createEncryptionCipher(D);w.start(O),w.update(h.toDer(x)),w.finish(),C=w.output.getBytes(),f=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(E["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,c),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,R.getBytes())])])}else{var g=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw g.algorithm=m.algorithm,g}var z=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[f,h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,C)]);return z},s.decryptPrivateKeyInfo=function(x,y){var m=null,c={},v=[];if(!h.validate(x,T,c,v)){var R=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw R.errors=v,R}var n=h.derToOid(c.encryptionOid),f=s.pbe.getCipher(n,c.encryptionParams,y),C=t.util.createBuffer(c.encryptedData);return f.update(C),f.finish()&&(m=h.fromDer(f.output)),m},s.encryptedPrivateKeyToPem=function(x,y){var m={type:"ENCRYPTED PRIVATE KEY",body:h.toDer(x).getBytes()};return t.pem.encode(m,{maxline:y})},s.encryptedPrivateKeyFromPem=function(x){var y=t.pem.decode(x)[0];if(y.type!=="ENCRYPTED PRIVATE KEY"){var m=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw m.headerType=y.type,m}if(y.procType&&y.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return h.fromDer(y.body)},s.encryptRsaPrivateKey=function(x,y,m){if(m=m||{},!m.legacy){var c=s.wrapRsaPrivateKey(s.privateKeyToAsn1(x));return c=s.encryptPrivateKeyInfo(c,y,m),s.encryptedPrivateKeyToPem(c)}var v,R,n,f;switch(m.algorithm){case"aes128":v="AES-128-CBC",n=16,R=t.random.getBytesSync(16),f=t.aes.createEncryptionCipher;break;case"aes192":v="AES-192-CBC",n=24,R=t.random.getBytesSync(16),f=t.aes.createEncryptionCipher;break;case"aes256":v="AES-256-CBC",n=32,R=t.random.getBytesSync(16),f=t.aes.createEncryptionCipher;break;case"3des":v="DES-EDE3-CBC",n=24,R=t.random.getBytesSync(8),f=t.des.createEncryptionCipher;break;case"des":v="DES-CBC",n=8,R=t.random.getBytesSync(8),f=t.des.createEncryptionCipher;break;default:var C=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+m.algorithm+'".');throw C.algorithm=m.algorithm,C}var B=t.pbe.opensslDeriveBytes(y,R.substr(0,8),n),V=f(B);V.start(R),V.update(h.toDer(s.privateKeyToAsn1(x))),V.finish();var u={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:v,parameters:t.util.bytesToHex(R).toUpperCase()},body:V.output.getBytes()};return t.pem.encode(u)},s.decryptRsaPrivateKey=function(x,y){var m=null,c=t.pem.decode(x)[0];if(c.type!=="ENCRYPTED PRIVATE KEY"&&c.type!=="PRIVATE KEY"&&c.type!=="RSA PRIVATE KEY"){var v=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw v.headerType=v,v}if(c.procType&&c.procType.type==="ENCRYPTED"){var R,n;switch(c.dekInfo.algorithm){case"DES-CBC":R=8,n=t.des.createDecryptionCipher;break;case"DES-EDE3-CBC":R=24,n=t.des.createDecryptionCipher;break;case"AES-128-CBC":R=16,n=t.aes.createDecryptionCipher;break;case"AES-192-CBC":R=24,n=t.aes.createDecryptionCipher;break;case"AES-256-CBC":R=32,n=t.aes.createDecryptionCipher;break;case"RC2-40-CBC":R=5,n=function(u){return t.rc2.createDecryptionCipher(u,40)};break;case"RC2-64-CBC":R=8,n=function(u){return t.rc2.createDecryptionCipher(u,64)};break;case"RC2-128-CBC":R=16,n=function(u){return t.rc2.createDecryptionCipher(u,128)};break;default:var v=new Error('Could not decrypt private key; unsupported encryption algorithm "'+c.dekInfo.algorithm+'".');throw v.algorithm=c.dekInfo.algorithm,v}var f=t.util.hexToBytes(c.dekInfo.parameters),C=t.pbe.opensslDeriveBytes(y,f.substr(0,8),R),B=n(C);if(B.start(f),B.update(t.util.createBuffer(c.body)),B.finish())m=B.output.getBytes();else return m}else m=c.body;return c.type==="ENCRYPTED PRIVATE KEY"?m=s.decryptPrivateKeyInfo(h.fromDer(m),y):m=h.fromDer(m),m!==null&&(m=s.privateKeyFromAsn1(m)),m},s.pbe.generatePkcs12Key=function(x,y,m,c,v,R){var n,f;if(typeof R>"u"||R===null){if(!("sha1"in t.md))throw new Error('"sha1" hash algorithm unavailable.');R=t.md.sha1.create()}var C=R.digestLength,B=R.blockLength,V=new t.util.ByteBuffer,u=new t.util.ByteBuffer;if(x!=null){for(f=0;f<x.length;f++)u.putInt16(x.charCodeAt(f));u.putInt16(0)}var g=u.length(),b=y.length(),r=new t.util.ByteBuffer;r.fillWithByte(m,B);var D=B*Math.ceil(b/B),O=new t.util.ByteBuffer;for(f=0;f<D;f++)O.putByte(y.at(f%b));var w=B*Math.ceil(g/B),H=new t.util.ByteBuffer;for(f=0;f<w;f++)H.putByte(u.at(f%g));var j=O;j.putBuffer(H);for(var z=Math.ceil(v/C),W=1;W<=z;W++){var X=new t.util.ByteBuffer;X.putBytes(r.bytes()),X.putBytes(j.bytes());for(var J=0;J<c;J++)R.start(),R.update(X.getBytes()),X=R.digest();var te=new t.util.ByteBuffer;for(f=0;f<B;f++)te.putByte(X.at(f%C));var he=Math.ceil(b/B)+Math.ceil(g/B),xe=new t.util.ByteBuffer;for(n=0;n<he;n++){var Se=new t.util.ByteBuffer(j.getBytes(B)),ve=511;for(f=te.length()-1;f>=0;f--)ve=ve>>8,ve+=te.at(f)+Se.at(f),Se.setAt(f,ve&255);xe.putBuffer(Se)}j=xe,V.putBuffer(X)}return V.truncate(V.length()-v),V},s.pbe.getCipher=function(x,y,m){switch(x){case s.oids.pkcs5PBES2:return s.pbe.getCipherForPBES2(x,y,m);case s.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case s.oids["pbewithSHAAnd40BitRC2-CBC"]:return s.pbe.getCipherForPKCS12PBE(x,y,m);default:var c=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw c.oid=x,c.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],c}},s.pbe.getCipherForPBES2=function(x,y,m){var c={},v=[];if(!h.validate(y,d,c,v)){var R=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw R.errors=v,R}if(x=h.derToOid(c.kdfOid),x!==s.oids.pkcs5PBKDF2){var R=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw R.oid=x,R.supportedOids=["pkcs5PBKDF2"],R}if(x=h.derToOid(c.encOid),x!==s.oids["aes128-CBC"]&&x!==s.oids["aes192-CBC"]&&x!==s.oids["aes256-CBC"]&&x!==s.oids["des-EDE3-CBC"]&&x!==s.oids.desCBC){var R=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw R.oid=x,R.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],R}var n=c.kdfSalt,f=t.util.createBuffer(c.kdfIterationCount);f=f.getInt(f.length()<<3);var C,B;switch(s.oids[x]){case"aes128-CBC":C=16,B=t.aes.createDecryptionCipher;break;case"aes192-CBC":C=24,B=t.aes.createDecryptionCipher;break;case"aes256-CBC":C=32,B=t.aes.createDecryptionCipher;break;case"des-EDE3-CBC":C=24,B=t.des.createDecryptionCipher;break;case"desCBC":C=8,B=t.des.createDecryptionCipher;break}var V=o(c.prfOid),u=t.pkcs5.pbkdf2(m,n,f,C,V),g=c.encIv,b=B(u);return b.start(g),b},s.pbe.getCipherForPKCS12PBE=function(x,y,m){var c={},v=[];if(!h.validate(y,p,c,v)){var R=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw R.errors=v,R}var n=t.util.createBuffer(c.salt),f=t.util.createBuffer(c.iterations);f=f.getInt(f.length()<<3);var C,B,V;switch(x){case s.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:C=24,B=8,V=t.des.startDecrypting;break;case s.oids["pbewithSHAAnd40BitRC2-CBC"]:C=5,B=8,V=function(D,O){var w=t.rc2.createDecryptionCipher(D,40);return w.start(O,null),w};break;default:var R=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw R.oid=x,R}var u=o(c.prfOid),g=s.pbe.generatePkcs12Key(m,n,1,f,C,u);u.start();var b=s.pbe.generatePkcs12Key(m,n,2,f,B,u);return V(g,b)},s.pbe.opensslDeriveBytes=function(x,y,m,c){if(typeof c>"u"||c===null){if(!("md5"in t.md))throw new Error('"md5" hash algorithm unavailable.');c=t.md.md5.create()}y===null&&(y="");for(var v=[a(c,x+y)],R=16,n=1;R<m;++n,R+=16)v.push(a(c,v[n-1]+x+y));return v.join("").substr(0,m)};function a(x,y){return x.start().update(y).digest().getBytes()}function o(x){var y;if(!x)y="hmacWithSHA1";else if(y=s.oids[h.derToOid(x)],!y){var m=new Error("Unsupported PRF OID.");throw m.oid=x,m.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],m}return S(y)}function S(x){var y=t.md;switch(x){case"hmacWithSHA224":y=t.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":x=x.substr(8).toLowerCase();break;default:var m=new Error("Unsupported PRF algorithm.");throw m.algorithm=x,m.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],m}if(!y||!(x in y))throw new Error("Unknown hash algorithm: "+x);return y[x].create()}function U(x,y,m,c){var v=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,x),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,y.getBytes())]);return c!=="hmacWithSHA1"&&v.value.push(h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,t.util.hexToBytes(m.toString(16))),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(s.oids[c]).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.NULL,!1,"")])),v}},3254:(re,me,P)=>{var t=P(42363).Buffer,e=P(50276);P(71696),P(8106),P(7619);var h=e.pkcs5=e.pkcs5||{},s;e.util.isNodejs&&!e.options.usePureJavaScript&&(s=P(50310)),re.exports=e.pbkdf2=h.pbkdf2=function(E,T,d,p,a,o){if(typeof a=="function"&&(o=a,a=null),e.util.isNodejs&&!e.options.usePureJavaScript&&s.pbkdf2&&(a===null||typeof a!="object")&&(s.pbkdf2Sync.length>4||!a||a==="sha1"))return typeof a!="string"&&(a="sha1"),E=t.from(E,"binary"),T=t.from(T,"binary"),o?s.pbkdf2Sync.length===4?s.pbkdf2(E,T,d,p,function(u,g){if(u)return o(u);o(null,g.toString("binary"))}):s.pbkdf2(E,T,d,p,a,function(u,g){if(u)return o(u);o(null,g.toString("binary"))}):s.pbkdf2Sync.length===4?s.pbkdf2Sync(E,T,d,p).toString("binary"):s.pbkdf2Sync(E,T,d,p,a).toString("binary");if((typeof a>"u"||a===null)&&(a="sha1"),typeof a=="string"){if(!(a in e.md.algorithms))throw new Error("Unknown hash algorithm: "+a);a=e.md[a].create()}var S=a.digestLength;if(p>4294967295*S){var U=new Error("Derived key is too long.");if(o)return o(U);throw U}var x=Math.ceil(p/S),y=p-(x-1)*S,m=e.hmac.create();m.start(a,E);var c="",v,R,n;if(!o){for(var f=1;f<=x;++f){m.start(null,null),m.update(T),m.update(e.util.int32ToBytes(f)),v=n=m.digest().getBytes();for(var C=2;C<=d;++C)m.start(null,null),m.update(n),R=m.digest().getBytes(),v=e.util.xorBytes(v,R,S),n=R;c+=f<x?v:v.substr(0,y)}return c}var f=1,C;function B(){if(f>x)return o(null,c);m.start(null,null),m.update(T),m.update(e.util.int32ToBytes(f)),v=n=m.digest().getBytes(),C=2,V()}function V(){if(C<=d)return m.start(null,null),m.update(n),R=m.digest().getBytes(),v=e.util.xorBytes(v,R,S),n=R,++C,e.util.setImmediate(V);c+=f<x?v:v.substr(0,y),++f,B()}B()}},2385:(re,me,P)=>{var t=P(50276);P(7619);var e=re.exports=t.pem=t.pem||{};e.encode=function(E,T){T=T||{};var d="-----BEGIN "+E.type+`-----\r
`,p;if(E.procType&&(p={name:"Proc-Type",values:[String(E.procType.version),E.procType.type]},d+=h(p)),E.contentDomain&&(p={name:"Content-Domain",values:[E.contentDomain]},d+=h(p)),E.dekInfo&&(p={name:"DEK-Info",values:[E.dekInfo.algorithm]},E.dekInfo.parameters&&p.values.push(E.dekInfo.parameters),d+=h(p)),E.headers)for(var a=0;a<E.headers.length;++a)d+=h(E.headers[a]);return E.procType&&(d+=`\r
`),d+=t.util.encode64(E.body,T.maxline||64)+`\r
`,d+="-----END "+E.type+`-----\r
`,d},e.decode=function(E){for(var T=[],d=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,p=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,a=/\r?\n/,o;o=d.exec(E),!!o;){var S=o[1];S==="NEW CERTIFICATE REQUEST"&&(S="CERTIFICATE REQUEST");var U={type:S,procType:null,contentDomain:null,dekInfo:null,headers:[],body:t.util.decode64(o[3])};if(T.push(U),!!o[2]){for(var x=o[2].split(a),y=0;o&&y<x.length;){for(var m=x[y].replace(/\s+$/,""),c=y+1;c<x.length;++c){var v=x[c];if(!/\s/.test(v[0]))break;m+=v,y=c}if(o=m.match(p),o){for(var R={name:o[1],values:[]},n=o[2].split(","),f=0;f<n.length;++f)R.values.push(s(n[f]));if(U.procType)if(!U.contentDomain&&R.name==="Content-Domain")U.contentDomain=n[0]||"";else if(!U.dekInfo&&R.name==="DEK-Info"){if(R.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');U.dekInfo={algorithm:n[0],parameters:n[1]||null}}else U.headers.push(R);else{if(R.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(R.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');U.procType={version:n[0],type:n[1]}}}++y}if(U.procType==="ENCRYPTED"&&!U.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(T.length===0)throw new Error("Invalid PEM formatted message.");return T};function h(E){for(var T=E.name+": ",d=[],p=function(x,y){return" "+y},a=0;a<E.values.length;++a)d.push(E.values[a].replace(/^(\S+\r\n)/,p));T+=d.join(",")+`\r
`;for(var o=0,S=-1,a=0;a<T.length;++a,++o)if(o>65&&S!==-1){var U=T[S];U===","?(++S,T=T.substr(0,S)+`\r
 `+T.substr(S)):T=T.substr(0,S)+`\r
`+U+T.substr(S+1),o=a-S-1,S=-1,++a}else(T[a]===" "||T[a]==="	"||T[a]===",")&&(S=a);return T}function s(E){return E.replace(/^\s+/,"")}},47501:(re,me,P)=>{var t=P(50276);P(7619),P(89356),P(21598);var e=re.exports=t.pkcs1=t.pkcs1||{};e.encode_rsa_oaep=function(s,E,T){var d,p,a,o;typeof T=="string"?(d=T,p=arguments[3]||void 0,a=arguments[4]||void 0):T&&(d=T.label||void 0,p=T.seed||void 0,a=T.md||void 0,T.mgf1&&T.mgf1.md&&(o=T.mgf1.md)),a?a.start():a=t.md.sha1.create(),o||(o=a);var S=Math.ceil(s.n.bitLength()/8),U=S-2*a.digestLength-2;if(E.length>U){var x=new Error("RSAES-OAEP input message length is too long.");throw x.length=E.length,x.maxLength=U,x}d||(d=""),a.update(d,"raw");for(var y=a.digest(),m="",c=U-E.length,v=0;v<c;v++)m+="\0";var R=y.getBytes()+m+""+E;if(!p)p=t.random.getBytes(a.digestLength);else if(p.length!==a.digestLength){var x=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw x.seedLength=p.length,x.digestLength=a.digestLength,x}var n=h(p,S-a.digestLength-1,o),f=t.util.xorBytes(R,n,R.length),C=h(f,a.digestLength,o),B=t.util.xorBytes(p,C,p.length);return"\0"+B+f},e.decode_rsa_oaep=function(s,E,T){var d,p,a;typeof T=="string"?(d=T,p=arguments[3]||void 0):T&&(d=T.label||void 0,p=T.md||void 0,T.mgf1&&T.mgf1.md&&(a=T.mgf1.md));var o=Math.ceil(s.n.bitLength()/8);if(E.length!==o){var f=new Error("RSAES-OAEP encoded message length is invalid.");throw f.length=E.length,f.expectedLength=o,f}if(p===void 0?p=t.md.sha1.create():p.start(),a||(a=p),o<2*p.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");d||(d=""),p.update(d,"raw");for(var S=p.digest().getBytes(),U=E.charAt(0),x=E.substring(1,p.digestLength+1),y=E.substring(1+p.digestLength),m=h(y,p.digestLength,a),c=t.util.xorBytes(x,m,x.length),v=h(c,o-p.digestLength-1,a),R=t.util.xorBytes(y,v,y.length),n=R.substring(0,p.digestLength),f=U!=="\0",C=0;C<p.digestLength;++C)f|=S.charAt(C)!==n.charAt(C);for(var B=1,V=p.digestLength,u=p.digestLength;u<R.length;u++){var g=R.charCodeAt(u),b=g&1^1,r=B?65534:0;f|=g&r,B=B&b,V+=B}if(f||R.charCodeAt(V)!==1)throw new Error("Invalid RSAES-OAEP padding.");return R.substring(V+1)};function h(s,E,T){T||(T=t.md.sha1.create());for(var d="",p=Math.ceil(E/T.digestLength),a=0;a<p;++a){var o=String.fromCharCode(a>>24&255,a>>16&255,a>>8&255,a&255);T.start(),T.update(s+o),d+=T.digest().getBytes()}return d.substring(0,E)}},55071:(re,me,P)=>{var t=P(50276);P(12746),P(71696),P(94037),P(39954),P(90317),P(89356),P(15805),P(21598),P(7619),P(66011);var e=t.asn1,h=t.pki,s=re.exports=t.pkcs12=t.pkcs12||{},E={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},T={name:"PFX",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},E,{name:"PFX.macData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},d={name:"SafeBag",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},p={name:"Attribute",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,capture:"values"}]},a={name:"CertBag",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:e.Class.UNIVERSAL,type:e.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function o(c,v,R,n){for(var f=[],C=0;C<c.length;C++)for(var B=0;B<c[C].safeBags.length;B++){var V=c[C].safeBags[B];if(!(n!==void 0&&V.type!==n)){if(v===null){f.push(V);continue}V.attributes[v]!==void 0&&V.attributes[v].indexOf(R)>=0&&f.push(V)}}return f}s.pkcs12FromAsn1=function(c,v,R){typeof v=="string"?(R=v,v=!0):v===void 0&&(v=!0);var n={},f=[];if(!e.validate(c,T,n,f)){var C=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw C.errors=C,C}var B={version:n.version.charCodeAt(0),safeContents:[],getBags:function(j){var z={},W;return"localKeyId"in j?W=j.localKeyId:"localKeyIdHex"in j&&(W=t.util.hexToBytes(j.localKeyIdHex)),W===void 0&&!("friendlyName"in j)&&"bagType"in j&&(z[j.bagType]=o(B.safeContents,null,null,j.bagType)),W!==void 0&&(z.localKeyId=o(B.safeContents,"localKeyId",W,j.bagType)),"friendlyName"in j&&(z.friendlyName=o(B.safeContents,"friendlyName",j.friendlyName,j.bagType)),z},getBagsByFriendlyName:function(j,z){return o(B.safeContents,"friendlyName",j,z)},getBagsByLocalKeyId:function(j,z){return o(B.safeContents,"localKeyId",j,z)}};if(n.version.charCodeAt(0)!==3){var C=new Error("PKCS#12 PFX of version other than 3 not supported.");throw C.version=n.version.charCodeAt(0),C}if(e.derToOid(n.contentType)!==h.oids.data){var C=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw C.oid=e.derToOid(n.contentType),C}var V=n.content.value[0];if(V.tagClass!==e.Class.UNIVERSAL||V.type!==e.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(V=S(V),n.mac){var u=null,g=0,b=e.derToOid(n.macAlgorithm);switch(b){case h.oids.sha1:u=t.md.sha1.create(),g=20;break;case h.oids.sha256:u=t.md.sha256.create(),g=32;break;case h.oids.sha384:u=t.md.sha384.create(),g=48;break;case h.oids.sha512:u=t.md.sha512.create(),g=64;break;case h.oids.md5:u=t.md.md5.create(),g=16;break}if(u===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+b);var r=new t.util.ByteBuffer(n.macSalt),D="macIterations"in n?parseInt(t.util.bytesToHex(n.macIterations),16):1,O=s.generateKey(R,r,3,D,g,u),w=t.hmac.create();w.start(u,O),w.update(V.value);var H=w.getMac();if(H.getBytes()!==n.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return U(B,V.value,v,R),B};function S(c){if(c.composed||c.constructed){for(var v=t.util.createBuffer(),R=0;R<c.value.length;++R)v.putBytes(c.value[R].value);c.composed=c.constructed=!1,c.value=v.getBytes()}return c}function U(c,v,R,n){if(v=e.fromDer(v,R),v.tagClass!==e.Class.UNIVERSAL||v.type!==e.Type.SEQUENCE||v.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var f=0;f<v.value.length;f++){var C=v.value[f],B={},V=[];if(!e.validate(C,E,B,V)){var u=new Error("Cannot read ContentInfo.");throw u.errors=V,u}var g={encrypted:!1},b=null,r=B.content.value[0];switch(e.derToOid(B.contentType)){case h.oids.data:if(r.tagClass!==e.Class.UNIVERSAL||r.type!==e.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");b=S(r).value;break;case h.oids.encryptedData:b=x(r,n),g.encrypted=!0;break;default:var u=new Error("Unsupported PKCS#12 contentType.");throw u.contentType=e.derToOid(B.contentType),u}g.safeBags=y(b,R,n),c.safeContents.push(g)}}function x(c,v){var R={},n=[];if(!e.validate(c,t.pkcs7.asn1.encryptedDataValidator,R,n)){var f=new Error("Cannot read EncryptedContentInfo.");throw f.errors=n,f}var C=e.derToOid(R.contentType);if(C!==h.oids.data){var f=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw f.oid=C,f}C=e.derToOid(R.encAlgorithm);var B=h.pbe.getCipher(C,R.encParameter,v),V=S(R.encryptedContentAsn1),u=t.util.createBuffer(V.value);if(B.update(u),!B.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return B.output.getBytes()}function y(c,v,R){if(!v&&c.length===0)return[];if(c=e.fromDer(c,v),c.tagClass!==e.Class.UNIVERSAL||c.type!==e.Type.SEQUENCE||c.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var n=[],f=0;f<c.value.length;f++){var C=c.value[f],B={},V=[];if(!e.validate(C,d,B,V)){var u=new Error("Cannot read SafeBag.");throw u.errors=V,u}var g={type:e.derToOid(B.bagId),attributes:m(B.bagAttributes)};n.push(g);var b,r,D=B.bagValue.value[0];switch(g.type){case h.oids.pkcs8ShroudedKeyBag:if(D=h.decryptPrivateKeyInfo(D,R),D===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case h.oids.keyBag:try{g.key=h.privateKeyFromAsn1(D)}catch{g.key=null,g.asn1=D}continue;case h.oids.certBag:b=a,r=function(){if(e.derToOid(B.certId)!==h.oids.x509Certificate){var w=new Error("Unsupported certificate type, only X.509 supported.");throw w.oid=e.derToOid(B.certId),w}var H=e.fromDer(B.cert,v);try{g.cert=h.certificateFromAsn1(H,!0)}catch{g.cert=null,g.asn1=H}};break;default:var u=new Error("Unsupported PKCS#12 SafeBag type.");throw u.oid=g.type,u}if(b!==void 0&&!e.validate(D,b,B,V)){var u=new Error("Cannot read PKCS#12 "+b.name);throw u.errors=V,u}r()}return n}function m(c){var v={};if(c!==void 0)for(var R=0;R<c.length;++R){var n={},f=[];if(!e.validate(c[R],p,n,f)){var C=new Error("Cannot read PKCS#12 BagAttribute.");throw C.errors=f,C}var B=e.derToOid(n.oid);if(h.oids[B]!==void 0){v[h.oids[B]]=[];for(var V=0;V<n.values.length;++V)v[h.oids[B]].push(n.values[V].value)}}return v}s.toPkcs12Asn1=function(c,v,R,n){n=n||{},n.saltSize=n.saltSize||8,n.count=n.count||2048,n.algorithm=n.algorithm||n.encAlgorithm||"aes128","useMac"in n||(n.useMac=!0),"localKeyId"in n||(n.localKeyId=null),"generateLocalKeyId"in n||(n.generateLocalKeyId=!0);var f=n.localKeyId,C;if(f!==null)f=t.util.hexToBytes(f);else if(n.generateLocalKeyId)if(v){var B=t.util.isArray(v)?v[0]:v;typeof B=="string"&&(B=h.certificateFromPem(B));var V=t.md.sha1.create();V.update(e.toDer(h.certificateToAsn1(B)).getBytes()),f=V.digest().getBytes()}else f=t.random.getBytes(20);var u=[];f!==null&&u.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.oids.localKeyId).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,f)])])),"friendlyName"in n&&u.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.oids.friendlyName).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.BMPSTRING,!1,n.friendlyName)])])),u.length>0&&(C=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,u));var g=[],b=[];v!==null&&(t.util.isArray(v)?b=v:b=[v]);for(var r=[],D=0;D<b.length;++D){v=b[D],typeof v=="string"&&(v=h.certificateFromPem(v));var O=D===0?C:void 0,w=h.certificateToAsn1(v),H=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.oids.certBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.oids.x509Certificate).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(w).getBytes())])])]),O]);r.push(H)}if(r.length>0){var j=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,r),z=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(j).getBytes())])]);g.push(z)}var W=null;if(c!==null){var X=h.wrapRsaPrivateKey(h.privateKeyToAsn1(c));R===null?W=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.oids.keyBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[X]),C]):W=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.oids.pkcs8ShroudedKeyBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[h.encryptPrivateKeyInfo(X,R,n)]),C]);var J=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[W]),te=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(J).getBytes())])]);g.push(te)}var he=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,g),xe;if(n.useMac){var V=t.md.sha1.create(),Se=new t.util.ByteBuffer(t.random.getBytes(n.saltSize)),ve=n.count,c=s.generateKey(R,Se,3,ve,20),ae=t.hmac.create();ae.start(V,c),ae.update(e.toDer(he).getBytes());var ue=ae.getMac();xe=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.oids.sha1).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,ue.getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,Se.getBytes()),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(ve).getBytes())])}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(3).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(he).getBytes())])]),xe])},s.generateKey=t.pbe.generatePkcs12Key},59343:(re,me,P)=>{var t=P(50276);P(39504),P(12746),P(19095),P(94037),P(2385),P(39954),P(89356),P(7619),P(66011);var e=t.asn1,h=re.exports=t.pkcs7=t.pkcs7||{};h.messageFromPem=function(c){var v=t.pem.decode(c)[0];if(v.type!=="PKCS7"){var R=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw R.headerType=v.type,R}if(v.procType&&v.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var n=e.fromDer(v.body);return h.messageFromAsn1(n)},h.messageToPem=function(c,v){var R={type:"PKCS7",body:e.toDer(c.toAsn1()).getBytes()};return t.pem.encode(R,{maxline:v})},h.messageFromAsn1=function(c){var v={},R=[];if(!e.validate(c,h.asn1.contentInfoValidator,v,R)){var n=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw n.errors=R,n}var f=e.derToOid(v.contentType),C;switch(f){case t.pki.oids.envelopedData:C=h.createEnvelopedData();break;case t.pki.oids.encryptedData:C=h.createEncryptedData();break;case t.pki.oids.signedData:C=h.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+f+" is not (yet) supported.")}return C.fromAsn1(v.content.value[0]),C},h.createSignedData=function(){var c=null;return c={type:t.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(n){if(y(c,n,h.asn1.signedDataValidator),c.certificates=[],c.crls=[],c.digestAlgorithmIdentifiers=[],c.contentInfo=null,c.signerInfos=[],c.rawCapture.certificates)for(var f=c.rawCapture.certificates.value,C=0;C<f.length;++C)c.certificates.push(t.pki.certificateFromAsn1(f[C]))},toAsn1:function(){c.contentInfo||c.sign();for(var n=[],f=0;f<c.certificates.length;++f)n.push(t.pki.certificateToAsn1(c.certificates[f]));var C=[],B=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(c.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,c.digestAlgorithmIdentifiers),c.contentInfo])]);return n.length>0&&B.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,n)),C.length>0&&B.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,C)),B.value[0].value.push(e.create(e.Class.UNIVERSAL,e.Type.SET,!0,c.signerInfos)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(c.type).getBytes()),B])},addSigner:function(n){var f=n.issuer,C=n.serialNumber;if(n.certificate){var B=n.certificate;typeof B=="string"&&(B=t.pki.certificateFromPem(B)),f=B.issuer.attributes,C=B.serialNumber}var V=n.key;if(!V)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof V=="string"&&(V=t.pki.privateKeyFromPem(V));var u=n.digestAlgorithm||t.pki.oids.sha1;switch(u){case t.pki.oids.sha1:case t.pki.oids.sha256:case t.pki.oids.sha384:case t.pki.oids.sha512:case t.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+u)}var g=n.authenticatedAttributes||[];if(g.length>0){for(var b=!1,r=!1,D=0;D<g.length;++D){var O=g[D];if(!b&&O.type===t.pki.oids.contentType){if(b=!0,r)break;continue}if(!r&&O.type===t.pki.oids.messageDigest){if(r=!0,b)break;continue}}if(!b||!r)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}c.signers.push({key:V,version:1,issuer:f,serialNumber:C,digestAlgorithm:u,signatureAlgorithm:t.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:g,unauthenticatedAttributes:[]})},sign:function(n){if(n=n||{},(typeof c.content!="object"||c.contentInfo===null)&&(c.contentInfo=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(t.pki.oids.data).getBytes())]),"content"in c)){var f;c.content instanceof t.util.ByteBuffer?f=c.content.bytes():typeof c.content=="string"&&(f=t.util.encodeUtf8(c.content)),n.detached?c.detachedContent=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,f):c.contentInfo.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,f)]))}if(c.signers.length!==0){var C=v();R(C)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(n){typeof n=="string"&&(n=t.pki.certificateFromPem(n)),c.certificates.push(n)},addCertificateRevokationList:function(n){throw new Error("PKCS#7 CRL support not yet implemented.")}},c;function v(){for(var n={},f=0;f<c.signers.length;++f){var C=c.signers[f],B=C.digestAlgorithm;B in n||(n[B]=t.md[t.pki.oids[B]].create()),C.authenticatedAttributes.length===0?C.md=n[B]:C.md=t.md[t.pki.oids[B]].create()}c.digestAlgorithmIdentifiers=[];for(var B in n)c.digestAlgorithmIdentifiers.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(B).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]));return n}function R(n){var f;if(c.detachedContent?f=c.detachedContent:(f=c.contentInfo.value[1],f=f.value[0]),!f)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var C=e.derToOid(c.contentInfo.value[0].value),B=e.toDer(f);B.getByte(),e.getBerValueLength(B),B=B.getBytes();for(var V in n)n[V].start().update(B);for(var u=new Date,g=0;g<c.signers.length;++g){var b=c.signers[g];if(b.authenticatedAttributes.length===0){if(C!==t.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{b.authenticatedAttributesAsn1=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var r=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[]),D=0;D<b.authenticatedAttributes.length;++D){var O=b.authenticatedAttributes[D];O.type===t.pki.oids.messageDigest?O.value=n[b.digestAlgorithm].digest():O.type===t.pki.oids.signingTime&&(O.value||(O.value=u)),r.value.push(U(O)),b.authenticatedAttributesAsn1.value.push(U(O))}B=e.toDer(r).getBytes(),b.md.start().update(B)}b.signature=b.key.sign(b.md,"RSASSA-PKCS1-V1_5")}c.signerInfos=S(c.signers)}},h.createEncryptedData=function(){var c=null;return c={type:t.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:t.pki.oids["aes256-CBC"]},fromAsn1:function(v){y(c,v,h.asn1.encryptedDataValidator)},decrypt:function(v){v!==void 0&&(c.encryptedContent.key=v),m(c)}},c},h.createEnvelopedData=function(){var c=null;return c={type:t.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:t.pki.oids["aes256-CBC"]},fromAsn1:function(v){var R=y(c,v,h.asn1.envelopedDataValidator);c.recipients=T(R.recipientInfos.value)},toAsn1:function(){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(c.type).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(c.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,d(c.recipients)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,x(c.encryptedContent))])])])},findRecipient:function(v){for(var R=v.issuer.attributes,n=0;n<c.recipients.length;++n){var f=c.recipients[n],C=f.issuer;if(f.serialNumber===v.serialNumber&&C.length===R.length){for(var B=!0,V=0;V<R.length;++V)if(C[V].type!==R[V].type||C[V].value!==R[V].value){B=!1;break}if(B)return f}}return null},decrypt:function(v,R){if(c.encryptedContent.key===void 0&&v!==void 0&&R!==void 0)switch(v.encryptedContent.algorithm){case t.pki.oids.rsaEncryption:case t.pki.oids.desCBC:var n=R.decrypt(v.encryptedContent.content);c.encryptedContent.key=t.util.createBuffer(n);break;default:throw new Error("Unsupported asymmetric cipher, OID "+v.encryptedContent.algorithm)}m(c)},addRecipient:function(v){c.recipients.push({version:0,issuer:v.issuer.attributes,serialNumber:v.serialNumber,encryptedContent:{algorithm:t.pki.oids.rsaEncryption,key:v.publicKey}})},encrypt:function(v,R){if(c.encryptedContent.content===void 0){R=R||c.encryptedContent.algorithm,v=v||c.encryptedContent.key;var n,f,C;switch(R){case t.pki.oids["aes128-CBC"]:n=16,f=16,C=t.aes.createEncryptionCipher;break;case t.pki.oids["aes192-CBC"]:n=24,f=16,C=t.aes.createEncryptionCipher;break;case t.pki.oids["aes256-CBC"]:n=32,f=16,C=t.aes.createEncryptionCipher;break;case t.pki.oids["des-EDE3-CBC"]:n=24,f=8,C=t.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+R)}if(v===void 0)v=t.util.createBuffer(t.random.getBytes(n));else if(v.length()!=n)throw new Error("Symmetric key has wrong length; got "+v.length()+" bytes, expected "+n+".");c.encryptedContent.algorithm=R,c.encryptedContent.key=v,c.encryptedContent.parameter=t.util.createBuffer(t.random.getBytes(f));var B=C(v);if(B.start(c.encryptedContent.parameter.copy()),B.update(c.content),!B.finish())throw new Error("Symmetric encryption failed.");c.encryptedContent.content=B.output}for(var V=0;V<c.recipients.length;++V){var u=c.recipients[V];if(u.encryptedContent.content===void 0)switch(u.encryptedContent.algorithm){case t.pki.oids.rsaEncryption:u.encryptedContent.content=u.encryptedContent.key.encrypt(c.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+u.encryptedContent.algorithm)}}}},c};function s(c){var v={},R=[];if(!e.validate(c,h.asn1.recipientInfoValidator,v,R)){var n=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw n.errors=R,n}return{version:v.version.charCodeAt(0),issuer:t.pki.RDNAttributesAsArray(v.issuer),serialNumber:t.util.createBuffer(v.serial).toHex(),encryptedContent:{algorithm:e.derToOid(v.encAlgorithm),parameter:v.encParameter?v.encParameter.value:void 0,content:v.encKey}}}function E(c){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(c.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[t.pki.distinguishedNameToAsn1({attributes:c.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,t.util.hexToBytes(c.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(c.encryptedContent.algorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,c.encryptedContent.content)])}function T(c){for(var v=[],R=0;R<c.length;++R)v.push(s(c[R]));return v}function d(c){for(var v=[],R=0;R<c.length;++R)v.push(E(c[R]));return v}function p(c){var v={},R=[];if(!e.validate(c,h.asn1.signerInfoValidator,v,R)){var n=new Error("Cannot read PKCS#7 SignerInfo. ASN.1 object is not an PKCS#7 SignerInfo.");throw n.errors=R,n}var f={version:v.version.charCodeAt(0),issuer:t.pki.RDNAttributesAsArray(v.issuer),serialNumber:t.util.createBuffer(v.serial).toHex(),digestAlgorithm:e.derToOid(v.digestAlgorithm),signatureAlgorithm:e.derToOid(v.signatureAlgorithm),signature:v.signature,authenticatedAttributes:[],unauthenticatedAttributes:[]},C=v.authenticatedAttributes||[],B=v.unauthenticatedAttributes||[];return f}function a(c){var v=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(c.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[t.pki.distinguishedNameToAsn1({attributes:c.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,t.util.hexToBytes(c.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(c.digestAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])]);if(c.authenticatedAttributesAsn1&&v.value.push(c.authenticatedAttributesAsn1),v.value.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(c.signatureAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])),v.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,c.signature)),c.unauthenticatedAttributes.length>0){for(var R=e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[]),n=0;n<c.unauthenticatedAttributes.length;++n){var f=c.unauthenticatedAttributes[n];R.values.push(U(f))}v.value.push(R)}return v}function o(c){for(var v=[],R=0;R<c.length;++R)v.push(p(c[R]));return v}function S(c){for(var v=[],R=0;R<c.length;++R)v.push(a(c[R]));return v}function U(c){var v;if(c.type===t.pki.oids.contentType)v=e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(c.value).getBytes());else if(c.type===t.pki.oids.messageDigest)v=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,c.value.bytes());else if(c.type===t.pki.oids.signingTime){var R=new Date("1950-01-01T00:00:00Z"),n=new Date("2050-01-01T00:00:00Z"),f=c.value;if(typeof f=="string"){var C=Date.parse(f);isNaN(C)?f.length===13?f=e.utcTimeToDate(f):f=e.generalizedTimeToDate(f):f=new Date(C)}f>=R&&f<n?v=e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(f)):v=e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(f))}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(c.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[v])])}function x(c){return[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(t.pki.oids.data).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(c.algorithm).getBytes()),c.parameter?e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,c.parameter.getBytes()):void 0]),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,c.content.getBytes())])]}function y(c,v,R){var n={},f=[];if(!e.validate(v,R,n,f)){var C=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw C.errors=C,C}var B=e.derToOid(n.contentType);if(B!==t.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(n.encryptedContent){var V="";if(t.util.isArray(n.encryptedContent))for(var u=0;u<n.encryptedContent.length;++u){if(n.encryptedContent[u].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");V+=n.encryptedContent[u].value}else V=n.encryptedContent;c.encryptedContent={algorithm:e.derToOid(n.encAlgorithm),parameter:t.util.createBuffer(n.encParameter.value),content:t.util.createBuffer(V)}}if(n.content){var V="";if(t.util.isArray(n.content))for(var u=0;u<n.content.length;++u){if(n.content[u].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");V+=n.content[u].value}else V=n.content;c.content=t.util.createBuffer(V)}return c.version=n.version.charCodeAt(0),c.rawCapture=n,n}function m(c){if(c.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(c.content===void 0){var v;switch(c.encryptedContent.algorithm){case t.pki.oids["aes128-CBC"]:case t.pki.oids["aes192-CBC"]:case t.pki.oids["aes256-CBC"]:v=t.aes.createDecryptionCipher(c.encryptedContent.key);break;case t.pki.oids.desCBC:case t.pki.oids["des-EDE3-CBC"]:v=t.des.createDecryptionCipher(c.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+c.encryptedContent.algorithm)}if(v.start(c.encryptedContent.parameter),v.update(c.encryptedContent.content),!v.finish())throw new Error("Symmetric decryption failed.");c.content=v.output}}},39954:(re,me,P)=>{var t=P(50276);P(12746),P(7619);var e=t.asn1,h=re.exports=t.pkcs7asn1=t.pkcs7asn1||{};t.pkcs7=t.pkcs7||{},t.pkcs7.asn1=h;var s={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};h.contentInfoValidator=s;var E={name:"EncryptedContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};h.envelopedDataValidator={name:"EnvelopedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(E)},h.encryptedDataValidator={name:"EncryptedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"}].concat(E)};var T={name:"SignerInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};h.signedDataValidator={name:"SignedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},s,{name:"SignedData.Certificates",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,capture:"signerInfos",optional:!0,value:[T]}]},h.recipientInfoValidator={name:"RecipientInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}},29255:(re,me,P)=>{var t=P(50276);P(12746),P(94037),P(90317),P(2385),P(3254),P(55071),P(51417),P(15805),P(7619),P(66011);var e=t.asn1,h=re.exports=t.pki=t.pki||{};h.pemToDer=function(s){var E=t.pem.decode(s)[0];if(E.procType&&E.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return t.util.createBuffer(E.body)},h.privateKeyFromPem=function(s){var E=t.pem.decode(s)[0];if(E.type!=="PRIVATE KEY"&&E.type!=="RSA PRIVATE KEY"){var T=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw T.headerType=E.type,T}if(E.procType&&E.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var d=e.fromDer(E.body);return h.privateKeyFromAsn1(d)},h.privateKeyToPem=function(s,E){var T={type:"RSA PRIVATE KEY",body:e.toDer(h.privateKeyToAsn1(s)).getBytes()};return t.pem.encode(T,{maxline:E})},h.privateKeyInfoToPem=function(s,E){var T={type:"PRIVATE KEY",body:e.toDer(s).getBytes()};return t.pem.encode(T,{maxline:E})}},10268:(re,me,P)=>{var t=P(50276);P(7619),P(43736),P(89356),function(){if(t.prime){re.exports=t.prime;return}var e=re.exports=t.prime=t.prime||{},h=t.jsbn.BigInteger,s=[6,4,2,4,2,4,6,2],E=new h(null);E.fromInt(30);var T=function(x,y){return x|y};e.generateProbablePrime=function(x,y,m){typeof y=="function"&&(m=y,y={}),y=y||{};var c=y.algorithm||"PRIMEINC";typeof c=="string"&&(c={name:c}),c.options=c.options||{};var v=y.prng||t.random,R={nextBytes:function(n){for(var f=v.getBytesSync(n.length),C=0;C<n.length;++C)n[C]=f.charCodeAt(C)}};if(c.name==="PRIMEINC")return d(x,R,c.options,m);throw new Error("Invalid prime generation algorithm: "+c.name)};function d(x,y,m,c){return"workers"in m?o(x,y,m,c):p(x,y,m,c)}function p(x,y,m,c){var v=S(x,y),R=0,n=U(v.bitLength());"millerRabinTests"in m&&(n=m.millerRabinTests);var f=10;"maxBlockTime"in m&&(f=m.maxBlockTime),a(v,x,y,R,n,f,c)}function a(x,y,m,c,v,R,n){var f=+new Date;do{if(x.bitLength()>y&&(x=S(y,m)),x.isProbablePrime(v))return n(null,x);x.dAddOffset(s[c++%8],0)}while(R<0||+new Date-f<R);t.util.setImmediate(function(){a(x,y,m,c,v,R,n)})}function o(x,y,m,c){if(typeof Worker>"u")return p(x,y,m,c);var v=S(x,y),R=m.workers,n=m.workLoad||100,f=n*30/8,C=m.workerScript||"forge/prime.worker.js";if(R===-1)return t.util.estimateCores(function(V,u){V&&(u=2),R=u-1,B()});B();function B(){R=Math.max(1,R);for(var V=[],u=0;u<R;++u)V[u]=new Worker(C);for(var g=R,u=0;u<R;++u)V[u].addEventListener("message",r);var b=!1;function r(D){if(!b){--g;var O=D.data;if(O.found){for(var w=0;w<V.length;++w)V[w].terminate();return b=!0,c(null,new h(O.prime,16))}v.bitLength()>x&&(v=S(x,y));var H=v.toString(16);D.target.postMessage({hex:H,workLoad:n}),v.dAddOffset(f,0)}}}}function S(x,y){var m=new h(x,y),c=x-1;return m.testBit(c)||m.bitwiseTo(h.ONE.shiftLeft(c),T,m),m.dAddOffset(31-m.mod(E).byteValue(),0),m}function U(x){return x<=100?27:x<=150?18:x<=200?15:x<=250?12:x<=300?9:x<=350?8:x<=400?7:x<=500?6:x<=600?5:x<=800?4:x<=1250?3:2}}()},73878:(re,me,P)=>{var t=P(50276);P(7619);var e=null;t.util.isNodejs&&!t.options.usePureJavaScript&&!process.versions["node-webkit"]&&(e=P(50310));var h=re.exports=t.prng=t.prng||{};h.create=function(s){for(var E={plugin:s,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},T=s.md,d=new Array(32),p=0;p<32;++p)d[p]=T.create();E.pools=d,E.pool=0,E.generate=function(x,y){if(!y)return E.generateSync(x);var m=E.plugin.cipher,c=E.plugin.increment,v=E.plugin.formatKey,R=E.plugin.formatSeed,n=t.util.createBuffer();E.key=null,f();function f(C){if(C)return y(C);if(n.length()>=x)return y(null,n.getBytes(x));if(E.generated>1048575&&(E.key=null),E.key===null)return t.util.nextTick(function(){a(f)});var B=m(E.key,E.seed);E.generated+=B.length,n.putBytes(B),E.key=v(m(E.key,c(E.seed))),E.seed=R(m(E.key,E.seed)),t.util.setImmediate(f)}},E.generateSync=function(x){var y=E.plugin.cipher,m=E.plugin.increment,c=E.plugin.formatKey,v=E.plugin.formatSeed;E.key=null;for(var R=t.util.createBuffer();R.length()<x;){E.generated>1048575&&(E.key=null),E.key===null&&o();var n=y(E.key,E.seed);E.generated+=n.length,R.putBytes(n),E.key=c(y(E.key,m(E.seed))),E.seed=v(y(E.key,E.seed))}return R.getBytes(x)};function a(x){if(E.pools[0].messageLength>=32)return S(),x();var y=32-E.pools[0].messageLength<<5;E.seedFile(y,function(m,c){if(m)return x(m);E.collect(c),S(),x()})}function o(){if(E.pools[0].messageLength>=32)return S();var x=32-E.pools[0].messageLength<<5;E.collect(E.seedFileSync(x)),S()}function S(){E.reseeds=E.reseeds===4294967295?0:E.reseeds+1;var x=E.plugin.md.create();x.update(E.keyBytes);for(var y=1,m=0;m<32;++m)E.reseeds%y===0&&(x.update(E.pools[m].digest().getBytes()),E.pools[m].start()),y=y<<1;E.keyBytes=x.digest().getBytes(),x.start(),x.update(E.keyBytes);var c=x.digest().getBytes();E.key=E.plugin.formatKey(E.keyBytes),E.seed=E.plugin.formatSeed(c),E.generated=0}function U(x){var y=null,m=t.util.globalScope,c=m.crypto||m.msCrypto;c&&c.getRandomValues&&(y=function(g){return c.getRandomValues(g)});var v=t.util.createBuffer();if(y)for(;v.length()<x;){var R=Math.max(1,Math.min(x-v.length(),65536)/4),n=new Uint32Array(Math.floor(R));try{y(n);for(var f=0;f<n.length;++f)v.putInt32(n[f])}catch(g){if(!(typeof QuotaExceededError<"u"&&g instanceof QuotaExceededError))throw g}}if(v.length()<x)for(var C,B,V,u=Math.floor(Math.random()*65536);v.length()<x;){B=16807*(u&65535),C=16807*(u>>16),B+=(C&32767)<<16,B+=C>>15,B=(B&2147483647)+(B>>31),u=B&4294967295;for(var f=0;f<3;++f)V=u>>>(f<<3),V^=Math.floor(Math.random()*256),v.putByte(V&255)}return v.getBytes(x)}return e?(E.seedFile=function(x,y){e.randomBytes(x,function(m,c){if(m)return y(m);y(null,c.toString())})},E.seedFileSync=function(x){return e.randomBytes(x).toString()}):(E.seedFile=function(x,y){try{y(null,U(x))}catch(m){y(m)}},E.seedFileSync=U),E.collect=function(x){for(var y=x.length,m=0;m<y;++m)E.pools[E.pool].update(x.substr(m,1)),E.pool=E.pool===31?0:E.pool+1},E.collectInt=function(x,y){for(var m="",c=0;c<y;c+=8)m+=String.fromCharCode(x>>c&255);E.collect(m)},E.registerWorker=function(x){if(x===self)E.seedFile=function(m,c){function v(R){var n=R.data;n.forge&&n.forge.prng&&(self.removeEventListener("message",v),c(n.forge.prng.err,n.forge.prng.bytes))}self.addEventListener("message",v),self.postMessage({forge:{prng:{needed:m}}})};else{var y=function(m){var c=m.data;c.forge&&c.forge.prng&&E.seedFile(c.forge.prng.needed,function(v,R){x.postMessage({forge:{prng:{err:v,bytes:R}}})})};x.addEventListener("message",y)}},E}},51417:(re,me,P)=>{var t=P(50276);P(89356),P(7619);var e=re.exports=t.pss=t.pss||{};e.create=function(h){arguments.length===3&&(h={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var s=h.md,E=h.mgf,T=s.digestLength,d=h.salt||null;typeof d=="string"&&(d=t.util.createBuffer(d));var p;if("saltLength"in h)p=h.saltLength;else if(d!==null)p=d.length();else throw new Error("Salt length not specified or specific salt not given.");if(d!==null&&d.length()!==p)throw new Error("Given salt length does not match length of given salt.");var a=h.prng||t.random,o={};return o.encode=function(S,U){var x,y=U-1,m=Math.ceil(y/8),c=S.digest().getBytes();if(m<T+p+2)throw new Error("Message is too long to encrypt.");var v;d===null?v=a.getBytesSync(p):v=d.bytes();var R=new t.util.ByteBuffer;R.fillWithByte(0,8),R.putBytes(c),R.putBytes(v),s.start(),s.update(R.getBytes());var n=s.digest().getBytes(),f=new t.util.ByteBuffer;f.fillWithByte(0,m-p-T-2),f.putByte(1),f.putBytes(v);var C=f.getBytes(),B=m-T-1,V=E.generate(n,B),u="";for(x=0;x<B;x++)u+=String.fromCharCode(C.charCodeAt(x)^V.charCodeAt(x));var g=65280>>8*m-y&255;return u=String.fromCharCode(u.charCodeAt(0)&~g)+u.substr(1),u+n+"\xBC"},o.verify=function(S,U,x){var y,m=x-1,c=Math.ceil(m/8);if(U=U.substr(-c),c<T+p+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(U.charCodeAt(c-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var v=c-T-1,R=U.substr(0,v),n=U.substr(v,T),f=65280>>8*c-m&255;if(R.charCodeAt(0)&f)throw new Error("Bits beyond keysize not zero as expected.");var C=E.generate(n,v),B="";for(y=0;y<v;y++)B+=String.fromCharCode(R.charCodeAt(y)^C.charCodeAt(y));B=String.fromCharCode(B.charCodeAt(0)&~f)+B.substr(1);var V=c-T-p-2;for(y=0;y<V;y++)if(B.charCodeAt(y)!==0)throw new Error("Leftmost octets not zero as expected");if(B.charCodeAt(V)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var u=B.substr(-p),g=new t.util.ByteBuffer;g.fillWithByte(0,8),g.putBytes(S),g.putBytes(u),s.start(),s.update(g.getBytes());var b=s.digest().getBytes();return n===b},o}},89356:(re,me,P)=>{var t=P(50276);P(39504),P(30172),P(73878),P(7619),function(){if(t.random&&t.random.getBytes){re.exports=t.random;return}(function(e){var h={},s=new Array(4),E=t.util.createBuffer();h.formatKey=function(x){var y=t.util.createBuffer(x);return x=new Array(4),x[0]=y.getInt32(),x[1]=y.getInt32(),x[2]=y.getInt32(),x[3]=y.getInt32(),t.aes._expandKey(x,!1)},h.formatSeed=function(x){var y=t.util.createBuffer(x);return x=new Array(4),x[0]=y.getInt32(),x[1]=y.getInt32(),x[2]=y.getInt32(),x[3]=y.getInt32(),x},h.cipher=function(x,y){return t.aes._updateBlock(x,y,s,!1),E.putInt32(s[0]),E.putInt32(s[1]),E.putInt32(s[2]),E.putInt32(s[3]),E.getBytes()},h.increment=function(x){return++x[3],x},h.md=t.md.sha256;function T(){var x=t.prng.create(h);return x.getBytes=function(y,m){return x.generate(y,m)},x.getBytesSync=function(y){return x.generate(y)},x}var d=T(),p=null,a=t.util.globalScope,o=a.crypto||a.msCrypto;if(o&&o.getRandomValues&&(p=function(x){return o.getRandomValues(x)}),t.options.usePureJavaScript||!t.util.isNodejs&&!p){if(typeof window>"u"||window.document,d.collectInt(+new Date,32),typeof navigator<"u"){var S="";for(var U in navigator)try{typeof navigator[U]=="string"&&(S+=navigator[U])}catch{}d.collect(S),S=null}e&&(e().mousemove(function(x){d.collectInt(x.clientX,16),d.collectInt(x.clientY,16)}),e().keypress(function(x){d.collectInt(x.charCode,8)}))}if(!t.random)t.random=d;else for(var U in d)t.random[U]=d[U];t.random.createInstance=T,re.exports=t.random})(typeof jQuery<"u"?jQuery:null)}()},55124:(re,me,P)=>{var t=P(50276);P(7619);var e=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],h=[1,2,3,5],s=function(d,p){return d<<p&65535|(d&65535)>>16-p},E=function(d,p){return(d&65535)>>p|d<<16-p&65535};re.exports=t.rc2=t.rc2||{},t.rc2.expandKey=function(d,p){typeof d=="string"&&(d=t.util.createBuffer(d)),p=p||128;var a=d,o=d.length(),S=p,U=Math.ceil(S/8),x=255>>(S&7),y;for(y=o;y<128;y++)a.putByte(e[a.at(y-1)+a.at(y-o)&255]);for(a.setAt(128-U,e[a.at(128-U)&x]),y=127-U;y>=0;y--)a.setAt(y,e[a.at(y+1)^a.at(y+U)]);return a};var T=function(d,p,a){var o=!1,S=null,U=null,x=null,y,m,c,v,R=[];for(d=t.rc2.expandKey(d,p),c=0;c<64;c++)R.push(d.getInt16Le());a?(y=function(C){for(c=0;c<4;c++)C[c]+=R[v]+(C[(c+3)%4]&C[(c+2)%4])+(~C[(c+3)%4]&C[(c+1)%4]),C[c]=s(C[c],h[c]),v++},m=function(C){for(c=0;c<4;c++)C[c]+=R[C[(c+3)%4]&63]}):(y=function(C){for(c=3;c>=0;c--)C[c]=E(C[c],h[c]),C[c]-=R[v]+(C[(c+3)%4]&C[(c+2)%4])+(~C[(c+3)%4]&C[(c+1)%4]),v--},m=function(C){for(c=3;c>=0;c--)C[c]-=R[C[(c+3)%4]&63]});var n=function(C){var B=[];for(c=0;c<4;c++){var V=S.getInt16Le();x!==null&&(a?V^=x.getInt16Le():x.putInt16Le(V)),B.push(V&65535)}v=a?0:63;for(var u=0;u<C.length;u++)for(var g=0;g<C[u][0];g++)C[u][1](B);for(c=0;c<4;c++)x!==null&&(a?x.putInt16Le(B[c]):B[c]^=x.getInt16Le()),U.putInt16Le(B[c])},f=null;return f={start:function(C,B){C&&typeof C=="string"&&(C=t.util.createBuffer(C)),o=!1,S=t.util.createBuffer(),U=B||new t.util.createBuffer,x=C,f.output=U},update:function(C){for(o||S.putBuffer(C);S.length()>=8;)n([[5,y],[1,m],[6,y],[1,m],[5,y]])},finish:function(C){var B=!0;if(a)if(C)B=C(8,S,!a);else{var V=S.length()===8?8:8-S.length();S.fillWithByte(V,V)}if(B&&(o=!0,f.update()),!a&&(B=S.length()===0,B))if(C)B=C(8,U,!a);else{var u=U.length(),g=U.at(u-1);g>u?B=!1:U.truncate(g)}return B}},f};t.rc2.startEncrypting=function(d,p,a){var o=t.rc2.createEncryptionCipher(d,128);return o.start(p,a),o},t.rc2.createEncryptionCipher=function(d,p){return T(d,p,!0)},t.rc2.startDecrypting=function(d,p,a){var o=t.rc2.createDecryptionCipher(d,128);return o.start(p,a),o},t.rc2.createDecryptionCipher=function(d,p){return T(d,p,!1)}},15805:(re,me,P)=>{var t=P(50276);if(P(12746),P(43736),P(94037),P(47501),P(10268),P(89356),P(7619),typeof e>"u")var e=t.jsbn.BigInteger;var h=t.util.isNodejs?P(50310):null,s=t.asn1,E=t.util;t.pki=t.pki||{},re.exports=t.pki.rsa=t.rsa=t.rsa||{};var T=t.pki,d=[6,4,2,4,2,4,6,2],p={name:"PrivateKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},a={name:"RSAPrivateKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},o={name:"RSAPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},S=t.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},U={name:"DigestInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:s.Class.UNIVERSAL,type:s.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},x=function(r){var D;if(r.algorithm in T.oids)D=T.oids[r.algorithm];else{var O=new Error("Unknown message digest algorithm.");throw O.algorithm=r.algorithm,O}var w=s.oidToDer(D).getBytes(),H=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]),j=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]);j.value.push(s.create(s.Class.UNIVERSAL,s.Type.OID,!1,w)),j.value.push(s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,""));var z=s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,r.digest().getBytes());return H.value.push(j),H.value.push(z),s.toDer(H).getBytes()},y=function(r,D,O){if(O)return r.modPow(D.e,D.n);if(!D.p||!D.q)return r.modPow(D.d,D.n);D.dP||(D.dP=D.d.mod(D.p.subtract(e.ONE))),D.dQ||(D.dQ=D.d.mod(D.q.subtract(e.ONE))),D.qInv||(D.qInv=D.q.modInverse(D.p));var w;do w=new e(t.util.bytesToHex(t.random.getBytes(D.n.bitLength()/8)),16);while(w.compareTo(D.n)>=0||!w.gcd(D.n).equals(e.ONE));r=r.multiply(w.modPow(D.e,D.n)).mod(D.n);for(var H=r.mod(D.p).modPow(D.dP,D.p),j=r.mod(D.q).modPow(D.dQ,D.q);H.compareTo(j)<0;)H=H.add(D.p);var z=H.subtract(j).multiply(D.qInv).mod(D.p).multiply(D.q).add(j);return z=z.multiply(w.modInverse(D.n)).mod(D.n),z};T.rsa.encrypt=function(r,D,O){var w=O,H,j=Math.ceil(D.n.bitLength()/8);O!==!1&&O!==!0?(w=O===2,H=m(r,D,O)):(H=t.util.createBuffer(),H.putBytes(r));for(var z=new e(H.toHex(),16),W=y(z,D,w),X=W.toString(16),J=t.util.createBuffer(),te=j-Math.ceil(X.length/2);te>0;)J.putByte(0),--te;return J.putBytes(t.util.hexToBytes(X)),J.getBytes()},T.rsa.decrypt=function(r,D,O,w){var H=Math.ceil(D.n.bitLength()/8);if(r.length!==H){var j=new Error("Encrypted message length is invalid.");throw j.length=r.length,j.expected=H,j}var z=new e(t.util.createBuffer(r).toHex(),16);if(z.compareTo(D.n)>=0)throw new Error("Encrypted message is invalid.");for(var W=y(z,D,O),X=W.toString(16),J=t.util.createBuffer(),te=H-Math.ceil(X.length/2);te>0;)J.putByte(0),--te;return J.putBytes(t.util.hexToBytes(X)),w!==!1?c(J.getBytes(),D,O):J.getBytes()},T.rsa.createKeyPairGenerationState=function(r,D,O){typeof r=="string"&&(r=parseInt(r,10)),r=r||2048,O=O||{};var w=O.prng||t.random,H={nextBytes:function(W){for(var X=w.getBytesSync(W.length),J=0;J<W.length;++J)W[J]=X.charCodeAt(J)}},j=O.algorithm||"PRIMEINC",z;if(j==="PRIMEINC")z={algorithm:j,state:0,bits:r,rng:H,eInt:D||65537,e:new e(null),p:null,q:null,qBits:r>>1,pBits:r-(r>>1),pqState:0,num:null,keys:null},z.e.fromInt(z.eInt);else throw new Error("Invalid key generation algorithm: "+j);return z},T.rsa.stepKeyPairGenerationState=function(r,D){"algorithm"in r||(r.algorithm="PRIMEINC");var O=new e(null);O.fromInt(30);for(var w=0,H=function(he,xe){return he|xe},j=+new Date,z,W=0;r.keys===null&&(D<=0||W<D);){if(r.state===0){var X=r.p===null?r.pBits:r.qBits,J=X-1;r.pqState===0?(r.num=new e(X,r.rng),r.num.testBit(J)||r.num.bitwiseTo(e.ONE.shiftLeft(J),H,r.num),r.num.dAddOffset(31-r.num.mod(O).byteValue(),0),w=0,++r.pqState):r.pqState===1?r.num.bitLength()>X?r.pqState=0:r.num.isProbablePrime(n(r.num.bitLength()))?++r.pqState:r.num.dAddOffset(d[w++%8],0):r.pqState===2?r.pqState=r.num.subtract(e.ONE).gcd(r.e).compareTo(e.ONE)===0?3:0:r.pqState===3&&(r.pqState=0,r.p===null?r.p=r.num:r.q=r.num,r.p!==null&&r.q!==null&&++r.state,r.num=null)}else if(r.state===1)r.p.compareTo(r.q)<0&&(r.num=r.p,r.p=r.q,r.q=r.num),++r.state;else if(r.state===2)r.p1=r.p.subtract(e.ONE),r.q1=r.q.subtract(e.ONE),r.phi=r.p1.multiply(r.q1),++r.state;else if(r.state===3)r.phi.gcd(r.e).compareTo(e.ONE)===0?++r.state:(r.p=null,r.q=null,r.state=0);else if(r.state===4)r.n=r.p.multiply(r.q),r.n.bitLength()===r.bits?++r.state:(r.q=null,r.state=0);else if(r.state===5){var te=r.e.modInverse(r.phi);r.keys={privateKey:T.rsa.setPrivateKey(r.n,r.e,te,r.p,r.q,te.mod(r.p1),te.mod(r.q1),r.q.modInverse(r.p)),publicKey:T.rsa.setPublicKey(r.n,r.e)}}z=+new Date,W+=z-j,j=z}return r.keys!==null},T.rsa.generateKeyPair=function(r,D,O,w){if(arguments.length===1?typeof r=="object"?(O=r,r=void 0):typeof r=="function"&&(w=r,r=void 0):arguments.length===2?typeof r=="number"?typeof D=="function"?(w=D,D=void 0):typeof D!="number"&&(O=D,D=void 0):(O=r,w=D,r=void 0,D=void 0):arguments.length===3&&(typeof D=="number"?typeof O=="function"&&(w=O,O=void 0):(w=O,O=D,D=void 0)),O=O||{},r===void 0&&(r=O.bits||2048),D===void 0&&(D=O.e||65537),!t.options.usePureJavaScript&&!O.prng&&r>=256&&r<=16384&&(D===65537||D===3)){if(w){if(f("generateKeyPair"))return h.generateKeyPair("rsa",{modulusLength:r,publicExponent:D,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(W,X,J){if(W)return w(W);w(null,{privateKey:T.privateKeyFromPem(J),publicKey:T.publicKeyFromPem(X)})});if(C("generateKey")&&C("exportKey"))return E.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:V(D),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(W){return E.globalScope.crypto.subtle.exportKey("pkcs8",W.privateKey)}).then(void 0,function(W){w(W)}).then(function(W){if(W){var X=T.privateKeyFromAsn1(s.fromDer(t.util.createBuffer(W)));w(null,{privateKey:X,publicKey:T.setRsaPublicKey(X.n,X.e)})}});if(B("generateKey")&&B("exportKey")){var H=E.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:V(D),hash:{name:"SHA-256"}},!0,["sign","verify"]);H.oncomplete=function(W){var X=W.target.result,J=E.globalScope.msCrypto.subtle.exportKey("pkcs8",X.privateKey);J.oncomplete=function(te){var he=te.target.result,xe=T.privateKeyFromAsn1(s.fromDer(t.util.createBuffer(he)));w(null,{privateKey:xe,publicKey:T.setRsaPublicKey(xe.n,xe.e)})},J.onerror=function(te){w(te)}},H.onerror=function(W){w(W)};return}}else if(f("generateKeyPairSync")){var j=h.generateKeyPairSync("rsa",{modulusLength:r,publicExponent:D,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:T.privateKeyFromPem(j.privateKey),publicKey:T.publicKeyFromPem(j.publicKey)}}}var z=T.rsa.createKeyPairGenerationState(r,D,O);if(!w)return T.rsa.stepKeyPairGenerationState(z,0),z.keys;v(z,O,w)},T.setRsaPublicKey=T.rsa.setPublicKey=function(r,D){var O={n:r,e:D};return O.encrypt=function(w,H,j){if(typeof H=="string"?H=H.toUpperCase():H===void 0&&(H="RSAES-PKCS1-V1_5"),H==="RSAES-PKCS1-V1_5")H={encode:function(W,X,J){return m(W,X,2).getBytes()}};else if(H==="RSA-OAEP"||H==="RSAES-OAEP")H={encode:function(W,X){return t.pkcs1.encode_rsa_oaep(X,W,j)}};else if(["RAW","NONE","NULL",null].indexOf(H)!==-1)H={encode:function(W){return W}};else if(typeof H=="string")throw new Error('Unsupported encryption scheme: "'+H+'".');var z=H.encode(w,O,!0);return T.rsa.encrypt(z,O,!0)},O.verify=function(w,H,j,z){typeof j=="string"?j=j.toUpperCase():j===void 0&&(j="RSASSA-PKCS1-V1_5"),z===void 0&&(z={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in z||(z._parseAllDigestBytes=!0),j==="RSASSA-PKCS1-V1_5"?j={verify:function(X,J){J=c(J,O,!0);var te=s.fromDer(J,{parseAllBytes:z._parseAllDigestBytes}),he={},xe=[];if(!s.validate(te,U,he,xe)){var Se=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw Se.errors=xe,Se}var ve=s.derToOid(he.algorithmIdentifier);if(!(ve===t.oids.md2||ve===t.oids.md5||ve===t.oids.sha1||ve===t.oids.sha224||ve===t.oids.sha256||ve===t.oids.sha384||ve===t.oids.sha512||ve===t.oids["sha512-224"]||ve===t.oids["sha512-256"])){var Se=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw Se.oid=ve,Se}if((ve===t.oids.md2||ve===t.oids.md5)&&!("parameters"in he))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return X===he.digest}}:(j==="NONE"||j==="NULL"||j===null)&&(j={verify:function(X,J){return J=c(J,O,!0),X===J}});var W=T.rsa.decrypt(H,O,!0,!1);return j.verify(w,W,O.n.bitLength())},O},T.setRsaPrivateKey=T.rsa.setPrivateKey=function(r,D,O,w,H,j,z,W){var X={n:r,e:D,d:O,p:w,q:H,dP:j,dQ:z,qInv:W};return X.decrypt=function(J,te,he){typeof te=="string"?te=te.toUpperCase():te===void 0&&(te="RSAES-PKCS1-V1_5");var xe=T.rsa.decrypt(J,X,!1,!1);if(te==="RSAES-PKCS1-V1_5")te={decode:c};else if(te==="RSA-OAEP"||te==="RSAES-OAEP")te={decode:function(Se,ve){return t.pkcs1.decode_rsa_oaep(ve,Se,he)}};else if(["RAW","NONE","NULL",null].indexOf(te)!==-1)te={decode:function(Se){return Se}};else throw new Error('Unsupported encryption scheme: "'+te+'".');return te.decode(xe,X,!1)},X.sign=function(J,te){var he=!1;typeof te=="string"&&(te=te.toUpperCase()),te===void 0||te==="RSASSA-PKCS1-V1_5"?(te={encode:x},he=1):(te==="NONE"||te==="NULL"||te===null)&&(te={encode:function(){return J}},he=1);var xe=te.encode(J,X.n.bitLength());return T.rsa.encrypt(xe,X,he)},X},T.wrapRsaPrivateKey=function(r){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(0).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(T.oids.rsaEncryption).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")]),s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,s.toDer(r).getBytes())])},T.privateKeyFromAsn1=function(r){var D={},O=[];if(s.validate(r,p,D,O)&&(r=s.fromDer(t.util.createBuffer(D.privateKey))),D={},O=[],!s.validate(r,a,D,O)){var w=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw w.errors=O,w}var H,j,z,W,X,J,te,he;return H=t.util.createBuffer(D.privateKeyModulus).toHex(),j=t.util.createBuffer(D.privateKeyPublicExponent).toHex(),z=t.util.createBuffer(D.privateKeyPrivateExponent).toHex(),W=t.util.createBuffer(D.privateKeyPrime1).toHex(),X=t.util.createBuffer(D.privateKeyPrime2).toHex(),J=t.util.createBuffer(D.privateKeyExponent1).toHex(),te=t.util.createBuffer(D.privateKeyExponent2).toHex(),he=t.util.createBuffer(D.privateKeyCoefficient).toHex(),T.setRsaPrivateKey(new e(H,16),new e(j,16),new e(z,16),new e(W,16),new e(X,16),new e(J,16),new e(te,16),new e(he,16))},T.privateKeyToAsn1=T.privateKeyToRSAPrivateKey=function(r){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(0).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,R(r.n)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,R(r.e)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,R(r.d)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,R(r.p)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,R(r.q)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,R(r.dP)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,R(r.dQ)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,R(r.qInv))])},T.publicKeyFromAsn1=function(r){var D={},O=[];if(s.validate(r,S,D,O)){var w=s.derToOid(D.publicKeyOid);if(w!==T.oids.rsaEncryption){var H=new Error("Cannot read public key. Unknown OID.");throw H.oid=w,H}r=D.rsaPublicKey}if(O=[],!s.validate(r,o,D,O)){var H=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw H.errors=O,H}var j=t.util.createBuffer(D.publicKeyModulus).toHex(),z=t.util.createBuffer(D.publicKeyExponent).toHex();return T.setRsaPublicKey(new e(j,16),new e(z,16))},T.publicKeyToAsn1=T.publicKeyToSubjectPublicKeyInfo=function(r){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(T.oids.rsaEncryption).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")]),s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,!1,[T.publicKeyToRSAPublicKey(r)])])},T.publicKeyToRSAPublicKey=function(r){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,R(r.n)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,R(r.e))])};function m(r,D,O){var w=t.util.createBuffer(),H=Math.ceil(D.n.bitLength()/8);if(r.length>H-11){var j=new Error("Message is too long for PKCS#1 v1.5 padding.");throw j.length=r.length,j.max=H-11,j}w.putByte(0),w.putByte(O);var z=H-3-r.length,W;if(O===0||O===1){W=O===0?0:255;for(var X=0;X<z;++X)w.putByte(W)}else for(;z>0;){for(var J=0,te=t.random.getBytes(z),X=0;X<z;++X)W=te.charCodeAt(X),W===0?++J:w.putByte(W);z=J}return w.putByte(0),w.putBytes(r),w}function c(r,D,O,w){var H=Math.ceil(D.n.bitLength()/8),j=t.util.createBuffer(r),z=j.getByte(),W=j.getByte();if(z!==0||O&&W!==0&&W!==1||!O&&W!=2||O&&W===0&&typeof w>"u")throw new Error("Encryption block is invalid.");var X=0;if(W===0){X=H-3-w;for(var J=0;J<X;++J)if(j.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(W===1)for(X=0;j.length()>1;){if(j.getByte()!==255){--j.read;break}++X}else if(W===2)for(X=0;j.length()>1;){if(j.getByte()===0){--j.read;break}++X}var te=j.getByte();if(te!==0||X!==H-3-j.length())throw new Error("Encryption block is invalid.");return j.getBytes()}function v(r,D,O){typeof D=="function"&&(O=D,D={}),D=D||{};var w={algorithm:{name:D.algorithm||"PRIMEINC",options:{workers:D.workers||2,workLoad:D.workLoad||100,workerScript:D.workerScript}}};"prng"in D&&(w.prng=D.prng),H();function H(){j(r.pBits,function(W,X){if(W)return O(W);if(r.p=X,r.q!==null)return z(W,r.q);j(r.qBits,z)})}function j(W,X){t.prime.generateProbablePrime(W,w,X)}function z(W,X){if(W)return O(W);if(r.q=X,r.p.compareTo(r.q)<0){var J=r.p;r.p=r.q,r.q=J}if(r.p.subtract(e.ONE).gcd(r.e).compareTo(e.ONE)!==0){r.p=null,H();return}if(r.q.subtract(e.ONE).gcd(r.e).compareTo(e.ONE)!==0){r.q=null,j(r.qBits,z);return}if(r.p1=r.p.subtract(e.ONE),r.q1=r.q.subtract(e.ONE),r.phi=r.p1.multiply(r.q1),r.phi.gcd(r.e).compareTo(e.ONE)!==0){r.p=r.q=null,H();return}if(r.n=r.p.multiply(r.q),r.n.bitLength()!==r.bits){r.q=null,j(r.qBits,z);return}var te=r.e.modInverse(r.phi);r.keys={privateKey:T.rsa.setPrivateKey(r.n,r.e,te,r.p,r.q,te.mod(r.p1),te.mod(r.q1),r.q.modInverse(r.p)),publicKey:T.rsa.setPublicKey(r.n,r.e)},O(null,r.keys)}}function R(r){var D=r.toString(16);D[0]>="8"&&(D="00"+D);var O=t.util.hexToBytes(D);return O.length>1&&(O.charCodeAt(0)===0&&!(O.charCodeAt(1)&128)||O.charCodeAt(0)===255&&(O.charCodeAt(1)&128)===128)?O.substr(1):O}function n(r){return r<=100?27:r<=150?18:r<=200?15:r<=250?12:r<=300?9:r<=350?8:r<=400?7:r<=500?6:r<=600?5:r<=800?4:r<=1250?3:2}function f(r){return t.util.isNodejs&&typeof h[r]=="function"}function C(r){return typeof E.globalScope<"u"&&typeof E.globalScope.crypto=="object"&&typeof E.globalScope.crypto.subtle=="object"&&typeof E.globalScope.crypto.subtle[r]=="function"}function B(r){return typeof E.globalScope<"u"&&typeof E.globalScope.msCrypto=="object"&&typeof E.globalScope.msCrypto.subtle=="object"&&typeof E.globalScope.msCrypto.subtle[r]=="function"}function V(r){for(var D=t.util.hexToBytes(r.toString(16)),O=new Uint8Array(D.length),w=0;w<D.length;++w)O[w]=D.charCodeAt(w);return O}function u(r){if(r.kty!=="RSA")throw new Error('Unsupported key algorithm "'+r.kty+'"; algorithm must be "RSA".');return T.setRsaPrivateKey(b(r.n),b(r.e),b(r.d),b(r.p),b(r.q),b(r.dp),b(r.dq),b(r.qi))}function g(r){if(r.kty!=="RSA")throw new Error('Key algorithm must be "RSA".');return T.setRsaPublicKey(b(r.n),b(r.e))}function b(r){return new e(t.util.bytesToHex(t.util.decode64(r)),16)}},21598:(re,me,P)=>{var t=P(50276);P(8106),P(7619);var e=re.exports=t.sha1=t.sha1||{};t.md.sha1=t.md.algorithms.sha1=e,e.create=function(){s||E();var d=null,p=t.util.createBuffer(),a=new Array(80),o={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return o.start=function(){o.messageLength=0,o.fullMessageLength=o.messageLength64=[];for(var S=o.messageLengthSize/4,U=0;U<S;++U)o.fullMessageLength.push(0);return p=t.util.createBuffer(),d={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},o},o.start(),o.update=function(S,U){U==="utf8"&&(S=t.util.encodeUtf8(S));var x=S.length;o.messageLength+=x,x=[x/4294967296>>>0,x>>>0];for(var y=o.fullMessageLength.length-1;y>=0;--y)o.fullMessageLength[y]+=x[1],x[1]=x[0]+(o.fullMessageLength[y]/4294967296>>>0),o.fullMessageLength[y]=o.fullMessageLength[y]>>>0,x[0]=x[1]/4294967296>>>0;return p.putBytes(S),T(d,a,p),(p.read>2048||p.length()===0)&&p.compact(),o},o.digest=function(){var S=t.util.createBuffer();S.putBytes(p.bytes());var U=o.fullMessageLength[o.fullMessageLength.length-1]+o.messageLengthSize,x=U&o.blockLength-1;S.putBytes(h.substr(0,o.blockLength-x));for(var y,m,c=o.fullMessageLength[0]*8,v=0;v<o.fullMessageLength.length-1;++v)y=o.fullMessageLength[v+1]*8,m=y/4294967296>>>0,c+=m,S.putInt32(c>>>0),c=y>>>0;S.putInt32(c);var R={h0:d.h0,h1:d.h1,h2:d.h2,h3:d.h3,h4:d.h4};T(R,a,S);var n=t.util.createBuffer();return n.putInt32(R.h0),n.putInt32(R.h1),n.putInt32(R.h2),n.putInt32(R.h3),n.putInt32(R.h4),n},o};var h=null,s=!1;function E(){h="\x80",h+=t.util.fillString("\0",64),s=!0}function T(d,p,a){for(var o,S,U,x,y,m,c,v,R=a.length();R>=64;){for(S=d.h0,U=d.h1,x=d.h2,y=d.h3,m=d.h4,v=0;v<16;++v)o=a.getInt32(),p[v]=o,c=y^U&(x^y),o=(S<<5|S>>>27)+c+m+1518500249+o,m=y,y=x,x=(U<<30|U>>>2)>>>0,U=S,S=o;for(;v<20;++v)o=p[v-3]^p[v-8]^p[v-14]^p[v-16],o=o<<1|o>>>31,p[v]=o,c=y^U&(x^y),o=(S<<5|S>>>27)+c+m+1518500249+o,m=y,y=x,x=(U<<30|U>>>2)>>>0,U=S,S=o;for(;v<32;++v)o=p[v-3]^p[v-8]^p[v-14]^p[v-16],o=o<<1|o>>>31,p[v]=o,c=U^x^y,o=(S<<5|S>>>27)+c+m+1859775393+o,m=y,y=x,x=(U<<30|U>>>2)>>>0,U=S,S=o;for(;v<40;++v)o=p[v-6]^p[v-16]^p[v-28]^p[v-32],o=o<<2|o>>>30,p[v]=o,c=U^x^y,o=(S<<5|S>>>27)+c+m+1859775393+o,m=y,y=x,x=(U<<30|U>>>2)>>>0,U=S,S=o;for(;v<60;++v)o=p[v-6]^p[v-16]^p[v-28]^p[v-32],o=o<<2|o>>>30,p[v]=o,c=U&x|y&(U^x),o=(S<<5|S>>>27)+c+m+2400959708+o,m=y,y=x,x=(U<<30|U>>>2)>>>0,U=S,S=o;for(;v<80;++v)o=p[v-6]^p[v-16]^p[v-28]^p[v-32],o=o<<2|o>>>30,p[v]=o,c=U^x^y,o=(S<<5|S>>>27)+c+m+3395469782+o,m=y,y=x,x=(U<<30|U>>>2)>>>0,U=S,S=o;d.h0=d.h0+S|0,d.h1=d.h1+U|0,d.h2=d.h2+x|0,d.h3=d.h3+y|0,d.h4=d.h4+m|0,R-=64}}},30172:(re,me,P)=>{var t=P(50276);P(8106),P(7619);var e=re.exports=t.sha256=t.sha256||{};t.md.sha256=t.md.algorithms.sha256=e,e.create=function(){s||T();var p=null,a=t.util.createBuffer(),o=new Array(64),S={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return S.start=function(){S.messageLength=0,S.fullMessageLength=S.messageLength64=[];for(var U=S.messageLengthSize/4,x=0;x<U;++x)S.fullMessageLength.push(0);return a=t.util.createBuffer(),p={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},S},S.start(),S.update=function(U,x){x==="utf8"&&(U=t.util.encodeUtf8(U));var y=U.length;S.messageLength+=y,y=[y/4294967296>>>0,y>>>0];for(var m=S.fullMessageLength.length-1;m>=0;--m)S.fullMessageLength[m]+=y[1],y[1]=y[0]+(S.fullMessageLength[m]/4294967296>>>0),S.fullMessageLength[m]=S.fullMessageLength[m]>>>0,y[0]=y[1]/4294967296>>>0;return a.putBytes(U),d(p,o,a),(a.read>2048||a.length()===0)&&a.compact(),S},S.digest=function(){var U=t.util.createBuffer();U.putBytes(a.bytes());var x=S.fullMessageLength[S.fullMessageLength.length-1]+S.messageLengthSize,y=x&S.blockLength-1;U.putBytes(h.substr(0,S.blockLength-y));for(var m,c,v=S.fullMessageLength[0]*8,R=0;R<S.fullMessageLength.length-1;++R)m=S.fullMessageLength[R+1]*8,c=m/4294967296>>>0,v+=c,U.putInt32(v>>>0),v=m>>>0;U.putInt32(v);var n={h0:p.h0,h1:p.h1,h2:p.h2,h3:p.h3,h4:p.h4,h5:p.h5,h6:p.h6,h7:p.h7};d(n,o,U);var f=t.util.createBuffer();return f.putInt32(n.h0),f.putInt32(n.h1),f.putInt32(n.h2),f.putInt32(n.h3),f.putInt32(n.h4),f.putInt32(n.h5),f.putInt32(n.h6),f.putInt32(n.h7),f},S};var h=null,s=!1,E=null;function T(){h="\x80",h+=t.util.fillString("\0",64),E=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=!0}function d(p,a,o){for(var S,U,x,y,m,c,v,R,n,f,C,B,V,u,g,b=o.length();b>=64;){for(v=0;v<16;++v)a[v]=o.getInt32();for(;v<64;++v)S=a[v-2],S=(S>>>17|S<<15)^(S>>>19|S<<13)^S>>>10,U=a[v-15],U=(U>>>7|U<<25)^(U>>>18|U<<14)^U>>>3,a[v]=S+a[v-7]+U+a[v-16]|0;for(R=p.h0,n=p.h1,f=p.h2,C=p.h3,B=p.h4,V=p.h5,u=p.h6,g=p.h7,v=0;v<64;++v)y=(B>>>6|B<<26)^(B>>>11|B<<21)^(B>>>25|B<<7),m=u^B&(V^u),x=(R>>>2|R<<30)^(R>>>13|R<<19)^(R>>>22|R<<10),c=R&n|f&(R^n),S=g+y+m+E[v]+a[v],U=x+c,g=u,u=V,V=B,B=C+S>>>0,C=f,f=n,n=R,R=S+U>>>0;p.h0=p.h0+R|0,p.h1=p.h1+n|0,p.h2=p.h2+f|0,p.h3=p.h3+C|0,p.h4=p.h4+B|0,p.h5=p.h5+V|0,p.h6=p.h6+u|0,p.h7=p.h7+g|0,b-=64}}},72313:(re,me,P)=>{var t=P(50276);P(8106),P(7619);var e=re.exports=t.sha512=t.sha512||{};t.md.sha512=t.md.algorithms.sha512=e;var h=t.sha384=t.sha512.sha384=t.sha512.sha384||{};h.create=function(){return e.create("SHA-384")},t.md.sha384=t.md.algorithms.sha384=h,t.sha512.sha256=t.sha512.sha256||{create:function(){return e.create("SHA-512/256")}},t.md["sha512/256"]=t.md.algorithms["sha512/256"]=t.sha512.sha256,t.sha512.sha224=t.sha512.sha224||{create:function(){return e.create("SHA-512/224")}},t.md["sha512/224"]=t.md.algorithms["sha512/224"]=t.sha512.sha224,e.create=function(o){if(E||p(),typeof o>"u"&&(o="SHA-512"),!(o in d))throw new Error("Invalid SHA-512 algorithm: "+o);for(var S=d[o],U=null,x=t.util.createBuffer(),y=new Array(80),m=0;m<80;++m)y[m]=new Array(2);var c=64;switch(o){case"SHA-384":c=48;break;case"SHA-512/256":c=32;break;case"SHA-512/224":c=28;break}var v={algorithm:o.replace("-","").toLowerCase(),blockLength:128,digestLength:c,messageLength:0,fullMessageLength:null,messageLengthSize:16};return v.start=function(){v.messageLength=0,v.fullMessageLength=v.messageLength128=[];for(var R=v.messageLengthSize/4,n=0;n<R;++n)v.fullMessageLength.push(0);x=t.util.createBuffer(),U=new Array(S.length);for(var n=0;n<S.length;++n)U[n]=S[n].slice(0);return v},v.start(),v.update=function(R,n){n==="utf8"&&(R=t.util.encodeUtf8(R));var f=R.length;v.messageLength+=f,f=[f/4294967296>>>0,f>>>0];for(var C=v.fullMessageLength.length-1;C>=0;--C)v.fullMessageLength[C]+=f[1],f[1]=f[0]+(v.fullMessageLength[C]/4294967296>>>0),v.fullMessageLength[C]=v.fullMessageLength[C]>>>0,f[0]=f[1]/4294967296>>>0;return x.putBytes(R),a(U,y,x),(x.read>2048||x.length()===0)&&x.compact(),v},v.digest=function(){var R=t.util.createBuffer();R.putBytes(x.bytes());var n=v.fullMessageLength[v.fullMessageLength.length-1]+v.messageLengthSize,f=n&v.blockLength-1;R.putBytes(s.substr(0,v.blockLength-f));for(var C,B,V=v.fullMessageLength[0]*8,u=0;u<v.fullMessageLength.length-1;++u)C=v.fullMessageLength[u+1]*8,B=C/4294967296>>>0,V+=B,R.putInt32(V>>>0),V=C>>>0;R.putInt32(V);for(var g=new Array(U.length),u=0;u<U.length;++u)g[u]=U[u].slice(0);a(g,y,R);var b=t.util.createBuffer(),r;o==="SHA-512"?r=g.length:o==="SHA-384"?r=g.length-2:r=g.length-4;for(var u=0;u<r;++u)b.putInt32(g[u][0]),(u!==r-1||o!=="SHA-512/224")&&b.putInt32(g[u][1]);return b},v};var s=null,E=!1,T=null,d=null;function p(){s="\x80",s+=t.util.fillString("\0",128),T=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],d={},d["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],d["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],d["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],d["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],E=!0}function a(o,S,U){for(var x,y,m,c,v,R,n,f,C,B,V,u,g,b,r,D,O,w,H,j,z,W,X,J,te,he,xe,Se,ve,ae,ue,be,We,Ie,Q,l=U.length();l>=128;){for(ve=0;ve<16;++ve)S[ve][0]=U.getInt32()>>>0,S[ve][1]=U.getInt32()>>>0;for(;ve<80;++ve)be=S[ve-2],ae=be[0],ue=be[1],x=((ae>>>19|ue<<13)^(ue>>>29|ae<<3)^ae>>>6)>>>0,y=((ae<<13|ue>>>19)^(ue<<3|ae>>>29)^(ae<<26|ue>>>6))>>>0,Ie=S[ve-15],ae=Ie[0],ue=Ie[1],m=((ae>>>1|ue<<31)^(ae>>>8|ue<<24)^ae>>>7)>>>0,c=((ae<<31|ue>>>1)^(ae<<24|ue>>>8)^(ae<<25|ue>>>7))>>>0,We=S[ve-7],Q=S[ve-16],ue=y+We[1]+c+Q[1],S[ve][0]=x+We[0]+m+Q[0]+(ue/4294967296>>>0)>>>0,S[ve][1]=ue>>>0;for(g=o[0][0],b=o[0][1],r=o[1][0],D=o[1][1],O=o[2][0],w=o[2][1],H=o[3][0],j=o[3][1],z=o[4][0],W=o[4][1],X=o[5][0],J=o[5][1],te=o[6][0],he=o[6][1],xe=o[7][0],Se=o[7][1],ve=0;ve<80;++ve)n=((z>>>14|W<<18)^(z>>>18|W<<14)^(W>>>9|z<<23))>>>0,f=((z<<18|W>>>14)^(z<<14|W>>>18)^(W<<23|z>>>9))>>>0,C=(te^z&(X^te))>>>0,B=(he^W&(J^he))>>>0,v=((g>>>28|b<<4)^(b>>>2|g<<30)^(b>>>7|g<<25))>>>0,R=((g<<4|b>>>28)^(b<<30|g>>>2)^(b<<25|g>>>7))>>>0,V=(g&r|O&(g^r))>>>0,u=(b&D|w&(b^D))>>>0,ue=Se+f+B+T[ve][1]+S[ve][1],x=xe+n+C+T[ve][0]+S[ve][0]+(ue/4294967296>>>0)>>>0,y=ue>>>0,ue=R+u,m=v+V+(ue/4294967296>>>0)>>>0,c=ue>>>0,xe=te,Se=he,te=X,he=J,X=z,J=W,ue=j+y,z=H+x+(ue/4294967296>>>0)>>>0,W=ue>>>0,H=O,j=w,O=r,w=D,r=g,D=b,ue=y+c,g=x+m+(ue/4294967296>>>0)>>>0,b=ue>>>0;ue=o[0][1]+b,o[0][0]=o[0][0]+g+(ue/4294967296>>>0)>>>0,o[0][1]=ue>>>0,ue=o[1][1]+D,o[1][0]=o[1][0]+r+(ue/4294967296>>>0)>>>0,o[1][1]=ue>>>0,ue=o[2][1]+w,o[2][0]=o[2][0]+O+(ue/4294967296>>>0)>>>0,o[2][1]=ue>>>0,ue=o[3][1]+j,o[3][0]=o[3][0]+H+(ue/4294967296>>>0)>>>0,o[3][1]=ue>>>0,ue=o[4][1]+W,o[4][0]=o[4][0]+z+(ue/4294967296>>>0)>>>0,o[4][1]=ue>>>0,ue=o[5][1]+J,o[5][0]=o[5][0]+X+(ue/4294967296>>>0)>>>0,o[5][1]=ue>>>0,ue=o[6][1]+he,o[6][0]=o[6][0]+te+(ue/4294967296>>>0)>>>0,o[6][1]=ue>>>0,ue=o[7][1]+Se,o[7][0]=o[7][0]+xe+(ue/4294967296>>>0)>>>0,o[7][1]=ue>>>0,l-=128}}},50149:(re,me,P)=>{var t=P(50276);P(39504),P(71696),P(1267),P(21598),P(7619);var e=re.exports=t.ssh=t.ssh||{};e.privateKeyToPutty=function(T,d,p){p=p||"",d=d||"";var a="ssh-rsa",o=d===""?"none":"aes256-cbc",S="PuTTY-User-Key-File-2: "+a+`\r
`;S+="Encryption: "+o+`\r
`,S+="Comment: "+p+`\r
`;var U=t.util.createBuffer();s(U,a),h(U,T.e),h(U,T.n);var x=t.util.encode64(U.bytes(),64),y=Math.floor(x.length/66)+1;S+="Public-Lines: "+y+`\r
`,S+=x;var m=t.util.createBuffer();h(m,T.d),h(m,T.p),h(m,T.q),h(m,T.qInv);var c;if(!d)c=t.util.encode64(m.bytes(),64);else{var v=m.length()+16-1;v-=v%16;var R=E(m.bytes());R.truncate(R.length()-v+m.length()),m.putBuffer(R);var n=t.util.createBuffer();n.putBuffer(E("\0\0\0\0",d)),n.putBuffer(E("\0\0\0",d));var f=t.aes.createEncryptionCipher(n.truncate(8),"CBC");f.start(t.util.createBuffer().fillWithByte(0,16)),f.update(m.copy()),f.finish();var C=f.output;C.truncate(16),c=t.util.encode64(C.bytes(),64)}y=Math.floor(c.length/66)+1,S+=`\r
Private-Lines: `+y+`\r
`,S+=c;var B=E("putty-private-key-file-mac-key",d),V=t.util.createBuffer();s(V,a),s(V,o),s(V,p),V.putInt32(U.length()),V.putBuffer(U),V.putInt32(m.length()),V.putBuffer(m);var u=t.hmac.create();return u.start("sha1",B),u.update(V.bytes()),S+=`\r
Private-MAC: `+u.digest().toHex()+`\r
`,S},e.publicKeyToOpenSSH=function(T,d){var p="ssh-rsa";d=d||"";var a=t.util.createBuffer();return s(a,p),h(a,T.e),h(a,T.n),p+" "+t.util.encode64(a.bytes())+" "+d},e.privateKeyToOpenSSH=function(T,d){return d?t.pki.encryptRsaPrivateKey(T,d,{legacy:!0,algorithm:"aes128"}):t.pki.privateKeyToPem(T)},e.getPublicKeyFingerprint=function(T,d){d=d||{};var p=d.md||t.md.md5.create(),a="ssh-rsa",o=t.util.createBuffer();s(o,a),h(o,T.e),h(o,T.n),p.start(),p.update(o.getBytes());var S=p.digest();if(d.encoding==="hex"){var U=S.toHex();return d.delimiter?U.match(/.{2}/g).join(d.delimiter):U}else{if(d.encoding==="binary")return S.getBytes();if(d.encoding)throw new Error('Unknown encoding "'+d.encoding+'".')}return S};function h(T,d){var p=d.toString(16);p[0]>="8"&&(p="00"+p);var a=t.util.hexToBytes(p);T.putInt32(a.length),T.putBytes(a)}function s(T,d){T.putInt32(d.length),T.putString(d)}function E(){for(var T=t.md.sha1.create(),d=arguments.length,p=0;p<d;++p)T.update(arguments[p]);return T.digest()}},43986:(re,me,P)=>{var t=P(50276);P(12746),P(71696),P(1267),P(2385),P(29255),P(89356),P(21598),P(7619);var e=function(l,L,i,A){var K=t.util.createBuffer(),G=l.length>>1,M=G+(l.length&1),Z=l.substr(0,M),pe=l.substr(G,M),ce=t.util.createBuffer(),$=t.hmac.create();i=L+i;var de=Math.ceil(A/16),ye=Math.ceil(A/20);$.start("MD5",Z);var Be=t.util.createBuffer();ce.putBytes(i);for(var Ce=0;Ce<de;++Ce)$.start(null,null),$.update(ce.getBytes()),ce.putBuffer($.digest()),$.start(null,null),$.update(ce.bytes()+i),Be.putBuffer($.digest());$.start("SHA1",pe);var Ue=t.util.createBuffer();ce.clear(),ce.putBytes(i);for(var Ce=0;Ce<ye;++Ce)$.start(null,null),$.update(ce.getBytes()),ce.putBuffer($.digest()),$.start(null,null),$.update(ce.bytes()+i),Ue.putBuffer($.digest());return K.putBytes(t.util.xorBytes(Be.getBytes(),Ue.getBytes(),A)),K},h=function(l,L,i,A){},s=function(l,L,i){var A=t.hmac.create();A.start("SHA1",l);var K=t.util.createBuffer();return K.putInt32(L[0]),K.putInt32(L[1]),K.putByte(i.type),K.putByte(i.version.major),K.putByte(i.version.minor),K.putInt16(i.length),K.putBytes(i.fragment.bytes()),A.update(K.getBytes()),A.digest().getBytes()},E=function(l,L,i){var A=!1;try{var K=l.deflate(L.fragment.getBytes());L.fragment=t.util.createBuffer(K),L.length=K.length,A=!0}catch{}return A},T=function(l,L,i){var A=!1;try{var K=l.inflate(L.fragment.getBytes());L.fragment=t.util.createBuffer(K),L.length=K.length,A=!0}catch{}return A},d=function(l,L){var i=0;switch(L){case 1:i=l.getByte();break;case 2:i=l.getInt16();break;case 3:i=l.getInt24();break;case 4:i=l.getInt32();break}return t.util.createBuffer(l.getBytes(i))},p=function(l,L,i){l.putInt(i.length(),L<<3),l.putBuffer(i)},a={};a.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}},a.SupportedVersions=[a.Versions.TLS_1_1,a.Versions.TLS_1_0],a.Version=a.SupportedVersions[0],a.MaxFragment=15360,a.ConnectionEnd={server:0,client:1},a.PRFAlgorithm={tls_prf_sha256:0},a.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},a.CipherType={stream:0,block:1,aead:2},a.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},a.CompressionMethod={none:0,deflate:1},a.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},a.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},a.Alert={},a.Alert.Level={warning:1,fatal:2},a.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},a.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},a.CipherSuites={},a.getCipherSuite=function(l){var L=null;for(var i in a.CipherSuites){var A=a.CipherSuites[i];if(A.id[0]===l.charCodeAt(0)&&A.id[1]===l.charCodeAt(1)){L=A;break}}return L},a.handleUnexpected=function(l,L){var i=!l.open&&l.entity===a.ConnectionEnd.client;i||l.error(l,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.unexpected_message}})},a.handleHelloRequest=function(l,L,i){!l.handshaking&&l.handshakes>0&&(a.queue(l,a.createAlert(l,{level:a.Alert.Level.warning,description:a.Alert.Description.no_renegotiation})),a.flush(l)),l.process()},a.parseHelloMessage=function(l,L,i){var A=null,K=l.entity===a.ConnectionEnd.client;if(i<38)l.error(l,{message:K?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}});else{var G=L.fragment,M=G.length();if(A={version:{major:G.getByte(),minor:G.getByte()},random:t.util.createBuffer(G.getBytes(32)),session_id:d(G,1),extensions:[]},K?(A.cipher_suite=G.getBytes(2),A.compression_method=G.getByte()):(A.cipher_suites=d(G,2),A.compression_methods=d(G,1)),M=i-(M-G.length()),M>0){for(var Z=d(G,2);Z.length()>0;)A.extensions.push({type:[Z.getByte(),Z.getByte()],data:d(Z,2)});if(!K)for(var pe=0;pe<A.extensions.length;++pe){var ce=A.extensions[pe];if(ce.type[0]===0&&ce.type[1]===0)for(var $=d(ce.data,2);$.length()>0;){var de=$.getByte();if(de!==0)break;l.session.extensions.server_name.serverNameList.push(d($,2).getBytes())}}}if(l.session.version&&(A.version.major!==l.session.version.major||A.version.minor!==l.session.version.minor))return l.error(l,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.protocol_version}});if(K)l.session.cipherSuite=a.getCipherSuite(A.cipher_suite);else for(var ye=t.util.createBuffer(A.cipher_suites.bytes());ye.length()>0&&(l.session.cipherSuite=a.getCipherSuite(ye.getBytes(2)),l.session.cipherSuite===null););if(l.session.cipherSuite===null)return l.error(l,{message:"No cipher suites in common.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.handshake_failure},cipherSuite:t.util.bytesToHex(A.cipher_suite)});K?l.session.compressionMethod=A.compression_method:l.session.compressionMethod=a.CompressionMethod.none}return A},a.createSecurityParameters=function(l,L){var i=l.entity===a.ConnectionEnd.client,A=L.random.bytes(),K=i?l.session.sp.client_random:A,G=i?A:a.createRandom().getBytes();l.session.sp={entity:l.entity,prf_algorithm:a.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:l.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:K,server_random:G}},a.handleServerHello=function(l,L,i){var A=a.parseHelloMessage(l,L,i);if(!l.fail){if(A.version.minor<=l.version.minor)l.version.minor=A.version.minor;else return l.error(l,{message:"Incompatible TLS version.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.protocol_version}});l.session.version=l.version;var K=A.session_id.bytes();K.length>0&&K===l.session.id?(l.expect=m,l.session.resuming=!0,l.session.sp.server_random=A.random.bytes()):(l.expect=S,l.session.resuming=!1,a.createSecurityParameters(l,A)),l.session.id=K,l.process()}},a.handleClientHello=function(l,L,i){var A=a.parseHelloMessage(l,L,i);if(!l.fail){var K=A.session_id.bytes(),G=null;if(l.sessionCache&&(G=l.sessionCache.getSession(K),G===null?K="":(G.version.major!==A.version.major||G.version.minor>A.version.minor)&&(G=null,K="")),K.length===0&&(K=t.random.getBytes(32)),l.session.id=K,l.session.clientHelloVersion=A.version,l.session.sp={},G)l.version=l.session.version=G.version,l.session.sp=G.sp;else{for(var M,Z=1;Z<a.SupportedVersions.length&&(M=a.SupportedVersions[Z],!(M.minor<=A.version.minor));++Z);l.version={major:M.major,minor:M.minor},l.session.version=l.version}G!==null?(l.expect=V,l.session.resuming=!0,l.session.sp.client_random=A.random.bytes()):(l.expect=l.verifyClient!==!1?f:C,l.session.resuming=!1,a.createSecurityParameters(l,A)),l.open=!0,a.queue(l,a.createRecord(l,{type:a.ContentType.handshake,data:a.createServerHello(l)})),l.session.resuming?(a.queue(l,a.createRecord(l,{type:a.ContentType.change_cipher_spec,data:a.createChangeCipherSpec()})),l.state.pending=a.createConnectionState(l),l.state.current.write=l.state.pending.write,a.queue(l,a.createRecord(l,{type:a.ContentType.handshake,data:a.createFinished(l)}))):(a.queue(l,a.createRecord(l,{type:a.ContentType.handshake,data:a.createCertificate(l)})),l.fail||(a.queue(l,a.createRecord(l,{type:a.ContentType.handshake,data:a.createServerKeyExchange(l)})),l.verifyClient!==!1&&a.queue(l,a.createRecord(l,{type:a.ContentType.handshake,data:a.createCertificateRequest(l)})),a.queue(l,a.createRecord(l,{type:a.ContentType.handshake,data:a.createServerHelloDone(l)})))),a.flush(l),l.process()}},a.handleCertificate=function(l,L,i){if(i<3)return l.error(l,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}});var A=L.fragment,K={certificate_list:d(A,3)},G,M,Z=[];try{for(;K.certificate_list.length()>0;)G=d(K.certificate_list,3),M=t.asn1.fromDer(G),G=t.pki.certificateFromAsn1(M,!0),Z.push(G)}catch(ce){return l.error(l,{message:"Could not parse certificate list.",cause:ce,send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.bad_certificate}})}var pe=l.entity===a.ConnectionEnd.client;(pe||l.verifyClient===!0)&&Z.length===0?l.error(l,{message:pe?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}}):Z.length===0?l.expect=pe?U:C:(pe?l.session.serverCertificate=Z[0]:l.session.clientCertificate=Z[0],a.verifyCertificateChain(l,Z)&&(l.expect=pe?U:C)),l.process()},a.handleServerKeyExchange=function(l,L,i){if(i>0)return l.error(l,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.unsupported_certificate}});l.expect=x,l.process()},a.handleClientKeyExchange=function(l,L,i){if(i<48)return l.error(l,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.unsupported_certificate}});var A=L.fragment,K={enc_pre_master_secret:d(A,2).getBytes()},G=null;if(l.getPrivateKey)try{G=l.getPrivateKey(l,l.session.serverCertificate),G=t.pki.privateKeyFromPem(G)}catch(pe){l.error(l,{message:"Could not get private key.",cause:pe,send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}})}if(G===null)return l.error(l,{message:"No private key set.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}});try{var M=l.session.sp;M.pre_master_secret=G.decrypt(K.enc_pre_master_secret);var Z=l.session.clientHelloVersion;if(Z.major!==M.pre_master_secret.charCodeAt(0)||Z.minor!==M.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{M.pre_master_secret=t.random.getBytes(48)}l.expect=V,l.session.clientCertificate!==null&&(l.expect=B),l.process()},a.handleCertificateRequest=function(l,L,i){if(i<3)return l.error(l,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}});var A=L.fragment,K={certificate_types:d(A,1),certificate_authorities:d(A,2)};l.session.certificateRequest=K,l.expect=y,l.process()},a.handleCertificateVerify=function(l,L,i){if(i<2)return l.error(l,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}});var A=L.fragment;A.read-=4;var K=A.bytes();A.read+=4;var G={signature:d(A,2).getBytes()},M=t.util.createBuffer();M.putBuffer(l.session.md5.digest()),M.putBuffer(l.session.sha1.digest()),M=M.getBytes();try{var Z=l.session.clientCertificate;if(!Z.publicKey.verify(M,G.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");l.session.md5.update(K),l.session.sha1.update(K)}catch{return l.error(l,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.handshake_failure}})}l.expect=V,l.process()},a.handleServerHelloDone=function(l,L,i){if(i>0)return l.error(l,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.record_overflow}});if(l.serverCertificate===null){var A={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.insufficient_security}},K=0,G=l.verify(l,A.alert.description,K,[]);if(G!==!0)return(G||G===0)&&(typeof G=="object"&&!t.util.isArray(G)?(G.message&&(A.message=G.message),G.alert&&(A.alert.description=G.alert)):typeof G=="number"&&(A.alert.description=G)),l.error(l,A)}l.session.certificateRequest!==null&&(L=a.createRecord(l,{type:a.ContentType.handshake,data:a.createCertificate(l)}),a.queue(l,L)),L=a.createRecord(l,{type:a.ContentType.handshake,data:a.createClientKeyExchange(l)}),a.queue(l,L),l.expect=R;var M=function(Z,pe){Z.session.certificateRequest!==null&&Z.session.clientCertificate!==null&&a.queue(Z,a.createRecord(Z,{type:a.ContentType.handshake,data:a.createCertificateVerify(Z,pe)})),a.queue(Z,a.createRecord(Z,{type:a.ContentType.change_cipher_spec,data:a.createChangeCipherSpec()})),Z.state.pending=a.createConnectionState(Z),Z.state.current.write=Z.state.pending.write,a.queue(Z,a.createRecord(Z,{type:a.ContentType.handshake,data:a.createFinished(Z)})),Z.expect=m,a.flush(Z),Z.process()};if(l.session.certificateRequest===null||l.session.clientCertificate===null)return M(l,null);a.getClientSignature(l,M)},a.handleChangeCipherSpec=function(l,L){if(L.fragment.getByte()!==1)return l.error(l,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}});var i=l.entity===a.ConnectionEnd.client;(l.session.resuming&&i||!l.session.resuming&&!i)&&(l.state.pending=a.createConnectionState(l)),l.state.current.read=l.state.pending.read,(!l.session.resuming&&i||l.session.resuming&&!i)&&(l.state.pending=null),l.expect=i?c:u,l.process()},a.handleFinished=function(l,L,i){var A=L.fragment;A.read-=4;var K=A.bytes();A.read+=4;var G=L.fragment.getBytes();A=t.util.createBuffer(),A.putBuffer(l.session.md5.digest()),A.putBuffer(l.session.sha1.digest());var M=l.entity===a.ConnectionEnd.client,Z=M?"server finished":"client finished",pe=l.session.sp,ce=12,$=e;if(A=$(pe.master_secret,Z,A.getBytes(),ce),A.getBytes()!==G)return l.error(l,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.decrypt_error}});l.session.md5.update(K),l.session.sha1.update(K),(l.session.resuming&&M||!l.session.resuming&&!M)&&(a.queue(l,a.createRecord(l,{type:a.ContentType.change_cipher_spec,data:a.createChangeCipherSpec()})),l.state.current.write=l.state.pending.write,l.state.pending=null,a.queue(l,a.createRecord(l,{type:a.ContentType.handshake,data:a.createFinished(l)}))),l.expect=M?v:g,l.handshaking=!1,++l.handshakes,l.peerCertificate=M?l.session.serverCertificate:l.session.clientCertificate,a.flush(l),l.isConnected=!0,l.connected(l),l.process()},a.handleAlert=function(l,L){var i=L.fragment,A={level:i.getByte(),description:i.getByte()},K;switch(A.description){case a.Alert.Description.close_notify:K="Connection closed.";break;case a.Alert.Description.unexpected_message:K="Unexpected message.";break;case a.Alert.Description.bad_record_mac:K="Bad record MAC.";break;case a.Alert.Description.decryption_failed:K="Decryption failed.";break;case a.Alert.Description.record_overflow:K="Record overflow.";break;case a.Alert.Description.decompression_failure:K="Decompression failed.";break;case a.Alert.Description.handshake_failure:K="Handshake failure.";break;case a.Alert.Description.bad_certificate:K="Bad certificate.";break;case a.Alert.Description.unsupported_certificate:K="Unsupported certificate.";break;case a.Alert.Description.certificate_revoked:K="Certificate revoked.";break;case a.Alert.Description.certificate_expired:K="Certificate expired.";break;case a.Alert.Description.certificate_unknown:K="Certificate unknown.";break;case a.Alert.Description.illegal_parameter:K="Illegal parameter.";break;case a.Alert.Description.unknown_ca:K="Unknown certificate authority.";break;case a.Alert.Description.access_denied:K="Access denied.";break;case a.Alert.Description.decode_error:K="Decode error.";break;case a.Alert.Description.decrypt_error:K="Decrypt error.";break;case a.Alert.Description.export_restriction:K="Export restriction.";break;case a.Alert.Description.protocol_version:K="Unsupported protocol version.";break;case a.Alert.Description.insufficient_security:K="Insufficient security.";break;case a.Alert.Description.internal_error:K="Internal error.";break;case a.Alert.Description.user_canceled:K="User canceled.";break;case a.Alert.Description.no_renegotiation:K="Renegotiation not supported.";break;default:K="Unknown error.";break}if(A.description===a.Alert.Description.close_notify)return l.close();l.error(l,{message:K,send:!1,origin:l.entity===a.ConnectionEnd.client?"server":"client",alert:A}),l.process()},a.handleHandshake=function(l,L){var i=L.fragment,A=i.getByte(),K=i.getInt24();if(K>i.length())return l.fragmented=L,L.fragment=t.util.createBuffer(),i.read-=4,l.process();l.fragmented=null,i.read-=4;var G=i.bytes(K+4);i.read+=4,A in ve[l.entity][l.expect]?(l.entity===a.ConnectionEnd.server&&!l.open&&!l.fail&&(l.handshaking=!0,l.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:t.md.md5.create(),sha1:t.md.sha1.create()}),A!==a.HandshakeType.hello_request&&A!==a.HandshakeType.certificate_verify&&A!==a.HandshakeType.finished&&(l.session.md5.update(G),l.session.sha1.update(G)),ve[l.entity][l.expect][A](l,L,K)):a.handleUnexpected(l,L)},a.handleApplicationData=function(l,L){l.data.putBuffer(L.fragment),l.dataReady(l),l.process()},a.handleHeartbeat=function(l,L){var i=L.fragment,A=i.getByte(),K=i.getInt16(),G=i.getBytes(K);if(A===a.HeartbeatMessageType.heartbeat_request){if(l.handshaking||K>G.length)return l.process();a.queue(l,a.createRecord(l,{type:a.ContentType.heartbeat,data:a.createHeartbeat(a.HeartbeatMessageType.heartbeat_response,G)})),a.flush(l)}else if(A===a.HeartbeatMessageType.heartbeat_response){if(G!==l.expectedHeartbeatPayload)return l.process();l.heartbeatReceived&&l.heartbeatReceived(l,t.util.createBuffer(G))}l.process()};var o=0,S=1,U=2,x=3,y=4,m=5,c=6,v=7,R=8,n=0,f=1,C=2,B=3,V=4,u=5,g=6,b=7,r=a.handleUnexpected,D=a.handleChangeCipherSpec,O=a.handleAlert,w=a.handleHandshake,H=a.handleApplicationData,j=a.handleHeartbeat,z=[];z[a.ConnectionEnd.client]=[[r,O,w,r,j],[r,O,w,r,j],[r,O,w,r,j],[r,O,w,r,j],[r,O,w,r,j],[D,O,r,r,j],[r,O,w,r,j],[r,O,w,H,j],[r,O,w,r,j]],z[a.ConnectionEnd.server]=[[r,O,w,r,j],[r,O,w,r,j],[r,O,w,r,j],[r,O,w,r,j],[D,O,r,r,j],[r,O,w,r,j],[r,O,w,H,j],[r,O,w,r,j]];var W=a.handleHelloRequest,X=a.handleServerHello,J=a.handleCertificate,te=a.handleServerKeyExchange,he=a.handleCertificateRequest,xe=a.handleServerHelloDone,Se=a.handleFinished,ve=[];ve[a.ConnectionEnd.client]=[[r,r,X,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[W,r,r,r,r,r,r,r,r,r,r,J,te,he,xe,r,r,r,r,r,r],[W,r,r,r,r,r,r,r,r,r,r,r,te,he,xe,r,r,r,r,r,r],[W,r,r,r,r,r,r,r,r,r,r,r,r,he,xe,r,r,r,r,r,r],[W,r,r,r,r,r,r,r,r,r,r,r,r,r,xe,r,r,r,r,r,r],[W,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[W,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,Se],[W,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[W,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r]];var ae=a.handleClientHello,ue=a.handleClientKeyExchange,be=a.handleCertificateVerify;ve[a.ConnectionEnd.server]=[[r,ae,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,J,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,ue,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,be,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,Se],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r]],a.generateKeys=function(l,L){var i=e,A=L.client_random+L.server_random;l.session.resuming||(L.master_secret=i(L.pre_master_secret,"master secret",A,48).bytes(),L.pre_master_secret=null),A=L.server_random+L.client_random;var K=2*L.mac_key_length+2*L.enc_key_length,G=l.version.major===a.Versions.TLS_1_0.major&&l.version.minor===a.Versions.TLS_1_0.minor;G&&(K+=2*L.fixed_iv_length);var M=i(L.master_secret,"key expansion",A,K),Z={client_write_MAC_key:M.getBytes(L.mac_key_length),server_write_MAC_key:M.getBytes(L.mac_key_length),client_write_key:M.getBytes(L.enc_key_length),server_write_key:M.getBytes(L.enc_key_length)};return G&&(Z.client_write_IV=M.getBytes(L.fixed_iv_length),Z.server_write_IV=M.getBytes(L.fixed_iv_length)),Z},a.createConnectionState=function(l){var L=l.entity===a.ConnectionEnd.client,i=function(){var G={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(M){return!0},compressionState:null,compressFunction:function(M){return!0},updateSequenceNumber:function(){G.sequenceNumber[1]===4294967295?(G.sequenceNumber[1]=0,++G.sequenceNumber[0]):++G.sequenceNumber[1]}};return G},A={read:i(),write:i()};if(A.read.update=function(G,M){return A.read.cipherFunction(M,A.read)?A.read.compressFunction(G,M,A.read)||G.error(G,{message:"Could not decompress record.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.decompression_failure}}):G.error(G,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.bad_record_mac}}),!G.fail},A.write.update=function(G,M){return A.write.compressFunction(G,M,A.write)?A.write.cipherFunction(M,A.write)||G.error(G,{message:"Could not encrypt record.",send:!1,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}}):G.error(G,{message:"Could not compress record.",send:!1,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}}),!G.fail},l.session){var K=l.session.sp;switch(l.session.cipherSuite.initSecurityParameters(K),K.keys=a.generateKeys(l,K),A.read.macKey=L?K.keys.server_write_MAC_key:K.keys.client_write_MAC_key,A.write.macKey=L?K.keys.client_write_MAC_key:K.keys.server_write_MAC_key,l.session.cipherSuite.initConnectionState(A,l,K),K.compression_algorithm){case a.CompressionMethod.none:break;case a.CompressionMethod.deflate:A.read.compressFunction=T,A.write.compressFunction=E;break;default:throw new Error("Unsupported compression algorithm.")}}return A},a.createRandom=function(){var l=new Date,L=+l+l.getTimezoneOffset()*6e4,i=t.util.createBuffer();return i.putInt32(L),i.putBytes(t.random.getBytes(28)),i},a.createRecord=function(l,L){if(!L.data)return null;var i={type:L.type,version:{major:l.version.major,minor:l.version.minor},length:L.data.length(),fragment:L.data};return i},a.createAlert=function(l,L){var i=t.util.createBuffer();return i.putByte(L.level),i.putByte(L.description),a.createRecord(l,{type:a.ContentType.alert,data:i})},a.createClientHello=function(l){l.session.clientHelloVersion={major:l.version.major,minor:l.version.minor};for(var L=t.util.createBuffer(),i=0;i<l.cipherSuites.length;++i){var A=l.cipherSuites[i];L.putByte(A.id[0]),L.putByte(A.id[1])}var K=L.length(),G=t.util.createBuffer();G.putByte(a.CompressionMethod.none);var M=G.length(),Z=t.util.createBuffer();if(l.virtualHost){var pe=t.util.createBuffer();pe.putByte(0),pe.putByte(0);var ce=t.util.createBuffer();ce.putByte(0),p(ce,2,t.util.createBuffer(l.virtualHost));var $=t.util.createBuffer();p($,2,ce),p(pe,2,$),Z.putBuffer(pe)}var de=Z.length();de>0&&(de+=2);var ye=l.session.id,Be=ye.length+1+2+4+28+2+K+1+M+de,Ce=t.util.createBuffer();return Ce.putByte(a.HandshakeType.client_hello),Ce.putInt24(Be),Ce.putByte(l.version.major),Ce.putByte(l.version.minor),Ce.putBytes(l.session.sp.client_random),p(Ce,1,t.util.createBuffer(ye)),p(Ce,2,L),p(Ce,1,G),de>0&&p(Ce,2,Z),Ce},a.createServerHello=function(l){var L=l.session.id,i=L.length+1+2+4+28+2+1,A=t.util.createBuffer();return A.putByte(a.HandshakeType.server_hello),A.putInt24(i),A.putByte(l.version.major),A.putByte(l.version.minor),A.putBytes(l.session.sp.server_random),p(A,1,t.util.createBuffer(L)),A.putByte(l.session.cipherSuite.id[0]),A.putByte(l.session.cipherSuite.id[1]),A.putByte(l.session.compressionMethod),A},a.createCertificate=function(l){var L=l.entity===a.ConnectionEnd.client,i=null;if(l.getCertificate){var A;L?A=l.session.certificateRequest:A=l.session.extensions.server_name.serverNameList,i=l.getCertificate(l,A)}var K=t.util.createBuffer();if(i!==null)try{t.util.isArray(i)||(i=[i]);for(var G=null,M=0;M<i.length;++M){var Z=t.pem.decode(i[M])[0];if(Z.type!=="CERTIFICATE"&&Z.type!=="X509 CERTIFICATE"&&Z.type!=="TRUSTED CERTIFICATE"){var pe=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw pe.headerType=Z.type,pe}if(Z.procType&&Z.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var ce=t.util.createBuffer(Z.body);G===null&&(G=t.asn1.fromDer(ce.bytes(),!1));var $=t.util.createBuffer();p($,3,ce),K.putBuffer($)}i=t.pki.certificateFromAsn1(G),L?l.session.clientCertificate=i:l.session.serverCertificate=i}catch(Be){return l.error(l,{message:"Could not send certificate list.",cause:Be,send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.bad_certificate}})}var de=3+K.length(),ye=t.util.createBuffer();return ye.putByte(a.HandshakeType.certificate),ye.putInt24(de),p(ye,3,K),ye},a.createClientKeyExchange=function(l){var L=t.util.createBuffer();L.putByte(l.session.clientHelloVersion.major),L.putByte(l.session.clientHelloVersion.minor),L.putBytes(t.random.getBytes(46));var i=l.session.sp;i.pre_master_secret=L.getBytes();var A=l.session.serverCertificate.publicKey;L=A.encrypt(i.pre_master_secret);var K=L.length+2,G=t.util.createBuffer();return G.putByte(a.HandshakeType.client_key_exchange),G.putInt24(K),G.putInt16(L.length),G.putBytes(L),G},a.createServerKeyExchange=function(l){var L=0,i=t.util.createBuffer();return L>0&&(i.putByte(a.HandshakeType.server_key_exchange),i.putInt24(L)),i},a.getClientSignature=function(l,L){var i=t.util.createBuffer();i.putBuffer(l.session.md5.digest()),i.putBuffer(l.session.sha1.digest()),i=i.getBytes(),l.getSignature=l.getSignature||function(A,K,G){var M=null;if(A.getPrivateKey)try{M=A.getPrivateKey(A,A.session.clientCertificate),M=t.pki.privateKeyFromPem(M)}catch(Z){A.error(A,{message:"Could not get private key.",cause:Z,send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}})}M===null?A.error(A,{message:"No private key set.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}}):K=M.sign(K,null),G(A,K)},l.getSignature(l,i,L)},a.createCertificateVerify=function(l,L){var i=L.length+2,A=t.util.createBuffer();return A.putByte(a.HandshakeType.certificate_verify),A.putInt24(i),A.putInt16(L.length),A.putBytes(L),A},a.createCertificateRequest=function(l){var L=t.util.createBuffer();L.putByte(1);var i=t.util.createBuffer();for(var A in l.caStore.certs){var K=l.caStore.certs[A],G=t.pki.distinguishedNameToAsn1(K.subject),M=t.asn1.toDer(G);i.putInt16(M.length()),i.putBuffer(M)}var Z=1+L.length()+2+i.length(),pe=t.util.createBuffer();return pe.putByte(a.HandshakeType.certificate_request),pe.putInt24(Z),p(pe,1,L),p(pe,2,i),pe},a.createServerHelloDone=function(l){var L=t.util.createBuffer();return L.putByte(a.HandshakeType.server_hello_done),L.putInt24(0),L},a.createChangeCipherSpec=function(){var l=t.util.createBuffer();return l.putByte(1),l},a.createFinished=function(l){var L=t.util.createBuffer();L.putBuffer(l.session.md5.digest()),L.putBuffer(l.session.sha1.digest());var i=l.entity===a.ConnectionEnd.client,A=l.session.sp,K=12,G=e,M=i?"client finished":"server finished";L=G(A.master_secret,M,L.getBytes(),K);var Z=t.util.createBuffer();return Z.putByte(a.HandshakeType.finished),Z.putInt24(L.length()),Z.putBuffer(L),Z},a.createHeartbeat=function(l,L,i){typeof i>"u"&&(i=L.length);var A=t.util.createBuffer();A.putByte(l),A.putInt16(i),A.putBytes(L);var K=A.length(),G=Math.max(16,K-i-3);return A.putBytes(t.random.getBytes(G)),A},a.queue=function(l,L){if(L&&!(L.fragment.length()===0&&(L.type===a.ContentType.handshake||L.type===a.ContentType.alert||L.type===a.ContentType.change_cipher_spec))){if(L.type===a.ContentType.handshake){var i=L.fragment.bytes();l.session.md5.update(i),l.session.sha1.update(i),i=null}var A;if(L.fragment.length()<=a.MaxFragment)A=[L];else{A=[];for(var K=L.fragment.bytes();K.length>a.MaxFragment;)A.push(a.createRecord(l,{type:L.type,data:t.util.createBuffer(K.slice(0,a.MaxFragment))})),K=K.slice(a.MaxFragment);K.length>0&&A.push(a.createRecord(l,{type:L.type,data:t.util.createBuffer(K)}))}for(var G=0;G<A.length&&!l.fail;++G){var M=A[G],Z=l.state.current.write;Z.update(l,M)&&l.records.push(M)}}},a.flush=function(l){for(var L=0;L<l.records.length;++L){var i=l.records[L];l.tlsData.putByte(i.type),l.tlsData.putByte(i.version.major),l.tlsData.putByte(i.version.minor),l.tlsData.putInt16(i.fragment.length()),l.tlsData.putBuffer(l.records[L].fragment)}return l.records=[],l.tlsDataReady(l)};var We=function(l){switch(l){case!0:return!0;case t.pki.certificateError.bad_certificate:return a.Alert.Description.bad_certificate;case t.pki.certificateError.unsupported_certificate:return a.Alert.Description.unsupported_certificate;case t.pki.certificateError.certificate_revoked:return a.Alert.Description.certificate_revoked;case t.pki.certificateError.certificate_expired:return a.Alert.Description.certificate_expired;case t.pki.certificateError.certificate_unknown:return a.Alert.Description.certificate_unknown;case t.pki.certificateError.unknown_ca:return a.Alert.Description.unknown_ca;default:return a.Alert.Description.bad_certificate}},Ie=function(l){switch(l){case!0:return!0;case a.Alert.Description.bad_certificate:return t.pki.certificateError.bad_certificate;case a.Alert.Description.unsupported_certificate:return t.pki.certificateError.unsupported_certificate;case a.Alert.Description.certificate_revoked:return t.pki.certificateError.certificate_revoked;case a.Alert.Description.certificate_expired:return t.pki.certificateError.certificate_expired;case a.Alert.Description.certificate_unknown:return t.pki.certificateError.certificate_unknown;case a.Alert.Description.unknown_ca:return t.pki.certificateError.unknown_ca;default:return t.pki.certificateError.bad_certificate}};a.verifyCertificateChain=function(l,L){try{var i={};for(var A in l.verifyOptions)i[A]=l.verifyOptions[A];i.verify=function(G,M,Z){var pe=We(G),ce=l.verify(l,G,M,Z);if(ce!==!0){if(typeof ce=="object"&&!t.util.isArray(ce)){var $=new Error("The application rejected the certificate.");throw $.send=!0,$.alert={level:a.Alert.Level.fatal,description:a.Alert.Description.bad_certificate},ce.message&&($.message=ce.message),ce.alert&&($.alert.description=ce.alert),$}ce!==G&&(ce=Ie(ce))}return ce},t.pki.verifyCertificateChain(l.caStore,L,i)}catch(G){var K=G;(typeof K!="object"||t.util.isArray(K))&&(K={send:!0,alert:{level:a.Alert.Level.fatal,description:We(G)}}),"send"in K||(K.send=!0),"alert"in K||(K.alert={level:a.Alert.Level.fatal,description:We(K.error)}),l.error(l,K)}return!l.fail},a.createSessionCache=function(l,L){var i=null;if(l&&l.getSession&&l.setSession&&l.order)i=l;else{i={},i.cache=l||{},i.capacity=Math.max(L||100,1),i.order=[];for(var A in l)i.order.length<=L?i.order.push(A):delete l[A];i.getSession=function(K){var G=null,M=null;if(K?M=t.util.bytesToHex(K):i.order.length>0&&(M=i.order[0]),M!==null&&M in i.cache){G=i.cache[M],delete i.cache[M];for(var Z in i.order)if(i.order[Z]===M){i.order.splice(Z,1);break}}return G},i.setSession=function(K,G){if(i.order.length===i.capacity){var M=i.order.shift();delete i.cache[M]}var M=t.util.bytesToHex(K);i.order.push(M),i.cache[M]=G}}return i},a.createConnection=function(l){var L=null;l.caStore?t.util.isArray(l.caStore)?L=t.pki.createCaStore(l.caStore):L=l.caStore:L=t.pki.createCaStore();var i=l.cipherSuites||null;if(i===null){i=[];for(var A in a.CipherSuites)i.push(a.CipherSuites[A])}var K=l.server?a.ConnectionEnd.server:a.ConnectionEnd.client,G=l.sessionCache?a.createSessionCache(l.sessionCache):null,M={version:{major:a.Version.major,minor:a.Version.minor},entity:K,sessionId:l.sessionId,caStore:L,sessionCache:G,cipherSuites:i,connected:l.connected,virtualHost:l.virtualHost||null,verifyClient:l.verifyClient||!1,verify:l.verify||function($,de,ye,Be){return de},verifyOptions:l.verifyOptions||{},getCertificate:l.getCertificate||null,getPrivateKey:l.getPrivateKey||null,getSignature:l.getSignature||null,input:t.util.createBuffer(),tlsData:t.util.createBuffer(),data:t.util.createBuffer(),tlsDataReady:l.tlsDataReady,dataReady:l.dataReady,heartbeatReceived:l.heartbeatReceived,closed:l.closed,error:function($,de){de.origin=de.origin||($.entity===a.ConnectionEnd.client?"client":"server"),de.send&&(a.queue($,a.createAlert($,de.alert)),a.flush($));var ye=de.fatal!==!1;ye&&($.fail=!0),l.error($,de),ye&&$.close(!1)},deflate:l.deflate||null,inflate:l.inflate||null};M.reset=function($){M.version={major:a.Version.major,minor:a.Version.minor},M.record=null,M.session=null,M.peerCertificate=null,M.state={pending:null,current:null},M.expect=M.entity===a.ConnectionEnd.client?o:n,M.fragmented=null,M.records=[],M.open=!1,M.handshakes=0,M.handshaking=!1,M.isConnected=!1,M.fail=!($||typeof $>"u"),M.input.clear(),M.tlsData.clear(),M.data.clear(),M.state.current=a.createConnectionState(M)},M.reset();var Z=function($,de){var ye=de.type-a.ContentType.change_cipher_spec,Be=z[$.entity][$.expect];ye in Be?Be[ye]($,de):a.handleUnexpected($,de)},pe=function($){var de=0,ye=$.input,Be=ye.length();if(Be<5)de=5-Be;else{$.record={type:ye.getByte(),version:{major:ye.getByte(),minor:ye.getByte()},length:ye.getInt16(),fragment:t.util.createBuffer(),ready:!1};var Ce=$.record.version.major===$.version.major;Ce&&$.session&&$.session.version&&(Ce=$.record.version.minor===$.version.minor),Ce||$.error($,{message:"Incompatible TLS version.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.protocol_version}})}return de},ce=function($){var de=0,ye=$.input,Be=ye.length();if(Be<$.record.length)de=$.record.length-Be;else{$.record.fragment.putBytes(ye.getBytes($.record.length)),ye.compact();var Ce=$.state.current.read;Ce.update($,$.record)&&($.fragmented!==null&&($.fragmented.type===$.record.type?($.fragmented.fragment.putBuffer($.record.fragment),$.record=$.fragmented):$.error($,{message:"Invalid fragmented record.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.unexpected_message}})),$.record.ready=!0)}return de};return M.handshake=function($){if(M.entity!==a.ConnectionEnd.client)M.error(M,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(M.handshaking)M.error(M,{message:"Handshake already in progress.",fatal:!1});else{M.fail&&!M.open&&M.handshakes===0&&(M.fail=!1),M.handshaking=!0,$=$||"";var de=null;$.length>0&&(M.sessionCache&&(de=M.sessionCache.getSession($)),de===null&&($="")),$.length===0&&M.sessionCache&&(de=M.sessionCache.getSession(),de!==null&&($=de.id)),M.session={id:$,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:t.md.md5.create(),sha1:t.md.sha1.create()},de&&(M.version=de.version,M.session.sp=de.sp),M.session.sp.client_random=a.createRandom().getBytes(),M.open=!0,a.queue(M,a.createRecord(M,{type:a.ContentType.handshake,data:a.createClientHello(M)})),a.flush(M)}},M.process=function($){var de=0;return $&&M.input.putBytes($),M.fail||(M.record!==null&&M.record.ready&&M.record.fragment.isEmpty()&&(M.record=null),M.record===null&&(de=pe(M)),!M.fail&&M.record!==null&&!M.record.ready&&(de=ce(M)),!M.fail&&M.record!==null&&M.record.ready&&Z(M,M.record)),de},M.prepare=function($){return a.queue(M,a.createRecord(M,{type:a.ContentType.application_data,data:t.util.createBuffer($)})),a.flush(M)},M.prepareHeartbeatRequest=function($,de){return $ instanceof t.util.ByteBuffer&&($=$.bytes()),typeof de>"u"&&(de=$.length),M.expectedHeartbeatPayload=$,a.queue(M,a.createRecord(M,{type:a.ContentType.heartbeat,data:a.createHeartbeat(a.HeartbeatMessageType.heartbeat_request,$,de)})),a.flush(M)},M.close=function($){if(!M.fail&&M.sessionCache&&M.session){var de={id:M.session.id,version:M.session.version,sp:M.session.sp};de.sp.keys=null,M.sessionCache.setSession(de.id,de)}M.open&&(M.open=!1,M.input.clear(),(M.isConnected||M.handshaking)&&(M.isConnected=M.handshaking=!1,a.queue(M,a.createAlert(M,{level:a.Alert.Level.warning,description:a.Alert.Description.close_notify})),a.flush(M)),M.closed(M)),M.reset($)},M},re.exports=t.tls=t.tls||{};for(var Q in a)typeof a[Q]!="function"&&(t.tls[Q]=a[Q]);t.tls.prf_tls1=e,t.tls.hmac_sha1=s,t.tls.createSessionCache=a.createSessionCache,t.tls.createConnection=a.createConnection},7619:(re,me,P)=>{var t=P(42363).Buffer,e=P(50276),h=P(44058),s=re.exports=e.util=e.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){s.nextTick=process.nextTick,typeof setImmediate=="function"?s.setImmediate=setImmediate:s.setImmediate=s.nextTick;return}if(typeof setImmediate=="function"){s.setImmediate=function(){return setImmediate.apply(void 0,arguments)},s.nextTick=function(b){return setImmediate(b)};return}if(s.setImmediate=function(b){setTimeout(b,0)},typeof window<"u"&&typeof window.postMessage=="function"){let b=function(r){if(r.source===window&&r.data===n){r.stopPropagation();var D=f.slice();f.length=0,D.forEach(function(O){O()})}};var g=b,n="forge.setImmediate",f=[];s.setImmediate=function(r){f.push(r),f.length===1&&window.postMessage(n,"*")},window.addEventListener("message",b,!0)}if(typeof MutationObserver<"u"){var C=Date.now(),B=!0,V=document.createElement("div"),f=[];new MutationObserver(function(){var r=f.slice();f.length=0,r.forEach(function(D){D()})}).observe(V,{attributes:!0});var u=s.setImmediate;s.setImmediate=function(r){Date.now()-C>15?(C=Date.now(),u(r)):(f.push(r),f.length===1&&V.setAttribute("a",B=!B))}}s.nextTick=s.setImmediate})(),s.isNodejs=typeof process<"u"&&process.versions&&process.versions.node,s.globalScope=function(){return s.isNodejs?P.g:typeof self>"u"?window:self}(),s.isArray=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"},s.isArrayBuffer=function(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer},s.isArrayBufferView=function(n){return n&&s.isArrayBuffer(n.buffer)&&n.byteLength!==void 0};function E(n){if(!(n===8||n===16||n===24||n===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+n)}s.ByteBuffer=T;function T(n){if(this.data="",this.read=0,typeof n=="string")this.data=n;else if(s.isArrayBuffer(n)||s.isArrayBufferView(n))if(typeof t<"u"&&n instanceof t)this.data=n.toString("binary");else{var f=new Uint8Array(n);try{this.data=String.fromCharCode.apply(null,f)}catch{for(var C=0;C<f.length;++C)this.putByte(f[C])}}else(n instanceof T||typeof n=="object"&&typeof n.data=="string"&&typeof n.read=="number")&&(this.data=n.data,this.read=n.read);this._constructedStringLength=0}s.ByteStringBuffer=T;var d=4096;s.ByteStringBuffer.prototype._optimizeConstructedString=function(n){this._constructedStringLength+=n,this._constructedStringLength>d&&(this.data.substr(0,1),this._constructedStringLength=0)},s.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},s.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},s.ByteStringBuffer.prototype.putByte=function(n){return this.putBytes(String.fromCharCode(n))},s.ByteStringBuffer.prototype.fillWithByte=function(n,f){n=String.fromCharCode(n);for(var C=this.data;f>0;)f&1&&(C+=n),f>>>=1,f>0&&(n+=n);return this.data=C,this._optimizeConstructedString(f),this},s.ByteStringBuffer.prototype.putBytes=function(n){return this.data+=n,this._optimizeConstructedString(n.length),this},s.ByteStringBuffer.prototype.putString=function(n){return this.putBytes(s.encodeUtf8(n))},s.ByteStringBuffer.prototype.putInt16=function(n){return this.putBytes(String.fromCharCode(n>>8&255)+String.fromCharCode(n&255))},s.ByteStringBuffer.prototype.putInt24=function(n){return this.putBytes(String.fromCharCode(n>>16&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n&255))},s.ByteStringBuffer.prototype.putInt32=function(n){return this.putBytes(String.fromCharCode(n>>24&255)+String.fromCharCode(n>>16&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n&255))},s.ByteStringBuffer.prototype.putInt16Le=function(n){return this.putBytes(String.fromCharCode(n&255)+String.fromCharCode(n>>8&255))},s.ByteStringBuffer.prototype.putInt24Le=function(n){return this.putBytes(String.fromCharCode(n&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n>>16&255))},s.ByteStringBuffer.prototype.putInt32Le=function(n){return this.putBytes(String.fromCharCode(n&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n>>16&255)+String.fromCharCode(n>>24&255))},s.ByteStringBuffer.prototype.putInt=function(n,f){E(f);var C="";do f-=8,C+=String.fromCharCode(n>>f&255);while(f>0);return this.putBytes(C)},s.ByteStringBuffer.prototype.putSignedInt=function(n,f){return n<0&&(n+=2<<f-1),this.putInt(n,f)},s.ByteStringBuffer.prototype.putBuffer=function(n){return this.putBytes(n.getBytes())},s.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},s.ByteStringBuffer.prototype.getInt16=function(){var n=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,n},s.ByteStringBuffer.prototype.getInt24=function(){var n=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,n},s.ByteStringBuffer.prototype.getInt32=function(){var n=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,n},s.ByteStringBuffer.prototype.getInt16Le=function(){var n=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,n},s.ByteStringBuffer.prototype.getInt24Le=function(){var n=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,n},s.ByteStringBuffer.prototype.getInt32Le=function(){var n=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,n},s.ByteStringBuffer.prototype.getInt=function(n){E(n);var f=0;do f=(f<<8)+this.data.charCodeAt(this.read++),n-=8;while(n>0);return f},s.ByteStringBuffer.prototype.getSignedInt=function(n){var f=this.getInt(n),C=2<<n-2;return f>=C&&(f-=C<<1),f},s.ByteStringBuffer.prototype.getBytes=function(n){var f;return n?(n=Math.min(this.length(),n),f=this.data.slice(this.read,this.read+n),this.read+=n):n===0?f="":(f=this.read===0?this.data:this.data.slice(this.read),this.clear()),f},s.ByteStringBuffer.prototype.bytes=function(n){return typeof n>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+n)},s.ByteStringBuffer.prototype.at=function(n){return this.data.charCodeAt(this.read+n)},s.ByteStringBuffer.prototype.setAt=function(n,f){return this.data=this.data.substr(0,this.read+n)+String.fromCharCode(f)+this.data.substr(this.read+n+1),this},s.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},s.ByteStringBuffer.prototype.copy=function(){var n=s.createBuffer(this.data);return n.read=this.read,n},s.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},s.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},s.ByteStringBuffer.prototype.truncate=function(n){var f=Math.max(0,this.length()-n);return this.data=this.data.substr(this.read,f),this.read=0,this},s.ByteStringBuffer.prototype.toHex=function(){for(var n="",f=this.read;f<this.data.length;++f){var C=this.data.charCodeAt(f);C<16&&(n+="0"),n+=C.toString(16)}return n},s.ByteStringBuffer.prototype.toString=function(){return s.decodeUtf8(this.bytes())};function p(n,f){f=f||{},this.read=f.readOffset||0,this.growSize=f.growSize||1024;var C=s.isArrayBuffer(n),B=s.isArrayBufferView(n);if(C||B){C?this.data=new DataView(n):this.data=new DataView(n.buffer,n.byteOffset,n.byteLength),this.write="writeOffset"in f?f.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,n!=null&&this.putBytes(n),"writeOffset"in f&&(this.write=f.writeOffset)}s.DataBuffer=p,s.DataBuffer.prototype.length=function(){return this.write-this.read},s.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},s.DataBuffer.prototype.accommodate=function(n,f){if(this.length()>=n)return this;f=Math.max(f||this.growSize,n);var C=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),B=new Uint8Array(this.length()+f);return B.set(C),this.data=new DataView(B.buffer),this},s.DataBuffer.prototype.putByte=function(n){return this.accommodate(1),this.data.setUint8(this.write++,n),this},s.DataBuffer.prototype.fillWithByte=function(n,f){this.accommodate(f);for(var C=0;C<f;++C)this.data.setUint8(n);return this},s.DataBuffer.prototype.putBytes=function(n,f){if(s.isArrayBufferView(n)){var C=new Uint8Array(n.buffer,n.byteOffset,n.byteLength),B=C.byteLength-C.byteOffset;this.accommodate(B);var V=new Uint8Array(this.data.buffer,this.write);return V.set(C),this.write+=B,this}if(s.isArrayBuffer(n)){var C=new Uint8Array(n);this.accommodate(C.byteLength);var V=new Uint8Array(this.data.buffer);return V.set(C,this.write),this.write+=C.byteLength,this}if(n instanceof s.DataBuffer||typeof n=="object"&&typeof n.read=="number"&&typeof n.write=="number"&&s.isArrayBufferView(n.data)){var C=new Uint8Array(n.data.byteLength,n.read,n.length());this.accommodate(C.byteLength);var V=new Uint8Array(n.data.byteLength,this.write);return V.set(C),this.write+=C.byteLength,this}if(n instanceof s.ByteStringBuffer&&(n=n.data,f="binary"),f=f||"binary",typeof n=="string"){var u;if(f==="hex")return this.accommodate(Math.ceil(n.length/2)),u=new Uint8Array(this.data.buffer,this.write),this.write+=s.binary.hex.decode(n,u,this.write),this;if(f==="base64")return this.accommodate(Math.ceil(n.length/4)*3),u=new Uint8Array(this.data.buffer,this.write),this.write+=s.binary.base64.decode(n,u,this.write),this;if(f==="utf8"&&(n=s.encodeUtf8(n),f="binary"),f==="binary"||f==="raw")return this.accommodate(n.length),u=new Uint8Array(this.data.buffer,this.write),this.write+=s.binary.raw.decode(u),this;if(f==="utf16")return this.accommodate(n.length*2),u=new Uint16Array(this.data.buffer,this.write),this.write+=s.text.utf16.encode(u),this;throw new Error("Invalid encoding: "+f)}throw Error("Invalid parameter: "+n)},s.DataBuffer.prototype.putBuffer=function(n){return this.putBytes(n),n.clear(),this},s.DataBuffer.prototype.putString=function(n){return this.putBytes(n,"utf16")},s.DataBuffer.prototype.putInt16=function(n){return this.accommodate(2),this.data.setInt16(this.write,n),this.write+=2,this},s.DataBuffer.prototype.putInt24=function(n){return this.accommodate(3),this.data.setInt16(this.write,n>>8&65535),this.data.setInt8(this.write,n>>16&255),this.write+=3,this},s.DataBuffer.prototype.putInt32=function(n){return this.accommodate(4),this.data.setInt32(this.write,n),this.write+=4,this},s.DataBuffer.prototype.putInt16Le=function(n){return this.accommodate(2),this.data.setInt16(this.write,n,!0),this.write+=2,this},s.DataBuffer.prototype.putInt24Le=function(n){return this.accommodate(3),this.data.setInt8(this.write,n>>16&255),this.data.setInt16(this.write,n>>8&65535,!0),this.write+=3,this},s.DataBuffer.prototype.putInt32Le=function(n){return this.accommodate(4),this.data.setInt32(this.write,n,!0),this.write+=4,this},s.DataBuffer.prototype.putInt=function(n,f){E(f),this.accommodate(f/8);do f-=8,this.data.setInt8(this.write++,n>>f&255);while(f>0);return this},s.DataBuffer.prototype.putSignedInt=function(n,f){return E(f),this.accommodate(f/8),n<0&&(n+=2<<f-1),this.putInt(n,f)},s.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},s.DataBuffer.prototype.getInt16=function(){var n=this.data.getInt16(this.read);return this.read+=2,n},s.DataBuffer.prototype.getInt24=function(){var n=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,n},s.DataBuffer.prototype.getInt32=function(){var n=this.data.getInt32(this.read);return this.read+=4,n},s.DataBuffer.prototype.getInt16Le=function(){var n=this.data.getInt16(this.read,!0);return this.read+=2,n},s.DataBuffer.prototype.getInt24Le=function(){var n=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,n},s.DataBuffer.prototype.getInt32Le=function(){var n=this.data.getInt32(this.read,!0);return this.read+=4,n},s.DataBuffer.prototype.getInt=function(n){E(n);var f=0;do f=(f<<8)+this.data.getInt8(this.read++),n-=8;while(n>0);return f},s.DataBuffer.prototype.getSignedInt=function(n){var f=this.getInt(n),C=2<<n-2;return f>=C&&(f-=C<<1),f},s.DataBuffer.prototype.getBytes=function(n){var f;return n?(n=Math.min(this.length(),n),f=this.data.slice(this.read,this.read+n),this.read+=n):n===0?f="":(f=this.read===0?this.data:this.data.slice(this.read),this.clear()),f},s.DataBuffer.prototype.bytes=function(n){return typeof n>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+n)},s.DataBuffer.prototype.at=function(n){return this.data.getUint8(this.read+n)},s.DataBuffer.prototype.setAt=function(n,f){return this.data.setUint8(n,f),this},s.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},s.DataBuffer.prototype.copy=function(){return new s.DataBuffer(this)},s.DataBuffer.prototype.compact=function(){if(this.read>0){var n=new Uint8Array(this.data.buffer,this.read),f=new Uint8Array(n.byteLength);f.set(n),this.data=new DataView(f),this.write-=this.read,this.read=0}return this},s.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},s.DataBuffer.prototype.truncate=function(n){return this.write=Math.max(0,this.length()-n),this.read=Math.min(this.read,this.write),this},s.DataBuffer.prototype.toHex=function(){for(var n="",f=this.read;f<this.data.byteLength;++f){var C=this.data.getUint8(f);C<16&&(n+="0"),n+=C.toString(16)}return n},s.DataBuffer.prototype.toString=function(n){var f=new Uint8Array(this.data,this.read,this.length());if(n=n||"utf8",n==="binary"||n==="raw")return s.binary.raw.encode(f);if(n==="hex")return s.binary.hex.encode(f);if(n==="base64")return s.binary.base64.encode(f);if(n==="utf8")return s.text.utf8.decode(f);if(n==="utf16")return s.text.utf16.decode(f);throw new Error("Invalid encoding: "+n)},s.createBuffer=function(n,f){return f=f||"raw",n!==void 0&&f==="utf8"&&(n=s.encodeUtf8(n)),new s.ByteBuffer(n)},s.fillString=function(n,f){for(var C="";f>0;)f&1&&(C+=n),f>>>=1,f>0&&(n+=n);return C},s.xorBytes=function(n,f,C){for(var B="",V="",u="",g=0,b=0;C>0;--C,++g)V=n.charCodeAt(g)^f.charCodeAt(g),b>=10&&(B+=u,u="",b=0),u+=String.fromCharCode(V),++b;return B+=u,B},s.hexToBytes=function(n){var f="",C=0;for(n.length&!0&&(C=1,f+=String.fromCharCode(parseInt(n[0],16)));C<n.length;C+=2)f+=String.fromCharCode(parseInt(n.substr(C,2),16));return f},s.bytesToHex=function(n){return s.createBuffer(n).toHex()},s.int32ToBytes=function(n){return String.fromCharCode(n>>24&255)+String.fromCharCode(n>>16&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n&255)};var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],S="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";s.encode64=function(n,f){for(var C="",B="",V,u,g,b=0;b<n.length;)V=n.charCodeAt(b++),u=n.charCodeAt(b++),g=n.charCodeAt(b++),C+=a.charAt(V>>2),C+=a.charAt((V&3)<<4|u>>4),isNaN(u)?C+="==":(C+=a.charAt((u&15)<<2|g>>6),C+=isNaN(g)?"=":a.charAt(g&63)),f&&C.length>f&&(B+=C.substr(0,f)+`\r
`,C=C.substr(f));return B+=C,B},s.decode64=function(n){n=n.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var f="",C,B,V,u,g=0;g<n.length;)C=o[n.charCodeAt(g++)-43],B=o[n.charCodeAt(g++)-43],V=o[n.charCodeAt(g++)-43],u=o[n.charCodeAt(g++)-43],f+=String.fromCharCode(C<<2|B>>4),V!==64&&(f+=String.fromCharCode((B&15)<<4|V>>2),u!==64&&(f+=String.fromCharCode((V&3)<<6|u)));return f},s.encodeUtf8=function(n){return unescape(encodeURIComponent(n))},s.decodeUtf8=function(n){return decodeURIComponent(escape(n))},s.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:h.encode,decode:h.decode}},s.binary.raw.encode=function(n){return String.fromCharCode.apply(null,n)},s.binary.raw.decode=function(n,f,C){var B=f;B||(B=new Uint8Array(n.length)),C=C||0;for(var V=C,u=0;u<n.length;++u)B[V++]=n.charCodeAt(u);return f?V-C:B},s.binary.hex.encode=s.bytesToHex,s.binary.hex.decode=function(n,f,C){var B=f;B||(B=new Uint8Array(Math.ceil(n.length/2))),C=C||0;var V=0,u=C;for(n.length&1&&(V=1,B[u++]=parseInt(n[0],16));V<n.length;V+=2)B[u++]=parseInt(n.substr(V,2),16);return f?u-C:B},s.binary.base64.encode=function(n,f){for(var C="",B="",V,u,g,b=0;b<n.byteLength;)V=n[b++],u=n[b++],g=n[b++],C+=a.charAt(V>>2),C+=a.charAt((V&3)<<4|u>>4),isNaN(u)?C+="==":(C+=a.charAt((u&15)<<2|g>>6),C+=isNaN(g)?"=":a.charAt(g&63)),f&&C.length>f&&(B+=C.substr(0,f)+`\r
`,C=C.substr(f));return B+=C,B},s.binary.base64.decode=function(n,f,C){var B=f;B||(B=new Uint8Array(Math.ceil(n.length/4)*3)),n=n.replace(/[^A-Za-z0-9\+\/\=]/g,""),C=C||0;for(var V,u,g,b,r=0,D=C;r<n.length;)V=o[n.charCodeAt(r++)-43],u=o[n.charCodeAt(r++)-43],g=o[n.charCodeAt(r++)-43],b=o[n.charCodeAt(r++)-43],B[D++]=V<<2|u>>4,g!==64&&(B[D++]=(u&15)<<4|g>>2,b!==64&&(B[D++]=(g&3)<<6|b));return f?D-C:B.subarray(0,D)},s.binary.base58.encode=function(n,f){return s.binary.baseN.encode(n,S,f)},s.binary.base58.decode=function(n,f){return s.binary.baseN.decode(n,S,f)},s.text={utf8:{},utf16:{}},s.text.utf8.encode=function(n,f,C){n=s.encodeUtf8(n);var B=f;B||(B=new Uint8Array(n.length)),C=C||0;for(var V=C,u=0;u<n.length;++u)B[V++]=n.charCodeAt(u);return f?V-C:B},s.text.utf8.decode=function(n){return s.decodeUtf8(String.fromCharCode.apply(null,n))},s.text.utf16.encode=function(n,f,C){var B=f;B||(B=new Uint8Array(n.length*2));var V=new Uint16Array(B.buffer);C=C||0;for(var u=C,g=C,b=0;b<n.length;++b)V[g++]=n.charCodeAt(b),u+=2;return f?u-C:B},s.text.utf16.decode=function(n){return String.fromCharCode.apply(null,new Uint16Array(n.buffer))},s.deflate=function(n,f,C){if(f=s.decode64(n.deflate(s.encode64(f)).rval),C){var B=2,V=f.charCodeAt(1);V&32&&(B=6),f=f.substring(B,f.length-4)}return f},s.inflate=function(n,f,C){var B=n.inflate(s.encode64(f)).rval;return B===null?null:s.decode64(B)};var U=function(n,f,C){if(!n)throw new Error("WebStorage not available.");var B;if(C===null?B=n.removeItem(f):(C=s.encode64(JSON.stringify(C)),B=n.setItem(f,C)),typeof B<"u"&&B.rval!==!0){var V=new Error(B.error.message);throw V.id=B.error.id,V.name=B.error.name,V}},x=function(n,f){if(!n)throw new Error("WebStorage not available.");var C=n.getItem(f);if(n.init)if(C.rval===null){if(C.error){var B=new Error(C.error.message);throw B.id=C.error.id,B.name=C.error.name,B}C=null}else C=C.rval;return C!==null&&(C=JSON.parse(s.decode64(C))),C},y=function(n,f,C,B){var V=x(n,f);V===null&&(V={}),V[C]=B,U(n,f,V)},m=function(n,f,C){var B=x(n,f);return B!==null&&(B=C in B?B[C]:null),B},c=function(n,f,C){var B=x(n,f);if(B!==null&&C in B){delete B[C];var V=!0;for(var u in B){V=!1;break}V&&(B=null),U(n,f,B)}},v=function(n,f){U(n,f,null)},R=function(n,f,C){var B=null;typeof C>"u"&&(C=["web","flash"]);var V,u=!1,g=null;for(var b in C){V=C[b];try{if(V==="flash"||V==="both"){if(f[0]===null)throw new Error("Flash local storage not available.");B=n.apply(this,f),u=V==="flash"}(V==="web"||V==="both")&&(f[0]=localStorage,B=n.apply(this,f),u=!0)}catch(r){g=r}if(u)break}if(!u)throw g;return B};s.setItem=function(n,f,C,B,V){R(y,arguments,V)},s.getItem=function(n,f,C,B){return R(m,arguments,B)},s.removeItem=function(n,f,C,B){R(c,arguments,B)},s.clearItems=function(n,f,C){R(v,arguments,C)},s.isEmpty=function(n){for(var f in n)if(n.hasOwnProperty(f))return!1;return!0},s.format=function(n){for(var f=/%./g,C,B,V=0,u=[],g=0;C=f.exec(n);){B=n.substring(g,f.lastIndex-2),B.length>0&&u.push(B),g=f.lastIndex;var b=C[0][1];switch(b){case"s":case"o":V<arguments.length?u.push(arguments[V+++1]):u.push("<?>");break;case"%":u.push("%");break;default:u.push("<%"+b+"?>")}}return u.push(n.substring(g)),u.join("")},s.formatNumber=function(n,f,C,B){var V=n,u=isNaN(f=Math.abs(f))?2:f,g=C===void 0?",":C,b=B===void 0?".":B,r=V<0?"-":"",D=parseInt(V=Math.abs(+V||0).toFixed(u),10)+"",O=D.length>3?D.length%3:0;return r+(O?D.substr(0,O)+b:"")+D.substr(O).replace(/(\d{3})(?=\d)/g,"$1"+b)+(u?g+Math.abs(V-D).toFixed(u).slice(2):"")},s.formatSize=function(n){return n>=1073741824?n=s.formatNumber(n/1073741824,2,".","")+" GiB":n>=1048576?n=s.formatNumber(n/1048576,2,".","")+" MiB":n>=1024?n=s.formatNumber(n/1024,0)+" KiB":n=s.formatNumber(n,0)+" bytes",n},s.bytesFromIP=function(n){return n.indexOf(".")!==-1?s.bytesFromIPv4(n):n.indexOf(":")!==-1?s.bytesFromIPv6(n):null},s.bytesFromIPv4=function(n){if(n=n.split("."),n.length!==4)return null;for(var f=s.createBuffer(),C=0;C<n.length;++C){var B=parseInt(n[C],10);if(isNaN(B))return null;f.putByte(B)}return f.getBytes()},s.bytesFromIPv6=function(n){var f=0;n=n.split(":").filter(function(g){return g.length===0&&++f,!0});for(var C=(8-n.length+f)*2,B=s.createBuffer(),V=0;V<8;++V){if(!n[V]||n[V].length===0){B.fillWithByte(0,C),C=0;continue}var u=s.hexToBytes(n[V]);u.length<2&&B.putByte(0),B.putBytes(u)}return B.getBytes()},s.bytesToIP=function(n){return n.length===4?s.bytesToIPv4(n):n.length===16?s.bytesToIPv6(n):null},s.bytesToIPv4=function(n){if(n.length!==4)return null;for(var f=[],C=0;C<n.length;++C)f.push(n.charCodeAt(C));return f.join(".")},s.bytesToIPv6=function(n){if(n.length!==16)return null;for(var f=[],C=[],B=0,V=0;V<n.length;V+=2){for(var u=s.bytesToHex(n[V]+n[V+1]);u[0]==="0"&&u!=="0";)u=u.substr(1);if(u==="0"){var g=C[C.length-1],b=f.length;!g||b!==g.end+1?C.push({start:b,end:b}):(g.end=b,g.end-g.start>C[B].end-C[B].start&&(B=C.length-1))}f.push(u)}if(C.length>0){var r=C[B];r.end-r.start>0&&(f.splice(r.start,r.end-r.start+1,""),r.start===0&&f.unshift(""),r.end===7&&f.push(""))}return f.join(":")},s.estimateCores=function(n,f){if(typeof n=="function"&&(f=n,n={}),n=n||{},"cores"in s&&!n.update)return f(null,s.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return s.cores=navigator.hardwareConcurrency,f(null,s.cores);if(typeof Worker>"u")return s.cores=1,f(null,s.cores);if(typeof Blob>"u")return s.cores=2,f(null,s.cores);var C=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(g){for(var b=Date.now(),r=b+4;Date.now()<r;);self.postMessage({st:b,et:r})})}.toString(),")()"],{type:"application/javascript"}));B([],5,16);function B(g,b,r){if(b===0){var D=Math.floor(g.reduce(function(O,w){return O+w},0)/g.length);return s.cores=Math.max(1,D),URL.revokeObjectURL(C),f(null,s.cores)}V(r,function(O,w){g.push(u(r,w)),B(g,b-1,r)})}function V(g,b){for(var r=[],D=[],O=0;O<g;++O){var w=new Worker(C);w.addEventListener("message",function(H){if(D.push(H.data),D.length===g){for(var j=0;j<g;++j)r[j].terminate();b(null,D)}}),r.push(w)}for(var O=0;O<g;++O)r[O].postMessage(O)}function u(g,b){for(var r=[],D=0;D<g;++D)for(var O=b[D],w=r[D]=[],H=0;H<g;++H)if(D!==H){var j=b[H];(O.st>j.st&&O.st<j.et||j.st>O.st&&j.st<O.et)&&w.push(H)}return r.reduce(function(z,W){return Math.max(z,W.length)},0)}}},66011:(re,me,P)=>{var t=P(50276);P(39504),P(12746),P(19095),P(8106),P(41373),P(94037),P(2385),P(51417),P(15805),P(7619);var e=t.asn1,h=re.exports=t.pki=t.pki||{},s=h.oids,E={};E.CN=s.commonName,E.commonName="CN",E.C=s.countryName,E.countryName="C",E.L=s.localityName,E.localityName="L",E.ST=s.stateOrProvinceName,E.stateOrProvinceName="ST",E.O=s.organizationName,E.organizationName="O",E.OU=s.organizationalUnitName,E.organizationalUnitName="OU",E.E=s.emailAddress,E.emailAddress="E";var T=t.pki.rsa.publicKeyValidator,d={name:"Certificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},T,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},p={name:"rsapss",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},a={name:"CertificationRequestInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},T,{name:"CertificationRequestInfo.attributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0}]}]}]},o={name:"CertificationRequest",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[a,{name:"CertificationRequest.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};h.RDNAttributesAsArray=function(u,g){for(var b=[],r,D,O,w=0;w<u.value.length;++w){r=u.value[w];for(var H=0;H<r.value.length;++H)O={},D=r.value[H],O.type=e.derToOid(D.value[0].value),O.value=D.value[1].value,O.valueTagClass=D.value[1].type,O.type in s&&(O.name=s[O.type],O.name in E&&(O.shortName=E[O.name])),g&&(g.update(O.type),g.update(O.value)),b.push(O)}return b},h.CRIAttributesAsArray=function(u){for(var g=[],b=0;b<u.length;++b)for(var r=u[b],D=e.derToOid(r.value[0].value),O=r.value[1].value,w=0;w<O.length;++w){var H={};if(H.type=D,H.value=O[w].value,H.valueTagClass=O[w].type,H.type in s&&(H.name=s[H.type],H.name in E&&(H.shortName=E[H.name])),H.type===s.extensionRequest){H.extensions=[];for(var j=0;j<H.value.length;++j)H.extensions.push(h.certificateExtensionFromAsn1(H.value[j]))}g.push(H)}return g};function S(u,g){typeof g=="string"&&(g={shortName:g});for(var b=null,r,D=0;b===null&&D<u.attributes.length;++D)r=u.attributes[D],(g.type&&g.type===r.type||g.name&&g.name===r.name||g.shortName&&g.shortName===r.shortName)&&(b=r);return b}var U=function(u,g,b){var r={};if(u!==s["RSASSA-PSS"])return r;b&&(r={hash:{algorithmOid:s.sha1},mgf:{algorithmOid:s.mgf1,hash:{algorithmOid:s.sha1}},saltLength:20});var D={},O=[];if(!e.validate(g,p,D,O)){var w=new Error("Cannot read RSASSA-PSS parameter block.");throw w.errors=O,w}return D.hashOid!==void 0&&(r.hash=r.hash||{},r.hash.algorithmOid=e.derToOid(D.hashOid)),D.maskGenOid!==void 0&&(r.mgf=r.mgf||{},r.mgf.algorithmOid=e.derToOid(D.maskGenOid),r.mgf.hash=r.mgf.hash||{},r.mgf.hash.algorithmOid=e.derToOid(D.maskGenHashOid)),D.saltLength!==void 0&&(r.saltLength=D.saltLength.charCodeAt(0)),r},x=function(u){switch(s[u.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return t.md.sha1.create();case"md5WithRSAEncryption":return t.md.md5.create();case"sha256WithRSAEncryption":return t.md.sha256.create();case"sha384WithRSAEncryption":return t.md.sha384.create();case"sha512WithRSAEncryption":return t.md.sha512.create();case"RSASSA-PSS":return t.md.sha256.create();default:var g=new Error("Could not compute "+u.type+" digest. Unknown signature OID.");throw g.signatureOid=u.signatureOid,g}},y=function(u){var g=u.certificate,b;switch(g.signatureOid){case s.sha1WithRSAEncryption:case s.sha1WithRSASignature:break;case s["RSASSA-PSS"]:var r,D;if(r=s[g.signatureParameters.mgf.hash.algorithmOid],r===void 0||t.md[r]===void 0){var O=new Error("Unsupported MGF hash function.");throw O.oid=g.signatureParameters.mgf.hash.algorithmOid,O.name=r,O}if(D=s[g.signatureParameters.mgf.algorithmOid],D===void 0||t.mgf[D]===void 0){var O=new Error("Unsupported MGF function.");throw O.oid=g.signatureParameters.mgf.algorithmOid,O.name=D,O}if(D=t.mgf[D].create(t.md[r].create()),r=s[g.signatureParameters.hash.algorithmOid],r===void 0||t.md[r]===void 0){var O=new Error("Unsupported RSASSA-PSS hash function.");throw O.oid=g.signatureParameters.hash.algorithmOid,O.name=r,O}b=t.pss.create(t.md[r].create(),D,g.signatureParameters.saltLength);break}return g.publicKey.verify(u.md.digest().getBytes(),u.signature,b)};h.certificateFromPem=function(u,g,b){var r=t.pem.decode(u)[0];if(r.type!=="CERTIFICATE"&&r.type!=="X509 CERTIFICATE"&&r.type!=="TRUSTED CERTIFICATE"){var D=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw D.headerType=r.type,D}if(r.procType&&r.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var O=e.fromDer(r.body,b);return h.certificateFromAsn1(O,g)},h.certificateToPem=function(u,g){var b={type:"CERTIFICATE",body:e.toDer(h.certificateToAsn1(u)).getBytes()};return t.pem.encode(b,{maxline:g})},h.publicKeyFromPem=function(u){var g=t.pem.decode(u)[0];if(g.type!=="PUBLIC KEY"&&g.type!=="RSA PUBLIC KEY"){var b=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw b.headerType=g.type,b}if(g.procType&&g.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var r=e.fromDer(g.body);return h.publicKeyFromAsn1(r)},h.publicKeyToPem=function(u,g){var b={type:"PUBLIC KEY",body:e.toDer(h.publicKeyToAsn1(u)).getBytes()};return t.pem.encode(b,{maxline:g})},h.publicKeyToRSAPublicKeyPem=function(u,g){var b={type:"RSA PUBLIC KEY",body:e.toDer(h.publicKeyToRSAPublicKey(u)).getBytes()};return t.pem.encode(b,{maxline:g})},h.getPublicKeyFingerprint=function(u,g){g=g||{};var b=g.md||t.md.sha1.create(),r=g.type||"RSAPublicKey",D;switch(r){case"RSAPublicKey":D=e.toDer(h.publicKeyToRSAPublicKey(u)).getBytes();break;case"SubjectPublicKeyInfo":D=e.toDer(h.publicKeyToAsn1(u)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+g.type+'".')}b.start(),b.update(D);var O=b.digest();if(g.encoding==="hex"){var w=O.toHex();return g.delimiter?w.match(/.{2}/g).join(g.delimiter):w}else{if(g.encoding==="binary")return O.getBytes();if(g.encoding)throw new Error('Unknown encoding "'+g.encoding+'".')}return O},h.certificationRequestFromPem=function(u,g,b){var r=t.pem.decode(u)[0];if(r.type!=="CERTIFICATE REQUEST"){var D=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw D.headerType=r.type,D}if(r.procType&&r.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var O=e.fromDer(r.body,b);return h.certificationRequestFromAsn1(O,g)},h.certificationRequestToPem=function(u,g){var b={type:"CERTIFICATE REQUEST",body:e.toDer(h.certificationRequestToAsn1(u)).getBytes()};return t.pem.encode(b,{maxline:g})},h.createCertificate=function(){var u={};return u.version=2,u.serialNumber="00",u.signatureOid=null,u.signature=null,u.siginfo={},u.siginfo.algorithmOid=null,u.validity={},u.validity.notBefore=new Date,u.validity.notAfter=new Date,u.issuer={},u.issuer.getField=function(g){return S(u.issuer,g)},u.issuer.addField=function(g){v([g]),u.issuer.attributes.push(g)},u.issuer.attributes=[],u.issuer.hash=null,u.subject={},u.subject.getField=function(g){return S(u.subject,g)},u.subject.addField=function(g){v([g]),u.subject.attributes.push(g)},u.subject.attributes=[],u.subject.hash=null,u.extensions=[],u.publicKey=null,u.md=null,u.setSubject=function(g,b){v(g),u.subject.attributes=g,delete u.subject.uniqueId,b&&(u.subject.uniqueId=b),u.subject.hash=null},u.setIssuer=function(g,b){v(g),u.issuer.attributes=g,delete u.issuer.uniqueId,b&&(u.issuer.uniqueId=b),u.issuer.hash=null},u.setExtensions=function(g){for(var b=0;b<g.length;++b)R(g[b],{cert:u});u.extensions=g},u.getExtension=function(g){typeof g=="string"&&(g={name:g});for(var b=null,r,D=0;b===null&&D<u.extensions.length;++D)r=u.extensions[D],(g.id&&r.id===g.id||g.name&&r.name===g.name)&&(b=r);return b},u.sign=function(g,b){u.md=b||t.md.sha1.create();var r=s[u.md.algorithm+"WithRSAEncryption"];if(!r){var D=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw D.algorithm=u.md.algorithm,D}u.signatureOid=u.siginfo.algorithmOid=r,u.tbsCertificate=h.getTBSCertificate(u);var O=e.toDer(u.tbsCertificate);u.md.update(O.getBytes()),u.signature=g.sign(u.md)},u.verify=function(g){var b=!1;if(!u.issued(g)){var r=g.issuer,D=u.subject,O=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw O.expectedIssuer=D.attributes,O.actualIssuer=r.attributes,O}var w=g.md;if(w===null){w=x({signatureOid:g.signatureOid,type:"certificate"});var H=g.tbsCertificate||h.getTBSCertificate(g),j=e.toDer(H);w.update(j.getBytes())}return w!==null&&(b=y({certificate:u,md:w,signature:g.signature})),b},u.isIssuer=function(g){var b=!1,r=u.issuer,D=g.subject;if(r.hash&&D.hash)b=r.hash===D.hash;else if(r.attributes.length===D.attributes.length){b=!0;for(var O,w,H=0;b&&H<r.attributes.length;++H)O=r.attributes[H],w=D.attributes[H],(O.type!==w.type||O.value!==w.value)&&(b=!1)}return b},u.issued=function(g){return g.isIssuer(u)},u.generateSubjectKeyIdentifier=function(){return h.getPublicKeyFingerprint(u.publicKey,{type:"RSAPublicKey"})},u.verifySubjectKeyIdentifier=function(){for(var g=s.subjectKeyIdentifier,b=0;b<u.extensions.length;++b){var r=u.extensions[b];if(r.id===g){var D=u.generateSubjectKeyIdentifier().getBytes();return t.util.hexToBytes(r.subjectKeyIdentifier)===D}}return!1},u},h.certificateFromAsn1=function(u,g){var b={},r=[];if(!e.validate(u,d,b,r)){var D=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw D.errors=r,D}var O=e.derToOid(b.publicKeyOid);if(O!==h.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var w=h.createCertificate();w.version=b.certVersion?b.certVersion.charCodeAt(0):0;var H=t.util.createBuffer(b.certSerialNumber);w.serialNumber=H.toHex(),w.signatureOid=t.asn1.derToOid(b.certSignatureOid),w.signatureParameters=U(w.signatureOid,b.certSignatureParams,!0),w.siginfo.algorithmOid=t.asn1.derToOid(b.certinfoSignatureOid),w.siginfo.parameters=U(w.siginfo.algorithmOid,b.certinfoSignatureParams,!1),w.signature=b.certSignature;var j=[];if(b.certValidity1UTCTime!==void 0&&j.push(e.utcTimeToDate(b.certValidity1UTCTime)),b.certValidity2GeneralizedTime!==void 0&&j.push(e.generalizedTimeToDate(b.certValidity2GeneralizedTime)),b.certValidity3UTCTime!==void 0&&j.push(e.utcTimeToDate(b.certValidity3UTCTime)),b.certValidity4GeneralizedTime!==void 0&&j.push(e.generalizedTimeToDate(b.certValidity4GeneralizedTime)),j.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(j.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(w.validity.notBefore=j[0],w.validity.notAfter=j[1],w.tbsCertificate=b.tbsCertificate,g){w.md=x({signatureOid:w.signatureOid,type:"certificate"});var z=e.toDer(w.tbsCertificate);w.md.update(z.getBytes())}var W=t.md.sha1.create(),X=e.toDer(b.certIssuer);W.update(X.getBytes()),w.issuer.getField=function(he){return S(w.issuer,he)},w.issuer.addField=function(he){v([he]),w.issuer.attributes.push(he)},w.issuer.attributes=h.RDNAttributesAsArray(b.certIssuer),b.certIssuerUniqueId&&(w.issuer.uniqueId=b.certIssuerUniqueId),w.issuer.hash=W.digest().toHex();var J=t.md.sha1.create(),te=e.toDer(b.certSubject);return J.update(te.getBytes()),w.subject.getField=function(he){return S(w.subject,he)},w.subject.addField=function(he){v([he]),w.subject.attributes.push(he)},w.subject.attributes=h.RDNAttributesAsArray(b.certSubject),b.certSubjectUniqueId&&(w.subject.uniqueId=b.certSubjectUniqueId),w.subject.hash=J.digest().toHex(),b.certExtensions?w.extensions=h.certificateExtensionsFromAsn1(b.certExtensions):w.extensions=[],w.publicKey=h.publicKeyFromAsn1(b.subjectPublicKeyInfo),w},h.certificateExtensionsFromAsn1=function(u){for(var g=[],b=0;b<u.value.length;++b)for(var r=u.value[b],D=0;D<r.value.length;++D)g.push(h.certificateExtensionFromAsn1(r.value[D]));return g},h.certificateExtensionFromAsn1=function(u){var g={};if(g.id=e.derToOid(u.value[0].value),g.critical=!1,u.value[1].type===e.Type.BOOLEAN?(g.critical=u.value[1].value.charCodeAt(0)!==0,g.value=u.value[2].value):g.value=u.value[1].value,g.id in s){if(g.name=s[g.id],g.name==="keyUsage"){var b=e.fromDer(g.value),r=0,D=0;b.value.length>1&&(r=b.value.charCodeAt(1),D=b.value.length>2?b.value.charCodeAt(2):0),g.digitalSignature=(r&128)===128,g.nonRepudiation=(r&64)===64,g.keyEncipherment=(r&32)===32,g.dataEncipherment=(r&16)===16,g.keyAgreement=(r&8)===8,g.keyCertSign=(r&4)===4,g.cRLSign=(r&2)===2,g.encipherOnly=(r&1)===1,g.decipherOnly=(D&128)===128}else if(g.name==="basicConstraints"){var b=e.fromDer(g.value);b.value.length>0&&b.value[0].type===e.Type.BOOLEAN?g.cA=b.value[0].value.charCodeAt(0)!==0:g.cA=!1;var O=null;b.value.length>0&&b.value[0].type===e.Type.INTEGER?O=b.value[0].value:b.value.length>1&&(O=b.value[1].value),O!==null&&(g.pathLenConstraint=e.derToInteger(O))}else if(g.name==="extKeyUsage")for(var b=e.fromDer(g.value),w=0;w<b.value.length;++w){var H=e.derToOid(b.value[w].value);H in s?g[s[H]]=!0:g[H]=!0}else if(g.name==="nsCertType"){var b=e.fromDer(g.value),r=0;b.value.length>1&&(r=b.value.charCodeAt(1)),g.client=(r&128)===128,g.server=(r&64)===64,g.email=(r&32)===32,g.objsign=(r&16)===16,g.reserved=(r&8)===8,g.sslCA=(r&4)===4,g.emailCA=(r&2)===2,g.objCA=(r&1)===1}else if(g.name==="subjectAltName"||g.name==="issuerAltName"){g.altNames=[];for(var j,b=e.fromDer(g.value),z=0;z<b.value.length;++z){j=b.value[z];var W={type:j.type,value:j.value};switch(g.altNames.push(W),j.type){case 1:case 2:case 6:break;case 7:W.ip=t.util.bytesToIP(j.value);break;case 8:W.oid=e.derToOid(j.value);break;default:}}}else if(g.name==="subjectKeyIdentifier"){var b=e.fromDer(g.value);g.subjectKeyIdentifier=t.util.bytesToHex(b.value)}}return g},h.certificationRequestFromAsn1=function(u,g){var b={},r=[];if(!e.validate(u,o,b,r)){var D=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw D.errors=r,D}var O=e.derToOid(b.publicKeyOid);if(O!==h.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var w=h.createCertificationRequest();if(w.version=b.csrVersion?b.csrVersion.charCodeAt(0):0,w.signatureOid=t.asn1.derToOid(b.csrSignatureOid),w.signatureParameters=U(w.signatureOid,b.csrSignatureParams,!0),w.siginfo.algorithmOid=t.asn1.derToOid(b.csrSignatureOid),w.siginfo.parameters=U(w.siginfo.algorithmOid,b.csrSignatureParams,!1),w.signature=b.csrSignature,w.certificationRequestInfo=b.certificationRequestInfo,g){w.md=x({signatureOid:w.signatureOid,type:"certification request"});var H=e.toDer(w.certificationRequestInfo);w.md.update(H.getBytes())}var j=t.md.sha1.create();return w.subject.getField=function(z){return S(w.subject,z)},w.subject.addField=function(z){v([z]),w.subject.attributes.push(z)},w.subject.attributes=h.RDNAttributesAsArray(b.certificationRequestInfoSubject,j),w.subject.hash=j.digest().toHex(),w.publicKey=h.publicKeyFromAsn1(b.subjectPublicKeyInfo),w.getAttribute=function(z){return S(w,z)},w.addAttribute=function(z){v([z]),w.attributes.push(z)},w.attributes=h.CRIAttributesAsArray(b.certificationRequestInfoAttributes||[]),w},h.createCertificationRequest=function(){var u={};return u.version=0,u.signatureOid=null,u.signature=null,u.siginfo={},u.siginfo.algorithmOid=null,u.subject={},u.subject.getField=function(g){return S(u.subject,g)},u.subject.addField=function(g){v([g]),u.subject.attributes.push(g)},u.subject.attributes=[],u.subject.hash=null,u.publicKey=null,u.attributes=[],u.getAttribute=function(g){return S(u,g)},u.addAttribute=function(g){v([g]),u.attributes.push(g)},u.md=null,u.setSubject=function(g){v(g),u.subject.attributes=g,u.subject.hash=null},u.setAttributes=function(g){v(g),u.attributes=g},u.sign=function(g,b){u.md=b||t.md.sha1.create();var r=s[u.md.algorithm+"WithRSAEncryption"];if(!r){var D=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw D.algorithm=u.md.algorithm,D}u.signatureOid=u.siginfo.algorithmOid=r,u.certificationRequestInfo=h.getCertificationRequestInfo(u);var O=e.toDer(u.certificationRequestInfo);u.md.update(O.getBytes()),u.signature=g.sign(u.md)},u.verify=function(){var g=!1,b=u.md;if(b===null){b=x({signatureOid:u.signatureOid,type:"certification request"});var r=u.certificationRequestInfo||h.getCertificationRequestInfo(u),D=e.toDer(r);b.update(D.getBytes())}return b!==null&&(g=y({certificate:u,md:b,signature:u.signature})),g},u};function m(u){for(var g=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),b,r,D=u.attributes,O=0;O<D.length;++O){b=D[O];var w=b.value,H=e.Type.PRINTABLESTRING;"valueTagClass"in b&&(H=b.valueTagClass,H===e.Type.UTF8&&(w=t.util.encodeUtf8(w))),r=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(b.type).getBytes()),e.create(e.Class.UNIVERSAL,H,!1,w)])]),g.value.push(r)}return g}function c(u){for(var g={},b=0;b<u.length;++b){var r=u[b];if(r.shortName&&(r.valueTagClass===e.Type.UTF8||r.valueTagClass===e.Type.PRINTABLESTRING||r.valueTagClass===e.Type.IA5STRING)){var D=r.value;r.valueTagClass===e.Type.UTF8&&(D=t.util.encodeUtf8(r.value)),r.shortName in g?t.util.isArray(g[r.shortName])?g[r.shortName].push(D):g[r.shortName]=[g[r.shortName],D]:g[r.shortName]=D}}return g}function v(u){for(var g,b=0;b<u.length;++b){if(g=u[b],typeof g.name>"u"&&(g.type&&g.type in h.oids?g.name=h.oids[g.type]:g.shortName&&g.shortName in E&&(g.name=h.oids[E[g.shortName]])),typeof g.type>"u")if(g.name&&g.name in h.oids)g.type=h.oids[g.name];else{var r=new Error("Attribute type not specified.");throw r.attribute=g,r}if(typeof g.shortName>"u"&&g.name&&g.name in E&&(g.shortName=E[g.name]),g.type===s.extensionRequest&&(g.valueConstructed=!0,g.valueTagClass=e.Type.SEQUENCE,!g.value&&g.extensions)){g.value=[];for(var D=0;D<g.extensions.length;++D)g.value.push(h.certificateExtensionToAsn1(R(g.extensions[D])))}if(typeof g.value>"u"){var r=new Error("Attribute value not specified.");throw r.attribute=g,r}}}function R(u,g){if(g=g||{},typeof u.name>"u"&&u.id&&u.id in h.oids&&(u.name=h.oids[u.id]),typeof u.id>"u")if(u.name&&u.name in h.oids)u.id=h.oids[u.name];else{var b=new Error("Extension ID not specified.");throw b.extension=u,b}if(typeof u.value<"u")return u;if(u.name==="keyUsage"){var r=0,D=0,O=0;u.digitalSignature&&(D|=128,r=7),u.nonRepudiation&&(D|=64,r=6),u.keyEncipherment&&(D|=32,r=5),u.dataEncipherment&&(D|=16,r=4),u.keyAgreement&&(D|=8,r=3),u.keyCertSign&&(D|=4,r=2),u.cRLSign&&(D|=2,r=1),u.encipherOnly&&(D|=1,r=0),u.decipherOnly&&(O|=128,r=7);var w=String.fromCharCode(r);O!==0?w+=String.fromCharCode(D)+String.fromCharCode(O):D!==0&&(w+=String.fromCharCode(D)),u.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,w)}else if(u.name==="basicConstraints")u.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),u.cA&&u.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,"\xFF")),"pathLenConstraint"in u&&u.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(u.pathLenConstraint).getBytes()));else if(u.name==="extKeyUsage"){u.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var H=u.value.value;for(var j in u)u[j]===!0&&(j in s?H.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(s[j]).getBytes())):j.indexOf(".")!==-1&&H.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(j).getBytes())))}else if(u.name==="nsCertType"){var r=0,D=0;u.client&&(D|=128,r=7),u.server&&(D|=64,r=6),u.email&&(D|=32,r=5),u.objsign&&(D|=16,r=4),u.reserved&&(D|=8,r=3),u.sslCA&&(D|=4,r=2),u.emailCA&&(D|=2,r=1),u.objCA&&(D|=1,r=0);var w=String.fromCharCode(r);D!==0&&(w+=String.fromCharCode(D)),u.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,w)}else if(u.name==="subjectAltName"||u.name==="issuerAltName"){u.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var z,W=0;W<u.altNames.length;++W){z=u.altNames[W];var w=z.value;if(z.type===7&&z.ip){if(w=t.util.bytesFromIP(z.ip),w===null){var b=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw b.extension=u,b}}else z.type===8&&(z.oid?w=e.oidToDer(e.oidToDer(z.oid)):w=e.oidToDer(w));u.value.value.push(e.create(e.Class.CONTEXT_SPECIFIC,z.type,!1,w))}}else if(u.name==="nsComment"&&g.cert){if(!/^[\x00-\x7F]*$/.test(u.comment)||u.comment.length<1||u.comment.length>128)throw new Error('Invalid "nsComment" content.');u.value=e.create(e.Class.UNIVERSAL,e.Type.IA5STRING,!1,u.comment)}else if(u.name==="subjectKeyIdentifier"&&g.cert){var X=g.cert.generateSubjectKeyIdentifier();u.subjectKeyIdentifier=X.toHex(),u.value=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,X.getBytes())}else if(u.name==="authorityKeyIdentifier"&&g.cert){u.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var H=u.value.value;if(u.keyIdentifier){var J=u.keyIdentifier===!0?g.cert.generateSubjectKeyIdentifier().getBytes():u.keyIdentifier;H.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!1,J))}if(u.authorityCertIssuer){var te=[e.create(e.Class.CONTEXT_SPECIFIC,4,!0,[m(u.authorityCertIssuer===!0?g.cert.issuer:u.authorityCertIssuer)])];H.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,te))}if(u.serialNumber){var he=t.util.hexToBytes(u.serialNumber===!0?g.cert.serialNumber:u.serialNumber);H.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!1,he))}}else if(u.name==="cRLDistributionPoints"){u.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var H=u.value.value,xe=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),Se=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]),z,W=0;W<u.altNames.length;++W){z=u.altNames[W];var w=z.value;if(z.type===7&&z.ip){if(w=t.util.bytesFromIP(z.ip),w===null){var b=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw b.extension=u,b}}else z.type===8&&(z.oid?w=e.oidToDer(e.oidToDer(z.oid)):w=e.oidToDer(w));Se.value.push(e.create(e.Class.CONTEXT_SPECIFIC,z.type,!1,w))}xe.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[Se])),H.push(xe)}if(typeof u.value>"u"){var b=new Error("Extension value not specified.");throw b.extension=u,b}return u}function n(u,g){switch(u){case s["RSASSA-PSS"]:var b=[];return g.hash.algorithmOid!==void 0&&b.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(g.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])),g.mgf.algorithmOid!==void 0&&b.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(g.mgf.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(g.mgf.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])])),g.saltLength!==void 0&&b.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(g.saltLength).getBytes())])),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,b);default:return e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")}}function f(u){var g=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);if(u.attributes.length===0)return g;for(var b=u.attributes,r=0;r<b.length;++r){var D=b[r],O=D.value,w=e.Type.UTF8;"valueTagClass"in D&&(w=D.valueTagClass),w===e.Type.UTF8&&(O=t.util.encodeUtf8(O));var H=!1;"valueConstructed"in D&&(H=D.valueConstructed);var j=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(D.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,w,H,O)])]);g.value.push(j)}return g}var C=new Date("1950-01-01T00:00:00Z"),B=new Date("2050-01-01T00:00:00Z");function V(u){return u>=C&&u<B?e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(u)):e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(u))}h.getTBSCertificate=function(u){var g=V(u.validity.notBefore),b=V(u.validity.notAfter),r=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(u.version).getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,t.util.hexToBytes(u.serialNumber)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.siginfo.algorithmOid).getBytes()),n(u.siginfo.algorithmOid,u.siginfo.parameters)]),m(u.issuer),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[g,b]),m(u.subject),h.publicKeyToAsn1(u.publicKey)]);return u.issuer.uniqueId&&r.value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+u.issuer.uniqueId)])),u.subject.uniqueId&&r.value.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+u.subject.uniqueId)])),u.extensions.length>0&&r.value.push(h.certificateExtensionsToAsn1(u.extensions)),r},h.getCertificationRequestInfo=function(u){var g=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(u.version).getBytes()),m(u.subject),h.publicKeyToAsn1(u.publicKey),f(u)]);return g},h.distinguishedNameToAsn1=function(u){return m(u)},h.certificateToAsn1=function(u){var g=u.tbsCertificate||h.getTBSCertificate(u);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[g,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.signatureOid).getBytes()),n(u.signatureOid,u.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+u.signature)])},h.certificateExtensionsToAsn1=function(u){var g=e.create(e.Class.CONTEXT_SPECIFIC,3,!0,[]),b=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);g.value.push(b);for(var r=0;r<u.length;++r)b.value.push(h.certificateExtensionToAsn1(u[r]));return g},h.certificateExtensionToAsn1=function(u){var g=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);g.value.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.id).getBytes())),u.critical&&g.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,"\xFF"));var b=u.value;return typeof u.value!="string"&&(b=e.toDer(b).getBytes()),g.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,b)),g},h.certificationRequestToAsn1=function(u){var g=u.certificationRequestInfo||h.getCertificationRequestInfo(u);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[g,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.signatureOid).getBytes()),n(u.signatureOid,u.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+u.signature)])},h.createCaStore=function(u){var g={certs:{}};g.getIssuer=function(w){var H=b(w.issuer);return H},g.addCertificate=function(w){if(typeof w=="string"&&(w=t.pki.certificateFromPem(w)),r(w.subject),!g.hasCertificate(w))if(w.subject.hash in g.certs){var H=g.certs[w.subject.hash];t.util.isArray(H)||(H=[H]),H.push(w),g.certs[w.subject.hash]=H}else g.certs[w.subject.hash]=w},g.hasCertificate=function(w){typeof w=="string"&&(w=t.pki.certificateFromPem(w));var H=b(w.subject);if(!H)return!1;t.util.isArray(H)||(H=[H]);for(var j=e.toDer(h.certificateToAsn1(w)).getBytes(),z=0;z<H.length;++z){var W=e.toDer(h.certificateToAsn1(H[z])).getBytes();if(j===W)return!0}return!1},g.listAllCertificates=function(){var w=[];for(var H in g.certs)if(g.certs.hasOwnProperty(H)){var j=g.certs[H];if(!t.util.isArray(j))w.push(j);else for(var z=0;z<j.length;++z)w.push(j[z])}return w},g.removeCertificate=function(w){var H;if(typeof w=="string"&&(w=t.pki.certificateFromPem(w)),r(w.subject),!g.hasCertificate(w))return null;var j=b(w.subject);if(!t.util.isArray(j))return H=g.certs[w.subject.hash],delete g.certs[w.subject.hash],H;for(var z=e.toDer(h.certificateToAsn1(w)).getBytes(),W=0;W<j.length;++W){var X=e.toDer(h.certificateToAsn1(j[W])).getBytes();z===X&&(H=j[W],j.splice(W,1))}return j.length===0&&delete g.certs[w.subject.hash],H};function b(w){return r(w),g.certs[w.hash]||null}function r(w){if(!w.hash){var H=t.md.sha1.create();w.attributes=h.RDNAttributesAsArray(m(w),H),w.hash=H.digest().toHex()}}if(u)for(var D=0;D<u.length;++D){var O=u[D];g.addCertificate(O)}return g},h.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},h.verifyCertificateChain=function(u,g,b){typeof b=="function"&&(b={verify:b}),b=b||{},g=g.slice(0);var r=g.slice(0),D=b.validityCheckDate;typeof D>"u"&&(D=new Date);var O=!0,w=null,H=0;do{var j=g.shift(),z=null,W=!1;if(D&&(D<j.validity.notBefore||D>j.validity.notAfter)&&(w={message:"Certificate is not valid yet or has expired.",error:h.certificateError.certificate_expired,notBefore:j.validity.notBefore,notAfter:j.validity.notAfter,now:D}),w===null){if(z=g[0]||u.getIssuer(j),z===null&&j.isIssuer(j)&&(W=!0,z=j),z){var X=z;t.util.isArray(X)||(X=[X]);for(var J=!1;!J&&X.length>0;){z=X.shift();try{J=z.verify(j)}catch{}}J||(w={message:"Certificate signature is invalid.",error:h.certificateError.bad_certificate})}w===null&&(!z||W)&&!u.hasCertificate(j)&&(w={message:"Certificate is not trusted.",error:h.certificateError.unknown_ca})}if(w===null&&z&&!j.isIssuer(z)&&(w={message:"Certificate issuer is invalid.",error:h.certificateError.bad_certificate}),w===null)for(var te={keyUsage:!0,basicConstraints:!0},he=0;w===null&&he<j.extensions.length;++he){var xe=j.extensions[he];xe.critical&&!(xe.name in te)&&(w={message:"Certificate has an unsupported critical extension.",error:h.certificateError.unsupported_certificate})}if(w===null&&(!O||g.length===0&&(!z||W))){var Se=j.getExtension("basicConstraints"),ve=j.getExtension("keyUsage");if(ve!==null&&(!ve.keyCertSign||Se===null)&&(w={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:h.certificateError.bad_certificate}),w===null&&Se!==null&&!Se.cA&&(w={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:h.certificateError.bad_certificate}),w===null&&ve!==null&&"pathLenConstraint"in Se){var ae=H-1;ae>Se.pathLenConstraint&&(w={message:"Certificate basicConstraints pathLenConstraint violated.",error:h.certificateError.bad_certificate})}}var ue=w===null?!0:w.error,be=b.verify?b.verify(ue,H,r):ue;if(be===!0)w=null;else throw ue===!0&&(w={message:"The application rejected the certificate.",error:h.certificateError.bad_certificate}),(be||be===0)&&(typeof be=="object"&&!t.util.isArray(be)?(be.message&&(w.message=be.message),be.error&&(w.error=be.error)):typeof be=="string"&&(w.error=be)),w;O=!1,++H}while(g.length>0);return!0}}}]);

//# sourceMappingURL=7237.aa8a3e00033ee0f8c602.js.map